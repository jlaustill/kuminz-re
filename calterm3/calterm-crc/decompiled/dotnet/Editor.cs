#define TRACE
using System;
using System.CodeDom.Compiler;
using System.Collections;
using System.Collections.Generic;
using System.Collections.Specialized;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Data;
using System.Diagnostics;
using System.Drawing;
using System.Globalization;
using System.IO;
using System.Reflection;
using System.Resources;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Runtime.Serialization;
using System.Runtime.Versioning;
using System.Text;
using System.Threading;
using System.Windows.Forms;
using System.Windows.Forms.Layout;
using System.Xml;
using System.Xml.Schema;
using System.Xml.Serialization;
using Cummins.AddressRepresentation;
using Cummins.ApplicationServices;
using Cummins.CUTY;
using Cummins.CalToolsLib;
using Cummins.Calibration;
using Cummins.Editor;
using Cummins.EventLog;
using Cummins.HexEditor;
using Cummins.IDLLogger;
using Cummins.Interop.CalDataServer;
using Cummins.Interop.DataMonitoring;
using Cummins.Logging;
using Cummins.MessageDialog;
using Cummins.Module;
using Cummins.Parameter;
using Cummins.ParameterSelector;
using Cummins.ProductInformationProvider;
using Cummins.Services;
using Cummins.Subscription;
using Cummins.Widgets;
using DevComponents.DotNetBar;
using Iocomp.Classes;
using Iocomp.Instrumentation.Plotting;
using Iocomp.Instrumentation.Standard;
using Iocomp.Types;

[assembly: AssemblyProduct("Calterm III - Editor")]
[assembly: AssemblyDelaySign(false)]
[assembly: AssemblyTitle("Poodle")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCopyright("Copyright © Cummins Inc., 2017")]
[assembly: AssemblyTrademark("Copyright © Cummins Inc., 2017")]
[assembly: AssemblyFileVersion("3.17.0.000")]
[assembly: Debuggable(DebuggableAttribute.DebuggingModes.IgnoreSymbolStoreSequencePoints)]
[assembly: AssemblyDescription("")]
[assembly: RuntimeCompatibility(WrapNonExceptionThrows = true)]
[assembly: CompilationRelaxations(8)]
[assembly: TargetFramework(".NETFramework,Version=v4.5", FrameworkDisplayName = ".NET Framework 4.5")]
[assembly: AssemblyVersion("3.17.0.0")]
namespace Cummins.Editor
{
	public abstract class Monitor
	{
		private SortedList nameSubscriptions;

		private SortedList publicDataSubscriptions;

		private ISubscription publicDataBroadcastSubscription;

		private SortedList addressSubscriptions;

		private SortedList dataSources;

		private IModuleNetwork network;

		private bool connectionTimeoutEnabled;

		private int connectionTimeoutMinimum;

		private int connectionTimeoutFactor;

		private bool isMonitoring;

		private bool isPublicBroadcast;

		protected int dataRefreshRate;

		protected RefreshUnitsType dataRefreshUnit;

		public bool PublicBroadcastAvailable => isPublicBroadcast;

		public SortedList NameSubscriptions
		{
			get
			{
				if (nameSubscriptions == null)
				{
					nameSubscriptions = new SortedList();
				}
				return nameSubscriptions;
			}
		}

		public SortedList PublicDataSubscriptions
		{
			get
			{
				if (publicDataSubscriptions == null)
				{
					publicDataSubscriptions = new SortedList();
				}
				return publicDataSubscriptions;
			}
		}

		public ISubscription PublicDataBroadcastSubscription
		{
			get
			{
				if (publicDataBroadcastSubscription == null)
				{
					publicDataBroadcastSubscription = Network.BroadcastSubscription;
					try
					{
						publicDataBroadcastSubscription.Notification += OnDataRefresh;
						publicDataBroadcastSubscription.LastParameterRemoved += OnLastParameterRemoved;
						if (IsMonitoring)
						{
							publicDataBroadcastSubscription.Start();
						}
					}
					catch (Exception)
					{
					}
				}
				else
				{
					Network.ReopenBroadcastSubscription();
				}
				return publicDataBroadcastSubscription;
			}
			set
			{
				publicDataBroadcastSubscription = value;
			}
		}

		public SortedList AddressSubscriptions
		{
			get
			{
				if (addressSubscriptions == null)
				{
					addressSubscriptions = new SortedList();
				}
				return addressSubscriptions;
			}
		}

		public SortedList DataSources
		{
			get
			{
				return dataSources;
			}
			set
			{
				dataSources = value;
			}
		}

		public IModuleNetwork Network
		{
			get
			{
				return network;
			}
			set
			{
				if (value != network && value != null)
				{
					network = value;
				}
			}
		}

		public bool ConnectionTimeoutEnabled
		{
			get
			{
				return connectionTimeoutEnabled;
			}
			set
			{
				if (value == connectionTimeoutEnabled)
				{
					return;
				}
				connectionTimeoutEnabled = value;
				lock (NameSubscriptions)
				{
					foreach (ISubscription value2 in NameSubscriptions.Values)
					{
						if (value2 != null && value2 is IECMSubscription)
						{
							(value2 as IECMSubscription).MonitorTimeoutEnabled = value;
						}
					}
				}
				lock (AddressSubscriptions)
				{
					foreach (ISubscription value3 in AddressSubscriptions.Values)
					{
						if (value3 != null && value3 is IECMSubscription)
						{
							(value3 as IECMSubscription).MonitorTimeoutEnabled = value;
						}
					}
				}
			}
		}

		public int ConnectionTimeoutMinimum
		{
			get
			{
				return connectionTimeoutMinimum;
			}
			set
			{
				if (value == connectionTimeoutMinimum)
				{
					return;
				}
				connectionTimeoutMinimum = value;
				lock (NameSubscriptions)
				{
					foreach (ISubscription value2 in NameSubscriptions.Values)
					{
						if (value2 != null && value2 is IECMSubscription)
						{
							(value2 as IECMSubscription).MonitorTimeoutFloor = value;
						}
					}
				}
				lock (AddressSubscriptions)
				{
					foreach (ISubscription value3 in AddressSubscriptions.Values)
					{
						if (value3 != null && value3 is IECMSubscription)
						{
							(value3 as IECMSubscription).MonitorTimeoutFloor = value;
						}
					}
				}
			}
		}

		public int ConnectionTimeoutFactor
		{
			get
			{
				return connectionTimeoutFactor;
			}
			set
			{
				if (value == connectionTimeoutFactor)
				{
					return;
				}
				connectionTimeoutFactor = value;
				lock (NameSubscriptions)
				{
					foreach (ISubscription value2 in NameSubscriptions.Values)
					{
						if (value2 != null && value2 is IECMSubscription)
						{
							(value2 as IECMSubscription).MonitorTimeoutFactor = value;
						}
					}
				}
				lock (AddressSubscriptions)
				{
					foreach (ISubscription value3 in AddressSubscriptions.Values)
					{
						if (value3 != null && value3 is IECMSubscription)
						{
							(value3 as IECMSubscription).MonitorTimeoutFactor = value;
						}
					}
				}
			}
		}

		public int DataRefreshRate => dataRefreshRate;

		public RefreshUnitsType DataRefreshUnit => dataRefreshUnit;

		protected bool GetSubscriptionsStatus
		{
			get
			{
				bool flag = false;
				lock (NameSubscriptions)
				{
					for (int i = 0; i < NameSubscriptions.Count; i++)
					{
						if ((NameSubscriptions.GetByIndex(i) as ISubscription).IsActive)
						{
							flag = true;
							break;
						}
					}
				}
				if (!flag)
				{
					lock (AddressSubscriptions)
					{
						for (int j = 0; j < AddressSubscriptions.Count; j++)
						{
							if ((AddressSubscriptions.GetByIndex(j) as ISubscription).IsActive)
							{
								flag = true;
								break;
							}
						}
					}
				}
				if (!isMonitoring)
				{
					lock (PublicDataSubscriptions)
					{
						for (int k = 0; k < PublicDataSubscriptions.Count; k++)
						{
							if ((PublicDataSubscriptions.GetByIndex(k) as ISubscription).IsActive)
							{
								flag = true;
								break;
							}
						}
					}
				}
				if (!isMonitoring && publicDataBroadcastSubscription != null)
				{
					lock (PublicDataBroadcastSubscription)
					{
						isMonitoring = PublicDataBroadcastSubscription.IsActive;
					}
				}
				return flag;
			}
		}

		internal bool IsMonitoring
		{
			get
			{
				return isMonitoring;
			}
			private set
			{
				if (value != isMonitoring)
				{
					isMonitoring = value;
					RaiseMonitorStatusChangedEvent();
				}
			}
		}

		public event PerformanceEventHandler PerformanceStatistics;

		public event RunLocationChangeEventHandler RunLocationChange;

		public event StopBroadCastEventHandler StopBroadCast;

		public event ConnectionLostEventHandler ConnectionLost;

		public event NotificationEventHandler Notification;

		public event SubscriptionRemovedEventHandler SubscriptionRemoved;

		public event EventHandler MonitorStatusChangedEvent;

		public Monitor(IModuleNetwork network)
		{
			this.network = network;
		}

		public virtual void AddParameter(ParameterEventArgs e, bool startMonitoring)
		{
			if (!ValidateParameter(e))
			{
				return;
			}
			ICalibration calibration = (ICalibration)DataSources[e.SourceAddress];
			if (calibration is ICalibrationDisk)
			{
				if (AccessModeType.Address == e.ParameterSpecification.Type)
				{
					AddParameter(e.Address, e.Offset, e.Length, e.SourceAddress, e.ParameterModel, startMonitoring);
				}
				else
				{
					AddParameter(e.FullName, e.SourceAddress, e.ReadabilityCheckPassed, startMonitoring, e.DataAccessType);
				}
			}
			else if (calibration is ICalibrationECM)
			{
				if (AccessModeType.ArrayElement == e.ParameterSpecification.Type || AccessModeType.Address == e.ParameterSpecification.Type)
				{
					AddParameter(e.Address, e.Offset, e.Length, e.SourceAddress, e.ParameterModel, startMonitoring);
				}
				else
				{
					AddParameter(e.FullName, e.SourceAddress, e.ReadabilityCheckPassed, startMonitoring, e.DataAccessType);
				}
			}
			else if (calibration is ICalibrationASAM)
			{
				if (e.Type == ParameterType.Value || e.Type == ParameterType.Enumeration)
				{
					AddParameter(e.FullName, e.SourceAddress, e.ReadabilityCheckPassed, startMonitoring, e.DataAccessType);
				}
			}
			else if (calibration is IPublicDataSource)
			{
				AddParameter(e.FullName, e.SourceAddress, e.ReadabilityCheckPassed, startMonitoring, e.DataAccessType);
			}
		}

		public virtual void AddParameterList(ParameterListEventArgs e)
		{
			string empty = string.Empty;
			foreach (string key in e.Parameters.Keys)
			{
				try
				{
					ISubscription subscription = null;
					empty = string.Empty;
					int num = key.IndexOf('[');
					if (num > 0)
					{
						empty = key.Substring(num, key.Length - num);
					}
					IParameterModel parameterModel = (IParameterModel)e.Parameters[key];
					string text2 = parameterModel.Name + empty;
					IAddressValue sourceAddress = parameterModel.DataSource.SourceAddress;
					if (!ValidateParameter(parameterModel))
					{
						continue;
					}
					ICalibration calibration = null;
					IParameterSpecification specification = GetSpecification(text2, sourceAddress, ref calibration);
					DataAccessType dataAccessType = DataAccessType.Proprietary;
					if (PublicDataSource.IsPublicData(text2))
					{
						if (e.IsBroadcast)
						{
							dataAccessType = DataAccessType.PublicDataBroadcast;
							isPublicBroadcast = true;
						}
						else
						{
							dataAccessType = DataAccessType.PublicDataRequestReceive;
						}
					}
					subscription = ((!(calibration is ICalibrationECM) || (AccessModeType.ArrayElement != specification.Type && AccessModeType.Address != specification.Type)) ? GetSubscription(isAddress: false, shouldStop: false, sourceAddress, dataAccessType) : GetSubscription(isAddress: true, shouldStop: false, sourceAddress, dataAccessType));
					if (subscription == null)
					{
						continue;
					}
					if (calibration is ICalibrationDisk)
					{
						if (specification.Type == AccessModeType.Address)
						{
							(subscription as IDiskSubscription).Add(parameterModel.Address, parameterModel.Offset, parameterModel.Length, parameterModel);
						}
						else
						{
							subscription.Add(parameterModel.FullName);
						}
					}
					else if (calibration is ICalibrationECM)
					{
						if (AccessModeType.ArrayElement == specification.Type || AccessModeType.Address == specification.Type)
						{
							SetCoordinates(text2, parameterModel);
							uint length = ((parameterModel is IDataBlockModel) ? 1u : parameterModel.Length);
							(subscription as IECMSubscription).ValidateParameter = !parameterModel.ReadabilityCheckPassed;
							(subscription as IECMSubscription).Add(parameterModel.Address, parameterModel.Offset, length, parameterModel);
						}
						else
						{
							if (subscription is IECMSubscription)
							{
								(subscription as IECMSubscription).ValidateParameter = !parameterModel.ReadabilityCheckPassed;
							}
							subscription.Add(parameterModel.FullName);
						}
					}
					else if (calibration is ICalibrationASAM)
					{
						if (parameterModel.DataType == ParameterType.Value || parameterModel.DataType == ParameterType.Enumeration)
						{
							subscription.Add(parameterModel.FullName);
						}
					}
					else if (calibration is IPublicDataSource)
					{
						subscription.Add(parameterModel.FullName);
					}
				}
				catch (UnableToFindCalibrationException ex)
				{
					EventLogger.Error("Editor", "Fail to add parameter " + key + " could not get the calibration " + ex.ContextData, ex);
				}
				catch (MonitorModeNotSupportedException ex2)
				{
					EventLogger.Error("Editor", "Fail to add parameter " + key + " " + ex2.mode + " is not supported for the calibration " + ex2.ContextData, ex2);
				}
				catch (Exception e2)
				{
					EventLogger.Error("Editor", "Fail to add parameter " + key + " in to the subscription.", e2);
				}
			}
		}

		private IParameterSpecification GetSpecification(string name, IAddressValue sourceAddress, ref ICalibration calibration)
		{
			IParameterSpecification parameterSpecification = null;
			calibration = (ICalibration)DataSources[sourceAddress];
			return calibration.GetSpecification(name);
		}

		public void RemoveParameter(ParameterEventArgs e)
		{
			if (DataSources[e.SourceAddress] is ICalibrationDisk || e.Type == ParameterType.Value || e.Type == ParameterType.Enumeration)
			{
				RemoveParameter(e.FullName, e.SourceAddress, e.DataAccessType);
			}
			else
			{
				RemoveParameter(e.Address, e.Offset, e.Length, e.SourceAddress);
			}
		}

		public void RemoveAll()
		{
			lock (NameSubscriptions)
			{
				foreach (ISubscription value in NameSubscriptions.Values)
				{
					value?.RemoveAll();
				}
			}
			lock (AddressSubscriptions)
			{
				foreach (ISubscription value2 in AddressSubscriptions.Values)
				{
					value2?.RemoveAll();
				}
			}
			lock (PublicDataSubscriptions)
			{
				foreach (ISubscription value3 in PublicDataSubscriptions.Values)
				{
					value3?.RemoveAll();
				}
			}
			if (publicDataBroadcastSubscription != null)
			{
				lock (PublicDataBroadcastSubscription)
				{
					PublicDataBroadcastSubscription.RemoveAll();
				}
			}
		}

		public void RemoveAll(IAddressValue sourceAddress)
		{
			ISubscription subscription = null;
			lock (NameSubscriptions)
			{
				if (NameSubscriptions.Contains(sourceAddress))
				{
					((ISubscription)NameSubscriptions[sourceAddress])?.RemoveAll();
				}
			}
			lock (AddressSubscriptions)
			{
				if (AddressSubscriptions.Contains(sourceAddress))
				{
					((ISubscription)AddressSubscriptions[sourceAddress])?.RemoveAll();
				}
			}
			lock (PublicDataSubscriptions)
			{
				if (PublicDataSubscriptions.Contains(sourceAddress))
				{
					((ISubscription)PublicDataSubscriptions[sourceAddress])?.RemoveAll();
				}
			}
		}

		public abstract void SetRefreshRate(int rate, RefreshUnitsType units);

		public void Start()
		{
			lock (NameSubscriptions)
			{
				foreach (ISubscription value in NameSubscriptions.Values)
				{
					if (value == null)
					{
						continue;
					}
					try
					{
						if (ValidateSubscription(value))
						{
							value.Start();
						}
					}
					catch (ChangeLockNotAcquiredException e)
					{
						EventLogger.Error("Editor", "ChangeLock is required to start monitoring on device address : " + value.SourceAddress.DisplayId, e);
					}
					catch (Exception e2)
					{
						EventLogger.Error("Editor", "Failed to start monitoring on device address : " + value.SourceAddress.DisplayId, e2);
					}
				}
			}
			lock (AddressSubscriptions)
			{
				foreach (ISubscription value2 in AddressSubscriptions.Values)
				{
					if (value2 == null)
					{
						continue;
					}
					try
					{
						if (ValidateSubscription(value2))
						{
							value2.Start();
						}
					}
					catch (ChangeLockNotAcquiredException e3)
					{
						EventLogger.Error("Editor", "ChangeLock is required to start monitoring on device address : " + value2.SourceAddress.DisplayId, e3);
					}
					catch (ChangeRunLocationException)
					{
						EventLogger.Error("Editor", "Failed attempt to switch to development mode. BAM/IDL will not start", " Module must be running from development for BAM/IDL to initiate");
					}
					catch (Exception e4)
					{
						EventLogger.Error("Editor", "Failed to start monitoring on device address : " + value2.SourceAddress.DisplayId, e4);
					}
				}
			}
			lock (PublicDataSubscriptions)
			{
				foreach (ISubscription value3 in PublicDataSubscriptions.Values)
				{
					if (value3 == null)
					{
						continue;
					}
					try
					{
						if (ValidateSubscription(value3))
						{
							value3.Start();
						}
					}
					catch (ChangeLockNotAcquiredException e5)
					{
						EventLogger.Error("Editor", "ChangeLock is required to start monitoring on device address : " + value3.SourceAddress.DisplayId, e5);
					}
					catch (Exception e6)
					{
						EventLogger.Error("Editor", "Failed to start monitoring on device address : " + value3.SourceAddress.DisplayId, e6);
					}
				}
			}
			if (publicDataBroadcastSubscription != null)
			{
				lock (PublicDataBroadcastSubscription)
				{
					try
					{
						if (ValidateSubscription(PublicDataBroadcastSubscription))
						{
							PublicDataBroadcastSubscription.Start();
						}
					}
					catch (ChangeLockNotAcquiredException e7)
					{
						EventLogger.Error("Editor", "ChangeLock is required to start monitoring on device address : " + PublicDataBroadcastSubscription.SourceAddress.DisplayId, e7);
					}
					catch (Exception e8)
					{
						EventLogger.Error("Editor", "Failed to start monitoring on device address : " + PublicDataBroadcastSubscription.SourceAddress.DisplayId, e8);
					}
				}
			}
			IsMonitoring = true;
		}

		public void Start(IAddressValue sourceAddress)
		{
			ISubscription subscription = null;
			lock (NameSubscriptions)
			{
				if (NameSubscriptions.Contains(sourceAddress))
				{
					subscription = (ISubscription)NameSubscriptions[sourceAddress];
					if (subscription != null)
					{
						try
						{
							if (ValidateSubscription(subscription))
							{
								subscription.Start();
							}
						}
						catch (Exception e)
						{
							EventLogger.Error("Editor", "Failed to start monitoring on device address : " + sourceAddress.DisplayId, e);
						}
					}
				}
			}
			lock (AddressSubscriptions)
			{
				if (AddressSubscriptions.Contains(sourceAddress))
				{
					subscription = (ISubscription)AddressSubscriptions[sourceAddress];
					if (subscription != null)
					{
						try
						{
							if (ValidateSubscription(subscription))
							{
								subscription.Start();
							}
						}
						catch (Exception e2)
						{
							EventLogger.Error("Editor", "Failed to start monitoring on device address : " + sourceAddress.DisplayId, e2);
						}
					}
				}
			}
			lock (PublicDataSubscriptions)
			{
				if (PublicDataSubscriptions.Contains(sourceAddress))
				{
					subscription = (ISubscription)PublicDataSubscriptions[sourceAddress];
					if (subscription != null)
					{
						try
						{
							if (ValidateSubscription(subscription))
							{
								subscription.Start();
							}
						}
						catch (Exception e3)
						{
							EventLogger.Error("Editor", "Failed to start monitoring on device address : " + sourceAddress.DisplayId, e3);
						}
					}
				}
			}
			if (publicDataBroadcastSubscription != null)
			{
				lock (PublicDataBroadcastSubscription)
				{
					try
					{
						if (ValidateSubscription(PublicDataBroadcastSubscription))
						{
							PublicDataBroadcastSubscription.Start();
						}
					}
					catch (ChangeLockNotAcquiredException e4)
					{
						EventLogger.Error("Editor", "ChangeLock is required to start monitoring on device address : " + PublicDataBroadcastSubscription.SourceAddress.DisplayId, e4);
					}
					catch (Exception e5)
					{
						EventLogger.Error("Editor", "Failed to start monitoring on device address : " + PublicDataBroadcastSubscription.SourceAddress.DisplayId, e5);
					}
				}
			}
			IsMonitoring = true;
		}

		public void Stop()
		{
			lock (NameSubscriptions)
			{
				foreach (ISubscription value in NameSubscriptions.Values)
				{
					if (value != null)
					{
						try
						{
							value.Stop();
						}
						catch (Exception e)
						{
							EventLogger.Error("Editor", "Failed to stop monitoring on device address : " + value.SourceAddress.DisplayId, e);
						}
					}
				}
			}
			lock (AddressSubscriptions)
			{
				foreach (ISubscription value2 in AddressSubscriptions.Values)
				{
					if (value2 != null)
					{
						try
						{
							value2.Stop();
						}
						catch (Exception e2)
						{
							EventLogger.Error("Editor", "Failed to stop monitoring on device address : " + value2.SourceAddress.DisplayId, e2);
						}
					}
				}
			}
			lock (PublicDataSubscriptions)
			{
				foreach (ISubscription value3 in PublicDataSubscriptions.Values)
				{
					if (value3 != null)
					{
						try
						{
							value3.Stop();
						}
						catch (Exception e3)
						{
							EventLogger.Error("Editor", "Failed to stop monitoring on device address : " + value3.SourceAddress.DisplayId, e3);
						}
					}
				}
			}
			if (publicDataBroadcastSubscription != null)
			{
				lock (PublicDataBroadcastSubscription)
				{
					try
					{
						PublicDataBroadcastSubscription.Stop();
					}
					catch (Exception e4)
					{
						EventLogger.Error("Editor", "Failed to stop monitoring on device address : " + PublicDataBroadcastSubscription.SourceAddress.DisplayId, e4);
					}
				}
			}
			IsMonitoring = false;
		}

		public ArrayList Stop(IAddressValue sourceAddress)
		{
			ISubscription subscription = null;
			ArrayList arrayList = new ArrayList();
			lock (NameSubscriptions)
			{
				if (NameSubscriptions.Contains(sourceAddress))
				{
					subscription = (ISubscription)NameSubscriptions[sourceAddress];
					if (subscription != null)
					{
						try
						{
							subscription.Stop();
							arrayList.Add(subscription);
						}
						catch (Exception e)
						{
							EventLogger.Error("Editor", "Failed to stop monitoring on device address : " + sourceAddress.DisplayId, e);
						}
					}
				}
			}
			lock (AddressSubscriptions)
			{
				if (AddressSubscriptions.Contains(sourceAddress))
				{
					subscription = (ISubscription)AddressSubscriptions[sourceAddress];
					if (subscription != null)
					{
						try
						{
							subscription.Stop();
							arrayList.Add(subscription);
						}
						catch (Exception e2)
						{
							EventLogger.Error("Editor", "Failed to stop monitoring on device address : " + sourceAddress.DisplayId, e2);
						}
					}
				}
			}
			IsMonitoring = GetSubscriptionsStatus;
			return arrayList;
		}

		public void Pause()
		{
			lock (NameSubscriptions)
			{
				foreach (ISubscription value in NameSubscriptions.Values)
				{
					if (value != null)
					{
						PauseSubscription(value);
					}
				}
			}
			lock (AddressSubscriptions)
			{
				foreach (ISubscription value2 in AddressSubscriptions.Values)
				{
					if (value2 != null)
					{
						PauseSubscription(value2);
					}
				}
			}
			lock (PublicDataSubscriptions)
			{
				foreach (ISubscription value3 in PublicDataSubscriptions.Values)
				{
					if (value3 != null)
					{
						PauseSubscription(value3);
					}
				}
			}
			if (publicDataBroadcastSubscription != null)
			{
				lock (PublicDataBroadcastSubscription)
				{
					PauseSubscription(PublicDataBroadcastSubscription);
				}
			}
			IsMonitoring = false;
		}

		public ArrayList Pause(IAddressValue sourceAddress)
		{
			ArrayList arrayList = new ArrayList();
			lock (NameSubscriptions)
			{
				if (NameSubscriptions.Contains(sourceAddress))
				{
					ISubscription subscription = (ISubscription)NameSubscriptions[sourceAddress];
					if (subscription != null)
					{
						PauseSubscription(subscription);
						arrayList.Add(subscription);
					}
				}
			}
			lock (AddressSubscriptions)
			{
				if (AddressSubscriptions.Contains(sourceAddress))
				{
					ISubscription subscription2 = (ISubscription)AddressSubscriptions[sourceAddress];
					if (subscription2 != null)
					{
						PauseSubscription(subscription2);
						arrayList.Add(subscription2);
					}
				}
			}
			lock (PublicDataSubscriptions)
			{
				if (PublicDataSubscriptions.Contains(sourceAddress))
				{
					ISubscription subscription3 = (ISubscription)PublicDataSubscriptions[sourceAddress];
					if (subscription3 != null)
					{
						PauseSubscription(subscription3);
						arrayList.Add(subscription3);
					}
				}
			}
			IsMonitoring = GetSubscriptionsStatus;
			return arrayList;
		}

		public void Resume()
		{
			lock (NameSubscriptions)
			{
				foreach (ISubscription value in NameSubscriptions.Values)
				{
					if (value != null)
					{
						ResumeSubscription(value);
					}
				}
			}
			lock (AddressSubscriptions)
			{
				foreach (ISubscription value2 in AddressSubscriptions.Values)
				{
					if (value2 != null)
					{
						ResumeSubscription(value2);
					}
				}
			}
			lock (PublicDataSubscriptions)
			{
				foreach (ISubscription value3 in PublicDataSubscriptions.Values)
				{
					if (value3 != null)
					{
						ResumeSubscription(value3);
					}
				}
			}
			if (publicDataBroadcastSubscription != null)
			{
				lock (PublicDataBroadcastSubscription)
				{
					ResumeSubscription(PublicDataBroadcastSubscription);
				}
			}
			IsMonitoring = true;
		}

		public void Resume(IAddressValue sourceAddress)
		{
			ISubscription subscription = null;
			lock (NameSubscriptions)
			{
				if (NameSubscriptions.Contains(sourceAddress))
				{
					subscription = (ISubscription)NameSubscriptions[sourceAddress];
					if (subscription != null)
					{
						ResumeSubscription(subscription);
					}
				}
			}
			lock (AddressSubscriptions)
			{
				if (AddressSubscriptions.Contains(sourceAddress))
				{
					subscription = (ISubscription)AddressSubscriptions[sourceAddress];
					if (subscription != null)
					{
						ResumeSubscription(subscription);
					}
				}
			}
			lock (PublicDataSubscriptions)
			{
				if (PublicDataSubscriptions.Contains(sourceAddress))
				{
					subscription = (ISubscription)PublicDataSubscriptions[sourceAddress];
					if (subscription != null)
					{
						ResumeSubscription(subscription);
					}
				}
			}
			IsMonitoring = true;
		}

		public void ClearSubscription(IAddressValue deviceAddress)
		{
			lock (NameSubscriptions)
			{
				if (NameSubscriptions.Contains(deviceAddress))
				{
					ClearSubscription((ISubscription)NameSubscriptions[deviceAddress]);
				}
				NameSubscriptions.Remove(deviceAddress);
			}
			lock (AddressSubscriptions)
			{
				if (AddressSubscriptions.Contains(deviceAddress))
				{
					ClearSubscription((ISubscription)AddressSubscriptions[deviceAddress]);
				}
				AddressSubscriptions.Remove(deviceAddress);
			}
			lock (PublicDataSubscriptions)
			{
				if (PublicDataSubscriptions.Contains(deviceAddress))
				{
					ClearSubscription((ISubscription)PublicDataSubscriptions[deviceAddress]);
				}
				PublicDataSubscriptions.Remove(deviceAddress);
			}
			IsMonitoring = GetSubscriptionsStatus;
		}

		public void ClearAllSubscriptions()
		{
			lock (NameSubscriptions)
			{
				foreach (ISubscription value in NameSubscriptions.Values)
				{
					if (value != null)
					{
						ClearSubscription(value);
					}
				}
				NameSubscriptions.Clear();
			}
			lock (AddressSubscriptions)
			{
				foreach (ISubscription value2 in AddressSubscriptions.Values)
				{
					if (value2 != null)
					{
						ClearSubscription(value2);
					}
				}
				AddressSubscriptions.Clear();
			}
			lock (PublicDataSubscriptions)
			{
				foreach (ISubscription value3 in PublicDataSubscriptions.Values)
				{
					if (value3 != null)
					{
						ClearSubscription(value3);
					}
				}
				PublicDataSubscriptions.Clear();
			}
			if (publicDataBroadcastSubscription != null)
			{
				lock (PublicDataBroadcastSubscription)
				{
					ClearSubscription(PublicDataBroadcastSubscription);
					PublicDataBroadcastSubscription = null;
				}
			}
			IsMonitoring = false;
		}

		protected ISubscription GetNameSubscription(IAddressValue sourceAddress)
		{
			ISubscription subscription;
			if (NameSubscriptions.Contains(sourceAddress))
			{
				subscription = (ISubscription)NameSubscriptions[sourceAddress];
			}
			else
			{
				subscription = CreateSubscription(sourceAddress);
				NameSubscriptions.Add(sourceAddress, subscription);
			}
			return subscription;
		}

		protected ISubscription GetPublicDataSubscription(IAddressValue sourceAddress, DataAccessType dataAccessType)
		{
			ISubscription subscription = null;
			if (dataAccessType == DataAccessType.PublicDataRequestReceive)
			{
				if (PublicDataSubscriptions.Contains(sourceAddress))
				{
					subscription = (ISubscription)PublicDataSubscriptions[sourceAddress];
				}
				else
				{
					subscription = CreatePublicDataSubscription(sourceAddress);
					PublicDataSubscriptions.Add(sourceAddress, subscription);
				}
			}
			else
			{
				subscription = PublicDataBroadcastSubscription;
			}
			return subscription;
		}

		protected ISubscription GetAddressSubscription(IAddressValue sourceAddress)
		{
			ISubscription subscription;
			if (AddressSubscriptions.Contains(sourceAddress))
			{
				subscription = (ISubscription)AddressSubscriptions[sourceAddress];
			}
			else
			{
				subscription = CreateSubscription(sourceAddress);
				AddressSubscriptions.Add(sourceAddress, subscription);
			}
			return subscription;
		}

		protected virtual void PauseSubscription(ISubscription subscription)
		{
			if (subscription is IPausable)
			{
				(subscription as IPausable).Pause();
			}
		}

		protected virtual void ResumeSubscription(ISubscription subscription)
		{
			if (subscription is IPausable)
			{
				(subscription as IPausable).Resume();
			}
		}

		protected void SetCoordinates(string parameterName, IParameterModel parameter)
		{
			IParameterSpecification parameterSpecification = null;
			ICalibration dataSource = parameter.DataSource;
			if (dataSource == null)
			{
				return;
			}
			parameterSpecification = dataSource.GetSpecification(parameterName);
			if (parameterSpecification != null)
			{
				if (parameter is IArray2DModel)
				{
					((IArray2DModel)parameter).SetCurrentLocation(parameterSpecification.X, parameterSpecification.Y);
				}
				else if (parameter is IDataBlockModel)
				{
					IDataBlockModel dataBlockModel = (IDataBlockModel)parameter;
					dataBlockModel.X = parameterSpecification.X;
				}
				else if (parameter is IArray1DModel)
				{
					IArray1DModel array1DModel = (IArray1DModel)parameter;
					array1DModel.X = parameterSpecification.X;
				}
			}
		}

		protected bool ValidateChangeLock(ICalibrationOnline calibration)
		{
			bool result = true;
			if (calibration is ICalibrationECM && calibration.CalibrationDataServer.GTISLevel == GTISVersion.GTIS45)
			{
				result = (calibration as ICalibrationECM).CanEdit;
			}
			return result;
		}

		protected void AcquireChangeLock(ICalibrationECM calibration)
		{
			string message = "Change lock is not acquired for module with source address " + calibration.SourceAddress.DisplayId + ". Do you want to execute Request Change Lock command to set the BAM/EDM mode?";
			MsgBoxResult msgBoxResult = MsgBox.Show(message, "Editor", MsgBoxButtons.YesNo, MsgBoxIcon.Question);
			if (msgBoxResult == MsgBoxResult.Yes)
			{
				ExecutionResult executionResult = default(ExecutionResult);
				if (CommandReturnType.Failed == calibration.Execute(Cummins.Calibration.CommandType.RequestChangeLock).returnCode)
				{
					throw new ChangeLockNotAcquiredException(Facility.Editor, 3, "Could not acquire the change Lock", calibration.SourceAddress.DisplayId);
				}
				return;
			}
			throw new ChangeLockNotAcquiredException(Facility.Editor, 3, "Could not acquire the change Lock", calibration.SourceAddress.DisplayId);
		}

		protected int Convert(int fromRate, RefreshUnitsType toUnits, RefreshUnitsType fromUnits)
		{
			int result = fromRate;
			int num = fromRate;
			switch (fromUnits)
			{
			case RefreshUnitsType.Hertz:
				if (fromRate != 0)
				{
					num = 1000 / fromRate;
				}
				break;
			case RefreshUnitsType.Milliseconds:
				num = fromRate;
				break;
			}
			switch (toUnits)
			{
			case RefreshUnitsType.Hertz:
				if (num != 0)
				{
					result = 1000 / num;
				}
				break;
			case RefreshUnitsType.Milliseconds:
				result = num;
				break;
			}
			return result;
		}

		protected void OnDataRefresh(object sender, DataRefreshEventArgs e)
		{
			if (this.Notification != null)
			{
				this.Notification(this, e);
			}
		}

		protected virtual void OnRunLocationChange(object sender, RunLocationChangeEventArgs args)
		{
			ISecurityService securityService = (ISecurityService)ServiceManager.Services.GetService(typeof(ISecurityService));
			if (securityService == null)
			{
				return;
			}
			if (!securityService.IsFeatureSelected(Cummins.CalToolsLib.SelectableFeatures.TemporaryWritestoSecureModules.ToString()))
			{
				if (this.RunLocationChange != null)
				{
					this.RunLocationChange(this, args);
				}
			}
			else
			{
				args.ReturnType = InteropMessageReturnType.No;
				EventLogger.Error("Editor", Editor.ResourceManager.GetString(EditorMessageIDs.BAMNotInDevelopmentMode.ToString()));
			}
		}

		protected void OnConnectionLost(object sender, ConnectionEventArgs e)
		{
			if (this.ConnectionLost != null)
			{
				this.ConnectionLost(this, e);
			}
		}

		protected void OnPerformanceUpdate(object sender, PerformanceEventArgs e)
		{
			if (this.PerformanceStatistics != null)
			{
				this.PerformanceStatistics(this, e);
			}
		}

		protected void OnStopBroadCast(object sender, StopBroadCastEventArgs e)
		{
			if (this.StopBroadCast != null)
			{
				this.StopBroadCast(this, e);
			}
		}

		protected void OnLastParameterRemoved(object sender, EventArgs e)
		{
			ISubscription subscription = sender as ISubscription;
			int iD = (sender as IDataProvider).ID;
			ClearSubscription(subscription);
			if (AddressSubscriptions.Contains(subscription.SourceAddress))
			{
				foreach (ISubscription value in AddressSubscriptions.Values)
				{
					if (value.GetHashCode() == iD)
					{
						AddressSubscriptions.Remove(subscription.SourceAddress);
						break;
					}
				}
			}
			if (NameSubscriptions.Contains(subscription.SourceAddress))
			{
				foreach (ISubscription value2 in NameSubscriptions.Values)
				{
					if (value2.GetHashCode() == iD)
					{
						NameSubscriptions.Remove(subscription.SourceAddress);
						break;
					}
				}
			}
			if (PublicDataSubscriptions.Contains(subscription.SourceAddress))
			{
				foreach (ISubscription value3 in PublicDataSubscriptions.Values)
				{
					if (value3.GetHashCode() == iD)
					{
						PublicDataSubscriptions.Remove(value3.SourceAddress);
						break;
					}
				}
			}
			RaiseSubscriptionRemoved(iD);
		}

		protected virtual bool ValidateParameter(IParameterModel parameter)
		{
			bool flag = true;
			if (parameter != null)
			{
				ParameterEventArgs e = new ParameterEventArgs();
				e.Name = parameter.Name;
				e.FullName = parameter.FullName;
				e.Units = parameter.EngineeringUnits;
				e.SourceAddress = parameter.DataSource.SourceAddress;
				e.Type = parameter.DataType;
				e.Offset = parameter.Offset;
				e.Length = parameter.Length;
				e.ParameterModel = parameter;
				e.ReadabilityCheckPassed = parameter.ReadabilityCheckPassed;
				if (parameter is IDataBlockModel)
				{
					e.Length = 1u;
				}
				try
				{
					if (parameter.DataType != ParameterType.Value && parameter.DataType != ParameterType.Enumeration)
					{
						e.Address = parameter.Address;
					}
				}
				catch
				{
					e.Address = 0u;
				}
				return ValidateParameter(e);
			}
			return false;
		}

		protected abstract ISubscription CreateSubscription(IAddressValue sourceAddress);

		protected virtual ISubscription CreatePublicDataSubscription(IAddressValue sourceAddress)
		{
			ISubscription subscription = null;
			ICalibration calibration = (ICalibration)Network.Modules[sourceAddress];
			if (calibration != null)
			{
				subscription = SubscriptionProvider.Create(calibration, DataAcquisitionType.PublicRequestReceive, NotifyType.Message);
				subscription.BaseRate = Convert(DataRefreshRate, RefreshUnitsType.Milliseconds, DataRefreshUnit);
				subscription.Notification += OnDataRefresh;
				subscription.LastParameterRemoved += OnLastParameterRemoved;
				if (IsMonitoring)
				{
					subscription.Start();
				}
				return subscription;
			}
			throw new UnableToFindCalibrationException(Facility.Editor, 1, "Could Not get the calibration", sourceAddress.ToString());
		}

		protected virtual bool ValidateParameter(ParameterEventArgs e)
		{
			bool result = true;
			if (!e.ReadabilityCheckPassed)
			{
				result = false;
				string message = string.Format(Editor.ResourceManager.GetString(EditorMessageIDs.CanNotValidateParameter.ToString()), e.SourceAddress.Value, e.Name);
				EventLogger.Error("Editor", message);
			}
			return result;
		}

		protected abstract bool ValidateSubscription(ISubscription subscription);

		protected abstract ISubscription GetSubscription(bool isAddress, bool shouldStop, IAddressValue sourceAddress, DataAccessType dataAccessType);

		protected virtual void RaiseMonitorStatusChangedEvent()
		{
			if (this.MonitorStatusChangedEvent != null)
			{
				this.MonitorStatusChangedEvent(this, EventArgs.Empty);
			}
		}

		private void ClearSubscription(ISubscription subscription)
		{
			if (subscription != null)
			{
				ClearSubscriptionEvents(subscription);
				subscription.Dispose();
				if (publicDataBroadcastSubscription == subscription)
				{
					publicDataBroadcastSubscription = null;
				}
			}
		}

		private void ClearSubscriptionEvents(ISubscription subscription)
		{
			if (subscription != null)
			{
				if (subscription is IECMSubscription)
				{
					IECMSubscription iECMSubscription = subscription as IECMSubscription;
					iECMSubscription.ConnectionLost -= OnConnectionLost;
					iECMSubscription.PerformanceStatistics -= OnPerformanceUpdate;
					iECMSubscription.RunLocationChange -= OnRunLocationChange;
					iECMSubscription.StopBroadCast -= OnStopBroadCast;
				}
				subscription.Notification -= OnDataRefresh;
				subscription.LastParameterRemoved -= OnLastParameterRemoved;
			}
		}

		private void AddParameter(string parameterName, IAddressValue sourceAddress, bool ReadabilityCheckPassed, bool startMonitor, DataAccessType dataAccessType)
		{
			ISubscription subscription = null;
			try
			{
				subscription = GetSubscription(isAddress: false, shouldStop: true, sourceAddress, dataAccessType);
				if (subscription == null)
				{
					return;
				}
				if (subscription is IECMSubscription)
				{
					(subscription as IECMSubscription).ValidateParameter = !ReadabilityCheckPassed;
				}
				subscription.Add(parameterName);
				if (startMonitor && !subscription.IsStarted)
				{
					try
					{
						subscription.Start();
						return;
					}
					catch
					{
						return;
					}
				}
			}
			catch (UnableToFindCalibrationException ex)
			{
				EventLogger.Error("Editor", "Fail to add parameter " + parameterName + " could not get the calibration " + ex.ContextData, ex);
			}
			catch (MonitorModeNotSupportedException ex2)
			{
				EventLogger.Error("Editor", "Fail to add parameter " + parameterName + ex2.mode + " is not supported for the calibration " + ex2.ContextData, ex2);
			}
			catch (ChangeRunLocationException)
			{
				EventLogger.Error("Editor", "Failed attempt to switch to development mode. BAM/IDL will not start", " Module must be running from development for BAM/IDL to initiate.");
			}
			catch (Exception e)
			{
				EventLogger.Error("Editor", "Fail to add parameter " + parameterName + " in to the subscription.", e);
			}
		}

		private void AddParameter(uint address, int offset, uint length, IAddressValue sourceAddress, IParameterModel paramModel, bool startMonitoring)
		{
			ISubscription subscription = null;
			try
			{
				subscription = GetSubscription(isAddress: true, shouldStop: true, sourceAddress, DataAccessType.Proprietary);
				if (subscription == null)
				{
					return;
				}
				if (subscription is IECMSubscription)
				{
					(subscription as IECMSubscription).ValidateParameter = !paramModel.ReadabilityCheckPassed;
					(subscription as IECMSubscription).Add(address, offset, length, paramModel);
					if (startMonitoring && !subscription.IsStarted)
					{
						try
						{
							subscription.Start();
							return;
						}
						catch
						{
							return;
						}
					}
				}
				else if (subscription is IDiskSubscription)
				{
					(subscription as IDiskSubscription).Add(address, offset, length, paramModel);
				}
			}
			catch (UnableToFindCalibrationException ex)
			{
				EventLogger.Error("Editor", "Fail to add address " + address.ToString("X2") + " could not get the calibration " + ex.ContextData, ex);
			}
			catch (MonitorModeNotSupportedException ex2)
			{
				EventLogger.Error("Editor", "Fail to add address " + address.ToString("X2") + ex2.mode + " is not supported for the calibration " + ex2.ContextData, ex2);
			}
			catch (ChangeRunLocationException)
			{
				EventLogger.Error("Editor", "Failed attempt to switch to development mode. BAM/IDL will not start", " Module must be running from development for BAM/IDL to initiate.");
			}
			catch (Exception e)
			{
				EventLogger.Error("Editor", "Fail to add address " + address.ToString("X2") + " in to the subscription.", e);
			}
		}

		private void RemoveParameter(string parameterName, IAddressValue sourceAddress, DataAccessType dataAccessType)
		{
			try
			{
				ISubscription subscription = GetSubscription(isAddress: false, shouldStop: false, sourceAddress, dataAccessType);
				bool isStarted = subscription.IsStarted;
				if (subscription.IsStarted)
				{
					subscription.Stop();
				}
				if (subscription == null)
				{
					return;
				}
				subscription.Remove(parameterName);
				if (subscription.IsActive)
				{
					return;
				}
				try
				{
					if (isStarted)
					{
						subscription.Start();
					}
				}
				catch (Exception)
				{
				}
			}
			catch (Exception e)
			{
				EventLogger.Error("Editor", "Fail to remove parameter" + parameterName + " in to the subscription.", e);
			}
		}

		private void RemoveParameter(uint address, int offset, uint length, IAddressValue sourceAddress)
		{
			ISubscription subscription = null;
			try
			{
				subscription = GetSubscription(isAddress: true, shouldStop: false, sourceAddress, DataAccessType.Proprietary);
				bool isStarted = subscription.IsStarted;
				if (subscription.IsStarted)
				{
					subscription.Stop();
				}
				if (subscription == null)
				{
					return;
				}
				subscription.Remove(address, offset, length);
				if (subscription.IsActive)
				{
					return;
				}
				try
				{
					if (isStarted)
					{
						subscription.Start();
					}
				}
				catch (Exception)
				{
				}
			}
			catch (Exception e)
			{
				EventLogger.Error("Editor", "Fail to remove address" + address + " in to the subscription.", e);
			}
		}

		private void RaiseSubscriptionRemoved(int hashcode)
		{
			if (this.SubscriptionRemoved != null)
			{
				SubscriptionRemovedEventArgument subscriptionRemovedEventArgument = new SubscriptionRemovedEventArgument();
				subscriptionRemovedEventArgument.HashCode = hashcode;
				this.SubscriptionRemoved(this, subscriptionRemovedEventArgument);
			}
		}
	}
	internal class BAMMonitor : Monitor
	{
		private const string BAMCaption = "BAM Monitor";

		private const int FastestRateMultiplier = 1;

		private TriggerType triggerMode;

		private bool changedRunLocation;

		private bool allowTempWrites;

		public TriggerType TriggerMode
		{
			get
			{
				return triggerMode;
			}
			set
			{
				if (value == triggerMode)
				{
					return;
				}
				TriggerType triggerType = ((GTISVersion.GTIS45 == base.Network.GTISLevel) ? TriggerType.Clock : TriggerType.ForeGroundActivated);
				if (Enum.IsDefined(typeof(TriggerType), value.ToString()))
				{
					try
					{
						triggerType = ((GTISVersion.GTIS45 != base.Network.GTISLevel) ? ((TriggerType)(BAMPre45TriggerType)Enum.Parse(typeof(BAMPre45TriggerType), value.ToString(), ignoreCase: true)) : ((TriggerType)(BAM45TriggerType)Enum.Parse(typeof(BAM45TriggerType), value.ToString(), ignoreCase: true)));
					}
					catch (Exception)
					{
					}
				}
				lock (base.NameSubscriptions)
				{
					foreach (ISubscription value2 in base.NameSubscriptions.Values)
					{
						if (value2 is IECMSubscription)
						{
							(value2 as IECMSubscription).TriggerMode = triggerType;
						}
					}
				}
				lock (base.AddressSubscriptions)
				{
					foreach (ISubscription value3 in base.AddressSubscriptions.Values)
					{
						if (value3 is IECMSubscription)
						{
							(value3 as IECMSubscription).TriggerMode = triggerType;
						}
					}
				}
				triggerMode = triggerType;
			}
		}

		public BAMMonitor(IModuleNetwork network)
			: base(network)
		{
			ISecurityService securityService = (ISecurityService)ServiceManager.Services.GetService(typeof(ISecurityService));
			if (securityService != null)
			{
				allowTempWrites = securityService.IsFeatureSelected(Cummins.CalToolsLib.SelectableFeatures.TemporaryWritestoSecureModules.ToString());
			}
		}

		public override void SetRefreshRate(int rate, RefreshUnitsType units)
		{
			int num = 5;
			int num2 = 1;
			if (TriggerMode == TriggerType.Clock || TriggerMode == TriggerType.Frame || TriggerMode == TriggerType.ForeGroundActivated)
			{
				num = GetMaxBaseRate();
				num2 = Convert(rate, RefreshUnitsType.Milliseconds, units) / num;
			}
			else
			{
				num2 = rate;
			}
			if (num2 < 1)
			{
				num2 = 1;
			}
			if (TriggerMode == TriggerType.Clock || TriggerMode == TriggerType.Frame || TriggerMode == TriggerType.ForeGroundActivated)
			{
				dataRefreshRate = Convert(num2 * num, units, RefreshUnitsType.Milliseconds);
			}
			else
			{
				dataRefreshRate = num2;
			}
			dataRefreshUnit = units;
			lock (base.NameSubscriptions)
			{
				foreach (ISubscription value in base.NameSubscriptions.Values)
				{
					if (value != null)
					{
						if (value is IECMSubscription)
						{
							(value as IECMSubscription).RateMultiplier = num2;
						}
						else
						{
							value.BaseRate = rate;
						}
					}
				}
			}
			lock (base.AddressSubscriptions)
			{
				foreach (ISubscription value2 in base.AddressSubscriptions.Values)
				{
					if (value2 != null && value2 is IECMSubscription)
					{
						(value2 as IECMSubscription).RateMultiplier = num2;
					}
				}
			}
		}

		protected override void PauseSubscription(ISubscription subscription)
		{
			if (subscription is IPausable)
			{
				(subscription as IPausable).Pause();
			}
		}

		protected override void ResumeSubscription(ISubscription subscription)
		{
			if (subscription is IPausable)
			{
				(subscription as IPausable).Resume();
			}
		}

		protected override bool ValidateParameter(ParameterEventArgs e)
		{
			bool flag = true;
			flag = base.ValidateParameter(e);
			if (flag)
			{
				if (e.Name.StartsWith("_"))
				{
					flag = false;
					EventLogger.Error("Editor", "Fail to monitor the parameter " + e.Name + " " + DataAcquisitionType.BAM.ToString() + " does not supports Interface parameters.");
				}
				else if (e.Type != ParameterType.Value && e.Type != ParameterType.Enumeration)
				{
					ICalibration calibration = (ICalibration)base.DataSources[e.SourceAddress];
					if (calibration != null)
					{
						IDataCollectorInfo dataCollectorInfo = new DataCollectorInfo(calibration.CalibrationDataServer);
						if (calibration.CalibrationDataServer.GTISLevel == GTISVersion.GTIS45 && dataCollectorInfo.DataCollectorType == DataCollectorType.DataCollector1)
						{
							flag = false;
							EventLogger.Error("Editor", "Fail to monitor the address " + e.Name.ToString() + " " + DataAcquisitionType.BAM.ToString() + " does not supports address for the GTIS 4.5 calibration " + e.SourceAddress.ToString());
						}
					}
					if (flag && !ValidateRunLocation(calibration as ICalibrationOnline))
					{
						flag = false;
					}
				}
			}
			return flag;
		}

		protected override bool ValidateSubscription(ISubscription subscription)
		{
			bool flag = true;
			if (subscription is PCLSubscriptionBase)
			{
				return true;
			}
			ICalibrationOnline calibrationOnline = (ICalibrationOnline)subscription.DataSource;
			if (calibrationOnline != null)
			{
				if (!ValidateChangeLock(calibrationOnline))
				{
					flag = false;
					AcquireChangeLock(calibrationOnline as ICalibrationECM);
				}
				if (!ValidateRunLocation(calibrationOnline as ICalibrationECM))
				{
					flag = false;
				}
				return true;
			}
			return false;
		}

		protected override ISubscription GetSubscription(bool IsAddress, bool shouldStop, IAddressValue sourceAddress, DataAccessType dataAccessType)
		{
			ISubscription subscription = null;
			if (dataAccessType == DataAccessType.Proprietary)
			{
				subscription = GetNameSubscription(sourceAddress);
				if (subscription != null && shouldStop)
				{
					subscription.Stop();
				}
			}
			else
			{
				subscription = GetPublicDataSubscription(sourceAddress, dataAccessType);
			}
			return subscription;
		}

		protected override ISubscription CreateSubscription(IAddressValue sourceAddress)
		{
			ISubscription subscription = null;
			ICalibration calibration = (ICalibration)base.DataSources[sourceAddress];
			if (calibration != null)
			{
				if (calibration is ICalibrationASAM)
				{
					EventLogger.Warn("BAMHandler", "BAM not supported for ASAM Calibration at address " + sourceAddress.ToString() + ". Monitoring will continue in Request/Receive mode");
				}
				else if (calibration is ICalibrationDisk)
				{
					EventLogger.Warn("BAMHandler", "BAM not supported for Disk Calibration at address. Monitoring will continue in Request/Receive mode");
				}
				else if (calibration is ICalibrationECM)
				{
					IDataCollectorInfo dataCollectorInfo = new DataCollectorInfo(calibration.CalibrationDataServer);
					if (dataCollectorInfo.DataCollectorType == DataCollectorType.None)
					{
						throw new MonitorModeNotSupportedException(Facility.Editor, 2, "Calibration is not supporting BAM", sourceAddress.ToString(), DataAcquisitionType.BAM.ToString());
					}
				}
				subscription = SubscriptionProvider.Create(calibration, DataAcquisitionType.BAM, NotifyType.Message);
				RegisterEvents(subscription);
				return subscription;
			}
			throw new UnableToFindCalibrationException(Facility.Editor, 1, "Could Not get the calibration", sourceAddress.ToString());
		}

		private void RegisterEvents(ISubscription subscription)
		{
			if (subscription is IECMSubscription)
			{
				IECMSubscription iECMSubscription = subscription as IECMSubscription;
				iECMSubscription.MonitorTimeoutEnabled = base.ConnectionTimeoutEnabled;
				iECMSubscription.MonitorTimeoutFloor = base.ConnectionTimeoutMinimum;
				iECMSubscription.MonitorTimeoutFactor = base.ConnectionTimeoutFactor;
				iECMSubscription.RateMultiplier = Convert(base.DataRefreshRate, RefreshUnitsType.Milliseconds, base.DataRefreshUnit) / GetBaseRate(subscription);
				iECMSubscription.TriggerMode = TriggerMode;
				iECMSubscription.ConnectionLost += base.OnConnectionLost;
				iECMSubscription.PerformanceStatistics += base.OnPerformanceUpdate;
				iECMSubscription.RunLocationChange += OnRunLocationChange;
				iECMSubscription.StopBroadCast += base.OnStopBroadCast;
			}
			subscription.Notification += base.OnDataRefresh;
			subscription.LastParameterRemoved += base.OnLastParameterRemoved;
			subscription.Starting += OnSubscriptionStarting;
			subscription.Started += OnSubscriptionStarted;
			subscription.Stopping += OnSubscriptionStarting;
			subscription.Stopped += OnSubscriptionStopped;
		}

		protected override void OnRunLocationChange(object sender, RunLocationChangeEventArgs args)
		{
			base.OnRunLocationChange(this, args);
			changedRunLocation = args.ReturnType == InteropMessageReturnType.Yes;
		}

		private int GetMaxBaseRate()
		{
			int num = 1;
			int num2 = 1;
			lock (base.NameSubscriptions)
			{
				foreach (ISubscription value in base.NameSubscriptions.Values)
				{
					if (value != null)
					{
						num = GetBaseRate(value);
						if (num > num2)
						{
							num2 = num;
						}
					}
				}
			}
			lock (base.AddressSubscriptions)
			{
				foreach (ISubscription value2 in base.AddressSubscriptions.Values)
				{
					if (value2 != null)
					{
						num = GetBaseRate(value2);
						if (num > num2)
						{
							num2 = num;
						}
					}
				}
				return num2;
			}
		}

		private int GetBaseRate(ISubscription subscription)
		{
			int result = 5;
			if (subscription.DataSource is ICalibrationECM calibrationECM)
			{
				switch (TriggerMode)
				{
				case TriggerType.Clock:
				case TriggerType.Frame:
					result = SubscriptionRateHelper.GetBaseRate((IECMSubscription)subscription, triggerMode);
					break;
				case TriggerType.ForeGroundActivated:
					result = GetBaseRate(calibrationECM.ProductID);
					break;
				default:
					result = 1;
					break;
				}
			}
			return result;
		}

		private int GetBaseRate(string productId)
		{
			int result = 20;
			if (productId != null && productId.Length != 0)
			{
				try
				{
					ICIProductMaster iCIProductMaster = new ProductData();
					ICIProductDetail iCIProductDetail = iCIProductMaster[productId];
					if (base.Network.GetCalibration(base.Network.CurrentDeviceAddress) is ICalibrationECM calibrationECM)
					{
						result = iCIProductDetail.GetDataCollectorBaseRate(calibrationECM.DeviceInfo.Phase);
					}
				}
				catch (Exception)
				{
				}
			}
			return result;
		}

		private bool ValidateRunLocation(ICalibrationOnline calibration)
		{
			bool result = true;
			if (calibration is ICalibrationECM && GTISVersion.GTIS38 != calibration.CalibrationDataServer.GTISLevel)
			{
				_ = 2;
				_ = calibration.CalibrationDataServer.GTISLevel;
			}
			return result;
		}

		private void OnSubscriptionStarting(object sender, EventArgs e)
		{
			ICalibrationOnline calibrationOnline = (ICalibrationOnline)(sender as ISubscription).DataSource;
			if (calibrationOnline is ICalibrationECM)
			{
				ICalibrationECM calibrationECM = (ICalibrationECM)calibrationOnline;
				GTISVersion gTISLevel = calibrationECM.CalibrationDataServer.GTISLevel;
				if ((gTISLevel == GTISVersion.GTIS38 || gTISLevel == GTISVersion.GTIS20) && calibrationECM.Secured == SecurityStatus.Secured && !allowTempWrites)
				{
					(calibrationECM.DataLink as ICPPDataLink).EnableSecurity = true;
				}
			}
		}

		private void OnSubscriptionStarted(object sender, EventArgs e)
		{
			ICalibrationOnline calibrationOnline = (ICalibrationOnline)(sender as ISubscription).DataSource;
			if (calibrationOnline is ICalibrationECM)
			{
				ICalibrationECM calibrationECM = (ICalibrationECM)calibrationOnline;
				GTISVersion gTISLevel = calibrationECM.CalibrationDataServer.GTISLevel;
				if ((gTISLevel == GTISVersion.GTIS38 || gTISLevel == GTISVersion.GTIS20) && calibrationECM.Secured == SecurityStatus.Secured && !allowTempWrites)
				{
					(calibrationECM.DataLink as ICPPDataLink).EnableSecurity = false;
				}
			}
		}

		private void OnSubscriptionStopped(object sender, EventArgs e)
		{
			ICalibrationOnline calibrationOnline = (ICalibrationOnline)(sender as ISubscription).DataSource;
			if (calibrationOnline is ICalibrationECM)
			{
				ICalibrationECM calibrationECM = (ICalibrationECM)calibrationOnline;
				GTISVersion gTISLevel = calibrationECM.CalibrationDataServer.GTISLevel;
				if ((gTISLevel == GTISVersion.GTIS38 || gTISLevel == GTISVersion.GTIS20) && calibrationECM.Secured == SecurityStatus.Secured && !allowTempWrites)
				{
					(calibrationECM.DataLink as ICPPDataLink).EnableSecurity = false;
				}
				if (changedRunLocation)
				{
					calibrationECM.Execute(Cummins.Calibration.CommandType.RunFromDefault);
					EventLogger.Info("Editor", "Change Run Location back to default");
				}
			}
		}
	}
	public class ScreenRemovedEventArgs : EventArgs
	{
		private string screenName;

		private string title;

		public string ScreenName => screenName;

		public string ScreenTitle => title;

		public ScreenRemovedEventArgs(string screenName, string title)
		{
			this.screenName = screenName;
			this.title = title;
		}
	}
	public class ChangeActiveScreenEventArgs : EventArgs
	{
		private Screen screen;

		private Screen previousScreen;

		public Screen NewScreen => screen;

		public Screen PreviousScreen => previousScreen;

		public ChangeActiveScreenEventArgs(Screen newScreen, Screen previousScreen)
		{
			screen = newScreen;
			this.previousScreen = previousScreen;
		}
	}
	public class ScreenAddedEventArgs : EventArgs
	{
		private Screen screen;

		public Screen NewScreen => screen;

		public ScreenAddedEventArgs(Screen newScreen)
		{
			screen = newScreen;
		}
	}
	public class ScreenNameChangingEventArgs : CancelEventArgs
	{
		private string previousTitle = string.Empty;

		private string proposedName = string.Empty;

		private string currentName = string.Empty;

		private string cancelMessage = string.Empty;

		public string PreviousTitle => previousTitle;

		public string ProposedName => proposedName;

		public string CurrentName => currentName;

		public string CancelMessage
		{
			get
			{
				return cancelMessage;
			}
			set
			{
				cancelMessage = value;
			}
		}

		public ScreenNameChangingEventArgs(string proposedName, string currentName, string previousTitle)
		{
			base.Cancel = false;
			this.proposedName = proposedName;
			this.currentName = currentName;
			this.previousTitle = previousTitle;
		}
	}
	public class ScreenNameChangedEventArgs : EventArgs
	{
		private string screenName;

		private string previousScreenName;

		private string newLongScreenName;

		private string previousLongScreenName;

		public string NewScreenName => screenName;

		public string NewLongScreenName => newLongScreenName;

		public string PreviousLongScreenName => previousLongScreenName;

		public string PreviousScreenName => previousScreenName;

		public ScreenNameChangedEventArgs(string newScreenName, string previousScreenName, string title, string previousTitle)
		{
			screenName = newScreenName;
			this.previousScreenName = previousScreenName;
			newLongScreenName = title;
			previousLongScreenName = previousTitle;
		}
	}
	public class ScreenController
	{
		private delegate void MonitorDelegate(IAddressValue deviceAddress);

		private delegate void RefreshRateChangeDelegate(string rate, string unit);

		private delegate void MonitorResumeDelegate();

		private delegate void MonitorPauseDelegate();

		private const int DefaultDataRefreshRate = 20;

		public string dataMonitorRefreshRate;

		private ScreenModel model;

		private IModuleNetwork network;

		public List<J1939_71DataRefreshEventArgs> j1939_71notifications;

		private SortedList notificationList = new SortedList();

		private bool refreshInProgress;

		private MonitoredGroupView groupWithFocus;

		private bool forceUpdate;

		private Monitor monitor;

		private CompositeJ1939_71Data _j1939_71CompositeData;

		private IIntegratedCalibration integratedCalibration;

		public IIntegratedCalibration IntegratedCalibration
		{
			get
			{
				return integratedCalibration;
			}
			set
			{
				if (value != null)
				{
					integratedCalibration = value;
				}
			}
		}

		public DataAcquisitionType MonitorMode
		{
			get
			{
				return Model.MonitorMode;
			}
			set
			{
				DataAcquisitionType monitorMode = Model.MonitorMode;
				if (monitorMode == value)
				{
					return;
				}
				bool isMonitoring = IsMonitoring;
				try
				{
					if (isMonitoring)
					{
						StopMonitoring();
					}
					Model.MonitorMode = value;
					monitor = CreateMonitor();
					if (monitor != null)
					{
						InitializeMonitor(monitor);
					}
				}
				catch (Exception)
				{
					Model.MonitorMode = monitorMode;
					monitor = CreateMonitor();
					if (monitor != null)
					{
						InitializeMonitor(monitor);
					}
				}
				finally
				{
					ValueEnabled = value != DataAcquisitionType.BAM;
					ResynchronizeAllParameters();
					if (isMonitoring)
					{
						StartMonitoring();
					}
				}
			}
		}

		public bool ShowComments
		{
			get
			{
				return Model.ShowComments;
			}
			set
			{
				Model.ShowComments = value;
			}
		}

		public int DefaultDataMonitorRefreshRate => 20;

		public bool ValueEnabled
		{
			set
			{
				foreach (IMonitorElement monitorColumn in Model.MonitorColumns)
				{
					monitorColumn.ValueEnabled = value;
				}
			}
		}

		public TriggerType BAMTriggerMode
		{
			get
			{
				return Model.BAMTriggerMode;
			}
			set
			{
				Model.BAMTriggerMode = value;
				if (monitor is BAMMonitor)
				{
					(Monitor as BAMMonitor).TriggerMode = Model.BAMTriggerMode;
				}
			}
		}

		public bool ConnectionTimeoutEnabled
		{
			get
			{
				return Model.ConnectionTimeoutEnabled;
			}
			set
			{
				Model.ConnectionTimeoutEnabled = value;
				Monitor.ConnectionTimeoutEnabled = value;
			}
		}

		public int ConnectionTimeoutMinimum
		{
			get
			{
				return Model.ConnectionTimeoutMinimum;
			}
			set
			{
				Model.ConnectionTimeoutMinimum = value;
				Monitor.ConnectionTimeoutMinimum = value;
			}
		}

		public int ConnectionTimeoutFactor
		{
			get
			{
				return Model.ConnectionTimeoutFactor;
			}
			set
			{
				Model.ConnectionTimeoutFactor = value;
				Monitor.ConnectionTimeoutFactor = value;
			}
		}

		public int MonitorDataRefreshRate => Model.RequestReceiveRefreshRate;

		public int BAMRefreshRate => Model.BAMRefreshRate;

		public int UIRefreshRate => Model.UIRefreshRate;

		public RefreshUnitsType DataRefreshUnits
		{
			get
			{
				return Model.DataRefreshUnits;
			}
			set
			{
				Model.DataRefreshUnits = value;
			}
		}

		public RefreshUnitsType UIRefreshUnits
		{
			get
			{
				return Model.UIRefreshUnits;
			}
			set
			{
				Model.UIRefreshUnits = value;
			}
		}

		public double ActualMonitorRate
		{
			get
			{
				return Model.ActualMonitorRate;
			}
			set
			{
				double num = value;
				if (DataRefreshUnits != RefreshUnitsType.Milliseconds)
				{
					num = Convert((int)num, Model.DataRefreshUnits, RefreshUnitsType.Milliseconds);
				}
				Model.ActualMonitorRate = num;
			}
		}

		public DataFormat Radix
		{
			get
			{
				return Model.Radix;
			}
			set
			{
				Model.Radix = value;
				forceUpdate = true;
			}
		}

		public bool Restored
		{
			get
			{
				return Model.Restored;
			}
			set
			{
				Model.Restored = value;
			}
		}

		internal bool IsMonitoring => Monitor.IsMonitoring;

		public IModuleNetwork Network
		{
			get
			{
				return network;
			}
			set
			{
				bool isMonitoring = IsMonitoring;
				if (isMonitoring)
				{
					StopMonitoring();
				}
				network = value;
				if (network == null)
				{
					return;
				}
				foreach (MonitoredGroup monitorColumn in Model.MonitorColumns)
				{
					monitorColumn.Calibrations = Network.Modules;
					monitorColumn.CurrentSourceAddress = Network.CurrentDeviceAddress;
				}
				Monitor.Network = value;
				Model.Network = value;
				if (isMonitoring)
				{
					StartMonitoring();
				}
			}
		}

		public ScreenModel Model => model;

		public MonitoredGroupView GroupWithFocus
		{
			get
			{
				if (groupWithFocus == null)
				{
					groupWithFocus = (MonitoredGroupView)((MonitoredGroup)Model.MonitorColumns[0]).DataView;
				}
				return groupWithFocus;
			}
		}

		public int EDMRefreshRate => Model.EDMRefreshRate;

		public bool IsDirty
		{
			get
			{
				bool flag = Model.IsDirty;
				if (!flag)
				{
					foreach (IMonitorElement monitorColumn in Model.MonitorColumns)
					{
						if (monitorColumn != null && monitorColumn is MonitoredGroup && monitorColumn.IsDirty)
						{
							flag = true;
							break;
						}
					}
				}
				return flag;
			}
			set
			{
				Model.IsDirty = value;
				if (value)
				{
					return;
				}
				foreach (IMonitorElement monitorColumn in Model.MonitorColumns)
				{
					if (monitorColumn != null && monitorColumn is MonitoredGroup)
					{
						(monitorColumn as MonitoredGroup).IsDirty = value;
					}
				}
			}
		}

		public ArrayList IDLParametersList
		{
			get
			{
				ArrayList arrayList = new ArrayList();
				foreach (MonitoredGroup monitorColumn in Model.MonitorColumns)
				{
					arrayList.InsertRange(arrayList.Count, monitorColumn.IDLParametersList);
				}
				return arrayList;
			}
		}

		public SortedList NotificationList => notificationList;

		public MonitorScreenType ScreenType => Model.ScreenType;

		public ScreenStatus Status => Model.Status;

		protected Monitor Monitor
		{
			get
			{
				if (monitor == null)
				{
					monitor = CreateMonitor();
					if (monitor != null)
					{
						InitializeMonitor(monitor);
					}
				}
				return monitor;
			}
		}

		private CompositeJ1939_71Data J1939_71CompositeData
		{
			get
			{
				if (_j1939_71CompositeData == null)
				{
					_j1939_71CompositeData = new CompositeJ1939_71Data();
				}
				return _j1939_71CompositeData;
			}
			set
			{
				_j1939_71CompositeData = value;
			}
		}

		public event RunLocationChangeEventHandler RunLocationChange;

		public event StopBroadCastEventHandler StopBroadCast;

		public event ParameterEventHandler ParameterAdded;

		public event ParameterListEventHandler ParameterListAdded;

		public event ParameterEventHandler ParameterRemoved;

		public event ScreenLoadingFailedEventHandler ScreenLoadingFailedEvent;

		public ScreenController(ScreenModel model)
		{
			this.model = model;
			model.MonitorStartedEventHandler += OnMonitoringStarted;
			model.MonitorStoppedEventHandler += OnMonitoringStopped;
			Restored = false;
			GetOptions();
			integratedCalibration = null;
		}

		public void CleanupResources()
		{
			StopMonitoring();
			Monitor.ClearAllSubscriptions();
			RemoveAllColumns();
		}

		public void Initialize(NewDataSet.ScreenRow screenRow)
		{
			Model.Restore(screenRow);
			monitor = CreateMonitor();
			InitializeMonitor(monitor);
		}

		public virtual void Restore(NewDataSet.ScreenRow screenRow)
		{
			if (Restored || screenRow == null || Model.MonitorColumns.Count != 0)
			{
				return;
			}
			NewDataSet.GroupRow[] groupRows = screenRow.GetGroupRows();
			NewDataSet.GroupRow[] array = groupRows;
			foreach (NewDataSet.GroupRow groupRow in array)
			{
				IMonitorElement monitorElement = null;
				monitorElement = AddColumn();
				if (monitorElement != null)
				{
					monitorElement.Radix = Radix;
					monitorElement.Restore(groupRow);
				}
			}
		}

		public void Save(NewDataSet.ScreenRow screenRow)
		{
			SetRefreshRate(dataMonitorRefreshRate, DataRefreshUnits.ToString());
			Model.Save(screenRow);
			foreach (IMonitorElement monitorColumn in Model.MonitorColumns)
			{
				monitorColumn.SaveSession(screenRow);
			}
		}

		public void Cleanse(NewDataSet.ScreenRow screenRow)
		{
			if (screenRow == null)
			{
				return;
			}
			NewDataSet.GroupRow[] groupRows = screenRow.GetGroupRows();
			foreach (NewDataSet.GroupRow groupRow in groupRows)
			{
				StringBuilder stringBuilder = new StringBuilder();
				stringBuilder.Append("Group_Id = '");
				stringBuilder.Append(groupRow["Group_Id"]);
				stringBuilder.Append("'");
				DataRow[] array = groupRow.Table.DataSet.Tables["Parameter"].Select(stringBuilder.ToString());
				for (int j = 0; j < array.Length; j++)
				{
					groupRow.Table.DataSet.Tables["Parameter"].Rows.Remove(array[j]);
				}
				screenRow.Table.DataSet.Tables["Group"].Rows.Remove(groupRow);
			}
		}

		public MonitoredGroup AddColumn()
		{
			//IL_0063: Unknown result type (might be due to invalid IL or missing references)
			//IL_006d: Expected O, but got Unknown
			//IL_00f0: Unknown result type (might be due to invalid IL or missing references)
			//IL_00fa: Expected O, but got Unknown
			MonitoredGroup monitoredGroup = new MonitoredGroup(model.ScreenType);
			if (!(monitoredGroup.DataView is GraphicalMonitoredGroupView))
			{
				GroupDataView groupDataView = monitoredGroup.DataView as GroupDataView;
				((Menu)((Control)groupDataView.Grid).ContextMenu).MenuItems.Add(((Menu)((Control)groupDataView.Grid).ContextMenu).MenuItems.Count, new MenuItem("Add Monitor List", (EventHandler)AddColumn_Click));
				((Menu)((Control)groupDataView.Grid).ContextMenu).MenuItems.Add(((Menu)((Control)groupDataView.Grid).ContextMenu).MenuItems.Count, (MenuItem)(object)new RemoveColumnMenuItem("Delete Monitor List", null, this, monitoredGroup));
				if (IntegratedCalibration != null)
				{
					groupDataView.IntegratedCalibration = IntegratedCalibration;
					((Menu)((Control)groupDataView.Grid).ContextMenu).MenuItems.Add(((Menu)((Control)groupDataView.Grid).ContextMenu).MenuItems.Count, new MenuItem("Parameter Owner", (EventHandler)ParameterOwner_Click));
				}
			}
			monitoredGroup.BuildSomeRows();
			AddColumn(monitoredGroup);
			return monitoredGroup;
		}

		public void AddParameterOwnerContextMenu()
		{
			//IL_0084: Unknown result type (might be due to invalid IL or missing references)
			//IL_008e: Expected O, but got Unknown
			foreach (IMonitorElement monitorColumn in Model.MonitorColumns)
			{
				if (Model.ScreenType == MonitorScreenType.Normal)
				{
					ParameterView dataView = monitorColumn.DataView;
					if (IntegratedCalibration != null)
					{
						dataView.IntegratedCalibration = IntegratedCalibration;
						GroupDataView groupDataView = dataView as GroupDataView;
						((Menu)((Control)groupDataView.Grid).ContextMenu).MenuItems.Add(((Menu)((Control)groupDataView.Grid).ContextMenu).MenuItems.Count, new MenuItem("Parameter Owner", (EventHandler)ParameterOwner_Click));
					}
				}
			}
		}

		protected void ParameterOwner_Click(object sender, EventArgs e)
		{
			if (IntegratedCalibration != null)
			{
				IntegratedCalibration.ShowParameterOwner(IntegratedCalibration.SelectedParameter);
			}
		}

		public virtual void AddColumn(IMonitorElement column)
		{
			if (column == null)
			{
				return;
			}
			Model.AddColumn(column);
			if (column is MonitoredGroup)
			{
				(column as MonitoredGroup).MonitoredGroupModel.ParameterAdded += OnAddParameter;
				(column as MonitoredGroup).MonitoredGroupModel.ParameterListAdded += OnAddParameterList;
				(column as MonitoredGroup).MonitoredGroupModel.ParameterRemoved += OnRemoveParameter;
				(column as MonitoredGroup).MonitoredGroupView.BeforeParameterListAddingEvent += OnBeforeParameterListAddingEvent;
				(column as MonitoredGroup).MonitoredGroupModel.AddPendingChangedEvent += OnAddPendingChangedEvent;
				MonitoredGroupView monitoredGroupView = (MonitoredGroupView)(column as MonitoredGroup).DataView;
				monitoredGroupView.GotFocus += OnDataViewGotFocus;
				if ((column as MonitoredGroup).MonitoredGroupModel is GraphicalMonitoredGroupModel)
				{
					(column as MonitoredGroup).MonitoredGroupModel.UIRefreshRateChangedEvent += OnUIRefreshRateChanged;
				}
				if (Network != null)
				{
					Network.SuspendMonitoringChanged += (column as MonitoredGroup).OnSuspendMonitoringChanged;
					Network.ConnectionLost += (column as MonitoredGroup).OnNetworkConnectionLost;
					Network.ConnectionEstablished += (column as MonitoredGroup).OnNetworkConnectionEstablished;
				}
			}
			column.Calibrations = model.DataSources;
			column.CurrentSourceAddress = model.CurrentSourceAddress;
			column.ShowComments = ShowComments;
		}

		public virtual void RemoveColumn(int columnId)
		{
			IMonitorElement monitorElement = (IMonitorElement)Model.MonitorColumns[columnId];
			if (monitorElement == null)
			{
				return;
			}
			if (monitorElement is MonitoredGroup)
			{
				(monitorElement as MonitoredGroup).MonitoredGroupModel.ParameterAdded -= OnAddParameter;
				(monitorElement as MonitoredGroup).MonitoredGroupModel.ParameterListAdded -= OnAddParameterList;
				(monitorElement as MonitoredGroup).MonitoredGroupModel.ParameterRemoved -= OnRemoveParameter;
				(monitorElement as MonitoredGroup).MonitoredGroupView.BeforeParameterListAddingEvent -= OnBeforeParameterListAddingEvent;
				(monitorElement as MonitoredGroup).MonitoredGroupModel.AddPendingChangedEvent -= OnAddPendingChangedEvent;
				MonitoredGroupView monitoredGroupView = (MonitoredGroupView)(monitorElement as MonitoredGroup).DataView;
				monitoredGroupView.GotFocus -= OnDataViewGotFocus;
				if ((monitorElement as MonitoredGroup).MonitoredGroupModel is GraphicalMonitoredGroupModel)
				{
					(monitorElement as MonitoredGroup).MonitoredGroupModel.UIRefreshRateChangedEvent -= OnUIRefreshRateChanged;
				}
				if (Network != null)
				{
					Network.SuspendMonitoringChanged -= (monitorElement as MonitoredGroup).OnSuspendMonitoringChanged;
					Network.ConnectionLost -= (monitorElement as MonitoredGroup).OnNetworkConnectionLost;
					Network.ConnectionEstablished -= (monitorElement as MonitoredGroup).OnNetworkConnectionEstablished;
				}
			}
			Model.RemoveColumn(columnId);
		}

		public void RemoveAllColumns()
		{
			while (Model.MonitorColumns.Count > 0)
			{
				RemoveColumn(0);
			}
		}

		public void PauseMonitoring()
		{
			Cursor current = Cursor.Current;
			Cursor.Current = Cursors.WaitCursor;
			try
			{
				Monitor.Pause();
				lock (NotificationList)
				{
					NotificationList.Clear();
				}
			}
			catch (Exception e)
			{
				EventLogger.Error("Data Monitor", "Failed to pause monitoring on all devices", e);
			}
			Cursor.Current = current;
		}

		public void PauseMonitoring(IAddressValue sourceAddress)
		{
			Cursor current = Cursor.Current;
			Cursor.Current = Cursors.WaitCursor;
			try
			{
				ArrayList arrayList = Monitor.Pause(sourceAddress);
				if (arrayList != null)
				{
					lock (NotificationList)
					{
						foreach (ISubscription item in arrayList)
						{
							if (NotificationList.Contains(item.ID))
							{
								NotificationList.Remove(item.ID);
							}
						}
					}
				}
			}
			catch (Exception e)
			{
				EventLogger.Error("Data Monitor", "Failed to pause monitoring on the device at address" + sourceAddress.Value, e);
			}
			Cursor.Current = current;
		}

		public virtual void ResumeMonitoring()
		{
			Cursor current = Cursor.Current;
			Cursor.Current = Cursors.WaitCursor;
			try
			{
				object[] array = (Model.MonitorColumns as ArrayList).ToArray();
				for (int i = 0; i < array.Length; i++)
				{
					IMonitorElement monitorElement = (IMonitorElement)array[i];
					if (Model.Status == ScreenStatus.Active && (monitorElement as MonitoredGroup).AddPending)
					{
						monitorElement.Reconcile(null);
					}
				}
				Monitor.Resume();
			}
			catch (Exception e)
			{
				EventLogger.Error("Data Monitor", "Failed to resume monitoring on all devices", e);
			}
			Cursor.Current = current;
		}

		public virtual void ResumeMonitoring(IAddressValue sourceAddress)
		{
			Cursor current = Cursor.Current;
			Cursor.Current = Cursors.WaitCursor;
			try
			{
				object[] array = (Model.MonitorColumns as ArrayList).ToArray();
				for (int i = 0; i < array.Length; i++)
				{
					IMonitorElement monitorElement = (IMonitorElement)array[i];
					if (Model.Status == ScreenStatus.Active && (monitorElement as MonitoredGroup).AddPending)
					{
						monitorElement.Reconcile(sourceAddress);
					}
				}
				Monitor.Resume(sourceAddress);
			}
			catch (Exception e)
			{
				EventLogger.Error("Data Monitor", "Failed to resume monitoring on device at address " + sourceAddress.Value, e);
			}
			Cursor.Current = current;
		}

		public void StartScreen()
		{
			Monitor.Start();
		}

		public virtual void LoadScreen()
		{
			if (Editor.CurrentScreenName == "")
			{
				Editor.CurrentScreenName = Model.Name;
			}
			if (Model.DataSources.Count <= 0 && (Network == null || Network.UserSuspendMonitoring || Network.SystemSuspendAllMonitoring))
			{
				return;
			}
			object[] array = (Model.MonitorColumns as ArrayList).ToArray();
			for (int i = 0; i < array.Length; i++)
			{
				IMonitorElement monitorElement = (IMonitorElement)array[i];
				if (monitorElement is MonitoredGroup)
				{
					monitorElement.Reconcile(null);
				}
			}
		}

		public virtual void StartMonitoring()
		{
			Cursor current = Cursor.Current;
			Cursor.Current = Cursors.WaitCursor;
			try
			{
				if (Model.DataSources.Count > 0 || (Network != null && !Network.UserSuspendMonitoring && !Network.SystemSuspendAllMonitoring))
				{
					object[] array = (Model.MonitorColumns as ArrayList).ToArray();
					for (int i = 0; i < array.Length; i++)
					{
						IMonitorElement monitorElement = (IMonitorElement)array[i];
						monitorElement.Reconcile(null);
					}
					Monitor.Start();
				}
			}
			finally
			{
				Cursor.Current = current;
			}
		}

		public void StartMonitoring(IAddressValue deviceAddress)
		{
			EventLogger.Log("Editor", "Starting DataMonitor on device at address " + deviceAddress.ToString());
			if (Network != null && !Network.UserSuspendMonitoring && !Network.SystemSuspendMonitoring(deviceAddress))
			{
				foreach (MonitoredGroup monitorColumn in Model.MonitorColumns)
				{
					monitorColumn.Reconcile(deviceAddress);
				}
				Monitor.Start(deviceAddress);
			}
			EventLogger.Log("Editor", "Started DataMonitor on device at address " + deviceAddress.ToString());
		}

		public virtual void StopMonitoring()
		{
			Cursor.Current = Cursors.WaitCursor;
			EventLogger.Log("Editor", "Stopping DataMonitor on all devices");
			Cursor.Current = Cursors.WaitCursor;
			Monitor.Stop();
			lock (NotificationList)
			{
				NotificationList.Clear();
			}
			EventLogger.Log("Editor", "Stopped DataMonitor on all devices");
			Cursor.Current = Cursors.Default;
		}

		public void StopMonitoring(IAddressValue deviceAddress)
		{
			EventLogger.Log("Editor", "Stopping DataMonitor on device at address " + deviceAddress.ToString());
			ArrayList arrayList = Monitor.Stop(deviceAddress);
			if (arrayList != null)
			{
				lock (NotificationList)
				{
					foreach (ISubscription item in arrayList)
					{
						if (NotificationList.Contains(item.GetHashCode()))
						{
							NotificationList.Remove(item.GetHashCode());
						}
					}
				}
			}
			EventLogger.Log("Editor", "Stopped DataMonitor on device at address " + deviceAddress.ToString());
		}

		public void SetMonitorDataRefreshRate(int rate, RefreshUnitsType units)
		{
			Monitor.SetRefreshRate(rate, units);
			Model.RequestReceiveRefreshRate = Monitor.DataRefreshRate;
			Model.DataRefreshUnits = Monitor.DataRefreshUnit;
		}

		public void SetBAMRefreshRate(int rate, RefreshUnitsType units)
		{
			Monitor.SetRefreshRate(rate, units);
			Model.BAMRefreshRate = Monitor.DataRefreshRate;
			Model.DataRefreshUnits = Monitor.DataRefreshUnit;
		}

		public void SetUIRefreshRate(int rate, RefreshUnitsType units)
		{
			int uIRefreshRate = Convert(rate, RefreshUnitsType.Milliseconds, units);
			try
			{
				if (Model.UIRefreshRate != 0 && rate == 0)
				{
					monitor.Notification -= OnDataRefresh;
				}
				if (Model.UIRefreshRate == 0 && rate != 0)
				{
					monitor.Notification += OnDataRefresh;
				}
			}
			catch
			{
			}
			Model.UIRefreshRate = uIRefreshRate;
		}

		public ICollection GetDataProvider()
		{
			ArrayList arrayList = new ArrayList();
			lock (Monitor.NameSubscriptions)
			{
				foreach (ISubscription value in Monitor.NameSubscriptions.Values)
				{
					arrayList.Add(value as IDataProvider);
				}
			}
			lock (Monitor.AddressSubscriptions)
			{
				foreach (ISubscription value2 in Monitor.AddressSubscriptions.Values)
				{
					arrayList.Add(value2 as IDataProvider);
				}
			}
			lock (Monitor.PublicDataSubscriptions)
			{
				foreach (ISubscription value3 in Monitor.PublicDataSubscriptions.Values)
				{
					arrayList.Add(value3 as IDataProvider);
				}
			}
			IAppConfigService appConfigService = ServiceManager.Services.GetService(typeof(IAppConfigService)) as IAppConfigService;
			bool flag = bool.Parse(appConfigService.GetAppSetting(ApplicationSettings.AutoLoggingChecked));
			if ((Monitor.PublicBroadcastAvailable || !flag) && Monitor.PublicDataBroadcastSubscription != null)
			{
				lock (Monitor.PublicDataBroadcastSubscription)
				{
					arrayList.Add(Monitor.PublicDataBroadcastSubscription as IDataProvider);
				}
			}
			return arrayList;
		}

		private void RaiseParameterAddedEvent(ParameterEventArgs e)
		{
			if (this.ParameterAdded != null)
			{
				this.ParameterAdded(this, e);
			}
		}

		protected virtual void RaiseParameterListAdded(ParameterListEventArgs e)
		{
			if (this.ParameterListAdded != null)
			{
				this.ParameterListAdded(this, e);
			}
		}

		protected void RaiseScreenLoadingFailedEvent(string message)
		{
			if (this.ScreenLoadingFailedEvent != null)
			{
				ScreenLoadingFailedEventArgs args = new ScreenLoadingFailedEventArgs(message);
				this.ScreenLoadingFailedEvent(this, args);
			}
		}

		protected void OnAddParameter(object sender, ParameterEventArgs e)
		{
			Monitor.AddParameter(e, Status == ScreenStatus.Active);
			RaiseParameterAddedEvent(e);
		}

		protected void OnAddParameterList(object sender, ParameterListEventArgs e)
		{
			Monitor.AddParameterList(e);
			RaiseParameterListAdded(e);
		}

		protected void OnRemoveParameter(object sender, ParameterEventArgs e)
		{
			Monitor.RemoveParameter(e);
			if (this.ParameterRemoved != null)
			{
				this.ParameterRemoved(this, e);
			}
		}

		protected void OnPerformanceUpdate(object sender, PerformanceEventArgs e)
		{
			ActualMonitorRate = e.ElapsedTime;
		}

		protected void OnConnectionLost(object sender, ConnectionEventArgs e)
		{
			ICalibrationOnline calibration = Network.GetCalibration(e.DeviceAddress);
			if (calibration != null && calibration.DataLink != null && calibration.DataLink.Connected)
			{
				EventLogger.Log("Editor", "Connection lost. Attempting to disconnect " + e.DeviceAddress.ToString());
				calibration.DataLink.DisconnectClient();
			}
		}

		private void OnMonitoringStarted(object sender, EventArgs e)
		{
			ValueEnabled = MonitorMode == DataAcquisitionType.RequestReceive;
		}

		private void OnMonitoringStopped(object sender, EventArgs e)
		{
			ValueEnabled = false;
		}

		private void OnChangeRunLocation(object sender, RunLocationChangeEventArgs args)
		{
			if (this.RunLocationChange != null)
			{
				this.RunLocationChange(this, args);
			}
		}

		private void OnStopBroadCast(object sender, StopBroadCastEventArgs args)
		{
			if (this.StopBroadCast != null)
			{
				this.StopBroadCast(this, args);
			}
		}

		public virtual void Undo()
		{
			GroupWithFocus.Undo();
		}

		public void Revert()
		{
			for (int i = 0; i < Model.MonitorColumns.Count; i++)
			{
				IMonitorElement monitorElement = (IMonitorElement)Model.MonitorColumns[i];
				monitorElement.Revert();
			}
		}

		public void AddParameters(StringCollection parameters, bool isAppend, bool isBroadcast, IAddressValue sourceAddress)
		{
			GroupWithFocus.AddParameters(parameters, isAppend, isBroadcast, sourceAddress);
		}

		public void SetRefreshRate(string rate, string unit)
		{
			EventLogger.Log("Editor", "Attempting to set the refresh rate to " + rate.ToString() + " " + unit.ToString());
			InternalSetRefreshRate(rate, unit);
		}

		private void InternalSetRefreshRate(string rate, string unit)
		{
			int rate2 = DefaultDataMonitorRefreshRate;
			try
			{
				rate2 = int.Parse(rate);
				if (unit == "Hz")
				{
					unit = "Hertz";
				}
				else if (unit == "ms")
				{
					unit = "Milliseconds";
				}
				DataRefreshUnits = (RefreshUnitsType)Enum.Parse(typeof(RefreshUnitsType), unit);
			}
			catch
			{
			}
			switch (MonitorMode)
			{
			case DataAcquisitionType.BAM:
				SetBAMRefreshRate(rate2, DataRefreshUnits);
				break;
			case DataAcquisitionType.EDM:
				SetEDMRefreshRate(rate2, DataRefreshUnits);
				break;
			default:
				SetMonitorDataRefreshRate(rate2, DataRefreshUnits);
				break;
			}
		}

		public void SetEDMRefreshRate(int rate, RefreshUnitsType units)
		{
			Monitor.SetRefreshRate(rate, units);
			Model.EDMRefreshRate = Monitor.DataRefreshRate;
			Model.DataRefreshUnits = Monitor.DataRefreshUnit;
		}

		private int Convert(int fromRate, RefreshUnitsType toUnits, RefreshUnitsType fromUnits)
		{
			int result = fromRate;
			int num = fromRate;
			switch (fromUnits)
			{
			case RefreshUnitsType.Hertz:
				if (fromRate != 0)
				{
					num = 1000 / fromRate;
				}
				break;
			case RefreshUnitsType.Milliseconds:
				num = fromRate;
				break;
			}
			switch (toUnits)
			{
			case RefreshUnitsType.Hertz:
				if (num != 0)
				{
					result = 1000 / num;
				}
				break;
			case RefreshUnitsType.Milliseconds:
				result = num;
				break;
			}
			return result;
		}

		protected virtual void OnDataRefresh(object sender, DataRefreshEventArgs e)
		{
			if (!(e is J1939_71DataRefreshEventArgs))
			{
				lock (NotificationList)
				{
					if (!NotificationList.Contains(e.SubscriptionHashCode))
					{
						NotificationList.Add(e.SubscriptionHashCode, e);
					}
					else
					{
						NotificationList[e.SubscriptionHashCode] = e;
					}
					return;
				}
			}
			lock (J1939_71CompositeData)
			{
				PCLSubscriptionHelper.MergeJ1939_71Notifications(J1939_71CompositeData, e as J1939_71DataRefreshEventArgs);
			}
		}

		private bool IsNotificationsChanged(DataRefreshEventArgs e)
		{
			bool result = true;
			if (e.DataSourceType == DataSourceTypeEnum.ECM)
			{
				result = false;
				ArrayList eCMData = (e as ECMDataRefreshEventArgs).ECMData;
				for (int i = 0; i < eCMData.Count; i++)
				{
					ICIDataElementNotification iCIDataElementNotification = (ICIDataElementNotification)eCMData[i];
					if (iCIDataElementNotification.Status == tagCIDMStatusEnum.DM_STATUS_OK && iCIDataElementNotification.Changed)
					{
						result = true;
						break;
					}
				}
			}
			return result;
		}

		public void Refresh()
		{
			try
			{
				if (refreshInProgress)
				{
					return;
				}
				refreshInProgress = true;
				SortedList sortedList;
				lock (NotificationList)
				{
					sortedList = (SortedList)NotificationList.Clone();
				}
				foreach (DataRefreshEventArgs value in sortedList.Values)
				{
					foreach (IMonitorElement monitorColumn in Model.MonitorColumns)
					{
						monitorColumn.Refresh(value, forceUpdate);
					}
					value.IsProcessed = true;
				}
				if (J1939_71CompositeData.Count <= 0)
				{
					return;
				}
				lock (J1939_71CompositeData)
				{
					j1939_71notifications = PCLSubscriptionHelper.ConvertToNotification(J1939_71CompositeData);
					J1939_71CompositeData = null;
				}
				foreach (J1939_71DataRefreshEventArgs j1939_71notification in j1939_71notifications)
				{
					foreach (IMonitorElement monitorColumn2 in Model.MonitorColumns)
					{
						monitorColumn2.Refresh(j1939_71notification, forceUpdate);
					}
				}
			}
			catch (DataSizeMismatchException ex)
			{
				EventLogger.Error("Data Monitor", $"Stopped Monitoring on screen {Model.Name} ", ex.Message);
				StopMonitoring();
			}
			catch (Exception e2)
			{
				EventLogger.Error("Data Monitor", "Screen Refresh Failed", e2);
			}
			finally
			{
				refreshInProgress = false;
				forceUpdate = false;
			}
		}

		private void OnUIRefreshRateChanged(object sender, UIRefreshRateChangedEventArgs e)
		{
			SetUIRefreshRate(e.RefreshRate, RefreshUnitsType.Milliseconds);
		}

		private void OnBeforeParameterListAddingEvent(object sender, EventArgs e)
		{
			if (Status == ScreenStatus.Active)
			{
				Monitor.Stop();
			}
		}

		private void OnAddPendingChangedEvent(object sender, EventArgs e)
		{
			if (!(sender as MonitoredGroupModel).AddPending && Status == ScreenStatus.Active)
			{
				MonitorResumeDelegate monitorResumeDelegate = Monitor.Start;
				monitorResumeDelegate.BeginInvoke(null, null);
			}
		}

		private void GetOptions()
		{
			string text = "";
			string text2 = "";
			int num = 0;
			IAppConfigService appConfigService = (IAppConfigService)ServiceManager.Services.GetService(typeof(IAppConfigService));
			try
			{
				if (bool.Parse(appConfigService.GetAppSetting(ApplicationSettings.MonitorModeRequestReceiveChecked)))
				{
					MonitorMode = DataAcquisitionType.RequestReceive;
				}
				else if (bool.Parse(appConfigService.GetAppSetting(ApplicationSettings.MonitorModeBamChecked)))
				{
					MonitorMode = DataAcquisitionType.BAM;
				}
				else if (bool.Parse(appConfigService.GetAppSetting(ApplicationSettings.MonitorModeEDMChecked)))
				{
					MonitorMode = DataAcquisitionType.EDM;
				}
			}
			catch
			{
			}
			try
			{
				if (Model.ScreenType == MonitorScreenType.Complex)
				{
					text = appConfigService.GetAppSetting(ApplicationSettings.ComplexScreenRequestReceiveRefreshRate);
					text2 = appConfigService.GetAppSetting(ApplicationSettings.ComplexScreenRequestReceiveRefreshRateUnits);
				}
				else
				{
					text = appConfigService.GetAppSetting(ApplicationSettings.DataRefreshRate);
					text2 = appConfigService.GetAppSetting(ApplicationSettings.DataRefreshRateUnits);
				}
				num = int.Parse(text);
				Model.RequestReceiveRefreshRate = num;
				model.DataRefreshUnits = TranslateRefreshUnits(text2);
			}
			catch
			{
			}
			int bAMRefreshRate = MonitorDataRefreshRate;
			try
			{
				bAMRefreshRate = int.Parse(appConfigService.GetAppSetting(ApplicationSettings.BamRefreshRate));
			}
			catch
			{
			}
			Model.BAMRefreshRate = bAMRefreshRate;
			int eDMRefreshRate = 20;
			try
			{
				eDMRefreshRate = int.Parse(appConfigService.GetAppSetting(ApplicationSettings.EDMRefreshRate));
			}
			catch
			{
			}
			Model.EDMRefreshRate = eDMRefreshRate;
			switch (MonitorMode)
			{
			case DataAcquisitionType.BAM:
				Monitor.SetRefreshRate(Model.BAMRefreshRate, Model.DataRefreshUnits);
				break;
			case DataAcquisitionType.EDM:
				Monitor.SetRefreshRate(Model.EDMRefreshRate, Model.DataRefreshUnits);
				break;
			case DataAcquisitionType.RequestReceive:
				Monitor.SetRefreshRate(Model.RequestReceiveRefreshRate, Model.DataRefreshUnits);
				break;
			case DataAcquisitionType.IDL:
			case (DataAcquisitionType)4:
				break;
			}
		}

		public void SetCommonOptions()
		{
			string text = "";
			string text2 = "";
			string text3 = "";
			_ = MonitorDataRefreshRate;
			int num = 0;
			IAppConfigService appConfigService = (IAppConfigService)ServiceManager.Services.GetService(typeof(IAppConfigService));
			try
			{
				ShowComments = bool.Parse(appConfigService.GetAppSetting(ApplicationSettings.MonitorShowCommentsChecked));
			}
			catch
			{
			}
			try
			{
				text = appConfigService.GetAppSetting(ApplicationSettings.ScreenRefreshRate);
				text2 = appConfigService.GetAppSetting(ApplicationSettings.ScreenRefreshRateUnits);
				num = int.Parse(text);
				SetUIRefreshRate(num, TranslateRefreshUnits(text2));
			}
			catch
			{
			}
			try
			{
				text3 = appConfigService.GetAppSetting(ApplicationSettings.BamTriggerMode);
				BAMTriggerMode = TranslateTriggerMode(text3);
			}
			catch
			{
			}
			try
			{
				ConnectionTimeoutEnabled = bool.Parse(appConfigService.GetAppSetting(ApplicationSettings.ConnectionTimeoutEnabled));
				ConnectionTimeoutMinimum = int.Parse(appConfigService.GetAppSetting(ApplicationSettings.ConnectionTimeoutMinimum));
				ConnectionTimeoutFactor = int.Parse(appConfigService.GetAppSetting(ApplicationSettings.ConnectionTimeoutFactor));
			}
			catch
			{
			}
		}

		private RefreshUnitsType TranslateRefreshUnits(string units)
		{
			RefreshUnitsType refreshUnitsType = RefreshUnitsType.Milliseconds;
			switch (units.ToUpper())
			{
			case "HZ":
			case "HERTZ":
				return RefreshUnitsType.Hertz;
			default:
				return RefreshUnitsType.Milliseconds;
			}
		}

		private TriggerType TranslateTriggerMode(string trigger)
		{
			TriggerType triggerType = TriggerType.Clock;
			if (Enum.IsDefined(typeof(TriggerType), trigger))
			{
				try
				{
					return (TriggerType)Enum.Parse(typeof(TriggerType), trigger);
				}
				catch
				{
					return TriggerType.Clock;
				}
			}
			return TriggerType.Clock;
		}

		private Monitor CreateMonitor()
		{
			Monitor monitor = null;
			monitor = MonitorMode switch
			{
				DataAcquisitionType.BAM => new BAMMonitor(Network), 
				DataAcquisitionType.EDM => new EDMMonitor(Network), 
				_ => new ReqRecvMonitor(Network), 
			};
			monitor.SubscriptionRemoved += OnSubscriptionRemoved;
			return monitor;
		}

		private void InitializeMonitor(Monitor monitor)
		{
			if (monitor != null)
			{
				switch (MonitorMode)
				{
				case DataAcquisitionType.BAM:
					monitor.SetRefreshRate(BAMRefreshRate, DataRefreshUnits);
					(monitor as BAMMonitor).TriggerMode = BAMTriggerMode;
					break;
				case DataAcquisitionType.EDM:
					monitor.SetRefreshRate(EDMRefreshRate, DataRefreshUnits);
					break;
				default:
					monitor.SetRefreshRate(Model.RequestReceiveRefreshRate, DataRefreshUnits);
					break;
				}
				monitor.DataSources = Model.DataSources;
				monitor.ConnectionTimeoutEnabled = ConnectionTimeoutEnabled;
				monitor.ConnectionTimeoutFactor = ConnectionTimeoutFactor;
				monitor.ConnectionTimeoutMinimum = ConnectionTimeoutMinimum;
				if (UIRefreshRate != 0)
				{
					monitor.Notification += OnDataRefresh;
				}
				monitor.ConnectionLost += OnConnectionLost;
				monitor.PerformanceStatistics += OnPerformanceUpdate;
				monitor.RunLocationChange += OnChangeRunLocation;
				monitor.StopBroadCast += OnStopBroadCast;
				monitor.MonitorStatusChangedEvent += OnMonitorStatusChangedEvent;
			}
		}

		private void OnMonitorStatusChangedEvent(object sender, EventArgs e)
		{
			foreach (IMonitorElement monitorColumn in Model.MonitorColumns)
			{
				if (monitorColumn is MonitoredGroup)
				{
					(monitorColumn as MonitoredGroup).IsMonitoring = IsMonitoring;
				}
			}
		}

		private void OnSubscriptionRemoved(object sender, SubscriptionRemovedEventArgument e)
		{
			lock (NotificationList)
			{
				if (NotificationList.Contains(e.HashCode))
				{
					NotificationList.Remove(e.HashCode);
				}
			}
		}

		private void OnDataViewGotFocus(object sender, EventArgs e)
		{
			if (sender is MonitoredGroupView)
			{
				groupWithFocus = (MonitoredGroupView)sender;
			}
		}

		private void ResynchronizeAllParameters()
		{
			object[] array = (Model.MonitorColumns as ArrayList).ToArray();
			for (int i = 0; i < array.Length; i++)
			{
				IMonitorElement monitorElement = (IMonitorElement)array[i];
				if (monitorElement is MonitoredGroup)
				{
					monitorElement.Resynchronize();
				}
			}
		}

		private void AddColumn_Click(object sender, EventArgs e)
		{
			AddColumn();
			IsDirty = true;
		}
	}
	public class ComplexScreenController : ScreenController
	{
		private const string ComplexParameterNameFormat = "{0}:{1}";

		private string complexParameterName = string.Empty;

		private bool complexParameterAddPending = true;

		public string ComplexParameterName => complexParameterName;

		public ComplexScreenController(ScreenModel model)
			: base(model)
		{
			if (base.Model.DataSources == null)
			{
				return;
			}
			foreach (ICalibration value in base.Model.DataSources.Values)
			{
				if (value is ICalibrationDisk calibrationDisk)
				{
					calibrationDisk.FileSaveAsEvent += OnFileSaveAsEvent;
				}
			}
		}

		public override void Undo()
		{
			IMonitorElement monitorElement = (IMonitorElement)base.Model.MonitorColumns[0];
			monitorElement.Undo();
		}

		public override void AddColumn(IMonitorElement column)
		{
			base.AddColumn(column);
			if (base.Network != null)
			{
				base.Network.ConnectionEstablished += OnConnectionEstablished;
			}
		}

		public override void ResumeMonitoring()
		{
			Cursor current = Cursor.Current;
			Cursor.Current = Cursors.WaitCursor;
			try
			{
				object[] array = (base.Model.MonitorColumns as ArrayList).ToArray();
				for (int i = 0; i < array.Length; i++)
				{
					IMonitorElement monitorElement = (IMonitorElement)array[i];
					monitorElement.Reconcile(null);
					AddComplexParamToMonitor(monitorElement);
				}
				base.Monitor.Resume();
			}
			catch (Exception e)
			{
				EventLogger.Error("Data Monitor", "Failed to resume monitoring on all devices", e);
			}
			Cursor.Current = current;
		}

		public override void ResumeMonitoring(IAddressValue sourceAddress)
		{
			if (base.Model.CurrentSourceAddress == sourceAddress)
			{
				ResumeMonitoring();
			}
		}

		public override void StartMonitoring()
		{
			Cursor current = Cursor.Current;
			Cursor.Current = Cursors.WaitCursor;
			try
			{
				if (base.Model.DataSources.Count > 0 || (base.Network != null && !base.Network.UserSuspendMonitoring && !base.Network.SystemSuspendAllMonitoring))
				{
					object[] array = (base.Model.MonitorColumns as ArrayList).ToArray();
					for (int i = 0; i < array.Length; i++)
					{
						IMonitorElement monitorElement = (IMonitorElement)array[i];
						ICalibration calibration = (ICalibration)base.Model.DataSources[((LogParameters)monitorElement.IDLParametersList[0]).sourceAddess];
						IParameterModel parameterModel = calibration.FuzzyGet(((LogParameters)monitorElement.IDLParametersList[0]).parameterName);
						AddComplexParameter(parameterModel);
					}
					base.Monitor.Start();
				}
			}
			finally
			{
				Cursor.Current = current;
			}
		}

		public override void Restore(NewDataSet.ScreenRow screenRow)
		{
			if (!base.Restored && screenRow != null && base.Model.MonitorColumns.Count == 0)
			{
				IMonitorElement monitorElement = null;
				try
				{
					monitorElement = AddMonitoredElement(screenRow.GetGroupRows()[0]);
				}
				catch (MonitorElementNotAddedException ex)
				{
					RaiseScreenLoadingFailedEvent(ex.Message);
				}
				if (monitorElement != null)
				{
					monitorElement.Radix = base.Radix;
					monitorElement.Restore(screenRow.GetGroupRows()[0]);
				}
			}
		}

		public override void RemoveColumn(int columnId)
		{
			if (base.Network != null)
			{
				base.Network.ConnectionEstablished -= OnConnectionEstablished;
			}
			base.Model.RemoveColumn(columnId);
		}

		public IMonitorElement AddMonitoredElement(IParameterModel parameterModel)
		{
			IMonitorElement monitorElement = null;
			ISecurityService securityService = (ISecurityService)ServiceManager.Services.GetService(typeof(ISecurityService));
			if (parameterModel != null)
			{
				complexParameterName = $"{parameterModel.Name}:{parameterModel.DataSource.SourceAddress.DisplayId}";
				if (securityService != null)
				{
					if (securityService.ToolFamily == ToolFamily.FieldEngineering && !IsParameterAllowedForField(parameterModel))
					{
						string message = string.Format(Editor.ResourceManager.GetString(EditorMessageIDs.MonitorElementNotAllowedForField.ToString()), parameterModel.Name);
						throw new MonitorElementNotAddedException(Facility.Editor, 10, message);
					}
					switch (parameterModel.DataType)
					{
					case ParameterType.ArrayXYZ:
						monitorElement = new MonitoredArrayXYZ(parameterModel);
						break;
					case ParameterType.ArrayXY:
						monitorElement = new MonitoredArrayXY(parameterModel);
						break;
					case ParameterType.Array1D:
						monitorElement = ((!(parameterModel is IDataBlockModel)) ? ((IMonitorElement)new MonitoredArrayX(parameterModel)) : ((IMonitorElement)new MonitoredArray1D(parameterModel)));
						break;
					case ParameterType.ArrayXAxis:
						monitorElement = new MonitoredArrayX(parameterModel);
						break;
					case ParameterType.Structure:
						monitorElement = new MonitoredStructure(parameterModel);
						break;
					case ParameterType.StructureArray:
						monitorElement = new MonitoredStructureArray(parameterModel);
						break;
					}
					if (monitorElement != null)
					{
						AddColumn(monitorElement);
						if (base.Model.Status == ScreenStatus.Active)
						{
							AddComplexParameter(parameterModel);
						}
					}
				}
				return monitorElement;
			}
			string message2 = Editor.ResourceManager.GetString(EditorMessageIDs.MonitorElementIsNull.ToString());
			string detailedMessage = Editor.ResourceManager.GetString(EditorMessageIDs.MonitorElementIsNullDetailedMessage.ToString());
			EventLogger.Error("Editor", message2, detailedMessage);
			throw new MonitorElementNotAddedException(Facility.Editor, 11, message2);
		}

		public IMonitorElement AddMonitoredElement(NewDataSet.GroupRow groupRow)
		{
			IMonitorElement result = null;
			NewDataSet.ParameterRow[] parameterRows = groupRow.GetParameterRows();
			if (parameterRows.Length > 0)
			{
				NewDataSet.ParameterRow parameterRow = parameterRows[0];
				IAddressValue key = null;
				if (parameterRow.SourceAddress.ToString() != string.Empty)
				{
					key = AddressFactory.ProductAddressValue(parameterRow.SourceAddress);
				}
				if (!base.Model.DataSources.Contains(key))
				{
					key = base.Model.CurrentSourceAddress;
				}
				ICalibration calibration = (ICalibration)base.Model.DataSources[key];
				IParameterModel parameterModel = calibration.FuzzyGet(parameterRow.Name);
				result = AddMonitoredElement(parameterModel);
			}
			return result;
		}

		protected void OnFileSaveAsEvent(object sender, FileSaveAsEventArgs args)
		{
			if (complexParameterName.Length != 0)
			{
				string arg = complexParameterName.Substring(0, complexParameterName.IndexOf(":"));
				complexParameterName = $"{arg}:{args.NewSourceAddress.DisplayId}";
			}
		}

		private void AddComplexParamToMonitor(IMonitorElement column)
		{
			if (base.Model.Status != ScreenStatus.Active || !complexParameterAddPending)
			{
				return;
			}
			string name = (column as Cummins.Parameter.Parameter).ParameterModel.Name;
			IAddressValue sourceAddress = (column as Cummins.Parameter.Parameter).ParameterModel.DataSource.SourceAddress;
			if (base.Model.DataSources.Contains(sourceAddress))
			{
				ICalibration calibration = (ICalibration)base.Model.DataSources[sourceAddress];
				IParameterModel parameterModel = calibration.Get(name);
				if (parameterModel != null)
				{
					AddComplexParameter(parameterModel);
				}
			}
		}

		private void AddComplexParameter(IParameterModel parameterModel)
		{
			if (parameterModel.DataSource.Connected)
			{
				ListDictionary listDictionary = new ListDictionary();
				parameterModel.ReadabilityCheckPassed = true;
				switch (parameterModel.DataType)
				{
				case ParameterType.ArrayXYZ:
				{
					IParameterModel xAxis2 = (parameterModel as IArrayAxis).XAxis;
					xAxis2.ReadabilityCheckPassed = true;
					listDictionary.Add(xAxis2.Name, xAxis2);
					IParameterModel yAxis = (parameterModel as IArrayAxis).YAxis;
					yAxis.ReadabilityCheckPassed = true;
					listDictionary.Add(yAxis.Name, yAxis);
					listDictionary.Add(parameterModel.Name, parameterModel);
					break;
				}
				case ParameterType.ArrayXY:
				{
					IParameterModel xAxis = (parameterModel as IArrayAxis).XAxis;
					xAxis.ReadabilityCheckPassed = true;
					listDictionary.Add(xAxis.Name, xAxis);
					listDictionary.Add(parameterModel.Name, parameterModel);
					break;
				}
				default:
					listDictionary.Add(parameterModel.Name, parameterModel);
					break;
				}
				AddComplexParameter(listDictionary);
				complexParameterAddPending = false;
			}
			else
			{
				complexParameterAddPending = true;
			}
		}

		private void AddComplexParameter(ListDictionary parametersToAdd)
		{
			if (base.Status == ScreenStatus.Active)
			{
				base.Model.UIRefreshRate = 5000;
				ParameterListEventArgs e = new ParameterListEventArgs(parametersToAdd, isBroadcast: false, null);
				base.Monitor.AddParameterList(e);
				RaiseParameterListAdded(e);
			}
		}

		private bool IsParameterAllowedForField(IParameterModel parameterModel)
		{
			bool flag = false;
			if (parameterModel != null)
			{
				flag = parameterModel.DataType != ParameterType.StructureArray && parameterModel.DataType != ParameterType.Structure;
				if (flag)
				{
					ISecurityService securityService = (ISecurityService)ServiceManager.Services.GetService(typeof(ISecurityService));
					flag = securityService.IsTableEditAllowed(parameterModel.SubfileNumber);
					if (flag)
					{
						IParamInfo paramInfo = parameterModel.DataSource.ParametersInfo[parameterModel.Name];
						if (paramInfo != null)
						{
							if (paramInfo.IsTable)
							{
								ITableAxisInfo tableAxisInfo = paramInfo.TableAxisInfo;
								if (tableAxisInfo != null)
								{
									ICalibration dataSource = parameterModel.DataSource;
									IParameterModel parameterModel2 = dataSource.Get(tableAxisInfo.XAxisName);
									IParameterModel parameterModel3 = dataSource.Get(tableAxisInfo.YAxisName);
									if (parameterModel2 != null)
									{
										flag = IsParameterAllowedForField(parameterModel2);
									}
									if (parameterModel3 != null)
									{
										flag = flag && IsParameterAllowedForField(parameterModel3);
									}
								}
							}
						}
						else
						{
							flag = false;
						}
					}
					else
					{
						EventLogger.Error("Editor", string.Format(Editor.ResourceManager.GetString(EditorMessageIDs.TableEditNotAllowedForField.ToString()), parameterModel.Name, parameterModel.SubfileNumber));
					}
				}
				else
				{
					EventLogger.Error("Editor", Editor.ResourceManager.GetString(EditorMessageIDs.StructureAndStructureArrayEditNotAllowedForField.ToString()));
				}
			}
			else
			{
				flag = false;
			}
			return flag;
		}

		private void OnConnectionEstablished(object sender, DeviceAddressEventArgs e)
		{
			if (!complexParameterAddPending)
			{
				return;
			}
			object[] array = (base.Model.MonitorColumns as ArrayList).ToArray();
			for (int i = 0; i < array.Length; i++)
			{
				IMonitorElement monitorElement = (IMonitorElement)array[i];
				try
				{
					monitorElement.Reconcile(null);
				}
				catch
				{
				}
			}
			complexParameterAddPending = false;
		}
	}
	internal delegate void GaugeParameterChangedEventHandler(object sender, GaugeParameterChangedEventArgs args);
	internal class DashBoard : UserControl
	{
		private const int maxGauges = 8;

		private GaugeControl[] gaugeControls;

		private NewDataSet.GaugeDataTable gaugeTable;

		private Panel[] gaguePanels;

		private Panel panelMain;

		private SortedList nametoIndexMap;

		private Container components;

		private int selectedGaugeIndex = -1;

		public GaugeControl this[int index]
		{
			get
			{
				if (index >= 0 && index <= gaugeControls.Length)
				{
					return gaugeControls[index];
				}
				throw new Exception("Invallid index");
			}
		}

		public int SelectedGaugeIndex => selectedGaugeIndex;

		internal event GaugeParameterChangedEventHandler GaugeParameterChangedEvent;

		protected DashBoard()
		{
			gaugeControls = new GaugeControl[8];
			gaguePanels = (Panel[])(object)new Panel[8];
			gaugeTable = gaugeTable;
			InitializeComponent();
		}

		public DashBoard(int numberOfGauges, NewDataSet.GaugeDataTable gaugeTable)
		{
			if (numberOfGauges <= 8)
			{
				gaugeControls = new GaugeControl[numberOfGauges];
				gaguePanels = (Panel[])(object)new Panel[numberOfGauges];
				this.gaugeTable = gaugeTable;
				InitializeComponent();
				return;
			}
			throw new NotSupportedException("Currently max eight gauges are supported");
		}

		public int NametoIndex(string name)
		{
			int result = -1;
			if (nametoIndexMap.Contains(name))
			{
				result = (int)nametoIndexMap[name];
			}
			return result;
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			((ContainerControl)this).Dispose(disposing);
		}

		private void InitializeComponent()
		{
			//IL_000e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0018: Expected O, but got Unknown
			//IL_009c: Unknown result type (might be due to invalid IL or missing references)
			//IL_00a2: Expected O, but got Unknown
			int num = 0;
			nametoIndexMap = new SortedList();
			panelMain = new Panel();
			((Control)panelMain).Dock = (DockStyle)5;
			((Control)panelMain).Location = new Point(0, 0);
			((Control)panelMain).Size = new Size(211, 216);
			((Control)this).Controls.Add((Control)(object)panelMain);
			for (int i = 0; i < gaugeControls.Length; i++)
			{
				NewDataSet.GaugeRow gaugeRow = gaugeTable.NewGaugeRow();
				gaugeRow.Index = i;
				gaugeTable.AddGaugeRow(gaugeRow);
				gaugeControls[i] = new GaugeControl(gaugeRow);
				gaguePanels[i] = new Panel();
				((Control)gaguePanels[i]).Dock = (DockStyle)3;
				((Control)gaguePanels[i]).Location = new Point(num, 0);
				((Control)gaguePanels[i]).Size = new Size(211, 221);
				((Control)gaguePanels[i]).Controls.Add((Control)(object)gaugeControls[i]);
				((Control)gaugeControls[i]).Dock = (DockStyle)5;
				((Control)gaugeControls[i]).Location = new Point(num, 0);
				((Control)gaugeControls[i]).Name = "gaugeControl" + i;
				((Control)gaugeControls[i]).Size = new Size(211, 221);
				((Control)gaugeControls[i]).TabIndex = i;
				gaugeControls[i].ParameterChangedEvent += OnParameterChanged;
				((Control)gaugeControls[i]).Enter += OnGaugeGotFocus;
				((Control)gaugeControls[i]).Leave += OnGaugeLostFocus;
				num += 211;
				((Control)panelMain).Controls.Add((Control)(object)gaguePanels[i]);
				nametoIndexMap.Add(((Control)gaugeControls[i]).Name, i);
			}
			gaugeTable.AcceptChanges();
			((Control)this).Name = "DashBoard";
			((Control)this).Size = new Size(1216, 216);
			((Control)this).ResumeLayout(false);
		}

		private void OnParameterChanged(object sender, ParameterChangedEventArgs e)
		{
			if (sender is GaugeControl)
			{
				string name = ((Control)(sender as GaugeControl)).Name;
				int num = NametoIndex(name);
				if (-1 != num)
				{
					RaiseOnGaugeParameterChangedEvent(num, e);
				}
			}
		}

		private void OnGaugeGotFocus(object sender, EventArgs e)
		{
			if (sender is GaugeControl)
			{
				selectedGaugeIndex = NametoIndex(((Control)(sender as GaugeControl)).Name);
			}
		}

		private void OnGaugeLostFocus(object sender, EventArgs e)
		{
			selectedGaugeIndex = -1;
		}

		private void RaiseOnGaugeParameterChangedEvent(int gaugeIndex, ParameterChangedEventArgs e)
		{
			if (this.GaugeParameterChangedEvent != null)
			{
				GaugeParameterChangedEventArgs args = new GaugeParameterChangedEventArgs(gaugeIndex, e);
				this.GaugeParameterChangedEvent(this, args);
			}
		}
	}
	public class DatasourceNameChangedEventArgs : EventArgs
	{
		private string datasourceName = string.Empty;

		private string oldDatasourceName = string.Empty;

		public string DatasourceName
		{
			get
			{
				return datasourceName;
			}
			set
			{
				datasourceName = value;
			}
		}

		public string OldDataSourceName
		{
			get
			{
				return oldDatasourceName;
			}
			set
			{
				oldDatasourceName = value;
			}
		}

		public DatasourceNameChangedEventArgs(string datasourceName, string oldDataSourceName)
		{
			this.datasourceName = datasourceName;
			oldDatasourceName = oldDataSourceName;
		}
	}
	public enum BAM45TriggerType
	{
		EngineSpeed = 1,
		RoadSpeed,
		TurboSpeed,
		Clock,
		Frame
	}
	public enum BAMPre45TriggerType
	{
		RoadSpeed = 2,
		TurboSpeed = 3,
		ForeGroundActivated = 6,
		CamCrankSpeed = 7
	}
	public class Editor
	{
		private const string ResourceFileName = "Cummins.Editor.Strings";

		internal const string EditorCaption = "Editor";

		private EditorController editorController;

		private EditorModel editorModel;

		private EditorView editorView;

		private EditorPreferences editorPreferences;

		private static ResourceManager resourceMgr;

		private static string currentScreenName = "";

		private IIntegratedCalibration integratedCalibration;

		public NewDataSet.ScreenDataTable Screens => Model.MonitorSession.Screen;

		public bool IsDirty => Controller.IsDirty;

		public ArrayList ScreenList => Model.Screens;

		public LastUsedType ScreenFileDataSourceType
		{
			get
			{
				LastUsedType result = LastUsedType.LastScreenFile;
				if (Model.DataSources.Count > 0)
				{
					ICalibration calibration = (ICalibration)Model.DataSources.GetByIndex(0);
					if (calibration is ICalibrationOnline)
					{
						result = LastUsedType.LastScreenFileModule;
					}
					else if (calibration is ISubfile)
					{
						result = LastUsedType.LastScreenFileSubFile;
					}
					else if (calibration is CalibrationExport)
					{
						result = LastUsedType.LastScreenFileExport;
					}
					else if (calibration is ICalibrationDisk)
					{
						result = LastUsedType.LastScreenFileCalFile;
					}
				}
				return result;
			}
		}

		public IIntegratedCalibration IntegratedCalibration
		{
			get
			{
				return integratedCalibration;
			}
			set
			{
				if (value != null)
				{
					integratedCalibration = value;
					Controller.IntegratedCalibration = value;
				}
			}
		}

		public static string CurrentScreenName
		{
			get
			{
				return currentScreenName;
			}
			set
			{
				currentScreenName = value;
			}
		}

		public IModuleNetwork Network
		{
			get
			{
				return Model.Network;
			}
			set
			{
				Controller.Network = value;
			}
		}

		public string ScreenFile
		{
			get
			{
				return Controller.ScreenFilename;
			}
			set
			{
				Controller.ScreenFilename = value;
			}
		}

		public string DefaultScreenFilename => Controller.DefaultScreenFilename;

		public EditorView View => editorView;

		public int ScreenCount
		{
			get
			{
				if (Model.Screens != null)
				{
					return Model.Screens.Count;
				}
				return 0;
			}
		}

		public EditorController Controller => editorController;

		private EditorModel Model => editorModel;

		internal static ResourceManager ResourceManager
		{
			get
			{
				if (resourceMgr == null)
				{
					resourceMgr = new ResourceManager("Cummins.Editor.Strings", Assembly.GetExecutingAssembly());
				}
				return resourceMgr;
			}
		}

		public event MonitorModeEventHandler MonitorModeChanged;

		public event EventHandler MonitoringStarted
		{
			add
			{
				Controller.MonitoringStarted += value;
			}
			remove
			{
				Controller.MonitoringStarted -= value;
			}
		}

		public event EventHandler AllScreenLoadedEvent
		{
			add
			{
				Controller.AllScreensLoadedEvent += value;
			}
			remove
			{
				Controller.AllScreensLoadedEvent -= value;
			}
		}

		public event EventHandler MonitoringStopped
		{
			add
			{
				Controller.MonitoringStopped += value;
			}
			remove
			{
				Controller.MonitoringStopped -= value;
			}
		}

		public event KeyEventHandler UndockedScreenDownEvent
		{
			add
			{
				View.UndockedScreenKeyDownEvent += value;
			}
			remove
			{
				View.UndockedScreenKeyDownEvent -= value;
			}
		}

		public event ParameterEventHandler ParameterAddedToScreen;

		public event ParameterListEventHandler ParametersAddedToScreen;

		public event ParameterEventHandler ParameterRemovedFromScreen;

		public event ChangeActiveScreenEventHandler ActiveScreenChangeEvent
		{
			add
			{
				Model.ChangeActiveScreenEvent += value;
			}
			remove
			{
				Model.ChangeActiveScreenEvent -= value;
			}
		}

		public Editor(SortedList dataSources, IAddressValue currentSourceAddress, string dataSourceName)
		{
			editorModel = new EditorModel(dataSources, currentSourceAddress, dataSourceName);
			editorController = new EditorController(editorModel);
			editorView = new EditorView(editorController, editorModel);
			editorModel.ChangeActiveScreenEvent += OnChangeActiveScreen;
			editorView.ScreenTabChangedEvent += OnScreenTabChangedEvent;
			editorView.ScreenTabClosedEvent += OnScreenTabClosedEvent;
			editorView.ParameterAddedOnScreenEvent += OnParameterAddedOnScreen;
			editorView.HexEditorTabClosedEvent += OnHexEditorTabClosedEvent;
			editorView.ScreenTitleUpdatedEvent += OnScreenTitleUpdatedEvent;
			editorController.ScreenFilename = editorController.DefaultScreenFilename;
			editorPreferences = EditorPreferencesPageProvider.EditorPageProvider.EditorPreferencesPage;
			editorPreferences.DataMonitorOptionsChangedEvent += Controller.OnDataMonitorOptionsChanged;
			integratedCalibration = null;
		}

		private void OnScreenTitleUpdatedEvent(object sender, ScreenTitleUpdatedEventArgs e)
		{
			Controller.UpdateScreenRow(e.PreviousScreenTitle, e.UpdatedScreenTitle);
		}

		public void OnCurrentDeviceAddressChangedEvent(object sender, IAddressValue deviceAddress)
		{
			Model.CurrentSourceAddress = deviceAddress;
		}

		public void DockAllScreens()
		{
			View.DockAllScreens();
		}

		public void StartCurrentScreenMonitoring()
		{
			Controller.StartCurrentScreenMonitoring();
		}

		public void StopCurrentScreenMonitoring()
		{
			Controller.StopCurrentScreenMonitoring();
		}

		public ScreenStatus ToggleCurrentScreenMonitoring()
		{
			return Controller.ToggleCurrentScreenMonitoring();
		}

		public void ShowScreenList()
		{
			View.ShowScreenList();
		}

		public void LoadScreenFile(string filename)
		{
			Controller.LoadSession(filename);
			foreach (Screen screen in ScreenList)
			{
				screen.ParameterRemovedFromScreen += this.ParameterRemovedFromScreen;
				screen.ParameterAddedToScreen += this.ParameterAddedToScreen;
				screen.ParametersAddedToScreen += this.ParametersAddedToScreen;
			}
		}

		public bool SaveScreenFileAs(string filename)
		{
			bool flag = false;
			View.SaveSession();
			return Controller.SaveSession(filename);
		}

		public void AddScreen(MonitorScreenType typeOfScreen)
		{
			Screen screen = Controller.AddScreen(Model.CurrentSourceAddress, typeOfScreen, string.Empty, isScreenLoading: false);
			if (screen.Status == ScreenStatus.Active)
			{
				screen.StartMonitoring();
			}
			screen.ParameterRemovedFromScreen += this.ParameterRemovedFromScreen;
			screen.ParameterAddedToScreen += this.ParameterAddedToScreen;
			screen.ParametersAddedToScreen += this.ParametersAddedToScreen;
		}

		public void InvokeHexEditor(ICalibration datasource)
		{
			Controller.InvokeHexEditor(datasource);
		}

		public void RemoveScreen()
		{
			Controller.RemoveScreen(Controller.CurrentScreenId);
		}

		public void NextScreen()
		{
			Controller.NextScreen();
		}

		public void PreviousScreen()
		{
			Controller.PreviousScreen();
		}

		public void ParameterQuery(ICalibration calibration)
		{
			View.ParameterQuery(calibration);
		}

		public void J1939_71ParameterQuery(ICalibration calibration)
		{
			View.J1939_71ParameterQuery(calibration);
		}

		public void CloseBroadcastList()
		{
			View.CloseBroadcastList();
		}

		public void RadixBinary()
		{
			Controller.Radix = DataFormat.Binary;
		}

		public void RadixDecimal()
		{
			Controller.Radix = DataFormat.Decimal;
		}

		public void RadixHex()
		{
			Controller.Radix = DataFormat.Hex;
		}

		public string GetRadix()
		{
			return Controller.Radix.ToString();
		}

		public void Undo()
		{
			View.Undo();
		}

		public void Revert()
		{
			View.Revert();
		}

		public bool IsHexEditorPresent(IAddressValue sourceAddress)
		{
			bool flag = false;
			return Model.HexEditorList.Contains(sourceAddress.DisplayId);
		}

		public bool SaveHexEditorData(IAddressValue sourceAddress, string newFileName)
		{
			return Model.SaveHexEditorData(sourceAddress, newFileName);
		}

		public bool SaveHexEditorData(IAddressValue sourceAddress)
		{
			return Model.SaveHexEditorData(sourceAddress);
		}

		private void OnChangeActiveScreen(object sender, ChangeActiveScreenEventArgs e)
		{
			if (e.PreviousScreen != null)
			{
				e.PreviousScreen.MonitorModeChanged -= OnChangeMonitorMode;
			}
			if (e.NewScreen != null)
			{
				e.NewScreen.MonitorModeChanged += OnChangeMonitorMode;
			}
		}

		private void OnChangeMonitorMode(object sender, MonitorModeEventArgs e)
		{
			RaiseMonitorModeChangedEvent(e.Mode);
		}

		private void RaiseMonitorModeChangedEvent(DataAcquisitionType mode)
		{
			if (this.MonitorModeChanged != null)
			{
				this.MonitorModeChanged(this, new MonitorModeEventArgs(mode));
			}
		}

		private void OnScreenTabChangedEvent(object sender, ScreenTabChangedEventArgs e)
		{
			Controller.SetCurrentScreen(e.ScreenName);
			currentScreenName = e.ScreenName;
		}

		private void OnScreenTabClosedEvent(object sender, EventArgs e)
		{
			RemoveScreen();
		}

		private void OnParameterAddedOnScreen(object sender, ParameterAddedOnScreenEventArgs e, bool isBroadcast, IAddressValue sourceAddress)
		{
			Controller.AddParameters(e.ScreenName, e.ParametersSelected, e.IsAppend, isBroadcast, sourceAddress);
		}

		private void OnHexEditorTabClosedEvent(object sender, HexEditorScreenRemoveEventArgs e)
		{
			Controller.RemoveHexEditor(e.address);
		}

		public void Dispose()
		{
			Dispose(disposing: true);
		}

		public void ChangeScreenTabTitle(string dataSourceName)
		{
			Model.DataSourceName = dataSourceName;
		}

		protected virtual void Dispose(bool disposing)
		{
			if (disposing)
			{
				for (int i = 0; i < editorModel.Screens.Count; i++)
				{
					((Screen)editorModel.Screens[i])?.Dispose();
				}
				editorController.CleanupResources();
				((Component)(object)editorView).Dispose();
				editorModel.CleanupResources();
			}
		}
	}
	public delegate void ScreenAddedEventHandler(object sender, ScreenAddedEventArgs e);
	public delegate void HexEditorScreenAddedEventHandler(object sender, HexEditorScreenAddedEventArgs e);
	public delegate void HexEditorScreenRemoveEventHandler(object sender, HexEditorScreenRemoveEventArgs e);
	public class EditorController
	{
		private enum MonitorState
		{
			Idle,
			Rotating
		}

		private delegate void MonitorDelegate(IAddressValue deviceAddress);

		private delegate void NetworkChangeDelegate(IModuleNetwork network);

		private delegate void MonitorModeChangeDelegate(DataAcquisitionType monitorMode);

		private delegate void LoadHexEditorDelegate(ICalibration deviceAddress, Cummins.HexEditor.HexEditor hexEditor);

		private const string HexEditor = "Hex Editor";

		private const string DMMergeScreenVersion = "2.4.0";

		private const string CurrentScreenVersion = "2.4.0";

		private const string DefaultScreenPrefix = "Screen ";

		private const string ComplexParameterNameFormat = "{0}:{1}";

		private const string HexEditorLoadedMessage = "Hex editor loaded";

		private const string HexEditorOpeningMessage = "Please be patient while hex editor loads in background";

		private Hashtable hexEditors = new Hashtable();

		private IIntegratedCalibration integratedCalibration;

		private ISecurityService securityService;

		private EditorModel model;

		private Mutex monitorMutex = new Mutex();

		private object stateLock = new object();

		private MonitorState state;

		private Queue screenQueue = new Queue();

		private bool currentSystemMonitoringStatus;

		public IIntegratedCalibration IntegratedCalibration
		{
			get
			{
				return integratedCalibration;
			}
			set
			{
				try
				{
					monitorMutex.WaitOne();
					if (value != null)
					{
						integratedCalibration = value;
					}
				}
				finally
				{
					monitorMutex.ReleaseMutex();
				}
			}
		}

		private NewDataSet MonitorSession => Model.MonitorSession;

		public int CurrentScreenId
		{
			get
			{
				return Model.CurrentScreenId;
			}
			set
			{
				if (value != Model.CurrentScreenId)
				{
					Model.CurrentScreenId = value;
					if (model.Screens[Model.CurrentScreenId] is Screen { ScreenType: not MonitorScreenType.Complex } screen)
					{
						screen.SetGridFocus();
					}
				}
			}
		}

		public Screen CurrentScreen
		{
			get
			{
				Screen result = null;
				try
				{
					result = (Screen)Model.Screens[CurrentScreenId];
				}
				catch
				{
				}
				return result;
			}
		}

		public DataFormat Radix
		{
			get
			{
				DataFormat result = DataFormat.Decimal;
				if (CurrentScreenId >= 0)
				{
					result = ((Screen)Model.Screens[CurrentScreenId]).Radix;
				}
				return result;
			}
			set
			{
				Model.Radix = value;
				if (CurrentScreenId >= 0)
				{
					((Screen)Model.Screens[CurrentScreenId]).Radix = value;
				}
			}
		}

		public string DefaultScreenFilename => Model.DefaultScreenFilename;

		public IModuleNetwork Network
		{
			get
			{
				return Model.Network;
			}
			set
			{
				if (Network == null || Network.GetHashCode() != value.GetHashCode())
				{
					NetworkChangeDelegate networkChangeDelegate = SetNetwork;
					networkChangeDelegate.BeginInvoke(value, null, null);
				}
			}
		}

		public string ScreenFilename
		{
			get
			{
				return Model.ScreenFilename;
			}
			set
			{
				Model.ScreenFilename = value;
				foreach (Screen screen in Model.Screens)
				{
					screen.ScreenFilename = value;
				}
			}
		}

		public EditorModel Model => model;

		public bool IsDirty
		{
			get
			{
				bool flag = Model.IsDirty;
				if (!flag)
				{
					foreach (Screen screen in Model.Screens)
					{
						if (screen != null && screen.IsDirty)
						{
							flag = true;
							break;
						}
					}
				}
				return flag;
			}
			set
			{
				Model.IsDirty = value;
				if (value)
				{
					return;
				}
				foreach (Screen screen in Model.Screens)
				{
					if (screen != null)
					{
						screen.IsDirty = value;
					}
				}
			}
		}

		private MonitorState State
		{
			get
			{
				lock (stateLock)
				{
					return state;
				}
			}
			set
			{
				lock (stateLock)
				{
					state = value;
				}
			}
		}

		public event HexEditorScreenAddedEventHandler HexEditorScreenAddedEvent;

		public event HexEditorScreenRemoveEventHandler HexEditorScreenRemoveEvent;

		public event EventHandler MonitoringStarted;

		public event EventHandler MonitoringStopped;

		public event EventHandler AllScreensLoadedEvent;

		public event ScreenAddedEventHandler ScreenAddedEvent;

		public EditorController(EditorModel model)
		{
			this.model = model;
			securityService = (ISecurityService)ServiceManager.Services.GetService(typeof(ISecurityService));
			if (securityService == null)
			{
				throw new NullReferenceException("securityService is null");
			}
			integratedCalibration = null;
		}

		public void CleanupResources()
		{
			if (Network != null)
			{
				Network.ConnectionEstablished -= OnConnectionEstablished;
				Network.ConnectionLost -= OnConnectionLost;
				Network.SuspendMonitoringChanged -= OnSuspendMonitoringChanged;
				Network.PauseMonitoringChanged -= OnPauseMonitoring;
			}
		}

		public void SetParameterOwnerInterfaceToAllScreens()
		{
			try
			{
				monitorMutex.WaitOne();
				if (IntegratedCalibration == null)
				{
					return;
				}
				lock (Model.Screens)
				{
					for (int i = 0; i < Model.Screens.Count; i++)
					{
						try
						{
							Screen screen = (Screen)Model.Screens[i];
							screen.Controller.IntegratedCalibration = IntegratedCalibration;
						}
						catch (Exception ex)
						{
							EventLogger.Error("SetParameterOwnerInterfaceToAllScreens", "Failed to Set ParameterOwnerInterface To All Screens: " + ex.Message);
						}
					}
				}
			}
			finally
			{
				monitorMutex.ReleaseMutex();
			}
		}

		public void AddContextMenuToAllScreens()
		{
			try
			{
				monitorMutex.WaitOne();
				lock (Model.Screens)
				{
					for (int i = 0; i < Model.Screens.Count; i++)
					{
						try
						{
							Screen screen = (Screen)Model.Screens[i];
							screen.Controller.AddParameterOwnerContextMenu();
						}
						catch (Exception)
						{
						}
					}
				}
			}
			finally
			{
				monitorMutex.ReleaseMutex();
			}
		}

		public void PauseMonitoring()
		{
			MonitorDelegate monitorDelegate = PauseNetworkMonitoring;
			monitorDelegate.BeginInvoke(null, null, null);
		}

		public void PauseMonitoring(IAddressValue deviceAddress)
		{
			MonitorDelegate monitorDelegate = PauseDeviceMonitoring;
			monitorDelegate.BeginInvoke(deviceAddress, null, null);
		}

		private void PauseNetworkMonitoring(IAddressValue sourceAddress)
		{
			try
			{
				monitorMutex.WaitOne();
				lock (Model.Screens)
				{
					for (int i = 0; i < Model.Screens.Count; i++)
					{
						try
						{
							Screen screen = (Screen)Model.Screens[i];
							screen.PauseMonitoring();
						}
						catch (Exception)
						{
						}
					}
				}
			}
			finally
			{
				monitorMutex.ReleaseMutex();
			}
		}

		private void PauseDeviceMonitoring(IAddressValue deviceAddress)
		{
			try
			{
				monitorMutex.WaitOne();
				lock (Model.Screens)
				{
					for (int i = 0; i < Model.Screens.Count; i++)
					{
						try
						{
							Screen screen = (Screen)Model.Screens[i];
							screen.PauseMonitoring(deviceAddress);
						}
						catch (Exception)
						{
						}
					}
				}
			}
			finally
			{
				monitorMutex.ReleaseMutex();
			}
		}

		public void ResumeMonitoring()
		{
			MonitorDelegate monitorDelegate = ResumeNetworkMonitoring;
			monitorDelegate.BeginInvoke(null, null, null);
		}

		public void ResumeMonitoring(IAddressValue deviceAddress)
		{
			MonitorDelegate monitorDelegate = ResumeDeviceMonitoring;
			monitorDelegate.BeginInvoke(deviceAddress, null, null);
		}

		public void StartCurrentScreenMonitoring()
		{
			monitorMutex.WaitOne();
			try
			{
				CurrentScreen.Status = ScreenStatus.Active;
				CurrentScreen.StartMonitoring();
			}
			finally
			{
				monitorMutex.ReleaseMutex();
			}
		}

		public void StopCurrentScreenMonitoring()
		{
			monitorMutex.WaitOne();
			try
			{
				CurrentScreen.Status = ScreenStatus.Inactive;
				CurrentScreen.StopMonitoring();
			}
			finally
			{
				monitorMutex.ReleaseMutex();
			}
		}

		public ScreenStatus ToggleCurrentScreenMonitoring()
		{
			if (CurrentScreen.IsMonitoring)
			{
				StopCurrentScreenMonitoring();
			}
			else
			{
				StartCurrentScreenMonitoring();
			}
			return CurrentScreen.Status;
		}

		private void ResumeNetworkMonitoring(IAddressValue sourceAddress)
		{
			try
			{
				monitorMutex.WaitOne();
				lock (Model.Screens)
				{
					for (int i = 0; i < Model.Screens.Count; i++)
					{
						try
						{
							((Screen)Model.Screens[i]).ResumeMonitoring();
						}
						catch (Exception)
						{
						}
					}
				}
			}
			finally
			{
				monitorMutex.ReleaseMutex();
			}
		}

		private void ResumeDeviceMonitoring(IAddressValue deviceAddress)
		{
			try
			{
				monitorMutex.WaitOne();
				lock (Model.Screens)
				{
					for (int i = 0; i < Model.Screens.Count; i++)
					{
						try
						{
							((Screen)Model.Screens[i]).ResumeMonitoring(deviceAddress);
						}
						catch (Exception)
						{
						}
					}
				}
			}
			finally
			{
				monitorMutex.ReleaseMutex();
			}
		}

		private void StartMonitoring()
		{
			MonitorDelegate monitorDelegate = StartNetworkMonitoring;
			monitorDelegate.BeginInvoke(null, null, null);
		}

		private void StartMonitoring(IAddressValue deviceAddress)
		{
			MonitorDelegate monitorDelegate = StartDeviceMonitoring;
			monitorDelegate.BeginInvoke(deviceAddress, null, null);
		}

		private void RaiseMonitoringStopped()
		{
			if (this.MonitoringStopped != null)
			{
				this.MonitoringStopped(this, EventArgs.Empty);
			}
		}

		private void RaiseMonitoringStarted()
		{
			if (this.MonitoringStarted != null)
			{
				this.MonitoringStarted(this, EventArgs.Empty);
			}
		}

		private void StartNetworkMonitoring(IAddressValue deviceAddress)
		{
			StartActiveScreensMonitoring();
		}

		private void StartDeviceMonitoring(IAddressValue deviceAddress)
		{
			lock (Model.Screens)
			{
				if (Model.Screens.Count <= 0)
				{
					return;
				}
				monitorMutex.WaitOne();
				ManualResetEvent[] array = new ManualResetEvent[Model.Screens.Count];
				for (int i = 0; i < Model.Screens.Count; i++)
				{
					Screen screen = (Screen)Model.Screens[i];
					array[i] = new ManualResetEvent(initialState: true);
					if (screen.Status == ScreenStatus.Active)
					{
						array[i].Reset();
						ScreenSynchronize screenSynchronize = new ScreenSynchronize(screen, array[i], deviceAddress);
						ThreadPool.QueueUserWorkItem(StartScreenDeviceMonitoring, screenSynchronize);
					}
				}
				WaitHandle.WaitAll(array);
				monitorMutex.ReleaseMutex();
			}
		}

		private void StopMonitoring()
		{
			MonitorDelegate monitorDelegate = StopNetworkMonitoring;
			monitorDelegate.BeginInvoke(null, null, null);
		}

		private void StopMonitoring(IAddressValue deviceAddress)
		{
			MonitorDelegate monitorDelegate = StopDeviceMonitoring;
			monitorDelegate.BeginInvoke(deviceAddress, null, null);
		}

		private void StopNetworkMonitoring(IAddressValue deviceAddress)
		{
			lock (Model.Screens)
			{
				if (Model.Screens.Count <= 0)
				{
					return;
				}
				monitorMutex.WaitOne();
				ManualResetEvent[] array = new ManualResetEvent[Model.Screens.Count];
				for (int i = 0; i < Model.Screens.Count; i++)
				{
					Screen screen = (Screen)Model.Screens[i];
					array[i] = new ManualResetEvent(initialState: true);
					if (screen.Status == ScreenStatus.Active)
					{
						array[i].Reset();
						ScreenSynchronize screenSynchronize = new ScreenSynchronize(screen, array[i]);
						ThreadPool.QueueUserWorkItem(StopScreenMonitoring, screenSynchronize);
					}
				}
				WaitHandle.WaitAll(array);
				monitorMutex.ReleaseMutex();
				RaiseMonitoringStopped();
			}
		}

		private void StopDeviceMonitoring(IAddressValue deviceAddress)
		{
			lock (Model.Screens)
			{
				if (Model.Screens.Count <= 0)
				{
					return;
				}
				monitorMutex.WaitOne();
				ManualResetEvent[] array = new ManualResetEvent[Model.Screens.Count];
				for (int i = 0; i < Model.Screens.Count; i++)
				{
					Screen screen = (Screen)Model.Screens[i];
					array[i] = new ManualResetEvent(initialState: true);
					if (screen.Status == ScreenStatus.Active)
					{
						array[i].Reset();
						ScreenSynchronize screenSynchronize = new ScreenSynchronize(screen, array[i], deviceAddress);
						ThreadPool.QueueUserWorkItem(StopScreenDeviceMonitoring, screenSynchronize);
					}
				}
				WaitHandle.WaitAll(array);
				monitorMutex.ReleaseMutex();
			}
		}

		private void AddScreen(IParameterModel parameterModel)
		{
			try
			{
				Screen screen = AddScreen(parameterModel.DataSource.SourceAddress, MonitorScreenType.Complex, parameterModel.Name, isScreenLoading: false);
				screen.AddMonitoredElement(parameterModel);
			}
			catch (MonitorElementNotAddedException)
			{
				RemoveScreen(CurrentScreenId);
			}
		}

		public void InvokeHexEditor(ICalibration datasource)
		{
			Cummins.HexEditor.HexEditor hexEditor = null;
			if (Model.HexEditorList.ContainsKey(datasource.SourceAddress.DisplayId))
			{
				hexEditor = (Cummins.HexEditor.HexEditor)Model.HexEditorList[datasource.SourceAddress.DisplayId];
			}
			else
			{
				EventLogger.Info("Hex Editor", "Please be patient while hex editor loads in background");
				hexEditor = new Cummins.HexEditor.HexEditor();
				if (Network != null)
				{
					currentSystemMonitoringStatus = Network.SystemSuspendAllMonitoring;
					Network.SystemSuspendAllMonitoring = true;
				}
				LoadHexEditorDelegate loadHexEditorDelegate = LoadHexEditor;
				loadHexEditorDelegate.BeginInvoke(datasource, hexEditor, null, null);
				Model.HexEditorList.Add(datasource.SourceAddress.DisplayId, hexEditor);
			}
			RaiseHexEditorScreenAddedEvent(hexEditor.View, datasource.SourceAddress);
		}

		public void RemoveHexEditor(IAddressValue sourceAddress)
		{
			Cummins.HexEditor.HexEditor hexEditor = null;
			bool flag = false;
			if (Model.HexEditorList.ContainsKey(sourceAddress.DisplayId))
			{
				hexEditor = (Cummins.HexEditor.HexEditor)Model.HexEditorList[sourceAddress.DisplayId];
				flag = hexEditor.View.Controller.Shutdown(requestSavePrompt: true);
			}
			if (flag)
			{
				Model.HexEditorList.Remove(sourceAddress.DisplayId);
				RaiseHexEditorScreenRemoveEvent(sourceAddress);
			}
		}

		private void RaiseHexEditorScreenAddedEvent(HexEditorView hexEdiorView, IAddressValue sourceAddress)
		{
			if (this.HexEditorScreenAddedEvent != null)
			{
				HexEditorScreenAddedEventArgs e = new HexEditorScreenAddedEventArgs(hexEdiorView, sourceAddress);
				this.HexEditorScreenAddedEvent(this, e);
			}
		}

		private void RaiseHexEditorScreenRemoveEvent(IAddressValue sourceAddress)
		{
			if (this.HexEditorScreenRemoveEvent != null)
			{
				HexEditorScreenRemoveEventArgs e = new HexEditorScreenRemoveEventArgs(sourceAddress);
				this.HexEditorScreenRemoveEvent(this, e);
			}
		}

		public Screen AddScreen(IAddressValue sourceAddress, MonitorScreenType screenType, string screenName, bool isScreenLoading)
		{
			Screen screen = new Screen(screenType, Model.DataSources, sourceAddress, Model.DataSourceName);
			if (screenName == null || screenName.Length == 0)
			{
				screenName = GetNextScreenName();
			}
			screen.Name = screenName;
			screen.ScreenFilename = ScreenFilename;
			ConfigureScreen(screen, isScreenLoading);
			if (!isScreenLoading)
			{
				CreateScreenRow(screen);
			}
			Model.AddScreen(screen);
			if (IntegratedCalibration != null)
			{
				screen.Controller.IntegratedCalibration = IntegratedCalibration;
				screen.Controller.AddParameterOwnerContextMenu();
			}
			CurrentScreenId = Model.Screens.Count - 1;
			RaiseScreenAddedEvent(screen);
			return screen;
		}

		private void CreateScreenRow(Screen screen)
		{
			lock (MonitorSession)
			{
				NewDataSet.ScreenRow screenRow = MonitorSession.Screen.NewScreenRow();
				if (MonitorSession.MonitorSession.Rows.Count == 0)
				{
					NewDataSet.MonitorSessionRow monitorSessionRow = MonitorSession.MonitorSession.NewMonitorSessionRow();
					monitorSessionRow.Version = "2.4.0";
					MonitorSession.MonitorSession.AddMonitorSessionRow(monitorSessionRow);
				}
				screenRow.MonitorSessionRow = (NewDataSet.MonitorSessionRow)MonitorSession.MonitorSession.Rows[0];
				screenRow.Name = screen.Name;
				screenRow.Title = screen.Title;
				screenRow.ScreenType = screen.ScreenType.ToString();
				screenRow.DataRefreshRate = (ushort)screen.MonitorDataRefreshRate;
				screenRow.DataRefreshUnits = screen.DataRefreshUnits.ToString();
				screenRow.MonitorType = screen.MonitorMode.ToString();
				MonitorSession.Screen.AddScreenRow(screenRow);
				AddGroupRow(screenRow);
				if (screen.ScreenType == MonitorScreenType.Normal)
				{
					AddGroupRow(screenRow);
				}
				IsDirty = true;
			}
		}

		private void CreateScreenColums(Screen screen)
		{
			switch (screen.ScreenType)
			{
			case MonitorScreenType.Graphical:
				screen.AddColumn();
				break;
			case MonitorScreenType.Normal:
				screen.AddColumn();
				screen.AddColumn();
				break;
			case MonitorScreenType.Complex:
				break;
			}
		}

		private void RaiseScreenAddedEvent(Screen screen)
		{
			if (this.ScreenAddedEvent != null)
			{
				ScreenAddedEventArgs e = new ScreenAddedEventArgs(screen);
				this.ScreenAddedEvent(this, e);
			}
		}

		private void AddGroupRow(NewDataSet.ScreenRow screenRow)
		{
			NewDataSet.GroupRow groupRow = ((NewDataSet)screenRow.Table.DataSet).Group.NewGroupRow();
			groupRow.ScreenRow = screenRow;
			groupRow.Name = "Group";
			groupRow.Comment = "Comment";
			((NewDataSet)screenRow.Table.DataSet).Group.AddGroupRow(groupRow);
		}

		private void ConfigureScreen(Screen screen, bool isScreenLoading)
		{
			screen.Network = Network;
			screen.SetCommonOptions();
			if (!isScreenLoading)
			{
				CreateScreenColums(screen);
			}
			screen.MonitorModeChanged += OnChangeMonitorMode;
			screen.ScreenNameChangingEvent += OnScreenNameChanging;
			screen.ScreenNameChangedEvent += OnScreenNameChanged;
			screen.ScreenMonitorStatusChangedEvent += OnScreenMonitorStatusChanged;
			screen.MonitoredElementAddingEvent += OnMonitoredElementAddingEvent;
		}

		public void RemoveScreen(int id)
		{
			Screen screen = (Screen)Model.Screens[id];
			bool isDirty = true;
			if (screen == null)
			{
				return;
			}
			try
			{
				string name = screen.Name;
				lock (MonitorSession)
				{
					NewDataSet.ScreenRow screenRow = GetScreenRow(name);
					if (screenRow != null)
					{
						((Screen)Model.Screens[id]).Cleanse(screenRow);
						MonitorSession.Screen.Rows.Remove(screenRow);
					}
				}
				screen.MonitorModeChanged -= OnChangeMonitorMode;
				screen.ScreenNameChangingEvent -= OnScreenNameChanging;
				screen.ScreenNameChangedEvent -= OnScreenNameChanged;
				screen.ScreenMonitorStatusChangedEvent -= OnScreenMonitorStatusChanged;
				screen.MonitoredElementAddingEvent -= OnMonitoredElementAddingEvent;
				PreviousScreen();
				Model.RemoveScreen(id);
				if (ShouldAddScreen())
				{
					Screen screen2 = AddScreen(Model.CurrentSourceAddress, MonitorScreenType.Normal, string.Empty, isScreenLoading: false);
					if (screen2.Status == ScreenStatus.Active)
					{
						screen2.StartMonitoring();
					}
					isDirty = false;
				}
				IsDirty = isDirty;
			}
			catch (ArgumentOutOfRangeException)
			{
			}
			catch (Exception)
			{
				EventLogger.Warn("Editor", "Could not remove the screen");
			}
		}

		public void RemoveAllScreens()
		{
			MonitorSession.Screen.RowChanged -= OnScreenRowChanged;
			try
			{
				foreach (Screen screen in Model.Screens)
				{
					screen.MonitorModeChanged -= OnChangeMonitorMode;
					screen.ScreenNameChangingEvent -= OnScreenNameChanging;
					screen.ScreenNameChangedEvent -= OnScreenNameChanged;
					screen.ScreenMonitorStatusChangedEvent -= OnScreenMonitorStatusChanged;
					screen.MonitoredElementAddingEvent -= OnMonitoredElementAddingEvent;
					NewDataSet.ScreenRow screenRow = GetScreenRow(screen.Name);
					if (screenRow != null)
					{
						MonitorSession.Screen.Rows.Remove(screenRow);
					}
				}
			}
			catch (Exception)
			{
			}
			Model.RemoveAllScreens();
			MonitorSession.Clear();
			IsDirty = true;
		}

		public void NextScreen()
		{
			if (Model.Screens.Count > 1)
			{
				if (CurrentScreenId < Model.Screens.Count - 1)
				{
					CurrentScreenId++;
				}
				else
				{
					CurrentScreenId = 0;
				}
			}
		}

		public void PreviousScreen()
		{
			if (Model.Screens.Count > 1)
			{
				if (CurrentScreenId > 0)
				{
					CurrentScreenId--;
				}
				else
				{
					CurrentScreenId = Model.Screens.Count - 1;
				}
			}
		}

		public bool SaveSession()
		{
			return SaveSession(ScreenFilename);
		}

		public bool SaveSession(string filename)
		{
			bool flag = false;
			NewDataSet.ScreenRow screenRow = null;
			try
			{
				NewDataSet.MonitorSessionRow monitorSessionRow = (NewDataSet.MonitorSessionRow)MonitorSession.MonitorSession.Rows[0];
				monitorSessionRow.Version = "2.4.0";
				monitorSessionRow.ActiveScreen = CurrentScreen.Name;
				foreach (Screen screen in Model.Screens)
				{
					StringBuilder stringBuilder = new StringBuilder();
					stringBuilder.Append("Title = '");
					stringBuilder.Append(screen.Title);
					stringBuilder.Append("'");
					screenRow = GetScreenRow(stringBuilder);
					if (screenRow != null)
					{
						screen.Cleanse(screenRow);
						screen.Save(screenRow);
					}
					ScreenFilename = filename.Substring(filename.LastIndexOf("\\") + 1, filename.Length - filename.LastIndexOf("\\") - 1);
					screen.ScreenFilename = ScreenFilename;
				}
				MonitorSession.WriteXml(filename, XmlWriteMode.IgnoreSchema);
				flag = true;
				IsDirty = false;
				EventLogger.Info("Editor", "Saved screen file: " + filename);
			}
			catch (Exception e)
			{
				flag = false;
				EventLogger.Error("Editor", "Failed to save screen file: " + filename, e);
			}
			return flag;
		}

		public void LoadSession(string screenFilename)
		{
			Screen screen = null;
			string text = "";
			try
			{
				PauseActiveScreensMonitoring();
				RemoveAllScreens();
				if (File.Exists(screenFilename))
				{
					OpenScreenFile(screenFilename);
					ScreenFilename = screenFilename.Substring(screenFilename.LastIndexOf("\\") + 1, screenFilename.Length - screenFilename.LastIndexOf("\\") - 1);
					NewDataSet.MonitorSessionRow monitorSessionRow = (NewDataSet.MonitorSessionRow)MonitorSession.MonitorSession.Rows[0];
					text = ((monitorSessionRow.Version.CompareTo("1.2.0") >= 0) ? monitorSessionRow.ActiveScreen : "");
					foreach (NewDataSet.ScreenRow row in MonitorSession.Screen.Rows)
					{
						MonitorScreenType monitorScreenType = MonitorScreenType.Normal;
						if (monitorSessionRow.Version.CompareTo("2.0.0") < 0)
						{
							monitorScreenType = MonitorScreenType.Normal;
							row["ScreenType"] = "Normal";
						}
						else
						{
							try
							{
								monitorScreenType = (MonitorScreenType)Enum.Parse(typeof(MonitorScreenType), row.ScreenType);
							}
							catch
							{
								monitorScreenType = MonitorScreenType.Normal;
							}
						}
						if (monitorSessionRow.Version.CompareTo("2.2.0") < 0)
						{
							row.Title = string.Empty;
							if (text == row.Name)
							{
								row.Status = "Active";
							}
							else
							{
								row.Status = "InActive";
							}
							row.LogMode = "Any Data";
							row.LogRate = 1;
							row.LogUnit = "ms";
							row.LogPrefix = string.Empty;
							row.PCTimestamp = false;
							row.ActiveFaults = false;
							row.InactiveFaults = false;
							row.StopCondition = string.Empty;
							row.StartCondition = string.Empty;
							row.PreTrigger = 5;
							row.PostTrigger = 60;
							row.RepeatCount = 0;
							row.PositionX = 0;
							row.PositionY = 0;
							row.Height = 0;
							row.Width = 0;
							row.Dock = "Document";
						}
						if (monitorSessionRow.Version.CompareTo("2.2.1") < 0)
						{
							NewDataSet.GroupRow[] groupRows = row.GetGroupRows();
							foreach (NewDataSet.GroupRow groupRow in groupRows)
							{
								NewDataSet.GaugeConfigurationRow[] gaugeConfigurationRows = groupRow.GetGaugeConfigurationRows();
								foreach (NewDataSet.GaugeConfigurationRow gaugeConfigurationRow in gaugeConfigurationRows)
								{
									gaugeConfigurationRow.ShowGauges = false;
								}
							}
						}
						IAddressValue sourceAddress = Model.CurrentSourceAddress;
						if (MonitorScreenType.Complex == monitorScreenType)
						{
							try
							{
								IAddressValue addressValue = AddressFactory.ProductAddressValue(row.GetGroupRows()[0].GetParameterRows()[0].SourceAddress);
								if (Model.DataSources.Contains(addressValue))
								{
									sourceAddress = addressValue;
								}
							}
							catch
							{
							}
						}
						screen = AddScreen(sourceAddress, monitorScreenType, row.Name, isScreenLoading: true);
						try
						{
							row.Title = screen.Title;
							screen.Initialize(row);
							screen.Restore(row);
							screen.MonitoredElementAddingEvent += OnMonitoredElementAddingEvent;
						}
						catch (Exception e)
						{
							EventLogger.Error("Editor", "Could not load screen: " + screen.Name, e);
						}
					}
					MonitorSession.Screen.RowChanged += OnScreenRowChanged;
					EventLogger.Log("Editor", "Loaded screen file: " + screenFilename);
				}
			}
			catch (Exception e2)
			{
				EventLogger.Error("Editor", "Failed to load screen file: " + screenFilename, e2);
			}
			int num = 0;
			if (Model.Screens.Count == 0)
			{
				AddScreen(Model.CurrentSourceAddress, MonitorScreenType.Normal, string.Empty, isScreenLoading: false);
			}
			else if (text != null && text.Length > 0)
			{
				num = Model.Screens.IndexOf(GetScreen(text));
				if (num < 0)
				{
					num = 0;
				}
			}
			CurrentScreenId = num;
			RaiseAllScreensLoadedEvent();
			if (Network == null || (Network != null && !Network.SystemSuspendAllMonitoring))
			{
				Thread thread = new Thread(StartActiveScreensMonitoring);
				thread.Start();
			}
			IsDirty = false;
		}

		private void PauseActiveScreensMonitoring()
		{
			foreach (Screen screen in Model.Screens)
			{
				try
				{
					if (screen.Status == ScreenStatus.Active)
					{
						screen.PauseMonitoring();
					}
				}
				catch (Exception)
				{
				}
			}
		}

		private void WaitForAllHandles(ManualResetEvent[] handles)
		{
			if (handles.Length <= 64)
			{
				WaitHandle.WaitAll(handles);
				return;
			}
			int i = 0;
			int num = 0;
			Type elementType = handles.GetType().GetElementType();
			for (; i < handles.Length; i += num)
			{
				num = ((handles.Length - i > 64) ? 64 : (handles.Length - i));
				Array array = Array.CreateInstance(elementType, num);
				Array.Copy(handles, i, array, 0, num);
				WaitHandle.WaitAll((ManualResetEvent[])array);
			}
		}

		private void StartActiveScreensMonitoring()
		{
			lock (Model.Screens)
			{
				if (Model.Screens.Count <= 0)
				{
					return;
				}
				monitorMutex.WaitOne();
				try
				{
					ManualResetEvent[] array = new ManualResetEvent[Model.Screens.Count];
					for (int i = 0; i < Model.Screens.Count; i++)
					{
						Screen screen = (Screen)Model.Screens[i];
						array[i] = new ManualResetEvent(initialState: true);
						if (screen != null && screen.Status == ScreenStatus.Active)
						{
							array[i].Reset();
							ScreenSynchronize screenSynchronize = new ScreenSynchronize(screen, array[i]);
							ThreadPool.QueueUserWorkItem(LoadScreen, screenSynchronize);
						}
					}
					WaitForAllHandles(array);
					ManualResetEvent[] array2 = new ManualResetEvent[Model.Screens.Count];
					for (int j = 0; j < Model.Screens.Count; j++)
					{
						Screen screen2 = (Screen)Model.Screens[j];
						array2[j] = new ManualResetEvent(initialState: true);
						if (screen2 != null && screen2.Status == ScreenStatus.Active)
						{
							array2[j].Reset();
							ScreenSynchronize screenSynchronize2 = new ScreenSynchronize(screen2, array2[j]);
							ThreadPool.QueueUserWorkItem(StartScreen, screenSynchronize2);
						}
					}
					WaitForAllHandles(array2);
					RaiseMonitoringStarted();
				}
				finally
				{
					monitorMutex.ReleaseMutex();
				}
			}
		}

		private void LoadScreen(object screenSynchronize)
		{
			if (screenSynchronize is ScreenSynchronize)
			{
				ScreenSynchronize screenSynchronize2 = screenSynchronize as ScreenSynchronize;
				try
				{
					screenSynchronize2.Screen.LoadScreen();
				}
				catch (Exception)
				{
				}
				screenSynchronize2.ScreenStateEvent.Set();
			}
		}

		private void StopScreenDeviceMonitoring(object screenSynchronize)
		{
			if (screenSynchronize is ScreenSynchronize)
			{
				ScreenSynchronize screenSynchronize2 = screenSynchronize as ScreenSynchronize;
				try
				{
					screenSynchronize2.Screen.StopMonitoring(screenSynchronize2.DeviceAddress);
				}
				catch (Exception)
				{
				}
				screenSynchronize2.ScreenStateEvent.Set();
			}
		}

		private void StartScreenDeviceMonitoring(object screenSynchronize)
		{
			if (screenSynchronize is ScreenSynchronize)
			{
				ScreenSynchronize screenSynchronize2 = screenSynchronize as ScreenSynchronize;
				try
				{
					screenSynchronize2.Screen.StartMonitoring(screenSynchronize2.DeviceAddress);
				}
				catch (Exception)
				{
				}
				screenSynchronize2.ScreenStateEvent.Set();
			}
		}

		private void StopScreenMonitoring(object screenSynchronize)
		{
			if (screenSynchronize is ScreenSynchronize)
			{
				ScreenSynchronize screenSynchronize2 = screenSynchronize as ScreenSynchronize;
				try
				{
					screenSynchronize2.Screen.StopMonitoring();
				}
				catch (Exception)
				{
				}
				screenSynchronize2.ScreenStateEvent.Set();
			}
		}

		private void StartScreenMonitoring(object screenSynchronize)
		{
			if (screenSynchronize is ScreenSynchronize)
			{
				ScreenSynchronize screenSynchronize2 = screenSynchronize as ScreenSynchronize;
				try
				{
					screenSynchronize2.Screen.StartMonitoring();
				}
				catch (Exception)
				{
				}
				screenSynchronize2.ScreenStateEvent.Set();
			}
		}

		private void StartScreen(object screenSynchronize)
		{
			if (screenSynchronize is ScreenSynchronize)
			{
				ScreenSynchronize screenSynchronize2 = screenSynchronize as ScreenSynchronize;
				try
				{
					screenSynchronize2.Screen.StartScreen();
				}
				catch (Exception)
				{
				}
				screenSynchronize2.ScreenStateEvent.Set();
			}
		}

		private void RaiseAllScreensLoadedEvent()
		{
			if (this.AllScreensLoadedEvent != null)
			{
				this.AllScreensLoadedEvent(this, EventArgs.Empty);
			}
		}

		private Screen GetScreenByTitle(string title)
		{
			Screen result = null;
			foreach (Screen screen in Model.Screens)
			{
				if (screen.Title == title)
				{
					result = screen;
					break;
				}
			}
			return result;
		}

		private Screen GetScreen(string screenName)
		{
			Screen result = null;
			foreach (Screen screen in Model.Screens)
			{
				if (screen.Name == screenName)
				{
					result = screen;
					break;
				}
			}
			return result;
		}

		public NewDataSet.ScreenRow GetScreenRow(StringBuilder screenFilter)
		{
			NewDataSet.ScreenRow result = null;
			DataRow[] array = MonitorSession.Screen.Select(screenFilter.ToString());
			if (array.Length == 1)
			{
				result = (NewDataSet.ScreenRow)array[0];
			}
			return result;
		}

		public void UpdateScreenRow(string oldTitle, string newTitle)
		{
			StringBuilder stringBuilder = new StringBuilder();
			stringBuilder.Append("Title = '" + oldTitle + "'");
			NewDataSet.ScreenRow screenRow = GetScreenRow(stringBuilder);
			if (screenRow != null)
			{
				screenRow["Title"] = newTitle;
				screenRow.AcceptChanges();
			}
		}

		public NewDataSet.ScreenRow GetScreenRow(string screenName)
		{
			StringBuilder stringBuilder = new StringBuilder();
			NewDataSet.ScreenRow result = null;
			stringBuilder.Append("Name = '");
			stringBuilder.Append(screenName);
			stringBuilder.Append("'");
			DataRow[] array = MonitorSession.Screen.Select(stringBuilder.ToString());
			if (array.Length == 1)
			{
				result = (NewDataSet.ScreenRow)array[0];
			}
			else if (array.Length > 1)
			{
				stringBuilder = new StringBuilder();
				stringBuilder.Append("Title = '");
				stringBuilder.Append(CurrentScreen.Title);
				stringBuilder.Append("'");
				array = MonitorSession.Screen.Select(stringBuilder.ToString());
				if (array.Length == 1)
				{
					result = (NewDataSet.ScreenRow)array[0];
				}
			}
			return result;
		}

		private void OpenScreenFile(string filename)
		{
			//IL_0001: Unknown result type (might be due to invalid IL or missing references)
			//IL_0007: Expected O, but got Unknown
			try
			{
				XmlTextReader reader = new XmlTextReader(filename);
				MonitorSession.ReadXml((XmlReader?)(object)reader);
				MonitorSession.AcceptChanges();
				DataTable dataTable = MonitorSession.Tables["Screen"];
				if (dataTable == null)
				{
					throw new NullReferenceException("Monitoring DataSet must contain a Screen table");
				}
			}
			catch (ConstraintException ex)
			{
				foreach (DataTable table in MonitorSession.Tables)
				{
					if (!table.HasErrors)
					{
						continue;
					}
					DataRow[] errors = table.GetErrors();
					for (int i = 0; i < errors.GetUpperBound(0); i++)
					{
						foreach (DataColumn column in table.Columns)
						{
							_ = column;
						}
					}
				}
				throw ex;
			}
			catch (Exception ex2)
			{
				throw ex2;
			}
		}

		public bool Save(bool overwrite)
		{
			//IL_00a3: Unknown result type (might be due to invalid IL or missing references)
			//IL_00a9: Invalid comparison between Unknown and I4
			bool result = true;
			_ = CurrentScreenId;
			IDirectoryService directoryService = (IDirectoryService)ServiceManager.Services.GetService(typeof(IDirectoryService));
			IAppConfigService appConfigService = (IAppConfigService)ServiceManager.Services.GetService(typeof(IAppConfigService));
			string text = directoryService.FolderName(FolderType.Product, appConfigService.GetAppSetting(ApplicationSettings.LastProduct));
			string appSetting = appConfigService.GetAppSetting(ApplicationSettings.LastProduct);
			_ = text + "\\" + appSetting;
			SafeSaveFileDialog safeSaveFileDialog = new SafeSaveFileDialog();
			safeSaveFileDialog.Title = "Save the screen file";
			safeSaveFileDialog.DefaultExt = "*.scr.xml";
			safeSaveFileDialog.InitialDirectory = text;
			safeSaveFileDialog.FileName = appSetting;
			safeSaveFileDialog.Filter = "Screen File (*.scr.xml)|*.scr.xml|All files (*.*)|*.*";
			if ((int)safeSaveFileDialog.ShowDialog() == 1)
			{
				_ = safeSaveFileDialog.FileName;
			}
			try
			{
				DataSet dataSet = new DataSet();
				foreach (DataRow row in dataSet.Tables["ParameterRow"].Rows)
				{
					row["Value"] = "";
					row["Value2"] = "";
				}
				dataSet.AcceptChanges();
			}
			catch (Exception)
			{
				result = false;
			}
			return result;
		}

		public void OnDataMonitorOptionsChanged(object sender, EventArgs e)
		{
			foreach (Screen screen in Model.Screens)
			{
				screen.SetCommonOptions();
			}
		}

		private void OnChangeMonitorMode(object sender, MonitorModeEventArgs e)
		{
			Model.RaiseMonitorModeChangedEvent(e.Mode);
		}

		private bool ShouldAddScreen()
		{
			bool result = true;
			Screen screen = null;
			for (int i = 0; i < Model.Screens.Count; i++)
			{
				screen = (Screen)Model.Screens[i];
				if (screen.ScreenType != MonitorScreenType.Complex)
				{
					result = false;
					break;
				}
			}
			return result;
		}

		public void SetCurrentScreen(string screenTitle)
		{
			int screenID = Model.GetScreenID(screenTitle);
			CurrentScreenId = screenID;
		}

		public void AddParameters(string screenName, StringCollection parameters, bool isAppend, bool isBroadcast, IAddressValue sourceAddress)
		{
			Screen screen = null;
			GetScreen(screenName)?.AddParameters(parameters, isAppend, isBroadcast, sourceAddress);
		}

		private void SetNetwork(IModuleNetwork network)
		{
			monitorMutex.WaitOne();
			try
			{
				if (Network != null)
				{
					Network.ConnectionEstablished -= OnConnectionEstablished;
					Network.ConnectionLost -= OnConnectionLost;
					Network.SuspendMonitoringChanged -= OnSuspendMonitoringChanged;
				}
				Model.Network = network;
				if (Model.Screens.Count != 0)
				{
					foreach (Screen screen in Model.Screens)
					{
						screen.Network = Model.Network;
					}
				}
				if (Network != null)
				{
					Network.ConnectionEstablished += OnConnectionEstablished;
					Network.ConnectionLost += OnConnectionLost;
					Network.SuspendMonitoringChanged += OnSuspendMonitoringChanged;
					Network.PauseMonitoringChanged += OnPauseMonitoring;
				}
			}
			finally
			{
				monitorMutex.ReleaseMutex();
			}
		}

		private void SetMonitorMode(DataAcquisitionType monitorMode)
		{
			monitorMutex.WaitOne();
			try
			{
				Model.MonitorMode = monitorMode;
			}
			finally
			{
				monitorMutex.ReleaseMutex();
			}
		}

		private void OnScreenNameChanged(object sender, ScreenNameChangedEventArgs args)
		{
			NewDataSet.ScreenRow screenRow = null;
			StringBuilder stringBuilder = new StringBuilder();
			stringBuilder.Append("Name = '");
			stringBuilder.Append(args.PreviousScreenName);
			stringBuilder.Append("'");
			screenRow = GetScreenRow(stringBuilder);
			if (screenRow != null)
			{
				if (screenRow.Title == args.PreviousLongScreenName)
				{
					screenRow.Title = args.NewLongScreenName;
				}
				else
				{
					screenRow.Title = args.NewScreenName;
				}
				screenRow.Name = args.NewScreenName;
			}
		}

		private void OnScreenNameChanging(object sender, ScreenNameChangingEventArgs args)
		{
			NewDataSet.ScreenRow screenRow = null;
			screenRow = GetScreenRow(args.ProposedName);
			if (screenRow != null)
			{
				EventLogger.Error("Editor", "Can not change the screen name because multiple screens with the same name " + args.ProposedName);
				args.Cancel = true;
			}
			else
			{
				args.Cancel = false;
				Screen screenByTitle = GetScreenByTitle(args.PreviousTitle);
				screenByTitle.Name = args.ProposedName;
			}
		}

		protected void OnConnectionEstablished(object sender, DeviceAddressEventArgs e)
		{
			StartMonitoring(e.DeviceAddress);
		}

		protected void OnConnectionLost(object sender, DeviceAddressEventArgs e)
		{
			StopMonitoring(e.DeviceAddress);
		}

		private void OnSuspendMonitoringChanged(object sender, SuspendMonitoringChangedEventArgs e)
		{
			if (!e.SuspendDataMonitoring)
			{
				return;
			}
			if (e.Suspend)
			{
				if (e.AllDevices)
				{
					StopMonitoring();
				}
				else
				{
					StopMonitoring(e.DeviceAddress);
				}
			}
			else if (e.AllDevices)
			{
				StartMonitoring();
			}
			else
			{
				StartMonitoring(e.DeviceAddress);
			}
		}

		private void OnPauseMonitoring(object sender, PauseMonitoringChangedEventArgs args)
		{
			if (args.PauseMonitoring)
			{
				PauseMonitoring();
			}
			else
			{
				ResumeMonitoring();
			}
		}

		private void OnScreenRowChanged(object sender, DataRowChangeEventArgs e)
		{
			if (e.Action == DataRowAction.Change)
			{
				IsDirty = true;
			}
		}

		private string GetNextScreenName()
		{
			int num = Model.Screens.Count;
			string text = "Screen " + num;
			while (MonitorSession.Screen.Select("Name ='" + text + "'").Length > 0)
			{
				num++;
				text = "Screen " + num;
			}
			return text;
		}

		private Screen GetComplexScreenIfPresent(string complexParameterName)
		{
			Screen result = null;
			foreach (Screen screen in Model.Screens)
			{
				if (screen.ComplexParameterName == complexParameterName)
				{
					result = screen;
					break;
				}
			}
			return result;
		}

		private void OnMonitoredElementAddingEvent(object sender, IParameterModel e)
		{
			string complexParameterName = $"{e.Name}:{e.DataSource.SourceAddress.DisplayId}";
			Screen complexScreenIfPresent = GetComplexScreenIfPresent(complexParameterName);
			if (complexScreenIfPresent == null)
			{
				AddScreen(e);
			}
			else
			{
				CurrentScreenId = Model.GetScreenID(complexScreenIfPresent.Title);
			}
		}

		private void OnScreenMonitorStatusChanged(object sender, ScreenMonitorStatusChangedEventArgs e)
		{
			lock (MonitorSession)
			{
				NewDataSet.ScreenRow screenRow = GetScreenRow(e.ScreenName);
				if (screenRow != null)
				{
					screenRow.BeginEdit();
					screenRow.Status = e.NewStatus.ToString();
					screenRow.EndEdit();
				}
			}
		}

		private void LoadHexEditor(ICalibration datasource, Cummins.HexEditor.HexEditor hexEditor)
		{
			hexEditor.OpenHexEdit(datasource);
			if (Network != null)
			{
				Network.SystemSuspendAllMonitoring = currentSystemMonitoringStatus;
			}
			EventLogger.Info("Hex Editor", "Hex editor loaded");
		}
	}
	public class ScreenMonitorStatusChangedEventArgs : EventArgs
	{
		private string screenName = string.Empty;

		private ScreenStatus newStatus;

		public string ScreenName => screenName;

		public ScreenStatus NewStatus => newStatus;

		public ScreenMonitorStatusChangedEventArgs(string screenName, ScreenStatus newStatus)
		{
			this.screenName = screenName;
			this.newStatus = newStatus;
		}
	}
	public class HexEditorScreenAddedEventArgs : EventArgs
	{
		public HexEditorView hexEditView;

		public IAddressValue address;

		public HexEditorScreenAddedEventArgs(HexEditorView view, IAddressValue sourceAddress)
		{
			hexEditView = view;
			address = sourceAddress;
		}
	}
	public class HexEditorScreenRemoveEventArgs : EventArgs
	{
		public IAddressValue address;

		public HexEditorScreenRemoveEventArgs(IAddressValue sourceAddress)
		{
			address = sourceAddress;
		}
	}
	internal enum EditorMessageIDs
	{
		ResourceNotPresent,
		UnableToGetCalibrationForSourceAddress,
		MonitoringByThisModeIsNotSupported,
		UnableToGetChangeLock,
		UnableToChangeRunLocation,
		BAMNotInDevelopmentMode,
		MonitorModeNotSupported,
		TableEditNotAllowedForField,
		StructureAndStructureArrayEditNotAllowedForField,
		ArrayIndexOutOfBound,
		MonitorElementNotAllowedForField,
		MonitorElementIsNull,
		MonitorElementIsNullDetailedMessage,
		CanNotValidateParameter,
		RunLocationChanged,
		ParameterNotAllowed,
		SourceAddressNotFound,
		DataSizeMismatch
	}
	public class EditorException : BaseException
	{
		public EditorException(short errorID)
			: base(Facility.Editor, errorID)
		{
		}

		public EditorException(Facility facility, short errorNo)
			: base(facility, errorNo)
		{
		}

		public EditorException(Facility facility, short errorNo, string message)
			: base(facility, errorNo, message)
		{
		}

		public EditorException(Facility facility, short errorNo, string message, Exception inner)
			: base(facility, errorNo, message, inner)
		{
		}

		public EditorException(Facility facility, short errorNo, string message, string context)
			: base(facility, errorNo, message, context)
		{
		}

		public EditorException(Facility facility, short errorNo, string message, string context, Exception inner)
			: base(facility, errorNo, message, context, inner)
		{
		}
	}
	public class UnableToFindCalibrationException : EditorException
	{
		public UnableToFindCalibrationException(short errorNo)
			: base(errorNo)
		{
		}

		public UnableToFindCalibrationException(Facility facility, short errorNo)
			: base(facility, errorNo)
		{
		}

		public UnableToFindCalibrationException(Facility facility, short errorNo, string message)
			: base(facility, errorNo, message)
		{
		}

		public UnableToFindCalibrationException(Facility facility, short errorNo, string message, Exception inner)
			: base(facility, errorNo, message, inner)
		{
		}

		public UnableToFindCalibrationException(Facility facility, short errorNo, string message, string sourceAddress)
			: base(facility, errorNo, message, sourceAddress)
		{
		}

		public UnableToFindCalibrationException(Facility facility, short errorNo, string message, string sourceAddress, Exception inner)
			: base(facility, errorNo, message, sourceAddress, inner)
		{
		}
	}
	public class MonitorModeNotSupportedException : EditorException
	{
		public string mode;

		public MonitorModeNotSupportedException(short errorNo)
			: base(errorNo)
		{
		}

		public MonitorModeNotSupportedException(Facility facility, short errorNo)
			: base(facility, errorNo)
		{
		}

		public MonitorModeNotSupportedException(Facility facility, short errorNo, string message)
			: base(facility, errorNo, message)
		{
		}

		public MonitorModeNotSupportedException(Facility facility, short errorNo, string message, Exception inner)
			: base(facility, errorNo, message, inner)
		{
		}

		public MonitorModeNotSupportedException(Facility facility, short errorNo, string message, string sourceAddress)
			: base(facility, errorNo, message, sourceAddress)
		{
		}

		public MonitorModeNotSupportedException(Facility facility, short errorNo, string message, string sourceAddress, string monitorMode)
			: base(facility, errorNo, message, sourceAddress)
		{
			mode = monitorMode;
		}

		public MonitorModeNotSupportedException(Facility facility, short errorNo, string message, string sourceAddress, Exception inner, string monitorMode)
			: base(facility, errorNo, message, sourceAddress, inner)
		{
			mode = monitorMode;
		}
	}
	public class ChangeLockNotAcquiredException : EditorException
	{
		public ChangeLockNotAcquiredException(short errorNo)
			: base(errorNo)
		{
		}

		public ChangeLockNotAcquiredException(Facility facility, short errorNo)
			: base(facility, errorNo)
		{
		}

		public ChangeLockNotAcquiredException(Facility facility, short errorNo, string message)
			: base(facility, errorNo, message)
		{
		}

		public ChangeLockNotAcquiredException(Facility facility, short errorNo, string message, Exception inner)
			: base(facility, errorNo, message, inner)
		{
		}

		public ChangeLockNotAcquiredException(Facility facility, short errorNo, string message, string sourceAddress)
			: base(facility, errorNo, message, sourceAddress)
		{
		}

		public ChangeLockNotAcquiredException(Facility facility, short errorNo, string message, string sourceAddress, Exception inner)
			: base(facility, errorNo, message, sourceAddress, inner)
		{
		}
	}
	public class ChangeRunLocationException : EditorException
	{
		public ChangeRunLocationException(short errorNo)
			: base(errorNo)
		{
		}

		public ChangeRunLocationException(Facility facility, short errorNo)
			: base(facility, errorNo)
		{
		}

		public ChangeRunLocationException(Facility facility, short errorNo, string message)
			: base(facility, errorNo, message)
		{
		}

		public ChangeRunLocationException(Facility facility, short errorNo, string message, Exception inner)
			: base(facility, errorNo, message, inner)
		{
		}

		public ChangeRunLocationException(Facility facility, short errorNo, string message, string sourceAddress)
			: base(facility, errorNo, message, sourceAddress)
		{
		}

		public ChangeRunLocationException(Facility facility, short errorNo, string message, string sourceAddress, Exception inner)
			: base(facility, errorNo, message, sourceAddress, inner)
		{
		}
	}
	public class MonitorElementNotAddedException : EditorException
	{
		public MonitorElementNotAddedException(short errorNo)
			: base(errorNo)
		{
		}

		public MonitorElementNotAddedException(Facility facility, short errorNo)
			: base(facility, errorNo)
		{
		}

		public MonitorElementNotAddedException(Facility facility, short errorNo, string message)
			: base(facility, errorNo, message)
		{
		}

		public MonitorElementNotAddedException(Facility facility, short errorNo, string message, Exception inner)
			: base(facility, errorNo, message, inner)
		{
		}

		public MonitorElementNotAddedException(Facility facility, short errorNo, string message, string sourceAddress)
			: base(facility, errorNo, message, sourceAddress)
		{
		}

		public MonitorElementNotAddedException(Facility facility, short errorNo, string message, string sourceAddress, Exception inner)
			: base(facility, errorNo, message, sourceAddress, inner)
		{
		}
	}
	public class DataSizeMismatchException : EditorException
	{
		private int sizeInDataSource;

		private int sizeInConfig;

		public DataSizeMismatchException(short errorNo)
			: base(errorNo)
		{
		}

		public DataSizeMismatchException(Facility facility, short errorNo)
			: base(facility, errorNo)
		{
		}

		public DataSizeMismatchException(Facility facility, short errorNo, string message)
			: base(facility, errorNo, message)
		{
		}

		public DataSizeMismatchException(Facility facility, short errorNo, string message, Exception inner)
			: base(facility, errorNo, message, inner)
		{
		}

		public DataSizeMismatchException(Facility facility, short errorNo, string message, string sourceAddress)
			: base(facility, errorNo, message, sourceAddress)
		{
		}

		public DataSizeMismatchException(Facility facility, short errorNo, string message, string sourceAddress, Exception inner)
			: base(facility, errorNo, message, sourceAddress, inner)
		{
		}

		public DataSizeMismatchException(Facility facility, short errorNo, string message, string sourceAddress, int sizeInDataSource, int sizeInConfig)
			: base(facility, errorNo, message, sourceAddress)
		{
			this.sizeInConfig = sizeInConfig;
			this.sizeInDataSource = sizeInDataSource;
		}

		public DataSizeMismatchException(Facility facility, short errorNo, string message, string sourceAddress, Exception inner, int sizeInDataSource, int sizeInConfig)
			: base(facility, errorNo, message, sourceAddress, inner)
		{
			this.sizeInConfig = sizeInConfig;
			this.sizeInDataSource = sizeInDataSource;
		}
	}
	public delegate void ChangeActiveScreenEventHandler(object sender, ChangeActiveScreenEventArgs e);
	public delegate void DatasourceNameChangedEventHandler(object sender, DatasourceNameChangedEventArgs e);
	public class EditorModel
	{
		public delegate void ScreenRemovedEventHandler(object sender, ScreenRemovedEventArgs e);

		private const string defaultScreenFilename = "Screen_000.scr.xml";

		private ArrayList screens;

		private Hashtable hexEditors;

		private int currentScreenId;

		private IModuleNetwork network;

		private SortedList datasources;

		private string dataSourceName = string.Empty;

		private IAddressValue currentSourceAddress;

		private string screenFilename;

		private NewDataSet monitorSession;

		private DataAcquisitionType monitorMode;

		private DataFormat radix;

		private bool dirty;

		public ArrayList Screens => ArrayList.Synchronized(screens);

		public Hashtable HexEditorList
		{
			get
			{
				if (hexEditors == null)
				{
					hexEditors = new Hashtable();
				}
				return hexEditors;
			}
		}

		public int CurrentScreenId
		{
			get
			{
				return currentScreenId;
			}
			set
			{
				Cursor current = Cursor.Current;
				Cursor.Current = Cursors.WaitCursor;
				Screen screen = null;
				Screen previousScreen = null;
				if (currentScreenId != value)
				{
					int index = currentScreenId;
					currentScreenId = value;
					if (Screens.Count != 0)
					{
						try
						{
							screen = (Screen)Screens[currentScreenId];
							previousScreen = (Screen)Screens[index];
						}
						catch
						{
						}
						RaiseChangeActiveScreenEvent(screen, previousScreen);
					}
				}
				Cursor.Current = current;
			}
		}

		public IModuleNetwork Network
		{
			get
			{
				return network;
			}
			set
			{
				network = value;
			}
		}

		public string DataSourceName
		{
			get
			{
				return dataSourceName;
			}
			set
			{
				if (dataSourceName != value)
				{
					string oldDataSourceName = dataSourceName;
					dataSourceName = value;
					for (int i = 0; i < Screens.Count; i++)
					{
						Screen screen = (Screen)Screens[i];
						screen.DatasourceName = dataSourceName;
					}
					RaiseDatasourceNameChangedEvent(dataSourceName, oldDataSourceName);
				}
			}
		}

		public SortedList DataSources
		{
			get
			{
				if (datasources == null)
				{
					datasources = new SortedList();
				}
				return datasources;
			}
		}

		internal IAddressValue CurrentSourceAddress
		{
			get
			{
				return currentSourceAddress;
			}
			set
			{
				currentSourceAddress = value;
				foreach (Screen screen in Screens)
				{
					screen.CurrentSourceAddress = value;
				}
			}
		}

		public string ScreenFilename
		{
			get
			{
				return screenFilename;
			}
			set
			{
				screenFilename = value;
			}
		}

		public DataAcquisitionType MonitorMode
		{
			get
			{
				return monitorMode;
			}
			set
			{
				((Screen)Screens[CurrentScreenId]).MonitorMode = value;
				if (value != monitorMode)
				{
					monitorMode = value;
					RaiseMonitorModeChangedEvent(monitorMode);
				}
			}
		}

		public DataFormat Radix
		{
			set
			{
				radix = value;
			}
		}

		public NewDataSet MonitorSession
		{
			get
			{
				if (monitorSession == null)
				{
					monitorSession = new NewDataSet();
					monitorSession.Screen.Columns["Title"].ColumnMapping = MappingType.Hidden;
				}
				return monitorSession;
			}
		}

		public string DefaultScreenFilename => "Screen_000.scr.xml";

		public bool IsDirty
		{
			get
			{
				return dirty;
			}
			set
			{
				dirty = value;
			}
		}

		public event EventHandler DataSourceListChanged;

		public event ChangeActiveScreenEventHandler ChangeActiveScreenEvent;

		public event EventHandler AllScreensRemovedEvent;

		public event MonitorModeEventHandler MonitorModeChanged;

		public event ScreenRemovedEventHandler ScreenRemovedEvent;

		internal event ScreenNameChangedEventHandler ScreenNameChangedEvent;

		public event DatasourceNameChangedEventHandler DatasourceNameChangedEvent;

		public event FileSaveAsEventHandler FileSaveAsEvent;

		public event RunLocationChangedEventHandler RunLocationChanged
		{
			add
			{
				foreach (ICalibration value2 in DataSources.Values)
				{
					if (value2 != null && value2 is ICalibrationECM)
					{
						(value2 as ICalibrationECM).RunLocationChanged += value;
					}
				}
			}
			remove
			{
				foreach (ICalibration value2 in DataSources.Values)
				{
					if (value2 != null && value2 is ICalibrationECM)
					{
						(value2 as ICalibrationECM).RunLocationChanged -= value;
					}
				}
			}
		}

		public EditorModel(SortedList dataSources, IAddressValue currentSourceAddress, string dataSourceName)
		{
			this.currentSourceAddress = currentSourceAddress;
			datasources = dataSources;
			foreach (ICalibration value in dataSources.Values)
			{
				if (value is ICalibrationDisk calibrationDisk)
				{
					calibrationDisk.FileSaveAsEvent += OnFileSaveAsEvent;
				}
			}
			this.dataSourceName = dataSourceName;
			screens = new ArrayList();
			currentScreenId = -1;
			dirty = false;
		}

		public void CleanupResources()
		{
			DataSources.Clear();
		}

		public void AddScreen(Screen screen)
		{
			Screens.Add(screen);
			screen.ScreenNameChangedEvent += OnScreenNameChangedEvent;
		}

		public int GetScreenID(string screenTitle)
		{
			int result = 0;
			foreach (Screen screen in Screens)
			{
				if (screen.Title == screenTitle)
				{
					result = Screens.IndexOf(screen);
					break;
				}
			}
			return result;
		}

		public void RemoveScreen(int id)
		{
			lock (Screens.SyncRoot)
			{
				if (Screens.Count == 0)
				{
					return;
				}
				string name = ((Screen)Screens[id]).Name;
				string title = ((Screen)Screens[id]).Title;
				((Screen)Screens[id]).ScreenNameChangedEvent -= OnScreenNameChangedEvent;
				((Screen)Screens[id]).Dispose();
				Screens.RemoveAt(id);
				if (Screens.Count == 0 && HexEditorList.Count == 0)
				{
					currentScreenId = -1;
					RaiseAllScreensRemovedEvent();
					return;
				}
				RaiseScreensRemovedEvent(name, title);
				if (currentScreenId == Screens.Count)
				{
					currentScreenId = Screens.Count - 1;
				}
			}
		}

		public void RemoveAllScreens()
		{
			lock (Screens.SyncRoot)
			{
				if (Screens.Count == 0)
				{
					return;
				}
				foreach (Screen screen in Screens)
				{
					screen.ScreenNameChangedEvent -= OnScreenNameChangedEvent;
					screen.Dispose();
				}
				Screens.Clear();
				RaiseAllScreensRemovedEvent();
				currentScreenId = -1;
			}
		}

		private void RaiseDataSourceListChanged()
		{
			if (this.DataSourceListChanged != null)
			{
				this.DataSourceListChanged(this, EventArgs.Empty);
			}
		}

		public void RaiseMonitorModeChangedEvent(DataAcquisitionType mode)
		{
			if (this.MonitorModeChanged != null)
			{
				this.MonitorModeChanged(this, new MonitorModeEventArgs(mode));
			}
		}

		internal bool SaveHexEditorData(IAddressValue SourceAddress)
		{
			bool result = false;
			if (HexEditorList.Contains(SourceAddress.DisplayId))
			{
				Cummins.HexEditor.HexEditor hexEditor = (Cummins.HexEditor.HexEditor)HexEditorList[SourceAddress.DisplayId];
				if (hexEditor != null)
				{
					result = hexEditor.Save();
				}
			}
			return result;
		}

		internal bool SaveHexEditorData(IAddressValue SourceAddress, string newFileName)
		{
			bool result = false;
			if (HexEditorList.Contains(SourceAddress.DisplayId))
			{
				Cummins.HexEditor.HexEditor hexEditor = (Cummins.HexEditor.HexEditor)HexEditorList[SourceAddress.DisplayId];
				if (hexEditor != null)
				{
					result = hexEditor.SaveAs(newFileName);
				}
			}
			return result;
		}

		protected void RaiseChangeActiveScreenEvent(Screen screen, Screen previousScreen)
		{
			if (this.ChangeActiveScreenEvent != null)
			{
				ChangeActiveScreenEventArgs e = new ChangeActiveScreenEventArgs(screen, previousScreen);
				this.ChangeActiveScreenEvent(this, e);
			}
		}

		private void RaiseScreensRemovedEvent(string screenName, string title)
		{
			if (this.ScreenRemovedEvent != null)
			{
				ScreenRemovedEventArgs e = new ScreenRemovedEventArgs(screenName, title);
				this.ScreenRemovedEvent(this, e);
			}
		}

		private void RaiseDatasourceNameChangedEvent(string datasourceName, string oldDataSourceName)
		{
			if (this.DatasourceNameChangedEvent != null)
			{
				DatasourceNameChangedEventArgs e = new DatasourceNameChangedEventArgs(dataSourceName, oldDataSourceName);
				this.DatasourceNameChangedEvent(this, e);
			}
		}

		private void RaiseScreenNameChangedEvent(ScreenNameChangedEventArgs args)
		{
			if (this.ScreenNameChangedEvent != null)
			{
				this.ScreenNameChangedEvent(this, args);
			}
		}

		private void OnScreenNameChangedEvent(object sender, ScreenNameChangedEventArgs args)
		{
			RaiseScreenNameChangedEvent(args);
		}

		protected void RaiseAllScreensRemovedEvent()
		{
			if (this.AllScreensRemovedEvent != null)
			{
				this.AllScreensRemovedEvent(this, EventArgs.Empty);
			}
		}

		private void OnFileSaveAsEvent(object sender, FileSaveAsEventArgs args)
		{
			if (DataSources.Contains(args.OldSourceAddress))
			{
				ICalibrationDisk value = (ICalibrationDisk)datasources[args.OldSourceAddress];
				datasources.Remove(args.OldSourceAddress);
				if (!DataSources.Contains(args.NewSourceAddress))
				{
					DataSources.Add(args.NewSourceAddress, value);
				}
				if (CurrentSourceAddress == args.OldSourceAddress)
				{
					CurrentSourceAddress = args.NewSourceAddress;
				}
				RaiseFileSaveAsEvent(args);
			}
		}

		private void RaiseFileSaveAsEvent(FileSaveAsEventArgs args)
		{
			if (this.FileSaveAsEvent != null)
			{
				this.FileSaveAsEvent(this, args);
			}
		}
	}
	public class EditorPreferences : UserControl, IPropertyPage
	{
		private const string ScreenRefreshRateUnitInMilliSeconds = "ms";

		private const string ScreenRefreshRateUnitInHertz = "Hz";

		private const int SlowestScreenRefreshRateInMilliSeconds = 1000;

		private const int FastestScreenRefreshRateInMilliSeconds = 0;

		private const int SlowestScreenRefreshRateInHertz = 0;

		private const int FastestScreenRefreshRateInHertz = 50;

		private Panel panelPreferences;

		private Label labelDataMonitor;

		private GroupBox groupBoxDataMonitor;

		private GroupBox groupBoxMonitorMode;

		private Label labelDataRefreshRate;

		private TextBox textBoxDataRefreshRate;

		private Label labelScreenRefreshRate;

		private TextBox textBoxScreenRefreshRate;

		private Label labelTriggerMode;

		private Label labelRateMultiplier;

		private ComboBox comboBoxScreenRefreshRateUnits;

		private ComboBox comboBoxDataRefreshRateUnits;

		private CheckBox checkBoxShowComments;

		private CheckBox checkBoxAutoOpenScreenFile;

		private Label label1;

		private GroupBox groupBox1;

		private Label unitsBAMRate;

		private Label unitsIDLRate;

		private TextBox textBoxBAMRefreshRate;

		private TextBox textBoxIDLRefreshRate;

		private ComboBox bamTriggerMode;

		private Label label3;

		private Label label4;

		private Label label5;

		private TextBox connectionTimeoutMinimum;

		private NumericUpDown connectionTimeoutFactor;

		private CheckBox connectionTimeoutEnabled;

		private Container components;

		private TextBox textBoxComplexRequestReceive;

		private Label labelComplexRequestReceive;

		private ComboBox comboBoxComplexRequestReceiveUnits;

		private static int referenceCount;

		private string parentNode;

		private string currentNode;

		public string CurrentNode
		{
			get
			{
				return currentNode;
			}
			set
			{
				currentNode = value;
			}
		}

		public string ParentNode
		{
			get
			{
				return parentNode;
			}
			set
			{
				parentNode = value;
			}
		}

		public bool ShowComments
		{
			get
			{
				return checkBoxShowComments.Checked;
			}
			set
			{
				checkBoxShowComments.Checked = value;
			}
		}

		public string DataRefreshRate
		{
			get
			{
				return ((Control)textBoxDataRefreshRate).Text;
			}
			set
			{
				((Control)textBoxDataRefreshRate).Text = value;
			}
		}

		public string DataRefreshRateUnits
		{
			get
			{
				return ((Control)comboBoxDataRefreshRateUnits).Text;
			}
			set
			{
				if (value.ToUpper().CompareTo("HZ") == 0 || value.ToUpper().CompareTo("MS") == 0)
				{
					((Control)comboBoxDataRefreshRateUnits).Text = value;
				}
				else
				{
					((Control)comboBoxScreenRefreshRateUnits).Text = "ms";
				}
			}
		}

		public string BAMRefreshRate
		{
			get
			{
				return ((Control)textBoxBAMRefreshRate).Text;
			}
			set
			{
				((Control)textBoxBAMRefreshRate).Text = value;
			}
		}

		public string IDLRefreshRate
		{
			get
			{
				return ((Control)textBoxIDLRefreshRate).Text;
			}
			set
			{
				((Control)textBoxIDLRefreshRate).Text = value;
			}
		}

		public string ScreenRefreshRate
		{
			get
			{
				return ((Control)textBoxScreenRefreshRate).Text;
			}
			set
			{
				((Control)textBoxScreenRefreshRate).Text = value;
			}
		}

		public string ScreenRefreshRateUnits
		{
			get
			{
				return ((Control)comboBoxScreenRefreshRateUnits).Text;
			}
			set
			{
				if (value.ToUpper().CompareTo("HZ") == 0 || value.ToUpper().CompareTo("MS") == 0)
				{
					((Control)comboBoxScreenRefreshRateUnits).Text = value;
				}
				else
				{
					((Control)comboBoxScreenRefreshRateUnits).Text = "ms";
				}
			}
		}

		public string BAMTriggerMode
		{
			get
			{
				return ((Control)bamTriggerMode).Text;
			}
			set
			{
				if (bamTriggerMode.Items.Contains((object)value))
				{
					((Control)bamTriggerMode).Text = value;
				}
				else if (bamTriggerMode.Items.Contains((object)BAM45TriggerType.Clock))
				{
					((Control)bamTriggerMode).Text = BAM45TriggerType.Clock.ToString();
				}
				else
				{
					((Control)bamTriggerMode).Text = BAMPre45TriggerType.ForeGroundActivated.ToString();
				}
			}
		}

		public bool AutoLoadScreenFile
		{
			get
			{
				return checkBoxAutoOpenScreenFile.Checked;
			}
			set
			{
				checkBoxAutoOpenScreenFile.Checked = value;
			}
		}

		public bool ConnectionTimeoutEnabled
		{
			get
			{
				return connectionTimeoutEnabled.Checked;
			}
			set
			{
				connectionTimeoutEnabled.Checked = value;
			}
		}

		public string ConnectionTimeoutMinimum
		{
			get
			{
				return ((Control)connectionTimeoutMinimum).Text;
			}
			set
			{
				((Control)connectionTimeoutMinimum).Text = value;
			}
		}

		public string ConnectionTimeoutFactor
		{
			get
			{
				return connectionTimeoutFactor.Value.ToString();
			}
			set
			{
				connectionTimeoutFactor.Value = int.Parse(value);
			}
		}

		private string ComplexScreenRequestReceiveRefreshRate
		{
			get
			{
				return ((Control)textBoxComplexRequestReceive).Text;
			}
			set
			{
				((Control)textBoxComplexRequestReceive).Text = value;
			}
		}

		private string ComplexScreenRequestReceiveRefreshRateUnits
		{
			get
			{
				return ((Control)comboBoxComplexRequestReceiveUnits).Text;
			}
			set
			{
				if (value.ToUpper().CompareTo("HZ") == 0 || value.ToUpper().CompareTo("MS") == 0)
				{
					((Control)comboBoxComplexRequestReceiveUnits).Text = value;
				}
				else
				{
					((Control)comboBoxComplexRequestReceiveUnits).Text = "ms";
				}
			}
		}

		public event EventHandler DataMonitorOptionsChangedEvent;

		public EditorPreferences()
		{
			InitializeComponent();
			SetBamTriggerMode();
		}

		public EditorPreferences(string parentNode, string currentNode)
		{
			InitializeComponent();
			ParentNode = parentNode;
			CurrentNode = currentNode;
			SetBamTriggerMode();
		}

		public void AddReference()
		{
			referenceCount++;
		}

		protected override void Dispose(bool disposing)
		{
			if (referenceCount == 0)
			{
				if (disposing && components != null)
				{
					components.Dispose();
				}
				((ContainerControl)this).Dispose(disposing);
			}
			else
			{
				referenceCount--;
			}
		}

		protected void RaiseDataMonitorOptionsChangedEvent()
		{
			if (this.DataMonitorOptionsChangedEvent != null)
			{
				this.DataMonitorOptionsChangedEvent(this, EventArgs.Empty);
			}
		}

		private void InitializeComponent()
		{
			//IL_0001: Unknown result type (might be due to invalid IL or missing references)
			//IL_000b: Expected O, but got Unknown
			//IL_000c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0016: Expected O, but got Unknown
			//IL_0017: Unknown result type (might be due to invalid IL or missing references)
			//IL_0021: Expected O, but got Unknown
			//IL_0022: Unknown result type (might be due to invalid IL or missing references)
			//IL_002c: Expected O, but got Unknown
			//IL_002d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0037: Expected O, but got Unknown
			//IL_0038: Unknown result type (might be due to invalid IL or missing references)
			//IL_0042: Expected O, but got Unknown
			//IL_0043: Unknown result type (might be due to invalid IL or missing references)
			//IL_004d: Expected O, but got Unknown
			//IL_004e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0058: Expected O, but got Unknown
			//IL_0059: Unknown result type (might be due to invalid IL or missing references)
			//IL_0063: Expected O, but got Unknown
			//IL_0064: Unknown result type (might be due to invalid IL or missing references)
			//IL_006e: Expected O, but got Unknown
			//IL_006f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0079: Expected O, but got Unknown
			//IL_007a: Unknown result type (might be due to invalid IL or missing references)
			//IL_0084: Expected O, but got Unknown
			//IL_0085: Unknown result type (might be due to invalid IL or missing references)
			//IL_008f: Expected O, but got Unknown
			//IL_0090: Unknown result type (might be due to invalid IL or missing references)
			//IL_009a: Expected O, but got Unknown
			//IL_009b: Unknown result type (might be due to invalid IL or missing references)
			//IL_00a5: Expected O, but got Unknown
			//IL_00a6: Unknown result type (might be due to invalid IL or missing references)
			//IL_00b0: Expected O, but got Unknown
			//IL_00b1: Unknown result type (might be due to invalid IL or missing references)
			//IL_00bb: Expected O, but got Unknown
			//IL_00bc: Unknown result type (might be due to invalid IL or missing references)
			//IL_00c6: Expected O, but got Unknown
			//IL_00c7: Unknown result type (might be due to invalid IL or missing references)
			//IL_00d1: Expected O, but got Unknown
			//IL_00d2: Unknown result type (might be due to invalid IL or missing references)
			//IL_00dc: Expected O, but got Unknown
			//IL_00dd: Unknown result type (might be due to invalid IL or missing references)
			//IL_00e7: Expected O, but got Unknown
			//IL_00e8: Unknown result type (might be due to invalid IL or missing references)
			//IL_00f2: Expected O, but got Unknown
			//IL_00f3: Unknown result type (might be due to invalid IL or missing references)
			//IL_00fd: Expected O, but got Unknown
			//IL_00fe: Unknown result type (might be due to invalid IL or missing references)
			//IL_0108: Expected O, but got Unknown
			//IL_0109: Unknown result type (might be due to invalid IL or missing references)
			//IL_0113: Expected O, but got Unknown
			//IL_0114: Unknown result type (might be due to invalid IL or missing references)
			//IL_011e: Expected O, but got Unknown
			//IL_011f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0129: Expected O, but got Unknown
			//IL_012a: Unknown result type (might be due to invalid IL or missing references)
			//IL_0134: Expected O, but got Unknown
			//IL_0135: Unknown result type (might be due to invalid IL or missing references)
			//IL_013f: Expected O, but got Unknown
			//IL_0140: Unknown result type (might be due to invalid IL or missing references)
			//IL_014a: Expected O, but got Unknown
			//IL_028d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0297: Expected O, but got Unknown
			//IL_05df: Unknown result type (might be due to invalid IL or missing references)
			//IL_05e9: Expected O, but got Unknown
			//IL_065d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0667: Expected O, but got Unknown
			//IL_07a5: Unknown result type (might be due to invalid IL or missing references)
			//IL_07af: Expected O, but got Unknown
			//IL_0a0a: Unknown result type (might be due to invalid IL or missing references)
			//IL_0a14: Expected O, but got Unknown
			panelPreferences = new Panel();
			groupBox1 = new GroupBox();
			textBoxComplexRequestReceive = new TextBox();
			labelComplexRequestReceive = new Label();
			comboBoxComplexRequestReceiveUnits = new ComboBox();
			textBoxBAMRefreshRate = new TextBox();
			textBoxIDLRefreshRate = new TextBox();
			unitsIDLRate = new Label();
			unitsBAMRate = new Label();
			textBoxDataRefreshRate = new TextBox();
			labelRateMultiplier = new Label();
			label1 = new Label();
			labelDataRefreshRate = new Label();
			comboBoxDataRefreshRateUnits = new ComboBox();
			labelScreenRefreshRate = new Label();
			textBoxScreenRefreshRate = new TextBox();
			comboBoxScreenRefreshRateUnits = new ComboBox();
			checkBoxAutoOpenScreenFile = new CheckBox();
			checkBoxShowComments = new CheckBox();
			bamTriggerMode = new ComboBox();
			labelTriggerMode = new Label();
			groupBoxMonitorMode = new GroupBox();
			connectionTimeoutFactor = new NumericUpDown();
			label5 = new Label();
			label4 = new Label();
			label3 = new Label();
			connectionTimeoutMinimum = new TextBox();
			connectionTimeoutEnabled = new CheckBox();
			groupBoxDataMonitor = new GroupBox();
			labelDataMonitor = new Label();
			((Control)panelPreferences).SuspendLayout();
			((Control)groupBox1).SuspendLayout();
			((Control)groupBoxMonitorMode).SuspendLayout();
			((ISupportInitialize)connectionTimeoutFactor).BeginInit();
			((Control)this).SuspendLayout();
			((Control)panelPreferences).Controls.Add((Control)(object)groupBox1);
			((Control)panelPreferences).Controls.Add((Control)(object)checkBoxAutoOpenScreenFile);
			((Control)panelPreferences).Controls.Add((Control)(object)checkBoxShowComments);
			((Control)panelPreferences).Controls.Add((Control)(object)bamTriggerMode);
			((Control)panelPreferences).Controls.Add((Control)(object)labelTriggerMode);
			((Control)panelPreferences).Controls.Add((Control)(object)groupBoxMonitorMode);
			((Control)panelPreferences).Controls.Add((Control)(object)groupBoxDataMonitor);
			((Control)panelPreferences).Controls.Add((Control)(object)labelDataMonitor);
			((Control)panelPreferences).Dock = (DockStyle)5;
			((Control)panelPreferences).Location = new Point(0, 0);
			((Control)panelPreferences).Name = "panelPreferences";
			((Control)panelPreferences).Size = new Size(426, 309);
			((Control)panelPreferences).TabIndex = 0;
			((Control)panelPreferences).Paint += new PaintEventHandler(panelPreferences_Paint);
			((Control)groupBox1).Controls.Add((Control)(object)textBoxComplexRequestReceive);
			((Control)groupBox1).Controls.Add((Control)(object)labelComplexRequestReceive);
			((Control)groupBox1).Controls.Add((Control)(object)comboBoxComplexRequestReceiveUnits);
			((Control)groupBox1).Controls.Add((Control)(object)textBoxBAMRefreshRate);
			((Control)groupBox1).Controls.Add((Control)(object)textBoxIDLRefreshRate);
			((Control)groupBox1).Controls.Add((Control)(object)unitsIDLRate);
			((Control)groupBox1).Controls.Add((Control)(object)unitsBAMRate);
			((Control)groupBox1).Controls.Add((Control)(object)textBoxDataRefreshRate);
			((Control)groupBox1).Controls.Add((Control)(object)labelRateMultiplier);
			((Control)groupBox1).Controls.Add((Control)(object)label1);
			((Control)groupBox1).Controls.Add((Control)(object)labelDataRefreshRate);
			((Control)groupBox1).Controls.Add((Control)(object)comboBoxDataRefreshRateUnits);
			((Control)groupBox1).Controls.Add((Control)(object)labelScreenRefreshRate);
			((Control)groupBox1).Controls.Add((Control)(object)textBoxScreenRefreshRate);
			((Control)groupBox1).Controls.Add((Control)(object)comboBoxScreenRefreshRateUnits);
			((Control)groupBox1).Location = new Point(16, 128);
			((Control)groupBox1).Name = "groupBox1";
			((Control)groupBox1).Size = new Size(231, 170);
			((Control)groupBox1).TabIndex = 7;
			groupBox1.TabStop = false;
			((Control)groupBox1).Text = "Refresh Rates";
			((Control)textBoxComplexRequestReceive).Location = new Point(99, 58);
			((Control)textBoxComplexRequestReceive).Name = "textBoxComplexRequestReceive";
			((Control)textBoxComplexRequestReceive).Size = new Size(48, 20);
			((Control)textBoxComplexRequestReceive).TabIndex = 20;
			textBoxComplexRequestReceive.TextAlign = (HorizontalAlignment)1;
			((Control)labelComplexRequestReceive).Location = new Point(3, 52);
			((Control)labelComplexRequestReceive).Name = "labelComplexRequestReceive";
			((Control)labelComplexRequestReceive).Size = new Size(95, 28);
			((Control)labelComplexRequestReceive).TabIndex = 19;
			((Control)labelComplexRequestReceive).Text = "Complex Screen Request/Receive";
			comboBoxComplexRequestReceiveUnits.DropDownStyle = (ComboBoxStyle)2;
			comboBoxComplexRequestReceiveUnits.Items.AddRange(new object[2] { "Hz", "ms" });
			((Control)comboBoxComplexRequestReceiveUnits).Location = new Point(155, 59);
			((Control)comboBoxComplexRequestReceiveUnits).Name = "comboBoxComplexRequestReceiveUnits";
			((Control)comboBoxComplexRequestReceiveUnits).Size = new Size(48, 21);
			((Control)comboBoxComplexRequestReceiveUnits).TabIndex = 21;
			((Control)textBoxBAMRefreshRate).Location = new Point(99, 85);
			((Control)textBoxBAMRefreshRate).Name = "textBoxBAMRefreshRate";
			((Control)textBoxBAMRefreshRate).Size = new Size(48, 20);
			((Control)textBoxBAMRefreshRate).TabIndex = 4;
			textBoxBAMRefreshRate.TextAlign = (HorizontalAlignment)1;
			((Control)textBoxBAMRefreshRate).Leave += RefreshRate_Leave;
			((Control)textBoxBAMRefreshRate).KeyPress += new KeyPressEventHandler(RefreshRate_KeyPress);
			((Control)textBoxIDLRefreshRate).Location = new Point(99, 109);
			((Control)textBoxIDLRefreshRate).Name = "textBoxIDLRefreshRate";
			((Control)textBoxIDLRefreshRate).Size = new Size(48, 20);
			((Control)textBoxIDLRefreshRate).TabIndex = 6;
			textBoxIDLRefreshRate.TextAlign = (HorizontalAlignment)1;
			((Control)textBoxIDLRefreshRate).Leave += RefreshRate_Leave;
			((Control)textBoxIDLRefreshRate).KeyPress += new KeyPressEventHandler(RefreshRate_KeyPress);
			((Control)unitsIDLRate).Location = new Point(157, 107);
			((Control)unitsIDLRate).Name = "unitsIDLRate";
			((Control)unitsIDLRate).Size = new Size(32, 23);
			((Control)unitsIDLRate).TabIndex = 18;
			((Control)unitsIDLRate).Text = "ms";
			unitsIDLRate.TextAlign = (ContentAlignment)16;
			((Control)unitsBAMRate).Location = new Point(157, 82);
			((Control)unitsBAMRate).Name = "unitsBAMRate";
			((Control)unitsBAMRate).Size = new Size(32, 23);
			((Control)unitsBAMRate).TabIndex = 17;
			((Control)unitsBAMRate).Text = "ms";
			unitsBAMRate.TextAlign = (ContentAlignment)16;
			((Control)textBoxDataRefreshRate).Location = new Point(99, 21);
			((Control)textBoxDataRefreshRate).Name = "textBoxDataRefreshRate";
			((Control)textBoxDataRefreshRate).Size = new Size(48, 20);
			((Control)textBoxDataRefreshRate).TabIndex = 1;
			textBoxDataRefreshRate.TextAlign = (HorizontalAlignment)1;
			((Control)textBoxDataRefreshRate).Leave += RefreshRate_Leave;
			((Control)textBoxDataRefreshRate).KeyPress += new KeyPressEventHandler(RefreshRate_KeyPress);
			((Control)labelRateMultiplier).Location = new Point(5, 85);
			((Control)labelRateMultiplier).Name = "labelRateMultiplier";
			((Control)labelRateMultiplier).Size = new Size(47, 20);
			((Control)labelRateMultiplier).TabIndex = 3;
			((Control)labelRateMultiplier).Text = "BAM";
			((Control)label1).Location = new Point(7, 109);
			((Control)label1).Name = "label1";
			((Control)label1).Size = new Size(55, 20);
			((Control)label1).TabIndex = 5;
			((Control)label1).Text = "IDL";
			((Control)labelDataRefreshRate).Location = new Point(1, 20);
			((Control)labelDataRefreshRate).Name = "labelDataRefreshRate";
			((Control)labelDataRefreshRate).Size = new Size(138, 32);
			((Control)labelDataRefreshRate).TabIndex = 0;
			((Control)labelDataRefreshRate).Text = "Normal Screen Request/Receive";
			comboBoxDataRefreshRateUnits.DropDownStyle = (ComboBoxStyle)2;
			comboBoxDataRefreshRateUnits.Items.AddRange(new object[2] { "Hz", "ms" });
			((Control)comboBoxDataRefreshRateUnits).Location = new Point(155, 22);
			((Control)comboBoxDataRefreshRateUnits).Name = "comboBoxDataRefreshRateUnits";
			((Control)comboBoxDataRefreshRateUnits).Size = new Size(48, 21);
			((Control)comboBoxDataRefreshRateUnits).TabIndex = 2;
			comboBoxDataRefreshRateUnits.SelectedIndexChanged += comboBoxDataRefreshRateUnits_SelectedIndexChanged;
			((Control)labelScreenRefreshRate).Location = new Point(8, 133);
			((Control)labelScreenRefreshRate).Name = "labelScreenRefreshRate";
			((Control)labelScreenRefreshRate).Size = new Size(60, 20);
			((Control)labelScreenRefreshRate).TabIndex = 7;
			((Control)labelScreenRefreshRate).Text = "Screen";
			((Control)textBoxScreenRefreshRate).Location = new Point(99, 133);
			((Control)textBoxScreenRefreshRate).Name = "textBoxScreenRefreshRate";
			((Control)textBoxScreenRefreshRate).Size = new Size(48, 20);
			((Control)textBoxScreenRefreshRate).TabIndex = 8;
			textBoxScreenRefreshRate.TextAlign = (HorizontalAlignment)1;
			((Control)textBoxScreenRefreshRate).Leave += ScreenRefreshRate_Leave;
			((Control)textBoxScreenRefreshRate).KeyPress += new KeyPressEventHandler(RefreshRate_KeyPress);
			comboBoxScreenRefreshRateUnits.DropDownStyle = (ComboBoxStyle)2;
			comboBoxScreenRefreshRateUnits.Items.AddRange(new object[2] { "Hz", "ms" });
			((Control)comboBoxScreenRefreshRateUnits).Location = new Point(155, 133);
			((Control)comboBoxScreenRefreshRateUnits).Name = "comboBoxScreenRefreshRateUnits";
			((Control)comboBoxScreenRefreshRateUnits).Size = new Size(48, 21);
			((Control)comboBoxScreenRefreshRateUnits).TabIndex = 9;
			((Control)comboBoxScreenRefreshRateUnits).Leave += ScreenRefreshRateUnit_Leave;
			((Control)checkBoxAutoOpenScreenFile).Location = new Point(255, 61);
			((Control)checkBoxAutoOpenScreenFile).Name = "checkBoxAutoOpenScreenFile";
			((Control)checkBoxAutoOpenScreenFile).Size = new Size(144, 16);
			((Control)checkBoxAutoOpenScreenFile).TabIndex = 4;
			((Control)checkBoxAutoOpenScreenFile).Text = "Auto Open Screen File";
			((Control)checkBoxShowComments).Location = new Point(255, 38);
			((Control)checkBoxShowComments).Name = "checkBoxShowComments";
			((Control)checkBoxShowComments).Size = new Size(165, 18);
			((Control)checkBoxShowComments).TabIndex = 3;
			((Control)checkBoxShowComments).Text = "Show Parameter Comments";
			checkBoxShowComments.CheckedChanged += checkBoxShowComments_CheckedChanged;
			bamTriggerMode.DropDownStyle = (ComboBoxStyle)2;
			((Control)bamTriggerMode).Location = new Point(256, 101);
			((Control)bamTriggerMode).Name = "bamTriggerMode";
			((Control)bamTriggerMode).Size = new Size(112, 21);
			((Control)bamTriggerMode).TabIndex = 6;
			bamTriggerMode.SelectedIndexChanged += bamTriggerMode_SelectedIndexChanged;
			((Control)labelTriggerMode).Location = new Point(254, 85);
			((Control)labelTriggerMode).Name = "labelTriggerMode";
			((Control)labelTriggerMode).Size = new Size(80, 16);
			((Control)labelTriggerMode).TabIndex = 5;
			((Control)labelTriggerMode).Text = "BAM Trigger";
			((Control)labelTriggerMode).Click += labelTriggerMode_Click;
			((Control)groupBoxMonitorMode).Controls.Add((Control)(object)connectionTimeoutFactor);
			((Control)groupBoxMonitorMode).Controls.Add((Control)(object)label5);
			((Control)groupBoxMonitorMode).Controls.Add((Control)(object)label4);
			((Control)groupBoxMonitorMode).Controls.Add((Control)(object)label3);
			((Control)groupBoxMonitorMode).Controls.Add((Control)(object)connectionTimeoutMinimum);
			((Control)groupBoxMonitorMode).Controls.Add((Control)(object)connectionTimeoutEnabled);
			((Control)groupBoxMonitorMode).Location = new Point(16, 32);
			((Control)groupBoxMonitorMode).Name = "groupBoxMonitorMode";
			((Control)groupBoxMonitorMode).Size = new Size(231, 88);
			((Control)groupBoxMonitorMode).TabIndex = 2;
			groupBoxMonitorMode.TabStop = false;
			((Control)groupBoxMonitorMode).Text = "Lost Connection Detection";
			((Control)connectionTimeoutFactor).Enabled = false;
			((Control)connectionTimeoutFactor).Location = new Point(96, 56);
			connectionTimeoutFactor.Maximum = new decimal(new int[4] { 1000, 0, 0, 0 });
			connectionTimeoutFactor.Minimum = new decimal(new int[4] { 2, 0, 0, 0 });
			((Control)connectionTimeoutFactor).Name = "connectionTimeoutFactor";
			((Control)connectionTimeoutFactor).Size = new Size(56, 20);
			((Control)connectionTimeoutFactor).TabIndex = 5;
			((UpDownBase)connectionTimeoutFactor).TextAlign = (HorizontalAlignment)1;
			connectionTimeoutFactor.Value = new decimal(new int[4] { 2, 0, 0, 0 });
			((Control)label5).Location = new Point(24, 56);
			((Control)label5).Name = "label5";
			((Control)label5).Size = new Size(64, 16);
			((Control)label5).TabIndex = 4;
			((Control)label5).Text = "Factor";
			((Control)label4).Location = new Point(160, 32);
			((Control)label4).Name = "label4";
			((Control)label4).Size = new Size(24, 16);
			((Control)label4).TabIndex = 3;
			((Control)label4).Text = "ms";
			((Control)label3).Location = new Point(24, 32);
			((Control)label3).Name = "label3";
			((Control)label3).Size = new Size(64, 16);
			((Control)label3).TabIndex = 2;
			((Control)label3).Text = "Minimum";
			((Control)connectionTimeoutMinimum).Enabled = false;
			((Control)connectionTimeoutMinimum).Location = new Point(96, 32);
			((Control)connectionTimeoutMinimum).Name = "connectionTimeoutMinimum";
			((Control)connectionTimeoutMinimum).Size = new Size(56, 20);
			((Control)connectionTimeoutMinimum).TabIndex = 1;
			((Control)connectionTimeoutMinimum).Text = "200";
			connectionTimeoutMinimum.TextAlign = (HorizontalAlignment)1;
			((Control)connectionTimeoutEnabled).Location = new Point(16, 16);
			((Control)connectionTimeoutEnabled).Name = "connectionTimeoutEnabled";
			((Control)connectionTimeoutEnabled).Size = new Size(64, 16);
			((Control)connectionTimeoutEnabled).TabIndex = 0;
			((Control)connectionTimeoutEnabled).Tag = "";
			((Control)connectionTimeoutEnabled).Text = "Enable";
			connectionTimeoutEnabled.CheckedChanged += connectionTimeoutEnabled_CheckedChanged;
			((Control)groupBoxDataMonitor).Location = new Point(64, 8);
			((Control)groupBoxDataMonitor).Name = "groupBoxDataMonitor";
			((Control)groupBoxDataMonitor).Size = new Size(356, 7);
			((Control)groupBoxDataMonitor).TabIndex = 1;
			groupBoxDataMonitor.TabStop = false;
			((Control)labelDataMonitor).Location = new Point(16, 8);
			((Control)labelDataMonitor).Name = "labelDataMonitor";
			((Control)labelDataMonitor).Size = new Size(48, 16);
			((Control)labelDataMonitor).TabIndex = 0;
			((Control)labelDataMonitor).Text = "Editor";
			((Control)this).Controls.Add((Control)(object)panelPreferences);
			((Control)this).Name = "EditorPreferences";
			((Control)this).Size = new Size(426, 309);
			((Control)panelPreferences).ResumeLayout(false);
			((Control)groupBox1).ResumeLayout(false);
			((Control)groupBox1).PerformLayout();
			((Control)groupBoxMonitorMode).ResumeLayout(false);
			((Control)groupBoxMonitorMode).PerformLayout();
			((ISupportInitialize)connectionTimeoutFactor).EndInit();
			((Control)this).ResumeLayout(false);
		}

		public void Initialize()
		{
			IAppConfigService appConfigService = (IAppConfigService)ServiceManager.Services.GetService(typeof(IAppConfigService));
			try
			{
				ShowComments = bool.Parse(appConfigService.GetAppSetting(ApplicationSettings.MonitorShowCommentsChecked));
			}
			catch (Exception)
			{
				ShowComments = false;
				appConfigService.SetAppSetting(ApplicationSettings.MonitorShowCommentsChecked, ShowComments.ToString());
			}
			try
			{
				AutoLoadScreenFile = bool.Parse(appConfigService.GetAppSetting(ApplicationSettings.AutoLoadScreenFile));
			}
			catch
			{
			}
			DataRefreshRate = appConfigService.GetAppSetting(ApplicationSettings.DataRefreshRate);
			BAMRefreshRate = appConfigService.GetAppSetting(ApplicationSettings.BamRefreshRate);
			IDLRefreshRate = appConfigService.GetAppSetting(ApplicationSettings.IDLRefreshRate);
			DataRefreshRateUnits = appConfigService.GetAppSetting(ApplicationSettings.DataRefreshRateUnits);
			ComplexScreenRequestReceiveRefreshRate = appConfigService.GetAppSetting(ApplicationSettings.ComplexScreenRequestReceiveRefreshRate);
			ComplexScreenRequestReceiveRefreshRateUnits = appConfigService.GetAppSetting(ApplicationSettings.ComplexScreenRequestReceiveRefreshRateUnits);
			ScreenRefreshRate = appConfigService.GetAppSetting(ApplicationSettings.ScreenRefreshRate);
			ScreenRefreshRateUnits = appConfigService.GetAppSetting(ApplicationSettings.ScreenRefreshRateUnits);
			BAMTriggerMode = appConfigService.GetAppSetting(ApplicationSettings.BamTriggerMode);
			ConnectionTimeoutEnabled = bool.Parse(appConfigService.GetAppSetting(ApplicationSettings.ConnectionTimeoutEnabled));
			ConnectionTimeoutMinimum = appConfigService.GetAppSetting(ApplicationSettings.ConnectionTimeoutMinimum);
			ConnectionTimeoutFactor = appConfigService.GetAppSetting(ApplicationSettings.ConnectionTimeoutFactor);
		}

		public void SetOptions()
		{
			IAppConfigService appConfigService = (IAppConfigService)ServiceManager.Services.GetService(typeof(IAppConfigService));
			appConfigService.SetAppSetting(ApplicationSettings.MonitorShowCommentsChecked, ShowComments.ToString());
			appConfigService.SetAppSetting(ApplicationSettings.AutoLoadScreenFile, AutoLoadScreenFile.ToString());
			appConfigService.SetAppSetting(ApplicationSettings.DataRefreshRate, DataRefreshRate);
			appConfigService.SetAppSetting(ApplicationSettings.BamRefreshRate, BAMRefreshRate);
			appConfigService.SetAppSetting(ApplicationSettings.DataRefreshRateUnits, DataRefreshRateUnits);
			appConfigService.SetAppSetting(ApplicationSettings.ScreenRefreshRate, ScreenRefreshRate);
			appConfigService.SetAppSetting(ApplicationSettings.ScreenRefreshRateUnits, ScreenRefreshRateUnits);
			appConfigService.SetAppSetting(ApplicationSettings.BamTriggerMode, BAMTriggerMode);
			appConfigService.SetAppSetting(ApplicationSettings.ConnectionTimeoutEnabled, ConnectionTimeoutEnabled.ToString());
			appConfigService.SetAppSetting(ApplicationSettings.ConnectionTimeoutMinimum, ConnectionTimeoutMinimum);
			appConfigService.SetAppSetting(ApplicationSettings.ConnectionTimeoutFactor, ConnectionTimeoutFactor);
			appConfigService.SetAppSetting(ApplicationSettings.ComplexScreenRequestReceiveRefreshRate, ComplexScreenRequestReceiveRefreshRate);
			appConfigService.SetAppSetting(ApplicationSettings.ComplexScreenRequestReceiveRefreshRateUnits, ComplexScreenRequestReceiveRefreshRateUnits);
			RaiseDataMonitorOptionsChangedEvent();
		}

		private void UpdateBAMRefreshRate()
		{
			if (BAMTriggerMode == "Clock" || BAMTriggerMode == "Frame")
			{
				((Control)unitsBAMRate).Text = comboBoxDataRefreshRateUnits.SelectedItem.ToString();
			}
			else
			{
				((Control)unitsBAMRate).Text = "X";
			}
		}

		private void comboBoxDataRefreshRateUnits_SelectedIndexChanged(object sender, EventArgs e)
		{
			UpdateBAMRefreshRate();
		}

		private void bamTriggerMode_SelectedIndexChanged(object sender, EventArgs e)
		{
			UpdateBAMRefreshRate();
		}

		private void AllowNumbersOnly(KeyPressEventArgs e)
		{
			int keyChar = e.KeyChar;
			if (!char.IsDigit(e.KeyChar) && keyChar != 8)
			{
				e.Handled = true;
			}
		}

		private void SetToMinRefreshValue(object sender)
		{
			//IL_0001: Unknown result type (might be due to invalid IL or missing references)
			//IL_0007: Expected O, but got Unknown
			//IL_002e: Unknown result type (might be due to invalid IL or missing references)
			TextBox val = (TextBox)sender;
			try
			{
				if (string.Empty == ((Control)val).Text || int.Parse(((Control)val).Text.ToString(), NumberStyles.Integer) < 5)
				{
					((Control)(TextBox)sender).Text = "5";
				}
			}
			catch (Exception e)
			{
				EventLogger.Error("Options", " Unable to change the refresh rate value", e);
			}
		}

		private void SetToMinScreenRefreshValue()
		{
			string text = ((Control)comboBoxScreenRefreshRateUnits).Text;
			string text2 = ((Control)textBoxScreenRefreshRate).Text;
			if (text == "ms")
			{
				try
				{
					int num = int.Parse(text2, NumberStyles.Integer);
					if (string.Empty == text2 || num < 0 || num > 1000)
					{
						ScreenRefreshRate = 0.ToString();
					}
					return;
				}
				catch (Exception e)
				{
					ScreenRefreshRate = 0.ToString();
					EventLogger.Error("Options", " Unable to change the screen refresh rate value", e);
					return;
				}
			}
			try
			{
				int num2 = int.Parse(text2, NumberStyles.Integer);
				if (string.Empty == text2 || num2 < 0 || num2 > 50)
				{
					ScreenRefreshRate = 50.ToString();
				}
			}
			catch (Exception e2)
			{
				ScreenRefreshRate = 50.ToString();
				EventLogger.Error("Options", " Unable to change the screen refresh rate value", e2);
			}
		}

		private void RefreshRate_KeyPress(object sender, KeyPressEventArgs e)
		{
			AllowNumbersOnly(e);
		}

		private void RefreshRate_Leave(object sender, EventArgs e)
		{
			SetToMinRefreshValue(sender);
		}

		private void ScreenRefreshRate_Leave(object sender, EventArgs e)
		{
			SetToMinScreenRefreshValue();
		}

		private void ScreenRefreshRateUnit_Leave(object sender, EventArgs e)
		{
			SetToMinScreenRefreshValue();
		}

		private void connectionTimeoutEnabled_CheckedChanged(object sender, EventArgs e)
		{
			((Control)connectionTimeoutMinimum).Enabled = connectionTimeoutEnabled.Checked;
			((Control)connectionTimeoutFactor).Enabled = connectionTimeoutEnabled.Checked;
		}

		private void SetBamTriggerMode()
		{
			IAppConfigService appConfigService = (IAppConfigService)ServiceManager.Services.GetService(typeof(IAppConfigService));
			IProductInformationService productInformationService = (IProductInformationService)ServiceManager.Services.GetService(typeof(IProductInformationService));
			string appSetting = appConfigService.GetAppSetting(ApplicationSettings.LastProduct);
			string text = productInformationService.GTISLevel(appSetting);
			Type enumType = ((!text.Equals("GTIS45")) ? typeof(BAMPre45TriggerType) : typeof(BAM45TriggerType));
			string[] names = Enum.GetNames(enumType);
			bamTriggerMode.Items.AddRange((object[])names);
		}

		private void checkBoxShowComments_CheckedChanged(object sender, EventArgs e)
		{
		}

		private void panelPreferences_Paint(object sender, PaintEventArgs e)
		{
		}

		private void labelTriggerMode_Click(object sender, EventArgs e)
		{
		}
	}
	public class EditorPreferencesPageProvider : IPropertyPageProvider
	{
		private EditorPreferences editorPreferences;

		private static EditorPreferencesPageProvider editorPreferencesPageProvider;

		public static EditorPreferencesPageProvider EditorPageProvider
		{
			get
			{
				if (editorPreferencesPageProvider == null)
				{
					editorPreferencesPageProvider = new EditorPreferencesPageProvider();
				}
				return editorPreferencesPageProvider;
			}
		}

		public ArrayList Pages
		{
			get
			{
				ArrayList arrayList = new ArrayList();
				arrayList.Add(EditorPreferencesPage);
				return arrayList;
			}
		}

		internal EditorPreferences EditorPreferencesPage
		{
			get
			{
				if (editorPreferences == null)
				{
					editorPreferences = new EditorPreferences("", "Editor");
				}
				editorPreferences.AddReference();
				return editorPreferences;
			}
		}

		private EditorPreferencesPageProvider()
		{
		}
	}
	public class EditorUtilities
	{
		public static bool CheckAscendingOrder
		{
			get
			{
				return AppSettingHelper.GetSettingAsBool(ApplicationSettings.CheckArrayAscendingOrder);
			}
			set
			{
				AppSettingHelper.ChangeSetting(ApplicationSettings.CheckArrayAscendingOrder, value.ToString());
			}
		}
	}
	public delegate void ScreenTabChangedEventHandler(object sender, ScreenTabChangedEventArgs e);
	public delegate void ScreenTitleUpdatedEventHandler(object sender, ScreenTitleUpdatedEventArgs e);
	public class EditorView : UserControl
	{
		private delegate void PopulateParameterQueryDeleagte();

		private delegate void PopulateJ1939_71ParameterQueryDeleagte();

		private const string manualConnectmode = "Manual";

		internal const string HexEditor = "Hex Editor";

		private const string Seperator = " : ";

		public bool fetchData;

		private WaitDlg _WaitDlg;

		private KeyEventHandler m_UndockedScreenKeyDownEvent;

		private EditorController controller;

		private EditorModel model;

		private Screen screen;

		private SortedList parameterQueryList;

		private SortedList j1939_71parameterQueryList;

		private SortedList broadcastQueryDialog;

		private DockSite dockSite2;

		private DockSite dockSite3;

		private DockSite dockSite4;

		private DockSite dockSite5;

		private DockSite dockSite6;

		private DockSite dockSite7;

		private DockSite dockSite8;

		private IContainer components;

		private DockSite filldockSite;

		private Panel dataMonitorPanel;

		private DotNetBarManager screenBarManager;

		private DockSite dockSite1;

		public Screen CurrentScreen
		{
			get
			{
				return screen;
			}
			set
			{
				screen = value;
			}
		}

		public EditorModel Model => model;

		public EditorController Controller => controller;

		public Panel Panel => dataMonitorPanel;

		private Bar FirstDocumentBar
		{
			get
			{
				Bar result = null;
				foreach (Bar bar in screenBarManager.Bars)
				{
					if (bar.DockSide == eDockSide.Document)
					{
						result = bar;
						break;
					}
				}
				return result;
			}
		}

		public event ParameterAddedOnScreenEventHandler ParameterAddedOnScreenEvent;

		public event ScreenTabChangedEventHandler ScreenTabChangedEvent;

		public event EventHandler ScreenTabClosedEvent;

		public event HexEditorScreenRemoveEventHandler HexEditorTabClosedEvent;

		public event ScreenTitleUpdatedEventHandler ScreenTitleUpdatedEvent;

		public event KeyEventHandler UndockedScreenKeyDownEvent
		{
			add
			{
				//IL_0010: Unknown result type (might be due to invalid IL or missing references)
				//IL_0016: Expected O, but got Unknown
				KeyEventHandler val = this.m_UndockedScreenKeyDownEvent;
				KeyEventHandler val2;
				do
				{
					val2 = val;
					KeyEventHandler value2 = (KeyEventHandler)Delegate.Combine((Delegate?)(object)val2, (Delegate?)(object)value);
					val = Interlocked.CompareExchange(ref this.m_UndockedScreenKeyDownEvent, value2, val2);
				}
				while (val != val2);
			}
			remove
			{
				//IL_0010: Unknown result type (might be due to invalid IL or missing references)
				//IL_0016: Expected O, but got Unknown
				KeyEventHandler val = this.m_UndockedScreenKeyDownEvent;
				KeyEventHandler val2;
				do
				{
					val2 = val;
					KeyEventHandler value2 = (KeyEventHandler)Delegate.Remove((Delegate?)(object)val2, (Delegate?)(object)value);
					val = Interlocked.CompareExchange(ref this.m_UndockedScreenKeyDownEvent, value2, val2);
				}
				while (val != val2);
			}
		}

		public EditorView(EditorController controller, EditorModel model)
		{
			this.controller = controller;
			this.model = model;
			InitializeComponent();
			((Control)filldockSite).Dock = (DockStyle)5;
			((Control)Panel).Controls.Add((Control)(object)filldockSite);
			screenBarManager.FillDockSite = filldockSite;
			screenBarManager.BarDock += OnBarDock;
			screenBarManager.BarUndock += OnBarUnDock;
			screenBarManager.DockTabClosing += OnDockTabClosing;
			this.model.ChangeActiveScreenEvent += OnChangeActiveScreen;
			this.model.AllScreensRemovedEvent += OnAllScreensRemoved;
			this.model.ScreenRemovedEvent += OnScreenRemovedEvent;
			this.model.ScreenNameChangedEvent += OnScreenNameChangedEvent;
			this.model.RunLocationChanged += OnRunLocationChanged;
			this.model.DatasourceNameChangedEvent += OnDatasourceNameChangedEvent;
			this.model.FileSaveAsEvent += OnFileSaveAsEvent;
			this.controller.ScreenAddedEvent += OnScreenAddedEvent;
			this.controller.HexEditorScreenRemoveEvent += OnHexEditorRemovedEvent;
			this.controller.HexEditorScreenAddedEvent += OnHexEditorScreenAdded;
			this.controller.AllScreensLoadedEvent += OnAllScreensLoadedEvent;
		}

		private void InitializeComponent()
		{
			//IL_0075: Unknown result type (might be due to invalid IL or missing references)
			//IL_007f: Expected O, but got Unknown
			components = new Container();
			screenBarManager = new DotNetBarManager(components);
			dockSite4 = new DockSite();
			filldockSite = new DockSite();
			dockSite2 = new DockSite();
			dockSite8 = new DockSite();
			dockSite5 = new DockSite();
			dockSite6 = new DockSite();
			dockSite7 = new DockSite();
			dockSite3 = new DockSite();
			dataMonitorPanel = new Panel();
			dockSite1 = new DockSite();
			((Control)this).SuspendLayout();
			screenBarManager.BottomDockSite = dockSite4;
			screenBarManager.DefinitionName = "";
			screenBarManager.EnableFullSizeDock = false;
			screenBarManager.IgnoreF10Key = true;
			screenBarManager.LeftDockSite = filldockSite;
			screenBarManager.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
			screenBarManager.ParentForm = null;
			screenBarManager.ParentUserControl = (Control)(object)this;
			screenBarManager.RightDockSite = dockSite2;
			screenBarManager.Style = eDotNetBarStyle.Office2003;
			screenBarManager.ToolbarBottomDockSite = dockSite8;
			screenBarManager.ToolbarLeftDockSite = dockSite5;
			screenBarManager.ToolbarRightDockSite = dockSite6;
			screenBarManager.ToolbarTopDockSite = dockSite7;
			screenBarManager.TopDockSite = dockSite3;
			((Control)dockSite4).AccessibleRole = (AccessibleRole)9;
			((Control)dockSite4).Dock = (DockStyle)2;
			dockSite4.DocumentDockContainer = new DocumentDockContainer();
			((Control)dockSite4).Location = new Point(0, 525);
			((Control)dockSite4).Name = "dockSite4";
			((Control)dockSite4).Size = new Size(903, 0);
			((Control)dockSite4).TabIndex = 4;
			((Control)dockSite4).TabStop = false;
			((Control)filldockSite).AccessibleRole = (AccessibleRole)9;
			((Control)filldockSite).Dock = (DockStyle)5;
			filldockSite.DocumentDockContainer = new DocumentDockContainer();
			((Control)filldockSite).Location = new Point(0, 0);
			((Control)filldockSite).Name = "filldockSite";
			((Control)filldockSite).TabIndex = 1;
			((Control)filldockSite).TabStop = false;
			((Control)dockSite2).AccessibleRole = (AccessibleRole)9;
			((Control)dockSite2).Dock = (DockStyle)4;
			dockSite2.DocumentDockContainer = new DocumentDockContainer();
			((Control)dockSite2).Location = new Point(903, 0);
			((Control)dockSite2).Name = "dockSite2";
			((Control)dockSite2).Size = new Size(0, 525);
			((Control)dockSite2).TabIndex = 2;
			((Control)dockSite2).TabStop = false;
			((Control)dockSite8).AccessibleRole = (AccessibleRole)9;
			((Control)dockSite8).Dock = (DockStyle)2;
			((Control)dockSite8).Location = new Point(0, 525);
			((Control)dockSite8).Name = "dockSite8";
			((Control)dockSite8).Size = new Size(903, 0);
			((Control)dockSite8).TabIndex = 8;
			((Control)dockSite8).TabStop = false;
			((Control)dockSite5).AccessibleRole = (AccessibleRole)9;
			((Control)dockSite5).Dock = (DockStyle)3;
			((Control)dockSite5).Location = new Point(0, 0);
			((Control)dockSite5).Name = "dockSite5";
			((Control)dockSite5).Size = new Size(0, 525);
			((Control)dockSite5).TabIndex = 5;
			((Control)dockSite5).TabStop = false;
			((Control)dockSite6).AccessibleRole = (AccessibleRole)9;
			((Control)dockSite6).Dock = (DockStyle)4;
			((Control)dockSite6).Location = new Point(903, 0);
			((Control)dockSite6).Name = "dockSite6";
			((Control)dockSite6).Size = new Size(0, 525);
			((Control)dockSite6).TabIndex = 6;
			((Control)dockSite6).TabStop = false;
			((Control)dockSite7).AccessibleRole = (AccessibleRole)9;
			((Control)dockSite7).Dock = (DockStyle)1;
			((Control)dockSite7).Location = new Point(0, 0);
			((Control)dockSite7).Name = "dockSite7";
			((Control)dockSite7).Size = new Size(903, 0);
			((Control)dockSite7).TabIndex = 7;
			((Control)dockSite7).TabStop = false;
			((Control)dockSite3).AccessibleRole = (AccessibleRole)9;
			((Control)dockSite3).Dock = (DockStyle)1;
			dockSite3.DocumentDockContainer = new DocumentDockContainer();
			((Control)dockSite3).Location = new Point(0, 0);
			((Control)dockSite3).Name = "dockSite3";
			((Control)dockSite3).Size = new Size(903, 0);
			((Control)dockSite3).TabIndex = 3;
			((Control)dockSite3).TabStop = false;
			((Control)dataMonitorPanel).Dock = (DockStyle)5;
			((Control)dataMonitorPanel).Location = new Point(0, 0);
			((Control)dataMonitorPanel).Name = "dataMonitorPanel";
			((Control)dataMonitorPanel).Size = new Size(903, 525);
			((Control)dataMonitorPanel).TabIndex = 9;
			((Control)dockSite1).AccessibleRole = (AccessibleRole)9;
			((Control)dockSite1).Dock = (DockStyle)3;
			dockSite1.DocumentDockContainer = new DocumentDockContainer();
			((Control)dockSite1).Location = new Point(0, 0);
			((Control)dockSite1).Name = "dockSite1";
			((Control)dockSite1).Size = new Size(0, 525);
			((Control)dockSite1).TabIndex = 10;
			((Control)dockSite1).TabStop = false;
			((Control)this).Controls.Add((Control)(object)dataMonitorPanel);
			((Control)this).Controls.Add((Control)(object)dockSite1);
			((Control)this).Controls.Add((Control)(object)dockSite2);
			((Control)this).Controls.Add((Control)(object)dockSite3);
			((Control)this).Controls.Add((Control)(object)dockSite4);
			((Control)this).Controls.Add((Control)(object)dockSite5);
			((Control)this).Controls.Add((Control)(object)dockSite6);
			((Control)this).Controls.Add((Control)(object)dockSite7);
			((Control)this).Controls.Add((Control)(object)dockSite8);
			((Control)this).Name = "EditorView";
			((Control)this).Size = new Size(903, 525);
			((Control)this).ResumeLayout(false);
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing)
			{
				CleaupResources();
			}
		}

		public void CleaupResources()
		{
			model.ChangeActiveScreenEvent -= OnChangeActiveScreen;
			model.AllScreensRemovedEvent -= OnAllScreensRemoved;
			model.ScreenRemovedEvent -= OnScreenRemovedEvent;
			model.ScreenNameChangedEvent -= OnScreenNameChangedEvent;
			model.RunLocationChanged -= OnRunLocationChanged;
			controller.ScreenAddedEvent -= OnScreenAddedEvent;
			controller.AllScreensLoadedEvent -= OnAllScreensLoadedEvent;
			if (parameterQueryList != null)
			{
				foreach (ICalibration value in Model.DataSources.Values)
				{
					int num = parameterQueryList.IndexOfKey(value.SourceAddress);
					if (num != -1)
					{
						ParameterQueryDialog parameterQueryDialog = (ParameterQueryDialog)parameterQueryList.GetByIndex(num);
						parameterQueryDialog.ShouldClose = true;
						((Component)(object)parameterQueryDialog).Dispose();
					}
				}
			}
			if (j1939_71parameterQueryList != null && j1939_71parameterQueryList.Count != 0)
			{
				J1939_71ParameterQueryDialog j1939_71ParameterQueryDialog = (J1939_71ParameterQueryDialog)j1939_71parameterQueryList.GetByIndex(0);
				j1939_71ParameterQueryDialog.ShouldClose = true;
				((Component)(object)j1939_71ParameterQueryDialog).Dispose();
				if (broadcastQueryDialog != null)
				{
					BroadcastParameterDialog broadcastParameterDialog = (BroadcastParameterDialog)broadcastQueryDialog.GetByIndex(0);
					broadcastParameterDialog.ShouldClose = true;
					((Component)(object)broadcastParameterDialog).Dispose();
				}
			}
			ClearAllBars();
		}

		private void ClearAllBars()
		{
			for (int i = 0; i < screenBarManager.Bars.Count; i++)
			{
				Bar bar = screenBarManager.Bars[i];
				if (bar.Items != null)
				{
					for (int j = 0; j < bar.Items.Count; j++)
					{
						if (bar.Items[j].Text.ToLower().IndexOf("hex editor") >= 0)
						{
							bar.Items.Remove(j);
						}
					}
				}
				((Component)(object)bar).Dispose();
			}
			screenBarManager.Bars.Clear();
			filldockSite.DocumentDockContainer.Documents.Clear();
		}

		private bool IsLayOutPresent()
		{
			string text = string.Empty;
			NewDataSet.MonitorSessionRow monitorSessionRow = (NewDataSet.MonitorSessionRow)Model.MonitorSession.MonitorSession.Rows[0];
			try
			{
				text = monitorSessionRow.Dotnetbarlayouts;
			}
			catch
			{
				monitorSessionRow.Dotnetbarlayouts = string.Empty;
			}
			return text.Length != 0;
		}

		private Bar GetBar(string screenName, string longScreenName)
		{
			Bar bar = null;
			lock (screenBarManager.Bars)
			{
				foreach (Bar bar2 in screenBarManager.Bars)
				{
					if (bar2.Items == null)
					{
						continue;
					}
					for (int i = 0; i < bar2.Items.Count; i++)
					{
						if (bar2.Items[i].Text == screenName || bar2.Items[i].Text == longScreenName || ((bar2.Items[i] as DockContainerItem).Control is HexEditorView && screenName.Contains("Hex Editor")))
						{
							bar = bar2;
							break;
						}
					}
					if (bar != null)
					{
						break;
					}
				}
			}
			return bar;
		}

		private void ActivateScreen(string screenName)
		{
			Bar bar = GetBar(screenName, string.Empty);
			if (bar != null)
			{
				int screenIndex = GetScreenIndex(bar, screenName);
				bar.SelectedDockTab = screenIndex;
				((Control)bar).Focus();
			}
		}

		public void OnChangeActiveScreen(object sender, ChangeActiveScreenEventArgs e)
		{
			CurrentScreen = e.NewScreen;
			ActivateScreen(CurrentScreen.Title);
		}

		public void OnAllScreensRemoved(object sender, EventArgs e)
		{
			if (sender is EditorModel)
			{
				if (((Control)this).InvokeRequired)
				{
					((Control)this).BeginInvoke((Delegate)new EventHandler(OnAllScreensRemoved), new object[2] { sender, Controller.CurrentScreen });
				}
				else
				{
					ClearAllBars();
				}
			}
		}

		public void SaveSession()
		{
			for (int i = 0; i < screenBarManager.Bars.Count; i++)
			{
				Bar bar = screenBarManager.Bars[i];
				if (bar.Items.Count == 0)
				{
					screenBarManager.Bars.Remove(bar);
				}
			}
			NewDataSet.MonitorSessionRow monitorSessionRow = (NewDataSet.MonitorSessionRow)Model.MonitorSession.MonitorSession.Rows[0];
			monitorSessionRow.Dotnetbarlayouts = screenBarManager.LayoutDefinition;
		}

		public void Undo()
		{
			Bar firstDocumentBar = GetFirstDocumentBar();
			if (firstDocumentBar != null)
			{
				DockContainerItem dockContainerItem = firstDocumentBar.Items[firstDocumentBar.SelectedDockTab] as DockContainerItem;
				if (dockContainerItem.Control is ScreenView)
				{
					(dockContainerItem.Control as ScreenView).Undo();
				}
				else if (dockContainerItem.Control is HexEditorView)
				{
					(dockContainerItem.Control as HexEditorView).Undo();
				}
			}
		}

		public void Revert()
		{
			lock (screenBarManager.Bars)
			{
				foreach (Bar bar in screenBarManager.Bars)
				{
					foreach (DockContainerItem item in bar.Items)
					{
						if (item.Control is ScreenView)
						{
							(item.Control as ScreenView).Revert();
						}
						else if (item.Control is HexEditorView)
						{
							(item.Control as HexEditorView).RevertAll();
						}
					}
				}
			}
		}

		public void ShowScreenList()
		{
			//IL_000c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0012: Expected O, but got Unknown
			//IL_0023: Unknown result type (might be due to invalid IL or missing references)
			//IL_002a: Expected O, but got Unknown
			ArrayList screens = Model.Screens;
			ContextMenu val = new ContextMenu();
			for (int i = 0; i < screens.Count; i++)
			{
				Screen screen = (Screen)screens[i];
				MenuItem val2 = new MenuItem();
				val2.Text = screen.Title;
				((Menu)val).MenuItems.Add(val2);
				val2.Click += OnScreenListNameClick;
			}
			for (int j = 0; j < ((Menu)val).MenuItems.Count; j++)
			{
				if (((Menu)val).MenuItems[j].Text.Equals(CurrentScreen.Title))
				{
					((Menu)val).MenuItems[j].Checked = true;
					break;
				}
			}
			Bar firstDocumentBar = FirstDocumentBar;
			if (firstDocumentBar != null && firstDocumentBar.Items != null && firstDocumentBar.Items.Count > 0)
			{
				((Control)firstDocumentBar.DockTabControl).ContextMenu = val;
				((Control)firstDocumentBar.DockTabControl).ContextMenu.Show((Control)(object)this, new Point(((Control)this).Right, ((Control)this).Top - 30));
			}
		}

		private Bar CreateBar()
		{
			//IL_0083: Unknown result type (might be due to invalid IL or missing references)
			//IL_0089: Expected O, but got Unknown
			Bar bar = null;
			bar = BarUtilities.CreateDocumentBar();
			bar.LayoutType = eLayoutType.DockContainer;
			bar.CanDockBottom = false;
			bar.CanDockLeft = false;
			bar.CanDockRight = false;
			bar.CanDockTop = false;
			bar.CanTearOffTabs = true;
			bar.CanReorderTabs = true;
			bar.CanUndock = true;
			bar.DockTabAlignment = eTabStripAlignment.Bottom;
			bar.ThemeAware = true;
			bar.Stretch = true;
			bar.AutoSyncBarCaption = true;
			bar.LayoutType = eLayoutType.DockContainer;
			bar.BarType = eBarType.DockWindow;
			((Control)bar).Dock = (DockStyle)0;
			bar.DockSide = eDockSide.Document;
			Font font = new Font("Tahoma", 8.25f, (FontStyle)1);
			((Control)bar).Font = font;
			return bar;
		}

		private void DockScreen(Bar undockedBar)
		{
			if (undockedBar.DockSide != eDockSide.Document)
			{
				ChangeDockedScreenName(undockedBar, 0);
				UnregisterDockedScreenEvents(undockedBar);
				AddScreen(undockedBar.Items[0]);
				undockedBar.Visible = false;
				screenBarManager.RemoveBar(undockedBar);
			}
		}

		public void DockAllScreens()
		{
			ArrayList arrayList = new ArrayList(screenBarManager.Bars);
			for (int i = 0; i < arrayList.Count; i++)
			{
				Bar undockedBar = (Bar)arrayList[i];
				DockScreen(undockedBar);
			}
		}

		private Bar GetFirstDocumentBar()
		{
			Bar bar = null;
			foreach (Bar bar2 in screenBarManager.Bars)
			{
				if (bar2.DockSide == eDockSide.Document)
				{
					bar = bar2;
					break;
				}
			}
			if (bar == null)
			{
				bar = CreateBar();
				bar.DockTabChange += OnDockTabChange;
				filldockSite.GetDocumentUIManager().Dock(bar);
				if (((Control)bar).TopLevelControl != null)
				{
					((Control)bar).TopLevelControl.FindForm().Activated += OnApplicationActivated;
				}
				if (bar.Owner is DotNetBarManager { ParentForm: { } parentForm })
				{
					((Control)parentForm).SizeChanged += OnSizeChanged;
				}
			}
			return bar;
		}

		private void OnSizeChanged(object sender, EventArgs e)
		{
			Bar firstDocumentBar = GetFirstDocumentBar();
			Control parentUserControl = (firstDocumentBar.Owner as DotNetBarManager).ParentUserControl;
			firstDocumentBar.Size = new Size(parentUserControl.Width, parentUserControl.Height);
			firstDocumentBar.RecalcSize();
			firstDocumentBar.RecalcLayout();
		}

		private void AddScreen(BaseItem screenItem)
		{
			Bar firstDocumentBar = GetFirstDocumentBar();
			firstDocumentBar.Items.Add(screenItem);
			firstDocumentBar.Stretch = true;
			firstDocumentBar.Visible = true;
			firstDocumentBar.SelectedDockTab = firstDocumentBar.Items.IndexOf(screenItem);
			if (firstDocumentBar.Name == string.Empty)
			{
				firstDocumentBar.Name = firstDocumentBar.Items[0].Name;
			}
			firstDocumentBar.RecalcLayout();
		}

		private void AddScreen(Screen newScreen)
		{
			CurrentScreen = newScreen;
			string name = newScreen.Name;
			string name2 = newScreen.Name;
			DockContainerItem dockContainerItem = new DockContainerItem(name2, name);
			dockContainerItem.Control = (Control)(object)newScreen.View;
			dockContainerItem.Stretch = true;
			dockContainerItem.Visible = true;
			AddScreen(dockContainerItem);
		}

		private string GenerateHexEditorTitle()
		{
			ICalibration calibration = (ICalibration)Model.DataSources[Model.CurrentSourceAddress];
			string empty = string.Empty;
			string text = string.Empty;
			string empty2 = string.Empty;
			string empty3 = string.Empty;
			if (calibration is ICalibrationDisk)
			{
				empty = Model.DataSourceName;
				empty3 = calibration.CalibrationDataServer.ConfigFileName;
				string[] array = empty3.Split(new char[1] { '\\' });
				if (array.Length > 1)
				{
					text = array[^1];
				}
				return "Hex Editor : " + text + " : " + empty;
			}
			return "Hex Editor : " + calibration.SourceAddress.DisplayId;
		}

		private void OnHexEditorScreenAdded(object sender, HexEditorScreenAddedEventArgs args)
		{
			string text = GenerateHexEditorTitle();
			Bar bar = GetBar("Hex Editor", text);
			if (bar != null)
			{
				if (bar.DockSide == eDockSide.Document)
				{
					text = "Hex Editor";
				}
				ActivateScreen(text);
			}
			else
			{
				DockContainerItem dockContainerItem = new DockContainerItem(args.address.DisplayId, "Hex Editor");
				dockContainerItem.Control = (Control)(object)args.hexEditView;
				dockContainerItem.Stretch = true;
				dockContainerItem.Visible = true;
				AddScreen(dockContainerItem);
			}
		}

		private void ClearView()
		{
			((Control)Panel).Controls.Clear();
			((Control)this).Invalidate();
		}

		private void OnScreenAddedEvent(object sender, ScreenAddedEventArgs e)
		{
			AddScreen(e.NewScreen);
		}

		private void OnAllScreensLoadedEvent(object sender, EventArgs e)
		{
			if (!IsLayOutPresent())
			{
				return;
			}
			NewDataSet.MonitorSessionRow monitorSessionRow = (NewDataSet.MonitorSessionRow)Model.MonitorSession.MonitorSession.Rows[0];
			string tempFileName = Path.GetTempFileName();
			_ = monitorSessionRow.Dotnetbarlayouts;
			StreamWriter streamWriter = new StreamWriter(tempFileName);
			streamWriter.Write(monitorSessionRow.Dotnetbarlayouts);
			streamWriter.Close();
			screenBarManager.BarUndock -= OnBarUnDock;
			screenBarManager.LoadLayout(tempFileName);
			File.Delete(tempFileName);
			for (int i = 0; i < screenBarManager.Bars.Count; i++)
			{
				Bar bar = screenBarManager.Bars[i];
				if (bar.Items.Count == 0)
				{
					screenBarManager.Bars.Remove(bar);
				}
				else
				{
					bar.Visible = true;
				}
			}
			Bar firstDocumentBar = FirstDocumentBar;
			foreach (Bar bar2 in screenBarManager.Bars)
			{
				if (bar2 != firstDocumentBar && bar2.DockSide == eDockSide.Document)
				{
					bar2.DockTabChange += OnDockTabChange;
				}
				if (bar2.DockSide != eDockSide.Document)
				{
					RegisterUnDockedScreenEvents(bar2);
					bar2.Items[0].Text = ((bar2.Items[0] as DockContainerItem).Control as ScreenView).Model.LongScreenName;
					((bar2.Items[0] as DockContainerItem).Control as ScreenView).CurrentScreenName = bar2.Items[0].Text;
					bar2.Name = bar2.Items[0].Name;
				}
			}
			screenBarManager.BarUndock += OnBarUnDock;
		}

		private void OnDockTabChange(object sender, DockTabChangeEventArgs e)
		{
			if (CurrentScreen.Title != e.NewTab.Text)
			{
				RaiseScreenTabChanged(e.NewTab.Text);
			}
		}

		private void RaiseScreenTabChanged(string screenName)
		{
			if (-1 == screenName.IndexOf("Hex Editor"))
			{
				ScreenTabChangedEventArgs e = new ScreenTabChangedEventArgs(screenName);
				if (this.ScreenTabChangedEvent != null)
				{
					((Control)this).BeginInvoke((Delegate)this.ScreenTabChangedEvent, new object[2] { this, e });
				}
			}
		}

		private void RaiseScreenTabClosed()
		{
			if (this.ScreenTabClosedEvent != null)
			{
				((Control)this).BeginInvoke((Delegate)this.ScreenTabClosedEvent, new object[2]
				{
					this,
					EventArgs.Empty
				});
			}
		}

		private void RaiseScreenTitleUpdatedEvent(string previousScreenTitle, string newScreenTitle)
		{
			if (this.ScreenTitleUpdatedEvent != null)
			{
				ScreenTitleUpdatedEventArgs e = new ScreenTitleUpdatedEventArgs(previousScreenTitle, newScreenTitle);
				this.ScreenTitleUpdatedEvent(null, e);
			}
		}

		private void RaiseHexEditorTabClosed(string hexEditorName)
		{
			if (this.HexEditorTabClosedEvent != null)
			{
				IAddressValue sourceAddress = AddressFactory.ProductAddressValue(hexEditorName);
				HexEditorScreenRemoveEventArgs e = new HexEditorScreenRemoveEventArgs(sourceAddress);
				((Control)this).BeginInvoke((Delegate)this.HexEditorTabClosedEvent, new object[2] { this, e });
			}
		}

		private int GetScreenIndex(Bar screenBar, string screenTitle)
		{
			int result = 0;
			if (screenBar.Items != null)
			{
				for (int i = 0; i < screenBar.Items.Count; i++)
				{
					if (screenBar.Items[i].Text == screenTitle)
					{
						result = i;
						break;
					}
				}
			}
			return result;
		}

		private void RemoveScreen(string screenTitle)
		{
			Bar bar = GetBar(screenTitle, string.Empty);
			if (bar != null)
			{
				int screenIndex = GetScreenIndex(bar, screenTitle);
				bar.Items.Remove(screenIndex);
				if (bar.Items != null && bar.Items.Count == 0)
				{
					screenBarManager.RemoveBar(bar);
				}
			}
		}

		private void OnScreenRemovedEvent(object sender, ScreenRemovedEventArgs e)
		{
			RemoveScreen(e.ScreenTitle);
		}

		private void OnDockTabClosing(object sender, DockTabClosingEventArgs e)
		{
			if (e.DockContainerItem.Control is HexEditorView)
			{
				RaiseHexEditorTabClosed(e.DockContainerItem.Name);
			}
			else
			{
				if (CurrentScreen.Title != e.DockContainerItem.Text)
				{
					RaiseScreenTabChanged(e.DockContainerItem.Text);
				}
				RaiseScreenTabClosed();
			}
			e.Cancel = true;
		}

		private void OnBarUnDock(object sender, EventArgs e)
		{
			//IL_001e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0024: Expected O, but got Unknown
			Bar bar = sender as Bar;
			bar.Size = ((Control)this).Size;
			Font font = new Font("Tahoma", 8.25f, (FontStyle)1);
			((Control)bar).Font = font;
			if ((bar.Items[0] as DockContainerItem).Control is HexEditorView)
			{
				bar.Items[0].Text = GenerateHexEditorTitle();
			}
			else
			{
				ScreenView screenView = (bar.Items[0] as DockContainerItem).Control as ScreenView;
				RaiseScreenTitleUpdatedEvent(bar.Items[0].Text, screenView.Model.LongScreenName);
				bar.Items[0].Text = screenView.Model.LongScreenName;
				screenView.CurrentScreenName = screenView.Model.LongScreenName;
			}
			bar.Name = bar.Items[0].Name;
			bar.RecalcLayout();
			RegisterUnDockedScreenEvents(bar);
		}

		private void OnBarClosing(object sender, BarClosingEventArgs e)
		{
			DockScreen(sender as Bar);
		}

		private void RegisterUnDockedScreenEvents(Bar undockedBar)
		{
			//IL_0042: Unknown result type (might be due to invalid IL or missing references)
			//IL_004c: Expected O, but got Unknown
			//IL_00ca: Unknown result type (might be due to invalid IL or missing references)
			//IL_00d4: Expected O, but got Unknown
			//IL_009d: Unknown result type (might be due to invalid IL or missing references)
			//IL_00a7: Expected O, but got Unknown
			undockedBar.Closing += OnBarClosing;
			((Control)undockedBar).FindForm().Activated += OnBarActivated;
			((Control)undockedBar).FindForm().KeyPreview = true;
			((Control)((Control)undockedBar).FindForm()).KeyDown += new KeyEventHandler(OnUndockedScreenKeyDown);
			((Control)undockedBar).DoubleClick += OnUndockedScreenDoubleClick;
			if ((undockedBar.Items[0] as DockContainerItem).Control is HexEditorView)
			{
				((undockedBar.Items[0] as DockContainerItem).Control as HexEditorView).GridKeyDown += new KeyEventHandler(OnUndockedScreenKeyDown);
			}
			else
			{
				((undockedBar.Items[0] as DockContainerItem).Control as ScreenView).GridKeyDown += new KeyEventHandler(OnUndockedScreenKeyDown);
			}
		}

		private void UnregisterDockedScreenEvents(Bar dockedBar)
		{
			//IL_0042: Unknown result type (might be due to invalid IL or missing references)
			//IL_004c: Expected O, but got Unknown
			//IL_00b8: Unknown result type (might be due to invalid IL or missing references)
			//IL_00c2: Expected O, but got Unknown
			//IL_008b: Unknown result type (might be due to invalid IL or missing references)
			//IL_0095: Expected O, but got Unknown
			dockedBar.Closing -= OnBarClosing;
			((Control)dockedBar).FindForm().Activated -= OnBarActivated;
			((Control)dockedBar).FindForm().KeyPreview = false;
			((Control)((Control)dockedBar).FindForm()).KeyDown -= new KeyEventHandler(OnUndockedScreenKeyDown);
			if ((dockedBar.Items[0] as DockContainerItem).Control is HexEditorView)
			{
				((dockedBar.Items[0] as DockContainerItem).Control as HexEditorView).GridKeyDown -= new KeyEventHandler(OnUndockedScreenKeyDown);
			}
			else
			{
				((dockedBar.Items[0] as DockContainerItem).Control as ScreenView).GridKeyDown -= new KeyEventHandler(OnUndockedScreenKeyDown);
			}
		}

		private void OnUndockedScreenDoubleClick(object sender, EventArgs e)
		{
			Bar bar = sender as Bar;
			DockScreen(bar);
			((Control)bar).DoubleClick -= OnUndockedScreenDoubleClick;
		}

		private void OnBarDock(object sender, EventArgs e)
		{
			Bar bar = sender as Bar;
			for (int i = 0; i < bar.Items.Count && !ChangeDockedScreenName(bar, i); i++)
			{
			}
			UnregisterDockedScreenEvents(bar);
		}

		private bool ChangeDockedScreenName(Bar screenBar, int count)
		{
			bool result = false;
			if ((screenBar.Items[count] as DockContainerItem).Control is HexEditorView)
			{
				screenBar.Items[count].Text = "Hex Editor";
			}
			else
			{
				ScreenView screenView = (screenBar.Items[count] as DockContainerItem).Control as ScreenView;
				if (screenBar.Items[count].Text == screenView.Model.LongScreenName)
				{
					RaiseScreenTitleUpdatedEvent(screenBar.Items[count].Text, screenView.Model.Name);
					screenBar.Items[count].Text = screenView.Model.Name;
					screenView.CurrentScreenName = screenView.Model.Name;
					result = true;
				}
			}
			return result;
		}

		private void OnBarActivated(object sender, EventArgs e)
		{
			Bar bar = (Bar)(object)((Control)((sender is Form) ? sender : null)).Controls[0];
			if (bar.SelectedDockContainerItem != null)
			{
				string text = bar.SelectedDockContainerItem.Text;
				if (CurrentScreen.Title != text)
				{
					RaiseScreenTabChanged(text);
				}
			}
		}

		private void OnApplicationActivated(object sender, EventArgs e)
		{
			Bar firstDocumentBar = FirstDocumentBar;
			if (firstDocumentBar != null && firstDocumentBar.Items != null && firstDocumentBar.Items.Count > 0 && firstDocumentBar.SelectedDockContainerItem != null)
			{
				string text = firstDocumentBar.SelectedDockContainerItem.Text;
				if (CurrentScreen.Title != text && CurrentScreen.Name != text)
				{
					RaiseScreenTabChanged(text);
				}
			}
		}

		private void OnScreenListNameClick(object sender, EventArgs e)
		{
			ActivateScreen(((MenuItem)((sender is MenuItem) ? sender : null)).Text);
		}

		private void OnDatasourceNameChangedEvent(object sender, DatasourceNameChangedEventArgs e)
		{
			foreach (Bar bar in screenBarManager.Bars)
			{
				if (!bar.Docked && (bar.Items[0] as DockContainerItem).Control is HexEditorView)
				{
					bar.Items[0].Text = GenerateHexEditorTitle();
					continue;
				}
				foreach (DockContainerItem item in bar.Items)
				{
					string text = item.Text;
					if (item.Control is HexEditorView)
					{
						item.Text = "Hex Editor";
						continue;
					}
					ScreenView screenView = item.Control as ScreenView;
					item.Text = screenView.ChangeScreenTitle(bar.Docked, e.DatasourceName);
					RaiseScreenTitleUpdatedEvent(text, item.Text);
				}
			}
			if (parameterQueryList == null)
			{
				return;
			}
			foreach (ParameterQueryDialog value in parameterQueryList.Values)
			{
				if (value.DataSourceName == e.OldDataSourceName)
				{
					value.DataSourceName = e.DatasourceName;
					break;
				}
			}
		}

		public void OnScreenNameChangedEvent(object sender, ScreenNameChangedEventArgs args)
		{
			Bar bar = GetBar(args.PreviousScreenName, args.PreviousLongScreenName);
			if (bar != null)
			{
				string newScreenName = args.NewScreenName;
				string empty = string.Empty;
				empty = ((!bar.Docked) ? args.NewLongScreenName : args.NewScreenName);
				if (bar.Name == args.PreviousScreenName)
				{
					bar.Name = newScreenName;
					((Control)bar).Text = empty;
				}
				bar.SelectedDockContainerItem.Name = newScreenName;
				bar.SelectedDockContainerItem.Text = empty;
			}
		}

		private void RaiseUndockedScreenKeyDownEvent(object sender, KeyEventArgs e)
		{
			if (this.UndockedScreenKeyDownEvent != null)
			{
				this.UndockedScreenKeyDownEvent.Invoke((object)this, e);
			}
		}

		private void OnUndockedScreenKeyDown(object sender, KeyEventArgs e)
		{
			RaiseUndockedScreenKeyDownEvent(sender, e);
		}

		private void OnHexEditorRemovedEvent(object sender, HexEditorScreenRemoveEventArgs e)
		{
			string longScreenName = GenerateHexEditorTitle();
			GetBar("Hex Editor", longScreenName)?.Items.Remove(e.address.DisplayId);
		}

		private void OnRunLocationChanged(object sender, RunLocationChangedEventArgs e)
		{
			if (!((Control)this).InvokeRequired)
			{
				if (model.Screens.Count > 0 && sender is ICalibration)
				{
					ICalibration calibration = sender as ICalibration;
					if (calibration.CalibrationDataServer.GTISLevel != GTISVersion.GTIS45)
					{
						string message = string.Format(Editor.ResourceManager.GetString(EditorMessageIDs.RunLocationChanged.ToString()), calibration.SourceAddress.Value, e.EcmRunLocation.ToString());
						EventLogger.Warn("Editor", message);
					}
				}
			}
			else
			{
				RunLocationChangedEventHandler runLocationChangedEventHandler = OnRunLocationChanged;
				((Control)this).BeginInvoke((Delegate)runLocationChangedEventHandler, new object[2] { sender, e });
			}
		}

		private void BufferData()
		{
			//IL_0021: Unknown result type (might be due to invalid IL or missing references)
			_WaitDlg = new WaitDlg();
			_WaitDlg.setTitle("Buffering data, please wait for few seconds ...");
			((Form)_WaitDlg).ShowDialog();
		}

		private void PopulateParameterQuery()
		{
			lock (this)
			{
				bool flag = false;
				if (!((Control)this).InvokeRequired)
				{
					if (parameterQueryList == null)
					{
						parameterQueryList = new SortedList(Model.DataSources.Count);
						flag = true;
						Thread thread = new Thread(BufferData);
						thread.IsBackground = true;
						thread.Start();
					}
					foreach (ICalibration value in Model.DataSources.Values)
					{
						ParameterQueryDialog parameterQueryDialog = null;
						if (!parameterQueryList.Contains(value.SourceAddress))
						{
							parameterQueryDialog = CreateParameterQuery(value);
							if (parameterQueryDialog != null)
							{
								parameterQueryList.Add(value.SourceAddress, parameterQueryDialog);
							}
						}
					}
				}
				else
				{
					PopulateParameterQueryDeleagte populateParameterQueryDeleagte = PopulateParameterQuery;
					((Control)this).BeginInvoke((Delegate)populateParameterQueryDeleagte);
				}
				if (flag)
				{
					_WaitDlg.ShouldCloseNow = true;
				}
			}
		}

		private void PopulateJ1939_71ParameterQuery()
		{
			lock (this)
			{
				bool flag = false;
				if (!((Control)this).InvokeRequired)
				{
					if (j1939_71parameterQueryList == null)
					{
						j1939_71parameterQueryList = new SortedList(Model.DataSources.Count);
						flag = true;
						Thread thread = new Thread(BufferData);
						thread.IsBackground = true;
						thread.Start();
					}
					ICalibrationOnline calibrationOnline = (ICalibrationOnline)Model.DataSources.GetByIndex(0);
					if (calibrationOnline != null)
					{
						J1939_71ParameterQueryDialog j1939_71ParameterQueryDialog = null;
						BroadcastParameterDialog broadcastParameterDialog = null;
						if (!j1939_71parameterQueryList.Contains(calibrationOnline.SourceAddress))
						{
							SortedList sortedList = new SortedList(Model.DataSources.Count);
							foreach (ICalibration value in Model.DataSources.Values)
							{
								sortedList.Add(value.SourceAddress.ToString(), value.DataSourceName.ToString());
							}
							j1939_71ParameterQueryDialog = CreateJ1939_71ParameterQuery(calibrationOnline, sortedList);
							foreach (ICalibration value2 in Model.DataSources.Values)
							{
								j1939_71parameterQueryList.Add(value2.SourceAddress, j1939_71ParameterQueryDialog);
							}
							broadcastParameterDialog = CreateBroadcastParameterQuery(calibrationOnline);
							if (broadcastParameterDialog != null)
							{
								broadcastQueryDialog = new SortedList();
								broadcastQueryDialog.Add(0, broadcastParameterDialog);
								fetchData = true;
							}
						}
					}
				}
				else
				{
					PopulateJ1939_71ParameterQueryDeleagte populateJ1939_71ParameterQueryDeleagte = PopulateJ1939_71ParameterQuery;
					((Control)this).BeginInvoke((Delegate)populateJ1939_71ParameterQueryDeleagte);
				}
				if (flag)
				{
					_WaitDlg.ShouldCloseNow = true;
				}
			}
		}

		private ParameterQueryDialog CreateParameterQuery(ICalibration datasource)
		{
			bool isDataSourceOffline = datasource is ICalibrationDisk;
			ParameterQueryDialog parameterQueryDialog = new ParameterQueryDialog(datasource.ParametersInfo, model.MonitorSession.Screen, Model.DataSourceName, datasource.ConfigFileProperties.FileName, isDataSourceOffline);
			parameterQueryDialog.ParameterAddedOnScreenEvent += OnParameterAddedOnScreenEvent;
			parameterQueryDialog.ParameterQueryClosing += OnParameterQueryClosing;
			return parameterQueryDialog;
		}

		private J1939_71ParameterQueryDialog CreateJ1939_71ParameterQuery(ICalibration datasource, SortedList deviceList)
		{
			J1939_71ParameterQueryDialog j1939_71ParameterQueryDialog = new J1939_71ParameterQueryDialog(datasource, datasource.ParametersInfo, model.MonitorSession.Screen, Model.DataSourceName, datasource.ConfigFileProperties.FileName, deviceList);
			j1939_71ParameterQueryDialog.ParameterAddedOnScreenEvent += OnParameterAddedOnScreenEvent;
			j1939_71ParameterQueryDialog.ParameterQueryClosing += OnJ1939_71ParameterQueryClosing;
			j1939_71ParameterQueryDialog.ShowBroadcastListDialog += OnShowBroadcastList;
			return j1939_71ParameterQueryDialog;
		}

		private BroadcastParameterDialog CreateBroadcastParameterQuery(ICalibrationOnline datasource)
		{
			BroadcastParameterDialog broadcastParameterDialog = new BroadcastParameterDialog(datasource, datasource.ParametersInfo, model.MonitorSession.Screen);
			broadcastParameterDialog.ParameterAddedOnScreenEvent += OnParameterAddedOnScreenEvent;
			broadcastParameterDialog.ParameterQueryClosing += OnBroadcastParameterQueryClosing;
			return broadcastParameterDialog;
		}

		public void ParameterQuery(ICalibration calibration)
		{
			Cursor cursor = ((Control)this).Cursor;
			((Control)this).Cursor = Cursors.WaitCursor;
			PopulateParameterQuery();
			((Control)(ParameterQueryDialog)parameterQueryList[calibration.SourceAddress]).Show();
			((Control)(ParameterQueryDialog)parameterQueryList[calibration.SourceAddress]).Visible = true;
			((Control)(ParameterQueryDialog)parameterQueryList[calibration.SourceAddress]).Focus();
			((Form)(ParameterQueryDialog)parameterQueryList[calibration.SourceAddress]).WindowState = (FormWindowState)0;
			((ParameterQueryDialog)parameterQueryList[calibration.SourceAddress]).CurrentScreenName = CurrentScreen.Name;
			((Control)this).Cursor = cursor;
		}

		public void J1939_71ParameterQuery(ICalibration calibration)
		{
			bool flag = true;
			IAppConfigService appConfigService = (IAppConfigService)ServiceManager.Services.GetService(typeof(IAppConfigService));
			string appSetting = appConfigService.GetAppSetting(ApplicationSettings.LastModuleConnectSettingsType);
			foreach (ICalibration value in Model.DataSources.Values)
			{
				if ((value is ICalibrationOnline && appSetting.Equals("Manual")) || (value.Connected && !(value is ICalibrationASAM)))
				{
					flag = false;
				}
			}
			if (!flag)
			{
				Cursor cursor = ((Control)this).Cursor;
				((Control)this).Cursor = Cursors.WaitCursor;
				PopulateJ1939_71ParameterQuery();
				if (j1939_71parameterQueryList.Contains(calibration.SourceAddress))
				{
					((Control)(J1939_71ParameterQueryDialog)j1939_71parameterQueryList[calibration.SourceAddress]).Show();
					((Control)(J1939_71ParameterQueryDialog)j1939_71parameterQueryList[calibration.SourceAddress]).Visible = true;
					((Control)(J1939_71ParameterQueryDialog)j1939_71parameterQueryList[calibration.SourceAddress]).Focus();
					((Form)(J1939_71ParameterQueryDialog)j1939_71parameterQueryList[calibration.SourceAddress]).WindowState = (FormWindowState)0;
					((J1939_71ParameterQueryDialog)j1939_71parameterQueryList[calibration.SourceAddress]).CurrentScreenName = CurrentScreen.Name;
				}
				((Control)this).Cursor = cursor;
			}
		}

		private void OnParameterAddedOnScreenEvent(object sender, ParameterAddedOnScreenEventArgs e, bool isBroadcast, IAddressValue sourceAddress)
		{
			if (this.ParameterAddedOnScreenEvent != null)
			{
				this.ParameterAddedOnScreenEvent(this, e, isBroadcast, sourceAddress);
			}
		}

		private void OnShowBroadcastList(object sender, EventArgs e)
		{
			Cursor current = Cursor.Current;
			Cursor.Current = Cursors.WaitCursor;
			if (fetchData)
			{
				((BroadcastParameterDialog)broadcastQueryDialog[0]).fetchData();
				fetchData = false;
			}
			((BroadcastParameterDialog)broadcastQueryDialog[0]).CurrentScreenName = CurrentScreen.Name;
			((Control)(BroadcastParameterDialog)broadcastQueryDialog[0]).Show();
			Cursor.Current = current;
		}

		public void CloseBroadcastList()
		{
			if (broadcastQueryDialog != null && ((Control)(BroadcastParameterDialog)broadcastQueryDialog[0]).Visible)
			{
				((Form)(BroadcastParameterDialog)broadcastQueryDialog[0]).Close();
			}
		}

		private void OnFileSaveAsEvent(object sender, FileSaveAsEventArgs args)
		{
			PopulateParameterQuery();
			if (parameterQueryList.Contains(args.OldSourceAddress))
			{
				ParameterQueryDialog value = (ParameterQueryDialog)parameterQueryList[args.OldSourceAddress];
				parameterQueryList.Remove(args.OldSourceAddress);
				if (!parameterQueryList.Contains(args.NewSourceAddress))
				{
					parameterQueryList.Add(args.NewSourceAddress, value);
				}
			}
		}

		private void OnParameterQueryClosing(object sender, CancelEventArgs e)
		{
			((Control)(sender as ParameterQueryDialog)).Visible = false;
		}

		private void OnJ1939_71ParameterQueryClosing(object sender, CancelEventArgs e)
		{
			((Control)(sender as J1939_71ParameterQueryDialog)).Visible = false;
		}

		private void OnBroadcastParameterQueryClosing(object sender, CancelEventArgs e)
		{
			((Control)(sender as BroadcastParameterDialog)).Visible = false;
		}
	}
	internal class EDMMonitor : Monitor
	{
		private const int SlowestDataRefreshRate = 10000;

		private const int FastestDataRefreshRate = 0;

		private const int DefaultDataRefreshRate = 20;

		public EDMMonitor(IModuleNetwork network)
			: base(network)
		{
		}

		public override void SetRefreshRate(int rate, RefreshUnitsType units)
		{
			int num = 20;
			ICalibrationECM calibrationECM = null;
			if (base.Network != null)
			{
				foreach (IAddressValue key in base.Network.Modules.Keys)
				{
					ICalibrationOnline calibration = base.Network.GetCalibration(key);
					if (calibration is ICalibrationECM)
					{
						calibrationECM = (ICalibrationECM)calibration;
						num = Convert(rate, RefreshUnitsType.Milliseconds, units);
						if (num != calibrationECM.EDMRate)
						{
							calibrationECM.EDMRate = num;
							if (num != calibrationECM.EDMRate)
							{
								EventLogger.Warn("Editor", "EDM refresh rate set to nearest compatible rate " + calibrationECM.EDMRate + " " + units);
							}
							else
							{
								EventLogger.Log("Editor", "EDM refresh rate set to " + calibrationECM.EDMRate + " " + units);
							}
							num = calibrationECM.EDMRate;
						}
					}
					else if (calibration is ICalibrationASAM)
					{
						num = Convert(rate, RefreshUnitsType.Milliseconds, units);
						if (num <= 10000 && num >= 0)
						{
							dataRefreshRate = rate;
						}
					}
				}
			}
			dataRefreshRate = Convert(num, units, RefreshUnitsType.Milliseconds);
			dataRefreshUnit = units;
			lock (base.AddressSubscriptions)
			{
				foreach (ISubscription value in base.AddressSubscriptions.Values)
				{
					if (value == null)
					{
						continue;
					}
					ICalibrationOnline calibrationOnline = (ICalibrationOnline)value.DataSource;
					if (calibrationOnline is ICalibrationECM)
					{
						calibrationECM = (ICalibrationECM)calibrationOnline;
						if (value.BaseRate != calibrationECM.EDMRate)
						{
							value.BaseRate = calibrationECM.EDMRate;
						}
					}
					else if (calibrationOnline is ICalibrationASAM)
					{
						value.BaseRate = calibrationECM.EDMRate;
					}
					if (!base.Network.UserSuspendMonitoring && !value.IsActive)
					{
						try
						{
							value.Start();
						}
						catch (Exception e)
						{
							EventLogger.Error("Editor", "Failed to start monitoring on device address : " + value.SourceAddress.DisplayId, e);
						}
					}
				}
			}
		}

		protected override void PauseSubscription(ISubscription subscription)
		{
			if (subscription is IPausable)
			{
				(subscription as IPausable).Pause();
			}
		}

		protected override void ResumeSubscription(ISubscription subscription)
		{
			if (subscription is IPausable)
			{
				(subscription as IPausable).Resume();
			}
		}

		protected override bool ValidateParameter(ParameterEventArgs e)
		{
			bool flag = true;
			flag = base.ValidateParameter(e);
			if (flag && e.Name.StartsWith("_"))
			{
				flag = false;
				EventLogger.Error("Editor", "Fail to monitor the parameter " + e.Name + " " + DataAcquisitionType.EDM.ToString() + " does not supports Interface parameters.");
			}
			return flag;
		}

		protected override bool ValidateSubscription(ISubscription subscription)
		{
			bool result;
			if (subscription is PCLSubscriptionBase)
			{
				result = true;
			}
			else
			{
				result = true;
				ICalibrationOnline calibrationOnline = (ICalibrationOnline)subscription.DataSource;
				if (calibrationOnline != null)
				{
					if (calibrationOnline is ICalibrationECM)
					{
						if (calibrationOnline.CalibrationDataServer.GTISLevel == GTISVersion.GTIS45)
						{
							if (!ValidateChangeLock(calibrationOnline))
							{
								result = false;
								AcquireChangeLock(calibrationOnline as ICalibrationECM);
							}
							result = true;
						}
						else
						{
							result = false;
							EventLogger.Error("Editor", "Failed to start monitoring on device address : " + subscription.SourceAddress.ToString() + " because EDM supports only GTIS 4.5.");
						}
					}
				}
				else
				{
					result = false;
				}
			}
			return result;
		}

		protected override ISubscription GetSubscription(bool IsAddress, bool shouldStop, IAddressValue sourceAddress, DataAccessType dataAccessType)
		{
			ISubscription subscription = null;
			if (dataAccessType == DataAccessType.Proprietary)
			{
				subscription = GetAddressSubscription(sourceAddress);
				if (subscription != null && shouldStop)
				{
					subscription.Stop();
				}
			}
			else
			{
				subscription = GetPublicDataSubscription(sourceAddress, dataAccessType);
			}
			return subscription;
		}

		protected override ISubscription CreateSubscription(IAddressValue sourceAddress)
		{
			IECMSubscription iECMSubscription = null;
			ICalibrationOnline calibration = base.Network.GetCalibration(sourceAddress);
			if (calibration != null)
			{
				if (calibration is ICalibrationASAM)
				{
					EventLogger.Warn("EDMHandler", "EDM not supported for ASAM Calibration at address " + sourceAddress.ToString() + ". Monitoring will continue in Request/Receive mode at" + dataRefreshRate + " rate");
				}
				else if (calibration is ICalibrationECM && !calibration.EDMAvailable)
				{
					throw new MonitorModeNotSupportedException(Facility.Editor, 2, "EDM Monitor Mode is not supported", sourceAddress.ToString(), DataAcquisitionType.EDM.ToString());
				}
				iECMSubscription = (IECMSubscription)SubscriptionProvider.Create(calibration, DataAcquisitionType.EDM, NotifyType.Message);
				iECMSubscription.MonitorTimeoutEnabled = base.ConnectionTimeoutEnabled;
				iECMSubscription.MonitorTimeoutFloor = base.ConnectionTimeoutMinimum;
				iECMSubscription.MonitorTimeoutFactor = base.ConnectionTimeoutFactor;
				iECMSubscription.ConnectionLost += base.OnConnectionLost;
				iECMSubscription.PerformanceStatistics += base.OnPerformanceUpdate;
				iECMSubscription.RunLocationChange += OnRunLocationChange;
				iECMSubscription.StopBroadCast += base.OnStopBroadCast;
				iECMSubscription.BaseRate = Convert(base.DataRefreshRate, RefreshUnitsType.Milliseconds, base.DataRefreshUnit);
				iECMSubscription.Notification += base.OnDataRefresh;
				iECMSubscription.LastParameterRemoved += base.OnLastParameterRemoved;
				return iECMSubscription;
			}
			throw new UnableToFindCalibrationException(Facility.Editor, 1, "Could Not get the calibration", sourceAddress.ToString());
		}
	}
	internal delegate void ParameterChangedEventHandler(object sender, ParameterChangedEventArgs e);
	internal enum ActionType
	{
		ParameterAdded,
		ParameterDeleted,
		SourceAddressChanged
	}
	internal class GaugeControl : UserControl
	{
		private const double DefaultRedLineFactor = 0.9;

		private const int MaxPointerIndex = 2;

		private const int MinPointerIndex = 1;

		private Panel panelGauge;

		private Panel panelTextBox;

		private Panel panelCombo;

		private string oldValue = string.Empty;

		private ComboBox comboBoxSA;

		private ContextMenu contextMenuGaugeSetting;

		private MenuItem menuItemGaugeSetting;

		private Label labelUnit;

		private ToolTip toolTipUnits;

		private IContainer components;

		private ParameterTextbox parameterTextbox;

		private GaugeAngular gaugeAngular;

		private TextBox textBoxMin;

		private TextBox textBoxMax;

		private TextBox textBoxCurrent;

		private MenuItem menuItemResetMinMax;

		private MenuItem menuItemShowMinMaxPointers;

		private NewDataSet.GaugeRow gaugeRow;

		private double minimumValue = double.MaxValue;

		private double maximumValue = double.MinValue;

		public string Value
		{
			get
			{
				return gaugeAngular.Value;
			}
			set
			{
				((Control)textBoxCurrent).Text = value;
				try
				{
					double num = double.Parse(value);
					gaugeAngular.Value = num;
					if (gaugeAngular.InnerRadius != 48)
					{
						gaugeAngular.InnerRadius = 48;
					}
					if (num > MaximumValue)
					{
						MaximumValue = num;
					}
					if (num < MinimumValue)
					{
						MinimumValue = num;
					}
				}
				catch
				{
				}
			}
		}

		public string SourceAddress => ((Control)comboBoxSA).Text;

		public Cummins.Parameter.Parameter Parameter
		{
			get
			{
				return parameterTextbox.Parameter;
			}
			set
			{
				if (value != parameterTextbox.Parameter)
				{
					parameterTextbox.Parameter = value;
					StartValue = value.ParameterModel.LowerBound;
					EndValue = value.ParameterModel.UpperBound;
					RedLineVisible = true;
					Unit = value.ParameterModel.DisplayUnits;
					StartRedLineValue = (EndValue - StartValue) * 0.9;
					RestoreMinMaxValues();
					menuItemResetMinMax.Enabled = true;
					menuItemShowMinMaxPointers.Enabled = true;
				}
			}
		}

		public double StartValue
		{
			get
			{
				return GaugeRow.MinValue;
			}
			set
			{
				if (value != GaugeRow.MinValue)
				{
					GaugeRow.MinValue = value;
					gaugeAngular.ScaleRange.Min = value;
				}
			}
		}

		public double EndValue
		{
			get
			{
				return GaugeRow.MaxValue;
			}
			set
			{
				if (value != GaugeRow.MaxValue)
				{
					GaugeRow.MaxValue = value;
					gaugeAngular.ScaleRange.Span = GaugeRow.MaxValue - GaugeRow.MinValue;
				}
			}
		}

		public double StartRedLineValue
		{
			get
			{
				return GaugeRow.RedLinesStart;
			}
			set
			{
				if (value != GaugeRow.RedLinesStart)
				{
					GaugeRow.RedLinesStart = value;
					RefreshGaugeView();
				}
			}
		}

		public bool RedLineVisible
		{
			get
			{
				return GaugeRow.RedLineVisible;
			}
			set
			{
				if (value != GaugeRow.RedLineVisible)
				{
					GaugeRow.RedLineVisible = value;
					RefreshGaugeView();
				}
			}
		}

		public NewDataSet.GaugeRow GaugeRow
		{
			get
			{
				return gaugeRow;
			}
			set
			{
				gaugeRow.MaxValue = value.MaxValue;
				gaugeRow.MinValue = value.MinValue;
				gaugeRow.RedLinesStart = value.RedLinesStart;
				gaugeRow.RedLineVisible = value.RedLineVisible;
				RefreshGaugeView();
			}
		}

		public string Unit
		{
			set
			{
				Graphics val = ((Control)labelUnit).CreateGraphics();
				int num = (int)(val.MeasureString(value, ((Control)labelUnit).Font).Width / (float)value.Length);
				int num2 = ((Control)labelUnit).Size.Width / num;
				if (num2 >= value.Length)
				{
					((Control)labelUnit).Text = value;
				}
				else
				{
					((Control)labelUnit).Text = value.Substring(0, num2);
				}
				toolTipUnits.SetToolTip((Control)(object)labelUnit, value);
			}
		}

		private double MaximumValue
		{
			get
			{
				return maximumValue;
			}
			set
			{
				maximumValue = value;
				((Control)textBoxMax).Text = value.ToString();
				gaugeAngular.Pointers[2].Value = gaugeAngular.Value;
			}
		}

		private double MinimumValue
		{
			get
			{
				return minimumValue;
			}
			set
			{
				minimumValue = value;
				((Control)textBoxMin).Text = value.ToString();
				gaugeAngular.Pointers[1].Value = gaugeAngular.Value;
			}
		}

		internal event ParameterChangedEventHandler ParameterChangedEvent;

		protected GaugeControl()
		{
			InitializeComponent();
		}

		public GaugeControl(NewDataSet.GaugeRow gaugeRow)
		{
			InitializeComponent();
			this.gaugeRow = gaugeRow;
		}

		private void InitializeComponent()
		{
			//IL_002b: Unknown result type (might be due to invalid IL or missing references)
			//IL_0035: Expected O, but got Unknown
			//IL_0036: Unknown result type (might be due to invalid IL or missing references)
			//IL_0040: Expected O, but got Unknown
			//IL_004c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0056: Expected O, but got Unknown
			//IL_0057: Unknown result type (might be due to invalid IL or missing references)
			//IL_0061: Expected O, but got Unknown
			//IL_0062: Unknown result type (might be due to invalid IL or missing references)
			//IL_006c: Expected O, but got Unknown
			//IL_006d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0077: Expected O, but got Unknown
			//IL_0078: Unknown result type (might be due to invalid IL or missing references)
			//IL_0082: Expected O, but got Unknown
			//IL_0083: Unknown result type (might be due to invalid IL or missing references)
			//IL_008d: Expected O, but got Unknown
			//IL_008e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0098: Expected O, but got Unknown
			//IL_0099: Unknown result type (might be due to invalid IL or missing references)
			//IL_00a3: Expected O, but got Unknown
			//IL_00a4: Unknown result type (might be due to invalid IL or missing references)
			//IL_00ae: Expected O, but got Unknown
			//IL_00ba: Unknown result type (might be due to invalid IL or missing references)
			//IL_00c4: Expected O, but got Unknown
			//IL_00cb: Unknown result type (might be due to invalid IL or missing references)
			//IL_00d5: Expected O, but got Unknown
			//IL_01ab: Unknown result type (might be due to invalid IL or missing references)
			//IL_01b5: Expected O, but got Unknown
			components = new Container();
			ColorSection colorSection = new ColorSection();
			ColorSection colorSection2 = new ColorSection();
			PointerGaugeAngular pointerGaugeAngular = new PointerGaugeAngular();
			PointerGaugeAngular pointerGaugeAngular2 = new PointerGaugeAngular();
			PointerGaugeAngular pointerGaugeAngular3 = new PointerGaugeAngular();
			panelGauge = new Panel();
			labelUnit = new Label();
			gaugeAngular = new GaugeAngular();
			contextMenuGaugeSetting = new ContextMenu();
			menuItemGaugeSetting = new MenuItem();
			menuItemResetMinMax = new MenuItem();
			menuItemShowMinMaxPointers = new MenuItem();
			panelTextBox = new Panel();
			textBoxMax = new TextBox();
			textBoxCurrent = new TextBox();
			textBoxMin = new TextBox();
			panelCombo = new Panel();
			parameterTextbox = new ParameterTextbox();
			comboBoxSA = new ComboBox();
			toolTipUnits = new ToolTip(components);
			((Control)panelGauge).SuspendLayout();
			((Control)panelTextBox).SuspendLayout();
			((Control)panelCombo).SuspendLayout();
			((Control)this).SuspendLayout();
			((Control)panelGauge).Controls.Add((Control)(object)labelUnit);
			((Control)panelGauge).Controls.Add((Control)(object)gaugeAngular);
			((Control)panelGauge).Dock = (DockStyle)1;
			((Control)panelGauge).Location = new Point(0, 0);
			((Control)panelGauge).Name = "panelGauge";
			((Control)panelGauge).Size = new Size(211, 151);
			((Control)panelGauge).TabIndex = 0;
			((Control)labelUnit).BackColor = SystemColors.Control;
			labelUnit.FlatStyle = (FlatStyle)3;
			((Control)labelUnit).Font = new Font("Microsoft Sans Serif", 8.25f, (FontStyle)0, (GraphicsUnit)3, (byte)0);
			((Control)labelUnit).ForeColor = Color.Black;
			((Control)labelUnit).Location = new Point(88, 128);
			((Control)labelUnit).Name = "labelUnit";
			((Control)labelUnit).Size = new Size(39, 12);
			((Control)labelUnit).TabIndex = 1;
			labelUnit.TextAlign = (ContentAlignment)32;
			gaugeAngular.LoadingBegin();
			gaugeAngular.BackColor = SystemColors.Control;
			gaugeAngular.Border.Color = SystemColors.Desktop;
			gaugeAngular.Border.Style = BorderStyleControl.Sunken;
			gaugeAngular.Border.ThicknessDesired = 5;
			colorSection.Color = Color.Lime;
			colorSection.Stop = 90.0;
			colorSection2.Start = 90.0;
			colorSection2.Stop = 100.0;
			gaugeAngular.ColorSections.Add(colorSection);
			gaugeAngular.ColorSections.Add(colorSection2);
			((Control)gaugeAngular).ContextMenu = contextMenuGaugeSetting;
			((Control)gaugeAngular).Dock = (DockStyle)5;
			gaugeAngular.Hub.Size = 5;
			gaugeAngular.InnerRadius = 48;
			((Control)gaugeAngular).Location = new Point(0, 0);
			((Control)gaugeAngular).Name = "gaugeAngular";
			pointerGaugeAngular.Color = Color.OrangeRed;
			pointerGaugeAngular.Size = 3;
			pointerGaugeAngular2.Color = Color.Yellow;
			pointerGaugeAngular2.Style = PointerStyleGaugeAngular.Arrow;
			pointerGaugeAngular2.Visible = false;
			pointerGaugeAngular3.Color = Color.Blue;
			pointerGaugeAngular3.Style = PointerStyleGaugeAngular.Arrow;
			pointerGaugeAngular3.Visible = false;
			gaugeAngular.Pointers.Add(pointerGaugeAngular);
			gaugeAngular.Pointers.Add(pointerGaugeAngular2);
			gaugeAngular.Pointers.Add(pointerGaugeAngular3);
			gaugeAngular.ScaleDisplay.StartRefEnabled = true;
			gaugeAngular.ScaleDisplay.TextAlignment = StringAlignmentAngular.Justified;
			gaugeAngular.ScaleDisplay.TextFormatting.Precision = 0;
			gaugeAngular.ScaleDisplay.TextWidthMinAuto = true;
			gaugeAngular.ScaleRange.AngleMin = 240.0;
			gaugeAngular.ScaleRange.AngleSpan = 300.0;
			gaugeAngular.Size = new Size(211, 151);
			((Control)gaugeAngular).Click += gaugeAngular_Click;
			((Control)gaugeAngular).BackColorChanged += OnGaugeAngularBackColorChanged;
			gaugeAngular.LoadingEnd();
			((Menu)contextMenuGaugeSetting).MenuItems.AddRange((MenuItem[])(object)new MenuItem[3] { menuItemGaugeSetting, menuItemResetMinMax, menuItemShowMinMaxPointers });
			menuItemGaugeSetting.Index = 0;
			menuItemGaugeSetting.Text = "&Setting";
			menuItemGaugeSetting.Click += OnMenuItemGaugeSettingClickEvent;
			menuItemResetMinMax.Enabled = false;
			menuItemResetMinMax.Index = 1;
			menuItemResetMinMax.Text = "&Reset Min/Max Values";
			menuItemResetMinMax.Click += OnMenuItemResetPointerClick;
			menuItemShowMinMaxPointers.Enabled = false;
			menuItemShowMinMaxPointers.Index = 2;
			menuItemShowMinMaxPointers.Text = "Show Min/Max Pointers";
			menuItemShowMinMaxPointers.Click += OnMenuItemShowMinMaxPointersClick;
			panelTextBox.BorderStyle = (BorderStyle)1;
			((Control)panelTextBox).Controls.Add((Control)(object)textBoxMax);
			((Control)panelTextBox).Controls.Add((Control)(object)textBoxCurrent);
			((Control)panelTextBox).Controls.Add((Control)(object)textBoxMin);
			((Control)panelTextBox).Dock = (DockStyle)1;
			((ScrollableControl)panelTextBox).DockPadding.Bottom = 1;
			((ScrollableControl)panelTextBox).DockPadding.Left = 30;
			((ScrollableControl)panelTextBox).DockPadding.Right = 30;
			((ScrollableControl)panelTextBox).DockPadding.Top = 3;
			((Control)panelTextBox).Location = new Point(0, 151);
			((Control)panelTextBox).Name = "panelTextBox";
			((Control)panelTextBox).Size = new Size(211, 30);
			((Control)panelTextBox).TabIndex = 4;
			((TextBoxBase)textBoxMax).HideSelection = false;
			((Control)textBoxMax).ImeMode = (ImeMode)0;
			((Control)textBoxMax).Location = new Point(141, 3);
			((Control)textBoxMax).Name = "textBoxMax";
			((TextBoxBase)textBoxMax).ReadOnly = true;
			((Control)textBoxMax).Size = new Size(59, 20);
			((Control)textBoxMax).TabIndex = 2;
			((Control)textBoxMax).Text = "";
			toolTipUnits.SetToolTip((Control)(object)textBoxMax, "Maximum Value");
			((TextBoxBase)textBoxCurrent).HideSelection = false;
			((Control)textBoxCurrent).Location = new Point(72, 3);
			((Control)textBoxCurrent).Name = "textBoxCurrent";
			((TextBoxBase)textBoxCurrent).ReadOnly = true;
			((Control)textBoxCurrent).Size = new Size(59, 20);
			((Control)textBoxCurrent).TabIndex = 1;
			((Control)textBoxCurrent).Text = "";
			toolTipUnits.SetToolTip((Control)(object)textBoxCurrent, "Current Value");
			((TextBoxBase)textBoxMin).HideSelection = false;
			((Control)textBoxMin).ImeMode = (ImeMode)0;
			((Control)textBoxMin).Location = new Point(6, 3);
			((Control)textBoxMin).Name = "textBoxMin";
			((TextBoxBase)textBoxMin).ReadOnly = true;
			((Control)textBoxMin).Size = new Size(59, 20);
			((Control)textBoxMin).TabIndex = 0;
			((Control)textBoxMin).Text = "";
			toolTipUnits.SetToolTip((Control)(object)textBoxMin, "Minimum Value ");
			panelCombo.BorderStyle = (BorderStyle)1;
			((Control)panelCombo).Controls.Add((Control)(object)parameterTextbox);
			((Control)panelCombo).Controls.Add((Control)(object)comboBoxSA);
			((Control)panelCombo).Dock = (DockStyle)5;
			((ScrollableControl)panelCombo).DockPadding.Left = 10;
			((ScrollableControl)panelCombo).DockPadding.Right = 10;
			((ScrollableControl)panelCombo).DockPadding.Top = 10;
			((Control)panelCombo).Location = new Point(0, 181);
			((Control)panelCombo).Name = "panelCombo";
			((Control)panelCombo).Size = new Size(211, 40);
			((Control)panelCombo).TabIndex = 5;
			((Control)parameterTextbox).Location = new Point(72, 8);
			((Control)parameterTextbox).Name = "parameterTextbox";
			parameterTextbox.ParameterName = "";
			((Control)parameterTextbox).Size = new Size(128, 20);
			((Control)parameterTextbox).TabIndex = 2;
			parameterTextbox.ParameterChangedEvent += OnParameterChanged;
			comboBoxSA.Items.AddRange(new object[1] { "00" });
			((Control)comboBoxSA).Location = new Point(4, 9);
			((Control)comboBoxSA).Name = "comboBoxSA";
			((Control)comboBoxSA).Size = new Size(60, 21);
			((Control)comboBoxSA).TabIndex = 1;
			comboBoxSA.SelectedIndexChanged += comboBoxSA_SelectedIndexChanged;
			toolTipUnits.ShowAlways = true;
			((Control)this).Controls.Add((Control)(object)panelCombo);
			((Control)this).Controls.Add((Control)(object)panelTextBox);
			((Control)this).Controls.Add((Control)(object)panelGauge);
			((Control)this).Name = "GaugeControl";
			((Control)this).Size = new Size(211, 221);
			((Control)this).Click += gaugeAngular_Click;
			((Control)panelGauge).ResumeLayout(false);
			((Control)panelTextBox).ResumeLayout(false);
			((Control)panelCombo).ResumeLayout(false);
			((Control)this).ResumeLayout(false);
		}

		public void RaiseParameterChangedEvent(ActionType action)
		{
			if (this.ParameterChangedEvent != null)
			{
				ResetValues();
				menuItemResetMinMax.Enabled = false;
				menuItemShowMinMaxPointers.Enabled = false;
				ParameterChangedEventArgs e = new ParameterChangedEventArgs(((Control)comboBoxSA).Text, parameterTextbox.ParameterName, action);
				this.ParameterChangedEvent(this, e);
			}
		}

		public void ResetValues()
		{
			NewDataSet.GaugeRow gaugeRow = new NewDataSet.GaugeDataTable().NewGaugeRow();
			((Control)labelUnit).Text = string.Empty;
			ScaleRangeAngular scaleRange = gaugeAngular.ScaleRange;
			double min = (GaugeRow.MinValue = gaugeRow.MinValue);
			scaleRange.Min = min;
			ScaleRangeAngular scaleRange2 = gaugeAngular.ScaleRange;
			double span = (GaugeRow.MaxValue = gaugeRow.MaxValue - gaugeRow.MinValue);
			scaleRange2.Span = span;
			gaugeAngular.ColorSections.Clear();
			ColorSection colorSection = new ColorSection();
			colorSection.Start = gaugeRow.MinValue;
			colorSection.Stop = gaugeRow.RedLinesStart;
			colorSection.Color = Color.Lime;
			gaugeAngular.ColorSections.Add(colorSection);
			colorSection = new ColorSection();
			ColorSection colorSection2 = colorSection;
			double start = (GaugeRow.RedLinesStart = gaugeRow.RedLinesStart);
			colorSection2.Start = start;
			colorSection.Stop = gaugeRow.MaxValue;
			colorSection.Color = Color.Red;
			gaugeAngular.ColorSections.Add(colorSection);
			gaugeAngular.Value = 0.0;
			((Control)textBoxCurrent).Text = string.Empty;
			RestoreMinMaxValues();
			gaugeAngular.Pointers[1].Visible = false;
			gaugeAngular.Pointers[2].Visible = false;
			gaugeAngular.ScaleDisplay.TextFormatting.Precision = 0;
		}

		public void SetSourceAddress(ArrayList sourceAddressList)
		{
			comboBoxSA.Items.Clear();
			foreach (string sourceAddress in sourceAddressList)
			{
				comboBoxSA.Items.Add((object)sourceAddress);
			}
			if (comboBoxSA.Items.Count > 0)
			{
				((ListControl)comboBoxSA).SelectedIndex = 0;
			}
		}

		private void gaugeAngular_Click(object sender, EventArgs e)
		{
			((Control)this).Focus();
		}

		private void comboBoxSA_SelectedIndexChanged(object sender, EventArgs e)
		{
			if (-1 != ((ListControl)comboBoxSA).SelectedIndex && parameterTextbox.ParameterName.Length > 0)
			{
				RaiseParameterChangedEvent(ActionType.SourceAddressChanged);
			}
		}

		private void OnMenuItemGaugeSettingClickEvent(object sender, EventArgs e)
		{
			//IL_000f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0014: Invalid comparison between I4 and Unknown
			GaugeSettings gaugeSettings = new GaugeSettings(GaugeRow);
			if (1 == (int)((Form)gaugeSettings).ShowDialog((IWin32Window)(object)this))
			{
				RefreshGaugeView();
			}
		}

		private void OnParameterChanged(object sender, Cummins.Parameter.ParameterChangedEventArgs e)
		{
			ActionType actionType = ActionType.ParameterAdded;
			if (e.ParameterName.Length == 0)
			{
				actionType = ActionType.ParameterDeleted;
			}
			RaiseParameterChangedEvent(actionType);
			if (ActionType.ParameterDeleted == actionType)
			{
				ResetValues();
			}
		}

		private void OnGaugeAngularBackColorChanged(object sender, EventArgs e)
		{
			gaugeAngular.BackColor = ((Control)labelUnit).BackColor;
		}

		private void OnMenuItemResetPointerClick(object sender, EventArgs e)
		{
			MinimumValue = gaugeAngular.Value;
			MaximumValue = gaugeAngular.Value;
		}

		private void OnMenuItemShowMinMaxPointersClick(object sender, EventArgs e)
		{
			gaugeAngular.Pointers[1].Visible = !gaugeAngular.Pointers[1].Visible;
			gaugeAngular.Pointers[2].Visible = gaugeAngular.Pointers[1].Visible;
			menuItemShowMinMaxPointers.Checked = gaugeAngular.Pointers[1].Visible;
		}

		private void RefreshGaugeView()
		{
			gaugeAngular.ScaleRange.Span = GaugeRow.MaxValue - GaugeRow.MinValue;
			gaugeAngular.ScaleRange.Min = GaugeRow.MinValue;
			gaugeAngular.ColorSections[0].Start = GaugeRow.MinValue;
			if (GaugeRow.RedLineVisible)
			{
				gaugeAngular.ColorSections[1].Visible = true;
				gaugeAngular.ColorSections[0].Stop = GaugeRow.RedLinesStart;
				gaugeAngular.ColorSections[1].Start = GaugeRow.RedLinesStart;
				gaugeAngular.ColorSections[1].Stop = GaugeRow.MaxValue;
			}
			else
			{
				gaugeAngular.ColorSections[0].Stop = GaugeRow.MaxValue;
				gaugeAngular.ColorSections[1].Visible = false;
			}
			int num = 0;
			int num2 = 0;
			int num3 = GaugeRow.MinValue.ToString().IndexOf(".");
			if (-1 != num3)
			{
				num = GaugeRow.MinValue.ToString().Substring(num3, GaugeRow.MinValue.ToString().Length - num3).Length - 1;
			}
			num3 = GaugeRow.MaxValue.ToString().IndexOf(".");
			if (-1 != num3)
			{
				num2 = GaugeRow.MaxValue.ToString().Substring(num3, GaugeRow.MaxValue.ToString().Length - num3).Length - 1;
			}
			int precision = ((num > num2) ? num : num2);
			gaugeAngular.ScaleDisplay.TextFormatting.Precision = precision;
		}

		private void RestoreMinMaxValues()
		{
			minimumValue = double.MaxValue;
			maximumValue = double.MinValue;
			((Control)textBoxMax).Text = string.Empty;
			((Control)textBoxMin).Text = string.Empty;
		}
	}
	internal class GaugeSettings : Form
	{
		private NewDataSet.GaugeRow gaugeConfigurationRow;

		private Label labelMin;

		private Label labelMax;

		private GroupBox groupBox1;

		private Button buttonApply;

		private CheckBox checkBoxRedLines;

		private Label labelStart;

		private TextBox textBoxStartRedLinesValue;

		private TextBox textBoxMinValue;

		private TextBox textBoxMaxValue;

		private Container components;

		public GaugeSettings(NewDataSet.GaugeRow gaugeRow)
		{
			InitializeComponent();
			gaugeConfigurationRow = gaugeRow;
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			((Form)this).Dispose(disposing);
		}

		private void InitializeComponent()
		{
			//IL_0011: Unknown result type (might be due to invalid IL or missing references)
			//IL_001b: Expected O, but got Unknown
			//IL_001c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0026: Expected O, but got Unknown
			//IL_0027: Unknown result type (might be due to invalid IL or missing references)
			//IL_0031: Expected O, but got Unknown
			//IL_0032: Unknown result type (might be due to invalid IL or missing references)
			//IL_003c: Expected O, but got Unknown
			//IL_003d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0047: Expected O, but got Unknown
			//IL_0048: Unknown result type (might be due to invalid IL or missing references)
			//IL_0052: Expected O, but got Unknown
			//IL_0053: Unknown result type (might be due to invalid IL or missing references)
			//IL_005d: Expected O, but got Unknown
			//IL_005e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0068: Expected O, but got Unknown
			//IL_0069: Unknown result type (might be due to invalid IL or missing references)
			//IL_0073: Expected O, but got Unknown
			//IL_058e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0598: Expected O, but got Unknown
			ComponentResourceManager componentResourceManager = new ComponentResourceManager(typeof(GaugeSettings));
			labelMin = new Label();
			labelMax = new Label();
			checkBoxRedLines = new CheckBox();
			labelStart = new Label();
			groupBox1 = new GroupBox();
			textBoxStartRedLinesValue = new TextBox();
			buttonApply = new Button();
			textBoxMinValue = new TextBox();
			textBoxMaxValue = new TextBox();
			((Control)groupBox1).SuspendLayout();
			((Control)this).SuspendLayout();
			((Control)labelMin).Location = new Point(8, 8);
			((Control)labelMin).Name = "labelMin";
			((Control)labelMin).Size = new Size(24, 23);
			((Control)labelMin).TabIndex = 1;
			((Control)labelMin).Text = "&Min";
			((Control)labelMax).Location = new Point(8, 40);
			((Control)labelMax).Name = "labelMax";
			((Control)labelMax).Size = new Size(32, 23);
			((Control)labelMax).TabIndex = 3;
			((Control)labelMax).Text = "Ma&x";
			checkBoxRedLines.Checked = true;
			checkBoxRedLines.CheckState = (CheckState)1;
			((Control)checkBoxRedLines).Location = new Point(16, 16);
			((Control)checkBoxRedLines).Name = "checkBoxRedLines";
			((Control)checkBoxRedLines).Size = new Size(120, 24);
			((Control)checkBoxRedLines).TabIndex = 4;
			((Control)checkBoxRedLines).Text = "&Enable Red Line";
			checkBoxRedLines.CheckedChanged += OncheckBoxRedLinesCheckedChangedEvent;
			((Control)labelStart).Location = new Point(8, 48);
			((Control)labelStart).Name = "labelStart";
			((Control)labelStart).Size = new Size(32, 23);
			((Control)labelStart).TabIndex = 5;
			((Control)labelStart).Text = "Start:";
			((Control)groupBox1).Controls.Add((Control)(object)labelStart);
			((Control)groupBox1).Controls.Add((Control)(object)checkBoxRedLines);
			((Control)groupBox1).Controls.Add((Control)(object)textBoxStartRedLinesValue);
			((Control)groupBox1).Location = new Point(0, 64);
			((Control)groupBox1).Name = "groupBox1";
			((Control)groupBox1).Size = new Size(152, 72);
			((Control)groupBox1).TabIndex = 9;
			groupBox1.TabStop = false;
			((Control)groupBox1).Text = "Red Lines";
			((Control)textBoxStartRedLinesValue).Location = new Point(56, 40);
			((TextBoxBase)textBoxStartRedLinesValue).MaxLength = 15;
			((Control)textBoxStartRedLinesValue).Name = "textBoxStartRedLinesValue";
			((Control)textBoxStartRedLinesValue).Size = new Size(80, 20);
			((Control)textBoxStartRedLinesValue).TabIndex = 13;
			((Control)textBoxStartRedLinesValue).Text = "0.0";
			textBoxStartRedLinesValue.TextAlign = (HorizontalAlignment)1;
			((Control)textBoxStartRedLinesValue).Leave += Validate_TextBox;
			((Control)textBoxStartRedLinesValue).TextChanged += Validate_TextBox;
			((Control)buttonApply).Location = new Point(32, 152);
			((Control)buttonApply).Name = "buttonApply";
			((Control)buttonApply).Size = new Size(80, 24);
			((Control)buttonApply).TabIndex = 10;
			((Control)buttonApply).Text = "&Apply";
			((Control)buttonApply).Click += buttonApply_Click;
			((Control)textBoxMinValue).Location = new Point(56, 8);
			((TextBoxBase)textBoxMinValue).MaxLength = 15;
			((Control)textBoxMinValue).Name = "textBoxMinValue";
			((Control)textBoxMinValue).Size = new Size(80, 20);
			((Control)textBoxMinValue).TabIndex = 11;
			((Control)textBoxMinValue).Text = "0.0";
			textBoxMinValue.TextAlign = (HorizontalAlignment)1;
			((Control)textBoxMinValue).Leave += Validate_TextBox;
			((Control)textBoxMinValue).TextChanged += Validate_TextBox;
			((Control)textBoxMaxValue).Location = new Point(56, 40);
			((TextBoxBase)textBoxMaxValue).MaxLength = 15;
			((Control)textBoxMaxValue).Name = "textBoxMaxValue";
			((Control)textBoxMaxValue).Size = new Size(80, 20);
			((Control)textBoxMaxValue).TabIndex = 12;
			((Control)textBoxMaxValue).Text = "0.0";
			textBoxMaxValue.TextAlign = (HorizontalAlignment)1;
			((Control)textBoxMaxValue).Leave += Validate_TextBox;
			((Control)textBoxMaxValue).TextChanged += Validate_TextBox;
			((Form)this).AcceptButton = (IButtonControl)(object)buttonApply;
			((Form)this).AutoScaleBaseSize = new Size(5, 13);
			((Form)this).ClientSize = new Size(154, 191);
			((Control)this).Controls.Add((Control)(object)textBoxMaxValue);
			((Control)this).Controls.Add((Control)(object)textBoxMinValue);
			((Control)this).Controls.Add((Control)(object)buttonApply);
			((Control)this).Controls.Add((Control)(object)groupBox1);
			((Control)this).Controls.Add((Control)(object)labelMax);
			((Control)this).Controls.Add((Control)(object)labelMin);
			((Form)this).FormBorderStyle = (FormBorderStyle)1;
			((Form)this).Icon = (Icon)componentResourceManager.GetObject("$this.Icon");
			((Form)this).MaximizeBox = false;
			((Form)this).MinimizeBox = false;
			((Control)this).Name = "GaugeSettings";
			((Form)this).ShowInTaskbar = false;
			((Form)this).StartPosition = (FormStartPosition)4;
			((Control)this).Text = "Gauge Settings";
			((Control)this).Leave += Validate_TextBox;
			((Form)this).Load += GaugeSettings_Load;
			((Control)groupBox1).ResumeLayout(false);
			((Control)groupBox1).PerformLayout();
			((Control)this).ResumeLayout(false);
			((Control)this).PerformLayout();
		}

		private void buttonApply_Click(object sender, EventArgs e)
		{
			//IL_00f5: Unknown result type (might be due to invalid IL or missing references)
			//IL_00cf: Unknown result type (might be due to invalid IL or missing references)
			gaugeConfigurationRow.MinValue = double.Parse(((Control)textBoxMinValue).Text);
			gaugeConfigurationRow.MaxValue = double.Parse(((Control)textBoxMaxValue).Text);
			gaugeConfigurationRow.RedLineVisible = checkBoxRedLines.Checked;
			gaugeConfigurationRow.RedLinesStart = double.Parse(((Control)textBoxStartRedLinesValue).Text);
			if (gaugeConfigurationRow.MinValue < gaugeConfigurationRow.MaxValue)
			{
				if (gaugeConfigurationRow.RedLineVisible)
				{
					if (gaugeConfigurationRow.RedLinesStart >= gaugeConfigurationRow.MinValue && gaugeConfigurationRow.RedLinesStart <= gaugeConfigurationRow.MaxValue)
					{
						((Form)this).DialogResult = (DialogResult)1;
						return;
					}
					MessageBox.Show((IWin32Window)(object)this, "Enter the red lines start value in the Min-Max Range", "Gauge Settings");
					((Control)textBoxStartRedLinesValue).Focus();
				}
				else
				{
					((Form)this).DialogResult = (DialogResult)1;
				}
			}
			else
			{
				MessageBox.Show((IWin32Window)(object)this, "Minimum value should be less than Maximum value ", "Gauge Settings");
				((Control)textBoxMaxValue).Focus();
			}
		}

		private void GaugeSettings_Load(object sender, EventArgs e)
		{
			((Control)textBoxMaxValue).Text = gaugeConfigurationRow.MaxValue.ToString();
			((Control)textBoxMinValue).Text = gaugeConfigurationRow.MinValue.ToString();
			checkBoxRedLines.Checked = gaugeConfigurationRow.RedLineVisible;
			((Control)textBoxStartRedLinesValue).Text = gaugeConfigurationRow.RedLinesStart.ToString();
		}

		private void OncheckBoxRedLinesCheckedChangedEvent(object sender, EventArgs e)
		{
			if (checkBoxRedLines.Checked)
			{
				((Control)textBoxStartRedLinesValue).Enabled = true;
			}
			else
			{
				((Control)textBoxStartRedLinesValue).Enabled = false;
			}
		}

		private void Validate_TextBox(object sender, EventArgs e)
		{
			//IL_0026: Unknown result type (might be due to invalid IL or missing references)
			if (sender is TextBox)
			{
				try
				{
					double.Parse(((Control)((sender is TextBox) ? sender : null)).Text);
				}
				catch
				{
					MessageBox.Show("Enter valid value", "Gauge Properties");
					((Control)((sender is TextBox) ? sender : null)).Focus();
				}
			}
		}
	}
	internal delegate void AvailableSourceAddressChangedEventHandler(object sender, AvailableSourceAddressChangedEventArgs args);
	internal delegate void GuageConfigurationRestoreEventHandler(object sender, GuageConfigurationRestoreEventArgs e);
	public class DataUpdate
	{
		public string name;

		public double dataValue;

		public bool found;

		public static DataUpdate Empty => new DataUpdate();

		public bool IsEmpty => string.IsNullOrEmpty(name);

		public DataUpdate()
		{
			found = false;
			name = string.Empty;
			dataValue = 0.0;
		}
	}
}
namespace Cummins.Parameter
{
	public abstract class ParameterController
	{
		public delegate void CellChangedHandler(object sender, DataColumnChangeEventArgs e);

		public delegate void AllCellsUnmodifiedHandler(object sender, EventArgs e);

		protected DataTable dataTable;

		protected DataTable propertiesTable;

		protected DataTable metaDataTable;

		protected bool isDataTableLoaded;

		private IMonitoredModel model;

		private DataFormat displayFormat;

		public virtual DataTable MetaDataTable
		{
			get
			{
				if (metaDataTable == null)
				{
					try
					{
						InitializeMetaDataTable();
					}
					catch (Exception ex)
					{
						throw ex;
					}
				}
				return metaDataTable;
			}
		}

		public bool DataTableLoaded => isDataTableLoaded;

		public abstract DataTable Data { get; }

		public abstract DataTable Properties { get; }

		public DataFormat DisplayFormat
		{
			get
			{
				return displayFormat;
			}
			set
			{
				displayFormat = value;
			}
		}

		public string Name => model.Name;

		public virtual string Comment => model.Comment;

		public abstract int PropertiesTablePropertyColumnChars { get; set; }

		public abstract int PropertiesTableValueColumnChars { get; set; }

		public event CellChangedHandler CellChangedEvent;

		public event EventHandler DataLoadedEvent;

		public event EventHandler RowRemovedEvent;

		public event AllCellsUnmodifiedHandler AllCellsUnmodifiedEvent;

		private void InitializeMetaDataTable()
		{
			try
			{
				metaDataTable = new DataTable();
				dataTable.TableName = "MetaDataTable";
				CreateMetaDataColumns();
				LoadMetaDataTable();
			}
			catch (Exception)
			{
			}
		}

		protected virtual void CreateMetaDataColumns()
		{
			DataColumn column = MakeDataColumn("Addr", "SourceAddress", Type.GetType("System.String"), isReadOnly: false, isUnique: false);
			metaDataTable.Columns.Add(column);
			column = MakeDataColumn("Name", "Name", Type.GetType("System.String"), isReadOnly: false, isUnique: false);
			metaDataTable.Columns.Add(column);
			column = MakeDataColumn("Unit", "Unit", Type.GetType("System.String"), isReadOnly: false, isUnique: false);
			metaDataTable.Columns.Add(column);
		}

		protected virtual void LoadMetaDataTable()
		{
			DataRow dataRow = metaDataTable.NewRow();
			dataRow["SourceAddress"] = model.DataSource.SourceAddress.Value;
			dataRow["Name"] = model.Name;
			try
			{
				dataRow["Unit"] = model.EngineeringUnits;
			}
			catch
			{
				dataRow["Unit"] = string.Empty;
			}
			metaDataTable.Rows.Add(dataRow);
			metaDataTable.AcceptChanges();
		}

		protected ParameterController(IMonitoredModel paramModel)
		{
			model = paramModel;
			DisplayFormat = DataFormat.Decimal;
		}

		public abstract void Undo();

		public abstract void Revert();

		public abstract void Save();

		public virtual void Reload()
		{
		}

		public abstract void DataMode(DataFormat displayFormat);

		protected DataColumn MakeDataColumn(string caption, string columnName, Type columnType, bool isReadOnly, bool isUnique)
		{
			DataColumn dataColumn = new DataColumn();
			try
			{
				dataColumn.Caption = caption;
				dataColumn.ColumnName = columnName;
				dataColumn.DataType = columnType;
				dataColumn.ReadOnly = isReadOnly;
				dataColumn.Unique = isUnique;
				return dataColumn;
			}
			catch (Exception ex)
			{
				throw ex;
			}
		}

		protected void CreatePropertyColumns(DataTable dataTable)
		{
			DataColumn column = MakeDataColumn("Property", "Property", Type.GetType("System.String"), isReadOnly: true, isUnique: false);
			dataTable.Columns.Add(column);
			column = MakeDataColumn(model.Name, "Value", Type.GetType("System.String"), isReadOnly: true, isUnique: false);
			dataTable.Columns.Add(column);
		}

		public void RaiseAllCellsUnmodifiedEvent()
		{
			if (this.AllCellsUnmodifiedEvent != null)
			{
				this.AllCellsUnmodifiedEvent(this, new EventArgs());
			}
		}

		protected void RaiseDataLoadedEvent()
		{
			if (this.DataLoadedEvent != null)
			{
				this.DataLoadedEvent(this, EventArgs.Empty);
			}
		}

		protected void RaiseCellChanged(object sender, DataColumnChangeEventArgs e)
		{
			if (this.CellChangedEvent != null)
			{
				this.CellChangedEvent(this, e);
			}
		}

		protected void RaiseRowRemoved()
		{
			if (this.RowRemovedEvent != null)
			{
				this.RowRemovedEvent(this, new EventArgs());
			}
		}

		private double GetDoubleValueByFormat(string proposedValue)
		{
			double num = 0.0;
			if (DisplayFormat == DataFormat.Hex)
			{
				return double.Parse(proposedValue, NumberStyles.AllowHexSpecifier);
			}
			return double.Parse(proposedValue, NumberStyles.Any);
		}

		protected void DisplayBoundMessage(string proposedValue, string actualValue, double lowerBound, double upperBound, string parameterName)
		{
			try
			{
				if (RangeLimitProvider.CurrentRangeLimit == RangeLimit.Clip)
				{
					if (proposedValue != actualValue)
					{
						double doubleValueByFormat = GetDoubleValueByFormat(proposedValue);
						if (doubleValueByFormat < lowerBound || doubleValueByFormat > upperBound)
						{
							EventLogger.Warn("Value Edit", parameterName + " proposed value = " + proposedValue + " is clipped to value = " + actualValue);
						}
					}
				}
				else if (RangeLimitProvider.CurrentRangeLimit == RangeLimit.Ignore)
				{
					double doubleValueByFormat2 = GetDoubleValueByFormat(actualValue);
					if (doubleValueByFormat2 < lowerBound || doubleValueByFormat2 > upperBound)
					{
						EventLogger.Warn("Value Edit", parameterName + " exceeded its engineering range limits. Lower limit = " + lowerBound + " Upper limit = " + upperBound);
					}
				}
			}
			catch
			{
			}
		}
	}
	public class GroupController : ParameterController
	{
		private const int DataTypeEnumeration = 4;

		private const int DataTypeDateTime = 5;

		private const int DataTypeString = 14;

		private const string DataPlateGroupFullName = "DataStructures.DataplateStructure";

		private MonitoredGroupModel model;

		private int propertiesTablePropertyColumnChars;

		private int propertiesTableValueColumnChars;

		private int previousRowIndex;

		private string previousValue;

		private bool currentlyEditing;

		private bool IscopyPasteOperation;

		private bool IsupDownOperation;

		private object disableChangeEventsLock = new object();

		private uint disableChangeEventsCount = 1u;

		public override DataTable Data
		{
			get
			{
				if (dataTable == null)
				{
					try
					{
						InitializeDataTable();
					}
					catch (Exception ex)
					{
						throw ex;
					}
				}
				return dataTable;
			}
		}

		public override DataTable Properties
		{
			get
			{
				if (propertiesTable == null)
				{
					try
					{
						InitializePropertiesTable();
					}
					catch (Exception ex)
					{
						throw ex;
					}
				}
				return propertiesTable;
			}
		}

		public int Count => model.Members.Count;

		public MonitoredGroupModel Model => model;

		public bool EnableChangeEvents
		{
			get
			{
				lock (disableChangeEventsLock)
				{
					return disableChangeEventsCount == 0;
				}
			}
			set
			{
				lock (disableChangeEventsLock)
				{
					bool flag = false;
					if (value)
					{
						if (disableChangeEventsCount != 0)
						{
							disableChangeEventsCount--;
							if (disableChangeEventsCount == 0)
							{
								flag = true;
							}
						}
					}
					else
					{
						disableChangeEventsCount++;
						if (disableChangeEventsCount == 1)
						{
							flag = true;
						}
					}
					if (flag)
					{
						if (disableChangeEventsCount == 0)
						{
							Data.ColumnChanging += OnColumnChanging;
						}
						else
						{
							Data.ColumnChanging -= OnColumnChanging;
						}
					}
				}
			}
		}

		public override int PropertiesTablePropertyColumnChars
		{
			get
			{
				return propertiesTablePropertyColumnChars;
			}
			set
			{
				if (value > propertiesTablePropertyColumnChars)
				{
					propertiesTablePropertyColumnChars = value;
				}
			}
		}

		public override int PropertiesTableValueColumnChars
		{
			get
			{
				return propertiesTableValueColumnChars;
			}
			set
			{
				if (value > propertiesTableValueColumnChars)
				{
					propertiesTableValueColumnChars = value;
				}
			}
		}

		public int DataTableNameColumnChars
		{
			get
			{
				return Model.DataTableNameColumnChars;
			}
			set
			{
				Model.DataTableNameColumnChars = value;
			}
		}

		public int DataTableValueColumnChars
		{
			get
			{
				return Model.DataTableValueColumnChars;
			}
			set
			{
				Model.DataTableValueColumnChars = value;
			}
		}

		public int DataTableUnitColumnChars
		{
			get
			{
				return Model.DataTableUnitColumnChars;
			}
			set
			{
				Model.DataTableUnitColumnChars = value;
			}
		}

		public int DataTableCommentColumnChars
		{
			get
			{
				return Model.DataTableNameColumnChars;
			}
			set
			{
				Model.DataTableNameColumnChars = value;
			}
		}

		public bool IsCopyPasteOperation
		{
			get
			{
				return IscopyPasteOperation;
			}
			set
			{
				IscopyPasteOperation = value;
			}
		}

		public bool IsUpDownOperation
		{
			get
			{
				return IsupDownOperation;
			}
			set
			{
				IsupDownOperation = value;
			}
		}

		protected bool CurrentlyEditing
		{
			get
			{
				return currentlyEditing;
			}
			set
			{
				currentlyEditing = value;
			}
		}

		public bool IsReadOnlyParameter(string parameterName)
		{
			bool result = false;
			switch (parameterName)
			{
			case "security_key":
			case "secret":
			case "sec_key":
				result = true;
				break;
			}
			return result;
		}

		public GroupController(MonitoredGroupModel groupModel)
			: base(groupModel)
		{
			model = groupModel;
			previousRowIndex = -1;
			previousValue = "";
		}

		public override void Undo()
		{
			try
			{
				DataRow dataRow = dataTable.Rows[previousRowIndex];
				dataRow["Value"] = previousValue;
			}
			catch
			{
			}
		}

		public override void Reload()
		{
			if (isDataTableLoaded)
			{
				return;
			}
			try
			{
				EnableChangeEvents = false;
				if (dataTable != null)
				{
					dataTable.Rows.Clear();
					LoadDataTable();
				}
				else
				{
					InitializeDataTable();
				}
			}
			finally
			{
				EnableChangeEvents = true;
			}
		}

		public virtual int GetMemberIndex(string paramName)
		{
			DataRow[] array = Data.Select("Name = '" + paramName + "'");
			if (array.Length > 0)
			{
				return (int)array[0]["Index"];
			}
			return -1;
		}

		public virtual IParameterModel GetMemberParameter(int index)
		{
			IParameterModel parameterModel = null;
			DataRow[] array = Data.Select("Index = '" + index + "'");
			if (array.Length > 0)
			{
				return GetMemberParameter(array[0]);
			}
			return null;
		}

		public virtual IParameterModel GetMemberParameter(DataRow row)
		{
			IParameterModel parameterModel = null;
			if (row != null)
			{
				string parameterName = (string)row["Name"];
				return GetMemberParameter(parameterName);
			}
			return null;
		}

		public IParameterModel GetMemberParameter(string parameterName)
		{
			return model.Members[parameterName] as IParameterModel;
		}

		public override void Revert()
		{
			try
			{
				foreach (DataRow row in Data.Rows)
				{
					try
					{
						IValueModel valueModel = (IValueModel)GetMemberParameter(row);
						if (valueModel.IsDirty)
						{
							valueModel.Revert();
							row["Value"] = GetValueByDataFormat(valueModel);
						}
					}
					catch (Exception)
					{
					}
				}
				Model.ParameterModel.IsDirty = false;
				RaiseAllCellsUnmodifiedEvent();
			}
			catch (Exception ex2)
			{
				throw ex2;
			}
		}

		public override void Save()
		{
			model.ParameterModel.Save();
			dataTable.AcceptChanges();
		}

		public string GetValueByDataFormat(IValueModel model)
		{
			string empty = string.Empty;
			return base.DisplayFormat switch
			{
				DataFormat.Binary => model.BinaryValue(), 
				DataFormat.Decimal => model.ScaledValue, 
				DataFormat.Hex => model.HexValue(), 
				_ => throw new DipsplayFormatNotSupportedException(base.DisplayFormat), 
			};
		}

		public void SetValueByDataFormat(IValueModel model, string proposedValue)
		{
			switch (base.DisplayFormat)
			{
			case DataFormat.Binary:
				model.BinaryValue(proposedValue);
				break;
			case DataFormat.Decimal:
				if (model.DataSource is ICalibrationASAM)
				{
					try
					{
						ICalibrationASAM calibrationASAM = (ICalibrationASAM)model.DataSource;
						double num = 0.0;
						num = double.Parse(proposedValue);
						calibrationASAM.ASAM3RemoteDevice.WriteParameter(model.Name, num);
						break;
					}
					catch
					{
						EventLogger.Info("Setting Parameter", "Setting Value for " + model.Name + " has failed");
						break;
					}
				}
				if (model.DataSource.Secured != SecurityStatus.Secured)
				{
					model.ScaledValue = proposedValue;
					break;
				}
				if (IsWriteAllowed())
				{
					model.ScaledValue = proposedValue;
					break;
				}
				Trace.WriteLine("Module is Secured..");
				throw new Exception("Module is Secured. Cannot modify parameter value of Secured module.");
			case DataFormat.Hex:
				model.HexValue(proposedValue);
				break;
			default:
				throw new DipsplayFormatNotSupportedException(base.DisplayFormat);
			}
		}

		public override void DataMode(DataFormat displayFormat)
		{
			if (base.DisplayFormat == displayFormat)
			{
				return;
			}
			base.DisplayFormat = displayFormat;
			try
			{
				dataTable.Rows.Clear();
				EnableChangeEvents = false;
				try
				{
					LoadDataTable();
				}
				finally
				{
					EnableChangeEvents = true;
				}
			}
			catch (Exception)
			{
			}
		}

		private void InitializeDataTable()
		{
			try
			{
				dataTable = new DataTable();
				dataTable.TableName = "DataTable";
				CreateDataColumns();
				LoadDataTable();
			}
			catch (Exception ex)
			{
				throw ex;
			}
		}

		private void InitializePropertiesTable()
		{
			try
			{
				propertiesTable = new DataTable();
				propertiesTable.TableName = "PropertiesTable";
				CreatePropertyColumns(propertiesTable);
				LoadPropertiesTable();
			}
			catch (Exception ex)
			{
				throw ex;
			}
		}

		protected virtual void CreateDataColumns()
		{
			DataColumn column = MakeDataColumn("Name", "Name", Type.GetType("System.String"), isReadOnly: true, isUnique: true);
			dataTable.Columns.Add(column);
			column = MakeDataColumn("Value", "Value", Type.GetType("System.String"), isReadOnly: false, isUnique: false);
			dataTable.Columns.Add(column);
			column = MakeDataColumn("Unit", "Unit", Type.GetType("System.String"), isReadOnly: true, isUnique: false);
			dataTable.Columns.Add(column);
			column = MakeDataColumn("Comment", "Comment", Type.GetType("System.String"), isReadOnly: true, isUnique: false);
			dataTable.Columns.Add(column);
			column = MakeDataColumn("", "Index", Type.GetType("System.Int32"), isReadOnly: false, isUnique: true);
			column.ColumnMapping = MappingType.Hidden;
			dataTable.Columns.Add(column);
			column = MakeDataColumn("", "LastUpdateTime", Type.GetType("System.DateTime"), isReadOnly: false, isUnique: false);
			column.ColumnMapping = MappingType.Hidden;
			dataTable.Columns.Add(column);
			column = MakeDataColumn("", "IsBroadcast", Type.GetType("System.Boolean"), isReadOnly: false, isUnique: false);
			column.ColumnMapping = MappingType.Hidden;
			dataTable.Columns.Add(column);
		}

		private void LoadDataTable()
		{
			try
			{
				int num = 0;
				int num2 = 0;
				bool flag = true;
				foreach (IParameterModel value in Model.Members.Values)
				{
					if (value.DataType != ParameterType.Value && value.DataType != ParameterType.Enumeration)
					{
						continue;
					}
					IValueModel valueModel = (IValueModel)value;
					if (valueModel.DataSource.Connected)
					{
						if (Model.DataSource is CalibrationDisk && !valueModel.AvailableOffline && valueModel.FullName.IndexOf("DataStructures.DataplateStructure") < 0)
						{
							continue;
						}
						DataRow dataRow = dataTable.NewRow();
						dataRow["Name"] = valueModel.Name;
						Model.DataTableNameColumnChars = dataRow["Name"].ToString().Length;
						try
						{
							dataRow["Value"] = GetValueByDataFormat(valueModel);
							int length = dataRow["Value"].ToString().Length;
							if (num2 < length)
							{
								num2 = length;
							}
						}
						catch (Exception)
						{
						}
						try
						{
							dataRow["Unit"] = valueModel.EngineeringUnits;
							Model.DataTableUnitColumnChars = dataRow["Unit"].ToString().Length;
						}
						catch (Exception)
						{
						}
						try
						{
							dataRow["Comment"] = valueModel.Comment;
							Model.DataTableCommentColumnChars = dataRow["Comment"].ToString().Length;
						}
						catch (Exception)
						{
						}
						dataRow["Index"] = num++;
						dataTable.Rows.Add(dataRow);
					}
					else
					{
						flag = false;
					}
				}
				Model.DataTableValueColumnChars = num2;
				dataTable.AcceptChanges();
				isDataTableLoaded = flag;
				if (flag)
				{
					RaiseDataLoadedEvent();
				}
			}
			catch (Exception ex4)
			{
				throw ex4;
			}
		}

		private void LoadPropertiesTable()
		{
			try
			{
				try
				{
					AddToPropertiesTable("Full Name", model.ParameterModel.FullName);
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Comment", model.Comment);
				}
				catch
				{
				}
			}
			catch (Exception ex)
			{
				throw ex;
			}
		}

		private void AddToPropertiesTable(string propertyName, string propertyValue)
		{
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = propertyName;
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = propertyValue;
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
		}

		private void AddToPropertiesTable(string propertyName, long propertyValue, string format)
		{
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = propertyName;
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = propertyValue.ToString(format);
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
		}

		protected virtual void OnColumnChanging(object sender, DataColumnChangeEventArgs e)
		{
			if (!IscopyPasteOperation)
			{
				if (!(e.Column.ColumnName == "Value"))
				{
					return;
				}
				IValueModel valueModel = (IValueModel)GetMemberParameter(e.Row);
				try
				{
					if (!(e.Row["Value"].ToString() != e.ProposedValue.ToString()))
					{
						return;
					}
					string parameterName = e.Row[1].ToString().ToLower();
					if (!IsReadOnlyParameter(parameterName))
					{
						previousValue = e.Row["Value"].ToString();
						if (!IsUpDownOperation)
						{
							SetValueByDataFormat(valueModel, e.ProposedValue.ToString());
						}
						string valueByDataFormat = GetValueByDataFormat(valueModel);
						try
						{
							DisplayBoundMessage(e.ProposedValue.ToString(), valueByDataFormat, valueModel.LowerBound, valueModel.UpperBound, valueModel.Name);
						}
						catch
						{
						}
						e.ProposedValue = valueByDataFormat;
						Model.DataTableValueColumnChars = e.ProposedValue.ToString().Length;
						if (e.Row["Index"] != DBNull.Value)
						{
							previousRowIndex = (int)e.Row["Index"];
						}
						RaiseCellChanged(sender, e);
						Model.IsDirty = true;
					}
					else
					{
						EventLogger.Error("Calibration Edit", "The license does not support editing " + e.Row[1].ToString() + ". The value can only be monitored");
					}
					return;
				}
				catch (ParameterReadOnlyException ex)
				{
					EventLogger.Error("Calibration Edit", "Parameter " + ex.ParameterName + " is read only.", ex);
					e.Row.CancelEdit();
					throw ex;
				}
				catch (Exception ex2)
				{
					EventLogger.Error("Value Edit", ex2.Message, ex2.InnerException);
					e.Row.CancelEdit();
					e.ProposedValue = previousValue;
					throw ex2;
				}
			}
			_ = e.Column.ColumnName == "Unit";
		}

		private bool IsWriteAllowed()
		{
			bool result = false;
			try
			{
				ISecurityService securityService = (ISecurityService)ServiceManager.Services.GetService(typeof(ISecurityService));
				if (securityService != null && securityService.ToolFamily == ToolFamily.FieldEngineering)
				{
					if (!securityService.IsFeatureSelected(Cummins.CalToolsLib.SelectableFeatures.TemporaryWritestoSecureModules.ToString()))
					{
						EventLogger.Error("Calibration Edit", "The license does not support editing. The parameter value can only be monitored");
						result = false;
					}
					else
					{
						result = true;
					}
				}
			}
			catch
			{
			}
			return result;
		}
	}
}
namespace Cummins.Editor
{
	public class MonitoredGroupController : GroupController
	{
		private delegate void ReconcileDelegate(IAddressValue deviceAddress);

		protected const string NamedMonitorFilterFormat = "FullName = '{0}' AND SourceAddress = '{1}'";

		protected const string AddressFilterFormat = "SourceAddress = '{0}'";

		protected const string NamedMonitorFilterFormatForASAM = "Name = '{0}' AND SourceAddress = '{1}'";

		protected const string NamedMonitorFilterFormatForDisk = "FullName = '{0}'";

		protected const string NamedMonitorFilterFormatForJ1939_71 = "FullName = '{0}' AND SourceAddress = '{1}'";

		protected const string AddressedMonitorFilterFormat = "Address = '{0}' AND Offset = '{1}' AND Length = '{2}' AND SourceAddress = '{3}'";

		private const int MinimumRows = 8;

		private const string Subfile3ParameterError = "Contact your product System Integrator to have this parameter moved from the Code group and/or Subfile 3 if you need access.";

		private const string FilterConfigHeaderParameterString = "ConfigHeaders.";

		internal const string Array1DElementFormat = "{0}[0]";

		internal const string Array2DElementFormat = "{0}[0:0]";

		private MonitoredGroupModel model;

		private IAddressValue currentSourceAddress;

		private EditorState currentState;

		private bool isMonitoring = true;

		protected Mutex groupMutex = new Mutex();

		private int previousRowIndex;

		private string previousValue;

		public bool ShowComments
		{
			get
			{
				return MonitoredModel.ShowComments;
			}
			set
			{
				if (value)
				{
					Data.Columns["Comment"].ColumnMapping = MappingType.Element;
				}
				else
				{
					Data.Columns["Comment"].ColumnMapping = MappingType.Hidden;
				}
				MonitoredModel.ShowComments = value;
			}
		}

		public bool ValueEnabled
		{
			get
			{
				return MonitoredModel.ValueEnabled;
			}
			set
			{
				MonitoredModel.ValueEnabled = value;
			}
		}

		public EditorState EditorState
		{
			get
			{
				return currentState;
			}
			set
			{
				if ((currentState != EditorState.Editing || value == EditorState.EditOver) && currentState != value)
				{
					if (value == EditorState.EditOver)
					{
						currentState = EditorState.Idle;
					}
					else
					{
						currentState = value;
					}
				}
			}
		}

		public DataFormat Radix
		{
			get
			{
				return MonitoredModel.Radix;
			}
			set
			{
				base.DisplayFormat = value;
				MonitoredModel.Radix = value;
			}
		}

		public IAddressValue CurrentSourceAddress
		{
			get
			{
				return currentSourceAddress;
			}
			set
			{
				currentSourceAddress = value;
			}
		}

		public ArrayList IDLParametersList
		{
			get
			{
				ArrayList arrayList = new ArrayList();
				lock (Data)
				{
					DataRow[] array = Data.Select("Name <> ' ' AND SourceAddress <> ' '");
					DataRow[] array2 = array;
					foreach (DataRow dataRow in array2)
					{
						IAddressValue addressValue = AddressFactory.ProductAddressValue(dataRow["SourceAddress"].ToString());
						if (!addressValue.DisplayId.Contains("R0"))
						{
							arrayList.Add(new LogParameters
							{
								parameterName = dataRow["Name"].ToString(),
								sourceAddess = addressValue
							});
						}
					}
					return arrayList;
				}
			}
		}

		public SortedList Calibrations
		{
			get
			{
				return model.Calibrations;
			}
			set
			{
				model.Calibrations = value;
				for (int i = 0; i < model.Calibrations.Count; i++)
				{
					ICalibration calibration = (ICalibration)model.Calibrations.GetByIndex(i);
					calibration.SaveChangesEvent += OnSaveChangesEvent;
					if (calibration is ICalibrationECM)
					{
						(calibration as ICalibrationECM).RunLocationChanged += OnRunLocationChanged;
					}
					if (calibration is ICalibrationDisk)
					{
						(calibration as ICalibrationDisk).FileSaveAsEvent += OnFileSaveAsEvent;
					}
				}
				UpdateColumns();
				RaiseCalibrationListChanged();
			}
		}

		public MonitoredGroupModel MonitoredModel => model;

		public virtual bool IsMonitoring
		{
			get
			{
				return isMonitoring;
			}
			set
			{
				isMonitoring = value;
			}
		}

		public event EventHandler MultipleParametersAdded;

		public event EventHandler CalibrationListChanged;

		public event EventHandler RefreshStart;

		public event EventHandler RefreshOver;

		public event EventHandler UpdateSourceAddressColumnEvent;

		public event MonitoredElementAddingEventHandler MonitoredElementAddingEvent;

		public MonitoredGroupController(MonitoredGroupModel model)
			: base(model)
		{
			this.model = model;
			this.model.RadixChanged += OnRadixChanged;
			Data.RowDeleting += OnRowDeleting;
			Data.RowDeleted += OnRowDeleted;
			base.EnableChangeEvents = true;
		}

		public virtual void CleanupResources()
		{
			base.EnableChangeEvents = false;
			Data.RowDeleting -= OnRowDeleting;
			Data.RowDeleted -= OnRowDeleted;
			for (int i = 0; i < model.Calibrations.Count; i++)
			{
				ICalibration calibration = (ICalibration)model.Calibrations.GetByIndex(i);
				calibration.SaveChangesEvent -= OnSaveChangesEvent;
				if (calibration is ICalibrationECM)
				{
					(calibration as ICalibrationECM).RunLocationChanged -= OnRunLocationChanged;
				}
			}
			MonitoredModel.RemoveAll();
			Data.Clear();
		}

		public virtual void Restore(NewDataSet.GroupRow groupRow)
		{
			StringBuilder stringBuilder = new StringBuilder();
			string text = "";
			IAddressValue sourceAddress = null;
			MonitoredModel.Restore(groupRow);
			stringBuilder.Append("Group_Id = '");
			stringBuilder.Append(groupRow["Group_Id"]);
			stringBuilder.Append("' and Name <> ''");
			bool flag = false;
			int count = Data.Rows.Count;
			try
			{
				base.EnableChangeEvents = false;
				DataRow[] array = groupRow.Table.DataSet.Tables["Parameter"].Select(stringBuilder.ToString());
				for (int i = 0; i < array.Length; i++)
				{
					DataRow row;
					if (i < count)
					{
						row = Data.Rows[i];
						flag = false;
					}
					else
					{
						row = Data.NewRow();
						flag = true;
					}
					DataRow dataRow = array[i];
					try
					{
						if (dataRow["Name"] == DBNull.Value || dataRow["Name"].ToString().Length <= 0)
						{
							continue;
						}
						text = (string)dataRow["Name"];
						sourceAddress = AddressFactory.ProductAddressValue(dataRow["SourceAddress"].ToString());
						if (!(bool)dataRow["IsBroadcast"] && !Calibrations.Contains(sourceAddress))
						{
							sourceAddress = CurrentSourceAddress;
						}
						if (!ValidateAndAddToTable(row, text, ref sourceAddress, (bool)dataRow["IsBroadcast"]))
						{
							continue;
						}
						try
						{
							if (flag)
							{
								Data.Rows.Add(row);
							}
						}
						catch
						{
							EventLogger.Warn("Editor", "Failed to add to screen: " + sourceAddress.Value + ":" + text + " - Device Address " + sourceAddress);
						}
					}
					catch (AddressException ex)
					{
						string text2 = "";
						if (dataRow["SourceAddress"] != null)
						{
							text2 = "Source Address: " + dataRow["SourceAddress"].ToString();
						}
						text2 = text2 + " Failed to add to screen: " + text;
						EventLogger.Warn("Editor", text2, ex.Message);
					}
					catch
					{
						EventLogger.Warn("Editor", "Failed to add to screen: " + sourceAddress.Value + ":" + text + " - Device Address " + sourceAddress);
					}
				}
				Data.AcceptChanges();
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
			MonitoredModel.IsChanged = false;
			BuildSomeRows();
		}

		public void BuildExtraRows(int rowsToPad)
		{
			try
			{
				for (int i = 0; i < rowsToPad; i++)
				{
					Data.Rows.Add(Data.NewRow());
				}
			}
			catch
			{
			}
		}

		public void BuildSomeRows()
		{
			int num = 8 - Data.Rows.Count;
			try
			{
				for (int i = 0; i < num; i++)
				{
					Data.Rows.Add(Data.NewRow());
				}
			}
			catch
			{
			}
		}

		public virtual void SaveSession(NewDataSet.ScreenRow screenRow)
		{
			ScreenDataSaver screenDataSaver = new ScreenDataSaver();
			NewDataSet.GroupRow groupRow = screenDataSaver.SaveSession(screenRow);
			model.SaveSession(groupRow);
			((NewDataSet)screenRow.Table.DataSet).Group.AddGroupRow(groupRow);
			screenDataSaver.PopulateParameterTableRows(groupRow, Data);
			MonitoredModel.IsChanged = false;
		}

		public void AddInsertedRow(IAddressValue sourceAddress, int currentRowIndex)
		{
			DataRow dataRow = null;
			int count = Data.Rows.Count;
			for (int num = count; num > currentRowIndex; num--)
			{
				try
				{
					dataRow = Data.Select("Order =" + num)[0];
					dataRow["Order"] = (int)dataRow["Order"] + 1;
				}
				catch (IndexOutOfRangeException)
				{
					dataRow = Data.NewRow();
					Data.Rows.InsertAt(dataRow, Data.Rows.Count - 1);
					dataRow["Order"] = (int)dataRow["Order"] + 1;
				}
				catch
				{
				}
			}
		}

		public void Add(StringCollection parameters, IAddressValue sourceAddress, int currentRowIndex, bool isBroadcast)
		{
			DataRow dataRow = null;
			bool flag = false;
			_ = Data.Rows.Count;
			try
			{
				base.EnableChangeEvents = false;
				string text = string.Empty;
				IAddressValue sourceAddress2 = CurrentSourceAddress;
				bool isBroadcast2 = false;
				groupMutex.WaitOne();
				EditorState = EditorState.Editing;
				for (int i = 0; i < parameters.Count; i++)
				{
					if (dataRow == null)
					{
						try
						{
							dataRow = Data.Select("Order =" + currentRowIndex)[0];
						}
						catch
						{
						}
						if (dataRow != null)
						{
							flag = false;
							try
							{
								text = dataRow["Name"].ToString();
								isBroadcast2 = (bool)dataRow["IsBroadcast"];
								sourceAddress2 = AddressFactory.ProductAddressValue(dataRow["SourceAddress"].ToString());
							}
							catch
							{
							}
						}
						else
						{
							dataRow = Data.NewRow();
							flag = true;
						}
					}
					else
					{
						text = string.Empty;
					}
					string text2 = parameters[i];
					try
					{
						if (!ValidateAndAddToTable(dataRow, text2, ref sourceAddress, isBroadcast))
						{
							continue;
						}
						currentRowIndex++;
						try
						{
							if (text.Length != 0)
							{
								MonitoredModel.Remove((int)dataRow["Order"], text, sourceAddress2, isBroadcast2);
							}
						}
						catch
						{
						}
						try
						{
							dataRow["Connected"] = false;
							if (flag)
							{
								Data.Rows.Add(dataRow);
							}
							dataRow = null;
						}
						catch
						{
							EventLogger.Warn("Editor", "Failed to add to screen: " + sourceAddress.Value + ":" + text2 + " - Device Address " + sourceAddress);
						}
					}
					catch
					{
						EventLogger.Warn("Editor", "Failed to add to screen: " + sourceAddress.Value + ":" + text2 + " - Device Address " + sourceAddress);
					}
				}
				RaiseMultipleParametersAdded();
				EditorState = EditorState.EditOver;
				groupMutex.ReleaseMutex();
				MonitoredModel.AddPending = true;
				ReconcileDelegate reconcileDelegate = Reconcile;
				reconcileDelegate.BeginInvoke(sourceAddress, null, null);
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
		}

		public virtual bool Add(DataRow row, string name, IAddressValue sourceAddress, bool isBroadcast)
		{
			ICalibration calibration = null;
			IParameterModel parameterModel = null;
			bool result = false;
			groupMutex.WaitOne();
			EditorState = EditorState.Editing;
			try
			{
				if (sourceAddress == null)
				{
					sourceAddress = CurrentSourceAddress;
				}
				IParameterSpecification specification = GetSpecification(sourceAddress, name, ref calibration);
				if (ValidateAndAddToTable(row, name, ref sourceAddress, isBroadcast))
				{
					result = true;
					parameterModel = Connect(row);
					if (parameterModel != null)
					{
						if (calibration.Connected)
						{
							if (!IsArrayElementWithZeroAddress(calibration, specification, parameterModel))
							{
								if (!MonitoredModel.Members.Contains(string.Concat(row["Order"], ":", sourceAddress.Value, ":", specification.Name)))
								{
									MonitoredModel.Add((int)row["Order"], specification.Name, sourceAddress, parameterModel, isBroadcast);
								}
							}
							else
							{
								EventLogger.Info("AddParameter", "Cannot monitor " + name + " at " + sourceAddress.Value + " because address is 0.");
							}
							row["Connected"] = true;
						}
						else
						{
							base.Model.AddPending = true;
							EventLogger.Log("AddParameter", "Cannot monitor " + name + " at " + sourceAddress.Value);
							row["Connected"] = false;
						}
					}
				}
			}
			catch (Exception e)
			{
				EventLogger.Error("AddParameter", "Invalid Parameter or Address: " + name + " from Device Address " + sourceAddress, e);
				result = false;
			}
			EditorState = EditorState.EditOver;
			groupMutex.ReleaseMutex();
			MonitoredModel.AddPending = true;
			ReconcileDelegate reconcileDelegate = Reconcile;
			reconcileDelegate.BeginInvoke(sourceAddress, null, null);
			return result;
		}

		public string AppendQualifier(string parameterName)
		{
			ICalibration calibration = null;
			IParameterSpecification specification = GetSpecification(CurrentSourceAddress, parameterName, ref calibration);
			IParameterModel parameterModel = calibration.Get(specification.Name);
			if (parameterModel != null)
			{
				if (parameterModel.DataType == ParameterType.Array1D || parameterModel.DataType == ParameterType.ArrayXAxis || parameterModel.DataType == ParameterType.ArrayXY)
				{
					parameterName = $"{parameterName.Trim()}[0]";
				}
				else if (parameterModel.DataType == ParameterType.ArrayXYZ || parameterModel.DataType == ParameterType.Array2D)
				{
					parameterName = $"{parameterName.Trim()}[0:0]";
				}
			}
			return parameterName;
		}

		public bool IsStructureParameter(string parameterName)
		{
			bool result = false;
			ICalibration calibration = null;
			IParameterSpecification specification = GetSpecification(CurrentSourceAddress, parameterName, ref calibration);
			IParameterModel parameterModel = calibration.Get(specification.Name);
			if (parameterModel != null && (parameterModel.DataType == ParameterType.StructureArray || parameterModel.DataType == ParameterType.Structure))
			{
				result = true;
				string message = parameterName + " is " + parameterModel.DataType.ToString() + "  type parameter. You have to use Parameter Query to add Structure/Structure Array parameter on Editor Screen";
				EventLogger.Message(EventTypes.Warning, "AddParameter", message);
			}
			return result;
		}

		protected void AddToTable(DataRow row, IParameterSpecification specs, IAddressValue sourceAddress, bool isBroadcast)
		{
			try
			{
				Data.Columns["Unit"].ReadOnly = false;
				Data.Columns["Comment"].ReadOnly = false;
				row.BeginEdit();
				row["SourceAddress"] = sourceAddress.DisplayId;
				row["Name"] = AppendQualifier(specs.Name);
				row["FullName"] = specs.FullName;
				row["Type"] = (int)specs.Type;
				row["Changed"] = false;
				base.DataTableNameColumnChars = row["Name"].ToString().Length;
				row["Value"] = string.Empty;
				row["LastUpdateTime"] = DateTime.Now;
				row["IsBroadcast"] = isBroadcast;
				ICalibration calibration = null;
				try
				{
					row["ReadabilityCheckPassed"] = false;
					IParameterModel parameter = GetParameter(sourceAddress, row["Name"].ToString(), ref calibration);
					if (sourceAddress is IPAddressValue)
					{
						parameter.ReadabilityCheckPassed = true;
						row["ReadabilityCheckPassed"] = true;
					}
					else if (calibration.Connected)
					{
						row["Value"] = GetValueByDataFormat(parameter as IValueModel);
						row["ReadabilityCheckPassed"] = true;
					}
				}
				catch
				{
				}
				row["Unit"] = "";
				switch (specs.Type)
				{
				case AccessModeType.Name:
					try
					{
						row["Unit"] = (string)specs.MetaData["EngineeringUnits"];
						base.DataTableUnitColumnChars = row["Unit"].ToString().Length;
					}
					catch (Exception)
					{
						row["Unit"] = "";
					}
					try
					{
						row["Comment"] = (string)specs.MetaData["Comment"];
						base.DataTableCommentColumnChars = row["Comment"].ToString().Length;
					}
					catch (Exception)
					{
					}
					break;
				case AccessModeType.ArrayElement:
				case AccessModeType.Array:
					try
					{
						row["Address"] = specs.Address;
						row["Offset"] = specs.Offset;
						row["Length"] = specs.Length;
					}
					catch (Exception)
					{
					}
					try
					{
						row["Unit"] = (string)specs.MetaData["EngineeringUnits"];
						base.DataTableUnitColumnChars = row["Unit"].ToString().Length;
					}
					catch (Exception)
					{
						row["Unit"] = "";
					}
					try
					{
						row["Comment"] = (string)specs.MetaData["Comment"];
						base.DataTableCommentColumnChars = row["Comment"].ToString().Length;
					}
					catch (Exception)
					{
					}
					break;
				case AccessModeType.Address:
					try
					{
						row["Address"] = specs.Address;
						row["Offset"] = specs.Offset;
						row["Length"] = specs.Length;
						row["Comment"] = "Memory address " + specs.Address.ToString("X2") + "," + specs.Length;
					}
					catch (Exception)
					{
					}
					break;
				}
				row.EndEdit();
				MonitoredModel.IsChanged = true;
				try
				{
					if (previousRowIndex == int.Parse(row["Order"].ToString()))
					{
						previousRowIndex = -1;
					}
				}
				catch
				{
				}
			}
			catch (Exception ex7)
			{
				row.CancelEdit();
				throw ex7;
			}
			finally
			{
				Data.Columns["Unit"].ReadOnly = true;
				Data.Columns["Comment"].ReadOnly = true;
			}
		}

		protected virtual IParameterModel Connect(DataRow row)
		{
			string text = "";
			ICalibration calibration = null;
			IParameterModel parameterModel = null;
			IAddressValue addressValue = null;
			try
			{
				if (row["Name"] != DBNull.Value && row["SourceAddress"] != DBNull.Value)
				{
					text = (string)row["Name"];
					addressValue = AddressFactory.ProductAddressValue(row["SourceAddress"].ToString().Trim());
					GetSpecification(addressValue, text, ref calibration);
					parameterModel = calibration.FuzzyGet(text);
					parameterModel.DataType.ToString();
					if (parameterModel != null)
					{
						try
						{
							parameterModel.SourceAddress = addressValue;
							if (row["Type"] != DBNull.Value)
							{
								row["Offset"] = 0;
								row["Length"] = 0;
								if (AccessModeType.Address == (AccessModeType)row["Type"])
								{
									row["Offset"] = parameterModel.Offset;
									row["Length"] = parameterModel.Length;
								}
								else if (parameterModel is IArrayModel)
								{
									row["Address"] = parameterModel.Address.ToString();
									MonitoredModel.SetArrayIndex((IArrayModel)parameterModel, text, addressValue);
									row["Offset"] = parameterModel.Offset;
									row["Length"] = ((parameterModel is IDataBlockModel) ? 1u : parameterModel.Length);
								}
							}
						}
						catch (Exception)
						{
							parameterModel = null;
						}
					}
				}
			}
			catch (ParameterIndexOutOfBoundException ex2)
			{
				string message = string.Format(Editor.ResourceManager.GetString(EditorMessageIDs.ArrayIndexOutOfBound.ToString()), ex2.ParameterName, ex2.ProposedIndexValue.ToString(), ex2.MaxLength.ToString());
				EventLogger.Warn("Editor", message, ex2);
			}
			catch (Exception)
			{
				parameterModel = null;
			}
			return parameterModel;
		}

		private void OnRowDeleted(object sender, DataRowChangeEventArgs e)
		{
			Data.AcceptChanges();
		}

		private void OnRowDeleting(object sender, DataRowChangeEventArgs e)
		{
			Remove((int)e.Row["Order"]);
		}

		public void Remove(int rowOrder)
		{
			groupMutex.WaitOne();
			DataRow dataRow = null;
			DataRow[] array = Data.Select("Order =" + rowOrder);
			if (array.Length > 0)
			{
				dataRow = array[0];
			}
			if (dataRow != null)
			{
				EditorState = EditorState.Editing;
				string text = null;
				bool flag = false;
				IAddressValue addressValue = null;
				try
				{
					text = dataRow["Name", DataRowVersion.Current].ToString();
					flag = (bool)dataRow["IsBroadcast", DataRowVersion.Current];
					addressValue = AddressFactory.ProductAddressValue(dataRow["SourceAddress", DataRowVersion.Current].ToString());
					ClearRow(dataRow);
					RaiseRowRemoved();
					MonitoredModel.IsChanged = true;
					MonitoredModel.Remove((int)dataRow["Order"], text, addressValue, flag);
					EventLogger.Log("Editor", "Removed parameter: " + text + " from Device Address " + addressValue);
				}
				catch (Exception ex)
				{
					Console.WriteLine(ex.StackTrace);
				}
			}
			EditorState = EditorState.EditOver;
			groupMutex.ReleaseMutex();
		}

		protected virtual void ClearRow(DataRow row)
		{
			Data.Columns["Unit"].ReadOnly = false;
			Data.Columns["Comment"].ReadOnly = false;
			row["SourceAddress"] = DBNull.Value;
			row["ReadabilityCheckPassed"] = false;
			row["Connected"] = false;
			row["Name"] = string.Empty;
			row["Value"] = string.Empty;
			row["Unit"] = string.Empty;
			row["Comment"] = string.Empty;
			row["Changed"] = false;
			row["Fullname"] = string.Empty;
			row["Length"] = 0;
			row["Address"] = 0;
			row["Offset"] = 0;
			row["Type"] = DBNull.Value;
			row["LastUpdateTime"] = DateTime.Now;
			row["IsBroadcast"] = false;
			Data.Columns["Unit"].ReadOnly = true;
			Data.Columns["Comment"].ReadOnly = true;
		}

		public void RemoveAll()
		{
			Data.Clear();
			MonitoredModel.RemoveAll();
		}

		public virtual void Reconcile(IAddressValue deviceAddress)
		{
			IAddressValue addressValue = null;
			ListDictionary listDictionary = new ListDictionary();
			ListDictionary listDictionary2 = new ListDictionary();
			try
			{
				base.EnableChangeEvents = false;
				Array array = new object[Data.Rows.Count];
				Data.Rows.CopyTo(array, 0);
				foreach (DataRow item in array)
				{
					if (item["Connected"] == DBNull.Value || (bool)item["Connected"] || item["Name"] == DBNull.Value || item["SourceAddress"] == DBNull.Value || (deviceAddress != null && deviceAddress.CompareTo(AddressFactory.ProductAddressValue(item["SourceAddress"].ToString().Trim())) != 0))
					{
						continue;
					}
					string text = (string)item["Name"];
					addressValue = AddressFactory.ProductAddressValue(item["SourceAddress"].ToString().Trim());
					string key = string.Concat(item["Order"], ":", addressValue.Value, ":", text);
					if (MonitoredModel.Members.Contains(key))
					{
						continue;
					}
					ICalibration calibration = null;
					IParameterSpecification specification = GetSpecification(addressValue, item["Name"].ToString().Trim(), ref calibration);
					IParameterModel parameterModel = Connect(item);
					if (parameterModel == null)
					{
						continue;
					}
					if ((bool)item["IsBroadcast"])
					{
						listDictionary2.Add(key, parameterModel);
						ReloadValue(item, specification, calibration);
					}
					else if (!IsArrayElementWithZeroAddress(calibration, specification, parameterModel))
					{
						try
						{
							listDictionary.Add(key, parameterModel);
							ReloadValue(item, specification, calibration);
						}
						catch
						{
						}
					}
					else
					{
						EventLogger.Info("AddParameter", "Cannot monitor " + text + " at " + addressValue.ToString() + " because address is 0.");
					}
					item["Connected"] = parameterModel.DataSource.Connected;
					if (!parameterModel.DataSource.Connected)
					{
						base.Model.AddPending = true;
					}
				}
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
			if (listDictionary.Count > 0)
			{
				MonitoredModel.Add(listDictionary, isBroadcast: false, null);
			}
			if (listDictionary2.Count > 0)
			{
				MonitoredModel.Add(listDictionary2, isBroadcast: true, addressValue);
			}
			base.Model.AddPending = false;
		}

		protected IParameterSpecification GetSpecification(IAddressValue deviceAddress, string name, ref ICalibration calibration)
		{
			IParameterSpecification parameterSpecification = null;
			calibration = GetCalibration(deviceAddress);
			return calibration.GetSpecification(name);
		}

		protected IParameterModel GetParameter(IAddressValue deviceAddress, string name, ref ICalibration calibration)
		{
			IParameterModel parameterModel = null;
			calibration = GetCalibration(deviceAddress);
			return calibration.FuzzyGet(name);
		}

		protected bool IsArrayElementWithZeroAddress(ICalibration calibration, IParameterSpecification spec, IParameterModel parameter)
		{
			bool flag = true;
			return !(calibration is ICalibrationExport) && !(calibration is ISubfile) && spec.Type == AccessModeType.ArrayElement && parameter.Address == 0;
		}

		public virtual void Resynchronize()
		{
			IAddressValue addressValue = null;
			ListDictionary listDictionary = new ListDictionary();
			ListDictionary listDictionary2 = new ListDictionary();
			MonitoredModel.RemoveAll();
			try
			{
				base.EnableChangeEvents = false;
				Array array = new object[Data.Rows.Count];
				Data.Rows.CopyTo(array, 0);
				foreach (DataRow item in array)
				{
					if (!item.HasVersion(DataRowVersion.Current) || item["Name"] == DBNull.Value || item["SourceAddress"] == DBNull.Value)
					{
						continue;
					}
					string text = (string)item["Name"];
					addressValue = AddressFactory.ProductAddressValue(item["SourceAddress"].ToString().Trim());
					string key = string.Concat(item["Order"], ":", addressValue.Value, ":", text);
					IParameterModel parameterModel = Connect(item);
					if (parameterModel == null)
					{
						continue;
					}
					if (!listDictionary.Contains(key))
					{
						ICalibration calibration = null;
						IParameterSpecification specification = GetSpecification(addressValue, item["Name"].ToString().Trim(), ref calibration);
						if ((bool)item["IsBroadcast"])
						{
							listDictionary2.Add(key, parameterModel);
							if (calibration != null && specification != null)
							{
								ReloadValue(item, specification, calibration);
							}
						}
						else if (!IsArrayElementWithZeroAddress(calibration, specification, parameterModel))
						{
							listDictionary.Add(key, parameterModel);
							if (calibration != null && specification != null)
							{
								ReloadValue(item, specification, calibration);
							}
						}
						else
						{
							EventLogger.Info("AddParameter", "Cannot monitor " + text + " at " + item["SourceAddress"].ToString() + " because address is 0.");
						}
					}
					item["Connected"] = parameterModel.DataSource.Connected;
					if (!parameterModel.DataSource.Connected)
					{
						base.Model.AddPending = true;
					}
				}
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
			if (listDictionary.Count > 0)
			{
				MonitoredModel.Add(listDictionary, isBroadcast: false, null);
			}
			if (listDictionary2.Count > 0)
			{
				MonitoredModel.Add(listDictionary2, isBroadcast: true, addressValue);
			}
		}

		public override int GetMemberIndex(string paramName)
		{
			throw new NotSupportedException();
		}

		public override IParameterModel GetMemberParameter(int index)
		{
			IParameterModel parameterModel = null;
			try
			{
				DataRow row = Data.Select("Order =" + index)[0];
				return GetMemberParameter(row);
			}
			catch
			{
				return null;
			}
		}

		public override IParameterModel GetMemberParameter(DataRow row)
		{
			IParameterModel parameterModel = null;
			if (row != null)
			{
				string name = (string)row["Name"];
				IAddressValue deviceAddress = AddressFactory.ProductAddressValue(row["SourceAddress"].ToString().Trim());
				ICalibration calibration = null;
				return GetParameter(deviceAddress, name, ref calibration);
			}
			return null;
		}

		public IParameterModel GetMemberParameter(int order, string parameterName, IAddressValue sourceAddress)
		{
			IParameterModel parameterModel = null;
			try
			{
				return model.MemberByName(order, parameterName, sourceAddress);
			}
			catch
			{
				return null;
			}
		}

		public override void Undo()
		{
			try
			{
				DataRow dataRow = dataTable.Rows[previousRowIndex];
				dataRow["Value"] = previousValue;
				dataRow["Changed"] = false;
			}
			catch
			{
			}
		}

		public override void Revert()
		{
			try
			{
				foreach (DataRow row in Data.Rows)
				{
					try
					{
						IValueModel valueModel = (IValueModel)GetMemberParameter(row);
						if (valueModel != null && valueModel.IsDirty)
						{
							valueModel.Revert();
							if (valueModel is IArrayModel)
							{
								(valueModel as IArrayModel).PreviousValues.Clear();
							}
							SetValueByDataFormat(valueModel, valueModel.ScaledValue);
							row["Value"] = GetValueByDataFormat(valueModel);
							row["Changed"] = false;
						}
					}
					catch (Exception)
					{
					}
				}
				MonitoredModel.IsDirty = false;
				RaiseAllCellsUnmodifiedEvent();
			}
			catch (Exception ex2)
			{
				throw ex2;
			}
		}

		protected override void OnColumnChanging(object sender, DataColumnChangeEventArgs e)
		{
			if (EditorState != EditorState.Idle && EditorState != EditorState.RefreshOver)
			{
				return;
			}
			if (e.ProposedValue != DBNull.Value && e.ProposedValue != null)
			{
				IAddressValue addressValue = null;
				string text = "";
				bool isBroadcast = false;
				IAddressValue addressValue2 = null;
				try
				{
					lock (Data)
					{
						if (e.Column.ColumnName == "Name")
						{
							string text2 = ((string)e.ProposedValue).ToString().Trim();
							string address = e.Row["SourceAddress"].ToString().Trim();
							try
							{
								addressValue = AddressFactory.ProductAddressValue(address);
							}
							catch
							{
								addressValue = CurrentSourceAddress;
							}
							if (e.Row.HasVersion(DataRowVersion.Current))
							{
								try
								{
									text = e.Row["Name", DataRowVersion.Current].ToString();
									isBroadcast = (bool)e.Row["IsBroadcast", DataRowVersion.Current];
									addressValue2 = AddressFactory.ProductAddressValue(e.Row["SourceAddress", DataRowVersion.Current].ToString());
								}
								catch (Exception)
								{
									text = "";
								}
							}
							if (addressValue == null)
							{
								addressValue = CurrentSourceAddress;
							}
							if (IsPGN(text2))
							{
								ICalibration calibration = (ICalibration)Calibrations[addressValue];
								DataRow[] array = calibration.Parameters.Tables["Parameter"].Select("FullName LIKE '" + text2 + "*'");
								StringCollection stringCollection = new StringCollection();
								DataRow[] array2 = array;
								foreach (DataRow dataRow in array2)
								{
									stringCollection.Add(dataRow["FullName"].ToString());
								}
								if (stringCollection.Count > 0)
								{
									Add(stringCollection, addressValue, (int)e.Row["Order"], isBroadcast: false);
									e.ProposedValue = stringCollection[0];
								}
								return;
							}
							if (text2 == "B*")
							{
								ICalibration calibration2 = (ICalibration)Calibrations[addressValue];
								if (!(calibration2 is ICalibrationOnline))
								{
									return;
								}
								ICalibrationOnline calibrationOnline = calibration2 as ICalibrationOnline;
								calibrationOnline.StartListeningForBroadcastParameters();
								Thread.Sleep(5000);
								calibrationOnline.StopListeningForBroadcastParameters();
								Dictionary<byte, IParameterListInfo> broadcastParameters = calibrationOnline.BroadcastParameters;
								if (!broadcastParameters.ContainsKey(addressValue.DeviceAddress))
								{
									return;
								}
								IParameterListInfo parameterListInfo = broadcastParameters[addressValue.DeviceAddress];
								StringCollection includedParameters = parameterListInfo.IncludedParameters;
								if (includedParameters.Count > 0)
								{
									Add(includedParameters, addressValue, (int)e.Row["Order"], isBroadcast: true);
									if ((string)e.ProposedValue == "B*")
									{
										e.ProposedValue = includedParameters[0];
									}
								}
								return;
							}
							text2 = AppendQualifier(text2);
							if (text.ToUpper() != e.ProposedValue.ToString().ToUpper() && !IsStructureParameter(text2) && Add(e.Row, text2, addressValue, isBroadcast: false))
							{
								e.ProposedValue = e.Row["Name"];
								try
								{
									MonitoredModel.Remove((int)e.Row["Order"], text, addressValue2, isBroadcast);
								}
								catch
								{
								}
								RaiseRowRemoved();
							}
							else
							{
								e.Row.CancelEdit();
								e.ProposedValue = text;
							}
							return;
						}
						if (e.Column.ColumnName == "SourceAddress")
						{
							try
							{
								if (e.ProposedValue.ToString().Substring(0, 2) == "0x")
								{
									e.ProposedValue = e.ProposedValue.ToString().Substring(2);
								}
								addressValue = AddressFactory.ProductAddressValue(e.ProposedValue.ToString().Trim());
								string text3 = e.Row["Name"].ToString().Trim();
								if (text3.Length > 0 && e.Row.HasVersion(DataRowVersion.Current))
								{
									try
									{
										addressValue2 = AddressFactory.ProductAddressValue(e.Row["SourceAddress", DataRowVersion.Current].ToString());
									}
									catch
									{
									}
									if (addressValue2 != null && addressValue.DisplayId != addressValue2.DisplayId)
									{
										try
										{
											MonitoredModel.Remove((int)e.Row["Order"], text3, addressValue2, isBroadcast);
										}
										catch
										{
										}
										if (Calibrations.Contains(addressValue))
										{
											if (Add(e.Row, text3, addressValue, isBroadcast: false))
											{
												e.ProposedValue = addressValue.DisplayId;
											}
											else
											{
												e.Row.CancelEdit();
											}
										}
										else
										{
											base.EnableChangeEvents = false;
											try
											{
												string format = Editor.ResourceManager.GetString(EditorMessageIDs.SourceAddressNotFound.ToString());
												format = string.Format(format, addressValue.DisplayId);
												EventLogger.Error("Editor", format);
												e.Row["Value"] = string.Empty;
												e.Row["Changed"] = false;
											}
											catch
											{
											}
											base.EnableChangeEvents = true;
										}
									}
									else
									{
										e.Row.CancelEdit();
									}
								}
								return;
							}
							catch (Exception)
							{
								e.Row.CancelEdit();
								return;
							}
						}
						if (e.Column.ColumnName == "Value")
						{
							previousRowIndex = int.Parse(e.Row["Order"].ToString().Trim());
							previousValue = e.Row["Value"].ToString();
							if (e.Row["Name"].ToString().Trim().Length > 0)
							{
								IAddressValue deviceAddress = AddressFactory.ProductAddressValue(e.Row["SourceAddress"].ToString());
								ICalibration calibration3 = null;
								if (AccessModeType.ArrayElement == (AccessModeType)e.Row["Type"])
								{
									IParameterSpecification specification = GetSpecification(deviceAddress, e.Row["Name"].ToString(), ref calibration3);
									string key = string.Concat(e.Row["Order"], ":", e.Row["SourceAddress"]).ToString() + ":" + e.Row["Name"].ToString();
									if (MonitoredModel.Members[key] is IArrayModel arrayModel)
									{
										if (arrayModel is IDataBlockModel)
										{
											(arrayModel as IDataBlockModel).X = specification.X;
										}
										else if (arrayModel is IArray2DModel)
										{
											(arrayModel as IArray2DModel).SetCurrentLocation(specification.X, specification.Y);
										}
										else if (arrayModel is IArray1DModel)
										{
											(arrayModel as IArray1DModel).X = specification.X;
										}
									}
								}
								base.OnColumnChanging(sender, e);
							}
							else
							{
								e.ProposedValue = "";
							}
							e.Row.AcceptChanges();
						}
						else if (e.Column.ColumnName == "Unit")
						{
							e.Row.RejectChanges();
						}
						return;
					}
				}
				catch (Exception)
				{
					return;
				}
				finally
				{
					EditorState = EditorState.EditOver;
				}
			}
			e.ProposedValue = e.Row[e.Column];
		}

		private bool IsPGN(string proposedName)
		{
			return proposedName[proposedName.Length - 1] == '.';
		}

		public void IncrementArrayIndex(int rowIndex)
		{
			try
			{
				ToggleArrayIndex(rowIndex, ArrayIndexChange.Increment);
			}
			catch (Exception e)
			{
				EventLogger.Error("Toggle Index", "Unable to toggle array Index.", e);
			}
		}

		public void DecrementArrayIndex(int rowIndex)
		{
			try
			{
				ToggleArrayIndex(rowIndex, ArrayIndexChange.Decrement);
			}
			catch (Exception e)
			{
				EventLogger.Error("Toggle Index", "Unable to toggle array Index.", e);
			}
		}

		public void ToggleArrayIndex(int rowIndex, ArrayIndexChange arrayIndexChange)
		{
			IParameterModel parameter = null;
			if (ValidArray(rowIndex, out parameter))
			{
				_ = string.Empty;
				string empty = string.Empty;
				string empty2 = string.Empty;
				IAddressValue addressValue = null;
				IParameterSpecification parameterSpecification = null;
				int num = -1;
				int num2 = 0;
				int num3 = 0;
				int num4 = 0;
				int num5 = 0;
				int num6 = 0;
				int num7 = 0;
				DataRow dataRow = Data.Select("Order =" + rowIndex)[0];
				empty = dataRow["Name"].ToString();
				addressValue = AddressFactory.ProductAddressValue(dataRow["SourceAddress"].ToString());
				empty2 = empty[..empty.IndexOf('[')];
				if (parameter is IArray2DModel)
				{
					ICalibration calibration = (ICalibration)Calibrations[addressValue];
					parameterSpecification = calibration.GetSpecification(empty);
					num4 = parameterSpecification.X;
					num5 = parameterSpecification.Y;
					num6 = ((IArrayAxis)parameter).XAxis.Count;
					num7 = ((IArrayAxis)parameter).YAxis.Count;
					num2 = num4;
					num3 = num5;
					switch (arrayIndexChange)
					{
					case ArrayIndexChange.Increment:
						num3++;
						if (num3 >= num7)
						{
							num2++;
							if (num2 < num6)
							{
								num3 = 0;
								break;
							}
							num2 = 0;
							num3 = 0;
						}
						break;
					case ArrayIndexChange.Decrement:
						num3--;
						if (num3 < 0)
						{
							num2--;
							if (num2 >= 0)
							{
								num3 = num7 - 1;
								break;
							}
							num2 = num6 - 1;
							num3 = num7 - 1;
						}
						break;
					}
					empty2 = empty2 + '[' + num2.ToString() + ':' + num3.ToString() + ']';
					Add(dataRow, empty2, addressValue, isBroadcast: false);
				}
				else
				{
					if (!(parameter is IArray1DModel))
					{
						return;
					}
					ICalibration calibration = (ICalibration)Calibrations[addressValue];
					parameterSpecification = calibration.GetSpecification(empty);
					num4 = parameterSpecification.X;
					num6 = ((IArrayModel)parameter).Count;
					switch (arrayIndexChange)
					{
					case ArrayIndexChange.Increment:
						num2 = num4 + 1;
						if (num2 >= num6)
						{
							num2 = 0;
						}
						break;
					case ArrayIndexChange.Decrement:
						num2 = num4 - 1;
						if (num2 < 0)
						{
							num2 = num6 - 1;
						}
						break;
					}
					empty2 = empty2 + '[' + num2.ToString() + ']';
					Add(dataRow, empty2, addressValue, isBroadcast: false);
				}
			}
			else
			{
				EventLogger.Warn("Toggle Index", "Parameter is not a valid Array Parameter");
			}
		}

		private bool ValidArray(int rowIndex, out IParameterModel parameter)
		{
			bool result = false;
			parameter = GetMemberParameter(rowIndex);
			if (parameter is IArray1DModel)
			{
				result = true;
			}
			return result;
		}

		public void ParameterAddress(int index)
		{
			DataRow dataRow = Data.Rows[index];
			try
			{
				if (dataRow["Name"] != DBNull.Value)
				{
					IAddressValue deviceAddress = AddressFactory.ProductAddressValue(dataRow["SourceAddress"].ToString().Trim());
					ICalibration calibration = null;
					IParameterModel parameter = GetParameter(deviceAddress, dataRow["Name"].ToString(), ref calibration);
					dataRow["Address"] = parameter.Address;
					EventLogger.Info("Editor", string.Concat(dataRow["Name"], " @ ", ((int)dataRow["Address"]).ToString("X4")));
				}
			}
			catch (InvalidCastException e)
			{
				EventLogger.Error("Editor", "Address not available for " + dataRow["Name"], e);
			}
			catch (Exception e2)
			{
				EventLogger.Error("Editor", "Unable to get address for " + dataRow["Name"], e2);
			}
		}

		protected override void CreateDataColumns()
		{
			DataColumn column = MakeDataColumn("Addr", "SourceAddress", Type.GetType("System.String"), isReadOnly: false, isUnique: false);
			dataTable.Columns.Add(column);
			base.CreateDataColumns();
			column = MakeDataColumn("", "Order", Type.GetType("System.Int32"), isReadOnly: false, isUnique: true);
			column.ColumnMapping = MappingType.Hidden;
			column.AutoIncrement = true;
			column.AutoIncrementSeed = 0L;
			dataTable.Columns.Add(column);
			column = MakeDataColumn("", "FullName", Type.GetType("System.String"), isReadOnly: false, isUnique: false);
			column.ColumnMapping = MappingType.Hidden;
			dataTable.Columns.Add(column);
			column = MakeDataColumn("", "Type", Type.GetType("System.Int32"), isReadOnly: false, isUnique: false);
			column.ColumnMapping = MappingType.Hidden;
			dataTable.Columns.Add(column);
			column = MakeDataColumn("", "Address", Type.GetType("System.UInt32"), isReadOnly: false, isUnique: false);
			column.ColumnMapping = MappingType.Hidden;
			dataTable.Columns.Add(column);
			column = MakeDataColumn("", "Offset", Type.GetType("System.Int32"), isReadOnly: false, isUnique: false);
			column.ColumnMapping = MappingType.Hidden;
			dataTable.Columns.Add(column);
			column = MakeDataColumn("", "Length", Type.GetType("System.Int32"), isReadOnly: false, isUnique: false);
			column.ColumnMapping = MappingType.Hidden;
			dataTable.Columns.Add(column);
			column = MakeDataColumn("", "ReadabilityCheckPassed", Type.GetType("System.Boolean"), isReadOnly: false, isUnique: false);
			column.ColumnMapping = MappingType.Hidden;
			column.DefaultValue = true;
			dataTable.Columns.Add(column);
			column = MakeDataColumn("", "Changed", Type.GetType("System.Boolean"), isReadOnly: false, isUnique: false);
			column.ColumnMapping = MappingType.Hidden;
			column.DefaultValue = false;
			dataTable.Columns.Add(column);
			column = MakeDataColumn("", "Connected", Type.GetType("System.Boolean"), isReadOnly: false, isUnique: false);
			column.ColumnMapping = MappingType.Hidden;
			column.DefaultValue = false;
			dataTable.Columns.Add(column);
			Data.Columns["Name"].Unique = false;
			Data.Columns["Name"].ReadOnly = false;
			Data.Columns["Index"].Unique = false;
		}

		protected string GetFilterFromNotification(CICPPMonitor monitoredElement, IAddressValue sourceAddress)
		{
			string result = string.Empty;
			switch (monitoredElement.mode)
			{
			case tagCIDMAccessModeEnum.DM_MODE_NAME:
			{
				string format = ((sourceAddress.Type == AddressType.ASAM) ? "Name = '{0}' AND SourceAddress = '{1}'" : "FullName = '{0}' AND SourceAddress = '{1}'");
				string arg = (string)monitoredElement.location;
				result = string.Format(format, arg, sourceAddress.DisplayId);
				break;
			}
			case tagCIDMAccessModeEnum.DM_MODE_ADDRESS:
				result = $"Address = '{(uint)monitoredElement.location}' AND Offset = '{monitoredElement.offset}' AND Length = '{monitoredElement.Length}' AND SourceAddress = '{sourceAddress.DisplayId}'";
				break;
			}
			return result;
		}

		protected string GetFilterFromParameterModel(IParameterModel parameterModel, IAddressValue sourceAddress)
		{
			string empty = string.Empty;
			ParameterType dataType = parameterModel.DataType;
			if (dataType == ParameterType.MemoryMap)
			{
				return $"Address = '{parameterModel.Address}' AND Offset = '{parameterModel.Offset}' AND Length = '{parameterModel.Length}' AND SourceAddress = '{sourceAddress.DisplayId}'";
			}
			return $"FullName = '{parameterModel.FullName}'";
		}

		protected string GetValueFromNotification(ICIDataElementNotification notification)
		{
			string text = string.Empty;
			try
			{
				switch (Radix)
				{
				case DataFormat.Decimal:
					text = notification.ScaledValue;
					break;
				case DataFormat.Hex:
					text = RawDataToString(notification.RawData);
					break;
				case DataFormat.Binary:
				{
					byte[] bytes = (byte[])notification.RawData;
					byteSwap(ref bytes);
					text = string.Empty;
					byte[] array = bytes;
					foreach (byte b in array)
					{
						text += Convert.ToString(b, 2).PadLeft(8, '0');
					}
					break;
				}
				}
			}
			catch
			{
			}
			return text;
		}

		private string GetValueFromNotification(string parameterName, IAddressValue sourceAddress, ICIDataElementNotification notification)
		{
			IParameterModel parameterModel = null;
			ICalibration calibration = (ICalibration)Calibrations[sourceAddress];
			if (calibration != null)
			{
				parameterModel = calibration.Get(parameterName);
				try
				{
					(parameterModel as IValueModel).ScaledValue = notification.ScaledValue;
				}
				catch (Exception ex)
				{
					throw ex;
				}
			}
			return (parameterModel as IValueModel).ScaledValue;
		}

		public void ResetModuleNetwork(SortedList calibrations)
		{
			MonitoredModel.RemoveAll();
			Calibrations.Clear();
			Calibrations = calibrations;
		}

		public ICalibration GetCalibration(IAddressValue sourceAddress)
		{
			ICalibration calibration = null;
			if (Calibrations.Contains(sourceAddress))
			{
				return (ICalibration)Calibrations[sourceAddress];
			}
			IAddressValue addressValue = null;
			addressValue = AddressFactory.ProductAddressValue("FF");
			return (ICalibration)Calibrations[addressValue];
		}

		protected string RawDataToString(object rawData)
		{
			byte[] bytes = (byte[])rawData;
			byteSwap(ref bytes);
			string text = "";
			if (bytes != null)
			{
				byte[] array = bytes;
				foreach (byte b in array)
				{
					text += b.ToString("X2");
				}
			}
			return text;
		}

		protected void byteSwap(ref byte[] bytes)
		{
			try
			{
				IAddressValue key = CurrentSourceAddress;
				ICalibration calibration = (ICalibration)Calibrations[key];
				string productID = calibration.ProductID;
				IProductInformationService productInformationService = (IProductInformationService)ServiceManager.Services.GetService(typeof(IProductInformationService));
				if (!(productInformationService.GetProductInformation(productID, ProductInformationType.ByteOrder).Trim().ToUpper() == "INTEL"))
				{
					return;
				}
				string value = productInformationService.GetProductInformation(productID, ProductInformationType.WordSize).Trim();
				int num = bytes.Length;
				if ("2".Equals(value))
				{
					for (int i = 0; i < num - 1; i += 2)
					{
						byte b = bytes[i + 1];
						bytes[i + 1] = bytes[i];
						bytes[i] = b;
					}
				}
				else
				{
					if (!"4".Equals(value))
					{
						return;
					}
					switch (bytes.Length)
					{
					case 2:
					{
						for (int k = 0; k < num - 1; k += 2)
						{
							byte b2 = bytes[k + 1];
							bytes[k + 1] = bytes[k];
							bytes[k] = b2;
						}
						break;
					}
					case 4:
					{
						for (int j = 0; j < num - 3; j += 4)
						{
							byte[] array = new byte[4]
							{
								bytes[j + 3],
								bytes[j + 2],
								bytes[j + 1],
								bytes[j]
							};
							bytes[j] = array[0];
							bytes[j + 1] = array[1];
							bytes[j + 2] = array[2];
							bytes[j + 3] = array[3];
						}
						break;
					}
					default:
						throw new Exception("Invalid data. Cannot swap data with length : " + bytes.Length);
					case 1:
						break;
					}
				}
			}
			catch (Exception innerException)
			{
				throw new Exception("Error while swapping data.", innerException);
			}
		}

		private string ToBinaryString(byte[] bytes)
		{
			StringBuilder stringBuilder = new StringBuilder(bytes.Length * 8);
			for (int i = 0; i < bytes.Length; i++)
			{
				string text = Convert.ToString(bytes[i], 2);
				if (text.Length % 8 != 0)
				{
					text = text.PadLeft(text.Length + (8 - text.Length % 8), '0');
				}
				stringBuilder.Append(text);
			}
			return stringBuilder.ToString();
		}

		private byte[] ToByteArray(string dataValue)
		{
			byte[] array = new byte[dataValue.Length / 2];
			dataValue.Trim();
			for (int i = 0; i < dataValue.Length / 2; i++)
			{
				string s = dataValue.Substring(i * 2, 2);
				array[i] = byte.Parse(s, NumberStyles.AllowHexSpecifier);
			}
			return array;
		}

		private void RaiseMultipleParametersAdded()
		{
			if (this.MultipleParametersAdded != null)
			{
				this.MultipleParametersAdded(this, EventArgs.Empty);
			}
		}

		private void RaiseCalibrationListChanged()
		{
			if (this.CalibrationListChanged != null)
			{
				this.CalibrationListChanged(this, EventArgs.Empty);
			}
		}

		private void OnRadixChanged(object sender, RadixEventArgs e)
		{
			base.EnableChangeEvents = false;
			try
			{
				lock (Data)
				{
					if (IsMonitoring)
					{
						return;
					}
					foreach (DataRow row in Data.Rows)
					{
						try
						{
							IParameterModel memberParameter = GetMemberParameter(row);
							if (memberParameter != null)
							{
								switch (Radix)
								{
								case DataFormat.Hex:
									row["Value"] = (memberParameter as IValueModel).HexValue();
									break;
								case DataFormat.Decimal:
									row["Value"] = (memberParameter as IValueModel).ScaledValue;
									break;
								case DataFormat.Binary:
									row["Value"] = (memberParameter as IValueModel).BinaryValue();
									break;
								}
							}
						}
						catch
						{
						}
					}
				}
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
		}

		private void RaiseMonitoredElementAddingEvent(IParameterModel parameterModel)
		{
			if (this.MonitoredElementAddingEvent != null)
			{
				this.MonitoredElementAddingEvent(this, parameterModel);
			}
		}

		public virtual void Refresh(DataRefreshEventArgs e, bool forceUpdate)
		{
			if (EditorState != EditorState.EditOver && EditorState != EditorState.RefreshOver && EditorState != EditorState.Idle)
			{
				return;
			}
			groupMutex.WaitOne();
			EditorState = EditorState.Refreshing;
			this.RefreshStart(this, EventArgs.Empty);
			try
			{
				switch (e.DataSourceType)
				{
				case DataSourceTypeEnum.ECM:
					RefreshECMData(e as ECMDataRefreshEventArgs, forceUpdate);
					break;
				case DataSourceTypeEnum.ASAM:
					RefreshASAMData(e as ASAMDataRefreshEventArgs);
					break;
				case DataSourceTypeEnum.Disk:
					RefreshDiskData(e as DiskDataRefreshEventArgs);
					break;
				case DataSourceTypeEnum.J1939_71:
					RefreshJ1939_71Data(e as J1939_71DataRefreshEventArgs);
					break;
				}
			}
			finally
			{
				EditorState = EditorState.Idle;
				this.RefreshOver(this, EventArgs.Empty);
			}
			groupMutex.ReleaseMutex();
		}

		private void RefreshDiskData(DiskDataRefreshEventArgs e)
		{
			SortedList diskData = e.DiskData;
			DataRow[] array = null;
			_ = string.Empty;
			string empty = string.Empty;
			for (int i = 0; i < diskData.Count; i++)
			{
				lock (Data)
				{
					IParameterModel parameterModel = (IParameterModel)diskData.GetByIndex(i);
					_ = parameterModel.FullName;
					empty = GetFilterFromParameterModel(parameterModel, e.SourceAddress);
					array = Data.Select(empty);
					if (array == null || 0 >= array.Length)
					{
						continue;
					}
					string empty2 = string.Empty;
					for (int j = 0; j < array.Length; j++)
					{
						empty2 = GetValueFromNotification(parameterModel, array[j][1].ToString());
						if (array[j][2].ToString() != empty2)
						{
							array[j][2] = empty2;
						}
					}
				}
			}
		}

		private void RefreshJ1939_71Data(J1939_71DataRefreshEventArgs e)
		{
			string empty = string.Empty;
			ICalibration calibration = null;
			DataRow[] array = null;
			foreach (PGNList j1939_71Datum in e.J1939_71Data)
			{
				foreach (PGN pGN in j1939_71Datum.PGNs)
				{
					if (pGN.SPNs == null)
					{
						continue;
					}
					foreach (SPN sPN in pGN.SPNs)
					{
						lock (Data)
						{
							empty = string.Format("FullName = '{0}' AND SourceAddress = '{1}'", CreateElementName(pGN, sPN), AddressFactory.ProductAddressValue(j1939_71Datum.SourceAddress.ToString("X2")).DisplayId);
							array = Data.Select(empty);
							if (0 < array.Length)
							{
								for (int i = 0; i < array.Length; i++)
								{
									if (array[i][2].ToString() != sPN.Value)
									{
										array[i][2] = sPN.Value;
									}
									array[i][6] = DateTime.Now;
								}
							}
						}
						IParameterSpecification specification = GetSpecification(AddressFactory.ProductAddressValue(j1939_71Datum.SourceAddress.ToString("X2")), sPN.FullName, ref calibration);
						sPN.Units = (string)specification.MetaData["EngineeringUnits"];
					}
				}
			}
		}

		private string CreateElementName(PGN pgn, SPN spn)
		{
			return pgn.Name + "." + spn.Name;
		}

		private string GetValueFromNotification(IParameterModel parameterModel, string parameterName)
		{
			string result = string.Empty;
			try
			{
				if (parameterModel is IArrayModel)
				{
					MonitoredModel.SetArrayIndex(parameterModel as IArrayModel, parameterName, parameterModel.DataSource.SourceAddress);
				}
				switch (Radix)
				{
				case DataFormat.Decimal:
					result = (parameterModel as IValueModel).ScaledValue;
					break;
				case DataFormat.Hex:
					result = (parameterModel as IValueModel).HexValue();
					break;
				case DataFormat.Binary:
					result = (parameterModel as IValueModel).BinaryValue();
					break;
				}
			}
			catch
			{
			}
			return result;
		}

		private void RefreshASAMData(ASAMDataRefreshEventArgs e)
		{
			ICINotification aSAMData = e.ASAMData;
			ICIMonitorElement iCIMonitorElement = null;
			string empty = string.Empty;
			DataRow[] array = null;
			for (int i = 0; i < aSAMData.Count; i++)
			{
				lock (Data)
				{
					iCIMonitorElement = aSAMData.GetElement(i);
					empty = $"Name = '{iCIMonitorElement.Name}' AND SourceAddress = '{e.SourceAddress.DisplayId}'";
					array = Data.Select(empty);
					if (0 >= array.Length)
					{
						continue;
					}
					for (int j = 0; j < array.Length; j++)
					{
						if (array[j][2].ToString() != iCIMonitorElement.Value)
						{
							array[j][2] = iCIMonitorElement.Value;
						}
						array[j][6] = DateTime.Now;
					}
				}
			}
		}

		private void RefreshECMData(ECMDataRefreshEventArgs e, bool forceUpdate)
		{
			if (e.IsProcessed && !forceUpdate)
			{
				return;
			}
			ArrayList eCMData = e.ECMData;
			string empty = string.Empty;
			DataRow[] array = null;
			this.RefreshStart(this, EventArgs.Empty);
			for (int i = 0; i < eCMData.Count; i++)
			{
				lock (Data)
				{
					ICIDataElementNotification iCIDataElementNotification = (ICIDataElementNotification)eCMData[i];
					CICPPMonitor monitoredElement = (CICPPMonitor)iCIDataElementNotification.DataElementMonitor;
					if (iCIDataElementNotification.Status != tagCIDMStatusEnum.DM_STATUS_OK)
					{
						continue;
					}
					empty = GetFilterFromNotification(monitoredElement, e.SourceAddress);
					array = Data.Select(empty);
					if (array == null || 0 >= array.Length)
					{
						continue;
					}
					string empty2 = string.Empty;
					empty2 = GetValueFromNotification(iCIDataElementNotification);
					for (int j = 0; j < array.Length; j++)
					{
						if (array[j][2].ToString() != empty2)
						{
							array[j][2] = empty2;
						}
						array[j][6] = DateTime.Now;
					}
				}
			}
		}

		private void OnSaveChangesEvent(object sender, EventArgs e)
		{
			foreach (DataRow row in Data.Rows)
			{
				row["Changed"] = false;
			}
			foreach (IParameterModel value in model.Members.Values)
			{
				(value as IEntityModel).UpdateRevertValue();
			}
			RaiseAllCellsUnmodifiedEvent();
		}

		protected virtual bool ValidateAndAddToTable(DataRow row, string name, ref IAddressValue sourceAddress, bool isBroadcast)
		{
			bool result = false;
			ICalibration calibration = null;
			IParameterSpecification specification = GetSpecification(sourceAddress, name, ref calibration);
			if (specification.Type != AccessModeType.Invalid)
			{
				string text = row["Name"].ToString();
				string text2 = row["SourceAddress"].ToString();
				bool flag = true;
				if (specification.Type != AccessModeType.Address)
				{
					if (specification.MetaData != null)
					{
						IParamInfo paramInfo = calibration.ParametersInfo[specification.MetaData["Name"].ToString()];
						if (paramInfo.IsCodeTypeParameter)
						{
							flag = false;
							string message = string.Format(Editor.ResourceManager.GetString(EditorMessageIDs.ParameterNotAllowed.ToString()), sourceAddress.DisplayId, specification.Name, "subfile 3") + " Contact your product System Integrator to have this parameter moved from the Code group and/or Subfile 3 if you need access.";
							EventLogger.Error("Editor", message);
						}
						else if (-1 != paramInfo.FullName.IndexOf("ConfigHeaders."))
						{
							flag = false;
							string message2 = string.Format(Editor.ResourceManager.GetString(EditorMessageIDs.ParameterNotAllowed.ToString()), sourceAddress.DisplayId, specification.Name, "config headers");
							EventLogger.Error("Editor", message2);
						}
					}
					else
					{
						flag = false;
					}
				}
				if (flag)
				{
					if (specification.Type == AccessModeType.Structure || specification.Type == AccessModeType.Array)
					{
						IParamInfo paramInfo2 = calibration.ParametersInfo[specification.Name];
						if (paramInfo2 != null && !paramInfo2.IsAxis)
						{
							IParameterModel byFullName = calibration.GetByFullName(specification.FullName);
							RaiseMonitoredElementAddingEvent(byFullName);
						}
					}
					else
					{
						AddToTable(row, specification, sourceAddress, isBroadcast);
						result = true;
						if (text.Length > 0)
						{
							EventLogger.Info("Editor", "Removed parameter: " + text + " from device address " + text2.ToString());
						}
					}
				}
			}
			else
			{
				EventLogger.Error("AddParameter", "Invalid parameter " + name + " at address " + sourceAddress.Value);
			}
			return result;
		}

		private void UpdateColumns()
		{
			for (int i = 0; i < Calibrations.Count; i++)
			{
				ICalibration calibration = (ICalibration)Calibrations.GetByIndex(i);
				if (calibration is ICalibrationDisk)
				{
					Data.Columns["SourceAddress"].ColumnMapping = MappingType.Hidden;
					RaiseUpdateSourceAddressColumnEvent();
					break;
				}
			}
		}

		private void ReloadValue(DataRow row, IParameterSpecification specs, ICalibration calibration)
		{
			try
			{
				base.EnableChangeEvents = false;
				if (calibration == null || !calibration.Connected || (!row.IsNull("ReadabilityCheckPassed") && (bool)row["ReadabilityCheckPassed"]))
				{
					return;
				}
				try
				{
					string name = specs.Name;
					if (calibration.Connected)
					{
						row["Value"] = GetValueByDataFormat(calibration.FuzzyGet(name) as IValueModel);
						row["ReadabilityCheckPassed"] = true;
					}
				}
				catch
				{
				}
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
		}

		private void UpdateReloadCheck(IAddressValue deviceAddress)
		{
			try
			{
				base.EnableChangeEvents = false;
				foreach (DataRow row in Data.Rows)
				{
					if (row["Name"] != DBNull.Value && row["SourceAddress"] != DBNull.Value && deviceAddress.CompareTo(AddressFactory.ProductAddressValue(row["SourceAddress"].ToString().Trim())) == 0)
					{
						row["ReadabilityCheckPassed"] = false;
					}
				}
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
		}

		private void OnRunLocationChanged(object sender, RunLocationChangedEventArgs e)
		{
			if (sender is ICalibration calibration && calibration.CalibrationDataServer.GTISLevel != GTISVersion.GTIS45)
			{
				IAddressValue sourceAddress = calibration.SourceAddress;
				UpdateReloadCheck(sourceAddress);
			}
		}

		private void OnFileSaveAsEvent(object sender, FileSaveAsEventArgs args)
		{
			lock (Data)
			{
				try
				{
					base.EnableChangeEvents = false;
					string filterExpression = $"SourceAddress = '{args.OldSourceAddress.DisplayId}'";
					DataRow[] array = Data.Select(filterExpression);
					DataRow[] array2 = array;
					foreach (DataRow dataRow in array2)
					{
						dataRow["SourceAddress"] = args.NewSourceAddress.DisplayId;
					}
					if (array.Length > 0)
					{
						Data.AcceptChanges();
					}
				}
				catch (Exception ex)
				{
					Trace.WriteLine("Unhandled exception in Monitored::GroupContoller::OnFileSaveAsEvent - " + ex.Message);
				}
				finally
				{
					base.EnableChangeEvents = true;
				}
			}
		}

		private void RaiseUpdateSourceAddressColumnEvent()
		{
			if (this.UpdateSourceAddressColumnEvent != null)
			{
				this.UpdateSourceAddressColumnEvent(this, EventArgs.Empty);
			}
		}

		private string ByteSwapString(string hexData)
		{
			StringBuilder stringBuilder = new StringBuilder(hexData.Length);
			int num = hexData.Length / 8;
			int num2 = hexData.Length % 8;
			for (int i = 0; i < num; i++)
			{
				for (int num3 = 7; num3 > 0; num3 -= 2)
				{
					stringBuilder = stringBuilder.Append(hexData[i * 8 + num3 - 1]);
					stringBuilder = stringBuilder.Append(hexData[i * 8 + num3]);
				}
			}
			for (int num4 = num2 - 1; num4 > 0; num4 -= 2)
			{
				stringBuilder = stringBuilder.Append(hexData[num * 8 + num4 - 1]);
				stringBuilder = stringBuilder.Append(hexData[num * 8 + num4]);
			}
			return stringBuilder.ToString();
		}
	}
	public class GraphicalMonitoredGroupController : MonitoredGroupController
	{
		internal const string GraphParametersFilterFormat = "ViewType = 'Graph'";

		internal const string GaugeParametersFilterFormat = "ViewType = 'Gauge'";

		internal static string ColorColumn = "Color";

		internal static string LowerBoundColumn = "LowerBound";

		internal static string UpperBoundColumn = "UpperBound";

		internal static string ViewTypeColumn = "ViewType";

		internal static string PlotGraphColumn = "PlotGraph";

		internal int UIRefreshRate
		{
			get
			{
				return GDMModel.UIRefreshRate;
			}
			set
			{
				GDMModel.UIRefreshRate = value;
			}
		}

		public override bool IsMonitoring
		{
			get
			{
				return base.IsMonitoring;
			}
			set
			{
				base.IsMonitoring = value;
			}
		}

		internal DataRow[] GraphParameters => Data.Select("ViewType = 'Graph'");

		internal DataRow[] GaugeParameters => Data.Select("ViewType = 'Gauge'");

		private GraphicalMonitoredGroupModel GDMModel => (GraphicalMonitoredGroupModel)base.MonitoredModel;

		internal event GDMParameterAddedEventHandler GDMParameterAddedEvent;

		internal event AvailableSourceAddressChangedEventHandler AvailableSourceAddressChangedEvent;

		internal event GuageConfigurationRestoreEventHandler GuageConfigurationRestoreEvent;

		internal event EventHandler ScreenUpdateEvent;

		internal event EventHandler CleanUpDataEvent;

		internal event EventHandler PrepareToSaveSettingsEvent;

		public GraphicalMonitoredGroupController(GraphicalMonitoredGroupModel model)
			: base(model)
		{
			GDMModel.CalibrationsChangedEventHandler += OnCalibrationsChangedEventHandler;
		}

		public override bool Add(DataRow row, string name, IAddressValue sourceAddress, bool isBroadcast)
		{
			IParameterModel parameterModel = null;
			bool result = false;
			groupMutex.WaitOne();
			base.EditorState = EditorState.Editing;
			try
			{
				ICalibration calibration = GetCalibration(sourceAddress);
				IParameterSpecification specification = calibration.GetSpecification(name);
				if (ValidateAndAddToTable(row, name, ref sourceAddress, isBroadcast))
				{
					result = true;
					parameterModel = Connect(row);
					if (parameterModel != null)
					{
						if (specification.Type != AccessModeType.Address)
						{
							long num = long.Parse(row["Order"].ToString());
							if (!IsArrayElementWithZeroAddress(calibration, specification, parameterModel))
							{
								if (!base.MonitoredModel.Members.Contains(num + ":" + sourceAddress.Value + ":" + specification.Name))
								{
									base.MonitoredModel.Add(num, specification.Name, sourceAddress, parameterModel, isBroadcast);
								}
							}
							else
							{
								EventLogger.Warn("AddParameter", "Cannot monitor " + name + " at " + sourceAddress.Value + " because address is 0.");
							}
						}
						else
						{
							string message = specification.Name + " is an address parameter and not supported for graphical monitoring at this time.";
							EventLogger.Warn("Data Monitor", message);
						}
					}
					else
					{
						EventLogger.Error("AddParameter", "Cannot monitor " + name + " at " + sourceAddress.Value);
					}
				}
				else
				{
					EventLogger.Log("AddParameter", "Invalid parameter " + name + " at address " + sourceAddress.Value);
				}
			}
			catch (Exception e)
			{
				EventLogger.Error("AddParameter", "Invalid Parameter or Address: " + name + " from Device Address " + sourceAddress, e);
				result = false;
			}
			base.EditorState = EditorState.EditOver;
			groupMutex.ReleaseMutex();
			return result;
		}

		protected override void CreateDataColumns()
		{
			base.CreateDataColumns();
			Data.Columns["Index"].ReadOnly = false;
			Data.Columns["Index"].DefaultValue = -1;
			DataColumn dataColumn = MakeDataColumn("", ColorColumn, Type.GetType("System.String"), isReadOnly: false, isUnique: false);
			dataColumn.ColumnMapping = MappingType.Hidden;
			dataTable.Columns.Add(dataColumn);
			dataColumn = MakeDataColumn("", LowerBoundColumn, Type.GetType("System.Double"), isReadOnly: false, isUnique: false);
			dataColumn.DefaultValue = 0;
			dataTable.Columns.Add(dataColumn);
			dataColumn = MakeDataColumn("", UpperBoundColumn, Type.GetType("System.Double"), isReadOnly: false, isUnique: false);
			dataColumn.DefaultValue = 100;
			dataTable.Columns.Add(dataColumn);
			dataColumn = MakeDataColumn("", ViewTypeColumn, Type.GetType("System.String"), isReadOnly: false, isUnique: false);
			dataColumn.DefaultValue = GraphicalMonitorViewType.Graph.ToString();
			dataTable.Columns.Add(dataColumn);
			dataColumn = MakeDataColumn("", PlotGraphColumn, Type.GetType("System.Boolean"), isReadOnly: false, isUnique: false);
			dataColumn.DefaultValue = false;
			dataTable.Columns.Add(dataColumn);
		}

		protected override IParameterModel Connect(DataRow row)
		{
			IParameterModel parameterModel = base.Connect(row);
			if (parameterModel != null)
			{
				string parameterName = (string)row["Name"];
				IParameterSpecification specification = parameterModel.DataSource.GetSpecification(parameterName);
				if (!(parameterModel is IDataBlockModel))
				{
					row[LowerBoundColumn] = parameterModel.LowerBound;
					row[UpperBoundColumn] = parameterModel.UpperBound;
				}
				if ((GraphicalMonitorViewType)Enum.Parse(typeof(GraphicalMonitorViewType), row[ViewTypeColumn].ToString(), ignoreCase: true) == GraphicalMonitorViewType.Graph)
				{
					row[PlotGraphColumn] = true;
				}
				if (specification.Type != AccessModeType.Address && (specification.Type != AccessModeType.ArrayElement || parameterModel.Address != 0))
				{
					RaiseGDMParameterAddedEvent(row);
				}
			}
			return parameterModel;
		}

		protected override void ClearRow(DataRow row)
		{
			row[ViewTypeColumn] = GraphicalMonitorViewType.Graph;
			row[PlotGraphColumn] = false;
			row[ColorColumn] = string.Empty;
			row[LowerBoundColumn] = 0;
			row[UpperBoundColumn] = 0;
			Data.AcceptChanges();
			base.ClearRow(row);
		}

		public override void Restore(NewDataSet.GroupRow groupRow)
		{
			RestoreParameters(groupRow);
			RestoreGaugeConfiguration(groupRow);
			RestoreGraphConfiguration(groupRow);
		}

		public override void CleanupResources()
		{
			base.CleanupResources();
			GDMModel.CalibrationsChangedEventHandler -= OnCalibrationsChangedEventHandler;
		}

		public override void SaveSession(NewDataSet.ScreenRow screenRow)
		{
			this.PrepareToSaveSettingsEvent(this, EventArgs.Empty);
			NewDataSet.GroupRow groupRow = ((NewDataSet)screenRow.Table.DataSet).Group.NewGroupRow();
			screenRow.UIRefreshRate = (ushort)GDMModel.UIRefreshRate;
			groupRow.ScreenRow = screenRow;
			GDMModel.SaveSession(groupRow);
			((NewDataSet)screenRow.Table.DataSet).Group.AddGroupRow(groupRow);
			SaveParameters(groupRow);
			SaveGraphSetting(groupRow);
			SaveGaugeSetting(groupRow);
			GDMModel.IsChanged = false;
		}

		public void CleanUpData()
		{
			if (this.CleanUpDataEvent != null)
			{
				this.CleanUpDataEvent(this, EventArgs.Empty);
			}
			GDMModel.DeviceList.Clear();
		}

		public void SaveDataPoint(DataRefreshEventArgs e)
		{
			try
			{
				GDMModel.AddDataPoint(e);
			}
			catch
			{
			}
		}

		public override void Refresh(DataRefreshEventArgs e, bool forceUpdate)
		{
			base.Refresh(e, forceUpdate);
			if (this.ScreenUpdateEvent != null)
			{
				lock (Data)
				{
					this.ScreenUpdateEvent(this, EventArgs.Empty);
				}
			}
		}

		internal void OnGaugeParameterChanged(object sender, GaugeParameterChangedEventArgs args)
		{
			AddParameterOnGauge(args.ParameterName, args.SourceAddress, args.GaugeIndex, args.Action);
		}

		internal void OnUpdatedConnectionEvent(object sender, UpdatedConnectionEventArgs e)
		{
			if (e.Connected)
			{
				if (!GDMModel.ConnectedDeviceList.Contains(e.SourceAddress.DisplayId))
				{
					GDMModel.ConnectedDeviceList.Add(e.SourceAddress.DisplayId);
				}
			}
			else if (GDMModel.ConnectedDeviceList.Contains(e.SourceAddress.DisplayId))
			{
				GDMModel.ConnectedDeviceList.Remove(e.SourceAddress.DisplayId);
			}
		}

		private void OnCalibrationsChangedEventHandler(object sender, EventArgs e)
		{
			ICalibration calibration = null;
			GDMModel.ConnectedDeviceList.Clear();
			for (int i = 0; i < base.Calibrations.Count; i++)
			{
				calibration = (ICalibration)base.Calibrations.GetByIndex(i);
				if (calibration.SourceAddress != null && calibration.Connected && !GDMModel.ConnectedDeviceList.Contains(calibration.SourceAddress.DisplayId))
				{
					GDMModel.ConnectedDeviceList.Add(calibration.SourceAddress.DisplayId);
				}
			}
			RaiseAvailableSourceAddressChangedEvent();
		}

		protected void RaiseGDMParameterAddedEvent(DataRow row)
		{
			if (this.GDMParameterAddedEvent != null)
			{
				GraphicalMonitorParameterEventArgs e = new GraphicalMonitorParameterEventArgs(row);
				this.GDMParameterAddedEvent(this, e);
			}
		}

		protected void RaiseAvailableSourceAddressChangedEvent()
		{
			if (this.AvailableSourceAddressChangedEvent != null)
			{
				AvailableSourceAddressChangedEventArgs args = new AvailableSourceAddressChangedEventArgs(GDMModel.ConnectedDeviceList);
				this.AvailableSourceAddressChangedEvent(this, args);
			}
		}

		internal void AddParameterOnGauge(string parameterName, string sourceAddress, int index, ActionType action)
		{
			DataRow[] array = Data.Select("Index = " + index);
			if (array.Length > 0)
			{
				Remove((int)array[0]["Order"]);
				Data.Rows.Remove(array[0]);
			}
			if (ActionType.ParameterDeleted != action)
			{
				DataRow dataRow = Data.NewRow();
				dataRow["Index"] = index;
				dataRow[ViewTypeColumn] = GraphicalMonitorViewType.Gauge.ToString();
				if (Add(dataRow, parameterName, AddressFactory.ProductAddressValue(sourceAddress), isBroadcast: false))
				{
					Data.Rows.Add(dataRow);
					Data.AcceptChanges();
				}
			}
		}

		internal DataUpdate GetNotficationValue(DataRefreshEventArgs e, int index)
		{
			DataUpdate result = DataUpdate.Empty;
			switch (e.DataSourceType)
			{
			case DataSourceTypeEnum.Disk:
				result = GetDiskNotificationValue(e as DiskDataRefreshEventArgs, index);
				break;
			case DataSourceTypeEnum.ECM:
				result = GetECMNotificationValue(e as ECMDataRefreshEventArgs, index);
				break;
			case DataSourceTypeEnum.ASAM:
				result = GetASAMNotificationValue(e as ASAMDataRefreshEventArgs, index);
				break;
			case DataSourceTypeEnum.J1939_71:
				result = GetJ1939_71NotificationValue(e as J1939_71DataRefreshEventArgs, index);
				break;
			}
			return result;
		}

		internal DataUpdate GetECMNotificationValue(ECMDataRefreshEventArgs e, int index)
		{
			DataUpdate empty = DataUpdate.Empty;
			CICPPMonitor cICPPMonitor = null;
			if (index < e.ECMData.Count)
			{
				ICIDataElementNotification iCIDataElementNotification = e.ECMData[index] as ICIDataElementNotification;
				if (iCIDataElementNotification.Status == tagCIDMStatusEnum.DM_STATUS_OK)
				{
					cICPPMonitor = (CICPPMonitor)iCIDataElementNotification.DataElementMonitor;
					if (cICPPMonitor.mode == tagCIDMAccessModeEnum.DM_MODE_NAME)
					{
						empty.name = cICPPMonitor.location.ToString();
						empty.name = empty.name.Substring(empty.name.IndexOf('.') + 1);
						empty.dataValue = iCIDataElementNotification.ScaledFloat;
					}
					else if (cICPPMonitor.mode == tagCIDMAccessModeEnum.DM_MODE_ADDRESS)
					{
						empty.name = cICPPMonitor.location.ToString() + " " + cICPPMonitor.offset;
						try
						{
							empty.dataValue = Convert.ToDouble(iCIDataElementNotification.ScaledValue);
						}
						catch
						{
							empty.dataValue = iCIDataElementNotification.ScaledFloat;
						}
					}
					empty.found = true;
				}
			}
			return empty;
		}

		internal DataUpdate GetJ1939_71NotificationValue(J1939_71DataRefreshEventArgs e, int index)
		{
			DataUpdate empty = DataUpdate.Empty;
			SPN sPN = e[index];
			empty.name = sPN.FullName;
			empty.found = true;
			empty.dataValue = double.Parse(sPN.Value);
			return empty;
		}

		internal DataUpdate GetASAMNotificationValue(ASAMDataRefreshEventArgs e, int index)
		{
			DataUpdate empty = DataUpdate.Empty;
			ICINotification aSAMData = e.ASAMData;
			ICIMonitorElement element = aSAMData.GetElement(index);
			empty.name = element.Name;
			empty.found = true;
			empty.dataValue = double.Parse(element.Value);
			return empty;
		}

		internal DataUpdate GetDiskNotificationValue(DiskDataRefreshEventArgs e, int index)
		{
			DataUpdate empty = DataUpdate.Empty;
			IParameterModel parameterModel = (IParameterModel)e.DiskData.GetByIndex(index);
			if (parameterModel is IArrayModel)
			{
				GDMModel.SetArrayIndex(parameterModel as IArrayModel, parameterModel.FullName, parameterModel.DataSource.SourceAddress);
			}
			empty.name = parameterModel.FullName;
			empty.found = true;
			empty.dataValue = ((IValueModel)parameterModel).ScaledFloat();
			return empty;
		}

		private void SaveParameters(NewDataSet.GroupRow groupRow)
		{
			NewDataSet.ParameterDataTable parameter = ((NewDataSet)groupRow.Table.DataSet).Parameter;
			DataRow[] array = Data.Select();
			DataRow[] array2 = array;
			foreach (DataRow dataRow in array2)
			{
				try
				{
					if (dataRow["Name"] == DBNull.Value)
					{
						continue;
					}
					NewDataSet.ParameterRow parameterRow = parameter.NewParameterRow();
					parameterRow.GroupRow = groupRow;
					parameterRow.SourceAddress = dataRow["SourceAddress"].ToString();
					parameterRow.Name = (string)dataRow["Name"];
					parameterRow.Units = (string)dataRow["Unit"];
					parameterRow.ViewType = dataRow[ViewTypeColumn].ToString();
					if (dataRow[ColorColumn] != DBNull.Value && dataRow[ColorColumn].ToString().Length > 0)
					{
						parameterRow.Color = dataRow[ColorColumn].ToString();
					}
					parameter.AddParameterRow(parameterRow);
					if (parameterRow.ViewType == GraphicalMonitorViewType.Graph.ToString())
					{
						string filterExpression = "Name ='" + dataRow["Name"].ToString() + "' AND SourceAddress = '" + dataRow["SourceAddress"].ToString() + "'";
						DataRow[] array3 = GDMModel.GraphConfiguration.Tables["Parameters"].Select(filterExpression);
						if (array3.Length > 0)
						{
							NewDataSet.ParameterYAxisDataTable parameterYAxis = ((NewDataSet)groupRow.Table.DataSet).ParameterYAxis;
							NewDataSet.ParameterYAxisRow parameterYAxisRow = parameterYAxis.NewParameterYAxisRow();
							parameterYAxisRow.MaxValue = double.Parse(array3[0][UpperBoundColumn].ToString());
							parameterYAxisRow.MinValue = double.Parse(array3[0][LowerBoundColumn].ToString());
							parameterYAxisRow.ParameterRow = parameterRow;
							parameterYAxis.AddParameterYAxisRow(parameterYAxisRow);
						}
					}
					else if (parameterRow.ViewType == GraphicalMonitorViewType.Gauge.ToString())
					{
						parameterRow.GaugeIndex = short.Parse(dataRow["Index"].ToString());
					}
				}
				catch (Exception)
				{
				}
			}
		}

		private void SaveGraphSetting(NewDataSet.GroupRow groupRow)
		{
			NewDataSet.GraphConfigurationDataTable graphConfiguration = ((NewDataSet)groupRow.Table.DataSet).GraphConfiguration;
			NewDataSet.GraphConfigurationRow graphConfigurationRow = graphConfiguration.NewGraphConfigurationRow();
			graphConfigurationRow.GroupRow = groupRow;
			graphConfiguration.AddGraphConfigurationRow(graphConfigurationRow);
			NewDataSet.GeneralDataTable general = ((NewDataSet)graphConfigurationRow.Table.DataSet).General;
			NewDataSet.GeneralRow generalRow = general.NewGeneralRow();
			generalRow.GraphConfigurationRow = graphConfigurationRow;
			DataSet graphConfiguration2 = GDMModel.GraphConfiguration;
			DataRow dataRow = graphConfiguration2.Tables["General"].Rows[0];
			generalRow.BackColor = dataRow["BackGroundColor"].ToString();
			generalRow.Title = dataRow["TitleString"].ToString();
			generalRow.TitlePosition = dataRow["TitlePosition"].ToString();
			generalRow.TitleVisble = bool.Parse(dataRow["TitleVisible"].ToString());
			generalRow.IOCompSettings = dataRow["IOCompSettings"].ToString();
			general.AddGeneralRow(generalRow);
		}

		private void SaveGaugeSetting(NewDataSet.GroupRow groupRow)
		{
			if (GDMModel.GaugeConfiguration.Rows.Count <= 0)
			{
				return;
			}
			NewDataSet.GaugeConfigurationRow gaugeConfigurationRow = null;
			NewDataSet.GaugeConfigurationDataTable gaugeConfiguration = ((NewDataSet)groupRow.Table.DataSet).GaugeConfiguration;
			gaugeConfigurationRow = gaugeConfiguration.NewGaugeConfigurationRow();
			gaugeConfigurationRow.ShowGauges = GDMModel.ShowGauges;
			gaugeConfigurationRow.GroupRow = groupRow;
			gaugeConfiguration.AddGaugeConfigurationRow(gaugeConfigurationRow);
			NewDataSet.GaugeDataTable gauge = ((NewDataSet)gaugeConfigurationRow.Table.DataSet).Gauge;
			NewDataSet.GaugeRow[] array = (NewDataSet.GaugeRow[])GDMModel.GaugeConfiguration.Select();
			NewDataSet.GaugeRow[] array2 = array;
			foreach (NewDataSet.GaugeRow gaugeRow in array2)
			{
				if (IsGaugeConfigurationDefault(gaugeRow))
				{
					NewDataSet.GaugeRow gaugeRow2 = gauge.NewGaugeRow();
					gaugeRow2.Index = gaugeRow.Index;
					gaugeRow2.MaxValue = gaugeRow.MaxValue;
					gaugeRow2.MinValue = gaugeRow.MinValue;
					gaugeRow2.RedLinesStart = gaugeRow.RedLinesStart;
					gaugeRow2.RedLineVisible = gaugeRow.RedLineVisible;
					gaugeRow2.GaugeConfigurationRow = gaugeConfigurationRow;
					gauge.AddGaugeRow(gaugeRow2);
				}
			}
		}

		private void RestoreParameters(NewDataSet.GroupRow groupRow)
		{
			DataRow dataRow = null;
			bool flag = false;
			int count = Data.Rows.Count;
			NewDataSet.ParameterRow[] parameterRows = groupRow.GetParameterRows();
			NewDataSet.ParameterRow parameterRow = null;
			IAddressValue addressValue = null;
			string text = string.Empty;
			for (int i = 0; i < parameterRows.Length; i++)
			{
				if (i < count)
				{
					dataRow = Data.Rows[i];
					flag = false;
				}
				else
				{
					dataRow = Data.NewRow();
					flag = true;
				}
				parameterRow = parameterRows[i];
				try
				{
					if (parameterRow.Name == null || parameterRow.Name.Length <= 0)
					{
						continue;
					}
					dataRow[ViewTypeColumn] = parameterRow.ViewType;
					if (parameterRow.ViewType == GraphicalMonitorViewType.Gauge.ToString())
					{
						dataRow["Index"] = parameterRow.GaugeIndex;
					}
					text = parameterRow.Name;
					addressValue = AddressFactory.ProductAddressValue(parameterRow.SourceAddress);
					if (!base.Calibrations.Contains(addressValue))
					{
						addressValue = base.CurrentSourceAddress;
					}
					if (Add(dataRow, text, addressValue, isBroadcast: false))
					{
						if (flag)
						{
							Data.Rows.Add(dataRow);
						}
						continue;
					}
					EventLogger.Warn("Editor", "Failed to add to screen: " + addressValue.Value + ":" + text + " - Device Address " + addressValue);
				}
				catch (AddressException ex)
				{
					string text2 = string.Empty;
					if (parameterRow.SourceAddress != null)
					{
						text2 = "Source Address: " + parameterRow.SourceAddress;
					}
					text2 = text2 + " Failed to add to screen: " + text;
					EventLogger.Warn("Editor", text2, ex.Message);
				}
				catch (Exception)
				{
					EventLogger.Warn("Editor", "Failed to add to screen: " + addressValue.Value + ":" + text + " - Device Address " + addressValue);
				}
			}
			Data.AcceptChanges();
			BuildSomeRows();
		}

		private void RestoreGaugeConfiguration(NewDataSet.GroupRow groupRow)
		{
			NewDataSet.GaugeConfigurationRow[] gaugeConfigurationRows = groupRow.GetGaugeConfigurationRows();
			GDMModel.ShowGauges = gaugeConfigurationRows[0].ShowGauges;
			if (0 < gaugeConfigurationRows.Length && this.GuageConfigurationRestoreEvent != null)
			{
				this.GuageConfigurationRestoreEvent(this, new GuageConfigurationRestoreEventArgs(gaugeConfigurationRows[0].GetGaugeRows()));
			}
		}

		private void RestoreGraphConfiguration(NewDataSet.GroupRow groupRow)
		{
			NewDataSet.GraphConfigurationRow[] graphConfigurationRows = groupRow.GetGraphConfigurationRows();
			if (graphConfigurationRows.Length > 0)
			{
				GDMModel.RestoreGraphSettings(graphConfigurationRows[0]);
			}
		}

		private bool IsGaugeConfigurationDefault(NewDataSet.GaugeRow gaugeRow)
		{
			NewDataSet.GaugeRow gaugeRow2 = new NewDataSet.GaugeDataTable().NewGaugeRow();
			return gaugeRow2.MaxValue != gaugeRow.MaxValue || gaugeRow2.MinValue != gaugeRow.MinValue || gaugeRow2.RedLinesStart != gaugeRow.RedLinesStart || gaugeRow2.RedLineVisible != gaugeRow.RedLineVisible;
		}
	}
	public enum GraphType
	{
		StripChart,
		ScopeChart
	}
	public enum GraphicalMonitorViewType
	{
		Graph,
		Gauge,
		Normal
	}
	internal delegate void GraphModeChangedEventHandler(object sender, GraphModeChangedEventArgs e);
	internal delegate void GDMParameterAddedEventHandler(object sender, GraphicalMonitorParameterEventArgs e);
	internal delegate void UpdatedConnectionEventHandler(object sender, UpdatedConnectionEventArgs e);
	public class DeviceDataPoints
	{
		private SortedList dataPoints;

		public SortedList DataPoints => dataPoints;

		public ICollection Keys => dataPoints.Keys;

		public DeviceDataPoints()
		{
			dataPoints = new SortedList();
		}

		public void addDataPoint(DataRefreshEventArgs e, long time)
		{
			lock (dataPoints)
			{
				if (dataPoints.ContainsKey(time))
				{
					dataPoints[time] = e;
				}
				else
				{
					dataPoints.Add(time, e);
				}
			}
		}

		public DataRefreshEventArgs GetDataPoint(long time)
		{
			return (DataRefreshEventArgs)dataPoints[time];
		}

		public void ClearList()
		{
			dataPoints.Clear();
		}

		public SortedList Clone()
		{
			return (SortedList)dataPoints.Clone();
		}
	}
	public interface IMonitoredModel
	{
		IParameterModel ParameterModel { get; set; }

		ParameterType DataType { get; set; }

		ICalibration DataSource { get; set; }

		string Name { get; set; }

		string Comment { get; set; }

		string EngineeringUnits { get; }
	}
	public class MonitoredModel : IMonitoredModel
	{
		private ParameterType _dataType;

		private IParameterModel _parameterModel;

		private ICalibration _dataSource;

		public IParameterModel ParameterModel
		{
			get
			{
				return _parameterModel;
			}
			set
			{
				_parameterModel = value;
			}
		}

		public ParameterType DataType
		{
			get
			{
				return _dataType;
			}
			set
			{
				_dataType = value;
			}
		}

		public ICalibration DataSource
		{
			get
			{
				return _dataSource;
			}
			set
			{
				_dataSource = value;
			}
		}

		public virtual string Name
		{
			get
			{
				return ParameterModel.Name;
			}
			set
			{
				ParameterModel.Name = value;
			}
		}

		public virtual string Comment
		{
			get
			{
				return ParameterModel.Comment;
			}
			set
			{
				ParameterModel.Comment = value;
			}
		}

		public virtual string EngineeringUnits => ParameterModel.EngineeringUnits;

		public MonitoredModel(ICalibration dataSource)
		{
			_dataSource = dataSource;
		}

		public MonitoredModel(IParameterModel parameterModel)
		{
			_parameterModel = parameterModel;
			_dataSource = parameterModel.DataSource;
		}
	}
	public class MonitoredGroupModel : MonitoredModel
	{
		private string name;

		private string comment;

		private bool showComments;

		private bool showUnits;

		private bool showSourceAddress;

		private string sortExpression;

		private Dictionary<string, int> columnWidths;

		private bool valueEnabled;

		private DataFormat radix;

		private SortedList calibrations;

		private bool isChanged;

		private bool addPending;

		private int uiRefreshRate = 100;

		private SortedList _members = new SortedList();

		private int dirtyReferenceCount;

		private int dataTableNameColumnChars;

		private int dataTableValueColumnChars;

		private int dataTableUnitColumnChars;

		private int dataTableCommentColumnChars;

		private bool _isDirty;

		public int DataTableNameColumnChars
		{
			get
			{
				return dataTableNameColumnChars;
			}
			set
			{
				if (value > dataTableNameColumnChars)
				{
					dataTableNameColumnChars = value;
				}
			}
		}

		public int DataTableValueColumnChars
		{
			get
			{
				return dataTableValueColumnChars;
			}
			set
			{
				dataTableValueColumnChars = value;
			}
		}

		public int DataTableUnitColumnChars
		{
			get
			{
				return dataTableUnitColumnChars;
			}
			set
			{
				if (value > dataTableUnitColumnChars)
				{
					dataTableUnitColumnChars = value;
				}
			}
		}

		public int DataTableCommentColumnChars
		{
			get
			{
				return dataTableCommentColumnChars;
			}
			set
			{
				if (value > dataTableCommentColumnChars)
				{
					dataTableCommentColumnChars = value;
				}
			}
		}

		protected int DirtyReferenceCount
		{
			get
			{
				return dirtyReferenceCount;
			}
			set
			{
				if (dirtyReferenceCount != value)
				{
					if (dirtyReferenceCount == 0 && value == 1)
					{
						IsDirty = true;
					}
					else if (dirtyReferenceCount != 0 && value == 0)
					{
						IsDirty = false;
					}
					dirtyReferenceCount = value;
				}
			}
		}

		public override string Name
		{
			get
			{
				return name;
			}
			set
			{
				name = value;
			}
		}

		public override string Comment
		{
			get
			{
				return comment;
			}
			set
			{
				comment = value;
			}
		}

		public bool ShowComments
		{
			get
			{
				return showComments;
			}
			set
			{
				showComments = value;
				RaiseChangeShowCommentsEvent(showComments);
			}
		}

		public bool ShowUnits
		{
			get
			{
				return showUnits;
			}
			set
			{
				if (showUnits != value)
				{
					showUnits = value;
					RaiseChangeShowUnitsEvent(showUnits);
					IsChanged = true;
				}
			}
		}

		public bool ShowSourceAddress
		{
			get
			{
				return showSourceAddress;
			}
			set
			{
				if (showSourceAddress != value)
				{
					showSourceAddress = value;
					RaiseChangeShowSourceAddressEvent(showSourceAddress);
					IsChanged = true;
				}
			}
		}

		public string SortExpression
		{
			get
			{
				return sortExpression;
			}
			set
			{
				try
				{
					sortExpression = value;
					RaiseChangeSortExpression(sortExpression);
					IsChanged = true;
				}
				catch
				{
				}
			}
		}

		public Dictionary<string, int> ColumnWidths
		{
			get
			{
				if (columnWidths == null)
				{
					columnWidths = new Dictionary<string, int>();
				}
				return columnWidths;
			}
			set
			{
				columnWidths = value;
			}
		}

		public bool ValueEnabled
		{
			get
			{
				return valueEnabled;
			}
			set
			{
				valueEnabled = value;
				RaiseChangeValueEnabledEvent(value);
			}
		}

		public DataFormat Radix
		{
			get
			{
				return radix;
			}
			set
			{
				DataFormat dataFormat = radix;
				radix = value;
				if (dataFormat != radix)
				{
					RaiseRadixChangedEvent(radix);
				}
			}
		}

		public SortedList Calibrations
		{
			get
			{
				if (calibrations == null)
				{
					calibrations = new SortedList();
				}
				return calibrations;
			}
			set
			{
				if (!value.Equals(calibrations))
				{
					calibrations = value;
					RaiseCalibrationsChangedEvent();
				}
			}
		}

		public virtual bool IsChanged
		{
			get
			{
				return isChanged;
			}
			set
			{
				isChanged = value;
			}
		}

		public virtual SortedList Members => _members;

		public virtual bool IsDirty
		{
			get
			{
				return _isDirty;
			}
			set
			{
				if (!value)
				{
					foreach (IParameterModel value2 in Members.Values)
					{
						if (!(value2 is IArrayModel))
						{
							value2.IsDirty = false;
						}
					}
				}
				_isDirty = value;
			}
		}

		public bool AddPending
		{
			get
			{
				return addPending;
			}
			set
			{
				if (value != addPending)
				{
					addPending = value;
					RaiseAddPendingChangedEvent();
				}
			}
		}

		internal virtual int UIRefreshRate
		{
			get
			{
				return uiRefreshRate;
			}
			set
			{
				if (value != UIRefreshRate)
				{
					uiRefreshRate = value;
					RaiseUIRefreshRateChangedEvent();
				}
			}
		}

		public event EventHandler CommentColumnCharsChangedEventHandler;

		public event EventHandler NameColumnCharsChangedEventHandler;

		public event EventHandler UnitColumnCharsChangedEventHandler;

		public event RadixEventHandler RadixChanged;

		public event ParameterEventHandler ParameterAdded;

		public event ParameterListEventHandler ParameterListAdded;

		public event ParameterEventHandler ParameterRemoved;

		public event EventHandler AllParametersRemoved;

		public event EventHandler ChangeShowCommentsState;

		public event EventHandler ChangeShowUnitsState;

		public event EventHandler ChangeShowSourceAddressState;

		public event EventHandler ChangeSortExpression;

		public event EventHandler PrepareToSaveSettings;

		public event EventHandler SettingsChanged;

		public event StateChangedEventHandler ChangeValueEnabled;

		public event EventHandler CalibrationsChangedEventHandler;

		internal event UIRefreshRateChangedEventHandler UIRefreshRateChangedEvent;

		public event EventHandler AddPendingChangedEvent;

		public MonitoredGroupModel()
			: base((ICalibration)null)
		{
			base.DataType = ParameterType.MonitoredGroup;
			Name = "Group";
			Comment = "Comment";
			valueEnabled = true;
			isChanged = false;
			showUnits = true;
			showSourceAddress = true;
			dataTableNameColumnChars = 4;
			dataTableValueColumnChars = 5;
			dataTableUnitColumnChars = 4;
			dataTableCommentColumnChars = 7;
		}

		public void Restore(NewDataSet.GroupRow groupRow)
		{
			try
			{
				Name = groupRow.Name;
				Comment = groupRow.Comment;
			}
			catch
			{
			}
			try
			{
				ShowUnits = groupRow.ShowUnits;
				ShowSourceAddress = groupRow.ShowSourceAddress;
			}
			catch
			{
				ShowUnits = true;
				ShowSourceAddress = true;
			}
			try
			{
				SortExpression = groupRow.SortExpression;
			}
			catch
			{
			}
			try
			{
				string text = groupRow.ColumnWidths;
				while (!string.IsNullOrEmpty(text))
				{
					int num = text.IndexOf(',');
					string text2;
					if (num >= 0)
					{
						text2 = text.Substring(0, num);
						text = text.Substring(num + 1);
					}
					else
					{
						text2 = text;
						text = string.Empty;
					}
					text2 = text2.Trim();
					num = text2.IndexOf('=');
					string text3 = text2.Substring(0, num);
					text3 = text3.Trim();
					text2 = text2.Substring(num + 1);
					int value = Convert.ToInt32(text2);
					ColumnWidths.Add(text3, value);
				}
			}
			catch
			{
			}
			RaiseSettingsChanged();
		}

		public void SaveSession(NewDataSet.GroupRow groupRow)
		{
			RaisePrepareToSaveSettings();
			groupRow.Name = Name;
			groupRow.Comment = Comment;
			groupRow.ShowUnits = ShowUnits;
			groupRow.ShowSourceAddress = ShowSourceAddress;
			groupRow.SortExpression = SortExpression;
			string text = string.Empty;
			bool flag = true;
			foreach (KeyValuePair<string, int> columnWidth in ColumnWidths)
			{
				if (!flag)
				{
					text += ',';
				}
				else
				{
					flag = false;
				}
				object obj = text;
				text = string.Concat(obj, columnWidth.Key, "=", columnWidth.Value);
			}
			groupRow.ColumnWidths = text;
		}

		public void Add(long parameterOrder, string parameterName, IAddressValue sourceAddress, IParameterModel parameter, bool isBroadcast)
		{
			if (parameter == null)
			{
				throw new ArgumentNullException("parameter");
			}
			if (parameter.DataSource.Connected)
			{
				Members.Add(parameterOrder + ":" + sourceAddress.Value + ":" + parameterName, parameter);
				RaiseAddParameterEvent(parameterOrder, parameter, parameterName, sourceAddress, isBroadcast);
				parameter.DirtyEventHandler += parameter_DirtyEventHandler;
			}
		}

		protected void parameter_DirtyEventHandler(object sender, EventArgs e)
		{
			if (((IParameterModel)sender).IsDirty)
			{
				DirtyReferenceCount++;
			}
			else
			{
				DirtyReferenceCount--;
			}
		}

		public void Add(ListDictionary parameters, bool isBroadcast, IAddressValue sourceAddress)
		{
			ListDictionary listDictionary = new ListDictionary();
			if (parameters == null)
			{
				throw new ArgumentNullException("parameters");
			}
			foreach (string key in parameters.Keys)
			{
				try
				{
					IParameterModel parameterModel = (IParameterModel)parameters[key];
					if (parameterModel != null && parameterModel.DataSource.Connected)
					{
						key.Split(new char[1] { ':' }, 3);
						listDictionary.Add(key, parameterModel);
						Members.Add(key, parameterModel);
						parameterModel.DirtyEventHandler += parameter_DirtyEventHandler;
					}
				}
				catch
				{
				}
			}
			RaiseAddParameterEvent(listDictionary, isBroadcast, sourceAddress);
		}

		public virtual void Remove(long order, string parameterName, IAddressValue sourceAddress, bool isBroadcast)
		{
			if (parameterName == null)
			{
				throw new ArgumentNullException("parameterName");
			}
			if (parameterName.Length == 0)
			{
				throw new ArgumentException("Empty string", "parameterName");
			}
			string key = order + ":" + sourceAddress.Value + ":" + parameterName;
			if (Members.Contains(key))
			{
				IParameterModel parameterModel = (IParameterModel)Members[key];
				if (parameterModel != null)
				{
					parameterModel.DirtyEventHandler -= parameter_DirtyEventHandler;
					RaiseRemoveParameterEvent(order, parameterModel, parameterName, sourceAddress, isBroadcast);
				}
				Members.Remove(key);
			}
		}

		public void RemoveAll()
		{
			foreach (IParameterModel value in Members.Values)
			{
				value.DirtyEventHandler -= parameter_DirtyEventHandler;
			}
			Members.Clear();
			RaiseRemoveAllParametersEvent();
		}

		public void RemoveAll(IAddressValue deviceAddress)
		{
			string value = ":" + deviceAddress.Value + ":";
			StringCollection stringCollection = new StringCollection();
			foreach (string key in Members.Keys)
			{
				if (key.IndexOf(value) != -1)
				{
					stringCollection.Add(key);
				}
			}
			StringEnumerator enumerator2 = stringCollection.GetEnumerator();
			try
			{
				while (enumerator2.MoveNext())
				{
					string current = enumerator2.Current;
					IParameterModel parameterModel = (IParameterModel)Members[current];
					if (parameterModel != null)
					{
						parameterModel.DirtyEventHandler -= parameter_DirtyEventHandler;
					}
					Members.Remove(current);
				}
			}
			finally
			{
				if (enumerator2 is IDisposable disposable)
				{
					disposable.Dispose();
				}
			}
		}

		public IParameterModel MemberByName(long order, string parameterName, IAddressValue sourceAddress)
		{
			if (parameterName == null)
			{
				throw new ArgumentNullException("parameterName");
			}
			if (parameterName.Length == 0)
			{
				throw new ArgumentException("Empty string", "parameterName");
			}
			IParameterModel parameterModel = null;
			return (IParameterModel)Members[order + ":" + sourceAddress.Value + ":" + parameterName];
		}

		public void SetArrayIndex(IArrayModel parameter, string parameterName, IAddressValue sourceAddress)
		{
			ICalibration calibration = (ICalibration)Calibrations[sourceAddress];
			IParameterSpecification specification = calibration.GetSpecification(parameterName);
			if (parameter is IArray2DModel)
			{
				IArray2DModel array2DModel = parameter as IArray2DModel;
				array2DModel.SetCurrentLocation(specification.X, specification.Y);
			}
			else if (parameter is IDataBlockModel)
			{
				IDataBlockModel dataBlockModel = parameter as IDataBlockModel;
				dataBlockModel.X = specification.X;
			}
			else if (parameter is IArray1DModel)
			{
				IArray1DModel array1DModel = parameter as IArray1DModel;
				array1DModel.X = specification.X;
			}
		}

		private void RaiseAddPendingChangedEvent()
		{
			if (this.AddPendingChangedEvent != null)
			{
				this.AddPendingChangedEvent(this, EventArgs.Empty);
			}
		}

		public void RaiseAddParameterEvent(long order, IParameterModel parameter, string parameterName, IAddressValue sourceAddress, bool isBroadcast)
		{
			if (this.ParameterAdded == null)
			{
				return;
			}
			ParameterEventArgs e = new ParameterEventArgs();
			e.Order = order;
			e.Name = parameterName;
			e.FullName = parameter.FullName;
			e.Units = parameter.EngineeringUnits;
			e.SourceAddress = sourceAddress;
			e.Type = parameter.DataType;
			e.Offset = parameter.Offset;
			e.Length = parameter.Length;
			e.ReadabilityCheckPassed = parameter.ReadabilityCheckPassed;
			e.ParameterModel = parameter;
			e.DataAccessType = FigureDataAccessType(parameter, isBroadcast);
			if (parameter is IDataBlockModel)
			{
				e.Length = 1u;
			}
			e.Address = 0u;
			try
			{
				if (parameter.DataType != ParameterType.Value && parameter.DataType != ParameterType.Enumeration)
				{
					e.Address = parameter.Address;
				}
			}
			catch
			{
			}
			this.ParameterAdded(this, e);
		}

		private DataAccessType FigureDataAccessType(IParameterModel parameter, bool isBroadcast)
		{
			DataAccessType result = DataAccessType.Proprietary;
			if (parameter is IPublicDataModel)
			{
				result = ((!isBroadcast) ? DataAccessType.PublicDataRequestReceive : DataAccessType.PublicDataBroadcast);
			}
			return result;
		}

		public void RaiseAddParameterEvent(ListDictionary parameters, bool isBroadcast, IAddressValue sourceAddress)
		{
			ParameterListEventArgs e = new ParameterListEventArgs(parameters, isBroadcast, sourceAddress);
			if (this.ParameterListAdded != null)
			{
				this.ParameterListAdded(this, e);
			}
		}

		protected void RaiseRemoveParameterEvent(long order, IParameterModel parameter, string parameterName, IAddressValue sourceAddress, bool isBroadcast)
		{
			ParameterEventArgs e = new ParameterEventArgs();
			e.Order = order;
			e.Name = parameterName;
			e.FullName = parameter.FullName;
			e.SourceAddress = sourceAddress;
			e.Type = parameter.DataType;
			e.Length = parameter.Length;
			e.ParameterModel = parameter;
			e.DataAccessType = FigureDataAccessType(parameter, isBroadcast);
			if (parameter is IDataBlockModel)
			{
				e.Length = 1u;
			}
			if (parameter is IArrayModel)
			{
				SetArrayIndex((IArrayModel)parameter, parameterName, sourceAddress);
			}
			e.Offset = parameter.Offset;
			try
			{
				if (parameter.DataType != ParameterType.Value && parameter.DataType != ParameterType.Enumeration)
				{
					e.Address = parameter.Address;
				}
			}
			catch
			{
			}
			if (this.ParameterRemoved != null)
			{
				this.ParameterRemoved(this, e);
			}
		}

		public void RaiseRemoveAllParametersEvent()
		{
			if (this.AllParametersRemoved != null)
			{
				this.AllParametersRemoved(this, EventArgs.Empty);
			}
		}

		public void RaiseChangeShowCommentsEvent(bool show)
		{
			if (this.ChangeShowCommentsState != null)
			{
				this.ChangeShowCommentsState(this, EventArgs.Empty);
			}
		}

		public void RaiseChangeShowUnitsEvent(bool show)
		{
			if (this.ChangeShowUnitsState != null)
			{
				this.ChangeShowUnitsState(this, EventArgs.Empty);
			}
		}

		public void RaiseChangeShowSourceAddressEvent(bool show)
		{
			if (this.ChangeShowSourceAddressState != null)
			{
				this.ChangeShowSourceAddressState(this, EventArgs.Empty);
			}
		}

		public void RaiseChangeSortExpression(string sortExpression)
		{
			if (this.ChangeSortExpression != null)
			{
				this.ChangeSortExpression(this, EventArgs.Empty);
			}
		}

		public void RaisePrepareToSaveSettings()
		{
			if (this.PrepareToSaveSettings != null)
			{
				this.PrepareToSaveSettings(this, EventArgs.Empty);
			}
		}

		public void RaiseSettingsChanged()
		{
			if (this.SettingsChanged != null)
			{
				this.SettingsChanged(this, EventArgs.Empty);
			}
		}

		public void RaiseRadixChangedEvent(DataFormat radix)
		{
			this.RadixChanged(this, new RadixEventArgs(radix));
		}

		public void RaiseChangeValueEnabledEvent(bool enable)
		{
			if (this.ChangeValueEnabled != null)
			{
				this.ChangeValueEnabled(this, new BooleanStateEventArgs(enable));
			}
		}

		public void RaiseCalibrationsChangedEvent()
		{
			if (this.CalibrationsChangedEventHandler != null)
			{
				this.CalibrationsChangedEventHandler(this, EventArgs.Empty);
			}
		}

		protected void RaiseUIRefreshRateChangedEvent()
		{
			if (this.UIRefreshRateChangedEvent != null)
			{
				UIRefreshRateChangedEventArgs e = new UIRefreshRateChangedEventArgs(UIRefreshRate);
				this.UIRefreshRateChangedEvent(this, e);
			}
		}

		protected void RaiseCommentColumnCharsChangedEvent()
		{
			if (this.CommentColumnCharsChangedEventHandler != null)
			{
				this.CommentColumnCharsChangedEventHandler(this, EventArgs.Empty);
			}
		}

		protected void RaiseNameColumnCharsChangedEvent()
		{
			if (this.NameColumnCharsChangedEventHandler != null)
			{
				this.NameColumnCharsChangedEventHandler(this, EventArgs.Empty);
			}
		}

		protected void RaiseUnitColumnCharsChangedEvent()
		{
			if (this.UnitColumnCharsChangedEventHandler != null)
			{
				this.UnitColumnCharsChangedEventHandler(this, EventArgs.Empty);
			}
		}
	}
	public class GraphicalMonitoredGroupModel : MonitoredGroupModel
	{
		internal const int MaxGauges = 6;

		private const string ConfigurationFileName = "Cummins.Editor.GraphConfiguration.xml";

		private const int DefaultGraphicalScreenUpdateRate = 250;

		private bool showGauges;

		private SortedList selectedColorList;

		private double timeUpperBound = 59.0;

		private double timeLowerBound;

		private double precisionTime = 0.25;

		private int historyCapacity = 240;

		private DataSet graphConfiguration;

		private NewDataSet.GaugeDataTable gaugeConfiguration;

		private ArrayList connectedDeviceList;

		private double currentTime;

		private SortedList deviceList;

		internal DataSet GraphConfiguration
		{
			get
			{
				if (graphConfiguration == null)
				{
					Stream manifestResourceStream = Assembly.GetExecutingAssembly().GetManifestResourceStream("Cummins.Editor.GraphConfiguration.xml");
					if (manifestResourceStream == null)
					{
						string message = "Unable to get embedded resource - Cummins.Editor.GraphConfiguration.xml";
						throw new ResourceException(Facility.Editor, 0, message);
					}
					graphConfiguration = new DataSet();
					graphConfiguration.ReadXml(manifestResourceStream);
					CreateParameterTable();
				}
				return graphConfiguration;
			}
		}

		internal NewDataSet.GaugeDataTable GaugeConfiguration
		{
			get
			{
				if (gaugeConfiguration == null)
				{
					gaugeConfiguration = new NewDataSet.GaugeDataTable();
					gaugeConfiguration.GaugeRowChanged += OnGaugeRowChanged;
				}
				return gaugeConfiguration;
			}
		}

		public bool ShowGauges
		{
			get
			{
				return showGauges;
			}
			set
			{
				if (value != showGauges)
				{
					showGauges = value;
					IsChanged = true;
				}
			}
		}

		internal double TimeLowerBound
		{
			get
			{
				return timeLowerBound;
			}
			set
			{
				timeLowerBound = value;
			}
		}

		internal double TimeUpperBound
		{
			get
			{
				return timeUpperBound;
			}
			set
			{
				timeUpperBound = value;
			}
		}

		internal SortedList SelectedColorList
		{
			get
			{
				if (selectedColorList == null)
				{
					selectedColorList = new SortedList();
				}
				return selectedColorList;
			}
		}

		internal int HistoryCapacity
		{
			get
			{
				return historyCapacity;
			}
			set
			{
				historyCapacity = value;
			}
		}

		internal double TimePrecision
		{
			get
			{
				return precisionTime;
			}
			set
			{
				precisionTime = value;
			}
		}

		internal override int UIRefreshRate
		{
			get
			{
				return base.UIRefreshRate;
			}
			set
			{
				if (value != base.UIRefreshRate && value != 0)
				{
					base.UIRefreshRate = value;
					TimePrecision = (double)value / 1000.0;
					HistoryCapacity = 600 * value;
				}
			}
		}

		internal ArrayList ConnectedDeviceList
		{
			get
			{
				if (connectedDeviceList == null)
				{
					connectedDeviceList = new ArrayList();
				}
				return connectedDeviceList;
			}
		}

		public SortedList DeviceList
		{
			get
			{
				if (deviceList == null)
				{
					deviceList = new SortedList();
				}
				return deviceList;
			}
		}

		public double CurrentTime
		{
			get
			{
				return currentTime;
			}
			set
			{
				currentTime = value;
			}
		}

		internal event EventHandler GraphConfigurationChangedEvent;

		public GraphicalMonitoredGroupModel()
		{
			base.DataType = ParameterType.GraphicalMonitorGroup;
			UIRefreshRate = 250;
		}

		protected void RaiseGraphConfigurationChangedEvent()
		{
			if (this.GraphConfigurationChangedEvent != null)
			{
				this.GraphConfigurationChangedEvent(this, EventArgs.Empty);
			}
		}

		private void CreateParameterTable()
		{
			DataTable dataTable = new DataTable("Parameters");
			DataColumn column = new DataColumn("SourceAddress");
			dataTable.Columns.Add(column);
			column = new DataColumn("Name");
			dataTable.Columns.Add(column);
			column = new DataColumn(GraphicalMonitoredGroupController.LowerBoundColumn, typeof(double));
			dataTable.Columns.Add(column);
			column = new DataColumn(GraphicalMonitoredGroupController.UpperBoundColumn, typeof(double));
			dataTable.Columns.Add(column);
			GraphConfiguration.Tables.Add(dataTable);
		}

		private void OnGaugeRowChanged(object sender, NewDataSet.GaugeRowChangeEvent e)
		{
			IsChanged = true;
		}

		public void RestoreGraphSettings(NewDataSet.GraphConfigurationRow graphConfigurationRow)
		{
			NewDataSet.GeneralRow[] generalRows = graphConfigurationRow.GetGeneralRows();
			if (generalRows.Length > 0)
			{
				NewDataSet.GeneralRow generalRow = generalRows[0];
				try
				{
					string iOCompSettings = generalRow.IOCompSettings;
					DataRow dataRow = null;
					dataRow = GraphConfiguration.Tables["General"].Rows[0];
					dataRow["IOCompSettings"] = iOCompSettings;
				}
				catch
				{
				}
			}
			RaiseGraphConfigurationChangedEvent();
		}

		public void AddDevice(string deviceHashNumber)
		{
			lock (DeviceList)
			{
				if (!DeviceList.Contains(deviceHashNumber))
				{
					DeviceDataPoints value = new DeviceDataPoints();
					DeviceList.Add(deviceHashNumber, value);
				}
			}
		}

		public void AddDataPoint(DataRefreshEventArgs e)
		{
			if (!DeviceList.ContainsKey(e.SubscriptionHashCode.ToString()))
			{
				try
				{
					AddDevice(e.SubscriptionHashCode.ToString());
				}
				catch (Exception e2)
				{
					EventLogger.Error("GraphicalEditor", "unable to create the device datapoints list", e2);
				}
			}
			lock (DeviceList)
			{
				DeviceDataPoints deviceDataPoints = (DeviceDataPoints)DeviceList[e.SubscriptionHashCode.ToString()];
				DateTime now = DateTime.Now;
				double num = 0.0;
				if (e is J1939_71DataRefreshEventArgs)
				{
					J1939_71DataRefreshEventArgs e3 = e as J1939_71DataRefreshEventArgs;
					if (e3.J1939_71Data.Count <= 0)
					{
						return;
					}
					num = e3.J1939_71Data[e3.J1939_71Data.Count - 1].TimeStamp;
					{
						foreach (PGNList j1939_71Datum in e3.J1939_71Data)
						{
							double num2 = j1939_71Datum.TimeStamp;
							int milliseconds = (int)(num - num2);
							TimeSpan timeSpan = new TimeSpan(0, 0, 0, 0, milliseconds);
							DateTime dateTime = now - timeSpan;
							J1939_71DataRefreshEventArgs e4 = new J1939_71DataRefreshEventArgs();
							e4.J1939_71Data = new List<PGNList>();
							e4.J1939_71Data.Add(j1939_71Datum);
							e4.SourceAddress = e.SourceAddress;
							e4.SubscriptionHashCode = e.SubscriptionHashCode;
							e4.ParameterCount = PCLSubscriptionBase.FigureParameterCount(e4.J1939_71Data);
							deviceDataPoints.addDataPoint(e4, dateTime.Ticks);
						}
						return;
					}
				}
				deviceDataPoints.addDataPoint(e, DateTime.Now.Ticks);
				DeviceList[e.SubscriptionHashCode.ToString()] = deviceDataPoints;
			}
		}

		public void OnGraphSettingChanged(object sender, EventArgs e)
		{
			IsChanged = true;
		}
	}
	internal enum YAxisDisplayType
	{
		Common,
		Hidden,
		Individual
	}
}
namespace Cummins.Parameter
{
	public class ParameterView : UserControl
	{
		private const double defaultAverageCharacterWidth = 10.0;

		protected const string TableDataTable = "DataTable";

		protected const string ColumnValue = "Value";

		private Font theFont;

		private double averageCharacterWidth;

		protected int minimumColumnWidth;

		private DataFormat dataViewFormat;

		private List<string> modifiedParams = new List<string>();

		private IIntegratedCalibration integratedCalibration;

		public virtual Panel Panel => null;

		protected double AverageCharacterWidth
		{
			get
			{
				if (averageCharacterWidth == 0.0)
				{
					if (theFont != null)
					{
						string text = "ABCDEFGHIJKLMNOPQRSTUVWXYZ_";
						int length = text.Length;
						Graphics val = ((Control)this).CreateGraphics();
						averageCharacterWidth = (double)(val.MeasureString(text, theFont).Width / (float)length) + 2.0;
					}
					else
					{
						averageCharacterWidth = 10.0;
					}
				}
				return averageCharacterWidth;
			}
		}

		protected int MinimumColumnWidth
		{
			get
			{
				if (minimumColumnWidth == 0)
				{
					minimumColumnWidth = (int)(6.0 * AverageCharacterWidth);
				}
				return minimumColumnWidth;
			}
		}

		public IIntegratedCalibration IntegratedCalibration
		{
			get
			{
				return integratedCalibration;
			}
			set
			{
				if (value != null)
				{
					integratedCalibration = value;
				}
			}
		}

		public DataFormat DataViewFormat
		{
			get
			{
				return dataViewFormat;
			}
			set
			{
				dataViewFormat = value;
			}
		}

		public List<string> ModifiedParameters => modifiedParams;

		public event EventHandler ShowPropertiesEvent;

		public ParameterView()
		{
			theFont = null;
			averageCharacterWidth = 0.0;
			minimumColumnWidth = 0;
			integratedCalibration = null;
		}

		public ParameterView(Font font)
		{
			theFont = font;
			averageCharacterWidth = 0.0;
			minimumColumnWidth = 0;
			integratedCalibration = null;
		}

		protected override void Dispose(bool disposing)
		{
			((ContainerControl)this).Dispose(disposing);
		}

		public virtual void SetSelectedParameter(string paramName)
		{
		}

		public virtual void SetDisplayMode(DataFormat dataFormat)
		{
		}

		protected virtual void OnListChanged(object sender, ListChangedEventArgs args)
		{
		}

		protected virtual void Properties_Click(object sender, EventArgs e)
		{
			if (this.ShowPropertiesEvent != null)
			{
				this.ShowPropertiesEvent(sender, e);
			}
		}

		protected int GetColumnWidth(string theString)
		{
			return GetColumnWidth(theString.Length);
		}

		protected int GetColumnWidth(int length)
		{
			int num = 0;
			if (length > 0)
			{
				num = (int)((double)length * AverageCharacterWidth);
			}
			if (num < MinimumColumnWidth)
			{
				num = MinimumColumnWidth;
			}
			return num;
		}

		protected void SetColumnStyle(DataGridTextBoxColumn columnStyle, string caption, string name, int width, bool readOnly)
		{
			((DataGridColumnStyle)columnStyle).HeaderText = caption;
			((DataGridColumnStyle)columnStyle).MappingName = name;
			((DataGridColumnStyle)columnStyle).Width = width;
			((DataGridColumnStyle)columnStyle).ReadOnly = readOnly;
		}

		protected virtual void OnDataLoadedEvent(object sender, EventArgs e)
		{
			if (!((Control)this).InvokeRequired)
			{
				InitializeView();
				return;
			}
			((Control)this).BeginInvoke((Delegate)new EventHandler(OnDataLoadedEvent), new object[2] { sender, e });
		}

		protected void AddModifiedParameter(string paramName)
		{
			if (!modifiedParams.Contains(paramName))
			{
				modifiedParams.Add(paramName);
			}
		}

		protected virtual void InitializeView()
		{
		}
	}
	public class GroupDataView : ParameterView
	{
		private const int valueColumnIndex = 2;

		protected GroupController controller;

		private CustomDataGrid dataGrid;

		private Panel panel;

		private TextBox textBoxComment;

		private TextBox editBox;

		private ComboBox comboBox;

		private CurrencyManager tableCurrency;

		private DataGridTextBoxColumn nameColumn;

		protected ColoredTextBoxColumn valueColumn;

		private DataGridTextBoxColumn unitColumn;

		private DataGridTextBoxColumn commentColumn;

		private Container components;

		private ContextMenu csmMenu;

		private int rowClicked;

		private bool comboBoxVisible;

		public override Panel Panel => panel;

		protected TextBox CommentLine => textBoxComment;

		public CustomDataGrid Grid => dataGrid;

		protected CurrencyManager TableCurrency
		{
			get
			{
				//IL_0024: Unknown result type (might be due to invalid IL or missing references)
				//IL_002e: Expected O, but got Unknown
				if (tableCurrency == null)
				{
					tableCurrency = (CurrencyManager)((Control)dataGrid).BindingContext[(object)controller.Data];
				}
				return tableCurrency;
			}
		}

		protected DataGridTextBoxColumn NameColumn
		{
			get
			{
				//IL_001e: Unknown result type (might be due to invalid IL or missing references)
				//IL_0028: Expected O, but got Unknown
				if (nameColumn == null)
				{
					nameColumn = new DataGridTextBoxColumn(((BindingManagerBase)TableCurrency).GetItemProperties()["Name"]);
					((DataGridColumnStyle)nameColumn).NullText = "";
				}
				return nameColumn;
			}
		}

		protected virtual ColoredTextBoxColumn ValueColumn
		{
			get
			{
				if (valueColumn == null)
				{
					valueColumn = new ColoredTextBoxColumn((DataGrid)(object)Grid, ((BindingManagerBase)TableCurrency).GetItemProperties()["Value"]);
					((DataGridColumnStyle)valueColumn).NullText = "";
				}
				return valueColumn;
			}
		}

		protected DataGridTextBoxColumn UnitColumn
		{
			get
			{
				//IL_001e: Unknown result type (might be due to invalid IL or missing references)
				//IL_0028: Expected O, but got Unknown
				if (unitColumn == null)
				{
					unitColumn = new DataGridTextBoxColumn(((BindingManagerBase)TableCurrency).GetItemProperties()["Unit"]);
					((DataGridColumnStyle)unitColumn).NullText = "";
					((DataGridColumnStyle)unitColumn).ReadOnly = true;
				}
				return unitColumn;
			}
		}

		protected DataGridTextBoxColumn CommentColumn
		{
			get
			{
				//IL_001e: Unknown result type (might be due to invalid IL or missing references)
				//IL_0028: Expected O, but got Unknown
				if (commentColumn == null)
				{
					commentColumn = new DataGridTextBoxColumn(((BindingManagerBase)TableCurrency).GetItemProperties()["Comment"]);
					((DataGridColumnStyle)commentColumn).NullText = "";
					((DataGridColumnStyle)commentColumn).ReadOnly = true;
				}
				return commentColumn;
			}
		}

		protected TextBox EditBox => editBox;

		protected ComboBox DropDownList => comboBox;

		protected bool ComboBoxVisible
		{
			get
			{
				return comboBoxVisible;
			}
			set
			{
				comboBoxVisible = value;
			}
		}

		protected GroupController Controller => controller;

		protected virtual int CurrentRowIndex => ((DataGrid)Grid).CurrentRowIndex;

		public GroupDataView()
		{
			InitializeComponent();
		}

		public GroupDataView(GroupController groupController, Font font)
			: base(font)
		{
			//IL_001c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0026: Expected O, but got Unknown
			//IL_0043: Unknown result type (might be due to invalid IL or missing references)
			//IL_004d: Expected O, but got Unknown
			//IL_006b: Unknown result type (might be due to invalid IL or missing references)
			//IL_0075: Expected O, but got Unknown
			//IL_0093: Unknown result type (might be due to invalid IL or missing references)
			//IL_009d: Expected O, but got Unknown
			//IL_00bc: Unknown result type (might be due to invalid IL or missing references)
			//IL_00c6: Expected O, but got Unknown
			//IL_01a5: Unknown result type (might be due to invalid IL or missing references)
			//IL_01af: Expected O, but got Unknown
			try
			{
				controller = groupController;
				rowClicked = -1;
				InitializeComponent();
				csmMenu = new ContextMenu();
				((Menu)csmMenu).MenuItems.Add(0, new MenuItem("Copy", (EventHandler)Copy_Click));
				((Menu)csmMenu).MenuItems.Add(1, new MenuItem("Paste", (EventHandler)Paste_Click));
				((Menu)csmMenu).MenuItems.Add(2, new MenuItem("Undo", (EventHandler)Undo_Click));
				((Menu)csmMenu).MenuItems.Add(3, new MenuItem("Properties", (EventHandler)Properties_Click));
				((Control)dataGrid).ContextMenu = csmMenu;
				try
				{
					((Control)textBoxComment).Text = controller.Comment;
				}
				catch
				{
				}
				InitializeView();
				controller.DataLoadedEvent += OnDataLoadedEvent;
				((Control)NameColumn.TextBox).ContextMenu = csmMenu;
				((Control)((DataGridTextBoxColumn)ValueColumn).TextBox).ContextMenu = csmMenu;
				((Control)UnitColumn.TextBox).ContextMenu = csmMenu;
				((Control)CommentColumn.TextBox).ContextMenu = csmMenu;
				controller.CellChangedEvent += OnCellChanged;
				controller.RowRemovedEvent += OnRowRemoved;
				((Control)dataGrid).MouseDown += new MouseEventHandler(OnMouseDown);
				controller.AllCellsUnmodifiedEvent += OnAllCellsUnmodified;
				((Control)((DataGridTextBoxColumn)ValueColumn).TextBox).Enter += OnValueColumnEnter;
				DropDownList.SelectionChangeCommitted += OnDropDownListChanged;
				((Control)DropDownList).LostFocus += OnDropDownListLostFocus;
				if (groupController is MonitoredGroupController)
				{
					(groupController as MonitoredGroupController).CalibrationListChanged += GroupDataView_CalibrationListChanged;
				}
			}
			catch (Exception ex)
			{
				_ = ex.Message;
			}
		}

		private void GroupDataView_CalibrationListChanged(object sender, EventArgs e)
		{
			if (controller.Model.Calibrations.Count > 0 && controller.Model.Calibrations.GetByIndex(0) is ICalibrationOnline)
			{
				ValueColumn.MonitorUpdateRate = true;
			}
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		public override void SetSelectedParameter(string paramName)
		{
			try
			{
				int memberIndex = controller.GetMemberIndex(paramName);
				if (memberIndex > -1)
				{
					if (((DataGrid)dataGrid).CurrentRowIndex > -1)
					{
						((DataGrid)dataGrid).UnSelect(((DataGrid)dataGrid).CurrentRowIndex);
					}
					((DataGrid)dataGrid).CurrentRowIndex = memberIndex;
					((DataGrid)dataGrid).Select(((DataGrid)dataGrid).CurrentRowIndex);
					return;
				}
				throw new NotImplementedException("GroupDataView.SetSelectedParameter(): Parameter not found in group.");
			}
			catch
			{
			}
		}

		public override void SetDisplayMode(DataFormat dataFormat)
		{
			base.DataViewFormat = dataFormat;
			SetColumnStyles();
		}

		protected void Copy_Click(object sender, EventArgs e)
		{
			try
			{
				dataGrid.Copy();
			}
			catch
			{
			}
		}

		protected void Paste_Click(object sender, EventArgs e)
		{
			try
			{
				dataGrid.Paste();
			}
			catch
			{
			}
		}

		protected void Undo_Click(object sender, EventArgs e)
		{
			_ = rowClicked;
			_ = -1;
			controller.Undo();
		}

		protected override void Properties_Click(object sender, EventArgs e)
		{
			if (rowClicked == -1)
			{
				base.Properties_Click(this, e);
				return;
			}
			try
			{
				Parameter parameter = new Parameter(controller.GetMemberParameter(rowClicked));
				parameter.ShowPropertiesView();
			}
			catch (Exception)
			{
			}
		}

		protected void OnValueColumnEnter(object sender, EventArgs e)
		{
			if (GetParameterType() == ParameterType.Enumeration && Controller.DisplayFormat == DataFormat.Decimal)
			{
				ShowComboBox();
			}
		}

		protected void OnDropDownListChanged(object sender, EventArgs e)
		{
			BindingManagerBase val = ((Control)this).BindingContext[((DataGrid)Grid).DataSource, ((DataGrid)Grid).DataMember];
			DataRowView dataRowView = (DataRowView)val.Current;
			dataRowView["Value"] = ((Control)DropDownList).Text;
		}

		protected void OnDropDownListLostFocus(object sender, EventArgs e)
		{
			((Control)DropDownList).SendToBack();
			((Control)DropDownList).Hide();
		}

		protected ParameterType GetParameterType()
		{
			ParameterType result = ParameterType.Value;
			IParameterModel parameterModel = null;
			parameterModel = Controller.GetMemberParameter(CurrentRowIndex);
			if (parameterModel != null)
			{
				result = parameterModel.DataType;
			}
			return result;
		}

		protected void ShowComboBox()
		{
			//IL_0030: Unknown result type (might be due to invalid IL or missing references)
			//IL_0158: Unknown result type (might be due to invalid IL or missing references)
			IEnumerationModel enumerationModel = (IEnumerationModel)Controller.GetMemberParameter(CurrentRowIndex);
			if (enumerationModel == null)
			{
				return;
			}
			ComboBoxVisible = true;
			Rectangle cellBounds = ((DataGrid)Grid).GetCellBounds(((DataGrid)Grid).CurrentCell);
			((Control)DropDownList).Location = new Point(cellBounds.X + ((Control)Grid).Location.X, cellBounds.Y + ((Control)Grid).Location.Y);
			int num = 0;
			try
			{
				for (int i = 0; i < enumerationModel.Enumerations.Keys.Count; i++)
				{
					string text = (string)enumerationModel.Enumerations.GetByIndex(i);
					if (num < text.Length)
					{
						float sizeInPoints = ((Control)DropDownList).Font.SizeInPoints;
						num = (int)((float)text.Length * sizeInPoints) + 30;
					}
				}
			}
			catch (Exception ex)
			{
				EventLogger.Info("click", ex.Message);
				num = ((Control)DropDownList).Size.Width;
			}
			((Control)DropDownList).Size = new Size(num, ((Control)DropDownList).Size.Height);
			DropDownList.DataSource = enumerationModel.Enumerations.Values;
			((Control)DropDownList).Text = ((DataGrid)Grid)[((DataGrid)Grid).CurrentCell].ToString();
			((Control)DropDownList).Show();
			((Control)DropDownList).BringToFront();
			((Control)DropDownList).Focus();
		}

		protected override void InitializeView()
		{
			//IL_0075: Unknown result type (might be due to invalid IL or missing references)
			//IL_007b: Expected O, but got Unknown
			try
			{
				_ = controller.Data;
				if (controller.DataTableLoaded)
				{
					((DataGrid)dataGrid).DataSource = controller.Data;
					((DataGrid)dataGrid).AllowSorting = false;
					((DataGrid)dataGrid).CaptionText = controller.Name;
					CurrencyManager val = (CurrencyManager)((Control)this).BindingContext[((DataGrid)dataGrid).DataSource, ((DataGrid)dataGrid).DataMember];
					((DataView)val.List).AllowNew = false;
					((DataView)val.List).AllowDelete = false;
					SetColumnStyles();
				}
			}
			catch (Exception e)
			{
				EventLogger.Error("GroupDataView", "Exception in updating the view after data change ", e);
			}
		}

		protected void SetColumnStyles()
		{
			//IL_001c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0022: Expected O, but got Unknown
			((DataGrid)dataGrid).TableStyles.Clear();
			DataTable data = controller.Data;
			DataGridTableStyle val = new DataGridTableStyle();
			val.MappingName = data.TableName;
			val.AllowSorting = false;
			PopulateColumnStyles(val);
			((DataGrid)dataGrid).TableStyles.Add(val);
		}

		protected virtual void PopulateColumnStyles(DataGridTableStyle tableStyle)
		{
			DataTable data = controller.Data;
			SetColumnStyle(NameColumn, data.Columns["Name"].Caption, "Name", GetColumnWidth(controller.DataTableNameColumnChars), data.Columns["Name"].ReadOnly);
			tableStyle.GridColumnStyles.Add((DataGridColumnStyle)(object)NameColumn);
			SetColumnStyle((DataGridTextBoxColumn)(object)ValueColumn, data.Columns["Value"].Caption, "Value", GetColumnWidth(controller.DataTableValueColumnChars), data.Columns["Value"].ReadOnly);
			tableStyle.GridColumnStyles.Add((DataGridColumnStyle)(object)ValueColumn);
			SetColumnStyle(UnitColumn, data.Columns["Unit"].Caption, "Unit", GetColumnWidth(controller.DataTableUnitColumnChars), data.Columns["Unit"].ReadOnly);
			tableStyle.GridColumnStyles.Add((DataGridColumnStyle)(object)UnitColumn);
			SetColumnStyle(CommentColumn, data.Columns["Comment"].Caption, "Comment", GetColumnWidth(controller.DataTableCommentColumnChars), data.Columns["Comment"].ReadOnly);
			tableStyle.GridColumnStyles.Add((DataGridColumnStyle)(object)CommentColumn);
		}

		protected virtual void OnCellChanged(object sender, DataColumnChangeEventArgs e)
		{
			ColoredTextBoxColumn coloredTextBoxColumn = (ColoredTextBoxColumn)(object)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles[e.Column.ColumnName];
			AddModifiedParameter(e.Row["Name"].ToString().Trim());
			int num = 0;
			num = ((e.Row["Index"] == DBNull.Value) ? ((DataGrid)dataGrid).CurrentRowIndex : ((int)e.Row["Index"]));
			coloredTextBoxColumn.ShowCellModified(num);
		}

		private void OnRowRemoved(object sender, EventArgs e)
		{
			ColoredTextBoxColumn coloredTextBoxColumn = (ColoredTextBoxColumn)(object)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles["Value"];
			int currentRowIndex = CurrentRowIndex;
			coloredTextBoxColumn.ShowCellUnmodified(currentRowIndex);
		}

		private void OnMouseDown(object sender, MouseEventArgs e)
		{
			//IL_0028: Unknown result type (might be due to invalid IL or missing references)
			//IL_002e: Invalid comparison between Unknown and I4
			//IL_0031: Unknown result type (might be due to invalid IL or missing references)
			//IL_0037: Invalid comparison between Unknown and I4
			rowClicked = -1;
			Point point = new Point(e.X, e.Y);
			HitTestInfo val = ((DataGrid)dataGrid).HitTest(point);
			if ((int)val.Type == 4 || (int)val.Type == 1)
			{
				rowClicked = val.Row;
			}
		}

		private void OnAllCellsUnmodified(object sender, EventArgs e)
		{
			ColoredTextBoxColumn coloredTextBoxColumn = (ColoredTextBoxColumn)(object)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles["Value"];
			coloredTextBoxColumn.ShowAllCellsUnmodified();
		}

		private void InitializeComponent()
		{
			//IL_0001: Unknown result type (might be due to invalid IL or missing references)
			//IL_000b: Expected O, but got Unknown
			//IL_000c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0016: Expected O, but got Unknown
			//IL_0017: Unknown result type (might be due to invalid IL or missing references)
			//IL_0021: Expected O, but got Unknown
			//IL_002d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0037: Expected O, but got Unknown
			panel = new Panel();
			editBox = new TextBox();
			comboBox = new ComboBox();
			dataGrid = new CustomDataGrid();
			textBoxComment = new TextBox();
			((Control)panel).SuspendLayout();
			((ISupportInitialize)dataGrid).BeginInit();
			((Control)this).SuspendLayout();
			((Control)panel).Controls.Add((Control)(object)editBox);
			((Control)panel).Controls.Add((Control)(object)comboBox);
			((Control)panel).Controls.Add((Control)(object)dataGrid);
			((Control)panel).Controls.Add((Control)(object)textBoxComment);
			((Control)panel).Dock = (DockStyle)5;
			((Control)panel).Location = new Point(0, 0);
			((Control)panel).Name = "panel";
			((Control)panel).Size = new Size(536, 328);
			((Control)panel).TabIndex = 0;
			((TextBoxBase)editBox).BorderStyle = (BorderStyle)0;
			((Control)editBox).Location = new Point(194, 157);
			((Control)editBox).Name = "editBox";
			((Control)editBox).TabIndex = 2;
			((Control)editBox).Text = "";
			((Control)editBox).Visible = false;
			comboBox.DropDownStyle = (ComboBoxStyle)2;
			((Control)comboBox).Location = new Point(194, 157);
			((Control)comboBox).Name = "comboBox";
			((Control)comboBox).Size = new Size(121, 21);
			((Control)comboBox).TabIndex = 3;
			((Control)comboBox).Visible = false;
			dataGrid.AddRowWhilePaste = false;
			((Control)dataGrid).Anchor = (AnchorStyles)15;
			((DataGrid)dataGrid).DataMember = "";
			((DataGrid)dataGrid).HeaderForeColor = SystemColors.ControlText;
			((Control)dataGrid).Location = new Point(8, 40);
			((Control)dataGrid).Name = "dataGrid";
			((Control)dataGrid).Size = new Size(520, 280);
			((Control)dataGrid).TabIndex = 1;
			((Control)textBoxComment).Location = new Point(8, 8);
			((Control)textBoxComment).Name = "textBoxComment";
			((TextBoxBase)textBoxComment).ReadOnly = true;
			((Control)textBoxComment).Size = new Size(344, 20);
			((Control)textBoxComment).TabIndex = 0;
			((Control)textBoxComment).Text = "Comment";
			((Control)this).Controls.Add((Control)(object)panel);
			((Control)this).Name = "GroupDataView";
			((Control)this).Size = new Size(536, 328);
			((Control)panel).ResumeLayout(false);
			((ISupportInitialize)dataGrid).EndInit();
			((Control)this).ResumeLayout(false);
		}

		protected override bool ProcessCmdKey(ref Message m, Keys keyData)
		{
			//IL_000f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0010: Unknown result type (might be due to invalid IL or missing references)
			//IL_0016: Unknown result type (might be due to invalid IL or missing references)
			//IL_001c: Invalid comparison between Unknown and I4
			//IL_0325: Unknown result type (might be due to invalid IL or missing references)
			//IL_032b: Unknown result type (might be due to invalid IL or missing references)
			//IL_0331: Invalid comparison between Unknown and I4
			//IL_0021: Unknown result type (might be due to invalid IL or missing references)
			//IL_0024: Invalid comparison between Unknown and I4
			//IL_035b: Unknown result type (might be due to invalid IL or missing references)
			//IL_0333: Unknown result type (might be due to invalid IL or missing references)
			//IL_0336: Invalid comparison between Unknown and I4
			//IL_006e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0073: Unknown result type (might be due to invalid IL or missing references)
			//IL_0083: Unknown result type (might be due to invalid IL or missing references)
			//IL_0088: Unknown result type (might be due to invalid IL or missing references)
			//IL_0026: Unknown result type (might be due to invalid IL or missing references)
			//IL_0029: Invalid comparison between Unknown and I4
			//IL_016b: Unknown result type (might be due to invalid IL or missing references)
			//IL_016e: Invalid comparison between Unknown and I4
			//IL_01bc: Unknown result type (might be due to invalid IL or missing references)
			//IL_01bf: Invalid comparison between Unknown and I4
			//IL_028e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0291: Invalid comparison between Unknown and I4
			//IL_02e9: Unknown result type (might be due to invalid IL or missing references)
			//IL_02ec: Invalid comparison between Unknown and I4
			//IL_0225: Unknown result type (might be due to invalid IL or missing references)
			//IL_0228: Invalid comparison between Unknown and I4
			try
			{
				Keys val = (Keys)((Message)(ref m)).WParam.ToInt32();
				if ((keyData & 0x40000) == 262144 && ((int)val == 38 || (int)val == 40))
				{
					Controller.IsUpDownOperation = true;
					BindingManagerBase val2 = ((Control)this).BindingContext[((DataGrid)dataGrid).DataSource, ((DataGrid)dataGrid).DataMember];
					DataRowView dataRowView = (DataRowView)val2.Current;
					DataGridCell currentCell = ((DataGrid)dataGrid).CurrentCell;
					int columnNumber = ((DataGridCell)(ref currentCell)).ColumnNumber;
					DataGridCell currentCell2 = ((DataGrid)dataGrid).CurrentCell;
					int rowNumber = ((DataGridCell)(ref currentCell2)).RowNumber;
					DataRow dataRow = controller.Data.Rows[rowNumber];
					if (columnNumber == 2 && !dataRow.IsNull("Name") && dataRow["Value"].ToString() != string.Empty)
					{
						IParameterModel memberParameter = controller.GetMemberParameter(dataRowView.Row);
						string parameterName = (string)dataRowView.Row["Name"];
						IParameterSpecification specification = memberParameter.DataSource.GetSpecification(parameterName);
						if (specification.Type != AccessModeType.Invalid)
						{
							parameterName = specification.FullName;
						}
						switch (memberParameter.DataType)
						{
						case ParameterType.Value:
						{
							IValueModel model = (IValueModel)memberParameter;
							if ((int)val == 38)
							{
								IncValue(model);
							}
							else
							{
								DecValue(model);
							}
							dataRow[columnNumber] = controller.GetValueByDataFormat(model);
							break;
						}
						case ParameterType.ArrayXAxis:
						{
							IArray1DModel array1DModel2 = (IArray1DModel)memberParameter;
							array1DModel2.X = specification.X;
							int rawValue = array1DModel2.GetRawValue();
							rawValue = (((int)val != 38) ? (rawValue - 1) : (rawValue + 1));
							array1DModel2.SetRawValue(rawValue);
							dataRow[columnNumber] = array1DModel2.ScaledValue;
							break;
						}
						case ParameterType.Array1D:
						{
							IArray1DModel array1DModel = (IArray1DModel)memberParameter;
							array1DModel.X = specification.X;
							int rawValue = ((!(memberParameter is IDataBlockModel)) ? array1DModel.GetRawValue() : (memberParameter as IDataBlockModel).GetRawValue());
							rawValue = (((int)val != 38) ? (rawValue - 1) : (rawValue + 1));
							if (memberParameter is IDataBlockModel)
							{
								(memberParameter as IDataBlockModel).SetRawValue(rawValue);
							}
							else
							{
								array1DModel.SetRawValue(rawValue);
							}
							dataRow[columnNumber] = array1DModel.ScaledValue;
							break;
						}
						case ParameterType.ArrayXY:
						{
							IArrayXYModel arrayXYModel = (IArrayXYModel)memberParameter;
							arrayXYModel.X = specification.X;
							int rawValue = arrayXYModel.GetRawValue();
							rawValue = (((int)val != 38) ? (rawValue - 1) : (rawValue + 1));
							arrayXYModel.SetRawValue(rawValue);
							dataRow[columnNumber] = arrayXYModel.ScaledValue;
							break;
						}
						case ParameterType.ArrayXYZ:
						{
							IArrayXYZModel arrayXYZModel = (IArrayXYZModel)memberParameter;
							arrayXYZModel.X = specification.X;
							arrayXYZModel.Y = specification.Y;
							int rawValue = arrayXYZModel.GetRawValue();
							rawValue = (((int)val != 38) ? (rawValue - 1) : (rawValue + 1));
							arrayXYZModel.SetRawValue(rawValue);
							dataRow[columnNumber] = arrayXYZModel.ScaledValue;
							break;
						}
						}
						Controller.IsUpDownOperation = false;
						return true;
					}
				}
				if ((keyData & 0x20000) == 131072 && (int)val == 73)
				{
					Properties_Click(this, null);
					return true;
				}
			}
			catch (ArrayNotInAscendingOrderException)
			{
			}
			catch (Exception innerException)
			{
				throw new Exception("Exception", innerException);
			}
			return ((ContainerControl)this).ProcessCmdKey(ref m, keyData);
		}

		protected static IValueModel IncValue(IValueModel model)
		{
			try
			{
				if (1 != model.ConfigFileType)
				{
					model.SetRawValue(model.GetRawValue() + 1);
				}
				else
				{
					model.ScaledFloat(model.ScaledFloat() + model.MinResolution);
				}
			}
			catch (Exception ex)
			{
				EventLogger.Error(Facility.Parameter.ToString(), ex.Message, ex.InnerException);
			}
			return model;
		}

		protected static IValueModel DecValue(IValueModel model)
		{
			try
			{
				if (1 != model.ConfigFileType)
				{
					model.SetRawValue(model.GetRawValue() - 1);
				}
				else
				{
					model.ScaledFloat(model.ScaledFloat() - model.MinResolution);
				}
			}
			catch (Exception ex)
			{
				EventLogger.Error(Facility.Parameter.ToString(), ex.Message, ex.InnerException);
			}
			return model;
		}
	}
}
namespace Cummins.Editor
{
	public class MonitoredGroupView : GroupDataView
	{
		private delegate void AddMulitipleParametersDelegate();

		protected const int ValueColumnwidthDec = 75;

		protected const int ValueColumnwidthHex = 75;

		protected const int ValueColumnwidthBin = 235;

		protected const int ValueIndex = 2;

		protected const int NameColumnwidth = 200;

		protected const int TimerDefaultInterval = 20;

		private MonitoredGroupController groupController;

		private bool editBoxVisible;

		private DataGridTextBoxColumn sourceAddressColumn;

		private DataGridTextBoxColumn changedColumn;

		private int currentEditedColumn;

		private int currentEditedRow;

		private bool shouldCommit;

		private Point MouseDownPoint;

		private Timer timer1;

		protected CurrencyManager cm;

		private StringCollection parametersPasted;

		private MenuItem _sourceAddressMenuItem;

		private MenuItem _unitsMenuItem;

		private Point _contextMouseDown;

		protected override int CurrentRowIndex
		{
			get
			{
				int result = -1;
				try
				{
					DataRowView dataRowView = (DataRowView)((BindingManagerBase)cm).Current;
					result = (int)dataRowView["Order"];
					DataRow dataRow = null;
					try
					{
						dataRow = MonitoredController.Data.Select("Order =" + result)[0];
					}
					catch
					{
					}
					if (dataRow == null)
					{
						MonitoredController.Data.Rows.Add(dataRowView.Row);
						MonitoredController.Data.AcceptChanges();
					}
				}
				catch
				{
				}
				return result;
			}
		}

		protected MonitoredGroupController MonitoredController => groupController;

		private bool EditBoxVisible
		{
			get
			{
				return editBoxVisible;
			}
			set
			{
				editBoxVisible = value;
			}
		}

		protected DataGridTextBoxColumn SourceAddressColumn
		{
			get
			{
				//IL_001e: Unknown result type (might be due to invalid IL or missing references)
				//IL_0028: Expected O, but got Unknown
				if (sourceAddressColumn == null)
				{
					sourceAddressColumn = new DataGridTextBoxColumn(((BindingManagerBase)base.TableCurrency).GetItemProperties()["SourceAddress"]);
					((DataGridColumnStyle)sourceAddressColumn).ReadOnly = false;
					((DataGridColumnStyle)sourceAddressColumn).NullText = "";
				}
				return sourceAddressColumn;
			}
		}

		protected override ColoredTextBoxColumn ValueColumn
		{
			get
			{
				if (valueColumn == null)
				{
					IAppConfigService appConfigService = (IAppConfigService)ServiceManager.Services.GetService(typeof(IAppConfigService));
					if (bool.Parse(appConfigService.GetAppSetting(ApplicationSettings.GreyOutUnchangedData)))
					{
						valueColumn = new MonitorColoredTextBoxColumn((DataGrid)(object)base.Grid, ((BindingManagerBase)base.TableCurrency).GetItemProperties()["Value"]);
					}
					else
					{
						valueColumn = new ColoredTextBoxColumn((DataGrid)(object)base.Grid, ((BindingManagerBase)base.TableCurrency).GetItemProperties()["Value"]);
					}
					((DataGridColumnStyle)valueColumn).NullText = "";
				}
				return valueColumn;
			}
		}

		protected DataGridTextBoxColumn ChangedColumn
		{
			get
			{
				//IL_001e: Unknown result type (might be due to invalid IL or missing references)
				//IL_0028: Expected O, but got Unknown
				if (changedColumn == null)
				{
					changedColumn = new DataGridTextBoxColumn(((BindingManagerBase)base.TableCurrency).GetItemProperties()["Changed"]);
					((DataGridColumnStyle)changedColumn).ReadOnly = false;
				}
				return changedColumn;
			}
		}

		public bool ShowUnits
		{
			get
			{
				return MonitoredController.MonitoredModel.ShowUnits;
			}
			set
			{
				MonitoredController.MonitoredModel.ShowUnits = value;
				UnitsDisplay = value;
			}
		}

		private bool UnitsDisplay
		{
			set
			{
				if (value)
				{
					((DataGridColumnStyle)base.UnitColumn).MappingName = "Unit";
				}
				else
				{
					((DataGridColumnStyle)base.UnitColumn).MappingName = "";
				}
			}
		}

		public bool ShowSourceAddress
		{
			get
			{
				return MonitoredController.MonitoredModel.ShowSourceAddress;
			}
			set
			{
				MonitoredController.MonitoredModel.ShowSourceAddress = value;
				SourceAddressDisplay = value;
			}
		}

		private bool SourceAddressDisplay
		{
			set
			{
				if (value)
				{
					((DataGridColumnStyle)SourceAddressColumn).MappingName = "SourceAddress";
				}
				else
				{
					((DataGridColumnStyle)SourceAddressColumn).MappingName = "";
				}
			}
		}

		public event EventHandler BeforeParameterListAddingEvent;

		public event EventHandler GotFocus;

		public event KeyEventHandler GridKeyDown
		{
			add
			{
				base.Grid.GridKeyDown += value;
			}
			remove
			{
				base.Grid.GridKeyDown -= value;
			}
		}

		public MonitoredGroupView()
		{
		}

		public MonitoredGroupView(MonitoredGroupController groupController, Font font)
			: base(groupController, font)
		{
			//IL_0009: Unknown result type (might be due to invalid IL or missing references)
			//IL_0013: Expected O, but got Unknown
			//IL_0090: Unknown result type (might be due to invalid IL or missing references)
			//IL_009a: Expected O, but got Unknown
			//IL_02dd: Unknown result type (might be due to invalid IL or missing references)
			//IL_02e7: Expected O, but got Unknown
			//IL_02f9: Unknown result type (might be due to invalid IL or missing references)
			//IL_0303: Expected O, but got Unknown
			//IL_0315: Unknown result type (might be due to invalid IL or missing references)
			//IL_031f: Expected O, but got Unknown
			//IL_0331: Unknown result type (might be due to invalid IL or missing references)
			//IL_033b: Expected O, but got Unknown
			//IL_034d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0357: Expected O, but got Unknown
			//IL_0369: Unknown result type (might be due to invalid IL or missing references)
			//IL_0373: Expected O, but got Unknown
			//IL_03b7: Unknown result type (might be due to invalid IL or missing references)
			//IL_03c1: Expected O, but got Unknown
			//IL_03fb: Unknown result type (might be due to invalid IL or missing references)
			//IL_0405: Expected O, but got Unknown
			//IL_0417: Unknown result type (might be due to invalid IL or missing references)
			//IL_0421: Expected O, but got Unknown
			//IL_0433: Unknown result type (might be due to invalid IL or missing references)
			//IL_043d: Expected O, but got Unknown
			//IL_044f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0459: Expected O, but got Unknown
			//IL_046b: Unknown result type (might be due to invalid IL or missing references)
			//IL_0475: Expected O, but got Unknown
			//IL_0487: Unknown result type (might be due to invalid IL or missing references)
			//IL_0491: Expected O, but got Unknown
			//IL_049f: Unknown result type (might be due to invalid IL or missing references)
			//IL_04a9: Expected O, but got Unknown
			//IL_04bc: Unknown result type (might be due to invalid IL or missing references)
			//IL_04c6: Expected O, but got Unknown
			//IL_04d9: Unknown result type (might be due to invalid IL or missing references)
			//IL_04e3: Expected O, but got Unknown
			//IL_04f6: Unknown result type (might be due to invalid IL or missing references)
			//IL_0500: Expected O, but got Unknown
			//IL_0513: Unknown result type (might be due to invalid IL or missing references)
			//IL_051d: Expected O, but got Unknown
			//IL_0530: Unknown result type (might be due to invalid IL or missing references)
			//IL_053a: Expected O, but got Unknown
			//IL_0645: Unknown result type (might be due to invalid IL or missing references)
			//IL_064b: Expected O, but got Unknown
			//IL_065d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0667: Expected O, but got Unknown
			//IL_069c: Unknown result type (might be due to invalid IL or missing references)
			//IL_06a6: Expected O, but got Unknown
			//IL_0701: Unknown result type (might be due to invalid IL or missing references)
			//IL_070b: Expected O, but got Unknown
			//IL_072d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0737: Expected O, but got Unknown
			//IL_0759: Unknown result type (might be due to invalid IL or missing references)
			//IL_0763: Expected O, but got Unknown
			//IL_0785: Unknown result type (might be due to invalid IL or missing references)
			//IL_078f: Expected O, but got Unknown
			//IL_07b9: Unknown result type (might be due to invalid IL or missing references)
			//IL_07c3: Expected O, but got Unknown
			timer1 = new Timer();
			timer1.Tick += timer1_Tick;
			MouseDownPoint = new Point(0, 0);
			this.groupController = groupController;
			shouldCommit = false;
			groupController.Data.RowChanged += OnDataRowChangedEvent;
			groupController.MultipleParametersAdded += OnMultipleParametersAdded;
			cm = (CurrencyManager)((Control)this).BindingContext[((DataGrid)base.Grid).DataSource, ((DataGrid)base.Grid).DataMember];
			((DataView)cm.List).AllowNew = true;
			((DataView)cm.List).AllowDelete = true;
			((DataGrid)base.Grid).AllowSorting = false;
			((DataGrid)base.Grid).TableStyles[0].AllowSorting = false;
			((DataGrid)base.Grid).CaptionVisible = false;
			((Control)base.Grid).GotFocus += OnDataGridGotFocus;
			base.Grid.ColumnHeaderClickedEvent += OnColumnHeaderClickedEvent;
			((Control)base.CommentLine).Hide();
			((Control)Panel).Dock = (DockStyle)5;
			((Control)base.Grid).Dock = (DockStyle)5;
			((Control)base.Grid).TabIndex = 0;
			MonitoredController.MonitoredModel.RadixChanged += OnRadixChanged;
			MonitoredController.MonitoredModel.CommentColumnCharsChangedEventHandler += OnCommentColumnCharsChanged;
			MonitoredController.MonitoredModel.NameColumnCharsChangedEventHandler += OnNameColumnCharsChanged;
			MonitoredController.MonitoredModel.UnitColumnCharsChangedEventHandler += OnUnitColumnCharsChanged;
			MonitoredController.MonitoredModel.ChangeShowCommentsState += OnChangeShowCommentState;
			MonitoredController.MonitoredModel.ChangeShowUnitsState += OnChangeShowUnitsState;
			MonitoredController.MonitoredModel.ChangeShowSourceAddressState += OnChangeShowSourceAddressState;
			MonitoredController.MonitoredModel.ChangeSortExpression += OnChangeSortExpression;
			MonitoredController.MonitoredModel.PrepareToSaveSettings += OnPrepareToSaveSettings;
			MonitoredController.MonitoredModel.SettingsChanged += OnSettingsChanged;
			MonitoredController.MonitoredModel.ChangeValueEnabled += OnChangeValueEnabled;
			MonitoredController.RefreshStart += OnRefreshStart;
			MonitoredController.RefreshOver += OnRefreshOver;
			MonitoredController.UpdateSourceAddressColumnEvent += OnUpdateSourceAddressColumnEvent;
			((Control)SourceAddressColumn.TextBox).KeyPress += new KeyPressEventHandler(OnHandleKeyPress);
			((Control)base.NameColumn.TextBox).KeyPress += new KeyPressEventHandler(OnHandleKeyPress);
			((Control)((DataGridTextBoxColumn)ValueColumn).TextBox).KeyPress += new KeyPressEventHandler(OnHandleKeyPress);
			((Control)base.NameColumn.TextBox).MouseUp += new MouseEventHandler(OnColumnMouseUp);
			((Control)SourceAddressColumn.TextBox).MouseUp += new MouseEventHandler(OnColumnMouseUp);
			((Control)((DataGridTextBoxColumn)ValueColumn).TextBox).MouseUp += new MouseEventHandler(OnColumnMouseUp);
			((Control)base.NameColumn.TextBox).GotFocus += OnNameTextboxGotFocus;
			((Control)base.NameColumn.TextBox).ContextMenu = ((Control)base.Grid).ContextMenu;
			((Control)base.EditBox).KeyPress += new KeyPressEventHandler(EditOver);
			((Control)base.EditBox).Leave += FocusOver;
			((Control)base.EditBox).ContextMenu = ((Control)base.Grid).ContextMenu;
			((Control)base.Grid).KeyUp += new KeyEventHandler(OnKeyUp);
			((Control)SourceAddressColumn.TextBox).KeyUp += new KeyEventHandler(OnKeyUp);
			((Control)base.NameColumn.TextBox).KeyUp += new KeyEventHandler(OnKeyUp);
			((Control)((DataGridTextBoxColumn)ValueColumn).TextBox).KeyUp += new KeyEventHandler(OnKeyUp);
			((Control)base.UnitColumn.TextBox).KeyUp += new KeyEventHandler(OnKeyUp);
			((Control)base.CommentColumn.TextBox).KeyUp += new KeyEventHandler(OnKeyUp);
			((Control)base.Grid).KeyDown += new KeyEventHandler(OnKeyDown);
			((Control)SourceAddressColumn.TextBox).KeyDown += new KeyEventHandler(OnKeyDown);
			((Control)base.NameColumn.TextBox).KeyDown += new KeyEventHandler(OnKeyDown);
			((Control)((DataGridTextBoxColumn)ValueColumn).TextBox).KeyDown += new KeyEventHandler(OnKeyDown);
			((Control)base.UnitColumn.TextBox).KeyDown += new KeyEventHandler(OnKeyDown);
			((Control)base.CommentColumn.TextBox).KeyDown += new KeyEventHandler(OnKeyDown);
			((DataGridColumnStyle)SourceAddressColumn).WidthChanged += OnColumnWidthChanged;
			((DataGridColumnStyle)base.NameColumn).WidthChanged += OnColumnWidthChanged;
			((DataGridColumnStyle)ValueColumn).WidthChanged += OnColumnWidthChanged;
			((DataGridColumnStyle)base.UnitColumn).WidthChanged += OnColumnWidthChanged;
			((DataGridColumnStyle)base.CommentColumn).WidthChanged += OnColumnWidthChanged;
			((DataGridColumnStyle)base.NameColumn).Width = 200;
			((DataGridColumnStyle)ValueColumn).Width = GetDefaultWidth(groupController.Radix);
			((Control)SourceAddressColumn.TextBox).ContextMenu = ((Control)base.Grid).ContextMenu;
			base.Grid.AfterDataPasteEvent += OnAfterDataPasteEvent;
			base.Grid.BeforeDataPasteEvent += OnBeforePaste;
			base.Grid.AfterDataPasteEvent += OnAfterPaste;
			base.Grid.AddRowWhilePaste = true;
			MenuItem val = new MenuItem("Visible Columns");
			_sourceAddressMenuItem = new MenuItem("Source Address", (EventHandler)ToggleSourceAddressDisplay);
			_sourceAddressMenuItem.Checked = ShowSourceAddress;
			((Menu)val).MenuItems.Add(_sourceAddressMenuItem);
			_unitsMenuItem = new MenuItem("Units", (EventHandler)ToggleUnitsDisplay);
			_unitsMenuItem.Checked = ShowUnits;
			((Menu)val).MenuItems.Add(_unitsMenuItem);
			((Menu)((Control)base.Grid).ContextMenu).MenuItems.Add(val);
			((Menu)((Control)base.Grid).ContextMenu).MenuItems.Add(new MenuItem("Sort Ascending", (EventHandler)ToggleSortAscendingByColumn));
			((Menu)((Control)base.Grid).ContextMenu).MenuItems.Add(new MenuItem("Sort Descending", (EventHandler)ToggleSortDescendingByColumn));
			((Menu)((Control)base.Grid).ContextMenu).MenuItems.Add(new MenuItem("Stop Sorting", (EventHandler)OnStopSorting));
			((Menu)((Control)base.Grid).ContextMenu).MenuItems.Add(new MenuItem("Insert Row", (EventHandler)OnInsertRow));
			((Control)base.Grid).ContextMenu.Popup += SelectedParameter;
			((Control)base.Grid).MouseDown += new MouseEventHandler(Grid_MouseDown);
			UnitsDisplay = ShowUnits;
			SourceAddressDisplay = ShowSourceAddress;
			if (((BaseCollection)((DataGrid)base.Grid).TableStyles).Count > 0)
			{
				((DataGrid)base.Grid).TableStyles[0].RowHeaderWidth = 10;
			}
		}

		protected override void Dispose(bool disposing)
		{
			//IL_00dc: Unknown result type (might be due to invalid IL or missing references)
			//IL_00e6: Expected O, but got Unknown
			//IL_00f8: Unknown result type (might be due to invalid IL or missing references)
			//IL_0102: Expected O, but got Unknown
			//IL_0114: Unknown result type (might be due to invalid IL or missing references)
			//IL_011e: Expected O, but got Unknown
			//IL_0147: Unknown result type (might be due to invalid IL or missing references)
			//IL_0151: Expected O, but got Unknown
			//IL_0175: Unknown result type (might be due to invalid IL or missing references)
			//IL_017f: Expected O, but got Unknown
			//IL_0191: Unknown result type (might be due to invalid IL or missing references)
			//IL_019b: Expected O, but got Unknown
			//IL_01ad: Unknown result type (might be due to invalid IL or missing references)
			//IL_01b7: Expected O, but got Unknown
			//IL_01c9: Unknown result type (might be due to invalid IL or missing references)
			//IL_01d3: Expected O, but got Unknown
			//IL_01e5: Unknown result type (might be due to invalid IL or missing references)
			//IL_01ef: Expected O, but got Unknown
			//IL_0201: Unknown result type (might be due to invalid IL or missing references)
			//IL_020b: Expected O, but got Unknown
			//IL_0219: Unknown result type (might be due to invalid IL or missing references)
			//IL_0223: Expected O, but got Unknown
			//IL_0236: Unknown result type (might be due to invalid IL or missing references)
			//IL_0240: Expected O, but got Unknown
			//IL_0253: Unknown result type (might be due to invalid IL or missing references)
			//IL_025d: Expected O, but got Unknown
			//IL_0270: Unknown result type (might be due to invalid IL or missing references)
			//IL_027a: Expected O, but got Unknown
			//IL_028d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0297: Expected O, but got Unknown
			//IL_02aa: Unknown result type (might be due to invalid IL or missing references)
			//IL_02b4: Expected O, but got Unknown
			if (disposing)
			{
				MonitoredController.MonitoredModel.ChangeShowCommentsState -= OnChangeShowCommentState;
				MonitoredController.MonitoredModel.ChangeShowUnitsState -= OnChangeShowUnitsState;
				MonitoredController.MonitoredModel.ChangeShowSourceAddressState -= OnChangeShowSourceAddressState;
				MonitoredController.MonitoredModel.ChangeSortExpression -= OnChangeSortExpression;
				MonitoredController.MonitoredModel.PrepareToSaveSettings -= OnPrepareToSaveSettings;
				MonitoredController.MonitoredModel.SettingsChanged -= OnSettingsChanged;
				groupController.Data.RowChanged -= OnDataRowChangedEvent;
				((Control)SourceAddressColumn.TextBox).KeyPress -= new KeyPressEventHandler(OnHandleKeyPress);
				((Control)base.NameColumn.TextBox).KeyPress -= new KeyPressEventHandler(OnHandleKeyPress);
				((Control)((DataGridTextBoxColumn)ValueColumn).TextBox).KeyPress -= new KeyPressEventHandler(OnHandleKeyPress);
				((Control)base.NameColumn.TextBox).GotFocus -= OnNameTextboxGotFocus;
				((Control)base.EditBox).KeyPress -= new KeyPressEventHandler(EditOver);
				((Control)base.EditBox).Leave -= FocusOver;
				((Control)base.Grid).KeyUp -= new KeyEventHandler(OnKeyUp);
				((Control)SourceAddressColumn.TextBox).KeyUp -= new KeyEventHandler(OnKeyUp);
				((Control)base.NameColumn.TextBox).KeyUp -= new KeyEventHandler(OnKeyUp);
				((Control)((DataGridTextBoxColumn)ValueColumn).TextBox).KeyUp -= new KeyEventHandler(OnKeyUp);
				((Control)base.UnitColumn.TextBox).KeyUp -= new KeyEventHandler(OnKeyUp);
				((Control)base.CommentColumn.TextBox).KeyUp -= new KeyEventHandler(OnKeyUp);
				((Control)base.Grid).KeyDown -= new KeyEventHandler(OnKeyDown);
				((Control)SourceAddressColumn.TextBox).KeyDown -= new KeyEventHandler(OnKeyDown);
				((Control)base.NameColumn.TextBox).KeyDown -= new KeyEventHandler(OnKeyDown);
				((Control)((DataGridTextBoxColumn)ValueColumn).TextBox).KeyDown -= new KeyEventHandler(OnKeyDown);
				((Control)base.UnitColumn.TextBox).KeyDown -= new KeyEventHandler(OnKeyDown);
				((Control)base.CommentColumn.TextBox).KeyDown -= new KeyEventHandler(OnKeyDown);
				((DataGridColumnStyle)SourceAddressColumn).WidthChanged -= OnColumnWidthChanged;
				((DataGridColumnStyle)base.NameColumn).WidthChanged -= OnColumnWidthChanged;
				((DataGridColumnStyle)ValueColumn).WidthChanged -= OnColumnWidthChanged;
				((DataGridColumnStyle)base.UnitColumn).WidthChanged -= OnColumnWidthChanged;
				((DataGridColumnStyle)base.CommentColumn).WidthChanged -= OnColumnWidthChanged;
				valueColumn.StopUpdate();
				valueColumn = null;
			}
			base.Dispose(disposing);
		}

		private void OnAfterDataPasteEvent(object sender, EventArgs e)
		{
			//IL_006c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0071: Unknown result type (might be due to invalid IL or missing references)
			try
			{
				DataTable dataTable = (DataTable)((DataGrid)base.Grid).DataSource;
				DataRow[] array = dataTable.Select("Name = ''");
				DataRow[] array2 = array;
				foreach (DataRow row in array2)
				{
					dataTable.Rows.Remove(row);
				}
				DataRowView dataRowView = (DataRowView)((BindingManagerBase)cm).Current;
				DataColumnCollection columns = dataRowView.DataView.Table.Columns;
				DataGridCell currentCell = ((DataGrid)base.Grid).CurrentCell;
				string columnName = columns[((DataGridCell)(ref currentCell)).ColumnNumber].ColumnName;
				string text = dataRowView[columnName].ToString();
				((Control)base.EditBox).Text = text;
				((Control)base.Grid).Refresh();
			}
			catch
			{
			}
		}

		private void OnBeforePaste(object sender, DataPasteEventArgs args)
		{
			//IL_002e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0033: Unknown result type (might be due to invalid IL or missing references)
			_ = args.ClipBoardData;
			bool flag = args.ClipBoardData.Split(new char[1] { '\t' }).Length > 1;
			DataGridCell currentCell = ((DataGrid)base.Grid).CurrentCell;
			if (((DataGridCell)(ref currentCell)).ColumnNumber == 1 && !flag)
			{
				string[] array = args.ClipBoardData.Split(new char[1] { '\n' });
				parametersPasted = new StringCollection();
				for (int i = 0; i < array.Length; i++)
				{
					string text = array[i].Trim(new char[1] { '\r' });
					if (text != string.Empty && !groupController.IsStructureParameter(text.Trim()))
					{
						text = groupController.AppendQualifier(text.Trim());
						parametersPasted.Add(text);
					}
				}
				RaiseBeforeParameterListAddingEvent();
				controller.IsCopyPasteOperation = false;
				Thread thread = new Thread(AddMulitipleParameters);
				thread.Name = "Parameter copy paste thread";
				thread.Start();
				args.ContinueWithPaste = false;
			}
			else
			{
				controller.IsCopyPasteOperation = false;
			}
		}

		private void AddMulitipleParameters()
		{
			if (!((Control)this).InvokeRequired)
			{
				groupController.Add(parametersPasted, groupController.CurrentSourceAddress, CurrentRowIndex, isBroadcast: false);
				SetGridFocus();
			}
			else
			{
				AddMulitipleParametersDelegate addMulitipleParametersDelegate = AddMulitipleParameters;
				((Control)this).BeginInvoke((Delegate)addMulitipleParametersDelegate, (object[])null);
			}
		}

		private void AddMulitipleParameters(bool isBroadcast, IAddressValue sourceAddress)
		{
			if (!((Control)this).InvokeRequired)
			{
				if (sourceAddress == null)
				{
					groupController.Add(parametersPasted, groupController.CurrentSourceAddress, CurrentRowIndex, isBroadcast);
				}
				else
				{
					groupController.Add(parametersPasted, sourceAddress, CurrentRowIndex, isBroadcast);
				}
				SetGridFocus();
			}
			else
			{
				AddMulitipleParametersDelegate addMulitipleParametersDelegate = AddMulitipleParameters;
				((Control)this).BeginInvoke((Delegate)addMulitipleParametersDelegate, (object[])null);
			}
		}

		private void OnAfterPaste(object sender, EventArgs args)
		{
			controller.IsCopyPasteOperation = false;
		}

		private void OnChangeShowCommentState(object sender, EventArgs e)
		{
			if (MonitoredController.MonitoredModel.ShowComments)
			{
				((DataGridColumnStyle)base.CommentColumn).MappingName = "Comment";
			}
			else
			{
				((DataGridColumnStyle)base.CommentColumn).MappingName = "";
			}
		}

		private void OnChangeShowUnitsState(object sender, EventArgs e)
		{
			UnitsDisplay = MonitoredController.MonitoredModel.ShowUnits;
			_unitsMenuItem.Checked = MonitoredController.MonitoredModel.ShowUnits;
		}

		private void OnChangeShowSourceAddressState(object sender, EventArgs e)
		{
			SourceAddressDisplay = MonitoredController.MonitoredModel.ShowSourceAddress;
			_sourceAddressMenuItem.Checked = MonitoredController.MonitoredModel.ShowSourceAddress;
		}

		private void OnChangeSortExpression(object sender, EventArgs e)
		{
			try
			{
				base.Controller.Data.DefaultView.Sort = MonitoredController.MonitoredModel.SortExpression;
			}
			catch
			{
			}
		}

		private void OnPrepareToSaveSettings(object sender, EventArgs e)
		{
			try
			{
				base.Controller.Model.ColumnWidths[((DataGridColumnStyle)SourceAddressColumn).HeaderText] = ((DataGridColumnStyle)SourceAddressColumn).Width;
				base.Controller.Model.ColumnWidths[((DataGridColumnStyle)base.NameColumn).HeaderText] = ((DataGridColumnStyle)base.NameColumn).Width;
				base.Controller.Model.ColumnWidths[((DataGridColumnStyle)ValueColumn).HeaderText] = ((DataGridColumnStyle)ValueColumn).Width;
				base.Controller.Model.ColumnWidths[((DataGridColumnStyle)base.UnitColumn).HeaderText] = ((DataGridColumnStyle)base.UnitColumn).Width;
				base.Controller.Model.ColumnWidths[((DataGridColumnStyle)base.CommentColumn).HeaderText] = ((DataGridColumnStyle)base.CommentColumn).Width;
			}
			catch
			{
			}
		}

		private void OnSettingsChanged(object sender, EventArgs e)
		{
			try
			{
				((DataGridColumnStyle)SourceAddressColumn).Width = base.Controller.Model.ColumnWidths[((DataGridColumnStyle)SourceAddressColumn).HeaderText];
				((DataGridColumnStyle)base.NameColumn).Width = base.Controller.Model.ColumnWidths[((DataGridColumnStyle)base.NameColumn).HeaderText];
				((DataGridColumnStyle)ValueColumn).Width = base.Controller.Model.ColumnWidths[((DataGridColumnStyle)ValueColumn).HeaderText];
				((DataGridColumnStyle)base.UnitColumn).Width = base.Controller.Model.ColumnWidths[((DataGridColumnStyle)base.UnitColumn).HeaderText];
				((DataGridColumnStyle)base.CommentColumn).Width = base.Controller.Model.ColumnWidths[((DataGridColumnStyle)base.CommentColumn).HeaderText];
			}
			catch
			{
			}
		}

		private void OnChangeValueEnabled(object sender, BooleanStateEventArgs e)
		{
			if (e.State)
			{
				((DataGridColumnStyle)ValueColumn).ReadOnly = false;
			}
			else
			{
				((DataGridColumnStyle)ValueColumn).ReadOnly = true;
			}
		}

		private void OnNameTextboxGotFocus(object sender, EventArgs e)
		{
			int count = ((DataView)cm.List).Count;
			if (count - 1 == MonitoredController.Data.Rows.Count)
			{
				DataRowView dataRowView = ((DataView)cm.List)[count - 1];
				DataRow row = dataRowView.Row;
				MonitoredController.Data.Rows.Add(row);
				AddCellModifiedFlag();
				MonitoredController.Data.AcceptChanges();
				((TextBoxBase)base.NameColumn.TextBox).SelectAll();
			}
		}

		private void OnHandleKeyPress(object sender, KeyPressEventArgs e)
		{
			if (GetParameterType() != ParameterType.Enumeration)
			{
				if (!char.IsControl(e.KeyChar))
				{
					e.Handled = true;
					ShowEditBox(e.KeyChar);
				}
				else
				{
					e.Handled = false;
				}
			}
		}

		private void OnRadixChanged(object sender, RadixEventArgs e)
		{
			ScreenView screenView = (ScreenView)(object)((Control)this).Parent.Parent;
			double actualMonitorRate = screenView.Model.ActualMonitorRate;
			if ((int)actualMonitorRate == 0)
			{
				timer1.Interval = 20;
			}
			else
			{
				timer1.Interval = (int)actualMonitorRate * 2;
			}
			timer1.Start();
		}

		public void AutoSizeCol(int col)
		{
			_ = (MonitoredGroupController)controller;
			float num = 0f;
			int count = ((DataTable)((DataGrid)base.Grid).DataSource).Rows.Count;
			Graphics val = Graphics.FromHwnd(((Control)base.Grid).Handle);
			for (int i = 0; i < count; i++)
			{
				SizeF sizeF = val.MeasureString(((DataGrid)base.Grid)[i, col].ToString(), ((Control)base.Grid).Font);
				if (sizeF.Width > num)
				{
					num = sizeF.Width;
				}
			}
			val.Dispose();
			if (num < (float)GetDefaultWidth(groupController.Radix))
			{
				num = GetDefaultWidth(groupController.Radix);
			}
			((DataGridColumnStyle)ValueColumn).Width = (int)num;
		}

		public void Undo()
		{
			groupController.Undo();
			((Control)this).Refresh();
		}

		public void Revert()
		{
			groupController.Revert();
			((Control)this).Refresh();
		}

		private void OnCommentColumnCharsChanged(object sender, EventArgs e)
		{
			if (MonitoredController.ShowComments)
			{
				((DataGridColumnStyle)base.CommentColumn).Width = GetColumnWidth(MonitoredController.DataTableCommentColumnChars);
			}
		}

		private void OnNameColumnCharsChanged(object sender, EventArgs e)
		{
			((DataGridColumnStyle)base.NameColumn).Width = GetColumnWidth(MonitoredController.DataTableNameColumnChars);
		}

		private void OnUnitColumnCharsChanged(object sender, EventArgs e)
		{
			((DataGridColumnStyle)base.UnitColumn).Width = GetColumnWidth(MonitoredController.DataTableUnitColumnChars);
		}

		private void OnDataRowChangedEvent(object sender, DataRowChangeEventArgs e)
		{
			if (e.Action == DataRowAction.Add)
			{
				AddCellModifiedFlag();
			}
		}

		private void AddCellModifiedFlag()
		{
			ColoredTextBoxColumn coloredTextBoxColumn = (ColoredTextBoxColumn)(object)((DataGrid)base.Grid).TableStyles["DataTable"].GridColumnStyles["Value"];
			coloredTextBoxColumn.AddCell();
		}

		private void ShowEditBox(int keyValue)
		{
			//IL_0007: Unknown result type (might be due to invalid IL or missing references)
			//IL_000c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0021: Unknown result type (might be due to invalid IL or missing references)
			//IL_0026: Unknown result type (might be due to invalid IL or missing references)
			//IL_0047: Unknown result type (might be due to invalid IL or missing references)
			//IL_0064: Unknown result type (might be due to invalid IL or missing references)
			DataGridCell currentCell = ((DataGrid)base.Grid).CurrentCell;
			currentEditedColumn = ((DataGridCell)(ref currentCell)).ColumnNumber;
			DataGridCell currentCell2 = ((DataGrid)base.Grid).CurrentCell;
			currentEditedRow = ((DataGridCell)(ref currentCell2)).RowNumber;
			EditBoxVisible = true;
			Rectangle cellBounds = ((DataGrid)base.Grid).GetCellBounds(((DataGrid)base.Grid).CurrentCell);
			((Control)base.EditBox).Text = ((DataGrid)base.Grid)[((DataGrid)base.Grid).CurrentCell].ToString();
			((Control)base.EditBox).Font = ((Control)base.Grid).Font;
			((Control)base.EditBox).Location = new Point(cellBounds.X + ((Control)base.Grid).Location.X + 2, cellBounds.Y + ((Control)base.Grid).Location.Y + 2);
			((Control)base.EditBox).Size = new Size(cellBounds.Width, cellBounds.Height);
			((Control)base.EditBox).TabIndex = 1;
			((Control)base.EditBox).Show();
			((Control)base.EditBox).Focus();
			if (keyValue == 0)
			{
				Graphics val = ((Control)this).CreateGraphics();
				SizeF sizeF = val.MeasureString(((Control)base.EditBox).Text, ((Control)base.Grid).Font);
				int num = (int)((float)MouseDownPoint.X / (sizeF.Width / (float)((Control)base.EditBox).Text.Length)) + 1;
				if (num >= 0)
				{
					((TextBoxBase)base.EditBox).Select(num, 0);
				}
			}
			else
			{
				((Control)base.EditBox).Text = "";
				((TextBoxBase)base.EditBox).AppendText(((char)keyValue).ToString());
			}
		}

		private void timer1_Tick(object sender, EventArgs e)
		{
			AutoSizeCol(2);
			timer1.Stop();
		}

		protected void CommitEditChange(string newValue)
		{
			//IL_0027: Unknown result type (might be due to invalid IL or missing references)
			//IL_002c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0064: Unknown result type (might be due to invalid IL or missing references)
			//IL_0069: Unknown result type (might be due to invalid IL or missing references)
			DataRowView dataRowView = (DataRowView)((BindingManagerBase)cm).Current;
			DataColumnCollection columns = dataRowView.DataView.Table.Columns;
			DataGridCell currentCell = ((DataGrid)base.Grid).CurrentCell;
			string columnName = columns[((DataGridCell)(ref currentCell)).ColumnNumber].ColumnName;
			Cursor current = Cursor.Current;
			((Control)this).Cursor = Cursors.WaitCursor;
			dataRowView[columnName] = newValue;
			dataRowView.EndEdit();
			DataGridCell currentCell2 = ((DataGrid)base.Grid).CurrentCell;
			if (((DataGridCell)(ref currentCell2)).ColumnNumber == 2)
			{
				((Control)base.EditBox).Hide();
			}
			((Control)this).Cursor = current;
		}

		protected override void OnCellChanged(object sender, DataColumnChangeEventArgs e)
		{
			if (e.Row != null)
			{
				e.Row.BeginEdit();
				e.Row["Changed"] = true;
				e.Row.EndEdit();
				AddModifiedParameter(e.Row["Name"].ToString().Trim());
			}
		}

		private void FocusOver(object sender, EventArgs e)
		{
			//IL_0020: Unknown result type (might be due to invalid IL or missing references)
			//IL_0025: Unknown result type (might be due to invalid IL or missing references)
			((Control)base.EditBox).Hide();
			EditBoxVisible = false;
			if (shouldCommit)
			{
				DataGridCell currentCell = ((DataGrid)base.Grid).CurrentCell;
				if (((DataGridCell)(ref currentCell)).ColumnNumber != 2 && ((Control)base.EditBox).Text.Length > 0)
				{
					CommitEditChange(((Control)base.EditBox).Text);
				}
			}
			shouldCommit = false;
		}

		private void EditOver(object sender, KeyPressEventArgs e)
		{
			if (e.KeyChar == '\u001b')
			{
				shouldCommit = false;
				e.Handled = true;
				((Control)base.EditBox).Hide();
				EditBoxVisible = false;
			}
			else if (e.KeyChar == '\r')
			{
				((Control)base.EditBox).Hide();
				EditBoxVisible = false;
			}
			else
			{
				shouldCommit = true;
			}
		}

		private void RaiseBeforeParameterListAddingEvent()
		{
			if (this.BeforeParameterListAddingEvent != null)
			{
				this.BeforeParameterListAddingEvent(this, EventArgs.Empty);
			}
		}

		private void OnColumnMouseUp(object sender, MouseEventArgs e)
		{
			MouseDownPoint.X = e.X;
			MouseDownPoint.Y = e.Y;
			ShowEditBox(0);
		}

		private void OnKeyUp(object sender, KeyEventArgs e)
		{
			//IL_0001: Unknown result type (might be due to invalid IL or missing references)
			//IL_0006: Unknown result type (might be due to invalid IL or missing references)
			//IL_0007: Unknown result type (might be due to invalid IL or missing references)
			//IL_000a: Invalid comparison between Unknown and I4
			//IL_000c: Unknown result type (might be due to invalid IL or missing references)
			//IL_000f: Invalid comparison between Unknown and I4
			Keys keyCode = e.KeyCode;
			if ((int)keyCode != 113)
			{
				if ((int)keyCode == 118)
				{
					if (e.Alt && e.Shift)
					{
						e.Handled = false;
					}
					else if (e.Alt)
					{
						e.Handled = false;
					}
				}
				else
				{
					e.Handled = false;
				}
			}
			else
			{
				e.Handled = false;
			}
		}

		public void SetGridFocus()
		{
			try
			{
				for (int num = base.Grid.RowCount - 1; num > 0; num--)
				{
					if (((DataGrid)base.Grid)[num, 1].ToString() != string.Empty)
					{
						if (num == base.Grid.RowCount - 1 && ((DataGrid)base.Grid).CurrentRowIndex - 1 != num)
						{
							groupController.BuildExtraRows(1);
						}
						((DataGrid)base.Grid).CurrentRowIndex = num + 1;
						break;
					}
				}
			}
			catch (InvalidOperationException)
			{
			}
		}

		public virtual void AddParameters(StringCollection parameters, bool isBroadcast, IAddressValue sourceAddress)
		{
			parametersPasted = parameters;
			RaiseBeforeParameterListAddingEvent();
			AddMulitipleParameters(isBroadcast, sourceAddress);
		}

		public void AddParameters(StringCollection parameters, bool isAppend, bool isBroadcast, IAddressValue sourceAddress)
		{
			if (isAppend)
			{
				SetGridFocus();
			}
			AddParameters(parameters, isBroadcast, sourceAddress);
		}

		protected virtual void OnKeyDown(object sender, KeyEventArgs e)
		{
			//IL_0001: Unknown result type (might be due to invalid IL or missing references)
			//IL_0006: Unknown result type (might be due to invalid IL or missing references)
			//IL_0007: Unknown result type (might be due to invalid IL or missing references)
			//IL_000a: Invalid comparison between Unknown and I4
			//IL_000c: Unknown result type (might be due to invalid IL or missing references)
			//IL_000f: Invalid comparison between Unknown and I4
			Keys keyCode = e.KeyCode;
			if ((int)keyCode != 46)
			{
				if ((int)keyCode == 119)
				{
					MonitoredController.ParameterAddress(CurrentRowIndex);
					e.Handled = true;
				}
				else
				{
					e.Handled = false;
				}
				return;
			}
			Cursor current = Cursor.Current;
			try
			{
				Cursor.Current = Cursors.WaitCursor;
				int currentRowIndex = ((DataGrid)base.Grid).CurrentRowIndex;
				MonitoredController.Remove(CurrentRowIndex);
				((DataGrid)base.Grid).CurrentRowIndex = currentRowIndex;
			}
			catch (IndexOutOfRangeException)
			{
			}
			Cursor.Current = current;
			e.Handled = true;
		}

		protected override void Properties_Click(object sender, EventArgs e)
		{
			if (CurrentRowIndex == -1)
			{
				base.Properties_Click((object)this, e);
				return;
			}
			try
			{
				Cummins.Parameter.Parameter parameter = new Cummins.Parameter.Parameter(controller.GetMemberParameter(CurrentRowIndex));
				parameter.ShowPropertiesView();
			}
			catch (Exception)
			{
			}
		}

		private void SelectedParameter(object sender, EventArgs e)
		{
			if (base.IntegratedCalibration == null)
			{
				return;
			}
			string selectedParameter = string.Empty;
			try
			{
				DataRow dataRow = controller.Data.Select("Order =" + CurrentRowIndex)[0];
				if (dataRow != null)
				{
					selectedParameter = (string)dataRow["Name"];
				}
			}
			catch (Exception)
			{
				selectedParameter = "";
			}
			base.IntegratedCalibration.SelectedParameter = selectedParameter;
		}

		protected override void PopulateColumnStyles(DataGridTableStyle tableStyle)
		{
			DataTable data = controller.Data;
			int num = 0;
			num = (int)(7.0 * base.AverageCharacterWidth);
			SetColumnStyle(SourceAddressColumn, data.Columns["SourceAddress"].Caption, "SourceAddress", num, data.Columns["SourceAddress"].ReadOnly);
			tableStyle.GridColumnStyles.Add((DataGridColumnStyle)(object)SourceAddressColumn);
			base.PopulateColumnStyles(tableStyle);
			SetColumnStyle(ChangedColumn, data.Columns["Changed"].Caption, "Changed", 0, data.Columns["Changed"].ReadOnly);
			tableStyle.GridColumnStyles.Add((DataGridColumnStyle)(object)ChangedColumn);
		}

		protected override bool ProcessCmdKey(ref Message m, Keys keyData)
		{
			//IL_000b: Unknown result type (might be due to invalid IL or missing references)
			//IL_000e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0011: Invalid comparison between Unknown and I4
			//IL_006e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0071: Invalid comparison between Unknown and I4
			//IL_0013: Unknown result type (might be due to invalid IL or missing references)
			//IL_0019: Unknown result type (might be due to invalid IL or missing references)
			//IL_001f: Invalid comparison between Unknown and I4
			//IL_0160: Unknown result type (might be due to invalid IL or missing references)
			//IL_00ce: Unknown result type (might be due to invalid IL or missing references)
			//IL_00d4: Unknown result type (might be due to invalid IL or missing references)
			//IL_00da: Invalid comparison between Unknown and I4
			//IL_0073: Unknown result type (might be due to invalid IL or missing references)
			//IL_0079: Unknown result type (might be due to invalid IL or missing references)
			//IL_007f: Invalid comparison between Unknown and I4
			//IL_013d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0140: Invalid comparison between Unknown and I4
			//IL_00dc: Unknown result type (might be due to invalid IL or missing references)
			//IL_00df: Invalid comparison between Unknown and I4
			//IL_0142: Unknown result type (might be due to invalid IL or missing references)
			//IL_0148: Unknown result type (might be due to invalid IL or missing references)
			//IL_014e: Invalid comparison between Unknown and I4
			//IL_00f0: Unknown result type (might be due to invalid IL or missing references)
			//IL_00f5: Unknown result type (might be due to invalid IL or missing references)
			//IL_010c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0111: Unknown result type (might be due to invalid IL or missing references)
			//IL_011f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0124: Unknown result type (might be due to invalid IL or missing references)
			//IL_012f: Unknown result type (might be due to invalid IL or missing references)
			Keys val = (Keys)(int)((Message)(ref m)).WParam;
			bool flag = true;
			try
			{
				if ((int)val == 33 && (keyData & 0x20000) == 131072)
				{
					((Control)base.NameColumn.TextBox).Focus();
					MonitoredController.IncrementArrayIndex(CurrentRowIndex);
					((TextBoxBase)base.NameColumn.TextBox).Select(0, ((Control)base.NameColumn.TextBox).Text.Length);
				}
				else if ((int)val == 34 && (keyData & 0x20000) == 131072)
				{
					((Control)base.NameColumn.TextBox).Focus();
					MonitoredController.DecrementArrayIndex(CurrentRowIndex);
					((TextBoxBase)base.NameColumn.TextBox).Select(0, ((Control)base.NameColumn.TextBox).Text.Length);
				}
				else if ((keyData & 0x10000) != 65536 || (int)val != 9 || ParameterType.Enumeration != GetParameterType())
				{
					flag = (((int)val == 88 && (keyData & 0x20000) == 131072) ? true : false);
				}
				else
				{
					DataGridCell currentCell = ((DataGrid)base.Grid).CurrentCell;
					if (((DataGridCell)(ref currentCell)).ColumnNumber == 2)
					{
						CustomDataGrid grid = base.Grid;
						DataGridCell currentCell2 = ((DataGrid)base.Grid).CurrentCell;
						int rowNumber = ((DataGridCell)(ref currentCell2)).RowNumber;
						DataGridCell currentCell3 = ((DataGrid)base.Grid).CurrentCell;
						((DataGrid)grid).CurrentCell = new DataGridCell(rowNumber, ((DataGridCell)(ref currentCell3)).ColumnNumber - 1);
						flag = true;
					}
				}
			}
			catch
			{
			}
			if (!flag)
			{
				flag = base.ProcessCmdKey(ref m, keyData);
			}
			return flag;
		}

		protected override bool ProcessDialogKey(Keys AKeyData)
		{
			//IL_0008: Unknown result type (might be due to invalid IL or missing references)
			//IL_000d: Unknown result type (might be due to invalid IL or missing references)
			//IL_011a: Unknown result type (might be due to invalid IL or missing references)
			//IL_001b: Unknown result type (might be due to invalid IL or missing references)
			//IL_001e: Invalid comparison between Unknown and I4
			//IL_0020: Unknown result type (might be due to invalid IL or missing references)
			//IL_0023: Invalid comparison between Unknown and I4
			//IL_0110: Unknown result type (might be due to invalid IL or missing references)
			//IL_00dd: Unknown result type (might be due to invalid IL or missing references)
			//IL_00e2: Unknown result type (might be due to invalid IL or missing references)
			//IL_00f1: Unknown result type (might be due to invalid IL or missing references)
			//IL_00f6: Unknown result type (might be due to invalid IL or missing references)
			//IL_0101: Unknown result type (might be due to invalid IL or missing references)
			//IL_00a5: Unknown result type (might be due to invalid IL or missing references)
			//IL_00aa: Unknown result type (might be due to invalid IL or missing references)
			//IL_00b8: Unknown result type (might be due to invalid IL or missing references)
			//IL_00bd: Unknown result type (might be due to invalid IL or missing references)
			//IL_00c5: Unknown result type (might be due to invalid IL or missing references)
			bool flag = false;
			DataGridCell currentCell = ((DataGrid)base.Grid).CurrentCell;
			if (((DataGridCell)(ref currentCell)).ColumnNumber == 2)
			{
				if ((int)AKeyData == 9 || (int)AKeyData == 13)
				{
					if (EditBoxVisible)
					{
						((Control)base.EditBox).Hide();
						EditBoxVisible = false;
						CommitEditChange(((Control)base.EditBox).Text);
					}
					else if (base.ComboBoxVisible)
					{
						CommitEditChange(((Control)base.DropDownList).Text);
					}
					if (((object)this).GetType().ToString() == "Cummins.Editor.GraphicalMonitoredGroupView")
					{
						((Control)base.Grid).Focus();
					}
					if (!base.ComboBoxVisible)
					{
						CustomDataGrid grid = base.Grid;
						DataGridCell currentCell2 = ((DataGrid)base.Grid).CurrentCell;
						int rowNumber = ((DataGridCell)(ref currentCell2)).RowNumber;
						DataGridCell currentCell3 = ((DataGrid)base.Grid).CurrentCell;
						((DataGrid)grid).CurrentCell = new DataGridCell(rowNumber, ((DataGridCell)(ref currentCell3)).ColumnNumber);
					}
					else
					{
						CustomDataGrid grid2 = base.Grid;
						DataGridCell currentCell4 = ((DataGrid)base.Grid).CurrentCell;
						int rowNumber2 = ((DataGridCell)(ref currentCell4)).RowNumber;
						DataGridCell currentCell5 = ((DataGrid)base.Grid).CurrentCell;
						((DataGrid)grid2).CurrentCell = new DataGridCell(rowNumber2, ((DataGridCell)(ref currentCell5)).ColumnNumber + 1);
					}
					return true;
				}
				return ((ContainerControl)this).ProcessDialogKey(AKeyData);
			}
			return ((ContainerControl)this).ProcessDialogKey(AKeyData);
		}

		protected override void OnGotFocus(EventArgs e)
		{
			((Control)base.Grid).Focus();
			((Control)this).OnGotFocus(e);
		}

		protected int GetDefaultWidth(DataFormat Radix)
		{
			int result = 0;
			switch (Radix)
			{
			case DataFormat.Decimal:
				result = 75;
				break;
			case DataFormat.Hex:
				result = 75;
				break;
			case DataFormat.Binary:
				result = 235;
				break;
			}
			return result;
		}

		private void OnRefreshStart(object sender, EventArgs e)
		{
			ValueColumn.Freeze();
		}

		private void OnRefreshOver(object sender, EventArgs e)
		{
			ValueColumn.UnFreeze();
		}

		private void RaiseGotFocusEvent(EventArgs e)
		{
			if (this.GotFocus != null)
			{
				this.GotFocus(this, e);
			}
		}

		private void OnDataGridGotFocus(object sender, EventArgs e)
		{
			RaiseGotFocusEvent(e);
		}

		private void OnUpdateSourceAddressColumnEvent(object sender, EventArgs e)
		{
			if (MonitoredController.Data.Columns["SourceAddress"].ColumnMapping == MappingType.Hidden)
			{
				((DataGridColumnStyle)SourceAddressColumn).MappingName = "";
			}
		}

		private void OnMultipleParametersAdded(object sender, EventArgs e)
		{
			((Control)base.EditBox).Hide();
			EditBoxVisible = false;
		}

		private void OnColumnHeaderClickedEvent(object sender, EventArgs e)
		{
			((Control)((DataGridTextBoxColumn)ValueColumn).TextBox).Enter -= base.OnValueColumnEnter;
			((Control)base.DropDownList).SendToBack();
			((Control)base.DropDownList).Hide();
			((Control)((DataGridTextBoxColumn)ValueColumn).TextBox).Enter += base.OnValueColumnEnter;
		}

		private void ToggleSourceAddressDisplay(object sender, EventArgs args)
		{
			ShowSourceAddress = !ShowSourceAddress;
			MenuItem val = (MenuItem)((sender is MenuItem) ? sender : null);
			if (val != null)
			{
				val.Checked = ShowSourceAddress;
			}
		}

		private void ToggleUnitsDisplay(object sender, EventArgs args)
		{
			ShowUnits = !ShowUnits;
			MenuItem val = (MenuItem)((sender is MenuItem) ? sender : null);
			if (val != null)
			{
				val.Checked = ShowUnits;
			}
		}

		private void Grid_MouseDown(object sender, MouseEventArgs e)
		{
			//IL_0001: Unknown result type (might be due to invalid IL or missing references)
			//IL_000b: Invalid comparison between Unknown and I4
			if ((int)e.Button == 2097152)
			{
				_contextMouseDown = new Point(e.X, e.Y);
			}
		}

		private void ToggleSortAscendingByColumn(object sender, EventArgs args)
		{
			if (!_contextMouseDown.IsEmpty)
			{
				HitTestInfo val = ((DataGrid)base.Grid).HitTest(_contextMouseDown.X, _contextMouseDown.Y);
				if (val.Column > -1)
				{
					DataColumn dataColumn = base.Controller.Data.Columns[val.Column];
					string sortExpression = dataColumn.ColumnName + " ASC";
					MonitoredController.MonitoredModel.SortExpression = sortExpression;
				}
			}
		}

		private void ToggleSortDescendingByColumn(object sender, EventArgs args)
		{
			if (!_contextMouseDown.IsEmpty)
			{
				HitTestInfo val = ((DataGrid)base.Grid).HitTest(_contextMouseDown.X, _contextMouseDown.Y);
				if (val.Column > -1)
				{
					DataColumn dataColumn = base.Controller.Data.Columns[val.Column];
					string sortExpression = dataColumn.ColumnName + " DESC";
					MonitoredController.MonitoredModel.SortExpression = sortExpression;
				}
			}
		}

		private void OnStopSorting(object sender, EventArgs args)
		{
			MonitoredController.MonitoredModel.SortExpression = "";
		}

		private void OnInsertRow(object sender, EventArgs args)
		{
			if (!_contextMouseDown.IsEmpty)
			{
				HitTestInfo val = ((DataGrid)base.Grid).HitTest(_contextMouseDown.X, _contextMouseDown.Y);
				groupController.AddInsertedRow(groupController.CurrentSourceAddress, val.Row);
				DataRow dataRow = base.Controller.Data.NewRow();
				dataRow["Order"] = val.Row + 1;
				base.Controller.Data.Rows.InsertAt(dataRow, val.Row + 1);
			}
		}

		private void OnColumnWidthChanged(object sender, EventArgs e)
		{
			base.Controller.Model.IsChanged = true;
		}
	}
	public class GraphicalMonitoredGroupView : MonitoredGroupView
	{
		private delegate void AddParameterOnGraphDelegate(DataRow row);

		private const int MAX_CAPACITY = 40000;

		private const string MonitoredParametersFilterString = "SourceAddress NOT LIKE '' AND Name NOT LIKE ''";

		protected const string AddressedMonitorFilterFormat = "Address = '{0}' AND Offset = '{1}' AND Length = '{2}' AND SourceAddress = '{3}'";

		protected const string NamedMonitorFilterFormat = "FullName = '{0}' AND SourceAddress = '{1}'";

		protected const string NamedMonitorFilterFormatForASAM = "Name = '{0}' AND SourceAddress = '{1}'";

		internal const string GraphParametersFilterFormat = "Name = '{0}' AND SourceAddress = '{1}' AND ViewType = 'Graph'";

		internal const string GaugeParametersFilterFormat = "Name = '{0}' AND SourceAddress = '{1}' AND ViewType = 'Gauge'";

		internal const string NormalParametersFilterFormat = "Name = '{0}' AND SourceAddress = '{1}' AND ViewType = 'Normal'";

		internal const string AllParametersFilterFormat = "Name = '{0}' AND SourceAddress = '{1}'";

		internal const string GridParametersFilterString = "ViewType = 'Graph' OR ViewType = 'Normal'";

		private ImageList imageList1;

		private IContainer components;

		private Plot graphControl;

		private ImageList imageList2;

		private ImageList imageList3;

		private PlotToolBarStandard plotToolBarStandard1;

		private PlotToolBarButton plotToolBarButton1;

		private PlotToolBarButton plotToolBarButton2;

		private PlotToolBarButton plotToolBarButton3;

		private PlotToolBarButton plotToolBarButton4;

		private PlotToolBarButton plotToolBarButton5;

		private PlotToolBarButton plotToolBarButton6;

		private PlotToolBarButton plotToolBarButton7;

		private PlotToolBarButton plotToolBarButton8;

		private PlotToolBarButton plotToolBarButton9;

		private PlotToolBarButton plotToolBarButton10;

		private PlotToolBarButton plotToolBarButton11;

		private PlotToolBarButton plotToolBarButton12;

		private PlotToolBarButton plotToolBarButton13;

		private PlotToolBarButton plotToolBarButton14;

		private PlotToolBarButton plotToolBarButton15;

		private PlotToolBarButton plotToolBarButton16;

		private PlotToolBarButton plotToolBarButton17;

		private PlotToolBarButton plotToolBarButton18;

		private PlotToolBarButton plotToolBarButton19;

		private PlotToolBarButton plotToolBarButton20;

		private PlotToolBarButton plotToolBarButton21;

		private ImageList imageList4;

		private DateTime lastUpdate;

		private GraphicalMonitoredGroupController gdmController;

		private GraphicalMonitoredGroupModel gdmModel;

		private DashBoard dashBoard;

		private double pauseTime;

		private GraphProperties graphPropertiesDialog;

		private YAxisDisplayType yAxisDisplayType = YAxisDisplayType.Individual;

		private SortedList timeBarValues;

		private double currentTimeValue;

		private bool currentlyRefreshing;

		private Splitter splitterGraph;

		private MenuItem menuItemGaugesShow;

		private int dockingIndex;

		private Dictionary<string, string> AddressOffsetToChannelName = new Dictionary<string, string>();

		private bool _timeStartedSet;

		private DateTime _timeStarted = DateTime.Now;

		private GraphProperties GraphPropertiesDialog
		{
			get
			{
				if (graphPropertiesDialog == null)
				{
					graphPropertiesDialog = new GraphProperties(gdmModel.GraphConfiguration);
				}
				return graphPropertiesDialog;
			}
		}

		private bool CurrentlyRefreshing
		{
			get
			{
				return currentlyRefreshing;
			}
			set
			{
				if (currentlyRefreshing != value)
				{
					currentlyRefreshing = value;
				}
			}
		}

		private SortedList TimeBarValues
		{
			get
			{
				if (timeBarValues == null)
				{
					timeBarValues = new SortedList();
				}
				return timeBarValues;
			}
		}

		internal event EventHandler GraphSettingsChangedEvent;

		protected GraphicalMonitoredGroupView()
		{
			InitializeComponent();
		}

		public GraphicalMonitoredGroupView(GraphicalMonitoredGroupController gdmController, GraphicalMonitoredGroupModel model, Font font)
			: base(gdmController, font)
		{
			//IL_0052: Unknown result type (might be due to invalid IL or missing references)
			//IL_005c: Expected O, but got Unknown
			this.gdmController = gdmController;
			gdmModel = model;
			InitializeComponent();
			CreateDashBoard();
			ArrangeComponents();
			RegisterEvents();
			AssociateDataView();
			menuItemGaugesShow = new MenuItem();
			menuItemGaugesShow.Index = 3;
			menuItemGaugesShow.Text = "&Show Gauges";
			menuItemGaugesShow.Click += menuItemGauges_Click;
			((Menu)((Control)base.Grid).ContextMenu).MenuItems.Add(menuItemGaugesShow);
			RefreshGraphView();
		}

		~GraphicalMonitoredGroupView()
		{
			try
			{
				UnRegisterEvents();
			}
			finally
			{
				((Component)(object)this).Finalize();
			}
		}

		public override void AddParameters(StringCollection parameters, bool isBroadcast, IAddressValue sourceAddress)
		{
			int selectedGaugeIndex = dashBoard.SelectedGaugeIndex;
			if (selectedGaugeIndex != -1)
			{
				gdmController.MonitoredModel.AddPending = true;
				gdmController.AddParameterOnGauge(parameters[parameters.Count - 1], gdmController.CurrentSourceAddress.DisplayId, selectedGaugeIndex, ActionType.ParameterAdded);
				gdmController.MonitoredModel.AddPending = false;
			}
			else
			{
				base.AddParameters(parameters, isBroadcast, sourceAddress);
			}
		}

		protected override void PopulateColumnStyles(DataGridTableStyle tableStyle)
		{
			base.PopulateColumnStyles(tableStyle);
		}

		protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
		{
			//IL_000d: Unknown result type (might be due to invalid IL or missing references)
			//IL_000e: Unknown result type (might be due to invalid IL or missing references)
			//IL_000f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0010: Unknown result type (might be due to invalid IL or missing references)
			//IL_0013: Invalid comparison between Unknown and I4
			//IL_0015: Unknown result type (might be due to invalid IL or missing references)
			//IL_0018: Invalid comparison between Unknown and I4
			//IL_0082: Unknown result type (might be due to invalid IL or missing references)
			//IL_0087: Unknown result type (might be due to invalid IL or missing references)
			//IL_001d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0023: Unknown result type (might be due to invalid IL or missing references)
			//IL_0029: Invalid comparison between Unknown and I4
			//IL_010a: Unknown result type (might be due to invalid IL or missing references)
			//IL_00aa: Unknown result type (might be due to invalid IL or missing references)
			//IL_00af: Unknown result type (might be due to invalid IL or missing references)
			//IL_00d1: Unknown result type (might be due to invalid IL or missing references)
			//IL_00d6: Unknown result type (might be due to invalid IL or missing references)
			bool flag = false;
			Keys val = (Keys)(int)((Message)(ref msg)).WParam;
			Keys val2 = val;
			if ((int)val2 != 32)
			{
				if ((int)val2 == 80 && (keyData & 0x20000) == 131072)
				{
					graphControl.XAxes[0].Tracking.Enabled = !graphControl.XAxes[0].Tracking.Enabled;
				}
			}
			else if (((Control)base.Grid).ContainsFocus)
			{
				DataGridCell currentCell = ((DataGrid)base.Grid).CurrentCell;
				if (((DataGridCell)(ref currentCell)).ColumnNumber == ((DataGrid)base.Grid).VisibleColumnCount - 1)
				{
					CustomDataGrid grid = base.Grid;
					DataGridCell currentCell2 = ((DataGrid)base.Grid).CurrentCell;
					int rowNumber = ((DataGridCell)(ref currentCell2)).RowNumber;
					int num = ((DataGrid)base.Grid).VisibleColumnCount - 1;
					CustomDataGrid grid2 = base.Grid;
					DataGridCell currentCell3 = ((DataGrid)base.Grid).CurrentCell;
					((DataGrid)grid)[rowNumber, num] = !(bool)((DataGrid)grid2)[((DataGridCell)(ref currentCell3)).RowNumber, ((DataGrid)base.Grid).VisibleColumnCount - 1];
					flag = true;
				}
			}
			if (!flag)
			{
				flag = base.ProcessCmdKey(ref msg, keyData);
			}
			return flag;
		}

		protected void RaiseGraphSettingsChangedEvent()
		{
			if (this.GraphSettingsChangedEvent != null)
			{
				this.GraphSettingsChangedEvent(this, EventArgs.Empty);
			}
		}

		private void InitializeComponent()
		{
			//IL_0035: Unknown result type (might be due to invalid IL or missing references)
			//IL_003f: Expected O, but got Unknown
			//IL_0046: Unknown result type (might be due to invalid IL or missing references)
			//IL_0050: Expected O, but got Unknown
			//IL_0062: Unknown result type (might be due to invalid IL or missing references)
			//IL_006c: Expected O, but got Unknown
			//IL_0073: Unknown result type (might be due to invalid IL or missing references)
			//IL_007d: Expected O, but got Unknown
			//IL_0176: Unknown result type (might be due to invalid IL or missing references)
			//IL_0180: Expected O, but got Unknown
			//IL_01f7: Unknown result type (might be due to invalid IL or missing references)
			//IL_0201: Expected O, but got Unknown
			//IL_051a: Unknown result type (might be due to invalid IL or missing references)
			//IL_0524: Expected O, but got Unknown
			//IL_067e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0688: Expected O, but got Unknown
			//IL_0ffd: Unknown result type (might be due to invalid IL or missing references)
			//IL_1007: Expected O, but got Unknown
			components = new Container();
			ComponentResourceManager componentResourceManager = new ComponentResourceManager(typeof(GraphicalMonitoredGroupView));
			PlotDataCursorChannel plotDataCursorChannel = new PlotDataCursorChannel();
			PlotDataView plotDataView = new PlotDataView();
			PlotLegendBasic plotLegendBasic = new PlotLegendBasic();
			PlotXAxis plotXAxis = new PlotXAxis();
			splitterGraph = new Splitter();
			imageList1 = new ImageList(components);
			graphControl = new Plot();
			imageList2 = new ImageList(components);
			imageList3 = new ImageList(components);
			plotToolBarStandard1 = new PlotToolBarStandard();
			plotToolBarButton1 = new PlotToolBarButton();
			plotToolBarButton2 = new PlotToolBarButton();
			plotToolBarButton3 = new PlotToolBarButton();
			plotToolBarButton4 = new PlotToolBarButton();
			plotToolBarButton5 = new PlotToolBarButton();
			plotToolBarButton6 = new PlotToolBarButton();
			plotToolBarButton7 = new PlotToolBarButton();
			plotToolBarButton8 = new PlotToolBarButton();
			plotToolBarButton9 = new PlotToolBarButton();
			plotToolBarButton10 = new PlotToolBarButton();
			plotToolBarButton11 = new PlotToolBarButton();
			plotToolBarButton12 = new PlotToolBarButton();
			plotToolBarButton13 = new PlotToolBarButton();
			plotToolBarButton14 = new PlotToolBarButton();
			plotToolBarButton15 = new PlotToolBarButton();
			plotToolBarButton16 = new PlotToolBarButton();
			plotToolBarButton17 = new PlotToolBarButton();
			plotToolBarButton18 = new PlotToolBarButton();
			plotToolBarButton19 = new PlotToolBarButton();
			plotToolBarButton20 = new PlotToolBarButton();
			plotToolBarButton21 = new PlotToolBarButton();
			imageList4 = new ImageList(components);
			((Control)this).SuspendLayout();
			((Control)splitterGraph).Dock = (DockStyle)2;
			((Control)splitterGraph).Location = new Point(0, 573);
			((Control)splitterGraph).Name = "splitterGraph";
			((Control)splitterGraph).Size = new Size(1320, 3);
			((Control)splitterGraph).TabIndex = 8;
			splitterGraph.TabStop = false;
			imageList1.ImageStream = (ImageListStreamer)componentResourceManager.GetObject("imageList1.ImageStream");
			imageList1.TransparentColor = Color.Transparent;
			imageList1.Images.SetKeyName(0, "");
			imageList1.Images.SetKeyName(1, "");
			imageList1.Images.SetKeyName(2, "");
			imageList1.Images.SetKeyName(3, "");
			imageList1.Images.SetKeyName(4, "");
			imageList1.Images.SetKeyName(5, "");
			imageList1.Images.SetKeyName(6, "");
			imageList1.Images.SetKeyName(7, "");
			imageList1.Images.SetKeyName(8, "");
			imageList1.Images.SetKeyName(9, "");
			imageList1.Images.SetKeyName(10, "");
			imageList1.Images.SetKeyName(11, "");
			imageList1.Images.SetKeyName(12, "");
			imageList1.Images.SetKeyName(13, "");
			graphControl.LoadingBegin();
			graphControl.Background.HatchBackColor = Color.White;
			graphControl.Background.HatchForeColor = Color.Black;
			graphControl.Background.SolidColor = Color.White;
			plotDataCursorChannel.Hint.Fill.Pen.Color = SystemColors.InfoText;
			plotDataCursorChannel.Name = "Data-Cursor 1";
			plotDataCursorChannel.TitleText = "Data-Cursor 1";
			plotDataCursorChannel.Visible = true;
			graphControl.DataCursors.Add(plotDataCursorChannel);
			plotDataView.DockOrder = 0;
			plotDataView.Name = "Data-View 1";
			plotDataView.TitleText = "Data-View 1";
			graphControl.DataViews.Add(plotDataView);
			((Control)graphControl).Dock = (DockStyle)1;
			plotLegendBasic.DockOrder = 0;
			plotLegendBasic.Name = "Legend 1";
			plotLegendBasic.TitleText = "Legend 1";
			graphControl.Legends.Add(plotLegendBasic);
			((Control)graphControl).Location = new Point(0, 28);
			((Control)graphControl).Name = "graphControl";
			graphControl.Size = new Size(1320, 189);
			((Control)graphControl).TabIndex = 10;
			graphControl.UpdateFrameRate = 50.0;
			plotXAxis.Color = Color.White;
			plotXAxis.DockOrder = 0;
			plotXAxis.Name = "X-Axis 1";
			plotXAxis.Title.Text = "X-Axis 1";
			plotXAxis.ScaleRange.Span = 60.0;
			graphControl.XAxes.Add(plotXAxis);
			graphControl.LoadingEnd();
			imageList2.ImageStream = (ImageListStreamer)componentResourceManager.GetObject("imageList2.ImageStream");
			imageList2.TransparentColor = Color.Transparent;
			imageList2.Images.SetKeyName(0, "");
			imageList2.Images.SetKeyName(1, "");
			imageList2.Images.SetKeyName(2, "");
			imageList2.Images.SetKeyName(3, "");
			imageList2.Images.SetKeyName(4, "");
			imageList2.Images.SetKeyName(5, "");
			imageList2.Images.SetKeyName(6, "");
			imageList2.Images.SetKeyName(7, "");
			imageList2.Images.SetKeyName(8, "");
			imageList2.Images.SetKeyName(9, "");
			imageList2.Images.SetKeyName(10, "");
			imageList2.Images.SetKeyName(11, "");
			imageList2.Images.SetKeyName(12, "");
			imageList2.Images.SetKeyName(13, "");
			imageList3.ImageStream = (ImageListStreamer)componentResourceManager.GetObject("imageList3.ImageStream");
			imageList3.TransparentColor = Color.Transparent;
			imageList3.Images.SetKeyName(0, "");
			imageList3.Images.SetKeyName(1, "");
			imageList3.Images.SetKeyName(2, "");
			imageList3.Images.SetKeyName(3, "");
			imageList3.Images.SetKeyName(4, "");
			imageList3.Images.SetKeyName(5, "");
			imageList3.Images.SetKeyName(6, "");
			imageList3.Images.SetKeyName(7, "");
			imageList3.Images.SetKeyName(8, "");
			imageList3.Images.SetKeyName(9, "");
			imageList3.Images.SetKeyName(10, "");
			imageList3.Images.SetKeyName(11, "");
			imageList3.Images.SetKeyName(12, "");
			imageList3.Images.SetKeyName(13, "");
			plotToolBarStandard1.LoadingBegin();
			((ToolBar)plotToolBarStandard1).Appearance = (ToolBarAppearance)1;
			((ToolBar)plotToolBarStandard1).Buttons.AddRange((ToolBarButton[])(object)new ToolBarButton[21]
			{
				plotToolBarButton1, plotToolBarButton2, plotToolBarButton3, plotToolBarButton4, plotToolBarButton5, plotToolBarButton6, plotToolBarButton7, plotToolBarButton8, plotToolBarButton9, plotToolBarButton10,
				plotToolBarButton11, plotToolBarButton12, plotToolBarButton13, plotToolBarButton14, plotToolBarButton15, plotToolBarButton16, plotToolBarButton17, plotToolBarButton18, plotToolBarButton19, plotToolBarButton20,
				plotToolBarButton21
			});
			((ToolBar)plotToolBarStandard1).DropDownArrows = true;
			((ToolBar)plotToolBarStandard1).ImageList = imageList4;
			((Control)plotToolBarStandard1).Location = new Point(0, 0);
			((Control)plotToolBarStandard1).Name = "plotToolBarStandard1";
			plotToolBarStandard1.Plot = graphControl;
			((ToolBar)plotToolBarStandard1).ShowToolTips = true;
			((Control)plotToolBarStandard1).Size = new Size(1320, 28);
			((Control)plotToolBarStandard1).TabIndex = 11;
			plotToolBarStandard1.LoadingEnd();
			plotToolBarButton1.LoadingBegin();
			((ToolBarButton)plotToolBarButton1).Enabled = false;
			((ToolBarButton)plotToolBarButton1).ImageIndex = 0;
			((ToolBarButton)plotToolBarButton1).Name = "plotToolBarButton1";
			((ToolBarButton)plotToolBarButton1).ToolTipText = "Tracking Resume";
			plotToolBarButton1.LoadingEnd();
			plotToolBarButton2.LoadingBegin();
			plotToolBarButton2.Command = PlotToolBarCommandStyle.TrackingPause;
			((ToolBarButton)plotToolBarButton2).ImageIndex = 1;
			((ToolBarButton)plotToolBarButton2).Name = "plotToolBarButton2";
			((ToolBarButton)plotToolBarButton2).ToolTipText = "Tracking Pause";
			plotToolBarButton2.LoadingEnd();
			plotToolBarButton3.LoadingBegin();
			plotToolBarButton3.Command = PlotToolBarCommandStyle.Separator;
			((ToolBarButton)plotToolBarButton3).Enabled = false;
			((ToolBarButton)plotToolBarButton3).Name = "plotToolBarButton3";
			((ToolBarButton)plotToolBarButton3).Style = (ToolBarButtonStyle)3;
			plotToolBarButton3.LoadingEnd();
			plotToolBarButton4.LoadingBegin();
			plotToolBarButton4.Command = PlotToolBarCommandStyle.AxesScroll;
			((ToolBarButton)plotToolBarButton4).ImageIndex = 2;
			((ToolBarButton)plotToolBarButton4).Name = "plotToolBarButton4";
			((ToolBarButton)plotToolBarButton4).Pushed = true;
			((ToolBarButton)plotToolBarButton4).ToolTipText = "Axes Scroll";
			plotToolBarButton4.LoadingEnd();
			plotToolBarButton5.LoadingBegin();
			plotToolBarButton5.Command = PlotToolBarCommandStyle.AxesZoom;
			((ToolBarButton)plotToolBarButton5).ImageIndex = 3;
			((ToolBarButton)plotToolBarButton5).Name = "plotToolBarButton5";
			((ToolBarButton)plotToolBarButton5).ToolTipText = "Axes Zoom";
			plotToolBarButton5.LoadingEnd();
			plotToolBarButton6.LoadingBegin();
			plotToolBarButton6.Command = PlotToolBarCommandStyle.Separator;
			((ToolBarButton)plotToolBarButton6).Enabled = false;
			((ToolBarButton)plotToolBarButton6).Name = "plotToolBarButton6";
			((ToolBarButton)plotToolBarButton6).Style = (ToolBarButtonStyle)3;
			plotToolBarButton6.LoadingEnd();
			plotToolBarButton7.LoadingBegin();
			plotToolBarButton7.Command = PlotToolBarCommandStyle.ZoomOut;
			((ToolBarButton)plotToolBarButton7).ImageIndex = 4;
			((ToolBarButton)plotToolBarButton7).Name = "plotToolBarButton7";
			((ToolBarButton)plotToolBarButton7).ToolTipText = "Zoom-Out";
			plotToolBarButton7.LoadingEnd();
			plotToolBarButton8.LoadingBegin();
			plotToolBarButton8.Command = PlotToolBarCommandStyle.ZoomIn;
			((ToolBarButton)plotToolBarButton8).ImageIndex = 5;
			((ToolBarButton)plotToolBarButton8).Name = "plotToolBarButton8";
			((ToolBarButton)plotToolBarButton8).ToolTipText = "Zoom-In";
			plotToolBarButton8.LoadingEnd();
			plotToolBarButton9.LoadingBegin();
			plotToolBarButton9.Command = PlotToolBarCommandStyle.Separator;
			((ToolBarButton)plotToolBarButton9).Enabled = false;
			((ToolBarButton)plotToolBarButton9).Name = "plotToolBarButton9";
			((ToolBarButton)plotToolBarButton9).Style = (ToolBarButtonStyle)3;
			plotToolBarButton9.LoadingEnd();
			plotToolBarButton10.LoadingBegin();
			plotToolBarButton10.Command = PlotToolBarCommandStyle.Select;
			((ToolBarButton)plotToolBarButton10).ImageIndex = 6;
			((ToolBarButton)plotToolBarButton10).Name = "plotToolBarButton10";
			((ToolBarButton)plotToolBarButton10).Pushed = true;
			((ToolBarButton)plotToolBarButton10).ToolTipText = "Select";
			plotToolBarButton10.LoadingEnd();
			plotToolBarButton11.LoadingBegin();
			plotToolBarButton11.Command = PlotToolBarCommandStyle.ZoomBox;
			((ToolBarButton)plotToolBarButton11).ImageIndex = 7;
			((ToolBarButton)plotToolBarButton11).Name = "plotToolBarButton11";
			((ToolBarButton)plotToolBarButton11).ToolTipText = "Zoom-Box";
			plotToolBarButton11.LoadingEnd();
			plotToolBarButton12.LoadingBegin();
			plotToolBarButton12.Command = PlotToolBarCommandStyle.DataCursor;
			((ToolBarButton)plotToolBarButton12).ImageIndex = 8;
			((ToolBarButton)plotToolBarButton12).Name = "plotToolBarButton12";
			((ToolBarButton)plotToolBarButton12).ToolTipText = "Data-Cursor";
			plotToolBarButton12.LoadingEnd();
			plotToolBarButton13.LoadingBegin();
			plotToolBarButton13.Command = PlotToolBarCommandStyle.Separator;
			((ToolBarButton)plotToolBarButton13).Enabled = false;
			((ToolBarButton)plotToolBarButton13).Name = "plotToolBarButton13";
			((ToolBarButton)plotToolBarButton13).Style = (ToolBarButtonStyle)3;
			plotToolBarButton13.LoadingEnd();
			plotToolBarButton14.LoadingBegin();
			plotToolBarButton14.Command = PlotToolBarCommandStyle.Edit;
			((ToolBarButton)plotToolBarButton14).ImageIndex = 9;
			((ToolBarButton)plotToolBarButton14).Name = "plotToolBarButton14";
			((ToolBarButton)plotToolBarButton14).ToolTipText = "Edit";
			plotToolBarButton14.LoadingEnd();
			plotToolBarButton15.LoadingBegin();
			plotToolBarButton15.Command = PlotToolBarCommandStyle.Separator;
			((ToolBarButton)plotToolBarButton15).Enabled = false;
			((ToolBarButton)plotToolBarButton15).Name = "plotToolBarButton15";
			((ToolBarButton)plotToolBarButton15).Style = (ToolBarButtonStyle)3;
			plotToolBarButton15.LoadingEnd();
			plotToolBarButton16.LoadingBegin();
			plotToolBarButton16.Command = PlotToolBarCommandStyle.Copy;
			((ToolBarButton)plotToolBarButton16).Enabled = false;
			((ToolBarButton)plotToolBarButton16).ImageIndex = 10;
			((ToolBarButton)plotToolBarButton16).Name = "plotToolBarButton16";
			((ToolBarButton)plotToolBarButton16).ToolTipText = "Copy to Clipboard";
			plotToolBarButton16.LoadingEnd();
			plotToolBarButton17.LoadingBegin();
			plotToolBarButton17.Command = PlotToolBarCommandStyle.Save;
			((ToolBarButton)plotToolBarButton17).ImageIndex = 11;
			((ToolBarButton)plotToolBarButton17).Name = "plotToolBarButton17";
			((ToolBarButton)plotToolBarButton17).ToolTipText = "Save";
			plotToolBarButton17.LoadingEnd();
			plotToolBarButton18.LoadingBegin();
			plotToolBarButton18.Command = PlotToolBarCommandStyle.Separator;
			((ToolBarButton)plotToolBarButton18).Enabled = false;
			((ToolBarButton)plotToolBarButton18).Name = "plotToolBarButton18";
			((ToolBarButton)plotToolBarButton18).Style = (ToolBarButtonStyle)3;
			plotToolBarButton18.LoadingEnd();
			plotToolBarButton19.LoadingBegin();
			plotToolBarButton19.Command = PlotToolBarCommandStyle.Print;
			((ToolBarButton)plotToolBarButton19).ImageIndex = 12;
			((ToolBarButton)plotToolBarButton19).Name = "plotToolBarButton19";
			((ToolBarButton)plotToolBarButton19).ToolTipText = "Print";
			plotToolBarButton19.LoadingEnd();
			plotToolBarButton20.LoadingBegin();
			plotToolBarButton20.Command = PlotToolBarCommandStyle.Preview;
			((ToolBarButton)plotToolBarButton20).ImageIndex = 13;
			((ToolBarButton)plotToolBarButton20).Name = "plotToolBarButton20";
			((ToolBarButton)plotToolBarButton20).ToolTipText = "Preview";
			plotToolBarButton20.LoadingEnd();
			plotToolBarButton21.LoadingBegin();
			plotToolBarButton21.Command = PlotToolBarCommandStyle.PageSetup;
			((ToolBarButton)plotToolBarButton21).ImageIndex = 14;
			((ToolBarButton)plotToolBarButton21).Name = "plotToolBarButton21";
			((ToolBarButton)plotToolBarButton21).ToolTipText = "Page Setup";
			plotToolBarButton21.LoadingEnd();
			imageList4.ImageStream = (ImageListStreamer)componentResourceManager.GetObject("imageList4.ImageStream");
			imageList4.TransparentColor = Color.Transparent;
			imageList4.Images.SetKeyName(0, "");
			imageList4.Images.SetKeyName(1, "");
			imageList4.Images.SetKeyName(2, "");
			imageList4.Images.SetKeyName(3, "");
			imageList4.Images.SetKeyName(4, "");
			imageList4.Images.SetKeyName(5, "");
			imageList4.Images.SetKeyName(6, "");
			imageList4.Images.SetKeyName(7, "");
			imageList4.Images.SetKeyName(8, "");
			imageList4.Images.SetKeyName(9, "");
			imageList4.Images.SetKeyName(10, "");
			imageList4.Images.SetKeyName(11, "");
			imageList4.Images.SetKeyName(12, "");
			imageList4.Images.SetKeyName(13, "");
			((Control)this).Controls.Add((Control)(object)splitterGraph);
			((Control)this).Controls.Add((Control)(object)graphControl);
			((Control)this).Controls.Add((Control)(object)plotToolBarStandard1);
			((Control)this).Name = "GraphicalMonitoredGroupView";
			((Control)this).Size = new Size(1320, 576);
			((Control)this).Controls.SetChildIndex((Control)(object)plotToolBarStandard1, 0);
			((Control)this).Controls.SetChildIndex((Control)(object)graphControl, 0);
			((Control)this).Controls.SetChildIndex((Control)(object)splitterGraph, 0);
			((Control)this).ResumeLayout(false);
			((Control)this).PerformLayout();
		}

		private void OnParameterRemoved(object sender, ParameterEventArgs e)
		{
			RemoveParameterFromGraph(e.SourceAddress.Value, e.Name);
		}

		private void OnScreenUpdate(object sender, EventArgs e)
		{
			if (((Control)this).InvokeRequired)
			{
				((Control)this).BeginInvoke((Delegate)new EventHandler(OnScreenUpdate), new object[2] { sender, e });
			}
			else
			{
				if (CurrentlyRefreshing)
				{
					return;
				}
				CurrentlyRefreshing = true;
				lock (gdmController.Data)
				{
					try
					{
						SortedList sortedList = new SortedList();
						lock (gdmModel.DeviceList)
						{
							foreach (string key3 in gdmModel.DeviceList.Keys)
							{
								DeviceDataPoints deviceDataPoints = (DeviceDataPoints)gdmModel.DeviceList[key3];
								if (deviceDataPoints.DataPoints.Count > 0)
								{
									sortedList.Add(key3, deviceDataPoints.Clone());
								}
								deviceDataPoints.ClearList();
							}
						}
						if (sortedList.Count <= 0)
						{
							return;
						}
						string text = "";
						string filterExpression = "PlotGraph = true";
						DataRow[] array = gdmController.Data.Select(filterExpression);
						filterExpression = "ViewType ='" + GraphicalMonitorViewType.Gauge.ToString() + "'";
						DataRow[] array2 = gdmController.Data.Select(filterExpression);
						DataRefreshEventArgs e2 = null;
						graphControl.EndUpdate();
						if (array.Length > 0)
						{
							foreach (string key4 in sortedList.Keys)
							{
								SortedList sortedList2 = (SortedList)sortedList[key4];
								lock (sortedList2)
								{
									foreach (long key5 in sortedList2.Keys)
									{
										DateTime dateTime = new DateTime(key5);
										if (!_timeStartedSet)
										{
											_timeStarted = new DateTime(dateTime.Ticks);
											_timeStartedSet = true;
										}
										e2 = (DataRefreshEventArgs)sortedList2[key5];
										for (int i = 0; i < e2.ParameterCount; i++)
										{
											DataUpdate notficationValue = gdmController.GetNotficationValue(e2, i);
											if (notficationValue.IsEmpty)
											{
												continue;
											}
											text = GenerateGraphParameterKey(e2.SourceAddress.DisplayId.Trim(), notficationValue.name);
											PlotChannelTrace plotChannelTrace = graphControl.Channels.Trace[text];
											if (plotChannelTrace == null && AddressOffsetToChannelName.ContainsKey(notficationValue.name))
											{
												text = AddressOffsetToChannelName[notficationValue.name];
												plotChannelTrace = graphControl.Channels.Trace[text];
											}
											if (plotChannelTrace == null)
											{
												continue;
											}
											try
											{
												plotChannelTrace.AddXY((dateTime - _timeStarted).TotalSeconds, notficationValue.dataValue);
												if (plotChannelTrace.Count > 40000)
												{
													plotChannelTrace.RemoveRange(0, plotChannelTrace.Count - 40000);
												}
											}
											catch (Exception)
											{
											}
										}
									}
								}
							}
						}
						if (array2.Length > 0)
						{
							for (int j = 0; j < array2.Length; j++)
							{
								UpdateGaugeValue((int)array2[j]["Index"], array2[j]["Value"].ToString());
							}
						}
					}
					catch (Exception)
					{
					}
					finally
					{
						graphControl.BeginUpdate();
						CurrentlyRefreshing = false;
					}
				}
			}
		}

		private void UpdateGaugeValue(int gaugeIndex, string gaugeValue)
		{
			try
			{
				dashBoard[gaugeIndex].Value = gaugeValue;
			}
			catch (Exception)
			{
			}
		}

		private string RawDataToString(object rawData)
		{
			byte[] array = (byte[])rawData;
			string text = "";
			byte[] array2 = array;
			foreach (byte b in array2)
			{
				text += b.ToString("X2");
			}
			return text;
		}

		private void OnCleanUpData(object sender, EventArgs e)
		{
			if (TimeBarValues != null)
			{
				TimeBarValues.Clear();
			}
			CurrentlyRefreshing = false;
		}

		private void OnGDMParameterAdded(object sender, GraphicalMonitorParameterEventArgs e)
		{
			try
			{
				if (GraphicalMonitorViewType.Gauge == (GraphicalMonitorViewType)Enum.Parse(typeof(GraphicalMonitorViewType), e.GraphicalParameterRow[GraphicalMonitoredGroupController.ViewTypeColumn].ToString(), ignoreCase: true))
				{
					GaugeControl gaugeControl = dashBoard[int.Parse(e.GraphicalParameterRow["Index"].ToString())];
					IAddressValue key = AddressFactory.ProductAddressValue(e.GraphicalParameterRow["SourceAddress"].ToString());
					ICalibration calibration = (ICalibration)gdmController.Calibrations[key];
					string text = e.GraphicalParameterRow["Name"].ToString();
					int num = text.IndexOf('[');
					if (num > 0)
					{
						text = text.Substring(0, num);
					}
					IParameterModel model = calibration.Get(text);
					Cummins.Parameter.Parameter parameter = new Cummins.Parameter.Parameter(model);
					gaugeControl.Parameter = parameter;
					return;
				}
				if ((bool)e.GraphicalParameterRow[GraphicalMonitoredGroupController.PlotGraphColumn])
				{
					AddParameterOnGraph(e.GraphicalParameterRow);
					return;
				}
				string filterExpression = string.Format("Name = '{0}' AND SourceAddress = '{1}'", e.GraphicalParameterRow["Name"].ToString(), e.GraphicalParameterRow["SourceAddress"].ToString());
				DataRow[] array = gdmController.Data.Select(filterExpression);
				DataRow[] array2 = array;
				foreach (DataRow dataRow in array2)
				{
					if (dataRow[GraphicalMonitoredGroupController.ColorColumn] != DBNull.Value && dataRow[GraphicalMonitoredGroupController.ColorColumn].ToString().Length > 0)
					{
						e.GraphicalParameterRow[GraphicalMonitoredGroupController.ColorColumn] = dataRow[GraphicalMonitoredGroupController.ColorColumn];
						e.GraphicalParameterRow[GraphicalMonitoredGroupController.PlotGraphColumn] = dataRow[GraphicalMonitoredGroupController.PlotGraphColumn];
						e.GraphicalParameterRow[GraphicalMonitoredGroupController.ViewTypeColumn] = dataRow[GraphicalMonitoredGroupController.ViewTypeColumn];
						break;
					}
				}
			}
			catch (Exception)
			{
			}
		}

		private void OnAvailableSourceAddressChanged(object sender, AvailableSourceAddressChangedEventArgs e)
		{
			for (int i = 0; i < 6; i++)
			{
				dashBoard[i].SetSourceAddress(e.AvailableSourceAddresses);
			}
		}

		private void OnGraphConfigurationChanged(object sender, EventArgs e)
		{
			RefreshGraphView();
		}

		private void OnGaugeConfigurationChanged(object sender, EventArgs e)
		{
			foreach (NewDataSet.GaugeRow item in gdmModel.GaugeConfiguration)
			{
				dashBoard[item.Index].GaugeRow = item;
			}
		}

		private void OnGuageConfigurationRestore(object sender, GuageConfigurationRestoreEventArgs args)
		{
			NewDataSet.GaugeRow[] restoreGuageConfigurationRows = args.RestoreGuageConfigurationRows;
			foreach (NewDataSet.GaugeRow gaugeRow in restoreGuageConfigurationRows)
			{
				((Control)dashBoard).Visible = gdmModel.ShowGauges;
				dashBoard[gaugeRow.Index].GaugeRow = gaugeRow;
			}
		}

		private void Data_ColumnChanging(object sender, DataColumnChangeEventArgs e)
		{
			if ((gdmController.EditorState != EditorState.Idle && gdmController.EditorState != EditorState.RefreshOver) || e.ProposedValue == DBNull.Value)
			{
				return;
			}
			gdmController.EditorState = EditorState.Editing;
			if (e.Column.ColumnName == GraphicalMonitoredGroupController.PlotGraphColumn && e.Row["SourceAddress"] != DBNull.Value && e.Row["Name"] != DBNull.Value)
			{
				if ((bool)e.ProposedValue)
				{
					AddParameterOnGraph(e.Row);
				}
				else
				{
					RemoveParameterFromGraph(e.Row["SourceAddress"].ToString(), e.Row["Name"].ToString());
					e.Row[GraphicalMonitoredGroupController.ViewTypeColumn] = GraphicalMonitorViewType.Normal.ToString();
				}
				((Control)graphControl).Focus();
				((Control)base.Grid).Focus();
				gdmModel.IsChanged = true;
			}
			gdmController.EditorState = EditorState.EditOver;
		}

		private void CopyGraphToClipBoard()
		{
			//IL_003c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0042: Expected O, but got Unknown
			Thread.Sleep(100);
			Graphics val = ((Control)graphControl).CreateGraphics();
			Image val2 = (Image)new Bitmap(((Control)graphControl).ClientRectangle.Width, ((Control)graphControl).ClientRectangle.Height, val);
			Graphics val3 = Graphics.FromImage(val2);
			IntPtr hdc = val.GetHdc();
			IntPtr hdc2 = val3.GetHdc();
			BitBlt(hdc2, 0, 0, ((Control)graphControl).ClientRectangle.Width, ((Control)graphControl).ClientRectangle.Height, hdc, 0, 0, 13369376);
			val.ReleaseHdc(hdc);
			val3.ReleaseHdc(hdc2);
			Clipboard.SetDataObject((object)val2, true);
		}

		private void RefreshGraphView()
		{
			DataSet graphConfiguration = gdmModel.GraphConfiguration;
			DataRow generalConfiguration = graphConfiguration.Tables["General"].Rows[0];
			SetGeneralConfiguration(generalConfiguration);
		}

		private void SetGeneralConfiguration(DataRow row)
		{
			int uIRefreshRate = gdmController.UIRefreshRate;
			try
			{
				uIRefreshRate = int.Parse(row["ScreenRefreshRate"].ToString());
			}
			catch
			{
			}
			gdmController.UIRefreshRate = uIRefreshRate;
			try
			{
				string text = row["IOCompSettings"].ToString();
				if (!string.IsNullOrEmpty(text))
				{
					UTF8Encoding uTF8Encoding = new UTF8Encoding();
					byte[] bytes = uTF8Encoding.GetBytes(text);
					MemoryStream memoryStream = new MemoryStream(text.Length);
					memoryStream.Write(bytes, 0, bytes.Length);
					memoryStream.Seek(0L, SeekOrigin.Begin);
					StreamReader streamReader = new StreamReader(memoryStream);
					graphControl.LoadPropertiesFromStream(streamReader);
				}
			}
			catch
			{
			}
		}

		private void CreateDashBoard()
		{
			dashBoard = new DashBoard(6, gdmModel.GaugeConfiguration);
			((Control)dashBoard).Dock = (DockStyle)5;
			((Control)dashBoard).Location = new Point(0, 0);
			((Control)dashBoard).Name = "dashBoard";
			((Control)dashBoard).Size = new Size(800, 221);
			((Control)dashBoard).TabIndex = 0;
			((Control)dashBoard).Visible = false;
		}

		private void ArrangeComponents()
		{
			//IL_002c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0032: Expected O, but got Unknown
			if (((Control)this).Controls.Contains((Control)(object)Panel))
			{
				foreach (Control item in (ArrangedElementCollection)((Control)Panel).Controls)
				{
					Control val = item;
					((Control)this).Controls.Add(val);
					((Control)Panel).Controls.Remove(val);
				}
				((Control)this).Controls.Remove((Control)(object)Panel);
			}
			((ScrollableControl)this).DockPadding.Bottom = 10;
			((Control)base.Grid).Size = new Size(100, 70);
			((Control)base.Grid).Dock = (DockStyle)2;
			((Control)this).Controls.Add((Control)(object)dashBoard);
			((Control)dashBoard).Dock = (DockStyle)2;
			((Control)graphControl).Dock = (DockStyle)5;
		}

		private void RegisterEvents()
		{
			gdmController.GDMParameterAddedEvent += OnGDMParameterAdded;
			gdmController.GuageConfigurationRestoreEvent += OnGuageConfigurationRestore;
			gdmController.Data.ColumnChanging += Data_ColumnChanging;
			gdmModel.ParameterRemoved += OnParameterRemoved;
			gdmModel.GraphConfigurationChangedEvent += OnGraphConfigurationChanged;
			gdmController.AvailableSourceAddressChangedEvent += OnAvailableSourceAddressChanged;
			dashBoard.GaugeParameterChangedEvent += gdmController.OnGaugeParameterChanged;
			gdmController.ScreenUpdateEvent += OnScreenUpdate;
			gdmController.CleanUpDataEvent += OnCleanUpData;
			gdmController.PrepareToSaveSettingsEvent += OnPrepareToSaveSettingsEvent;
		}

		private void OnPrepareToSaveSettingsEvent(object sender, EventArgs e)
		{
			MemoryStream memoryStream = new MemoryStream();
			StreamWriter streamWriter = new StreamWriter(memoryStream);
			graphControl.SavePropertiesToStream(streamWriter);
			streamWriter.Close();
			ASCIIEncoding aSCIIEncoding = new ASCIIEncoding();
			byte[] buffer = memoryStream.GetBuffer();
			string text = aSCIIEncoding.GetString(buffer);
			text = text.Replace("\0", "");
			DataSet graphConfiguration = gdmModel.GraphConfiguration;
			DataRow dataRow = graphConfiguration.Tables["General"].Rows[0];
			dataRow["IOCompSettings"] = text;
		}

		protected override void OnKeyDown(object sender, KeyEventArgs e)
		{
			//IL_0001: Unknown result type (might be due to invalid IL or missing references)
			//IL_0006: Unknown result type (might be due to invalid IL or missing references)
			//IL_0007: Unknown result type (might be due to invalid IL or missing references)
			//IL_000a: Invalid comparison between Unknown and I4
			Keys keyCode = e.KeyCode;
			if ((int)keyCode == 46)
			{
				DataRow[] array = gdmController.Data.Select("Order =" + CurrentRowIndex);
				if (array.Length == 1)
				{
					try
					{
						string filterExpression = string.Format("Name = '{0}' AND SourceAddress = '{1}' AND ViewType = 'Graph'", array[0]["Name"], array[0]["SourceAddress"]);
						if (gdmController.Data.Select(filterExpression).Length == 1)
						{
							array[0][GraphicalMonitoredGroupController.PlotGraphColumn] = false;
						}
					}
					catch
					{
					}
				}
			}
			base.OnKeyDown(sender, e);
		}

		private void AssociateDataView()
		{
			//IL_0054: Unknown result type (might be due to invalid IL or missing references)
			//IL_005e: Expected O, but got Unknown
			DataView dataView = new DataView(gdmController.Data);
			dataView.AllowDelete = true;
			dataView.AllowNew = true;
			dataView.AllowEdit = true;
			dataView.RowFilter = "ViewType = 'Graph' OR ViewType = 'Normal'";
			((DataGrid)base.Grid).SetDataBinding((object)dataView, "");
			cm = (CurrencyManager)((Control)this).BindingContext[(object)dataView, ""];
		}

		private void UnRegisterEvents()
		{
			gdmController.GDMParameterAddedEvent -= OnGDMParameterAdded;
			gdmController.GuageConfigurationRestoreEvent -= OnGuageConfigurationRestore;
			gdmController.Data.ColumnChanging -= Data_ColumnChanging;
			gdmModel.ParameterRemoved -= OnParameterRemoved;
			gdmModel.GraphConfigurationChangedEvent -= OnGraphConfigurationChanged;
			gdmController.AvailableSourceAddressChangedEvent -= OnAvailableSourceAddressChanged;
			if (dashBoard != null)
			{
				dashBoard.GaugeParameterChangedEvent -= gdmController.OnGaugeParameterChanged;
			}
			gdmController.CleanUpDataEvent -= OnCleanUpData;
			gdmController.ScreenUpdateEvent -= OnScreenUpdate;
			gdmController.PrepareToSaveSettingsEvent -= OnPrepareToSaveSettingsEvent;
			lastUpdate = DateTime.Now;
		}

		private void AddParameterOnGraph(DataRow row)
		{
			if (((Control)this).InvokeRequired)
			{
				((Control)this).BeginInvoke((Delegate)new AddParameterOnGraphDelegate(AddParameterOnGraph), new object[1] { row });
				return;
			}
			string text = GenerateGraphParameterKey(row);
			if (graphControl.Channels[text] == null)
			{
				lock (gdmController.Data)
				{
					string titleText = row["Name"].ToString();
					row["SourceAddress"].ToString();
					PlotChannelTrace plotChannelTrace = new PlotChannelTrace();
					PlotYAxis plotYAxis = CreateYAxisForParameter(row);
					if (!string.IsNullOrEmpty(row["Address"].ToString()))
					{
						string key = row["Address"].ToString() + " " + row["Offset"].ToString();
						AddressOffsetToChannelName.Add(key, plotYAxis.Name);
					}
					graphControl.YAxes.Add(plotYAxis);
					plotChannelTrace.YAxisName = plotYAxis.Name;
					plotChannelTrace.Trace.Thickness = 2;
					plotChannelTrace.Capacity = 40000;
					if (graphControl.YAxes.Count > 1)
					{
						plotYAxis.GridLines.Visible = false;
					}
					plotChannelTrace.Name = text;
					plotChannelTrace.TitleText = titleText;
					graphControl.Channels.Add(plotChannelTrace);
					graphControl.YAxes[text].Color = graphControl.Channels[text].Color;
					row[GraphicalMonitoredGroupController.ViewTypeColumn] = GraphicalMonitorViewType.Graph.ToString();
				}
			}
			if (TimeBarValues.ContainsKey(text))
			{
				TimeBarValues.Remove(text);
			}
		}

		private void RemoveParameterFromGraph(string sourceAddress, string parameterName)
		{
			string text = sourceAddress + " " + parameterName;
			if (graphControl.Channels[text] != null)
			{
				graphControl.Channels.Remove(graphControl.Channels[text]);
				graphControl.YAxes.Remove(graphControl.YAxes[text]);
			}
			if (TimeBarValues.ContainsKey(text))
			{
				TimeBarValues.Remove(text);
			}
			if (graphControl.Channels.Count == 0)
			{
				CurrentlyRefreshing = false;
			}
		}

		private PlotYAxis CreateYAxisForParameter(DataRow row)
		{
			PlotYAxis plotYAxis = new PlotYAxis();
			string name = (plotYAxis.Title.Text = GenerateGraphParameterKey(row));
			plotYAxis.Name = name;
			plotYAxis.DockOrder = dockingIndex++;
			plotYAxis.Title.Visible = true;
			plotYAxis.Title.MarginSpacing = 0.0;
			plotYAxis.ScaleDisplay.Margin = 0;
			plotYAxis.ScaleDisplay.TextWidthMinValue = 0.0;
			return plotYAxis;
		}

		private string GenerateGraphParameterKey(DataRow row)
		{
			return GenerateGraphParameterKey(row["SourceAddress"].ToString(), row["Name"].ToString());
		}

		private string GenerateGraphParameterKey(string sourceAddress, string name)
		{
			return sourceAddress.ToString() + " " + name;
		}

		private void menuItemGauges_Click(object sender, EventArgs e)
		{
			((Control)dashBoard).Visible = !((Control)dashBoard).Visible;
			menuItemGaugesShow.Text = (((Control)dashBoard).Visible ? "&Hide gauges" : "&Show gauges");
			gdmModel.ShowGauges = (((Control)dashBoard).Visible ? true : false);
		}

		[DllImport("gdi32.dll")]
		private static extern bool BitBlt(IntPtr hdcDest, int nXDest, int nYDest, int nWidth, int nHeight, IntPtr hdcSrc, int nXSrc, int nYSrc, int dwRop);
	}
	internal class GraphModeChangedEventArgs : EventArgs
	{
		private GraphType graphType;

		public GraphType GraphType => graphType;

		public GraphModeChangedEventArgs(GraphType typeOfGraph)
		{
			graphType = typeOfGraph;
		}
	}
	internal class GraphicalMonitorParameterEventArgs : EventArgs
	{
		private DataRow row;

		public DataRow GraphicalParameterRow => row;

		public GraphicalMonitorParameterEventArgs(DataRow row)
		{
			this.row = row;
			_ = row[GraphicalMonitoredGroupController.ViewTypeColumn];
			_ = row[GraphicalMonitoredGroupController.ColorColumn];
			_ = row[GraphicalMonitoredGroupController.PlotGraphColumn];
		}
	}
	internal class ParameterChangedEventArgs : EventArgs
	{
		private string sourceAddr = string.Empty;

		private string parameterName = string.Empty;

		private ActionType action;

		public string SourceAddress => sourceAddr;

		public string ParameterName => parameterName;

		public ActionType Action => action;

		public ParameterChangedEventArgs(string sourceAddr, string parameterName, ActionType action)
		{
			this.sourceAddr = sourceAddr;
			this.parameterName = parameterName;
			this.action = action;
		}
	}
	internal class AvailableSourceAddressChangedEventArgs : EventArgs
	{
		private ArrayList availableSourceAddresses;

		public ArrayList AvailableSourceAddresses
		{
			get
			{
				if (availableSourceAddresses == null)
				{
					availableSourceAddresses = new ArrayList();
				}
				return availableSourceAddresses;
			}
		}

		public AvailableSourceAddressChangedEventArgs(ArrayList addressList)
		{
			availableSourceAddresses = addressList;
		}
	}
	internal class UpdatedConnectionEventArgs : EventArgs
	{
		private IAddressValue sourceAddress;

		private bool connected;

		public IAddressValue SourceAddress => sourceAddress;

		public bool Connected => connected;

		public UpdatedConnectionEventArgs(IAddressValue sourceAddress, bool connected)
		{
			this.sourceAddress = sourceAddress;
			this.connected = connected;
		}
	}
	internal class GaugeParameterChangedEventArgs : ParameterChangedEventArgs
	{
		private int gaugeIndex = -1;

		public int GaugeIndex => gaugeIndex;

		public GaugeParameterChangedEventArgs(int gaugeIndex, ParameterChangedEventArgs e)
			: base(e.SourceAddress, e.ParameterName, e.Action)
		{
			this.gaugeIndex = gaugeIndex;
		}
	}
	internal class GuageConfigurationRestoreEventArgs : EventArgs
	{
		private NewDataSet.GaugeRow[] restoreGuageConfigurationRows;

		public NewDataSet.GaugeRow[] RestoreGuageConfigurationRows => restoreGuageConfigurationRows;

		public GuageConfigurationRestoreEventArgs(NewDataSet.GaugeRow[] restoreGuageConfigurationRows)
		{
			this.restoreGuageConfigurationRows = restoreGuageConfigurationRows;
		}
	}
	internal class UIRefreshRateChangedEventArgs : EventArgs
	{
		private int refreshRate;

		public int RefreshRate => refreshRate;

		public UIRefreshRateChangedEventArgs(int refreshRate)
		{
			this.refreshRate = refreshRate;
		}
	}
	public class GraphicalScreenController : ScreenController
	{
		public GraphicalScreenController(ScreenModel model)
			: base(model)
		{
		}

		protected override void OnDataRefresh(object sender, DataRefreshEventArgs e)
		{
			foreach (MonitoredGroup monitorColumn in base.Model.MonitorColumns)
			{
				monitorColumn.SaveDataPoint(e);
			}
			base.OnDataRefresh(sender, e);
		}

		public override void StopMonitoring()
		{
			base.StopMonitoring();
			foreach (MonitoredGroup monitorColumn in base.Model.MonitorColumns)
			{
				monitorColumn.CleanUpData();
			}
		}
	}
	internal class GraphProperties : Form
	{
		private const string LANDSCAPE = "Landscape";

		private const string PORTRAIT = "Portrait";

		private DataSet configuration;

		private Button buttonOk;

		private Button buttonCancel;

		private TabPage tabPageGeneral;

		private GroupBox groupBoxBackground;

		private Label labelBackGroundColor;

		private TabControl tabControlA;

		private TabPage tabPageGridLines;

		private TabPage tabPagePrint;

		private GroupBox groupBox1;

		private TextBox textBoxTopMargin;

		private TextBox textBoxBottomMargin;

		private TextBox textBoxLeftMargin;

		private TextBox textBoxRightMargin;

		private GroupBox groupBoxOrientation;

		private RadioButton radioButtonLandscape;

		private RadioButton radioButtonPortrait;

		private GroupBox groupBoxTitle;

		private Label label1;

		private TextBox textBoxTitle;

		private CheckBox checkBoxTitleVisible;

		private Label labelTitlePosition;

		private ComboBox comboBoxtitlePosition;

		private CheckBox checkBoxShowXMajorGrids;

		private GroupBox groupBoxXAxis;

		private GroupBox groupBoxYAxis;

		private Label labelXMajorUnit;

		private Label labelXMinorUnit;

		private TextBox textBoxXMajorUnits;

		private TextBox textBoxXMinorUnit;

		private TextBox textBoxYMinorUnit;

		private TextBox textBoxYMajorUnit;

		private Label labelYMinorAxis;

		private Label labelYMajorAxis;

		private Label labelXMinorGridColor;

		private CheckBox checkBoxShowXMinorGrids;

		private CheckBox checkBoxShowYMinorGrids;

		private CheckBox checkBoxShowYMajorGrids;

		private Label labelXMajorGridColor;

		private Label labelYMajorGridColor;

		private Label labelYMinorGridColor;

		private ColorSelectionControl colorSelectionBackground;

		private ColorSelectionControl colorSelectionMinorY;

		private ColorSelectionControl colorSelectionMajorY;

		private ColorSelectionControl colorSelectionMinorX;

		private ColorSelectionControl colorSelectionMajorX;

		private Label labelAxisPosition;

		private ComboBox comboBoxAxisPosition;

		private Label labelScaleType;

		private ComboBox comboBoxScaleType;

		private TabPage tabPageYAxis;

		private TabPage tabPageRange;

		private DataGrid dataGridParameters;

		private TabPage tabPageXAxis;

		private Label labelAxisDislpalyMode;

		private ComboBox comboBoxlAxisDislpalyMode;

		private Label labelXaxisStart;

		private Label labelXaxisEnd;

		private Label labelCursor;

		private TextBox textBoxXaxisStart;

		private TextBox textBoxRefershRate;

		private Label labelRefershRate;

		private TextBox textBoxXaxisEnd;

		private ColorSelectionControl colorSelectionControlCursor;

		private CheckBox checkBoxAutoScaleYAxis;

		private TextBox textBoxMaxYAxis;

		private TextBox textBoxMinYAxis;

		private Label labelMaxYAxis;

		private Label labelMinYAxis;

		private RadioButton radioButtonCommonYAxis;

		private RadioButton radioButtonIndividualYAxis;

		private GroupBox groupBoxYAxisScale;

		private CheckBox checkBoxHideYAxis;

		private CheckBox checkBoxHideYAxisCaption;

		private Container components;

		public GraphProperties(DataSet configuration)
		{
			//IL_008f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0095: Expected O, but got Unknown
			InitializeComponent();
			this.configuration = configuration;
			configuration.Tables["Parameters"].DefaultView.AllowDelete = false;
			configuration.Tables["Parameters"].DefaultView.AllowNew = false;
			dataGridParameters.SetDataBinding((object)configuration.Tables["Parameters"].DefaultView, "");
			configuration.Tables["Parameters"].ColumnChanging += OnParameterColumnChangingEventHandler;
			DataGridTableStyle val = new DataGridTableStyle();
			val.MappingName = "Parameters";
			dataGridParameters.TableStyles.Add(val);
			val.GridColumnStyles["SourceAddress"].Width = 50;
			val.GridColumnStyles["SourceAddress"].ReadOnly = true;
			val.GridColumnStyles["Name"].Width = 210;
			val.GridColumnStyles["Name"].ReadOnly = true;
			val.GridColumnStyles[GraphicalMonitoredGroupController.LowerBoundColumn].Width = 70;
			val.GridColumnStyles[GraphicalMonitoredGroupController.UpperBoundColumn].Width = 70;
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			((Form)this).Dispose(disposing);
		}

		private void InitializeComponent()
		{
			//IL_0011: Unknown result type (might be due to invalid IL or missing references)
			//IL_001b: Expected O, but got Unknown
			//IL_001c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0026: Expected O, but got Unknown
			//IL_0027: Unknown result type (might be due to invalid IL or missing references)
			//IL_0031: Expected O, but got Unknown
			//IL_0032: Unknown result type (might be due to invalid IL or missing references)
			//IL_003c: Expected O, but got Unknown
			//IL_003d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0047: Expected O, but got Unknown
			//IL_0048: Unknown result type (might be due to invalid IL or missing references)
			//IL_0052: Expected O, but got Unknown
			//IL_0053: Unknown result type (might be due to invalid IL or missing references)
			//IL_005d: Expected O, but got Unknown
			//IL_005e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0068: Expected O, but got Unknown
			//IL_0069: Unknown result type (might be due to invalid IL or missing references)
			//IL_0073: Expected O, but got Unknown
			//IL_0074: Unknown result type (might be due to invalid IL or missing references)
			//IL_007e: Expected O, but got Unknown
			//IL_007f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0089: Expected O, but got Unknown
			//IL_0095: Unknown result type (might be due to invalid IL or missing references)
			//IL_009f: Expected O, but got Unknown
			//IL_00a0: Unknown result type (might be due to invalid IL or missing references)
			//IL_00aa: Expected O, but got Unknown
			//IL_00ab: Unknown result type (might be due to invalid IL or missing references)
			//IL_00b5: Expected O, but got Unknown
			//IL_00b6: Unknown result type (might be due to invalid IL or missing references)
			//IL_00c0: Expected O, but got Unknown
			//IL_00c1: Unknown result type (might be due to invalid IL or missing references)
			//IL_00cb: Expected O, but got Unknown
			//IL_00cc: Unknown result type (might be due to invalid IL or missing references)
			//IL_00d6: Expected O, but got Unknown
			//IL_00d7: Unknown result type (might be due to invalid IL or missing references)
			//IL_00e1: Expected O, but got Unknown
			//IL_00e2: Unknown result type (might be due to invalid IL or missing references)
			//IL_00ec: Expected O, but got Unknown
			//IL_00ed: Unknown result type (might be due to invalid IL or missing references)
			//IL_00f7: Expected O, but got Unknown
			//IL_00f8: Unknown result type (might be due to invalid IL or missing references)
			//IL_0102: Expected O, but got Unknown
			//IL_0103: Unknown result type (might be due to invalid IL or missing references)
			//IL_010d: Expected O, but got Unknown
			//IL_010e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0118: Expected O, but got Unknown
			//IL_012f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0139: Expected O, but got Unknown
			//IL_013a: Unknown result type (might be due to invalid IL or missing references)
			//IL_0144: Expected O, but got Unknown
			//IL_0145: Unknown result type (might be due to invalid IL or missing references)
			//IL_014f: Expected O, but got Unknown
			//IL_0150: Unknown result type (might be due to invalid IL or missing references)
			//IL_015a: Expected O, but got Unknown
			//IL_015b: Unknown result type (might be due to invalid IL or missing references)
			//IL_0165: Expected O, but got Unknown
			//IL_0166: Unknown result type (might be due to invalid IL or missing references)
			//IL_0170: Expected O, but got Unknown
			//IL_0171: Unknown result type (might be due to invalid IL or missing references)
			//IL_017b: Expected O, but got Unknown
			//IL_017c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0186: Expected O, but got Unknown
			//IL_0187: Unknown result type (might be due to invalid IL or missing references)
			//IL_0191: Expected O, but got Unknown
			//IL_01a8: Unknown result type (might be due to invalid IL or missing references)
			//IL_01b2: Expected O, but got Unknown
			//IL_01b3: Unknown result type (might be due to invalid IL or missing references)
			//IL_01bd: Expected O, but got Unknown
			//IL_01be: Unknown result type (might be due to invalid IL or missing references)
			//IL_01c8: Expected O, but got Unknown
			//IL_01c9: Unknown result type (might be due to invalid IL or missing references)
			//IL_01d3: Expected O, but got Unknown
			//IL_01d4: Unknown result type (might be due to invalid IL or missing references)
			//IL_01de: Expected O, but got Unknown
			//IL_01df: Unknown result type (might be due to invalid IL or missing references)
			//IL_01e9: Expected O, but got Unknown
			//IL_01ea: Unknown result type (might be due to invalid IL or missing references)
			//IL_01f4: Expected O, but got Unknown
			//IL_01f5: Unknown result type (might be due to invalid IL or missing references)
			//IL_01ff: Expected O, but got Unknown
			//IL_0200: Unknown result type (might be due to invalid IL or missing references)
			//IL_020a: Expected O, but got Unknown
			//IL_0216: Unknown result type (might be due to invalid IL or missing references)
			//IL_0220: Expected O, but got Unknown
			//IL_0221: Unknown result type (might be due to invalid IL or missing references)
			//IL_022b: Expected O, but got Unknown
			//IL_022c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0236: Expected O, but got Unknown
			//IL_0237: Unknown result type (might be due to invalid IL or missing references)
			//IL_0241: Expected O, but got Unknown
			//IL_0242: Unknown result type (might be due to invalid IL or missing references)
			//IL_024c: Expected O, but got Unknown
			//IL_024d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0257: Expected O, but got Unknown
			//IL_0258: Unknown result type (might be due to invalid IL or missing references)
			//IL_0262: Expected O, but got Unknown
			//IL_0263: Unknown result type (might be due to invalid IL or missing references)
			//IL_026d: Expected O, but got Unknown
			//IL_026e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0278: Expected O, but got Unknown
			//IL_0279: Unknown result type (might be due to invalid IL or missing references)
			//IL_0283: Expected O, but got Unknown
			//IL_0284: Unknown result type (might be due to invalid IL or missing references)
			//IL_028e: Expected O, but got Unknown
			//IL_028f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0299: Expected O, but got Unknown
			//IL_029a: Unknown result type (might be due to invalid IL or missing references)
			//IL_02a4: Expected O, but got Unknown
			//IL_02a5: Unknown result type (might be due to invalid IL or missing references)
			//IL_02af: Expected O, but got Unknown
			//IL_02b0: Unknown result type (might be due to invalid IL or missing references)
			//IL_02ba: Expected O, but got Unknown
			//IL_02bb: Unknown result type (might be due to invalid IL or missing references)
			//IL_02c5: Expected O, but got Unknown
			//IL_02c6: Unknown result type (might be due to invalid IL or missing references)
			//IL_02d0: Expected O, but got Unknown
			//IL_02d1: Unknown result type (might be due to invalid IL or missing references)
			//IL_02db: Expected O, but got Unknown
			//IL_02dc: Unknown result type (might be due to invalid IL or missing references)
			//IL_02e6: Expected O, but got Unknown
			//IL_02e7: Unknown result type (might be due to invalid IL or missing references)
			//IL_02f1: Expected O, but got Unknown
			//IL_02f2: Unknown result type (might be due to invalid IL or missing references)
			//IL_02fc: Expected O, but got Unknown
			//IL_02fd: Unknown result type (might be due to invalid IL or missing references)
			//IL_0307: Expected O, but got Unknown
			//IL_0308: Unknown result type (might be due to invalid IL or missing references)
			//IL_0312: Expected O, but got Unknown
			//IL_0313: Unknown result type (might be due to invalid IL or missing references)
			//IL_031d: Expected O, but got Unknown
			//IL_031e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0328: Expected O, but got Unknown
			//IL_0329: Unknown result type (might be due to invalid IL or missing references)
			//IL_0333: Expected O, but got Unknown
			//IL_25e7: Unknown result type (might be due to invalid IL or missing references)
			//IL_25f1: Expected O, but got Unknown
			ComponentResourceManager componentResourceManager = new ComponentResourceManager(typeof(GraphProperties));
			tabControlA = new TabControl();
			tabPageGeneral = new TabPage();
			labelRefershRate = new Label();
			textBoxRefershRate = new TextBox();
			groupBoxTitle = new GroupBox();
			comboBoxtitlePosition = new ComboBox();
			labelTitlePosition = new Label();
			textBoxTitle = new TextBox();
			label1 = new Label();
			checkBoxTitleVisible = new CheckBox();
			groupBoxBackground = new GroupBox();
			colorSelectionBackground = new ColorSelectionControl();
			labelBackGroundColor = new Label();
			tabPagePrint = new TabPage();
			groupBoxOrientation = new GroupBox();
			radioButtonPortrait = new RadioButton();
			radioButtonLandscape = new RadioButton();
			groupBox1 = new GroupBox();
			textBoxRightMargin = new TextBox();
			textBoxLeftMargin = new TextBox();
			textBoxBottomMargin = new TextBox();
			textBoxTopMargin = new TextBox();
			tabPageGridLines = new TabPage();
			groupBoxYAxis = new GroupBox();
			colorSelectionMinorY = new ColorSelectionControl();
			colorSelectionMajorY = new ColorSelectionControl();
			labelYMinorGridColor = new Label();
			labelYMajorGridColor = new Label();
			checkBoxShowYMajorGrids = new CheckBox();
			checkBoxShowYMinorGrids = new CheckBox();
			textBoxYMinorUnit = new TextBox();
			textBoxYMajorUnit = new TextBox();
			labelYMinorAxis = new Label();
			labelYMajorAxis = new Label();
			groupBoxXAxis = new GroupBox();
			colorSelectionMinorX = new ColorSelectionControl();
			colorSelectionMajorX = new ColorSelectionControl();
			checkBoxShowXMinorGrids = new CheckBox();
			labelXMinorGridColor = new Label();
			labelXMajorGridColor = new Label();
			textBoxXMinorUnit = new TextBox();
			textBoxXMajorUnits = new TextBox();
			labelXMinorUnit = new Label();
			labelXMajorUnit = new Label();
			checkBoxShowXMajorGrids = new CheckBox();
			tabPageXAxis = new TabPage();
			colorSelectionControlCursor = new ColorSelectionControl();
			textBoxXaxisEnd = new TextBox();
			textBoxXaxisStart = new TextBox();
			labelCursor = new Label();
			labelXaxisEnd = new Label();
			labelXaxisStart = new Label();
			labelAxisDislpalyMode = new Label();
			comboBoxlAxisDislpalyMode = new ComboBox();
			tabPageRange = new TabPage();
			dataGridParameters = new DataGrid();
			tabPageYAxis = new TabPage();
			groupBoxYAxisScale = new GroupBox();
			checkBoxHideYAxisCaption = new CheckBox();
			checkBoxHideYAxis = new CheckBox();
			radioButtonIndividualYAxis = new RadioButton();
			radioButtonCommonYAxis = new RadioButton();
			textBoxMinYAxis = new TextBox();
			textBoxMaxYAxis = new TextBox();
			labelMinYAxis = new Label();
			labelMaxYAxis = new Label();
			checkBoxAutoScaleYAxis = new CheckBox();
			comboBoxScaleType = new ComboBox();
			labelScaleType = new Label();
			comboBoxAxisPosition = new ComboBox();
			labelAxisPosition = new Label();
			buttonOk = new Button();
			buttonCancel = new Button();
			((Control)tabControlA).SuspendLayout();
			((Control)tabPageGeneral).SuspendLayout();
			((Control)groupBoxTitle).SuspendLayout();
			((Control)groupBoxBackground).SuspendLayout();
			((Control)tabPagePrint).SuspendLayout();
			((Control)groupBoxOrientation).SuspendLayout();
			((Control)groupBox1).SuspendLayout();
			((Control)tabPageGridLines).SuspendLayout();
			((Control)groupBoxYAxis).SuspendLayout();
			((Control)groupBoxXAxis).SuspendLayout();
			((Control)tabPageXAxis).SuspendLayout();
			((Control)tabPageRange).SuspendLayout();
			((ISupportInitialize)dataGridParameters).BeginInit();
			((Control)tabPageYAxis).SuspendLayout();
			((Control)groupBoxYAxisScale).SuspendLayout();
			((Control)this).SuspendLayout();
			((Control)tabControlA).Controls.Add((Control)(object)tabPageGeneral);
			((Control)tabControlA).Controls.Add((Control)(object)tabPagePrint);
			((Control)tabControlA).Controls.Add((Control)(object)tabPageGridLines);
			((Control)tabControlA).Controls.Add((Control)(object)tabPageXAxis);
			((Control)tabControlA).Controls.Add((Control)(object)tabPageRange);
			((Control)tabControlA).Controls.Add((Control)(object)tabPageYAxis);
			((Control)tabControlA).Location = new Point(16, 16);
			((Control)tabControlA).Name = "tabControlA";
			tabControlA.SelectedIndex = 0;
			((Control)tabControlA).Size = new Size(464, 280);
			((Control)tabControlA).TabIndex = 0;
			((Control)tabPageGeneral).Controls.Add((Control)(object)labelRefershRate);
			((Control)tabPageGeneral).Controls.Add((Control)(object)textBoxRefershRate);
			((Control)tabPageGeneral).Controls.Add((Control)(object)groupBoxTitle);
			((Control)tabPageGeneral).Controls.Add((Control)(object)groupBoxBackground);
			tabPageGeneral.Location = new Point(4, 22);
			((Control)tabPageGeneral).Name = "tabPageGeneral";
			((Control)tabPageGeneral).Size = new Size(456, 254);
			tabPageGeneral.TabIndex = 0;
			((Control)tabPageGeneral).Text = "General";
			((Control)labelRefershRate).Location = new Point(176, 152);
			((Control)labelRefershRate).Name = "labelRefershRate";
			((Control)labelRefershRate).Size = new Size(144, 16);
			((Control)labelRefershRate).TabIndex = 8;
			((Control)labelRefershRate).Text = "Screen Refersh Rate (ms)";
			((Control)textBoxRefershRate).Location = new Point(320, 152);
			((Control)textBoxRefershRate).Name = "textBoxRefershRate";
			((Control)textBoxRefershRate).Size = new Size(100, 20);
			((Control)textBoxRefershRate).TabIndex = 9;
			((Control)textBoxRefershRate).Leave += ValidateTextBox;
			((Control)groupBoxTitle).Controls.Add((Control)(object)comboBoxtitlePosition);
			((Control)groupBoxTitle).Controls.Add((Control)(object)labelTitlePosition);
			((Control)groupBoxTitle).Controls.Add((Control)(object)textBoxTitle);
			((Control)groupBoxTitle).Controls.Add((Control)(object)label1);
			((Control)groupBoxTitle).Controls.Add((Control)(object)checkBoxTitleVisible);
			((Control)groupBoxTitle).Location = new Point(176, 24);
			((Control)groupBoxTitle).Name = "groupBoxTitle";
			((Control)groupBoxTitle).Size = new Size(264, 100);
			((Control)groupBoxTitle).TabIndex = 1;
			groupBoxTitle.TabStop = false;
			((Control)groupBoxTitle).Text = "Title";
			comboBoxtitlePosition.DropDownStyle = (ComboBoxStyle)2;
			comboBoxtitlePosition.Items.AddRange(new object[4] { "Bottom", "Left", "Right", "Top" });
			((Control)comboBoxtitlePosition).Location = new Point(136, 32);
			comboBoxtitlePosition.MaxDropDownItems = 4;
			((Control)comboBoxtitlePosition).Name = "comboBoxtitlePosition";
			((Control)comboBoxtitlePosition).Size = new Size(112, 21);
			((Control)comboBoxtitlePosition).TabIndex = 5;
			((Control)labelTitlePosition).Location = new Point(80, 32);
			((Control)labelTitlePosition).Name = "labelTitlePosition";
			((Control)labelTitlePosition).Size = new Size(48, 16);
			((Control)labelTitlePosition).TabIndex = 4;
			((Control)labelTitlePosition).Text = "Position";
			((Control)textBoxTitle).Location = new Point(80, 64);
			((Control)textBoxTitle).Name = "textBoxTitle";
			((Control)textBoxTitle).Size = new Size(168, 20);
			((Control)textBoxTitle).TabIndex = 7;
			((Control)textBoxTitle).Text = "Graph ";
			((Control)label1).Location = new Point(24, 64);
			((Control)label1).Name = "label1";
			((Control)label1).Size = new Size(40, 16);
			((Control)label1).TabIndex = 6;
			((Control)label1).Text = "&Title";
			((Control)checkBoxTitleVisible).Location = new Point(24, 27);
			((Control)checkBoxTitleVisible).Name = "checkBoxTitleVisible";
			((Control)checkBoxTitleVisible).Size = new Size(64, 24);
			((Control)checkBoxTitleVisible).TabIndex = 3;
			((Control)checkBoxTitleVisible).Text = "&Visible";
			((Control)groupBoxBackground).Controls.Add((Control)(object)colorSelectionBackground);
			((Control)groupBoxBackground).Controls.Add((Control)(object)labelBackGroundColor);
			((Control)groupBoxBackground).Location = new Point(16, 24);
			((Control)groupBoxBackground).Name = "groupBoxBackground";
			((Control)groupBoxBackground).Size = new Size(144, 100);
			((Control)groupBoxBackground).TabIndex = 0;
			groupBoxBackground.TabStop = false;
			((Control)groupBoxBackground).Text = "Background";
			((Control)colorSelectionBackground).Location = new Point(64, 24);
			((Control)colorSelectionBackground).Name = "colorSelectionBackground";
			colorSelectionBackground.SelectedColor = Color.Black;
			((Control)colorSelectionBackground).Size = new Size(48, 24);
			((Control)colorSelectionBackground).TabIndex = 2;
			((Control)labelBackGroundColor).Location = new Point(8, 24);
			((Control)labelBackGroundColor).Name = "labelBackGroundColor";
			((Control)labelBackGroundColor).Size = new Size(32, 16);
			((Control)labelBackGroundColor).TabIndex = 1;
			((Control)labelBackGroundColor).Text = "&Color";
			((Control)tabPagePrint).Controls.Add((Control)(object)groupBoxOrientation);
			((Control)tabPagePrint).Controls.Add((Control)(object)groupBox1);
			tabPagePrint.Location = new Point(4, 22);
			((Control)tabPagePrint).Name = "tabPagePrint";
			((Control)tabPagePrint).Size = new Size(456, 254);
			tabPagePrint.TabIndex = 2;
			((Control)tabPagePrint).Text = "Print";
			((Control)groupBoxOrientation).Controls.Add((Control)(object)radioButtonPortrait);
			((Control)groupBoxOrientation).Controls.Add((Control)(object)radioButtonLandscape);
			((Control)groupBoxOrientation).Location = new Point(16, 8);
			((Control)groupBoxOrientation).Name = "groupBoxOrientation";
			((Control)groupBoxOrientation).Size = new Size(232, 120);
			((Control)groupBoxOrientation).TabIndex = 1;
			groupBoxOrientation.TabStop = false;
			((Control)groupBoxOrientation).Text = "Orientation";
			((Control)radioButtonPortrait).Location = new Point(32, 80);
			((Control)radioButtonPortrait).Name = "radioButtonPortrait";
			((Control)radioButtonPortrait).Size = new Size(144, 24);
			((Control)radioButtonPortrait).TabIndex = 1;
			((Control)radioButtonPortrait).Text = "&Portrait";
			radioButtonLandscape.Checked = true;
			((Control)radioButtonLandscape).Location = new Point(32, 40);
			((Control)radioButtonLandscape).Name = "radioButtonLandscape";
			((Control)radioButtonLandscape).Size = new Size(144, 24);
			((Control)radioButtonLandscape).TabIndex = 0;
			radioButtonLandscape.TabStop = true;
			((Control)radioButtonLandscape).Text = "&Landscape";
			((Control)groupBox1).Controls.Add((Control)(object)textBoxRightMargin);
			((Control)groupBox1).Controls.Add((Control)(object)textBoxLeftMargin);
			((Control)groupBox1).Controls.Add((Control)(object)textBoxBottomMargin);
			((Control)groupBox1).Controls.Add((Control)(object)textBoxTopMargin);
			((Control)groupBox1).Location = new Point(264, 112);
			((Control)groupBox1).Name = "groupBox1";
			((Control)groupBox1).Size = new Size(176, 112);
			((Control)groupBox1).TabIndex = 0;
			groupBox1.TabStop = false;
			((Control)groupBox1).Text = "Margins";
			((Control)textBoxRightMargin).Location = new Point(120, 56);
			((TextBoxBase)textBoxRightMargin).MaxLength = 2;
			((Control)textBoxRightMargin).Name = "textBoxRightMargin";
			((Control)textBoxRightMargin).Size = new Size(40, 20);
			((Control)textBoxRightMargin).TabIndex = 4;
			((Control)textBoxRightMargin).Text = "0";
			((Control)textBoxRightMargin).Leave += ValidateTextBox;
			((Control)textBoxLeftMargin).Location = new Point(16, 56);
			((TextBoxBase)textBoxLeftMargin).MaxLength = 2;
			((Control)textBoxLeftMargin).Name = "textBoxLeftMargin";
			((Control)textBoxLeftMargin).Size = new Size(40, 20);
			((Control)textBoxLeftMargin).TabIndex = 6;
			((Control)textBoxLeftMargin).Text = "0";
			((Control)textBoxLeftMargin).Leave += ValidateTextBox;
			((Control)textBoxBottomMargin).Location = new Point(64, 80);
			((TextBoxBase)textBoxBottomMargin).MaxLength = 2;
			((Control)textBoxBottomMargin).Name = "textBoxBottomMargin";
			((Control)textBoxBottomMargin).Size = new Size(40, 20);
			((Control)textBoxBottomMargin).TabIndex = 5;
			((Control)textBoxBottomMargin).Text = "0";
			((Control)textBoxBottomMargin).Leave += ValidateTextBox;
			((Control)textBoxTopMargin).Location = new Point(64, 24);
			((TextBoxBase)textBoxTopMargin).MaxLength = 2;
			((Control)textBoxTopMargin).Name = "textBoxTopMargin";
			((Control)textBoxTopMargin).Size = new Size(40, 20);
			((Control)textBoxTopMargin).TabIndex = 3;
			((Control)textBoxTopMargin).Text = "0";
			((Control)textBoxTopMargin).Leave += ValidateTextBox;
			((Control)tabPageGridLines).Controls.Add((Control)(object)groupBoxYAxis);
			((Control)tabPageGridLines).Controls.Add((Control)(object)groupBoxXAxis);
			tabPageGridLines.Location = new Point(4, 22);
			((Control)tabPageGridLines).Name = "tabPageGridLines";
			((Control)tabPageGridLines).Size = new Size(456, 254);
			tabPageGridLines.TabIndex = 1;
			((Control)tabPageGridLines).Text = "Gridlines";
			((Control)groupBoxYAxis).Controls.Add((Control)(object)colorSelectionMinorY);
			((Control)groupBoxYAxis).Controls.Add((Control)(object)colorSelectionMajorY);
			((Control)groupBoxYAxis).Controls.Add((Control)(object)labelYMinorGridColor);
			((Control)groupBoxYAxis).Controls.Add((Control)(object)labelYMajorGridColor);
			((Control)groupBoxYAxis).Controls.Add((Control)(object)checkBoxShowYMajorGrids);
			((Control)groupBoxYAxis).Controls.Add((Control)(object)checkBoxShowYMinorGrids);
			((Control)groupBoxYAxis).Controls.Add((Control)(object)textBoxYMinorUnit);
			((Control)groupBoxYAxis).Controls.Add((Control)(object)textBoxYMajorUnit);
			((Control)groupBoxYAxis).Controls.Add((Control)(object)labelYMinorAxis);
			((Control)groupBoxYAxis).Controls.Add((Control)(object)labelYMajorAxis);
			((Control)groupBoxYAxis).Location = new Point(232, 16);
			((Control)groupBoxYAxis).Name = "groupBoxYAxis";
			((Control)groupBoxYAxis).Size = new Size(208, 216);
			((Control)groupBoxYAxis).TabIndex = 3;
			groupBoxYAxis.TabStop = false;
			((Control)groupBoxYAxis).Text = "YAxis";
			((Control)colorSelectionMinorY).Enabled = false;
			((Control)colorSelectionMinorY).Location = new Point(136, 184);
			((Control)colorSelectionMinorY).Name = "colorSelectionMinorY";
			colorSelectionMinorY.SelectedColor = Color.Black;
			((Control)colorSelectionMinorY).Size = new Size(48, 24);
			((Control)colorSelectionMinorY).TabIndex = 19;
			((Control)colorSelectionMajorY).Enabled = false;
			((Control)colorSelectionMajorY).Location = new Point(136, 144);
			((Control)colorSelectionMajorY).Name = "colorSelectionMajorY";
			colorSelectionMajorY.SelectedColor = Color.Black;
			((Control)colorSelectionMajorY).Size = new Size(48, 24);
			((Control)colorSelectionMajorY).TabIndex = 17;
			((Control)labelYMinorGridColor).Location = new Point(16, 188);
			((Control)labelYMinorGridColor).Name = "labelYMinorGridColor";
			((Control)labelYMinorGridColor).Size = new Size(88, 16);
			((Control)labelYMinorGridColor).TabIndex = 18;
			((Control)labelYMinorGridColor).Text = "Minor grid color";
			((Control)labelYMajorGridColor).Location = new Point(16, 152);
			((Control)labelYMajorGridColor).Name = "labelYMajorGridColor";
			((Control)labelYMajorGridColor).Size = new Size(88, 16);
			((Control)labelYMajorGridColor).TabIndex = 16;
			((Control)labelYMajorGridColor).Text = "Major grid color";
			((Control)checkBoxShowYMajorGrids).Enabled = false;
			((Control)checkBoxShowYMajorGrids).Location = new Point(16, 16);
			((Control)checkBoxShowYMajorGrids).Name = "checkBoxShowYMajorGrids";
			((Control)checkBoxShowYMajorGrids).Size = new Size(144, 24);
			((Control)checkBoxShowYMajorGrids).TabIndex = 10;
			((Control)checkBoxShowYMajorGrids).Text = "Show major grid lines";
			((Control)checkBoxShowYMinorGrids).Enabled = false;
			((Control)checkBoxShowYMinorGrids).Location = new Point(16, 48);
			((Control)checkBoxShowYMinorGrids).Name = "checkBoxShowYMinorGrids";
			((Control)checkBoxShowYMinorGrids).Size = new Size(152, 24);
			((Control)checkBoxShowYMinorGrids).TabIndex = 11;
			((Control)checkBoxShowYMinorGrids).Text = "Show minor grid lines";
			((Control)textBoxYMinorUnit).Enabled = false;
			((Control)textBoxYMinorUnit).Location = new Point(104, 112);
			((TextBoxBase)textBoxYMinorUnit).MaxLength = 4;
			((Control)textBoxYMinorUnit).Name = "textBoxYMinorUnit";
			((Control)textBoxYMinorUnit).Size = new Size(80, 20);
			((Control)textBoxYMinorUnit).TabIndex = 15;
			((Control)textBoxYMinorUnit).Text = "5";
			((Control)textBoxYMinorUnit).Leave += ValidateTextBox;
			((Control)textBoxYMajorUnit).Enabled = false;
			((Control)textBoxYMajorUnit).Location = new Point(104, 80);
			((TextBoxBase)textBoxYMajorUnit).MaxLength = 4;
			((Control)textBoxYMajorUnit).Name = "textBoxYMajorUnit";
			((Control)textBoxYMajorUnit).Size = new Size(80, 20);
			((Control)textBoxYMajorUnit).TabIndex = 13;
			((Control)textBoxYMajorUnit).Text = "5";
			((Control)textBoxYMajorUnit).Leave += ValidateTextBox;
			((Control)labelYMinorAxis).Location = new Point(16, 114);
			((Control)labelYMinorAxis).Name = "labelYMinorAxis";
			((Control)labelYMinorAxis).Size = new Size(64, 16);
			((Control)labelYMinorAxis).TabIndex = 14;
			((Control)labelYMinorAxis).Text = "Minor units";
			((Control)labelYMajorAxis).Location = new Point(16, 82);
			((Control)labelYMajorAxis).Name = "labelYMajorAxis";
			((Control)labelYMajorAxis).Size = new Size(64, 23);
			((Control)labelYMajorAxis).TabIndex = 12;
			((Control)labelYMajorAxis).Text = "Major units";
			((Control)groupBoxXAxis).Controls.Add((Control)(object)colorSelectionMinorX);
			((Control)groupBoxXAxis).Controls.Add((Control)(object)colorSelectionMajorX);
			((Control)groupBoxXAxis).Controls.Add((Control)(object)checkBoxShowXMinorGrids);
			((Control)groupBoxXAxis).Controls.Add((Control)(object)labelXMinorGridColor);
			((Control)groupBoxXAxis).Controls.Add((Control)(object)labelXMajorGridColor);
			((Control)groupBoxXAxis).Controls.Add((Control)(object)textBoxXMinorUnit);
			((Control)groupBoxXAxis).Controls.Add((Control)(object)textBoxXMajorUnits);
			((Control)groupBoxXAxis).Controls.Add((Control)(object)labelXMinorUnit);
			((Control)groupBoxXAxis).Controls.Add((Control)(object)labelXMajorUnit);
			((Control)groupBoxXAxis).Controls.Add((Control)(object)checkBoxShowXMajorGrids);
			((Control)groupBoxXAxis).Location = new Point(16, 16);
			((Control)groupBoxXAxis).Name = "groupBoxXAxis";
			((Control)groupBoxXAxis).Size = new Size(208, 216);
			((Control)groupBoxXAxis).TabIndex = 2;
			groupBoxXAxis.TabStop = false;
			((Control)groupBoxXAxis).Text = "XAxis";
			((Control)colorSelectionMinorX).Location = new Point(144, 184);
			((Control)colorSelectionMinorX).Name = "colorSelectionMinorX";
			colorSelectionMinorX.SelectedColor = Color.Black;
			((Control)colorSelectionMinorX).Size = new Size(48, 24);
			((Control)colorSelectionMinorX).TabIndex = 9;
			((Control)colorSelectionMajorX).Location = new Point(144, 144);
			((Control)colorSelectionMajorX).Name = "colorSelectionMajorX";
			colorSelectionMajorX.SelectedColor = Color.Black;
			((Control)colorSelectionMajorX).Size = new Size(48, 24);
			((Control)colorSelectionMajorX).TabIndex = 7;
			((Control)checkBoxShowXMinorGrids).Location = new Point(16, 48);
			((Control)checkBoxShowXMinorGrids).Name = "checkBoxShowXMinorGrids";
			((Control)checkBoxShowXMinorGrids).Size = new Size(152, 24);
			((Control)checkBoxShowXMinorGrids).TabIndex = 1;
			((Control)checkBoxShowXMinorGrids).Text = "Show minor grid lines";
			((Control)labelXMinorGridColor).Location = new Point(16, 188);
			((Control)labelXMinorGridColor).Name = "labelXMinorGridColor";
			((Control)labelXMinorGridColor).Size = new Size(88, 16);
			((Control)labelXMinorGridColor).TabIndex = 8;
			((Control)labelXMinorGridColor).Text = "Minor grid color";
			((Control)labelXMajorGridColor).Location = new Point(16, 149);
			((Control)labelXMajorGridColor).Name = "labelXMajorGridColor";
			((Control)labelXMajorGridColor).Size = new Size(88, 16);
			((Control)labelXMajorGridColor).TabIndex = 6;
			((Control)labelXMajorGridColor).Text = "Major grid color";
			((Control)textBoxXMinorUnit).Location = new Point(112, 112);
			((TextBoxBase)textBoxXMinorUnit).MaxLength = 4;
			((Control)textBoxXMinorUnit).Name = "textBoxXMinorUnit";
			((Control)textBoxXMinorUnit).Size = new Size(80, 20);
			((Control)textBoxXMinorUnit).TabIndex = 5;
			((Control)textBoxXMinorUnit).Text = "5";
			((Control)textBoxXMinorUnit).Leave += ValidateTextBox;
			((Control)textBoxXMajorUnits).Location = new Point(112, 80);
			((TextBoxBase)textBoxXMajorUnits).MaxLength = 4;
			((Control)textBoxXMajorUnits).Name = "textBoxXMajorUnits";
			((Control)textBoxXMajorUnits).Size = new Size(80, 20);
			((Control)textBoxXMajorUnits).TabIndex = 3;
			((Control)textBoxXMajorUnits).Text = "5";
			((Control)textBoxXMajorUnits).Leave += ValidateTextBox;
			((Control)labelXMinorUnit).Location = new Point(16, 115);
			((Control)labelXMinorUnit).Name = "labelXMinorUnit";
			((Control)labelXMinorUnit).Size = new Size(64, 16);
			((Control)labelXMinorUnit).TabIndex = 4;
			((Control)labelXMinorUnit).Text = "Minor units";
			((Control)labelXMajorUnit).Location = new Point(16, 83);
			((Control)labelXMajorUnit).Name = "labelXMajorUnit";
			((Control)labelXMajorUnit).Size = new Size(64, 16);
			((Control)labelXMajorUnit).TabIndex = 2;
			((Control)labelXMajorUnit).Text = "Major units";
			((Control)checkBoxShowXMajorGrids).Location = new Point(16, 16);
			((Control)checkBoxShowXMajorGrids).Name = "checkBoxShowXMajorGrids";
			((Control)checkBoxShowXMajorGrids).Size = new Size(144, 24);
			((Control)checkBoxShowXMajorGrids).TabIndex = 0;
			((Control)checkBoxShowXMajorGrids).Text = "Show major grid lines";
			((Control)tabPageXAxis).Controls.Add((Control)(object)colorSelectionControlCursor);
			((Control)tabPageXAxis).Controls.Add((Control)(object)textBoxXaxisEnd);
			((Control)tabPageXAxis).Controls.Add((Control)(object)textBoxXaxisStart);
			((Control)tabPageXAxis).Controls.Add((Control)(object)labelCursor);
			((Control)tabPageXAxis).Controls.Add((Control)(object)labelXaxisEnd);
			((Control)tabPageXAxis).Controls.Add((Control)(object)labelXaxisStart);
			((Control)tabPageXAxis).Controls.Add((Control)(object)labelAxisDislpalyMode);
			((Control)tabPageXAxis).Controls.Add((Control)(object)comboBoxlAxisDislpalyMode);
			tabPageXAxis.Location = new Point(4, 22);
			((Control)tabPageXAxis).Name = "tabPageXAxis";
			((Control)tabPageXAxis).Size = new Size(456, 254);
			tabPageXAxis.TabIndex = 5;
			((Control)tabPageXAxis).Text = "X Axis";
			((Control)colorSelectionControlCursor).Location = new Point(127, 128);
			((Control)colorSelectionControlCursor).Name = "colorSelectionControlCursor";
			colorSelectionControlCursor.SelectedColor = Color.FromArgb(255, 255, 128);
			((Control)colorSelectionControlCursor).Size = new Size(48, 24);
			((Control)colorSelectionControlCursor).TabIndex = 8;
			((Control)textBoxXaxisEnd).Location = new Point(120, 96);
			((Control)textBoxXaxisEnd).Name = "textBoxXaxisEnd";
			((Control)textBoxXaxisEnd).Size = new Size(100, 20);
			((Control)textBoxXaxisEnd).TabIndex = 6;
			((Control)textBoxXaxisStart).Location = new Point(120, 64);
			((Control)textBoxXaxisStart).Name = "textBoxXaxisStart";
			((Control)textBoxXaxisStart).Size = new Size(100, 20);
			((Control)textBoxXaxisStart).TabIndex = 4;
			((Control)labelCursor).Location = new Point(24, 136);
			((Control)labelCursor).Name = "labelCursor";
			((Control)labelCursor).Size = new Size(72, 23);
			((Control)labelCursor).TabIndex = 7;
			((Control)labelCursor).Text = "Cursor Color";
			((Control)labelXaxisEnd).Location = new Point(24, 98);
			((Control)labelXaxisEnd).Name = "labelXaxisEnd";
			((Control)labelXaxisEnd).Size = new Size(56, 16);
			((Control)labelXaxisEnd).TabIndex = 5;
			((Control)labelXaxisEnd).Text = "End";
			((Control)labelXaxisStart).Location = new Point(24, 68);
			((Control)labelXaxisStart).Name = "labelXaxisStart";
			((Control)labelXaxisStart).Size = new Size(56, 16);
			((Control)labelXaxisStart).TabIndex = 3;
			((Control)labelXaxisStart).Text = "Start";
			((Control)labelAxisDislpalyMode).Location = new Point(24, 40);
			((Control)labelAxisDislpalyMode).Name = "labelAxisDislpalyMode";
			((Control)labelAxisDislpalyMode).Size = new Size(88, 23);
			((Control)labelAxisDislpalyMode).TabIndex = 1;
			((Control)labelAxisDislpalyMode).Text = "Display Mode ";
			comboBoxlAxisDislpalyMode.Items.AddRange(new object[2] { "ScopeChart", "StripChart" });
			((Control)comboBoxlAxisDislpalyMode).Location = new Point(120, 32);
			((Control)comboBoxlAxisDislpalyMode).Name = "comboBoxlAxisDislpalyMode";
			((Control)comboBoxlAxisDislpalyMode).Size = new Size(104, 21);
			((Control)comboBoxlAxisDislpalyMode).TabIndex = 2;
			((Control)tabPageRange).Controls.Add((Control)(object)dataGridParameters);
			tabPageRange.Location = new Point(4, 22);
			((Control)tabPageRange).Name = "tabPageRange";
			((Control)tabPageRange).Size = new Size(456, 254);
			tabPageRange.TabIndex = 4;
			((Control)tabPageRange).Text = "Y Axis Bounds";
			dataGridParameters.DataMember = "";
			((Control)dataGridParameters).Dock = (DockStyle)5;
			dataGridParameters.HeaderForeColor = SystemColors.ControlText;
			((Control)dataGridParameters).Location = new Point(0, 0);
			((Control)dataGridParameters).Name = "dataGridParameters";
			((Control)dataGridParameters).Size = new Size(456, 254);
			((Control)dataGridParameters).TabIndex = 0;
			((Control)tabPageYAxis).Controls.Add((Control)(object)groupBoxYAxisScale);
			((Control)tabPageYAxis).Controls.Add((Control)(object)checkBoxAutoScaleYAxis);
			((Control)tabPageYAxis).Controls.Add((Control)(object)comboBoxScaleType);
			((Control)tabPageYAxis).Controls.Add((Control)(object)labelScaleType);
			((Control)tabPageYAxis).Controls.Add((Control)(object)comboBoxAxisPosition);
			((Control)tabPageYAxis).Controls.Add((Control)(object)labelAxisPosition);
			tabPageYAxis.Location = new Point(4, 22);
			((Control)tabPageYAxis).Name = "tabPageYAxis";
			((Control)tabPageYAxis).Size = new Size(456, 254);
			tabPageYAxis.TabIndex = 3;
			((Control)tabPageYAxis).Text = "Y Axis";
			((Control)groupBoxYAxisScale).Controls.Add((Control)(object)checkBoxHideYAxisCaption);
			((Control)groupBoxYAxisScale).Controls.Add((Control)(object)checkBoxHideYAxis);
			((Control)groupBoxYAxisScale).Controls.Add((Control)(object)radioButtonIndividualYAxis);
			((Control)groupBoxYAxisScale).Controls.Add((Control)(object)radioButtonCommonYAxis);
			((Control)groupBoxYAxisScale).Controls.Add((Control)(object)textBoxMinYAxis);
			((Control)groupBoxYAxisScale).Controls.Add((Control)(object)textBoxMaxYAxis);
			((Control)groupBoxYAxisScale).Controls.Add((Control)(object)labelMinYAxis);
			((Control)groupBoxYAxisScale).Controls.Add((Control)(object)labelMaxYAxis);
			((Control)groupBoxYAxisScale).Location = new Point(248, 8);
			((Control)groupBoxYAxisScale).Name = "groupBoxYAxisScale";
			((Control)groupBoxYAxisScale).Size = new Size(200, 216);
			((Control)groupBoxYAxisScale).TabIndex = 12;
			groupBoxYAxisScale.TabStop = false;
			((Control)groupBoxYAxisScale).Text = "Scale";
			((Control)checkBoxHideYAxisCaption).Location = new Point(40, 176);
			((Control)checkBoxHideYAxisCaption).Name = "checkBoxHideYAxisCaption";
			((Control)checkBoxHideYAxisCaption).Size = new Size(104, 24);
			((Control)checkBoxHideYAxisCaption).TabIndex = 13;
			((Control)checkBoxHideYAxisCaption).Text = "Hide Caption";
			((Control)checkBoxHideYAxis).Location = new Point(40, 150);
			((Control)checkBoxHideYAxis).Name = "checkBoxHideYAxis";
			((Control)checkBoxHideYAxis).Size = new Size(104, 24);
			((Control)checkBoxHideYAxis).TabIndex = 12;
			((Control)checkBoxHideYAxis).Text = "Hide Scale";
			checkBoxHideYAxis.CheckedChanged += OnCheckBoxHideYAxisCheckedChanged;
			((Control)radioButtonIndividualYAxis).Location = new Point(24, 120);
			((Control)radioButtonIndividualYAxis).Name = "radioButtonIndividualYAxis";
			((Control)radioButtonIndividualYAxis).Size = new Size(152, 24);
			((Control)radioButtonIndividualYAxis).TabIndex = 11;
			((Control)radioButtonIndividualYAxis).Text = "Individual Y Axis Scale";
			radioButtonIndividualYAxis.CheckedChanged += OnRadioButtonIndividualYAxisCheckedChanged;
			((Control)radioButtonCommonYAxis).Location = new Point(24, 24);
			((Control)radioButtonCommonYAxis).Name = "radioButtonCommonYAxis";
			((Control)radioButtonCommonYAxis).Size = new Size(144, 24);
			((Control)radioButtonCommonYAxis).TabIndex = 6;
			((Control)radioButtonCommonYAxis).Text = "Common Y Axis Scale";
			radioButtonCommonYAxis.CheckedChanged += OnRadioButtonCommonYAxisCheckedChanged;
			((Control)textBoxMinYAxis).Location = new Point(80, 56);
			((Control)textBoxMinYAxis).Name = "textBoxMinYAxis";
			((Control)textBoxMinYAxis).Size = new Size(100, 20);
			((Control)textBoxMinYAxis).TabIndex = 8;
			((Control)textBoxMaxYAxis).Location = new Point(80, 80);
			((Control)textBoxMaxYAxis).Name = "textBoxMaxYAxis";
			((Control)textBoxMaxYAxis).Size = new Size(100, 20);
			((Control)textBoxMaxYAxis).TabIndex = 10;
			((Control)labelMinYAxis).Location = new Point(40, 56);
			((Control)labelMinYAxis).Name = "labelMinYAxis";
			((Control)labelMinYAxis).Size = new Size(24, 16);
			((Control)labelMinYAxis).TabIndex = 7;
			((Control)labelMinYAxis).Text = "&Min";
			((Control)labelMaxYAxis).Location = new Point(40, 80);
			((Control)labelMaxYAxis).Name = "labelMaxYAxis";
			((Control)labelMaxYAxis).Size = new Size(32, 16);
			((Control)labelMaxYAxis).TabIndex = 9;
			((Control)labelMaxYAxis).Text = "Ma&x";
			((Control)checkBoxAutoScaleYAxis).Location = new Point(24, 104);
			((Control)checkBoxAutoScaleYAxis).Name = "checkBoxAutoScaleYAxis";
			((Control)checkBoxAutoScaleYAxis).Size = new Size(144, 24);
			((Control)checkBoxAutoScaleYAxis).TabIndex = 5;
			((Control)checkBoxAutoScaleYAxis).Text = "&Auto Scale Y Axis";
			comboBoxScaleType.Items.AddRange(new object[2] { "Linear", "Logarithmic" });
			((Control)comboBoxScaleType).Location = new Point(120, 64);
			((Control)comboBoxScaleType).Name = "comboBoxScaleType";
			((Control)comboBoxScaleType).Size = new Size(104, 21);
			((Control)comboBoxScaleType).TabIndex = 4;
			((Control)labelScaleType).Location = new Point(24, 64);
			((Control)labelScaleType).Name = "labelScaleType";
			((Control)labelScaleType).Size = new Size(64, 16);
			((Control)labelScaleType).TabIndex = 3;
			((Control)labelScaleType).Text = "Scale Type";
			comboBoxAxisPosition.Items.AddRange(new object[3] { "Left", "LeftRight", "Right" });
			((Control)comboBoxAxisPosition).Location = new Point(120, 24);
			((Control)comboBoxAxisPosition).Name = "comboBoxAxisPosition";
			((Control)comboBoxAxisPosition).Size = new Size(104, 21);
			((Control)comboBoxAxisPosition).TabIndex = 2;
			((Control)labelAxisPosition).Location = new Point(24, 32);
			((Control)labelAxisPosition).Name = "labelAxisPosition";
			((Control)labelAxisPosition).Size = new Size(72, 16);
			((Control)labelAxisPosition).TabIndex = 1;
			((Control)labelAxisPosition).Text = "Axis Position";
			buttonOk.DialogResult = (DialogResult)1;
			((Control)buttonOk).Location = new Point(312, 312);
			((Control)buttonOk).Name = "buttonOk";
			((Control)buttonOk).Size = new Size(75, 23);
			((Control)buttonOk).TabIndex = 1;
			((Control)buttonOk).Text = "&Ok";
			((Control)buttonOk).Click += buttonOk_Click;
			buttonCancel.DialogResult = (DialogResult)2;
			((Control)buttonCancel).Location = new Point(405, 312);
			((Control)buttonCancel).Name = "buttonCancel";
			((Control)buttonCancel).Size = new Size(75, 23);
			((Control)buttonCancel).TabIndex = 2;
			((Control)buttonCancel).Text = "&Cancel";
			((Form)this).AcceptButton = (IButtonControl)(object)buttonOk;
			((Form)this).AutoScaleBaseSize = new Size(5, 13);
			((Form)this).CancelButton = (IButtonControl)(object)buttonCancel;
			((Form)this).ClientSize = new Size(496, 341);
			((Control)this).Controls.Add((Control)(object)buttonCancel);
			((Control)this).Controls.Add((Control)(object)buttonOk);
			((Control)this).Controls.Add((Control)(object)tabControlA);
			((Form)this).FormBorderStyle = (FormBorderStyle)3;
			((Form)this).Icon = (Icon)componentResourceManager.GetObject("$this.Icon");
			((Form)this).MaximizeBox = false;
			((Form)this).MinimizeBox = false;
			((Control)this).Name = "GraphProperties";
			((Form)this).ShowInTaskbar = false;
			((Control)this).Text = "Graph Properties";
			((Form)this).Load += GraphProperties_Load;
			((Control)tabControlA).ResumeLayout(false);
			((Control)tabPageGeneral).ResumeLayout(false);
			((Control)tabPageGeneral).PerformLayout();
			((Control)groupBoxTitle).ResumeLayout(false);
			((Control)groupBoxTitle).PerformLayout();
			((Control)groupBoxBackground).ResumeLayout(false);
			((Control)tabPagePrint).ResumeLayout(false);
			((Control)groupBoxOrientation).ResumeLayout(false);
			((Control)groupBox1).ResumeLayout(false);
			((Control)groupBox1).PerformLayout();
			((Control)tabPageGridLines).ResumeLayout(false);
			((Control)groupBoxYAxis).ResumeLayout(false);
			((Control)groupBoxYAxis).PerformLayout();
			((Control)groupBoxXAxis).ResumeLayout(false);
			((Control)groupBoxXAxis).PerformLayout();
			((Control)tabPageXAxis).ResumeLayout(false);
			((Control)tabPageXAxis).PerformLayout();
			((Control)tabPageRange).ResumeLayout(false);
			((ISupportInitialize)dataGridParameters).EndInit();
			((Control)tabPageYAxis).ResumeLayout(false);
			((Control)groupBoxYAxisScale).ResumeLayout(false);
			((Control)groupBoxYAxisScale).PerformLayout();
			((Control)this).ResumeLayout(false);
		}

		private void SetCheckCheckBox(CheckBox checkBox, string checkFlag)
		{
			try
			{
				checkBox.Checked = bool.Parse(checkFlag);
			}
			catch
			{
				checkBox.Checked = false;
			}
		}

		private void buttonOk_Click(object sender, EventArgs e)
		{
			DataRow dataRow = configuration.Tables["General"].Rows[0];
			dataRow["TitleString"] = ((Control)textBoxTitle).Text;
			dataRow["TitleVisible"] = checkBoxTitleVisible.Checked.ToString();
			dataRow["TitlePosition"] = ((Control)comboBoxtitlePosition).Text;
			dataRow["BackGroundColor"] = ColorHelper.ColorToRGBString(colorSelectionBackground.SelectedColor);
			dataRow["ScreenRefreshRate"] = ((Control)textBoxRefershRate).Text;
			dataRow = configuration.Tables["Print"].Rows[0];
			dataRow["TopMargin"] = ((Control)textBoxTopMargin).Text;
			dataRow["BottomMargin"] = ((Control)textBoxBottomMargin).Text;
			dataRow["LeftMargin"] = ((Control)textBoxLeftMargin).Text;
			dataRow["RightMargin"] = ((Control)textBoxRightMargin).Text;
			dataRow["Orientation"] = (radioButtonPortrait.Checked ? "Portrait" : "Landscape");
			dataRow = configuration.Tables["Grid"].Rows[0];
			dataRow["ShowXMajor"] = checkBoxShowXMajorGrids.Checked.ToString();
			dataRow["ShowYMajor"] = checkBoxShowYMajorGrids.Checked.ToString();
			dataRow["ShowXMinor"] = checkBoxShowXMinorGrids.Checked.ToString();
			dataRow["ShowYMinor"] = checkBoxShowYMinorGrids.Checked.ToString();
			dataRow["XMajorUnits"] = ((Control)textBoxXMajorUnits).Text;
			dataRow["YMajorUnits"] = ((Control)textBoxYMajorUnit).Text;
			dataRow["XMinorUnits"] = ((Control)textBoxXMinorUnit).Text;
			dataRow["YMinorUnits"] = ((Control)textBoxYMinorUnit).Text;
			dataRow["XMajorColor"] = ColorHelper.ColorToRGBString(colorSelectionMajorX.SelectedColor);
			dataRow["YMajorColor"] = ColorHelper.ColorToRGBString(colorSelectionMajorY.SelectedColor);
			dataRow["XMinorColor"] = ColorHelper.ColorToRGBString(colorSelectionMinorX.SelectedColor);
			dataRow["YMinorColor"] = ColorHelper.ColorToRGBString(colorSelectionMinorY.SelectedColor);
			dataRow = configuration.Tables["YAxis"].Rows[0];
			YAxisDisplayType yAxisDisplayType = YAxisDisplayType.Individual;
			if (radioButtonCommonYAxis.Checked)
			{
				yAxisDisplayType = YAxisDisplayType.Common;
			}
			else if (radioButtonIndividualYAxis.Checked)
			{
				yAxisDisplayType = (checkBoxHideYAxis.Checked ? YAxisDisplayType.Hidden : YAxisDisplayType.Individual);
			}
			dataRow["AutoScale"] = checkBoxAutoScaleYAxis.Checked.ToString();
			dataRow["ScaleType"] = ((Control)comboBoxScaleType).Text;
			dataRow["AxisPosition"] = ((Control)comboBoxAxisPosition).Text;
			dataRow["LowerBound"] = ((Control)textBoxMinYAxis).Text;
			dataRow["UpperBound"] = ((Control)textBoxMaxYAxis).Text;
			dataRow["HideScale"] = checkBoxHideYAxis.Checked.ToString();
			dataRow["HideYAxisCaption"] = checkBoxHideYAxisCaption.Checked.ToString();
			dataRow["YAxisDisplayType"] = yAxisDisplayType.ToString();
			dataRow = configuration.Tables["XAxis"].Rows[0];
			dataRow["AxisDisplayMode"] = ((Control)comboBoxlAxisDislpalyMode).Text;
			dataRow["LowerBound"] = ((Control)textBoxXaxisStart).Text;
			dataRow["UpperBound"] = ((Control)textBoxXaxisEnd).Text;
			dataRow["CursorColor"] = ColorHelper.ColorToRGBString(colorSelectionControlCursor.SelectedColor);
			configuration.AcceptChanges();
			((Form)this).DialogResult = (DialogResult)1;
		}

		private void ValidateTextBox(object sender, EventArgs e)
		{
			//IL_0026: Unknown result type (might be due to invalid IL or missing references)
			if (sender is TextBox)
			{
				try
				{
					int.Parse(((Control)((sender is TextBox) ? sender : null)).Text);
				}
				catch
				{
					MessageBox.Show("Enter a valid number", "Graph Properties");
					((Control)((sender is TextBox) ? sender : null)).Text = "";
					((Control)((sender is TextBox) ? sender : null)).Focus();
				}
			}
		}

		private void GraphProperties_Load(object sender, EventArgs e)
		{
			DataRow dataRow = configuration.Tables["General"].Rows[0];
			((Control)comboBoxtitlePosition).Text = dataRow["TitlePosition"].ToString();
			checkBoxTitleVisible.Checked = bool.Parse(dataRow["TitleVisible"].ToString());
			colorSelectionBackground.SelectedColor = ColorHelper.StringToColor(dataRow["BackGroundColor"].ToString());
			((Control)textBoxTitle).Text = dataRow["TitleString"].ToString();
			((Control)textBoxRefershRate).Text = dataRow["ScreenRefreshRate"].ToString();
			dataRow = configuration.Tables["Grid"].Rows[0];
			SetCheckCheckBox(checkBoxShowXMajorGrids, dataRow["ShowXMajor"].ToString());
			SetCheckCheckBox(checkBoxShowYMajorGrids, dataRow["ShowYMajor"].ToString());
			SetCheckCheckBox(checkBoxShowXMinorGrids, dataRow["ShowXMinor"].ToString());
			SetCheckCheckBox(checkBoxShowYMinorGrids, dataRow["ShowYMinor"].ToString());
			((Control)textBoxXMajorUnits).Text = dataRow["XMajorUnits"].ToString();
			((Control)textBoxYMajorUnit).Text = dataRow["YMajorUnits"].ToString();
			((Control)textBoxXMinorUnit).Text = dataRow["XMinorUnits"].ToString();
			((Control)textBoxYMinorUnit).Text = dataRow["YMinorUnits"].ToString();
			colorSelectionMajorX.SelectedColor = ColorHelper.StringToColor(dataRow["XMajorColor"].ToString());
			colorSelectionMajorY.SelectedColor = ColorHelper.StringToColor(dataRow["YMajorColor"].ToString());
			colorSelectionMinorX.SelectedColor = ColorHelper.StringToColor(dataRow["XMinorColor"].ToString());
			colorSelectionMinorY.SelectedColor = ColorHelper.StringToColor(dataRow["YMinorColor"].ToString());
			dataRow = configuration.Tables["YAxis"].Rows[0];
			YAxisDisplayType yAxisDisplayType = (YAxisDisplayType)Enum.Parse(typeof(YAxisDisplayType), dataRow["YAxisDisplayType"].ToString(), ignoreCase: true);
			SetCheckCheckBox(checkBoxHideYAxisCaption, dataRow["HideYAxisCaption"].ToString());
			switch (yAxisDisplayType)
			{
			case YAxisDisplayType.Common:
				radioButtonCommonYAxis.Checked = true;
				((Control)checkBoxHideYAxis).Enabled = false;
				((Control)checkBoxHideYAxisCaption).Enabled = false;
				break;
			case YAxisDisplayType.Hidden:
				radioButtonIndividualYAxis.Checked = true;
				checkBoxHideYAxis.Checked = true;
				break;
			default:
				radioButtonIndividualYAxis.Checked = true;
				checkBoxHideYAxis.Checked = false;
				break;
			}
			((Control)textBoxMinYAxis).Enabled = yAxisDisplayType == YAxisDisplayType.Common;
			((Control)textBoxMaxYAxis).Enabled = yAxisDisplayType == YAxisDisplayType.Common;
			((Control)textBoxMaxYAxis).Text = dataRow["UpperBound"].ToString();
			((Control)textBoxMinYAxis).Text = dataRow["LowerBound"].ToString();
			if (((Control)textBoxMaxYAxis).Text == string.Empty)
			{
				string text = configuration.Tables["Parameters"].Compute("Max(UpperBound)", "").ToString();
				if (text == string.Empty)
				{
					((Control)textBoxMaxYAxis).Text = "100";
				}
				else
				{
					((Control)textBoxMaxYAxis).Text = text;
				}
			}
			if (((Control)textBoxMinYAxis).Text == string.Empty)
			{
				string text2 = configuration.Tables["Parameters"].Compute("Min(LowerBound)", "").ToString();
				if (text2 == string.Empty)
				{
					((Control)textBoxMinYAxis).Text = "0";
				}
				else
				{
					((Control)textBoxMinYAxis).Text = text2;
				}
			}
			((Control)comboBoxAxisPosition).Text = dataRow["AxisPosition"].ToString();
			((Control)comboBoxScaleType).Text = dataRow["ScaleType"].ToString();
			SetCheckCheckBox(checkBoxAutoScaleYAxis, dataRow["AutoScale"].ToString());
			dataRow = configuration.Tables["XAxis"].Rows[0];
			((Control)comboBoxlAxisDislpalyMode).Text = dataRow["AxisDisplayMode"].ToString();
			((Control)textBoxXaxisEnd).Text = dataRow["UpperBound"].ToString();
			((Control)textBoxXaxisStart).Text = dataRow["LowerBound"].ToString();
			colorSelectionControlCursor.SelectedColor = ColorHelper.StringToColor(dataRow["CursorColor"].ToString());
		}

		private void OnParameterColumnChangingEventHandler(object sender, DataColumnChangeEventArgs e)
		{
			if (e.Column.ColumnName == "LowerBound" || e.Column.ColumnName == "UpperBound")
			{
				double.Parse(e.ProposedValue.ToString());
			}
		}

		private void OnRadioButtonCommonYAxisCheckedChanged(object sender, EventArgs e)
		{
			((Control)textBoxMaxYAxis).Enabled = radioButtonCommonYAxis.Checked;
			((Control)textBoxMinYAxis).Enabled = radioButtonCommonYAxis.Checked;
		}

		private void OnRadioButtonIndividualYAxisCheckedChanged(object sender, EventArgs e)
		{
			((Control)checkBoxHideYAxis).Enabled = radioButtonIndividualYAxis.Checked;
			((Control)checkBoxHideYAxisCaption).Enabled = radioButtonIndividualYAxis.Checked;
		}

		private void OnCheckBoxHideYAxisCheckedChanged(object sender, EventArgs e)
		{
			((Control)checkBoxHideYAxisCaption).Enabled = !checkBoxHideYAxis.Checked;
			checkBoxHideYAxisCaption.Checked = checkBoxHideYAxis.Checked;
		}
	}
	public interface IIntegratedCalibration
	{
		string SelectedParameter { get; set; }

		void ShowParameterOwner(string parameterName);

		void TerminateParameterOwner();
	}
	public interface IMonitorElement : IDisposable
	{
		SortedList Calibrations { set; }

		bool ShowComments { get; set; }

		bool ValueEnabled { set; }

		DataFormat Radix { set; }

		IAddressValue CurrentSourceAddress { get; set; }

		ArrayList IDLParametersList { get; }

		bool IsDirty { get; }

		ParameterView DataView { get; }

		event KeyEventHandler GridKeyDown;

		void SaveSession(NewDataSet.ScreenRow screenRow);

		void Resynchronize();

		void Reconcile(IAddressValue deviceAddress);

		void BuildSomeRows();

		void CleaupResources();

		void Restore(DataRow groupRow);

		void Refresh(DataRefreshEventArgs e, bool forceUpdate);

		void Undo();

		void Revert();
	}
	public delegate void SubscriptionRemovedEventHandler(object sender, SubscriptionRemovedEventArgument e);
	public class MonitorColoredTextBoxColumn : ColoredTextBoxColumn
	{
		private const int ChangedValueColumn = 5;

		private ArrayList cellUpdatedColors = new ArrayList();

		private ArrayList cellLastUpdateTime = new ArrayList();

		private Timer _refreshTimer;

		private bool _monitorUpdateRate;

		public override bool MonitorUpdateRate
		{
			get
			{
				return _monitorUpdateRate;
			}
			set
			{
				_monitorUpdateRate = value;
				if (_monitorUpdateRate)
				{
					IAppConfigService appConfigService = ServiceManager.Services.GetService(typeof(IAppConfigService)) as IAppConfigService;
					if (bool.Parse(appConfigService.GetAppSetting(ApplicationSettings.AutoLoggingChecked)))
					{
						_refreshTimer.Stop();
					}
					else
					{
						_refreshTimer.Start();
					}
				}
				else
				{
					_refreshTimer.Stop();
				}
			}
		}

		public MonitorColoredTextBoxColumn(DataGrid grid, PropertyDescriptor pd)
			: base(grid, pd)
		{
			//IL_001f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0029: Expected O, but got Unknown
			_refreshTimer = new Timer();
			_refreshTimer.Interval = 333;
			_refreshTimer.Tick += OnRefreshTimerTick;
		}

		public MonitorColoredTextBoxColumn(DataGrid grid)
			: base(grid)
		{
			//IL_001e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0028: Expected O, but got Unknown
			_refreshTimer = new Timer();
			_refreshTimer.Interval = 333;
			_refreshTimer.Tick += OnRefreshTimerTick;
		}

		public override void AddCell()
		{
			base.AddCell();
			int num = 0;
			num = 0;
			cellUpdatedColors.Add(num);
			cellLastUpdateTime.Add(DateTime.Now);
		}

		public override void StopUpdate()
		{
			MonitorUpdateRate = false;
		}

		protected override void Paint(Graphics g, Rectangle rect, CurrencyManager source, int rowNum, Brush backBrush, Brush foreBrush, bool alignRight)
		{
			//IL_003c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0043: Expected O, but got Unknown
			//IL_001a: Unknown result type (might be due to invalid IL or missing references)
			//IL_0021: Expected O, but got Unknown
			try
			{
				if ((bool)dataGrid[rowNum, 5])
				{
					backBrush = (Brush)new SolidBrush(Color.Yellow);
				}
				int num = (int)cellUpdatedColors[rowNum];
				foreBrush = (Brush)new SolidBrush(Color.FromArgb(num, num, num));
			}
			catch (Exception)
			{
			}
			base.Paint(g, rect, source, rowNum, backBrush, foreBrush, alignRight);
		}

		private void OnRefreshTimerTick(object sender, EventArgs e)
		{
			//IL_002b: Unknown result type (might be due to invalid IL or missing references)
			//IL_0031: Expected O, but got Unknown
			try
			{
				if (((Control)dataGrid).BindingContext == null)
				{
					return;
				}
				CurrencyManager val = (CurrencyManager)((Control)dataGrid).BindingContext[dataGrid.DataSource];
				int count = ((BindingManagerBase)val).Count;
				DataTable dataTable = dataGrid.DataSource as DataTable;
				bool flag = false;
				if (dataTable == null)
				{
					return;
				}
				DateTime now = DateTime.Now;
				for (int i = 0; i < count; i++)
				{
					object obj = dataTable.Rows[i][6];
					if (obj != DBNull.Value)
					{
						DateTime dateTime = (DateTime)obj;
						flag = ((!((now - dateTime).TotalMilliseconds > 5000.0)) ? (flag | CellUpdated(i)) : (flag | CellNotUpdated(i)));
					}
				}
				if (flag)
				{
					((DataGridColumnStyle)this).Invalidate();
				}
			}
			catch (Exception)
			{
			}
		}

		public bool CellUpdated(int rowNum)
		{
			bool result = false;
			try
			{
				if ((int)cellUpdatedColors[rowNum] != 0)
				{
					cellUpdatedColors[rowNum] = 0;
					result = true;
				}
			}
			catch (Exception ex)
			{
				_ = ex.Message;
			}
			return result;
		}

		public bool CellNotUpdated(int rowNum)
		{
			bool result = false;
			try
			{
				int num = (int)cellUpdatedColors[rowNum];
				num += 20;
				if (num > 200)
				{
					num = 200;
				}
				if ((int)cellUpdatedColors[rowNum] != num)
				{
					cellUpdatedColors[rowNum] = num;
					result = true;
				}
			}
			catch (Exception ex)
			{
				_ = ex.Message;
			}
			return result;
		}
	}
}
namespace Cummins.Parameter
{
	public class Parameter
	{
		private IMonitoredModel theModel;

		private ParameterController theController;

		private ParameterView theDataView;

		private ParameterView thePropertiesView;

		private Font theFont;

		public IMonitoredModel Model
		{
			get
			{
				return theModel;
			}
			set
			{
				theModel = value;
			}
		}

		public IParameterModel ParameterModel
		{
			get
			{
				return theModel.ParameterModel;
			}
			set
			{
				theModel.ParameterModel = value;
			}
		}

		protected ParameterController Controller
		{
			get
			{
				return theController;
			}
			set
			{
				theController = value;
			}
		}

		public ParameterView DataView
		{
			get
			{
				if (theDataView == null)
				{
					switch (theModel.DataType)
					{
					case ParameterType.Value:
						theDataView = new ValueDataView((ValueController)theController, theFont);
						break;
					case ParameterType.ArrayXY:
						theDataView = new ArrayXYDataView((ArrayXYController)theController, theFont);
						break;
					case ParameterType.ArrayXYZ:
						theDataView = new ArrayXYZDataView((ArrayXYZController)theController, theFont);
						break;
					case ParameterType.StructureArray:
						theDataView = new StructureArrayView((StructureArrayController)theController, theFont);
						break;
					case ParameterType.Group:
					case ParameterType.Structure:
						theDataView = new GroupDataView((GroupController)theController, theFont);
						break;
					case ParameterType.ArrayXAxis:
						theDataView = new ArrayXDataView((ArrayXController)theController, theFont);
						break;
					case ParameterType.Enumeration:
						theDataView = new EnumerationDataView((EnumerationController)theController, theFont);
						break;
					case ParameterType.Array1D:
						theDataView = new Array1DDataView((Array1DController)theController, theFont);
						break;
					case ParameterType.Array2D:
						throw new NotImplementedException("Parameter: Array2D parameter type not currently supported.");
					case ParameterType.MemoryMap:
						theDataView = new MemoryMapDataView((MemoryMapController)theController, theFont);
						break;
					default:
						throw new Exception("Parameter: Unknown model parameter type.");
					case ParameterType.TableElement:
						break;
					}
					theDataView.ShowPropertiesEvent += OnShowProperties;
				}
				return theDataView;
			}
			set
			{
				theDataView = value;
				theDataView.ShowPropertiesEvent += OnShowProperties;
			}
		}

		private ParameterView PropertiesView
		{
			get
			{
				if (thePropertiesView == null)
				{
					thePropertiesView = new PropertiesView(theController, theFont);
				}
				return thePropertiesView;
			}
		}

		public Font Font
		{
			get
			{
				return theFont;
			}
			set
			{
				theFont = value;
			}
		}

		public virtual SortedList Calibrations
		{
			set
			{
			}
		}

		public Parameter()
		{
		}

		public Parameter(IParameterModel model)
		{
			theModel = new MonitoredModel(model);
			switch (model.DataType)
			{
			case ParameterType.Value:
				theController = new ValueController(theModel);
				break;
			case ParameterType.ArrayXY:
				theController = new ArrayXYController(theModel);
				break;
			case ParameterType.ArrayXYZ:
				theController = new ArrayXYZController(theModel);
				break;
			case ParameterType.StructureArray:
				theModel = new MonitoredGroupModel();
				theController = new StructureArrayController(theModel as MonitoredGroupModel);
				break;
			case ParameterType.Group:
			case ParameterType.Structure:
				theModel = new MonitoredGroupModel();
				theController = new GroupController(theModel as MonitoredGroupModel);
				break;
			case ParameterType.ArrayXAxis:
				theController = new ArrayXController(theModel);
				break;
			case ParameterType.Enumeration:
				theController = new EnumerationController(theModel);
				break;
			case ParameterType.Array1D:
				theController = new Array1DController(theModel);
				break;
			case ParameterType.Array2D:
				throw new NotImplementedException("Parameter: Array2D parameter type not currently supported.");
			case ParameterType.MemoryMap:
				theController = new MemoryMapController(theModel);
				break;
			default:
				throw new Exception("Parameter: Unknown model parameter type.");
			case ParameterType.TableElement:
				break;
			}
		}

		public void Revert()
		{
			theController.Revert();
			((Control)theDataView).Refresh();
		}

		public void Undo()
		{
			theController.Undo();
			((Control)theDataView).Refresh();
		}

		public virtual void Save()
		{
			theController.Save();
			((Control)theDataView).Refresh();
		}

		public void UpdateData()
		{
			theController.Data.AcceptChanges();
			((Control)theDataView).Refresh();
		}

		public void ViewRefresh()
		{
			((Control)theDataView).Refresh();
		}

		public void ShowPropertiesView()
		{
			//IL_000d: Unknown result type (might be due to invalid IL or missing references)
			Form val = (Form)(object)new PropertiesViewForm(PropertiesView);
			val.ShowDialog();
		}

		public void DisplayFormat(DataFormat displayFormat)
		{
			theController.DataMode(displayFormat);
			theDataView.SetDisplayMode(displayFormat);
			((Control)theDataView).Refresh();
		}

		public void DoSaveChanges()
		{
			theController.RaiseAllCellsUnmodifiedEvent();
		}

		private void OnShowProperties(object sender, EventArgs e)
		{
			ShowPropertiesView();
		}

		public virtual void Restore(DataRow groupRow)
		{
		}

		public virtual void Resynchronize()
		{
		}

		public virtual void Reconcile(IAddressValue deviceAddress)
		{
			Controller.Reload();
		}

		public virtual void BuildSomeRows()
		{
		}
	}
}
namespace Cummins.Editor
{
	public class MonitoredArray1D : Cummins.Parameter.Parameter, IMonitorElement, IDisposable
	{
		private bool disposed;

		private ArrayList iDLParametersList;

		public bool ShowComments
		{
			get
			{
				return ((MonitoredArray1DController)base.Controller).ShowComments;
			}
			set
			{
				((MonitoredArray1DController)base.Controller).ShowComments = value;
			}
		}

		public bool ValueEnabled
		{
			set
			{
				((MonitoredArray1DController)base.Controller).ValueEnabled = value;
			}
		}

		public bool IsDirty => ((MonitoredArray1DModel)base.ParameterModel).IsChanged;

		public DataFormat Radix
		{
			set
			{
				((MonitoredArray1DController)base.Controller).Radix = value;
			}
		}

		public IAddressValue CurrentSourceAddress
		{
			get
			{
				return ((MonitoredArray1DController)base.Controller).CurrentSourceAddress;
			}
			set
			{
				((MonitoredArray1DController)base.Controller).CurrentSourceAddress = value;
			}
		}

		public ArrayList IDLParametersList
		{
			get
			{
				if (iDLParametersList == null)
				{
					iDLParametersList = new ArrayList();
					LogParameters logParameters = new LogParameters
					{
						parameterName = base.ParameterModel.Name,
						sourceAddess = base.ParameterModel.DataSource.SourceAddress
					};
					iDLParametersList.Add(logParameters);
				}
				return iDLParametersList;
			}
		}

		public event KeyEventHandler GridKeyDown
		{
			add
			{
				((MonitoredArray1DView)base.DataView).GridKeyDown += value;
			}
			remove
			{
				((MonitoredArray1DView)base.DataView).GridKeyDown -= value;
			}
		}

		public MonitoredArray1D(IParameterModel parameterModel)
		{
			base.Model = new MonitoredArray1DModel(parameterModel);
			base.ParameterModel = parameterModel;
			base.ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
			base.Controller = new MonitoredArray1DController((MonitoredArray1DModel)base.Model);
			base.DataView = new MonitoredArray1DView((MonitoredArray1DController)base.Controller, base.Font);
			if (!(base.ParameterModel.DataSource is ICalibrationECM))
			{
				base.ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.dataVolatile;
			}
			disposed = false;
		}

		public void SaveSession(NewDataSet.ScreenRow screenRow)
		{
			((MonitoredArray1DController)base.Controller).SaveSession(screenRow);
		}

		public void Refresh(DataRefreshEventArgs e, bool forceUpdate)
		{
			((MonitoredArray1DController)base.Controller).Refresh(e);
		}

		public void Dispose()
		{
			Dispose(disposing: true);
			GC.SuppressFinalize(this);
		}

		protected virtual void Dispose(bool disposing)
		{
			if (!disposed && disposing)
			{
				CleaupResources();
			}
			disposed = true;
		}

		public void CleaupResources()
		{
			((Component)(object)base.DataView).Dispose();
			((MonitoredArray1DController)base.Controller).CleanupResources();
		}
	}
}
namespace Cummins.Parameter
{
	public abstract class ArrayController : ParameterController
	{
		protected IParameterModel model;

		protected bool enableChangeEvents = true;

		protected bool alteredAscendingOrderSetting;

		protected virtual bool EnableChangeEvents
		{
			get
			{
				return enableChangeEvents;
			}
			set
			{
				if (enableChangeEvents != value)
				{
					enableChangeEvents = value;
					if (value)
					{
						Data.ColumnChanging += OnColumnChanging;
					}
					else
					{
						Data.ColumnChanging -= OnColumnChanging;
					}
				}
			}
		}

		public override DataTable Data
		{
			get
			{
				if (dataTable == null)
				{
					try
					{
						InitializeDataTable();
						if (dataTable != null)
						{
							dataTable.ColumnChanging += OnColumnChanging;
						}
					}
					catch (Exception)
					{
						throw;
					}
				}
				return dataTable;
			}
		}

		public ArrayController(IMonitoredModel arrayModel)
			: base(arrayModel)
		{
			model = arrayModel.ParameterModel;
		}

		protected abstract void CreateDataColumns();

		protected abstract void OnColumnChanging(object sender, DataColumnChangeEventArgs e);

		protected abstract void LoadDataTable();

		protected virtual void InitializeDataTable()
		{
			try
			{
				dataTable = new DataTable();
				dataTable.TableName = "DataTable";
				CreateDataColumns();
				LoadDataTable();
			}
			catch (Exception)
			{
				throw;
			}
		}

		protected virtual void Refresh(string columnName, int count, IArray1DModel parameterModel)
		{
			lock (Data)
			{
				for (int i = 0; i < count; i++)
				{
					Data.Rows[i][columnName] = parameterModel.GetValueByDataFormat(i, base.DisplayFormat);
				}
			}
		}

		protected virtual void UpdateRevertedValues(string columnName, SortedList previousValues, IArray1DModel parameterModel)
		{
			lock (Data)
			{
				foreach (object key in previousValues.Keys)
				{
					int index = (key as IArray1DIndex).Index;
					Data.Rows[index][columnName] = parameterModel.GetValueByDataFormat(index, base.DisplayFormat);
				}
			}
		}

		public override void Reload()
		{
			if (isDataTableLoaded)
			{
				return;
			}
			try
			{
				EnableChangeEvents = false;
				if (dataTable != null)
				{
					dataTable.Rows.Clear();
					LoadDataTable();
				}
				else
				{
					InitializeDataTable();
				}
			}
			finally
			{
				EnableChangeEvents = true;
			}
		}
	}
	public class Array1DController : ArrayController
	{
		private new IMonitoredModel model;

		private string displayUnit = string.Empty;

		private string xDisplayUnit = string.Empty;

		private int dataTableValueColumnChars;

		private int propertiesTablePropertyColumnChars;

		private int propertiesTableValueColumnChars;

		private string previousColumnName;

		private int previousRowIndex;

		private string previousValue;

		private new bool enableChangeEvents = true;

		public override DataTable Properties
		{
			get
			{
				if (propertiesTable == null)
				{
					try
					{
						InitializePropertiesTable();
					}
					catch (Exception)
					{
						throw;
					}
				}
				return propertiesTable;
			}
		}

		public string DisplayUnit
		{
			get
			{
				return displayUnit;
			}
			set
			{
				if (value.Length > 0)
				{
					displayUnit = value;
					Data.Columns["Value"].Caption = displayUnit;
				}
			}
		}

		public string XDisplayUnit
		{
			get
			{
				return xDisplayUnit;
			}
			set
			{
				if (value.Length > 0)
				{
					xDisplayUnit = value;
					Data.Columns["XAxis"].Caption = xDisplayUnit;
				}
			}
		}

		public int DataTableValueColumnChars
		{
			get
			{
				return dataTableValueColumnChars;
			}
			set
			{
				if (value > dataTableValueColumnChars)
				{
					dataTableValueColumnChars = value;
				}
			}
		}

		public override int PropertiesTablePropertyColumnChars
		{
			get
			{
				return propertiesTablePropertyColumnChars;
			}
			set
			{
				if (value > propertiesTablePropertyColumnChars)
				{
					propertiesTablePropertyColumnChars = value;
				}
			}
		}

		public override int PropertiesTableValueColumnChars
		{
			get
			{
				return propertiesTableValueColumnChars;
			}
			set
			{
				if (value > propertiesTableValueColumnChars)
				{
					propertiesTableValueColumnChars = value;
				}
			}
		}

		protected IArray1DModel ParameterModel => model.ParameterModel as IArray1DModel;

		public Array1DController(IMonitoredModel array1DModel)
			: base(array1DModel)
		{
			model = array1DModel;
			UpdateUndoInfo(-1, string.Empty, string.Empty);
			try
			{
				DisplayUnit = model.EngineeringUnits;
			}
			catch (Exception)
			{
				DisplayUnit = "(null)";
			}
			dataTableValueColumnChars = DisplayUnit.Length;
			propertiesTablePropertyColumnChars = 8;
			propertiesTableValueColumnChars = 5;
		}

		public override void Undo()
		{
			try
			{
				DataRow dataRow = dataTable.Rows[previousRowIndex];
				dataRow[previousColumnName] = previousValue;
			}
			catch
			{
			}
		}

		public override void Revert()
		{
			ParameterModel.Revert();
			UpdateRevertedValues("Value", ParameterModel.PreviousValues, ParameterModel);
			ParameterModel.PreviousValues.Clear();
			RaiseAllCellsUnmodifiedEvent();
		}

		public override void Save()
		{
			ParameterModel.Save();
			dataTable.AcceptChanges();
			RaiseAllCellsUnmodifiedEvent();
		}

		public override void DataMode(DataFormat displayFormat)
		{
			if (base.DisplayFormat != displayFormat)
			{
				base.DisplayFormat = displayFormat;
				try
				{
					dataTable.Rows.Clear();
					dataTable.ColumnChanging -= OnColumnChanging;
					LoadDataTable();
					dataTable.ColumnChanging += OnColumnChanging;
				}
				catch (Exception)
				{
				}
			}
		}

		private void InitializePropertiesTable()
		{
			try
			{
				propertiesTable = new DataTable();
				propertiesTable.TableName = "PropertiesTable";
				CreatePropertyColumns(propertiesTable);
				LoadPropertiesTable();
			}
			catch (Exception)
			{
				throw;
			}
		}

		protected override void CreateDataColumns()
		{
			DataColumn column = MakeDataColumn(XDisplayUnit, "XAxis", Type.GetType("System.String"), isReadOnly: false, isUnique: false);
			dataTable.Columns.Add(column);
			column = MakeDataColumn(DisplayUnit, "Value", Type.GetType("System.String"), isReadOnly: false, isUnique: false);
			dataTable.Columns.Add(column);
			column = MakeDataColumn("", "Index", Type.GetType("System.Int32"), isReadOnly: true, isUnique: true);
			column.ColumnMapping = MappingType.Hidden;
			dataTable.Columns.Add(column);
		}

		protected override void LoadDataTable()
		{
			if (!model.DataSource.Connected)
			{
				return;
			}
			if (model is IDataBlockModel)
			{
				LoadDataTableForDataBlock();
				return;
			}
			try
			{
				ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
				int count = ParameterModel.Count;
				for (int i = 0; i < count; i++)
				{
					DataRow dataRow;
					try
					{
						dataRow = dataTable.NewRow();
						if (base.DisplayFormat == DataFormat.Hex)
						{
							dataRow["Value"] = ParameterModel.HexValue(i);
						}
						else if (base.DisplayFormat == DataFormat.Binary)
						{
							dataRow["Value"] = ParameterModel.BinaryValue(i);
						}
						else
						{
							dataRow["Value"] = ParameterModel[i];
						}
						DataTableValueColumnChars = dataRow["Value"].ToString().Length;
					}
					catch (Exception ex)
					{
						throw ex;
					}
					try
					{
						dataRow["Index"] = i;
						dataTable.Rows.Add(dataRow);
					}
					catch (Exception ex2)
					{
						throw ex2;
					}
				}
				dataTable.AcceptChanges();
				isDataTableLoaded = true;
				RaiseDataLoadedEvent();
			}
			catch (Exception ex3)
			{
				throw ex3;
			}
			finally
			{
				if (SecurityLevelHelper.ToolFamily == ToolFamily.FieldEngineering || !(model.DataSource is ICalibrationECM))
				{
					ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.dataVolatile;
				}
			}
		}

		private void LoadDataTableForDataBlock()
		{
			if (!model.DataSource.Connected)
			{
				return;
			}
			try
			{
				ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
				byte[] array = ParameterModel.RawValue();
				byte[] array2 = new byte[1];
				for (int i = 0; i < array.Length; i++)
				{
					try
					{
						DataRow dataRow = dataTable.NewRow();
						array2[0] = array[i];
						if (base.DisplayFormat == DataFormat.Hex)
						{
							dataRow["Value"] = ParameterModel.ToHexString(array2);
						}
						else if (base.DisplayFormat == DataFormat.Binary)
						{
							dataRow["Value"] = ParameterModel.ToBinaryString(array2);
						}
						else
						{
							dataRow["Value"] = ParameterModel.ToHexString(array2);
						}
						DataTableValueColumnChars = dataRow["Value"].ToString().Length;
						dataRow["Index"] = i;
						dataTable.Rows.Add(dataRow);
					}
					catch (Exception)
					{
						throw;
					}
				}
				dataTable.AcceptChanges();
				isDataTableLoaded = true;
				RaiseDataLoadedEvent();
			}
			catch (Exception ex2)
			{
				throw ex2;
			}
			finally
			{
				if (SecurityLevelHelper.ToolFamily == ToolFamily.FieldEngineering || !(model.DataSource is ICalibrationECM))
				{
					ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.dataVolatile;
				}
			}
		}

		private void LoadPropertiesTable()
		{
			try
			{
				AddToPropertiesTable("Full Name", ParameterModel.FullName);
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Comment", ParameterModel.Comment);
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Address", ParameterModel.Address, "X8");
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Length", ParameterModel.Length.ToString());
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Data Type", (long)ParameterModel.DataType, "N0");
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Config Data Type", ParameterModel.ConfigFileType, "N0");
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Engineering Unit", ParameterModel.EngineeringUnits);
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Minimum Value", ParameterModel.LowerBound.ToString());
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Maximum Value", ParameterModel.UpperBound.ToString());
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Subfile Number", ParameterModel.SubfileNumber, "N0");
			}
			catch
			{
			}
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = "Available Offline";
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				if (ParameterModel.AvailableOffline)
				{
					dataRow["Value"] = "Yes";
				}
				else
				{
					dataRow["Value"] = "No";
				}
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
		}

		private void AddToPropertiesTable(string propertyName, string propertyValue)
		{
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = propertyName;
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = propertyValue;
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
		}

		private void AddToPropertiesTable(string propertyName, long propertyValue, string format)
		{
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = propertyName;
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = propertyValue.ToString(format);
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
		}

		private void UpdateUndoInfo(int rowIndex, string columnName, string valueBeforeEdit)
		{
			previousColumnName = columnName;
			previousRowIndex = rowIndex;
			previousValue = valueBeforeEdit;
		}

		protected override void OnColumnChanging(object sender, DataColumnChangeEventArgs e)
		{
			if (!(e.Column.ColumnName == "Value"))
			{
				return;
			}
			try
			{
				if (e.ProposedValue.ToString().Length == 0)
				{
					throw new Exception();
				}
				int num = (int)e.Row["Index"];
				string valueByDataFormat = ParameterModel.GetValueByDataFormat(num, base.DisplayFormat);
				if (valueByDataFormat != e.ProposedValue.ToString())
				{
					ParameterModel.SetValueByFormat(num, e.ProposedValue.ToString(), base.DisplayFormat);
					UpdateUndoInfo(num, e.Column.ColumnName, valueByDataFormat);
					RaiseCellChanged(sender, e);
				}
			}
			catch (Exception ex)
			{
				e.Row.CancelEdit();
				throw ex;
			}
		}
	}
}
namespace Cummins.Editor
{
	public class MonitoredArray1DController : Array1DController
	{
		private int xCount;

		private IAddressValue currentSourceAddress;

		private new MonitoredArray1DModel model;

		private IArray1DModel valueConverter;

		public bool ShowComments
		{
			get
			{
				return model.ShowComments;
			}
			set
			{
				if (model.ShowComments != value)
				{
					model.ShowComments = value;
				}
			}
		}

		public bool ValueEnabled
		{
			get
			{
				return model.ValueEnabled;
			}
			set
			{
				model.ValueEnabled = value;
			}
		}

		public DataFormat Radix
		{
			get
			{
				return model.Radix;
			}
			set
			{
				if (base.DisplayFormat != value)
				{
					model.Radix = value;
					DataMode(value);
				}
			}
		}

		public IAddressValue CurrentSourceAddress
		{
			get
			{
				return currentSourceAddress;
			}
			set
			{
				currentSourceAddress = value;
			}
		}

		public MonitoredArray1DController(MonitoredArray1DModel model)
			: base(model)
		{
			this.model = model;
			Initialize();
			this.model.DataSource.SaveChangesEvent += OnSaveChangesEvent;
		}

		public void Refresh(DataRefreshEventArgs e)
		{
			if (e != null)
			{
				switch (e.DataSourceType)
				{
				case DataSourceTypeEnum.ECM:
					Refresh(e as ECMDataRefreshEventArgs);
					break;
				case DataSourceTypeEnum.Disk:
					Refresh(e as DiskDataRefreshEventArgs);
					break;
				case DataSourceTypeEnum.ASAM:
					break;
				}
			}
		}

		private void Refresh(ECMDataRefreshEventArgs e)
		{
			if (e.IsProcessed)
			{
				return;
			}
			try
			{
				ArrayList eCMData = e.ECMData;
				base.EnableChangeEvents = false;
				for (int i = 0; i < eCMData.Count; i++)
				{
					ICIDataElementNotification iCIDataElementNotification = (ICIDataElementNotification)eCMData[i];
					if (iCIDataElementNotification.Status == tagCIDMStatusEnum.DM_STATUS_OK && iCIDataElementNotification.Changed)
					{
						if ((valueConverter.CalEntity as ICICalAddressableEntity).size != (iCIDataElementNotification.RawData as byte[]).Length)
						{
							string message = string.Format(Editor.ResourceManager.GetString(EditorMessageIDs.DataSizeMismatch.ToString()), (iCIDataElementNotification.RawData as byte[]).Length, (valueConverter.CalEntity as ICICalAddressableEntity).size);
							throw new DataSizeMismatchException(Facility.Editor, 17, message, "Source Addr", (iCIDataElementNotification.RawData as byte[]).Length, (valueConverter.CalEntity as ICICalAddressableEntity).size);
						}
						(valueConverter.CalEntity as ICICalAddressableEntity).RawData = (Array)iCIDataElementNotification.RawData;
						Refresh("Value", xCount, valueConverter);
					}
				}
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
		}

		private void Refresh(DiskDataRefreshEventArgs e)
		{
			SortedList diskData = e.DiskData;
			try
			{
				base.EnableChangeEvents = false;
				for (int i = 0; i < diskData.Count; i++)
				{
					IParameterModel parameterModel = (IParameterModel)diskData.GetByIndex(i);
					Refresh("Value", xCount, parameterModel as IArray1DModel);
				}
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
		}

		public virtual void SaveSession(NewDataSet.ScreenRow screenRow)
		{
			ScreenDataSaver screenDataSaver = new ScreenDataSaver();
			NewDataSet.GroupRow groupRow = screenDataSaver.SaveSession(screenRow);
			model.SaveSession(groupRow);
			((NewDataSet)screenRow.Table.DataSet).Group.AddGroupRow(groupRow);
			screenDataSaver.PopulateParameterTableRows(groupRow, MetaDataTable);
			base.ParameterModel.IsDirty = false;
		}

		public virtual void CleanupResources()
		{
			model.DataSource.SaveChangesEvent -= OnSaveChangesEvent;
			Data.Clear();
		}

		public override void Reload()
		{
			base.Reload();
			Initialize();
		}

		private void OnSaveChangesEvent(object sender, EventArgs e)
		{
			Data.AcceptChanges();
			base.ParameterModel.UpdateRevertValue();
			RaiseAllCellsUnmodifiedEvent();
		}

		private void Initialize()
		{
			if (valueConverter == null && model.DataSource.Connected)
			{
				lock (model.DataSource)
				{
					bool cacheEnabled = model.DataSource.CacheEnabled;
					model.DataSource.CacheEnabled = false;
					valueConverter = (IArray1DModel)model.DataSource.Get(base.ParameterModel.FullName);
					model.DataSource.CacheEnabled = cacheEnabled;
				}
				valueConverter.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
				xCount = valueConverter.Count;
			}
		}
	}
	public class MonitoredArray1DModel : MonitoredModel
	{
		private bool isChanged = true;

		private bool showComments = true;

		private DataFormat radix;

		private bool valueEnabled = true;

		public bool ShowComments
		{
			get
			{
				return showComments;
			}
			set
			{
				showComments = value;
				RaiseChangeShowCommentsEvent(showComments);
			}
		}

		public bool ValueEnabled
		{
			get
			{
				return valueEnabled;
			}
			set
			{
				valueEnabled = value;
				RaiseChangeValueEnabledEvent(value);
			}
		}

		public bool IsChanged
		{
			get
			{
				return isChanged;
			}
			set
			{
				isChanged = value;
			}
		}

		public DataFormat Radix
		{
			get
			{
				return radix;
			}
			set
			{
				radix = value;
			}
		}

		public event EventHandler ChangeShowCommentsState;

		public event StateChangedEventHandler ChangeValueEnabled;

		public MonitoredArray1DModel(IParameterModel parameterModel)
			: base(parameterModel)
		{
			base.DataType = ParameterType.Array1D;
		}

		public void Restore(NewDataSet.GroupRow groupRow)
		{
			try
			{
				base.ParameterModel.Name = groupRow.Name;
				base.ParameterModel.Comment = groupRow.Comment;
			}
			catch
			{
			}
		}

		public void SaveSession(NewDataSet.GroupRow groupRow)
		{
			groupRow.Name = base.ParameterModel.Name;
			groupRow.Comment = base.ParameterModel.Comment;
		}

		public void RaiseChangeValueEnabledEvent(bool enable)
		{
			if (this.ChangeValueEnabled != null)
			{
				this.ChangeValueEnabled(this, new BooleanStateEventArgs(enable));
			}
		}

		public void RaiseChangeShowCommentsEvent(bool show)
		{
			if (this.ChangeShowCommentsState != null)
			{
				this.ChangeShowCommentsState(this, EventArgs.Empty);
			}
		}
	}
}
namespace Cummins.Parameter
{
	public class Array1DDataView : ParameterView
	{
		private Array1DController controller;

		private TextBox textBoxName;

		private ComboBox comboBoxUnitSelection;

		private TextBox textBoxComment;

		private CustomDataGrid dataGrid;

		private Panel panel;

		private Container components;

		private ContextMenu csmMenu;

		private int rowClicked;

		private DataGridTableStyle tableStyle;

		private Point pointInCell00;

		public override Panel Panel => panel;

		private DataGridTableStyle TableStyle => tableStyle;

		private int RowHeaderWidth
		{
			get
			{
				return TableStyle.RowHeaderWidth;
			}
			set
			{
				TableStyle.RowHeaderWidth = value;
			}
		}

		private int TopRow
		{
			get
			{
				HitTestInfo val = ((DataGrid)dataGrid).HitTest(pointInCell00);
				return val.Row;
			}
		}

		protected CustomDataGrid Grid => dataGrid;

		protected Array1DDataView()
		{
		}

		public Array1DDataView(Array1DController array1DController, Font font)
			: base(font)
		{
			//IL_001c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0026: Expected O, but got Unknown
			//IL_0043: Unknown result type (might be due to invalid IL or missing references)
			//IL_004d: Expected O, but got Unknown
			//IL_006b: Unknown result type (might be due to invalid IL or missing references)
			//IL_0075: Expected O, but got Unknown
			//IL_0093: Unknown result type (might be due to invalid IL or missing references)
			//IL_009d: Expected O, but got Unknown
			//IL_00bc: Unknown result type (might be due to invalid IL or missing references)
			//IL_00c6: Expected O, but got Unknown
			//IL_01d5: Unknown result type (might be due to invalid IL or missing references)
			//IL_01df: Expected O, but got Unknown
			//IL_01ec: Unknown result type (might be due to invalid IL or missing references)
			//IL_01f6: Expected O, but got Unknown
			controller = array1DController;
			rowClicked = -1;
			InitializeComponent();
			csmMenu = new ContextMenu();
			((Menu)csmMenu).MenuItems.Add(0, new MenuItem("Copy", (EventHandler)Copy_Click));
			((Menu)csmMenu).MenuItems.Add(1, new MenuItem("Paste", (EventHandler)Paste_Click));
			((Menu)csmMenu).MenuItems.Add(2, new MenuItem("Undo", (EventHandler)Undo_Click));
			((Menu)csmMenu).MenuItems.Add(3, new MenuItem("Properties", (EventHandler)Properties_Click));
			((Control)dataGrid).ContextMenu = csmMenu;
			((DataGrid)dataGrid).AllowSorting = false;
			((DataGrid)dataGrid).CaptionText = controller.Name;
			((Control)textBoxName).Text = controller.Name;
			((Control)textBoxComment).Text = controller.Comment;
			if (controller.DisplayUnit.Length > 0)
			{
				comboBoxUnitSelection.Items.Add((object)controller.DisplayUnit);
				((Control)comboBoxUnitSelection).Text = controller.DisplayUnit;
			}
			else
			{
				comboBoxUnitSelection.Items.Add((object)"(null)");
				((Control)comboBoxUnitSelection).Text = "(null)";
			}
			InitializeView();
			controller.DataLoadedEvent += OnDataLoadedEvent;
			controller.CellChangedEvent += OnCellChanged;
			((Control)dataGrid).MouseDown += new MouseEventHandler(OnMouseDown);
			((Control)dataGrid).Paint += new PaintEventHandler(OnDataGridPaint);
			((DataGrid)dataGrid).Scroll += OnScrolling;
			controller.AllCellsUnmodifiedEvent += OnAllCellsUnmodified;
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		public override void SetDisplayMode(DataFormat dataFormat)
		{
			base.DataViewFormat = dataFormat;
			if (base.DataViewFormat != DataFormat.Decimal)
			{
				((Control)comboBoxUnitSelection).Enabled = false;
			}
			else
			{
				((Control)comboBoxUnitSelection).Enabled = true;
			}
			SetColumnStyles();
		}

		protected void Copy_Click(object sender, EventArgs e)
		{
			try
			{
				dataGrid.Copy();
			}
			catch
			{
			}
		}

		protected void Paste_Click(object sender, EventArgs e)
		{
			dataGrid.Paste();
		}

		protected void Undo_Click(object sender, EventArgs e)
		{
			int currentRowIndex = 0;
			if (rowClicked != -1)
			{
				currentRowIndex = rowClicked;
			}
			controller.Undo();
			((DataGrid)dataGrid).CurrentRowIndex = currentRowIndex;
		}

		protected override void Properties_Click(object sender, EventArgs e)
		{
			base.Properties_Click(this, e);
		}

		private void SetColumnStyles()
		{
			//IL_001d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0027: Expected O, but got Unknown
			//IL_0055: Unknown result type (might be due to invalid IL or missing references)
			//IL_005b: Expected O, but got Unknown
			((DataGrid)dataGrid).TableStyles.Clear();
			DataTable data = controller.Data;
			tableStyle = new DataGridTableStyle();
			tableStyle.MappingName = data.TableName;
			tableStyle.AllowSorting = false;
			CurrencyManager val = (CurrencyManager)((Control)dataGrid).BindingContext[(object)data];
			PropertyDescriptor pd = ((BindingManagerBase)val).GetItemProperties()["Value"];
			ColoredTextBoxColumn coloredTextBoxColumn = new ColoredTextBoxColumn((DataGrid)(object)dataGrid, pd);
			SetColumnStyle((DataGridTextBoxColumn)(object)coloredTextBoxColumn, data.Columns["Value"].Caption, "Value", GetColumnWidth(controller.DataTableValueColumnChars), data.Columns["Value"].ReadOnly);
			tableStyle.GridColumnStyles.Add((DataGridColumnStyle)(object)coloredTextBoxColumn);
			((Control)((DataGridTextBoxColumn)coloredTextBoxColumn).TextBox).ContextMenu = csmMenu;
			((DataGrid)dataGrid).TableStyles.Add(tableStyle);
			((Control)textBoxName).Width = GetColumnWidth(((Control)textBoxName).Text);
			Point location = ((Control)textBoxName).Location;
			location.X += (int)((double)((Control)textBoxName).Width + 2.0 * base.AverageCharacterWidth);
			((Control)comboBoxUnitSelection).Location = location;
			((Control)comboBoxUnitSelection).Width = GetColumnWidth(((Control)comboBoxUnitSelection).Text) + (int)(2.0 * base.AverageCharacterWidth);
			((Control)textBoxComment).Width = GetColumnWidth(((Control)textBoxComment).Text);
			((Control)textBoxName).ContextMenu = csmMenu;
		}

		private void OnCellChanged(object sender, DataColumnChangeEventArgs e)
		{
			ColoredTextBoxColumn coloredTextBoxColumn = (ColoredTextBoxColumn)(object)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles[e.Column.ColumnName];
			AddModifiedParameter(controller.Name);
			int rowNum = (int)e.Row["Index"];
			coloredTextBoxColumn.ShowCellModified(rowNum);
		}

		private void OnMouseDown(object sender, MouseEventArgs e)
		{
			//IL_0008: Unknown result type (might be due to invalid IL or missing references)
			//IL_0012: Invalid comparison between Unknown and I4
			//IL_0035: Unknown result type (might be due to invalid IL or missing references)
			//IL_003b: Invalid comparison between Unknown and I4
			//IL_003e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0044: Invalid comparison between Unknown and I4
			rowClicked = -1;
			if ((int)e.Button == 2097152)
			{
				Point point = new Point(e.X, e.Y);
				HitTestInfo val = ((DataGrid)dataGrid).HitTest(point);
				if ((int)val.Type == 4 || (int)val.Type == 1)
				{
					rowClicked = val.Row;
				}
			}
		}

		private void OnAllCellsUnmodified(object sender, EventArgs e)
		{
			if (((DataGrid)dataGrid).TableStyles["DataTable"] != null)
			{
				ColoredTextBoxColumn coloredTextBoxColumn = (ColoredTextBoxColumn)(object)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles["Value"];
				coloredTextBoxColumn.ShowAllCellsUnmodified();
			}
		}

		private void OnScrolling(object sender, EventArgs e)
		{
			((Control)dataGrid).Invalidate();
		}

		private void OnDataGridPaint(object sender, PaintEventArgs e)
		{
			//IL_00aa: Unknown result type (might be due to invalid IL or missing references)
			//IL_00b1: Expected O, but got Unknown
			//IL_00d0: Unknown result type (might be due to invalid IL or missing references)
			//IL_00e1: Expected O, but got Unknown
			if (!controller.DataTableLoaded)
			{
				return;
			}
			try
			{
				int num = TopRow;
				int num2 = ((DataGrid)dataGrid).GetCellBounds(num, 0).Height + 1;
				int num3 = ((DataGrid)dataGrid).GetCellBounds(num, 0).Top + 2;
				RowHeaderWidth = Convert.ToInt32(e.Graphics.MeasureString(dataGrid.RowCount.ToString(), ((Control)dataGrid).Font).Width) + 12;
				CurrencyManager val = (CurrencyManager)((Control)this).BindingContext[((DataGrid)dataGrid).DataSource, ((DataGrid)dataGrid).DataMember];
				while (num3 < ((Control)dataGrid).Height - num2 && num < ((BindingManagerBase)val).Count)
				{
					e.Graphics.DrawString(num.ToString(), ((Control)dataGrid).Font, (Brush)new SolidBrush(Color.Black), 12f, (float)num3);
					num3 += num2;
					num++;
				}
			}
			catch (IndexOutOfRangeException)
			{
			}
		}

		protected override void InitializeView()
		{
			//IL_0055: Unknown result type (might be due to invalid IL or missing references)
			//IL_005b: Expected O, but got Unknown
			DataTable data = controller.Data;
			if (controller.DataTableLoaded)
			{
				((DataGrid)dataGrid).DataSource = data;
				((DataGrid)dataGrid).AllowSorting = false;
				CurrencyManager val = (CurrencyManager)((Control)this).BindingContext[((DataGrid)dataGrid).DataSource, ((DataGrid)dataGrid).DataMember];
				((DataView)val.List).AllowNew = false;
				((DataView)val.List).AllowDelete = false;
				SetColumnStyles();
				pointInCell00 = new Point(((DataGrid)dataGrid).GetCellBounds(0, 0).Height, ((DataGrid)dataGrid).GetCellBounds(0, 0).Width);
			}
		}

		private void InitializeComponent()
		{
			//IL_0007: Unknown result type (might be due to invalid IL or missing references)
			//IL_0011: Expected O, but got Unknown
			//IL_001d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0027: Expected O, but got Unknown
			//IL_0028: Unknown result type (might be due to invalid IL or missing references)
			//IL_0032: Expected O, but got Unknown
			//IL_0033: Unknown result type (might be due to invalid IL or missing references)
			//IL_003d: Expected O, but got Unknown
			RangeSelection rangeSelection = new RangeSelection();
			panel = new Panel();
			dataGrid = new CustomDataGrid();
			textBoxComment = new TextBox();
			comboBoxUnitSelection = new ComboBox();
			textBoxName = new TextBox();
			((Control)panel).SuspendLayout();
			((ISupportInitialize)dataGrid).BeginInit();
			((Control)this).SuspendLayout();
			((Control)panel).Controls.Add((Control)(object)dataGrid);
			((Control)panel).Controls.Add((Control)(object)textBoxComment);
			((Control)panel).Controls.Add((Control)(object)comboBoxUnitSelection);
			((Control)panel).Controls.Add((Control)(object)textBoxName);
			((Control)panel).Dock = (DockStyle)5;
			((Control)panel).Location = new Point(0, 0);
			((Control)panel).Name = "panel";
			((Control)panel).Size = new Size(528, 328);
			((Control)panel).TabIndex = 0;
			dataGrid.AddRowWhilePaste = false;
			((Control)dataGrid).Anchor = (AnchorStyles)15;
			((DataGrid)dataGrid).DataMember = "";
			((DataGrid)dataGrid).HeaderForeColor = SystemColors.ControlText;
			((Control)dataGrid).Location = new Point(8, 8);
			((Control)dataGrid).Name = "dataGrid";
			rangeSelection.Bottom = -1;
			rangeSelection.Left = -1;
			rangeSelection.Right = -1;
			rangeSelection.Top = -1;
			dataGrid.SelectedRange = rangeSelection;
			((Control)dataGrid).Size = new Size(512, 312);
			((Control)dataGrid).TabIndex = 3;
			((Control)textBoxComment).Location = new Point(8, 44);
			((Control)textBoxComment).Name = "textBoxComment";
			((TextBoxBase)textBoxComment).ReadOnly = true;
			((Control)textBoxComment).Size = new Size(472, 20);
			((Control)textBoxComment).TabIndex = 2;
			((Control)textBoxComment).Text = "Comment";
			((Control)textBoxComment).Visible = false;
			comboBoxUnitSelection.DropDownStyle = (ComboBoxStyle)2;
			((Control)comboBoxUnitSelection).Location = new Point(144, 8);
			((Control)comboBoxUnitSelection).Name = "comboBoxUnitSelection";
			((Control)comboBoxUnitSelection).Size = new Size(121, 21);
			((Control)comboBoxUnitSelection).TabIndex = 1;
			((Control)comboBoxUnitSelection).Visible = false;
			((Control)textBoxName).Location = new Point(8, 8);
			((Control)textBoxName).Name = "textBoxName";
			((TextBoxBase)textBoxName).ReadOnly = true;
			((Control)textBoxName).Size = new Size(128, 20);
			((Control)textBoxName).TabIndex = 0;
			((Control)textBoxName).Text = "Name";
			((Control)textBoxName).Visible = false;
			((Control)this).Controls.Add((Control)(object)panel);
			((Control)this).Name = "Array1DDataView";
			((Control)this).Size = new Size(528, 328);
			((Control)panel).ResumeLayout(false);
			((Control)panel).PerformLayout();
			((ISupportInitialize)dataGrid).EndInit();
			((Control)this).ResumeLayout(false);
		}

		protected override bool ProcessCmdKey(ref Message m, Keys keyData)
		{
			//IL_000f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0010: Unknown result type (might be due to invalid IL or missing references)
			//IL_0016: Unknown result type (might be due to invalid IL or missing references)
			//IL_001c: Invalid comparison between Unknown and I4
			//IL_01ed: Unknown result type (might be due to invalid IL or missing references)
			//IL_01f3: Unknown result type (might be due to invalid IL or missing references)
			//IL_01f9: Invalid comparison between Unknown and I4
			//IL_0021: Unknown result type (might be due to invalid IL or missing references)
			//IL_0024: Invalid comparison between Unknown and I4
			//IL_0214: Unknown result type (might be due to invalid IL or missing references)
			//IL_01fb: Unknown result type (might be due to invalid IL or missing references)
			//IL_01fe: Invalid comparison between Unknown and I4
			//IL_0075: Unknown result type (might be due to invalid IL or missing references)
			//IL_007a: Unknown result type (might be due to invalid IL or missing references)
			//IL_0026: Unknown result type (might be due to invalid IL or missing references)
			//IL_0029: Invalid comparison between Unknown and I4
			//IL_0133: Unknown result type (might be due to invalid IL or missing references)
			//IL_0136: Invalid comparison between Unknown and I4
			try
			{
				Keys val = (Keys)((Message)(ref m)).WParam.ToInt32();
				if ((keyData & 0x40000) == 262144 && ((int)val == 38 || (int)val == 40))
				{
					long num = 0L;
					BindingManagerBase val2 = ((Control)this).BindingContext[((DataGrid)dataGrid).DataSource, ((DataGrid)dataGrid).DataMember];
					DataRowView dataRowView = (DataRowView)val2.Current;
					DataColumnCollection columns = dataRowView.DataView.Table.Columns;
					DataGridCell currentCell = ((DataGrid)dataGrid).CurrentCell;
					string columnName = columns[((DataGridCell)(ref currentCell)).ColumnNumber + 1].ColumnName;
					string text = dataRowView.Row[columnName].ToString();
					if (controller.DisplayFormat == DataFormat.Binary)
					{
						num = Convert.ToInt32(text, 2);
					}
					else if (controller.DisplayFormat == DataFormat.Hex)
					{
						num = long.Parse(text, NumberStyles.HexNumber);
					}
					else
					{
						if (text.IndexOf(".") != -1)
						{
							text = text.Remove(text.IndexOf("."), text.Length - text.IndexOf("."));
						}
						num = long.Parse(text);
						text = Convert.ToString(num, 16);
						num = long.Parse(text, NumberStyles.HexNumber);
					}
					num = (((int)val != 40) ? (num + 1) : (num - 1));
					if (controller.DisplayFormat == DataFormat.Binary)
					{
						string text2 = text;
						text = Convert.ToString(num, 2);
						if (text2.Length > text.Length)
						{
							text = text.PadLeft(text2.Length, '0');
						}
					}
					else if (controller.DisplayFormat == DataFormat.Hex)
					{
						string text3 = text;
						text = num.ToString("X");
						if (text3.Length > text.Length)
						{
							text = text.PadLeft(text3.Length, '0');
						}
					}
					else
					{
						text = $"{num}";
					}
					dataRowView.Row[columnName] = text;
					return true;
				}
				if ((keyData & 0x20000) == 131072 && (int)val == 73)
				{
					Properties_Click(this, null);
					return true;
				}
			}
			catch
			{
			}
			return ((ContainerControl)this).ProcessCmdKey(ref m, keyData);
		}
	}
}
namespace Cummins.Editor
{
	public class MonitoredArray1DView : Array1DDataView
	{
		private MonitoredArray1DController controller;

		public event KeyEventHandler GridKeyDown
		{
			add
			{
				base.Grid.GridKeyDown += value;
			}
			remove
			{
				base.Grid.GridKeyDown -= value;
			}
		}

		protected MonitoredArray1DView()
		{
		}

		public MonitoredArray1DView(MonitoredArray1DController controller, Font font)
			: base(controller, font)
		{
			this.controller = controller;
		}
	}
	public class MonitoredArrayX : Cummins.Parameter.Parameter, IMonitorElement, IDisposable
	{
		private bool disposed;

		private ArrayList iDLParametersList;

		public bool ShowComments
		{
			get
			{
				return ((MonitoredArrayXController)base.Controller).ShowComments;
			}
			set
			{
				((MonitoredArrayXController)base.Controller).ShowComments = value;
			}
		}

		public bool ValueEnabled
		{
			set
			{
				((MonitoredArrayXController)base.Controller).ValueEnabled = value;
			}
		}

		public bool IsDirty => ((MonitoredArrayXModel)base.ParameterModel).IsChanged;

		public DataFormat Radix
		{
			set
			{
				((MonitoredArrayXController)base.Controller).Radix = value;
			}
		}

		public IAddressValue CurrentSourceAddress
		{
			get
			{
				return ((MonitoredArrayXController)base.Controller).CurrentSourceAddress;
			}
			set
			{
				((MonitoredArrayXController)base.Controller).CurrentSourceAddress = value;
			}
		}

		public ArrayList IDLParametersList
		{
			get
			{
				if (iDLParametersList == null)
				{
					iDLParametersList = new ArrayList();
					LogParameters logParameters = new LogParameters
					{
						parameterName = base.ParameterModel.Name,
						sourceAddess = base.ParameterModel.DataSource.SourceAddress
					};
					iDLParametersList.Add(logParameters);
				}
				return iDLParametersList;
			}
		}

		public event KeyEventHandler GridKeyDown
		{
			add
			{
				((MonitoredArrayXView)base.DataView).GridKeyDown += value;
			}
			remove
			{
				((MonitoredArrayXView)base.DataView).GridKeyDown -= value;
			}
		}

		public MonitoredArrayX(IParameterModel parameterModel)
		{
			base.Model = new MonitoredArrayXModel(parameterModel);
			base.ParameterModel = parameterModel;
			base.ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
			base.Controller = new MonitoredArrayXController((MonitoredArrayXModel)base.Model);
			base.DataView = new MonitoredArrayXView((MonitoredArrayXController)base.Controller, base.Font);
			if (!(base.ParameterModel.DataSource is ICalibrationECM))
			{
				base.ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.dataVolatile;
			}
			disposed = false;
		}

		public void SaveSession(NewDataSet.ScreenRow screenRow)
		{
			((MonitoredArrayXController)base.Controller).SaveSession(screenRow);
		}

		public void Refresh(DataRefreshEventArgs e, bool forceUpdate)
		{
			((MonitoredArrayXController)base.Controller).Refresh(e);
		}

		public void Dispose()
		{
			Dispose(disposing: true);
			GC.SuppressFinalize(this);
		}

		protected virtual void Dispose(bool disposing)
		{
			if (!disposed && disposing)
			{
				CleaupResources();
			}
			disposed = true;
		}

		public void CleaupResources()
		{
			((Component)(object)base.DataView).Dispose();
			((MonitoredArrayXController)base.Controller).CleanupResources();
		}
	}
}
namespace Cummins.Parameter
{
	public class ArrayXController : ArrayController
	{
		private new IMonitoredModel model;

		private string displayUnit = string.Empty;

		private string xDisplayUnit = string.Empty;

		private int dataTableValueColumnChars;

		private int propertiesTablePropertyColumnChars;

		private int propertiesTableValueColumnChars;

		private string previousColumnName;

		private int previousRowIndex;

		private string previousValue;

		public override DataTable Properties
		{
			get
			{
				if (propertiesTable == null)
				{
					try
					{
						InitializePropertiesTable();
					}
					catch (Exception ex)
					{
						throw ex;
					}
				}
				return propertiesTable;
			}
		}

		public string DisplayUnit
		{
			get
			{
				return displayUnit;
			}
			set
			{
				if (value.Length <= 0)
				{
					return;
				}
				displayUnit = value;
				if (dataTable != null)
				{
					try
					{
						dataTable.Columns["Value"].Caption = displayUnit;
					}
					catch (Exception ex)
					{
						throw ex;
					}
				}
			}
		}

		public string XDisplayUnit
		{
			get
			{
				return xDisplayUnit;
			}
			set
			{
				if (value.Length <= 0)
				{
					return;
				}
				xDisplayUnit = value;
				if (dataTable != null)
				{
					try
					{
						dataTable.Columns["XAxis"].Caption = xDisplayUnit;
					}
					catch (Exception ex)
					{
						throw ex;
					}
				}
			}
		}

		public int DataTableValueColumnChars
		{
			get
			{
				return dataTableValueColumnChars;
			}
			set
			{
				if (value > dataTableValueColumnChars)
				{
					dataTableValueColumnChars = value;
				}
			}
		}

		public override int PropertiesTablePropertyColumnChars
		{
			get
			{
				return propertiesTablePropertyColumnChars;
			}
			set
			{
				if (value > propertiesTablePropertyColumnChars)
				{
					propertiesTablePropertyColumnChars = value;
				}
			}
		}

		public override int PropertiesTableValueColumnChars
		{
			get
			{
				return propertiesTableValueColumnChars;
			}
			set
			{
				if (value > propertiesTableValueColumnChars)
				{
					propertiesTableValueColumnChars = value;
				}
			}
		}

		protected IArray1DModel ParameterModel => model.ParameterModel as IArray1DModel;

		public ArrayXController(IMonitoredModel arrayXModel)
			: base(arrayXModel)
		{
			model = arrayXModel;
			UpdateUndoInfo(-1, string.Empty, string.Empty);
			try
			{
				displayUnit = model.EngineeringUnits;
			}
			catch (Exception)
			{
			}
			if (displayUnit == null)
			{
				displayUnit = "(null)";
			}
			dataTableValueColumnChars = displayUnit.Length;
			propertiesTablePropertyColumnChars = 8;
			propertiesTableValueColumnChars = 5;
		}

		public override void Undo()
		{
			try
			{
				DataRow dataRow = dataTable.Rows[previousRowIndex];
				dataRow[previousColumnName] = previousValue;
			}
			catch
			{
			}
		}

		public override void Revert()
		{
			model.ParameterModel.Revert();
			UpdateRevertedValues("Value", (model.ParameterModel as IArray1DModel).PreviousValues, model.ParameterModel as IArray1DModel);
			RaiseAllCellsUnmodifiedEvent();
		}

		public override void Save()
		{
			model.ParameterModel.Save();
			dataTable.AcceptChanges();
			RaiseAllCellsUnmodifiedEvent();
		}

		public override void DataMode(DataFormat displayFormat)
		{
			if (base.DisplayFormat != displayFormat)
			{
				base.DisplayFormat = displayFormat;
				try
				{
					dataTable.Rows.Clear();
					dataTable.ColumnChanging -= OnColumnChanging;
					LoadDataTable();
					dataTable.ColumnChanging += OnColumnChanging;
				}
				catch (Exception)
				{
				}
			}
		}

		public void Increment(int xIndex, int yIndex)
		{
			try
			{
				ParameterModel.X = xIndex;
				if (1 != ParameterModel.ConfigFileType)
				{
					ParameterModel.SetRawValue(ParameterModel.GetRawValue() + 1);
				}
				else
				{
					ParameterModel.ScaledFloat(ParameterModel.ScaledFloat() + ParameterModel.MinResolution);
				}
				DataRow dataRow = Data.Rows[xIndex];
				UpdateUndoInfo(xIndex, dataRow.Table.Columns[yIndex].ColumnName, dataRow[yIndex].ToString());
				dataRow[yIndex] = ParameterModel.ScaledValue;
				DataColumnChangeEventArgs e = new DataColumnChangeEventArgs(Data.Rows[xIndex], Data.Columns[yIndex], dataRow[yIndex]);
				RaiseCellChanged(this, e);
			}
			catch
			{
			}
		}

		public void Decrement(int xIndex, int yIndex)
		{
			try
			{
				ParameterModel.X = xIndex;
				if (1 != model.ParameterModel.ConfigFileType)
				{
					ParameterModel.SetRawValue(ParameterModel.GetRawValue() - 1);
				}
				else
				{
					ParameterModel.ScaledFloat(ParameterModel.ScaledFloat() - ParameterModel.MinResolution);
				}
				DataRow dataRow = Data.Rows[xIndex];
				UpdateUndoInfo(xIndex, dataRow.Table.Columns[yIndex].ColumnName, dataRow[yIndex].ToString());
				dataRow[yIndex] = ParameterModel.ScaledValue;
				DataColumnChangeEventArgs e = new DataColumnChangeEventArgs(Data.Rows[xIndex], Data.Columns[yIndex], dataRow[yIndex]);
				RaiseCellChanged(this, e);
			}
			catch
			{
			}
		}

		private void InitializePropertiesTable()
		{
			try
			{
				propertiesTable = new DataTable();
				propertiesTable.TableName = "PropertiesTable";
				CreatePropertyColumns(propertiesTable);
				LoadPropertiesTable();
			}
			catch (Exception ex)
			{
				throw ex;
			}
		}

		protected override void CreateDataColumns()
		{
			DataColumn column = MakeDataColumn(DisplayUnit, "Value", Type.GetType("System.String"), isReadOnly: false, isUnique: false);
			dataTable.Columns.Add(column);
			column = MakeDataColumn("", "Index", Type.GetType("System.Int32"), isReadOnly: true, isUnique: true);
			column.ColumnMapping = MappingType.Hidden;
			dataTable.Columns.Add(column);
		}

		protected override void LoadDataTable()
		{
			if (!model.DataSource.Connected)
			{
				return;
			}
			try
			{
				ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
				int count = ParameterModel.Count;
				for (int i = 0; i < count; i++)
				{
					DataRow dataRow;
					try
					{
						dataRow = dataTable.NewRow();
						if (base.DisplayFormat == DataFormat.Hex)
						{
							dataRow["Value"] = ParameterModel.HexValue(i);
						}
						else if (base.DisplayFormat == DataFormat.Binary)
						{
							dataRow["Value"] = ParameterModel.BinaryValue(i);
						}
						else
						{
							dataRow["Value"] = ParameterModel[i];
						}
						DataTableValueColumnChars = dataRow["Value"].ToString().Length;
					}
					catch (Exception ex)
					{
						throw ex;
					}
					try
					{
						dataRow["Index"] = i;
						dataTable.Rows.Add(dataRow);
					}
					catch (Exception ex2)
					{
						throw ex2;
					}
				}
				dataTable.AcceptChanges();
				isDataTableLoaded = true;
				RaiseDataLoadedEvent();
			}
			catch (Exception ex3)
			{
				throw ex3;
			}
			finally
			{
				if (SecurityLevelHelper.ToolFamily == ToolFamily.FieldEngineering || !(model.DataSource is ICalibrationECM))
				{
					ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.dataVolatile;
				}
			}
		}

		private void LoadPropertiesTable()
		{
			try
			{
				AddToPropertiesTable("Full Name", ParameterModel.FullName);
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Comment", ParameterModel.Comment);
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Address", ParameterModel.Address, "X8");
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Length", ParameterModel.Length.ToString());
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Data Type", (long)ParameterModel.DataType, "N0");
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Config Data Type", ParameterModel.ConfigFileType, "N0");
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Engineering Unit", ParameterModel.EngineeringUnits);
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Minimum Value", ParameterModel.LowerBound.ToString());
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Maximum Value", ParameterModel.UpperBound.ToString());
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Subfile Number", ParameterModel.SubfileNumber, "N0");
			}
			catch
			{
			}
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = "Available Offline";
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				if (ParameterModel.AvailableOffline)
				{
					dataRow["Value"] = "Yes";
				}
				else
				{
					dataRow["Value"] = "No";
				}
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
		}

		private void AddToPropertiesTable(string propertyName, string propertyValue)
		{
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = propertyName;
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = propertyValue;
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
		}

		private void AddToPropertiesTable(string propertyName, long propertyValue, string format)
		{
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = propertyName;
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = propertyValue.ToString(format);
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
		}

		protected override void OnColumnChanging(object sender, DataColumnChangeEventArgs e)
		{
			if (!(e.Column.ColumnName == "Value"))
			{
				return;
			}
			try
			{
				if (e.ProposedValue.ToString().Length == 0)
				{
					throw new ArgumentException();
				}
				int num = (int)e.Row["Index"];
				string actualValueSet = string.Empty;
				string valueByDataFormat = ParameterModel.GetValueByDataFormat(num, base.DisplayFormat);
				if (ParameterModel.SetValueAtIndex(num, e.ProposedValue.ToString(), base.DisplayFormat, out actualValueSet))
				{
					DisplayBoundMessage(e.ProposedValue.ToString(), actualValueSet, ParameterModel.LowerBound, ParameterModel.UpperBound, ParameterModel.Name);
					e.ProposedValue = actualValueSet;
					UpdateUndoInfo(num, e.Column.ColumnName, valueByDataFormat);
					RaiseCellChanged(sender, e);
					ParameterModel.IsDirty = true;
				}
			}
			catch (Exception ex)
			{
				EventLogger.Error("Value Edit", ex.Message, ex.InnerException);
				e.Row.CancelEdit();
				throw ex;
			}
		}

		private void UpdateUndoInfo(int rowIndex, string columnName, string valueBeforeEdit)
		{
			previousColumnName = columnName;
			previousRowIndex = rowIndex;
			previousValue = valueBeforeEdit;
		}
	}
}
namespace Cummins.Editor
{
	public class MonitoredArrayXController : ArrayXController
	{
		private int xCount;

		private IAddressValue currentSourceAddress;

		private new MonitoredArrayXModel model;

		private IArray1DModel valueConverter;

		public bool ShowComments
		{
			get
			{
				return model.ShowComments;
			}
			set
			{
				if (model.ShowComments != value)
				{
					model.ShowComments = value;
				}
			}
		}

		public bool ValueEnabled
		{
			get
			{
				return model.ValueEnabled;
			}
			set
			{
				model.ValueEnabled = value;
			}
		}

		public DataFormat Radix
		{
			get
			{
				return model.Radix;
			}
			set
			{
				if (base.DisplayFormat != value)
				{
					model.Radix = value;
					DataMode(value);
				}
			}
		}

		public IAddressValue CurrentSourceAddress
		{
			get
			{
				return currentSourceAddress;
			}
			set
			{
				currentSourceAddress = value;
			}
		}

		public MonitoredArrayXController(MonitoredArrayXModel model)
			: base(model)
		{
			this.model = model;
			Initialize();
			this.model.DataSource.SaveChangesEvent += OnSaveChangesEvent;
		}

		private void Initialize()
		{
			if (valueConverter == null && model.DataSource.Connected)
			{
				lock (model.DataSource)
				{
					bool cacheEnabled = model.DataSource.CacheEnabled;
					model.DataSource.CacheEnabled = false;
					valueConverter = (IArray1DModel)model.DataSource.Get(base.ParameterModel.FullName);
					model.DataSource.CacheEnabled = cacheEnabled;
				}
				valueConverter.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
				xCount = valueConverter.Count;
			}
		}

		public void Refresh(DataRefreshEventArgs e)
		{
			if (e != null)
			{
				switch (e.DataSourceType)
				{
				case DataSourceTypeEnum.ECM:
					Refresh(e as ECMDataRefreshEventArgs);
					break;
				case DataSourceTypeEnum.Disk:
					Refresh(e as DiskDataRefreshEventArgs);
					break;
				case DataSourceTypeEnum.ASAM:
					break;
				}
			}
		}

		private void Refresh(ECMDataRefreshEventArgs e)
		{
			if (e.IsProcessed)
			{
				return;
			}
			try
			{
				ArrayList eCMData = e.ECMData;
				base.EnableChangeEvents = false;
				for (int i = 0; i < eCMData.Count; i++)
				{
					ICIDataElementNotification iCIDataElementNotification = (ICIDataElementNotification)eCMData[i];
					if (iCIDataElementNotification.Status == tagCIDMStatusEnum.DM_STATUS_OK && iCIDataElementNotification.Changed)
					{
						if ((valueConverter.CalEntity as ICICalAddressableEntity).size != (iCIDataElementNotification.RawData as byte[]).Length)
						{
							string message = string.Format(Editor.ResourceManager.GetString(EditorMessageIDs.DataSizeMismatch.ToString()), (iCIDataElementNotification.RawData as byte[]).Length, (valueConverter.CalEntity as ICICalAddressableEntity).size);
							throw new DataSizeMismatchException(Facility.Editor, 17, message, "Source Addr", (iCIDataElementNotification.RawData as byte[]).Length, (valueConverter.CalEntity as ICICalAddressableEntity).size);
						}
						(valueConverter.CalEntity as ICICalAddressableEntity).RawData = (Array)iCIDataElementNotification.RawData;
						Refresh("Value", xCount, valueConverter);
					}
				}
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
		}

		private void Refresh(DiskDataRefreshEventArgs e)
		{
			SortedList diskData = e.DiskData;
			try
			{
				base.EnableChangeEvents = false;
				for (int i = 0; i < diskData.Count; i++)
				{
					IParameterModel parameterModel = (IParameterModel)diskData.GetByIndex(i);
					Refresh("Value", xCount, parameterModel as IArray1DModel);
				}
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
		}

		public virtual void SaveSession(NewDataSet.ScreenRow screenRow)
		{
			ScreenDataSaver screenDataSaver = new ScreenDataSaver();
			NewDataSet.GroupRow groupRow = screenDataSaver.SaveSession(screenRow);
			model.SaveSession(groupRow);
			((NewDataSet)screenRow.Table.DataSet).Group.AddGroupRow(groupRow);
			screenDataSaver.PopulateParameterTableRows(groupRow, MetaDataTable);
			base.ParameterModel.IsDirty = false;
		}

		public override void Reload()
		{
			base.Reload();
			Initialize();
		}

		public virtual void CleanupResources()
		{
			model.DataSource.SaveChangesEvent -= OnSaveChangesEvent;
			Data.Clear();
		}

		private void OnSaveChangesEvent(object sender, EventArgs e)
		{
			Data.AcceptChanges();
			base.ParameterModel.UpdateRevertValue();
			RaiseAllCellsUnmodifiedEvent();
		}
	}
	public class MonitoredArrayXModel : MonitoredModel
	{
		private bool isChanged = true;

		private bool showComments = true;

		private DataFormat radix;

		private bool valueEnabled = true;

		public bool ShowComments
		{
			get
			{
				return showComments;
			}
			set
			{
				showComments = value;
				RaiseChangeShowCommentsEvent(showComments);
			}
		}

		public bool ValueEnabled
		{
			get
			{
				return valueEnabled;
			}
			set
			{
				valueEnabled = value;
				RaiseChangeValueEnabledEvent(value);
			}
		}

		public bool IsChanged
		{
			get
			{
				return isChanged;
			}
			set
			{
				isChanged = value;
			}
		}

		public DataFormat Radix
		{
			get
			{
				return radix;
			}
			set
			{
				radix = value;
			}
		}

		public event EventHandler ChangeShowCommentsState;

		public event StateChangedEventHandler ChangeValueEnabled;

		public MonitoredArrayXModel(IParameterModel parameterModel)
			: base(parameterModel.DataSource)
		{
			base.DataType = ParameterType.ArrayXAxis;
			base.DataSource = parameterModel.DataSource;
		}

		public void Restore(NewDataSet.GroupRow groupRow)
		{
			try
			{
				Name = groupRow.Name;
				Comment = groupRow.Comment;
			}
			catch
			{
			}
		}

		public void SaveSession(NewDataSet.GroupRow groupRow)
		{
			groupRow.Name = Name;
			groupRow.Comment = Comment;
		}

		public void RaiseChangeValueEnabledEvent(bool enable)
		{
			if (this.ChangeValueEnabled != null)
			{
				this.ChangeValueEnabled(this, new BooleanStateEventArgs(enable));
			}
		}

		public void RaiseChangeShowCommentsEvent(bool show)
		{
			if (this.ChangeShowCommentsState != null)
			{
				this.ChangeShowCommentsState(this, EventArgs.Empty);
			}
		}
	}
}
namespace Cummins.Parameter
{
	public class ArrayXDataView : ParameterView
	{
		private ArrayXController controller;

		private TextBox textBoxName;

		private ComboBox comboBoxUnitSelection;

		private TextBox textBoxComment;

		private CustomDataGrid dataGrid;

		private Panel panel;

		private Container components;

		private ContextMenu csmMenu;

		private int rowClicked;

		private ColoredTextBoxColumn valueColumn;

		private CurrencyManager tableCurrency;

		private Point pointInCell00;

		private DataGridTableStyle tableStyle;

		public override Panel Panel => panel;

		private int TopRow
		{
			get
			{
				HitTestInfo val = ((DataGrid)dataGrid).HitTest(pointInCell00);
				return val.Row;
			}
		}

		private DataGridTableStyle TableStyle => tableStyle;

		private int RowHeaderWidth
		{
			get
			{
				return TableStyle.RowHeaderWidth;
			}
			set
			{
				TableStyle.RowHeaderWidth = value;
			}
		}

		protected CustomDataGrid Grid => dataGrid;

		protected CurrencyManager TableCurrency
		{
			get
			{
				//IL_0024: Unknown result type (might be due to invalid IL or missing references)
				//IL_002e: Expected O, but got Unknown
				if (tableCurrency == null)
				{
					tableCurrency = (CurrencyManager)((Control)dataGrid).BindingContext[(object)controller.Data];
				}
				return tableCurrency;
			}
		}

		protected ColoredTextBoxColumn ValueColumn
		{
			get
			{
				if (valueColumn == null)
				{
					valueColumn = new ColoredTextBoxColumn((DataGrid)(object)dataGrid, ((BindingManagerBase)TableCurrency).GetItemProperties()["Value"]);
					((DataGridColumnStyle)valueColumn).NullText = "";
				}
				return valueColumn;
			}
		}

		protected ArrayXDataView()
		{
			InitializeComponent();
		}

		public ArrayXDataView(ArrayXController arrayXController, Font font)
			: base(font)
		{
			//IL_001c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0026: Expected O, but got Unknown
			//IL_0043: Unknown result type (might be due to invalid IL or missing references)
			//IL_004d: Expected O, but got Unknown
			//IL_006b: Unknown result type (might be due to invalid IL or missing references)
			//IL_0075: Expected O, but got Unknown
			//IL_0093: Unknown result type (might be due to invalid IL or missing references)
			//IL_009d: Expected O, but got Unknown
			//IL_00bc: Unknown result type (might be due to invalid IL or missing references)
			//IL_00c6: Expected O, but got Unknown
			//IL_00fb: Unknown result type (might be due to invalid IL or missing references)
			//IL_0105: Expected O, but got Unknown
			//IL_01ab: Unknown result type (might be due to invalid IL or missing references)
			//IL_01b5: Expected O, but got Unknown
			controller = arrayXController;
			rowClicked = -1;
			InitializeComponent();
			csmMenu = new ContextMenu();
			((Menu)csmMenu).MenuItems.Add(0, new MenuItem("Copy", (EventHandler)Copy_Click));
			((Menu)csmMenu).MenuItems.Add(1, new MenuItem("Paste", (EventHandler)Paste_Click));
			((Menu)csmMenu).MenuItems.Add(2, new MenuItem("Undo", (EventHandler)Undo_Click));
			((Menu)csmMenu).MenuItems.Add(3, new MenuItem("Properties", (EventHandler)Properties_Click));
			((Control)dataGrid).ContextMenu = csmMenu;
			((DataGrid)dataGrid).CaptionText = controller.Name;
			((Control)dataGrid).MouseDown += new MouseEventHandler(OnMouseDown);
			((Control)textBoxName).Text = controller.Name;
			((Control)textBoxComment).Text = controller.Comment;
			if (controller.DisplayUnit.Length > 0)
			{
				comboBoxUnitSelection.Items.Add((object)controller.DisplayUnit);
				((Control)comboBoxUnitSelection).Text = controller.DisplayUnit;
			}
			else
			{
				comboBoxUnitSelection.Items.Add((object)"(null)");
				((Control)comboBoxUnitSelection).Text = "(null)";
			}
			((Control)dataGrid).Paint += new PaintEventHandler(OnDataGridPaint);
			((DataGrid)dataGrid).Scroll += OnScrolling;
			InitializeView();
			controller.DataLoadedEvent += OnDataLoadedEvent;
			controller.CellChangedEvent += OnCellChanged;
			controller.AllCellsUnmodifiedEvent += OnAllCellsUnmodified;
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		public override void SetDisplayMode(DataFormat dataFormat)
		{
			base.DataViewFormat = dataFormat;
			if (base.DataViewFormat != DataFormat.Decimal)
			{
				((Control)comboBoxUnitSelection).Enabled = false;
			}
			else
			{
				((Control)comboBoxUnitSelection).Enabled = true;
			}
			SetColumnStyles();
		}

		protected void Copy_Click(object sender, EventArgs e)
		{
			try
			{
				dataGrid.Copy();
			}
			catch
			{
			}
		}

		protected void Paste_Click(object sender, EventArgs e)
		{
			try
			{
				dataGrid.Paste();
			}
			catch
			{
			}
		}

		protected void Undo_Click(object sender, EventArgs e)
		{
			int currentRowIndex = 0;
			if (rowClicked != -1)
			{
				currentRowIndex = rowClicked;
			}
			controller.Undo();
			((DataGrid)dataGrid).CurrentRowIndex = currentRowIndex;
		}

		protected override void Properties_Click(object sender, EventArgs e)
		{
			base.Properties_Click(this, e);
		}

		private void SetColumnStyles()
		{
			//IL_001d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0027: Expected O, but got Unknown
			((DataGrid)dataGrid).TableStyles.Clear();
			DataTable data = controller.Data;
			tableStyle = new DataGridTableStyle();
			tableStyle.MappingName = data.TableName;
			tableStyle.AllowSorting = false;
			SetColumnStyle((DataGridTextBoxColumn)(object)ValueColumn, data.Columns["Value"].Caption, "Value", GetColumnWidth(controller.DataTableValueColumnChars), data.Columns["Value"].ReadOnly);
			tableStyle.GridColumnStyles.Add((DataGridColumnStyle)(object)ValueColumn);
			((Control)((DataGridTextBoxColumn)ValueColumn).TextBox).ContextMenu = csmMenu;
			((DataGrid)dataGrid).TableStyles.Add(tableStyle);
			((Control)textBoxName).Width = GetColumnWidth(((Control)textBoxName).Text);
			Point location = ((Control)textBoxName).Location;
			location.X += (int)((double)((Control)textBoxName).Width + 2.0 * base.AverageCharacterWidth);
			((Control)comboBoxUnitSelection).Location = location;
			((Control)comboBoxUnitSelection).Width = GetColumnWidth(((Control)comboBoxUnitSelection).Text) + (int)(2.0 * base.AverageCharacterWidth);
			((Control)textBoxComment).Width = GetColumnWidth(((Control)textBoxComment).Text);
			((Control)textBoxName).ContextMenu = csmMenu;
		}

		private void OnCellChanged(object sender, DataColumnChangeEventArgs e)
		{
			ColoredTextBoxColumn coloredTextBoxColumn = (ColoredTextBoxColumn)(object)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles[e.Column.ColumnName];
			AddModifiedParameter(controller.Name);
			int rowNum = (int)e.Row["Index"];
			coloredTextBoxColumn.ShowCellModified(rowNum);
		}

		private void OnMouseDown(object sender, MouseEventArgs e)
		{
			//IL_0008: Unknown result type (might be due to invalid IL or missing references)
			//IL_0012: Invalid comparison between Unknown and I4
			//IL_0035: Unknown result type (might be due to invalid IL or missing references)
			//IL_003b: Invalid comparison between Unknown and I4
			//IL_003e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0044: Invalid comparison between Unknown and I4
			rowClicked = -1;
			if ((int)e.Button == 2097152)
			{
				Point point = new Point(e.X, e.Y);
				HitTestInfo val = ((DataGrid)dataGrid).HitTest(point);
				if ((int)val.Type == 4 || (int)val.Type == 1)
				{
					rowClicked = val.Row;
				}
			}
		}

		private void OnAllCellsUnmodified(object sender, EventArgs e)
		{
			if (((DataGrid)dataGrid).TableStyles["DataTable"] != null)
			{
				ColoredTextBoxColumn coloredTextBoxColumn = (ColoredTextBoxColumn)(object)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles["Value"];
				coloredTextBoxColumn.ShowAllCellsUnmodified();
			}
		}

		private void OnDataGridPaint(object sender, PaintEventArgs e)
		{
			//IL_00aa: Unknown result type (might be due to invalid IL or missing references)
			//IL_00b1: Expected O, but got Unknown
			//IL_00d0: Unknown result type (might be due to invalid IL or missing references)
			//IL_00e1: Expected O, but got Unknown
			if (!controller.DataTableLoaded)
			{
				return;
			}
			try
			{
				int num = TopRow;
				int num2 = ((DataGrid)dataGrid).GetCellBounds(num, 0).Height + 1;
				int num3 = ((DataGrid)dataGrid).GetCellBounds(num, 0).Top + 2;
				RowHeaderWidth = Convert.ToInt32(e.Graphics.MeasureString(dataGrid.RowCount.ToString(), ((Control)dataGrid).Font).Width) + 12;
				CurrencyManager val = (CurrencyManager)((Control)this).BindingContext[((DataGrid)dataGrid).DataSource, ((DataGrid)dataGrid).DataMember];
				while (num3 < ((Control)dataGrid).Height - num2 && num < ((BindingManagerBase)val).Count)
				{
					e.Graphics.DrawString(num.ToString(), ((Control)dataGrid).Font, (Brush)new SolidBrush(Color.Black), 12f, (float)num3);
					num3 += num2;
					num++;
				}
			}
			catch (IndexOutOfRangeException)
			{
			}
		}

		private void OnScrolling(object sender, EventArgs e)
		{
			((Control)dataGrid).Invalidate();
		}

		protected override void InitializeView()
		{
			//IL_0055: Unknown result type (might be due to invalid IL or missing references)
			//IL_005b: Expected O, but got Unknown
			DataTable data = controller.Data;
			if (controller.DataTableLoaded)
			{
				((DataGrid)dataGrid).DataSource = data;
				((DataGrid)dataGrid).AllowSorting = false;
				CurrencyManager val = (CurrencyManager)((Control)this).BindingContext[((DataGrid)dataGrid).DataSource, ((DataGrid)dataGrid).DataMember];
				((DataView)val.List).AllowNew = false;
				((DataView)val.List).AllowDelete = false;
				SetColumnStyles();
				pointInCell00 = new Point(((DataGrid)dataGrid).GetCellBounds(0, 0).Height, ((DataGrid)dataGrid).GetCellBounds(0, 0).Width);
			}
		}

		private void InitializeComponent()
		{
			//IL_0007: Unknown result type (might be due to invalid IL or missing references)
			//IL_0011: Expected O, but got Unknown
			//IL_001d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0027: Expected O, but got Unknown
			//IL_0028: Unknown result type (might be due to invalid IL or missing references)
			//IL_0032: Expected O, but got Unknown
			//IL_0033: Unknown result type (might be due to invalid IL or missing references)
			//IL_003d: Expected O, but got Unknown
			RangeSelection rangeSelection = new RangeSelection();
			panel = new Panel();
			dataGrid = new CustomDataGrid();
			textBoxComment = new TextBox();
			comboBoxUnitSelection = new ComboBox();
			textBoxName = new TextBox();
			((Control)panel).SuspendLayout();
			((ISupportInitialize)dataGrid).BeginInit();
			((Control)this).SuspendLayout();
			((Control)panel).Controls.Add((Control)(object)dataGrid);
			((Control)panel).Controls.Add((Control)(object)textBoxComment);
			((Control)panel).Controls.Add((Control)(object)comboBoxUnitSelection);
			((Control)panel).Controls.Add((Control)(object)textBoxName);
			((Control)panel).Dock = (DockStyle)5;
			((Control)panel).Location = new Point(0, 0);
			((Control)panel).Name = "panel";
			((Control)panel).Size = new Size(528, 328);
			((Control)panel).TabIndex = 0;
			dataGrid.AddRowWhilePaste = false;
			((Control)dataGrid).Anchor = (AnchorStyles)15;
			((DataGrid)dataGrid).DataMember = "";
			((DataGrid)dataGrid).HeaderForeColor = SystemColors.ControlText;
			((Control)dataGrid).Location = new Point(8, 8);
			((Control)dataGrid).Name = "dataGrid";
			rangeSelection.Bottom = -1;
			rangeSelection.Left = -1;
			rangeSelection.Right = -1;
			rangeSelection.Top = -1;
			dataGrid.SelectedRange = rangeSelection;
			((Control)dataGrid).Size = new Size(512, 312);
			((Control)dataGrid).TabIndex = 3;
			((Control)textBoxComment).Location = new Point(8, 44);
			((Control)textBoxComment).Name = "textBoxComment";
			((TextBoxBase)textBoxComment).ReadOnly = true;
			((Control)textBoxComment).Size = new Size(472, 20);
			((Control)textBoxComment).TabIndex = 2;
			((Control)textBoxComment).Text = "Comment";
			((Control)textBoxComment).Visible = false;
			comboBoxUnitSelection.DropDownStyle = (ComboBoxStyle)2;
			((Control)comboBoxUnitSelection).Location = new Point(144, 8);
			((Control)comboBoxUnitSelection).Name = "comboBoxUnitSelection";
			((Control)comboBoxUnitSelection).Size = new Size(121, 21);
			((Control)comboBoxUnitSelection).TabIndex = 1;
			((Control)comboBoxUnitSelection).Visible = false;
			((Control)textBoxName).Location = new Point(8, 8);
			((Control)textBoxName).Name = "textBoxName";
			((TextBoxBase)textBoxName).ReadOnly = true;
			((Control)textBoxName).Size = new Size(128, 20);
			((Control)textBoxName).TabIndex = 0;
			((Control)textBoxName).Text = "Name";
			((Control)textBoxName).Visible = false;
			((Control)this).Controls.Add((Control)(object)panel);
			((Control)this).Name = "ArrayXDataView";
			((Control)this).Size = new Size(528, 328);
			((Control)panel).ResumeLayout(false);
			((Control)panel).PerformLayout();
			((ISupportInitialize)dataGrid).EndInit();
			((Control)this).ResumeLayout(false);
		}

		protected override bool ProcessCmdKey(ref Message m, Keys keyData)
		{
			//IL_000f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0010: Unknown result type (might be due to invalid IL or missing references)
			//IL_0016: Unknown result type (might be due to invalid IL or missing references)
			//IL_001c: Invalid comparison between Unknown and I4
			//IL_00a9: Unknown result type (might be due to invalid IL or missing references)
			//IL_00af: Unknown result type (might be due to invalid IL or missing references)
			//IL_00b5: Invalid comparison between Unknown and I4
			//IL_0021: Unknown result type (might be due to invalid IL or missing references)
			//IL_0024: Invalid comparison between Unknown and I4
			//IL_00b7: Unknown result type (might be due to invalid IL or missing references)
			//IL_00ba: Invalid comparison between Unknown and I4
			//IL_005f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0064: Unknown result type (might be due to invalid IL or missing references)
			//IL_0074: Unknown result type (might be due to invalid IL or missing references)
			//IL_0079: Unknown result type (might be due to invalid IL or missing references)
			//IL_0083: Unknown result type (might be due to invalid IL or missing references)
			//IL_0086: Invalid comparison between Unknown and I4
			//IL_0026: Unknown result type (might be due to invalid IL or missing references)
			//IL_0029: Invalid comparison between Unknown and I4
			//IL_00dc: Unknown result type (might be due to invalid IL or missing references)
			try
			{
				Keys val = (Keys)((Message)(ref m)).WParam.ToInt32();
				if ((keyData & 0x40000) == 262144 && ((int)val == 38 || (int)val == 40))
				{
					BindingManagerBase val2 = ((Control)this).BindingContext[((DataGrid)dataGrid).DataSource, ((DataGrid)dataGrid).DataMember];
					_ = (DataRowView)val2.Current;
					DataGridCell currentCell = ((DataGrid)dataGrid).CurrentCell;
					int columnNumber = ((DataGridCell)(ref currentCell)).ColumnNumber;
					DataGridCell currentCell2 = ((DataGrid)dataGrid).CurrentCell;
					int rowNumber = ((DataGridCell)(ref currentCell2)).RowNumber;
					if ((int)val == 38)
					{
						controller.Increment(rowNumber, columnNumber);
					}
					else
					{
						controller.Decrement(rowNumber, columnNumber);
					}
					return true;
				}
				if ((keyData & 0x20000) == 131072 && (int)val == 73)
				{
					Properties_Click(this, null);
					return true;
				}
			}
			catch (Exception innerException)
			{
				throw new Exception("dsfds", innerException);
			}
			return ((ContainerControl)this).ProcessCmdKey(ref m, keyData);
		}
	}
}
namespace Cummins.Editor
{
	public class MonitoredArrayXView : ArrayXDataView
	{
		private MonitoredArrayXController controller;

		public event KeyEventHandler GridKeyDown
		{
			add
			{
				base.Grid.GridKeyDown += value;
			}
			remove
			{
				base.Grid.GridKeyDown -= value;
			}
		}

		protected MonitoredArrayXView()
		{
		}

		public MonitoredArrayXView(MonitoredArrayXController controller, Font font)
			: base(controller, font)
		{
			this.controller = controller;
		}
	}
	public class MonitoredArrayXY : Cummins.Parameter.Parameter, IMonitorElement, IDisposable
	{
		private bool disposed;

		private ArrayList iDLParametersList;

		public bool ShowComments
		{
			get
			{
				return ((MonitoredArrayXYController)base.Controller).ShowComments;
			}
			set
			{
				((MonitoredArrayXYController)base.Controller).ShowComments = value;
			}
		}

		public bool ValueEnabled
		{
			set
			{
				((MonitoredArrayXYController)base.Controller).ValueEnabled = value;
			}
		}

		public bool IsDirty => ((MonitoredArrayXYModel)base.ParameterModel).IsChanged;

		public DataFormat Radix
		{
			set
			{
				((MonitoredArrayXYController)base.Controller).Radix = value;
			}
		}

		public IAddressValue CurrentSourceAddress
		{
			get
			{
				return ((MonitoredArrayXYController)base.Controller).CurrentSourceAddress;
			}
			set
			{
				((MonitoredArrayXYController)base.Controller).CurrentSourceAddress = value;
			}
		}

		public ArrayList IDLParametersList
		{
			get
			{
				if (iDLParametersList == null)
				{
					iDLParametersList = new ArrayList();
					LogParameters logParameters = new LogParameters
					{
						parameterName = base.ParameterModel.Name,
						sourceAddess = base.ParameterModel.DataSource.SourceAddress
					};
					iDLParametersList.Add(logParameters);
				}
				return iDLParametersList;
			}
		}

		public event KeyEventHandler GridKeyDown
		{
			add
			{
				((MonitoredArrayXYView)base.DataView).GridKeyDown += value;
			}
			remove
			{
				((MonitoredArrayXYView)base.DataView).GridKeyDown -= value;
			}
		}

		public MonitoredArrayXY(IParameterModel parameterModel)
			: base(parameterModel)
		{
			base.Model = new MonitoredArrayXYModel(parameterModel);
			base.ParameterModel = parameterModel;
			base.ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
			base.Controller = new MonitoredArrayXYController((MonitoredArrayXYModel)base.Model);
			base.DataView = new MonitoredArrayXYView((MonitoredArrayXYController)base.Controller, base.Font);
			if (SecurityLevelHelper.ToolFamily == ToolFamily.FieldEngineering || !(base.ParameterModel.DataSource is ICalibrationECM))
			{
				base.ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.dataVolatile;
			}
			disposed = false;
		}

		public void Refresh(DataRefreshEventArgs e, bool forceUpdate)
		{
			((MonitoredArrayXYController)base.Controller).Refresh(e);
		}

		public void SaveSession(NewDataSet.ScreenRow screenRow)
		{
			((MonitoredArrayXYController)base.Controller).SaveSession(screenRow);
		}

		public void Dispose()
		{
			Dispose(disposing: true);
			GC.SuppressFinalize(this);
		}

		protected virtual void Dispose(bool disposing)
		{
			if (!disposed && disposing)
			{
				CleaupResources();
			}
			disposed = true;
		}

		public void CleaupResources()
		{
			((Component)(object)base.DataView).Dispose();
			((MonitoredArrayXYController)base.Controller).CleanupResources();
		}
	}
}
namespace Cummins.Parameter
{
	public class ArrayXYController : ArrayController
	{
		private new IMonitoredModel model;

		private string displayUnit = string.Empty;

		private string xDisplayUnit = string.Empty;

		private int dataTableXAxisColumnChars;

		private int dataTableValueColumnChars;

		private int propertiesTablePropertyColumnChars;

		private int propertiesTableValueColumnChars;

		private string previousColumnName;

		private int previousRowIndex;

		private string previousValue;

		private bool isUpDownOperation;

		public override DataTable Properties
		{
			get
			{
				if (propertiesTable == null)
				{
					InitializePropertiesTable();
				}
				return propertiesTable;
			}
		}

		public string DisplayUnit
		{
			get
			{
				return displayUnit;
			}
			set
			{
				if (value.Length > 0)
				{
					displayUnit = value;
					if (dataTable != null)
					{
						dataTable.Columns["Value"].Caption = displayUnit;
					}
				}
			}
		}

		public string XDisplayUnit
		{
			get
			{
				return xDisplayUnit;
			}
			set
			{
				if (value.Length > 0)
				{
					xDisplayUnit = value;
					if (dataTable != null)
					{
						dataTable.Columns["XAxis"].Caption = xDisplayUnit;
					}
				}
			}
		}

		public string XName
		{
			get
			{
				IArray1DModel xAxis = ParameterModel.XAxis;
				if (xAxis == null)
				{
					return "[missing]";
				}
				return xAxis.Name;
			}
		}

		public int DataTableXAxisColumnChars
		{
			get
			{
				return dataTableXAxisColumnChars;
			}
			set
			{
				dataTableXAxisColumnChars = value;
			}
		}

		public int DataTableValueColumnChars
		{
			get
			{
				return dataTableValueColumnChars;
			}
			set
			{
				dataTableValueColumnChars = value;
			}
		}

		public override int PropertiesTablePropertyColumnChars
		{
			get
			{
				return propertiesTablePropertyColumnChars;
			}
			set
			{
				if (value > propertiesTablePropertyColumnChars)
				{
					propertiesTablePropertyColumnChars = value;
				}
			}
		}

		public override int PropertiesTableValueColumnChars
		{
			get
			{
				return propertiesTableValueColumnChars;
			}
			set
			{
				if (value > propertiesTableValueColumnChars)
				{
					propertiesTableValueColumnChars = value;
				}
			}
		}

		public IMonitoredModel Model => model;

		protected IArrayXYModel ParameterModel => model.ParameterModel as IArrayXYModel;

		public ArrayXYController(IMonitoredModel xyModel)
			: base(xyModel)
		{
			model = xyModel;
			UpdateUndoInfo(-1, string.Empty, string.Empty);
			try
			{
				displayUnit = model.EngineeringUnits;
			}
			catch (Exception)
			{
			}
			if (displayUnit == null)
			{
				displayUnit = "(null)";
			}
			try
			{
				IArray1DModel xAxis = ParameterModel.XAxis;
				xDisplayUnit = ((xAxis != null) ? xAxis.EngineeringUnits : "(null)");
			}
			catch (Exception)
			{
			}
			if (xDisplayUnit == null)
			{
				xDisplayUnit = "(null)";
			}
			dataTableXAxisColumnChars = xDisplayUnit.Length;
			dataTableValueColumnChars = displayUnit.Length;
			propertiesTablePropertyColumnChars = 8;
			propertiesTableValueColumnChars = 5;
		}

		public override void Undo()
		{
			try
			{
				DataRow dataRow = dataTable.Rows[previousRowIndex];
				string text = dataRow[previousColumnName].ToString();
				dataRow[previousColumnName] = previousValue;
				previousValue = text;
			}
			catch
			{
			}
		}

		public override void Revert()
		{
			model.ParameterModel.Revert();
			UpdateRevertedValues("XAxis", ParameterModel.XAxis.PreviousValues, ParameterModel.XAxis);
			UpdateRevertedValues("Value", (model.ParameterModel as IArrayModel).PreviousValues, model.ParameterModel as IArray1DModel);
			ParameterModel.XAxis.PreviousValues.Clear();
			(model.ParameterModel as IArrayModel).PreviousValues.Clear();
			RaiseAllCellsUnmodifiedEvent();
		}

		public override void Save()
		{
			model.ParameterModel.Save();
			dataTable.AcceptChanges();
			RaiseAllCellsUnmodifiedEvent();
		}

		public override void DataMode(DataFormat displayFormat)
		{
			if (base.DisplayFormat != displayFormat)
			{
				base.DisplayFormat = displayFormat;
				model.ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
				try
				{
					dataTable.Rows.Clear();
					dataTable.ColumnChanging -= OnColumnChanging;
					LoadDataTable();
					dataTable.ColumnChanging += OnColumnChanging;
				}
				catch (Exception)
				{
				}
				if (SecurityLevelHelper.ToolFamily == ToolFamily.FieldEngineering || !(model.DataSource is ICalibrationECM))
				{
					ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.dataVolatile;
				}
			}
		}

		public void Increment(int xIndex, int yIndex)
		{
			try
			{
				isUpDownOperation = true;
				DataRow dataRow = null;
				if (yIndex == 0)
				{
					ParameterModel.XAxis.X = xIndex;
					if (1 != ParameterModel.XAxis.ConfigFileType)
					{
						int rawValue = ParameterModel.XAxis.GetRawValue();
						ParameterModel.XAxis.SetRawValue(rawValue, rawValue + 1, xIndex, base.DisplayFormat);
					}
					else
					{
						ParameterModel.XAxis.ScaledFloat(xIndex, ParameterModel.XAxis.ScaledFloat(xIndex) + ParameterModel.XAxis.MinResolution);
					}
					dataRow = Data.Rows[xIndex];
					UpdateUndoInfo(xIndex, dataRow.Table.Columns[yIndex].ColumnName, dataRow[yIndex].ToString());
					dataRow[yIndex] = ParameterModel.XAxis.ScaledValue;
				}
				else
				{
					ParameterModel.X = xIndex;
					if (1 != model.ParameterModel.ConfigFileType)
					{
						ParameterModel.SetRawValue(ParameterModel.GetRawValue() + 1);
					}
					else
					{
						ParameterModel.ScaledFloat(ParameterModel.ScaledFloat() + ParameterModel.MinResolution);
					}
					dataRow = Data.Rows[xIndex];
					UpdateUndoInfo(xIndex, dataRow.Table.Columns[yIndex].ColumnName, dataRow[yIndex].ToString());
					dataRow[yIndex] = ParameterModel.ScaledValue;
				}
				DataColumnChangeEventArgs e = new DataColumnChangeEventArgs(Data.Rows[xIndex], Data.Columns[yIndex], dataRow[yIndex]);
				RaiseCellChanged(this, e);
				model.ParameterModel.IsDirty = true;
			}
			catch
			{
			}
			isUpDownOperation = false;
		}

		public void Decrement(int xIndex, int yIndex)
		{
			try
			{
				isUpDownOperation = true;
				DataRow dataRow = null;
				if (yIndex == 0)
				{
					ParameterModel.XAxis.X = xIndex;
					if (1 != ParameterModel.XAxis.ConfigFileType)
					{
						int rawValue = ParameterModel.XAxis.GetRawValue();
						ParameterModel.XAxis.SetRawValue(rawValue, rawValue - 1, xIndex, base.DisplayFormat);
					}
					else
					{
						ParameterModel.XAxis.ScaledFloat(xIndex, ParameterModel.XAxis.ScaledFloat(xIndex) - ParameterModel.XAxis.MinResolution);
					}
					dataRow = Data.Rows[xIndex];
					UpdateUndoInfo(xIndex, dataRow.Table.Columns[yIndex].ColumnName, dataRow[yIndex].ToString());
					dataRow[yIndex] = ParameterModel.XAxis.ScaledValue;
				}
				else
				{
					ParameterModel.X = xIndex;
					if (1 != ParameterModel.ConfigFileType)
					{
						ParameterModel.SetRawValue(ParameterModel.GetRawValue() - 1);
					}
					else
					{
						ParameterModel.ScaledFloat(ParameterModel.ScaledFloat() - ParameterModel.MinResolution);
					}
					dataRow = Data.Rows[xIndex];
					UpdateUndoInfo(xIndex, dataRow.Table.Columns[yIndex].ColumnName, dataRow[yIndex].ToString());
					dataRow[yIndex] = ParameterModel.ScaledValue;
				}
				DataColumnChangeEventArgs e = new DataColumnChangeEventArgs(Data.Rows[xIndex], Data.Columns[yIndex], dataRow[yIndex]);
				RaiseCellChanged(this, e);
			}
			catch
			{
			}
			isUpDownOperation = false;
		}

		public void OnAfterPaste(object sender, AfterPasteArgs args)
		{
			if (alteredAscendingOrderSetting)
			{
				EditorUtilities.CheckAscendingOrder = true;
				alteredAscendingOrderSetting = false;
			}
			if (!ParameterModel.CompleteDataPaste(args.ContinueWithPaste))
			{
				try
				{
					ReLoadDataTable();
				}
				catch
				{
				}
			}
		}

		public void OnBeforeDataPaste(object sender, DataPasteEventArgs args)
		{
			ParameterModel.StartDataPaste();
			if (args.RowEndIndex < 0 || args.ColStartIndex != 0 || !EditorUtilities.CheckAscendingOrder)
			{
				return;
			}
			bool cacheEnabled = model.DataSource.CacheEnabled;
			IArray1DModel array1DModel = null;
			model.DataSource.CacheEnabled = false;
			EditorUtilities.CheckAscendingOrder = false;
			alteredAscendingOrderSetting = true;
			try
			{
				array1DModel = (IArray1DModel)model.DataSource.Get(ParameterModel.XAxis.Name);
				array1DModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
				array1DModel.StartDataPaste();
				string[] array = args.ClipBoardData.Split(new char[1] { '\n' });
				int num = 0;
				string[] array2 = new string[0];
				for (int i = args.RowStartIndex; i < args.RowStartIndex + array.Length - 1; i++)
				{
					array2 = array[num].Split(new char[1] { '\t' });
					try
					{
						array1DModel.SetValueByFormat(i, array2[0].TrimEnd(new char[1] { '\r' }), base.DisplayFormat);
					}
					catch
					{
					}
					num++;
				}
				if (!array1DModel.IsAscending())
				{
					string message = "Paste operation is aborted since after paste the values for " + array1DModel.Name + " is not in the ascending order.";
					EventLogger.Warn("Value Edit", message);
					throw new Exception(message);
				}
				ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
			}
			finally
			{
				array1DModel?.Revert();
				model.DataSource.CacheEnabled = cacheEnabled;
			}
		}

		protected override void InitializeDataTable()
		{
			dataTable = new DataTable();
			dataTable.TableName = "DataTable";
			CreateDataColumns();
			LoadDataTable();
		}

		private void InitializePropertiesTable()
		{
			propertiesTable = new DataTable();
			propertiesTable.TableName = "PropertiesTable";
			CreatePropertyColumns(propertiesTable);
			LoadPropertiesTable();
		}

		protected override void CreateDataColumns()
		{
			DataColumn column = MakeDataColumn(XDisplayUnit, "XAxis", Type.GetType("System.String"), isReadOnly: false, isUnique: false);
			dataTable.Columns.Add(column);
			column = MakeDataColumn(DisplayUnit, "Value", Type.GetType("System.String"), isReadOnly: false, isUnique: false);
			dataTable.Columns.Add(column);
			column = MakeDataColumn("", "Index", Type.GetType("System.Int32"), isReadOnly: true, isUnique: true);
			column.ColumnMapping = MappingType.Hidden;
			dataTable.Columns.Add(column);
		}

		private void ReLoadDataTable()
		{
			dataTable.Rows.Clear();
			dataTable.ColumnChanging -= OnColumnChanging;
			LoadDataTable();
			dataTable.ColumnChanging += OnColumnChanging;
		}

		protected override void LoadDataTable()
		{
			if (!model.DataSource.Connected)
			{
				return;
			}
			ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
			try
			{
				IArray1DModel xAxis = ParameterModel.XAxis;
				int num = xAxis?.Count ?? ParameterModel.Count;
				int num2 = 0;
				int num3 = 0;
				int num4 = 0;
				for (int i = 0; i < num; i++)
				{
					DataRow dataRow = dataTable.NewRow();
					if (xAxis == null)
					{
						dataRow["XAxis"] = "?";
					}
					else if (base.DisplayFormat == DataFormat.Hex)
					{
						dataRow["XAxis"] = xAxis.HexValue(i);
					}
					else if (base.DisplayFormat == DataFormat.Binary)
					{
						dataRow["XAxis"] = xAxis.BinaryValue(i);
					}
					else
					{
						dataRow["XAxis"] = xAxis[i];
					}
					num4 = dataRow["XAxis"].ToString().Length;
					if (num3 < num4)
					{
						num3 = num4;
					}
					if (base.DisplayFormat == DataFormat.Hex)
					{
						dataRow["Value"] = ParameterModel.HexValue(i);
					}
					else if (base.DisplayFormat == DataFormat.Binary)
					{
						dataRow["Value"] = ParameterModel.BinaryValue(i);
					}
					else
					{
						dataRow["Value"] = ParameterModel[i];
					}
					num4 = dataRow["Value"].ToString().Length;
					if (num2 < num4)
					{
						num2 = num4;
					}
					dataRow["Index"] = i;
					dataTable.Rows.Add(dataRow);
				}
				DataTableXAxisColumnChars = num3;
				DataTableValueColumnChars = num2;
				dataTable.AcceptChanges();
				isDataTableLoaded = true;
				RaiseDataLoadedEvent();
			}
			finally
			{
				if (SecurityLevelHelper.ToolFamily == ToolFamily.FieldEngineering || !(model.DataSource is ICalibrationECM))
				{
					ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.dataVolatile;
				}
			}
		}

		private void LoadPropertiesTable()
		{
			AddToPropertiesTable("Full Name", ParameterModel.FullName);
			AddToPropertiesTable("Comment", ParameterModel.Comment);
			AddToPropertiesTable("Address", ParameterModel.Address, "X8");
			AddToPropertiesTable("Length", ParameterModel.Length.ToString());
			AddToPropertiesTable("Data Type", (long)ParameterModel.DataType, "N0");
			AddToPropertiesTable("Config Data Type", ParameterModel.ConfigFileType, "N0");
			AddToPropertiesTable("Engineering Unit", ParameterModel.EngineeringUnits);
			AddToPropertiesTable("Minimum Value", ParameterModel.LowerBound.ToString());
			AddToPropertiesTable("Maximum Value", ParameterModel.UpperBound.ToString());
			AddToPropertiesTable("Subfile Number", ParameterModel.SubfileNumber, "N0");
			DataRow dataRow = propertiesTable.NewRow();
			dataRow["Property"] = "Available Offline";
			PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
			dataRow["Value"] = (ParameterModel.AvailableOffline ? "Yes" : "No");
			PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
			propertiesTable.Rows.Add(dataRow);
			IArray1DModel xAxis = ParameterModel.XAxis;
			if (xAxis != null)
			{
				AddToPropertiesTable("X-AXIS", xAxis.Name);
				AddToPropertiesTable("Full Name", xAxis.FullName);
				AddToPropertiesTable("Comment", xAxis.Comment);
				AddToPropertiesTable("Data Type", (long)xAxis.DataType, "N0");
				AddToPropertiesTable("Config Data Type", xAxis.ConfigFileType, "N0");
				AddToPropertiesTable("Engineering Unit", xAxis.EngineeringUnits);
				AddToPropertiesTable("Number of Elements", xAxis.Count, "N0");
				AddToPropertiesTable("Subfile Number", xAxis.SubfileNumber, "N0");
				dataRow = propertiesTable.NewRow();
				dataRow["Property"] = "Available Offline";
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = (xAxis.AvailableOffline ? "Yes" : "No");
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
		}

		private void AddToPropertiesTable(string propertyName, string propertyValue)
		{
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = propertyName;
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = propertyValue;
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
		}

		private void AddToPropertiesTable(string propertyName, long propertyValue, string format)
		{
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = propertyName;
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = propertyValue.ToString(format);
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
		}

		private void UpdateUndoInfo(int rowIndex, string columnName, string valueBeforeEdit)
		{
			previousColumnName = columnName;
			previousRowIndex = rowIndex;
			previousValue = valueBeforeEdit;
		}

		protected override void OnColumnChanging(object sender, DataColumnChangeEventArgs e)
		{
			if (e.ProposedValue.ToString().Length == 0)
			{
				throw new ArgumentException();
			}
			int num = (int)e.Row["Index"];
			string actualValueSet = string.Empty;
			try
			{
				bool flag = false;
				string text = null;
				if (!isUpDownOperation)
				{
					if (e.Column.ColumnName == "XAxis")
					{
						text = ParameterModel.XAxis.GetValueByDataFormat(num, base.DisplayFormat);
						flag = ParameterModel.XAxis.SetValueAtIndex(num, e.ProposedValue.ToString(), base.DisplayFormat, out actualValueSet);
						DisplayBoundMessage(e.ProposedValue.ToString(), actualValueSet, ParameterModel.XAxis.LowerBound, ParameterModel.XAxis.UpperBound, ParameterModel.XAxis.Name);
						e.ProposedValue = actualValueSet;
					}
					else if (e.Column.ColumnName == "Value")
					{
						text = ParameterModel.GetValueByDataFormat(num, base.DisplayFormat);
						ParameterModel.SetValueByFormat(num, e.ProposedValue.ToString(), base.DisplayFormat);
						actualValueSet = ParameterModel.GetValueByDataFormat(num, base.DisplayFormat);
						DisplayBoundMessage(e.ProposedValue.ToString(), actualValueSet, ParameterModel.LowerBound, ParameterModel.UpperBound, model.Name);
						e.ProposedValue = actualValueSet;
						flag = text != e.ProposedValue.ToString();
					}
				}
				if (flag)
				{
					UpdateUndoInfo(num, e.Column.ColumnName, text);
					RaiseCellChanged(sender, e);
					ParameterModel.IsDirty = true;
				}
			}
			catch (Exception ex)
			{
				EventLogger.Error("Value Edit", ex.Message, ex.InnerException);
				e.Row.CancelEdit();
				throw ex;
			}
		}
	}
}
namespace Cummins.Editor
{
	public class MonitoredArrayXYController : ArrayXYController
	{
		private int xCount;

		private int yCount;

		private IAddressValue currentSourceAddress;

		private new MonitoredArrayXYModel model;

		private IArrayAxis valueConverter;

		public bool ShowComments
		{
			get
			{
				return model.ShowComments;
			}
			set
			{
				if (model.ShowComments != value)
				{
					model.ShowComments = value;
				}
			}
		}

		public bool ValueEnabled
		{
			get
			{
				return model.ValueEnabled;
			}
			set
			{
				model.ValueEnabled = value;
			}
		}

		public DataFormat Radix
		{
			get
			{
				return model.Radix;
			}
			set
			{
				if (base.DisplayFormat != value)
				{
					model.Radix = value;
					DataMode(value);
				}
			}
		}

		public IAddressValue CurrentSourceAddress
		{
			get
			{
				return currentSourceAddress;
			}
			set
			{
				currentSourceAddress = value;
			}
		}

		public MonitoredArrayXYController(MonitoredArrayXYModel model)
			: base(model)
		{
			this.model = model;
			Initialize();
			this.model.DataSource.SaveChangesEvent += OnSaveChangesEvent;
		}

		public void Refresh(DataRefreshEventArgs e)
		{
			if (e != null)
			{
				switch (e.DataSourceType)
				{
				case DataSourceTypeEnum.ECM:
					Refresh(e as ECMDataRefreshEventArgs);
					break;
				case DataSourceTypeEnum.Disk:
					Refresh(e as DiskDataRefreshEventArgs);
					break;
				case DataSourceTypeEnum.ASAM:
					break;
				}
			}
		}

		public override void Reload()
		{
			base.Reload();
			Initialize();
		}

		private void Refresh(ECMDataRefreshEventArgs e)
		{
			try
			{
				if (e.IsProcessed)
				{
					return;
				}
				ArrayList eCMData = e.ECMData;
				base.EnableChangeEvents = false;
				for (int i = 0; i < eCMData.Count; i++)
				{
					ICIDataElementNotification iCIDataElementNotification = (ICIDataElementNotification)eCMData[i];
					if (iCIDataElementNotification.Status != tagCIDMStatusEnum.DM_STATUS_OK || !iCIDataElementNotification.Changed)
					{
						continue;
					}
					CICPPMonitor cICPPMonitor = (CICPPMonitor)iCIDataElementNotification.DataElementMonitor;
					if (cICPPMonitor.location.ToString() == base.ParameterModel.XAxis.FullName)
					{
						if ((valueConverter.XAxis.CalEntity as ICICalAddressableEntity).size != (iCIDataElementNotification.RawData as byte[]).Length)
						{
							string message = string.Format(Editor.ResourceManager.GetString(EditorMessageIDs.DataSizeMismatch.ToString()), (iCIDataElementNotification.RawData as byte[]).Length, (valueConverter.XAxis.CalEntity as ICICalAddressableEntity).size);
							throw new DataSizeMismatchException(Facility.Editor, 17, message, "Source Addr", (iCIDataElementNotification.RawData as byte[]).Length, (valueConverter.XAxis.CalEntity as ICICalAddressableEntity).size);
						}
						(valueConverter.XAxis.CalEntity as ICICalAddressableEntity).RawData = iCIDataElementNotification.RawData;
						Refresh("XAxis", xCount, valueConverter.XAxis);
					}
					else
					{
						if (((valueConverter as IEntityModel).CalEntity as ICICalAddressableEntity).size != (iCIDataElementNotification.RawData as byte[]).Length)
						{
							string message2 = string.Format(Editor.ResourceManager.GetString(EditorMessageIDs.DataSizeMismatch.ToString()), (iCIDataElementNotification.RawData as byte[]).Length, ((valueConverter as IEntityModel).CalEntity as ICICalAddressableEntity).size);
							throw new DataSizeMismatchException(Facility.Editor, 17, message2, "Source Addr", (iCIDataElementNotification.RawData as byte[]).Length, ((valueConverter as IEntityModel).CalEntity as ICICalAddressableEntity).size);
						}
						((valueConverter as IEntityModel).CalEntity as ICICalAddressableEntity).RawData = iCIDataElementNotification.RawData;
						Refresh("Value", yCount, valueConverter as IArray1DModel);
					}
				}
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
		}

		private void Refresh(DiskDataRefreshEventArgs e)
		{
			SortedList diskData = e.DiskData;
			try
			{
				base.EnableChangeEvents = false;
				for (int i = 0; i < diskData.Count; i++)
				{
					IParameterModel parameterModel = (IParameterModel)diskData.GetByIndex(i);
					if (parameterModel.FullName.ToString() == base.ParameterModel.XAxis.FullName)
					{
						Refresh("XAxis", xCount, parameterModel as IArray1DModel);
					}
					else
					{
						Refresh("Value", yCount, parameterModel as IArray1DModel);
					}
				}
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
		}

		private void Initialize()
		{
			if (valueConverter == null && base.Model.DataSource.Connected)
			{
				lock (model.DataSource)
				{
					bool cacheEnabled = model.DataSource.CacheEnabled;
					model.DataSource.CacheEnabled = false;
					valueConverter = (IArrayAxis)model.DataSource.Get(base.ParameterModel.FullName);
					model.DataSource.CacheEnabled = cacheEnabled;
				}
				(valueConverter as IParameterModel).CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
				xCount = valueConverter.XAxis.Count;
				yCount = (valueConverter as IArrayModel).Count;
			}
		}

		public virtual void SaveSession(NewDataSet.ScreenRow screenRow)
		{
			ScreenDataSaver screenDataSaver = new ScreenDataSaver();
			NewDataSet.GroupRow groupRow = screenDataSaver.SaveSession(screenRow);
			model.SaveSession(groupRow);
			((NewDataSet)screenRow.Table.DataSet).Group.AddGroupRow(groupRow);
			screenDataSaver.PopulateParameterTableRows(groupRow, MetaDataTable);
			base.ParameterModel.IsDirty = false;
		}

		public virtual void CleanupResources()
		{
			model.DataSource.SaveChangesEvent -= OnSaveChangesEvent;
			Data.Clear();
		}

		private void OnSaveChangesEvent(object sender, EventArgs e)
		{
			Data.AcceptChanges();
			base.ParameterModel.XAxis.UpdateRevertValue();
			base.ParameterModel.UpdateRevertValue();
			RaiseAllCellsUnmodifiedEvent();
		}
	}
	public class MonitoredArrayXYModel : MonitoredModel
	{
		private bool isChanged = true;

		private bool showComments = true;

		private DataFormat radix;

		private bool valueEnabled = true;

		public bool ShowComments
		{
			get
			{
				return showComments;
			}
			set
			{
				showComments = value;
				RaiseChangeShowCommentsEvent(showComments);
			}
		}

		public bool ValueEnabled
		{
			get
			{
				return valueEnabled;
			}
			set
			{
				valueEnabled = value;
				RaiseChangeValueEnabledEvent(value);
			}
		}

		public bool IsChanged
		{
			get
			{
				return isChanged;
			}
			set
			{
				isChanged = value;
			}
		}

		public DataFormat Radix
		{
			get
			{
				return radix;
			}
			set
			{
				radix = value;
			}
		}

		public event EventHandler ChangeShowCommentsState;

		public event StateChangedEventHandler ChangeValueEnabled;

		public MonitoredArrayXYModel(IParameterModel parameterModel)
			: base(parameterModel.DataSource)
		{
			base.DataType = ParameterType.ArrayXY;
		}

		public void Restore(NewDataSet.GroupRow groupRow)
		{
			try
			{
				Name = groupRow.Name;
				Comment = groupRow.Comment;
			}
			catch
			{
			}
		}

		public void SaveSession(NewDataSet.GroupRow groupRow)
		{
			groupRow.Name = Name;
			groupRow.Comment = Comment;
		}

		public void RaiseChangeValueEnabledEvent(bool enable)
		{
			if (this.ChangeValueEnabled != null)
			{
				this.ChangeValueEnabled(this, new BooleanStateEventArgs(enable));
			}
		}

		public void RaiseChangeShowCommentsEvent(bool show)
		{
			if (this.ChangeShowCommentsState != null)
			{
				this.ChangeShowCommentsState(this, EventArgs.Empty);
			}
		}
	}
}
namespace Cummins.Parameter
{
	public class ArrayXYDataView : ParameterView
	{
		private ArrayXYController controller;

		private TextBox textBoxName;

		private ComboBox comboBoxUnitSelection;

		private TextBox textBoxComment;

		private TextBox textBoxXName;

		private ComboBox comboBoxXUnit;

		private CustomDataGrid dataGrid;

		private Panel panel;

		private Container components;

		private ContextMenu csmMenu;

		private int rowClicked;

		private ColoredTextBoxColumn valueColumn;

		private ColoredTextBoxColumn xAxisColumn;

		private CurrencyManager tableCurrency;

		public override Panel Panel => panel;

		protected CustomDataGrid Grid => dataGrid;

		protected CurrencyManager TableCurrency
		{
			get
			{
				//IL_0024: Unknown result type (might be due to invalid IL or missing references)
				//IL_002e: Expected O, but got Unknown
				if (tableCurrency == null)
				{
					tableCurrency = (CurrencyManager)((Control)dataGrid).BindingContext[(object)controller.Data];
				}
				return tableCurrency;
			}
		}

		protected ColoredTextBoxColumn ValueColumn
		{
			get
			{
				if (valueColumn == null)
				{
					valueColumn = new ColoredTextBoxColumn((DataGrid)(object)dataGrid, ((BindingManagerBase)TableCurrency).GetItemProperties()["Value"]);
					((DataGridColumnStyle)valueColumn).NullText = "";
				}
				return valueColumn;
			}
		}

		protected ColoredTextBoxColumn XAxisColumn
		{
			get
			{
				if (xAxisColumn == null)
				{
					xAxisColumn = new ColoredTextBoxColumn((DataGrid)(object)dataGrid, ((BindingManagerBase)TableCurrency).GetItemProperties()["XAxis"]);
					((DataGridColumnStyle)xAxisColumn).NullText = "";
				}
				return xAxisColumn;
			}
		}

		public ArrayXYDataView()
		{
			InitializeComponent();
		}

		public ArrayXYDataView(ArrayXYController xyController, Font font)
			: base(font)
		{
			//IL_001c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0026: Expected O, but got Unknown
			//IL_0043: Unknown result type (might be due to invalid IL or missing references)
			//IL_004d: Expected O, but got Unknown
			//IL_006b: Unknown result type (might be due to invalid IL or missing references)
			//IL_0075: Expected O, but got Unknown
			//IL_0093: Unknown result type (might be due to invalid IL or missing references)
			//IL_009d: Expected O, but got Unknown
			//IL_00bc: Unknown result type (might be due to invalid IL or missing references)
			//IL_00c6: Expected O, but got Unknown
			//IL_029c: Unknown result type (might be due to invalid IL or missing references)
			//IL_02a6: Expected O, but got Unknown
			controller = xyController;
			rowClicked = -1;
			InitializeComponent();
			csmMenu = new ContextMenu();
			((Menu)csmMenu).MenuItems.Add(0, new MenuItem("Copy", (EventHandler)Copy_Click));
			((Menu)csmMenu).MenuItems.Add(1, new MenuItem("Paste", (EventHandler)Paste_Click));
			((Menu)csmMenu).MenuItems.Add(2, new MenuItem("Undo", (EventHandler)Undo_Click));
			((Menu)csmMenu).MenuItems.Add(3, new MenuItem("Properties", (EventHandler)Properties_Click));
			((Control)dataGrid).ContextMenu = csmMenu;
			dataGrid.BeforeDataPasteEvent += controller.OnBeforeDataPaste;
			dataGrid.AfterDataPasteEvent += controller.OnAfterPaste;
			((DataGrid)dataGrid).AllowSorting = false;
			((DataGrid)dataGrid).CaptionText = controller.Name;
			((Control)textBoxName).Text = controller.Name;
			((Control)textBoxComment).Text = controller.Comment;
			if (controller.DisplayUnit.Length > 0)
			{
				comboBoxUnitSelection.Items.Add((object)controller.DisplayUnit);
				((Control)comboBoxUnitSelection).Text = controller.DisplayUnit;
			}
			else
			{
				comboBoxUnitSelection.Items.Add((object)"(null)");
				((Control)comboBoxUnitSelection).Text = "(null)";
			}
			((Control)textBoxXName).Text = controller.XName;
			if (controller.XDisplayUnit.Length > 0)
			{
				comboBoxXUnit.Items.Add((object)controller.XDisplayUnit);
				((Control)comboBoxXUnit).Text = controller.XDisplayUnit;
			}
			else
			{
				comboBoxXUnit.Items.Add((object)"(null)");
				((Control)comboBoxXUnit).Text = "(null)";
			}
			InitializeView();
			controller.DataLoadedEvent += OnDataLoadedEvent;
			((DataGrid)dataGrid).AllowSorting = false;
			controller.CellChangedEvent += OnCellChanged;
			((Control)dataGrid).MouseDown += new MouseEventHandler(OnMouseDown);
			controller.AllCellsUnmodifiedEvent += OnAllCellsUnmodified;
		}

		protected override void InitializeView()
		{
			//IL_0052: Unknown result type (might be due to invalid IL or missing references)
			//IL_0058: Expected O, but got Unknown
			DataTable data = controller.Data;
			if (controller.DataTableLoaded)
			{
				((DataGrid)dataGrid).DataSource = data;
				((DataGrid)dataGrid).AllowSorting = false;
				CurrencyManager val = (CurrencyManager)((Control)this).BindingContext[((DataGrid)dataGrid).DataSource, ((DataGrid)dataGrid).DataMember];
				((DataView)val.List).AllowNew = false;
				((DataView)val.List).AllowDelete = false;
				SetColumnStyles();
			}
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		public override void SetDisplayMode(DataFormat dataFormat)
		{
			base.DataViewFormat = dataFormat;
			if (base.DataViewFormat != DataFormat.Decimal)
			{
				((Control)comboBoxUnitSelection).Enabled = false;
				((Control)comboBoxXUnit).Enabled = false;
			}
			else
			{
				((Control)comboBoxUnitSelection).Enabled = true;
				((Control)comboBoxXUnit).Enabled = true;
			}
			SetColumnStyles();
		}

		protected void Copy_Click(object sender, EventArgs e)
		{
			try
			{
				dataGrid.Copy();
			}
			catch
			{
			}
		}

		protected void Paste_Click(object sender, EventArgs e)
		{
			try
			{
				dataGrid.Paste();
			}
			catch
			{
			}
		}

		protected void Undo_Click(object sender, EventArgs e)
		{
			int currentRowIndex = 0;
			if (rowClicked != -1)
			{
				currentRowIndex = rowClicked;
			}
			controller.Undo();
			((DataGrid)dataGrid).CurrentRowIndex = currentRowIndex;
		}

		protected override void Properties_Click(object sender, EventArgs e)
		{
			base.Properties_Click(this, e);
		}

		private void SetColumnStyles()
		{
			//IL_001c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0022: Expected O, but got Unknown
			((DataGrid)dataGrid).TableStyles.Clear();
			DataTable data = controller.Data;
			DataGridTableStyle val = new DataGridTableStyle();
			val.MappingName = data.TableName;
			val.AllowSorting = false;
			xAxisColumn = null;
			valueColumn = null;
			SetColumnStyle((DataGridTextBoxColumn)(object)XAxisColumn, data.Columns["XAxis"].Caption, "XAxis", GetColumnWidth(controller.DataTableXAxisColumnChars), data.Columns["XAxis"].ReadOnly);
			val.GridColumnStyles.Add((DataGridColumnStyle)(object)XAxisColumn);
			((Control)((DataGridTextBoxColumn)XAxisColumn).TextBox).ContextMenu = csmMenu;
			SetColumnStyle((DataGridTextBoxColumn)(object)ValueColumn, data.Columns["Value"].Caption, "Value", GetColumnWidth(controller.DataTableValueColumnChars), data.Columns["Value"].ReadOnly);
			val.GridColumnStyles.Add((DataGridColumnStyle)(object)ValueColumn);
			((Control)((DataGridTextBoxColumn)ValueColumn).TextBox).ContextMenu = csmMenu;
			((DataGrid)dataGrid).TableStyles.Add(val);
			((Control)textBoxName).Width = GetColumnWidth(((Control)textBoxName).Text);
			Point location = ((Control)textBoxName).Location;
			location.X += (int)((double)((Control)textBoxName).Width + 2.0 * base.AverageCharacterWidth);
			((Control)comboBoxUnitSelection).Location = location;
			((Control)comboBoxUnitSelection).Width = GetColumnWidth(((Control)comboBoxUnitSelection).Text) + (int)(2.0 * base.AverageCharacterWidth);
			((Control)textBoxComment).Width = GetColumnWidth(((Control)textBoxComment).Text);
			((Control)textBoxXName).Width = GetColumnWidth(((Control)textBoxXName).Text);
			((Control)textBoxName).ContextMenu = csmMenu;
			location = ((Control)textBoxXName).Location;
			location.X += (int)((double)((Control)textBoxXName).Width + 2.0 * base.AverageCharacterWidth);
			((Control)comboBoxXUnit).Location = location;
			((Control)comboBoxXUnit).Width = GetColumnWidth(((Control)comboBoxXUnit).Text) + (int)(2.0 * base.AverageCharacterWidth);
		}

		private void OnCellChanged(object sender, DataColumnChangeEventArgs e)
		{
			ColoredTextBoxColumn coloredTextBoxColumn = (ColoredTextBoxColumn)(object)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles[e.Column.ColumnName];
			AddModifiedParameter(controller.Name);
			int num = (int)e.Row["Index"];
			coloredTextBoxColumn.ShowCellModified(num);
			if (num == ((DataGrid)dataGrid).CurrentRowIndex)
			{
				((Control)((DataGridTextBoxColumn)coloredTextBoxColumn).TextBox).Text = e.ProposedValue.ToString();
			}
		}

		private void OnMouseDown(object sender, MouseEventArgs e)
		{
			//IL_0008: Unknown result type (might be due to invalid IL or missing references)
			//IL_0012: Invalid comparison between Unknown and I4
			//IL_0035: Unknown result type (might be due to invalid IL or missing references)
			//IL_003b: Invalid comparison between Unknown and I4
			//IL_003e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0044: Invalid comparison between Unknown and I4
			rowClicked = -1;
			if ((int)e.Button == 2097152)
			{
				Point point = new Point(e.X, e.Y);
				HitTestInfo val = ((DataGrid)dataGrid).HitTest(point);
				if ((int)val.Type == 4 || (int)val.Type == 1)
				{
					rowClicked = val.Row;
				}
			}
		}

		private void OnAllCellsUnmodified(object sender, EventArgs e)
		{
			if (((DataGrid)dataGrid).TableStyles["DataTable"] != null)
			{
				ColoredTextBoxColumn coloredTextBoxColumn = (ColoredTextBoxColumn)(object)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles["XAxis"];
				coloredTextBoxColumn.ShowAllCellsUnmodified();
				coloredTextBoxColumn = (ColoredTextBoxColumn)(object)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles["Value"];
				coloredTextBoxColumn.ShowAllCellsUnmodified();
			}
		}

		private void OnScrolling(object sender, EventArgs e)
		{
			((Control)dataGrid).Invalidate();
		}

		private void InitializeComponent()
		{
			//IL_0007: Unknown result type (might be due to invalid IL or missing references)
			//IL_0011: Expected O, but got Unknown
			//IL_0012: Unknown result type (might be due to invalid IL or missing references)
			//IL_001c: Expected O, but got Unknown
			//IL_001d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0027: Expected O, but got Unknown
			//IL_0033: Unknown result type (might be due to invalid IL or missing references)
			//IL_003d: Expected O, but got Unknown
			//IL_003e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0048: Expected O, but got Unknown
			//IL_0049: Unknown result type (might be due to invalid IL or missing references)
			//IL_0053: Expected O, but got Unknown
			RangeSelection rangeSelection = new RangeSelection();
			panel = new Panel();
			comboBoxXUnit = new ComboBox();
			textBoxXName = new TextBox();
			dataGrid = new CustomDataGrid();
			textBoxComment = new TextBox();
			comboBoxUnitSelection = new ComboBox();
			textBoxName = new TextBox();
			((Control)panel).SuspendLayout();
			((ISupportInitialize)dataGrid).BeginInit();
			((Control)this).SuspendLayout();
			((Control)panel).Controls.Add((Control)(object)comboBoxXUnit);
			((Control)panel).Controls.Add((Control)(object)textBoxXName);
			((Control)panel).Controls.Add((Control)(object)dataGrid);
			((Control)panel).Controls.Add((Control)(object)textBoxComment);
			((Control)panel).Controls.Add((Control)(object)comboBoxUnitSelection);
			((Control)panel).Controls.Add((Control)(object)textBoxName);
			((Control)panel).Dock = (DockStyle)5;
			((Control)panel).Location = new Point(0, 0);
			((Control)panel).Name = "panel";
			((Control)panel).Size = new Size(528, 328);
			((Control)panel).TabIndex = 0;
			comboBoxXUnit.DropDownStyle = (ComboBoxStyle)2;
			((Control)comboBoxXUnit).Location = new Point(112, 80);
			((Control)comboBoxXUnit).Name = "comboBoxXUnit";
			((Control)comboBoxXUnit).Size = new Size(112, 21);
			((Control)comboBoxXUnit).TabIndex = 5;
			((Control)comboBoxXUnit).Visible = false;
			((Control)textBoxXName).Location = new Point(8, 80);
			((Control)textBoxXName).Name = "textBoxXName";
			((TextBoxBase)textBoxXName).ReadOnly = true;
			((Control)textBoxXName).Size = new Size(100, 20);
			((Control)textBoxXName).TabIndex = 4;
			((Control)textBoxXName).Text = "X Name";
			((Control)textBoxXName).Visible = false;
			dataGrid.AddRowWhilePaste = false;
			((Control)dataGrid).Anchor = (AnchorStyles)15;
			((DataGrid)dataGrid).DataMember = "";
			((DataGrid)dataGrid).HeaderForeColor = SystemColors.ControlText;
			((Control)dataGrid).Location = new Point(8, 3);
			((Control)dataGrid).Name = "dataGrid";
			rangeSelection.Bottom = -1;
			rangeSelection.Left = -1;
			rangeSelection.Right = -1;
			rangeSelection.Top = -1;
			dataGrid.SelectedRange = rangeSelection;
			((Control)dataGrid).Size = new Size(512, 317);
			((Control)dataGrid).TabIndex = 3;
			((DataGrid)dataGrid).Scroll += OnScrolling;
			((Control)textBoxComment).Location = new Point(8, 44);
			((Control)textBoxComment).Name = "textBoxComment";
			((TextBoxBase)textBoxComment).ReadOnly = true;
			((Control)textBoxComment).Size = new Size(472, 20);
			((Control)textBoxComment).TabIndex = 2;
			((Control)textBoxComment).Text = "Comment";
			((Control)textBoxComment).Visible = false;
			comboBoxUnitSelection.DropDownStyle = (ComboBoxStyle)2;
			((Control)comboBoxUnitSelection).Location = new Point(144, 8);
			((Control)comboBoxUnitSelection).Name = "comboBoxUnitSelection";
			((Control)comboBoxUnitSelection).Size = new Size(121, 21);
			((Control)comboBoxUnitSelection).TabIndex = 1;
			((Control)comboBoxUnitSelection).Visible = false;
			((Control)textBoxName).Location = new Point(8, 8);
			((Control)textBoxName).Name = "textBoxName";
			((TextBoxBase)textBoxName).ReadOnly = true;
			((Control)textBoxName).Size = new Size(128, 20);
			((Control)textBoxName).TabIndex = 0;
			((Control)textBoxName).Text = "Name";
			((Control)textBoxName).Visible = false;
			((Control)this).Controls.Add((Control)(object)panel);
			((Control)this).Name = "ArrayXYDataView";
			((Control)this).Size = new Size(528, 328);
			((Control)panel).ResumeLayout(false);
			((Control)panel).PerformLayout();
			((ISupportInitialize)dataGrid).EndInit();
			((Control)this).ResumeLayout(false);
		}

		protected override bool ProcessCmdKey(ref Message m, Keys keyData)
		{
			//IL_000f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0010: Unknown result type (might be due to invalid IL or missing references)
			//IL_0016: Unknown result type (might be due to invalid IL or missing references)
			//IL_001c: Invalid comparison between Unknown and I4
			//IL_00be: Unknown result type (might be due to invalid IL or missing references)
			//IL_00c4: Unknown result type (might be due to invalid IL or missing references)
			//IL_00ca: Invalid comparison between Unknown and I4
			//IL_0021: Unknown result type (might be due to invalid IL or missing references)
			//IL_0024: Invalid comparison between Unknown and I4
			//IL_00cc: Unknown result type (might be due to invalid IL or missing references)
			//IL_00cf: Invalid comparison between Unknown and I4
			//IL_0062: Unknown result type (might be due to invalid IL or missing references)
			//IL_0067: Unknown result type (might be due to invalid IL or missing references)
			//IL_0077: Unknown result type (might be due to invalid IL or missing references)
			//IL_007c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0086: Unknown result type (might be due to invalid IL or missing references)
			//IL_0089: Invalid comparison between Unknown and I4
			//IL_0026: Unknown result type (might be due to invalid IL or missing references)
			//IL_0029: Invalid comparison between Unknown and I4
			//IL_00f1: Unknown result type (might be due to invalid IL or missing references)
			//IL_00af: Unknown result type (might be due to invalid IL or missing references)
			try
			{
				Keys val = (Keys)((Message)(ref m)).WParam.ToInt32();
				if ((keyData & 0x40000) == 262144 && ((int)val == 38 || (int)val == 40))
				{
					BindingManagerBase val2 = ((Control)this).BindingContext[((DataGrid)dataGrid).DataSource, ((DataGrid)dataGrid).DataMember];
					_ = (DataRowView)val2.Current;
					DataGridCell currentCell = ((DataGrid)dataGrid).CurrentCell;
					int columnNumber = ((DataGridCell)(ref currentCell)).ColumnNumber;
					DataGridCell currentCell2 = ((DataGrid)dataGrid).CurrentCell;
					int rowNumber = ((DataGridCell)(ref currentCell2)).RowNumber;
					if ((int)val == 38)
					{
						controller.Increment(rowNumber, columnNumber);
					}
					else
					{
						controller.Decrement(rowNumber, columnNumber);
					}
					((DataGrid)dataGrid).CurrentCell = new DataGridCell(rowNumber, columnNumber);
					return true;
				}
				if ((keyData & 0x20000) == 131072 && (int)val == 73)
				{
					Properties_Click(this, null);
					return true;
				}
			}
			catch (Exception innerException)
			{
				throw new Exception("dsfds", innerException);
			}
			return ((ContainerControl)this).ProcessCmdKey(ref m, keyData);
		}
	}
}
namespace Cummins.Editor
{
	public class MonitoredArrayXYView : ArrayXYDataView
	{
		private MonitoredArrayXYController controller;

		public event KeyEventHandler GridKeyDown
		{
			add
			{
				base.Grid.GridKeyDown += value;
			}
			remove
			{
				base.Grid.GridKeyDown -= value;
			}
		}

		protected MonitoredArrayXYView()
		{
		}

		public MonitoredArrayXYView(MonitoredArrayXYController controller, Font font)
			: base(controller, font)
		{
			this.controller = controller;
		}
	}
	public class MonitoredArrayXYZ : Cummins.Parameter.Parameter, IMonitorElement, IDisposable
	{
		private bool disposed;

		private ArrayList iDLParametersList;

		public bool ShowComments
		{
			get
			{
				return ((MonitoredArrayXYZController)base.Controller).ShowComments;
			}
			set
			{
				((MonitoredArrayXYZController)base.Controller).ShowComments = value;
			}
		}

		public bool ValueEnabled
		{
			set
			{
				((MonitoredArrayXYZController)base.Controller).ValueEnabled = value;
			}
		}

		public bool IsDirty => ((MonitoredArrayXYZModel)base.ParameterModel).IsChanged;

		public DataFormat Radix
		{
			set
			{
				((MonitoredArrayXYZController)base.Controller).Radix = value;
			}
		}

		public IAddressValue CurrentSourceAddress
		{
			get
			{
				return ((MonitoredArrayXYZController)base.Controller).CurrentSourceAddress;
			}
			set
			{
				((MonitoredArrayXYZController)base.Controller).CurrentSourceAddress = value;
			}
		}

		public ArrayList IDLParametersList
		{
			get
			{
				if (iDLParametersList == null)
				{
					iDLParametersList = new ArrayList();
					LogParameters logParameters = new LogParameters
					{
						parameterName = base.ParameterModel.Name,
						sourceAddess = base.ParameterModel.DataSource.SourceAddress
					};
					iDLParametersList.Add(logParameters);
				}
				return iDLParametersList;
			}
		}

		public event KeyEventHandler GridKeyDown
		{
			add
			{
				((MonitoredArrayXYZView)base.DataView).GridKeyDown += value;
			}
			remove
			{
				((MonitoredArrayXYZView)base.DataView).GridKeyDown -= value;
			}
		}

		public MonitoredArrayXYZ(IParameterModel parameterModel)
		{
			base.Model = new MonitoredArrayXYZModel(parameterModel);
			base.ParameterModel = parameterModel;
			base.ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
			base.Controller = new MonitoredArrayXYZController((MonitoredArrayXYZModel)base.Model);
			base.DataView = new MonitoredArrayXYZView((MonitoredArrayXYZController)base.Controller, base.Font);
			if (SecurityLevelHelper.ToolFamily == ToolFamily.FieldEngineering || !(base.ParameterModel.DataSource is ICalibrationECM))
			{
				base.ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.dataVolatile;
			}
			disposed = false;
		}

		public void Refresh(DataRefreshEventArgs e, bool forceUpdate)
		{
			((MonitoredArrayXYZController)base.Controller).Refresh(e);
		}

		public void SaveSession(NewDataSet.ScreenRow screenRow)
		{
			((MonitoredArrayXYZController)base.Controller).SaveSession(screenRow);
		}

		public void Dispose()
		{
			Dispose(disposing: true);
			GC.SuppressFinalize(this);
		}

		protected virtual void Dispose(bool disposing)
		{
			if (!disposed && disposing)
			{
				CleaupResources();
			}
			disposed = true;
		}

		public void CleaupResources()
		{
			((Component)(object)base.DataView).Dispose();
			((MonitoredArrayXYZController)base.Controller).CleanupResources();
		}
	}
}
namespace Cummins.Parameter
{
	public class ArrayXYZController : ArrayController
	{
		private new IMonitoredModel model;

		private string displayUnit = string.Empty;

		private string xDisplayUnit = string.Empty;

		private string yDisplayUnit = string.Empty;

		private EditKind previousEditKind;

		private int dataTableValueColumnChars;

		private int propertiesTablePropertyColumnChars;

		private int propertiesTableValueColumnChars;

		private int previousColumnIndex;

		private int previousRowIndex;

		internal string previousValue;

		private new bool enableChangeEvents = true;

		public override DataTable Properties
		{
			get
			{
				if (propertiesTable == null)
				{
					InitializePropertiesTable();
				}
				return propertiesTable;
			}
		}

		public string DisplayUnit
		{
			get
			{
				return displayUnit;
			}
			set
			{
				if (value.Length > 0)
				{
					displayUnit = value;
				}
			}
		}

		public string XDisplayUnit
		{
			get
			{
				return xDisplayUnit;
			}
			set
			{
				if (value.Length > 0)
				{
					xDisplayUnit = value;
				}
			}
		}

		public string YDisplayUnit
		{
			get
			{
				return yDisplayUnit;
			}
			set
			{
				if (value.Length > 0)
				{
					yDisplayUnit = value;
				}
			}
		}

		public string XName
		{
			get
			{
				IArray1DModel xAxis = ParameterModel.XAxis;
				if (xAxis == null)
				{
					return "[missing]";
				}
				return xAxis.Name;
			}
		}

		public string YName
		{
			get
			{
				IArray1DModel yAxis = ParameterModel.YAxis;
				if (yAxis == null)
				{
					return "[missing]";
				}
				return yAxis.Name;
			}
		}

		public int YCount => ParameterModel.YAxis?.Count ?? 0;

		public int DataTableValueColumnChars
		{
			get
			{
				return dataTableValueColumnChars;
			}
			set
			{
				dataTableValueColumnChars = value;
			}
		}

		public override int PropertiesTablePropertyColumnChars
		{
			get
			{
				return propertiesTablePropertyColumnChars;
			}
			set
			{
				if (value > propertiesTablePropertyColumnChars)
				{
					propertiesTablePropertyColumnChars = value;
				}
			}
		}

		public override int PropertiesTableValueColumnChars
		{
			get
			{
				return propertiesTableValueColumnChars;
			}
			set
			{
				if (value > propertiesTableValueColumnChars)
				{
					propertiesTableValueColumnChars = value;
				}
			}
		}

		public IMonitoredModel Model => model;

		public IArrayXYZModel ParameterModel => model.ParameterModel as IArrayXYZModel;

		public new bool EnableChangeEvents
		{
			get
			{
				return enableChangeEvents;
			}
			set
			{
				if (enableChangeEvents != value)
				{
					enableChangeEvents = value;
					if (value)
					{
						Data.ColumnChanging += OnColumnChanging;
					}
					else
					{
						Data.ColumnChanging -= OnColumnChanging;
					}
				}
			}
		}

		public event EventHandler DataChangedEvent;

		public event AxisValueChangeEventHandler UndoEvent;

		public event AxisValueChangeEventHandler AxisValueChangeEvent;

		public event AxisValueChangeEventHandler ChangeAxisValueEvent;

		public ArrayXYZController(IMonitoredModel xyzModel)
			: base(xyzModel)
		{
			model = xyzModel;
			UpdateUndoInfo(EditKind.ZAxisEdit, string.Empty, -1, -1);
			try
			{
				displayUnit = model.EngineeringUnits;
			}
			catch (Exception)
			{
			}
			if (displayUnit == null)
			{
				displayUnit = "(null)";
			}
			try
			{
				IArray1DModel xAxis = ParameterModel.XAxis;
				xDisplayUnit = ((xAxis != null) ? xAxis.EngineeringUnits : "(null)");
			}
			catch (Exception)
			{
			}
			if (xDisplayUnit == null)
			{
				xDisplayUnit = "(null)";
			}
			try
			{
				IArray1DModel yAxis = ParameterModel.YAxis;
				yDisplayUnit = ((yAxis != null) ? yAxis.EngineeringUnits : "(null)");
			}
			catch (Exception)
			{
			}
			if (yDisplayUnit == null)
			{
				yDisplayUnit = "(null)";
			}
			dataTableValueColumnChars = 6;
			propertiesTablePropertyColumnChars = 8;
			propertiesTableValueColumnChars = 5;
		}

		public void OnAfterPaste(object sender, AfterPasteArgs args)
		{
			if (alteredAscendingOrderSetting)
			{
				EditorUtilities.CheckAscendingOrder = true;
				alteredAscendingOrderSetting = false;
			}
			if (!ParameterModel.CompleteDataPaste(args.ContinueWithPaste))
			{
				try
				{
					ReLoadDataTable();
				}
				catch
				{
				}
			}
		}

		public override void Reload()
		{
			if (isDataTableLoaded)
			{
				return;
			}
			try
			{
				EnableChangeEvents = false;
				if (dataTable != null)
				{
					dataTable.Rows.Clear();
					dataTable.Columns.Clear();
					CreateDataColumns();
					LoadDataTable();
				}
				else
				{
					InitializeDataTable();
				}
			}
			finally
			{
				EnableChangeEvents = true;
			}
		}

		public void OnBeforeDataPaste(object sender, DataPasteEventArgs args)
		{
			ParameterModel.StartDataPaste();
			bool cacheEnabled = model.DataSource.CacheEnabled;
			try
			{
				if (!EditorUtilities.CheckAscendingOrder)
				{
					return;
				}
				EditorUtilities.CheckAscendingOrder = false;
				alteredAscendingOrderSetting = true;
				model.DataSource.CacheEnabled = false;
				string text = args.ClipBoardData;
				if (text.Contains("X/Y"))
				{
					text = text.Remove(args.ClipBoardData.IndexOf("X/Y"), 4);
				}
				string[] array = text.Split(new char[1] { '\n' });
				int num = 0;
				string[] array2 = new string[0];
				if (args.RowStartIndex == -1)
				{
					IArray1DModel array1DModel = (IArray1DModel)model.DataSource.Get(ParameterModel.YAxis.Name);
					array1DModel.StartDataPaste();
					int i = 0;
					if (args.ColStartIndex != -1)
					{
						i = args.ColStartIndex;
					}
					array2 = array[0].Split(new char[1] { '\t' });
					for (; i < args.ColEndIndex; i++)
					{
						try
						{
							array1DModel.SetValueByFormat(i, array2[num].TrimEnd(new char[1] { '\r' }), base.DisplayFormat);
						}
						catch
						{
						}
						num++;
					}
					CheckAscendingOrder(array1DModel);
				}
				if (args.ColStartIndex != -1)
				{
					return;
				}
				IArray1DModel array1DModel2 = (IArray1DModel)model.DataSource.Get(ParameterModel.XAxis.Name);
				array1DModel2.StartDataPaste();
				num = 0;
				int j = 0;
				if (args.RowStartIndex != -1)
				{
					j = args.RowStartIndex;
				}
				else
				{
					num = 1;
				}
				for (; j < args.RowEndIndex; j++)
				{
					array2 = array[num].Split(new char[1] { '\t' });
					try
					{
						array1DModel2.SetValueByFormat(j, array2[0].TrimEnd(new char[1] { '\r' }), base.DisplayFormat);
					}
					catch
					{
					}
					num++;
				}
				CheckAscendingOrder(array1DModel2);
			}
			finally
			{
				model.DataSource.CacheEnabled = cacheEnabled;
			}
		}

		public override void Undo()
		{
			try
			{
				string actualValueSet = string.Empty;
				switch (previousEditKind)
				{
				case EditKind.XAxisEdit:
					ParameterModel.XAxis.SetValueAtIndex(previousColumnIndex, previousValue, base.DisplayFormat, out actualValueSet);
					RaiseUndoEvent(previousEditKind, previousColumnIndex, previousValue);
					break;
				case EditKind.YAxisEdit:
					ParameterModel.YAxis.SetValueAtIndex(previousRowIndex, previousValue, base.DisplayFormat, out actualValueSet);
					RaiseUndoEvent(previousEditKind, previousRowIndex, previousValue);
					break;
				default:
				{
					DataRow dataRow = dataTable.Rows[previousRowIndex];
					dataRow[previousColumnIndex] = previousValue;
					break;
				}
				}
			}
			catch
			{
			}
		}

		public override void Revert()
		{
			ParameterModel.Revert();
			UpdateRevertedValues(EditKind.XAxisEdit, ParameterModel.XAxis.PreviousValues, ParameterModel.XAxis);
			UpdateRevertedValues(EditKind.YAxisEdit, ParameterModel.YAxis.PreviousValues, ParameterModel.YAxis);
			UpdateRevertedValues();
			ParameterModel.XAxis.PreviousValues.Clear();
			ParameterModel.YAxis.PreviousValues.Clear();
			ParameterModel.PreviousValues.Clear();
			RaiseAllCellsUnmodifiedEvent();
		}

		public override void Save()
		{
			ParameterModel.Save();
			dataTable.AcceptChanges();
			RaiseDataChangedEvent();
		}

		public override void DataMode(DataFormat displayFormat)
		{
			if (base.DisplayFormat == displayFormat)
			{
				return;
			}
			lock (Data)
			{
				base.DisplayFormat = displayFormat;
				ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
				try
				{
					ReLoadDataTable();
				}
				catch (Exception)
				{
				}
				if (SecurityLevelHelper.ToolFamily == ToolFamily.FieldEngineering || !(model.DataSource is ICalibrationECM))
				{
					ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.dataVolatile;
				}
			}
		}

		public void Increment(int xIndex, int yIndex)
		{
			DataRow dataRow = null;
			try
			{
				string text = null;
				if (-1 == yIndex)
				{
					ParameterModel.XAxis.X = xIndex;
					text = ParameterModel.XAxis.GetValueByDataFormat(xIndex, base.DisplayFormat);
					if (1 != ParameterModel.XAxis.ConfigFileType)
					{
						int rawValue = ParameterModel.XAxis.GetRawValue();
						ParameterModel.XAxis.SetRawValue(rawValue, rawValue + 1, xIndex, base.DisplayFormat);
					}
					else
					{
						ParameterModel.XAxis.ScaledFloat(xIndex, ParameterModel.XAxis.ScaledFloat(xIndex) + ParameterModel.XAxis.MinResolution);
					}
					UpdateUndoInfo(EditKind.XAxisEdit, text, -1, xIndex);
					ParameterModel.IsDirty = true;
					RaiseAxisValueChangeEvent(EditKind.XAxisEdit, xIndex, ParameterModel.XAxis.ScaledValue);
					return;
				}
				if (-1 == xIndex)
				{
					ParameterModel.YAxis.X = yIndex;
					text = ParameterModel.YAxis.GetValueByDataFormat(yIndex, base.DisplayFormat);
					if (1 != ParameterModel.YAxis.ConfigFileType)
					{
						int rawValue = ParameterModel.YAxis.GetRawValue();
						ParameterModel.YAxis.SetRawValue(rawValue, rawValue + 1, yIndex, base.DisplayFormat);
					}
					else
					{
						ParameterModel.YAxis.ScaledFloat(yIndex, ParameterModel.YAxis.ScaledFloat(yIndex) + ParameterModel.YAxis.MinResolution);
					}
					UpdateUndoInfo(EditKind.YAxisEdit, text, yIndex, -1);
					ParameterModel.IsDirty = true;
					RaiseAxisValueChangeEvent(EditKind.YAxisEdit, yIndex, ParameterModel.YAxis.ScaledValue);
					return;
				}
				ParameterModel.X = xIndex;
				ParameterModel.Y = yIndex;
				if (1 != ParameterModel.ConfigFileType)
				{
					ParameterModel.SetRawValue(ParameterModel.GetRawValue() + 1);
				}
				else
				{
					ParameterModel.ScaledFloat(ParameterModel.ScaledFloat() + ParameterModel.MinResolution);
				}
				dataRow = Data.Rows[xIndex];
				UpdateUndoInfo(EditKind.ZAxisEdit, dataRow[yIndex].ToString(), xIndex, yIndex);
				dataRow[yIndex] = ParameterModel.ScaledValue;
				DataColumnChangeEventArgs e = new DataColumnChangeEventArgs(Data.Rows[xIndex], Data.Columns[yIndex], dataRow[yIndex]);
				RaiseCellChanged(Data, e);
			}
			catch (ArrayNotInAscendingOrderException)
			{
			}
			catch (Exception e2)
			{
				EventLogger.Error("XYZEdit", "Unable to increment the value", e2);
			}
		}

		public void Decrement(int xIndex, int yIndex)
		{
			DataRow dataRow = null;
			try
			{
				string text = null;
				if (-1 == yIndex)
				{
					ParameterModel.XAxis.X = xIndex;
					text = ParameterModel.XAxis.GetValueByDataFormat(xIndex, base.DisplayFormat);
					if (1 != ParameterModel.XAxis.ConfigFileType)
					{
						int rawValue = ParameterModel.XAxis.GetRawValue();
						ParameterModel.XAxis.SetRawValue(rawValue, rawValue - 1, xIndex, base.DisplayFormat);
					}
					else
					{
						ParameterModel.XAxis.ScaledFloat(xIndex, ParameterModel.XAxis.ScaledFloat(xIndex) - ParameterModel.XAxis.MinResolution);
					}
					UpdateUndoInfo(EditKind.XAxisEdit, text, -1, xIndex);
					ParameterModel.IsDirty = true;
					RaiseAxisValueChangeEvent(EditKind.XAxisEdit, xIndex, ParameterModel.XAxis.ScaledValue);
					return;
				}
				if (-1 == xIndex)
				{
					ParameterModel.YAxis.X = yIndex;
					text = ParameterModel.XAxis.GetValueByDataFormat(yIndex, base.DisplayFormat);
					if (1 != ParameterModel.YAxis.ConfigFileType)
					{
						int rawValue = ParameterModel.YAxis.GetRawValue();
						ParameterModel.YAxis.SetRawValue(rawValue, rawValue - 1, yIndex, base.DisplayFormat);
					}
					else
					{
						ParameterModel.YAxis.ScaledFloat(yIndex, ParameterModel.YAxis.ScaledFloat(yIndex) - ParameterModel.YAxis.MinResolution);
					}
					UpdateUndoInfo(EditKind.YAxisEdit, text, yIndex, -1);
					ParameterModel.IsDirty = true;
					RaiseAxisValueChangeEvent(EditKind.YAxisEdit, yIndex, ParameterModel.YAxis.ScaledValue);
					return;
				}
				ParameterModel.X = xIndex;
				ParameterModel.Y = yIndex;
				if (1 != ParameterModel.ConfigFileType)
				{
					ParameterModel.SetRawValue(ParameterModel.GetRawValue() - 1);
				}
				else
				{
					ParameterModel.ScaledFloat(ParameterModel.ScaledFloat(xIndex, yIndex) - ParameterModel.MinResolution);
				}
				dataRow = Data.Rows[xIndex];
				UpdateUndoInfo(EditKind.ZAxisEdit, dataRow[yIndex].ToString(), xIndex, yIndex);
				dataRow[yIndex] = ParameterModel.ScaledValue;
				DataColumnChangeEventArgs e = new DataColumnChangeEventArgs(Data.Rows[xIndex], Data.Columns[yIndex], dataRow[yIndex]);
				RaiseCellChanged(Data, e);
			}
			catch (Exception e2)
			{
				EventLogger.Error("XYZEdit", "Unable to decrement the value", e2);
			}
		}

		public string SetXAxisValue(int xIndex, string proposedValue, string previousValue)
		{
			return SetAxisValue(ParameterModel.XAxis, xIndex, proposedValue, previousValue, EditKind.XAxisEdit);
		}

		public string SetYAxisValue(int yIndex, string proposedValue, string previousValue)
		{
			return SetAxisValue(ParameterModel.YAxis, yIndex, proposedValue, previousValue, EditKind.YAxisEdit);
		}

		protected void RaiseUndoEvent(EditKind editKind, int index, string restoredValue)
		{
			if (this.UndoEvent != null)
			{
				this.UndoEvent(this, new AxisValueChangeEventArgs(editKind, index, restoredValue));
			}
		}

		protected void RaiseAxisValueChangeEvent(EditKind editKind, int index, string newValue)
		{
			if (this.AxisValueChangeEvent != null)
			{
				this.AxisValueChangeEvent(this, new AxisValueChangeEventArgs(editKind, index, newValue));
			}
		}

		protected void RaiseDataChangedEvent()
		{
			if (this.DataChangedEvent != null)
			{
				this.DataChangedEvent(this, EventArgs.Empty);
			}
		}

		protected void RaiseChangeAxisValueEvent(EditKind editKind, int index, string newValue)
		{
			if (this.ChangeAxisValueEvent != null)
			{
				AxisValueChangeEventArgs e = new AxisValueChangeEventArgs(editKind, index, newValue);
				this.ChangeAxisValueEvent(this, e);
			}
		}

		protected override void InitializeDataTable()
		{
			dataTable = new DataTable();
			dataTable.TableName = "DataTable";
			CreateDataColumns();
			LoadDataTable();
		}

		private void InitializePropertiesTable()
		{
			propertiesTable = new DataTable();
			propertiesTable.TableName = "PropertiesTable";
			CreatePropertyColumns(propertiesTable);
			LoadPropertiesTable();
		}

		protected override void CreateDataColumns()
		{
			if (model.DataSource.Connected)
			{
				IArray1DModel yAxis = ParameterModel.YAxis;
				DataColumn column;
				for (int i = 0; i < yAxis.Count; i++)
				{
					column = MakeDataColumn("", i.ToString(), Type.GetType("System.String"), isReadOnly: false, isUnique: false);
					dataTable.Columns.Add(column);
				}
				column = MakeDataColumn("", "XIndex", Type.GetType("System.Int32"), isReadOnly: true, isUnique: true);
				dataTable.Columns.Add(column);
			}
		}

		private void ReLoadDataTable()
		{
			dataTable.Rows.Clear();
			dataTable.ColumnChanging -= OnColumnChanging;
			LoadDataTable();
			dataTable.ColumnChanging += OnColumnChanging;
		}

		private void DetermineTableDimensions(IArray1DModel xAxis, IArray1DModel yAxis, out int xCount, out int yCount)
		{
			if (xAxis != null && yAxis != null)
			{
				xCount = xAxis.Count;
				yCount = yAxis.Count;
				return;
			}
			int num = 0;
			try
			{
				num = ParameterModel.Count;
			}
			catch
			{
				EventLogger.Error("CalEdit", "Selected XYZ table <" + model.Name + "> is missing an axis and can't be read or edited.");
				throw new Exception("Table size is 0 because XYZ Table <" + model.Name + "> with missing axis can't be read.");
			}
			if (xAxis != null)
			{
				xCount = xAxis.Count;
				yCount = num / xCount;
			}
			else if (yAxis != null)
			{
				yCount = yAxis.Count;
				xCount = num / yCount;
			}
			else
			{
				xCount = 1;
				yCount = num;
				EventLogger.Error("CalEdit", "Selected XYZ table <" + model.Name + "> is missing both axes and so will be displayed as a 1D array.");
			}
		}

		protected override void LoadDataTable()
		{
			if (!model.DataSource.Connected)
			{
				return;
			}
			try
			{
				ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
				IArray1DModel xAxis = ParameterModel.XAxis;
				IArray1DModel yAxis = ParameterModel.YAxis;
				DetermineTableDimensions(xAxis, yAxis, out var xCount, out var yCount);
				int num = 0;
				int num2 = 0;
				for (num = 0; num < xCount; num++)
				{
					DataRow dataRow = dataTable.NewRow();
					int num3 = 0;
					for (num2 = 0; num2 < yCount; num2++)
					{
						if (base.DisplayFormat == DataFormat.Hex)
						{
							dataRow[num2] = ParameterModel.HexValue(num, num2);
						}
						else if (base.DisplayFormat == DataFormat.Binary)
						{
							dataRow[num2] = ParameterModel.BinaryValue(num, num2);
						}
						else
						{
							dataRow[num2] = ParameterModel[num, num2];
						}
						int length = dataRow[num2].ToString().Length;
						if (num3 < length)
						{
							num3 = length;
						}
					}
					DataTableValueColumnChars = num3;
					dataRow["XIndex"] = num;
					dataTable.Rows.Add(dataRow);
				}
				isDataTableLoaded = true;
				dataTable.AcceptChanges();
				RaiseDataChangedEvent();
			}
			finally
			{
				if (SecurityLevelHelper.ToolFamily == ToolFamily.FieldEngineering || !(model.DataSource is ICalibrationECM))
				{
					ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.dataVolatile;
				}
			}
		}

		private void LoadPropertiesTable()
		{
			AddToPropertiesTable("Full Name", ParameterModel.FullName);
			AddToPropertiesTable("Comment", ParameterModel.Comment);
			AddToPropertiesTable("Address", ParameterModel.Address, "X8");
			AddToPropertiesTable("Length", ParameterModel.Length.ToString());
			AddToPropertiesTable("Data Type", (long)ParameterModel.DataType, "N0");
			AddToPropertiesTable("Config Data Type", ParameterModel.ConfigFileType, "N0");
			AddToPropertiesTable("Engineering Unit", ParameterModel.EngineeringUnits);
			AddToPropertiesTable("Minimum Value", ParameterModel.LowerBound.ToString());
			AddToPropertiesTable("Maximum Value", ParameterModel.UpperBound.ToString());
			AddToPropertiesTable("Subfile Number", ParameterModel.SubfileNumber, "N0");
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = "Available Offline";
				int length = dataRow["Property"].ToString().Length;
				if (length > propertiesTablePropertyColumnChars)
				{
					propertiesTablePropertyColumnChars = length;
				}
				dataRow["Value"] = (ParameterModel.AvailableOffline ? "Yes" : "No");
				length = dataRow["Value"].ToString().Length;
				if (length > propertiesTableValueColumnChars)
				{
					propertiesTableValueColumnChars = length;
				}
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
			IArray1DModel xAxis = ParameterModel.XAxis;
			if (xAxis != null)
			{
				AddToPropertiesTable("X-AXIS", xAxis.Name);
				AddToPropertiesTable("Full Name", xAxis.FullName);
				AddToPropertiesTable("Comment", xAxis.Comment);
				AddToPropertiesTable("Data Type", (long)xAxis.DataType, "N0");
				AddToPropertiesTable("Config Data Type", xAxis.ConfigFileType, "N0");
				AddToPropertiesTable("Engineering Unit", xAxis.EngineeringUnits);
				AddToPropertiesTable("Number of Elements", xAxis.Count, "N0");
				AddToPropertiesTable("Subfile Number", xAxis.SubfileNumber, "N0");
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = "Available Offline";
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = (xAxis.AvailableOffline ? "Yes" : "No");
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			IArray1DModel yAxis = ParameterModel.YAxis;
			if (yAxis != null)
			{
				AddToPropertiesTable("Y-AXIS", yAxis.Name);
				AddToPropertiesTable("Full Name", yAxis.FullName);
				AddToPropertiesTable("Comment", yAxis.Comment);
				AddToPropertiesTable("Data Type", (long)yAxis.DataType, "N0");
				AddToPropertiesTable("Config Data Type", yAxis.ConfigFileType, "N0");
				AddToPropertiesTable("Engineering Unit", yAxis.EngineeringUnits);
				AddToPropertiesTable("Number of Elements", yAxis.Count, "N0");
				AddToPropertiesTable("Subfile Number", yAxis.SubfileNumber, "N0");
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = "Available Offline";
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = (yAxis.AvailableOffline ? "Yes" : "No");
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
		}

		private void AddToPropertiesTable(string propertyName, string propertyValue)
		{
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = propertyName;
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = propertyValue;
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
		}

		private void AddToPropertiesTable(string propertyName, long propertyValue, string format)
		{
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = propertyName;
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = propertyValue.ToString(format);
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
		}

		private string GetDataByFormat(int xIndex, int yIndex)
		{
			string empty = string.Empty;
			if (base.DisplayFormat == DataFormat.Hex)
			{
				return ParameterModel.HexValue(xIndex, yIndex);
			}
			if (base.DisplayFormat == DataFormat.Binary)
			{
				return ParameterModel.BinaryValue(xIndex, yIndex);
			}
			return ParameterModel[xIndex, yIndex];
		}

		private void SetDataByFormat(int xIndex, int yIndex, string proposedValue)
		{
			if (base.DisplayFormat == DataFormat.Hex)
			{
				ParameterModel.HexValue(xIndex, yIndex, proposedValue.ToString());
			}
			else if (base.DisplayFormat == DataFormat.Binary)
			{
				ParameterModel.BinaryValue(xIndex, yIndex, proposedValue.ToString());
			}
			else
			{
				ParameterModel[xIndex, yIndex] = proposedValue.ToString();
			}
		}

		private void SetDataValue(DataColumnChangeEventArgs e)
		{
			int ordinal = e.Column.Ordinal;
			int num = (int)e.Row["XIndex"];
			string text = "";
			bool flag = false;
			text = GetDataByFormat(num, ordinal);
			if (text == e.ProposedValue.ToString())
			{
				flag = false;
			}
			else
			{
				try
				{
					flag = ((base.DisplayFormat != DataFormat.Decimal || double.Parse(ParameterModel[num, ordinal]) != double.Parse(e.ProposedValue.ToString())) ? true : false);
				}
				catch
				{
					flag = true;
				}
			}
			if (flag)
			{
				SetDataByFormat(num, ordinal, e.ProposedValue.ToString());
				RaiseCellChanged(this, e);
				ParameterModel.IsDirty = true;
				UpdateUndoInfo(EditKind.ZAxisEdit, text, num, e.Column.Ordinal);
				string dataByFormat = GetDataByFormat(num, ordinal);
				DisplayBoundMessage(e.ProposedValue.ToString(), dataByFormat, ParameterModel.LowerBound, ParameterModel.UpperBound, model.Name);
				e.ProposedValue = dataByFormat;
			}
		}

		protected override void OnColumnChanging(object sender, DataColumnChangeEventArgs e)
		{
			if (e.ProposedValue.ToString().Length == 0)
			{
				throw new ArgumentException();
			}
			try
			{
				SetDataValue(e);
			}
			catch (Exception ex)
			{
				EventLogger.Error("Value Edit", ex.Message, ex.InnerException);
				e.Row.CancelEdit();
				throw ex;
			}
		}

		private string SetAxisValue(IArray1DModel axis, int index, string proposedValue, string oldValue, EditKind editKind)
		{
			string actualValueSet = null;
			if (index >= 0 && index <= axis.Count && proposedValue != null)
			{
				try
				{
					if (axis.SetValueAtIndex(index, proposedValue, base.DisplayFormat, out actualValueSet))
					{
						int rowIndex = -1;
						int columnIndex = -1;
						switch (editKind)
						{
						case EditKind.XAxisEdit:
							columnIndex = index;
							break;
						case EditKind.YAxisEdit:
							rowIndex = index;
							break;
						}
						DisplayBoundMessage(proposedValue, actualValueSet, axis.LowerBound, axis.UpperBound, axis.Name);
						UpdateUndoInfo(editKind, oldValue, rowIndex, columnIndex);
						ParameterModel.IsDirty = true;
					}
				}
				catch (Exception ex)
				{
					EventLogger.Error("Value Edit", ex.Message, ex.InnerException);
				}
			}
			return actualValueSet;
		}

		private void CheckAscendingOrder(IArray1DModel model)
		{
			if (!model.IsAscending())
			{
				string message = "Paste operation is aborted since after paste the values for " + model.Name + " is not in the ascending order.";
				EventLogger.Warn("Value Edit", message);
				throw new Exception(message);
			}
		}

		private void UpdateRevertedValues()
		{
			lock (Data)
			{
				foreach (object key in ParameterModel.PreviousValues.Keys)
				{
					int xIndex = (key as IArray2DIndex).XIndex;
					int yIndex = (key as IArray2DIndex).YIndex;
					Data.Rows[xIndex][yIndex] = ParameterModel.GetValueByDataFormat(xIndex, yIndex, base.DisplayFormat);
				}
			}
		}

		private void UpdateRevertedValues(EditKind editKind, SortedList previousValues, IArray1DModel parameterModel)
		{
			lock (Data)
			{
				foreach (object key in previousValues.Keys)
				{
					int index = (key as IArray1DIndex).Index;
					string valueByDataFormat = parameterModel.GetValueByDataFormat(index, base.DisplayFormat);
					RaiseChangeAxisValueEvent(editKind, index, valueByDataFormat);
				}
			}
		}

		private void UpdateUndoInfo(EditKind kindOfEdit, string valueBeforeEdit, int rowIndex, int columnIndex)
		{
			previousEditKind = kindOfEdit;
			previousValue = valueBeforeEdit;
			previousRowIndex = rowIndex;
			previousColumnIndex = columnIndex;
		}
	}
}
namespace Cummins.Editor
{
	public class MonitoredArrayXYZController : ArrayXYZController
	{
		private int xCount;

		private int yCount;

		private IAddressValue currentSourceAddress;

		private new MonitoredArrayXYZModel model;

		private IArrayAxis valueConverter;

		public bool ShowComments
		{
			get
			{
				return model.ShowComments;
			}
			set
			{
				if (model.ShowComments != value)
				{
					model.ShowComments = value;
				}
			}
		}

		public bool ValueEnabled
		{
			get
			{
				return model.ValueEnabled;
			}
			set
			{
				model.ValueEnabled = value;
			}
		}

		public DataFormat Radix
		{
			get
			{
				return model.Radix;
			}
			set
			{
				if (base.DisplayFormat != value)
				{
					model.Radix = value;
					DataMode(value);
				}
			}
		}

		public IAddressValue CurrentSourceAddress
		{
			get
			{
				return currentSourceAddress;
			}
			set
			{
				currentSourceAddress = value;
			}
		}

		public MonitoredArrayXYZController(MonitoredArrayXYZModel model)
			: base(model)
		{
			this.model = model;
			this.model.DataSource.SaveChangesEvent += OnSaveChangesEvent;
			Initialize();
		}

		public override void Reload()
		{
			base.Reload();
			Initialize();
		}

		public void Refresh(DataRefreshEventArgs e)
		{
			if (e != null)
			{
				switch (e.DataSourceType)
				{
				case DataSourceTypeEnum.ECM:
					Refresh(e as ECMDataRefreshEventArgs);
					break;
				case DataSourceTypeEnum.Disk:
					Refresh(e as DiskDataRefreshEventArgs);
					break;
				case DataSourceTypeEnum.ASAM:
					break;
				}
			}
		}

		private void Refresh(ECMDataRefreshEventArgs e)
		{
			if (e.IsProcessed)
			{
				return;
			}
			try
			{
				ArrayList eCMData = e.ECMData;
				base.EnableChangeEvents = false;
				for (int i = 0; i < eCMData.Count; i++)
				{
					ICIDataElementNotification iCIDataElementNotification = (ICIDataElementNotification)eCMData[i];
					if (iCIDataElementNotification.Status != tagCIDMStatusEnum.DM_STATUS_OK || !iCIDataElementNotification.Changed)
					{
						continue;
					}
					CICPPMonitor cICPPMonitor = (CICPPMonitor)iCIDataElementNotification.DataElementMonitor;
					if (cICPPMonitor.location.ToString() == base.ParameterModel.XAxis.FullName)
					{
						if ((valueConverter.XAxis.CalEntity as ICICalAddressableEntity).size == (iCIDataElementNotification.RawData as byte[]).Length)
						{
							(valueConverter.XAxis.CalEntity as ICICalAddressableEntity).RawData = iCIDataElementNotification.RawData;
							Refresh(EditKind.XAxisEdit, xCount, valueConverter.XAxis);
							continue;
						}
						string message = string.Format(Editor.ResourceManager.GetString(EditorMessageIDs.DataSizeMismatch.ToString()), (iCIDataElementNotification.RawData as byte[]).Length, (valueConverter.XAxis.CalEntity as ICICalAddressableEntity).size);
						throw new DataSizeMismatchException(Facility.Editor, 17, message, "Source Addr", (iCIDataElementNotification.RawData as byte[]).Length, (valueConverter.XAxis.CalEntity as ICICalAddressableEntity).size);
					}
					if (cICPPMonitor.location.ToString() == base.ParameterModel.YAxis.FullName)
					{
						if ((valueConverter.YAxis.CalEntity as ICICalAddressableEntity).size == (iCIDataElementNotification.RawData as byte[]).Length)
						{
							(valueConverter.YAxis.CalEntity as ICICalAddressableEntity).RawData = iCIDataElementNotification.RawData;
							Refresh(EditKind.YAxisEdit, yCount, valueConverter.YAxis);
							continue;
						}
						string message2 = string.Format(Editor.ResourceManager.GetString(EditorMessageIDs.DataSizeMismatch.ToString()), (iCIDataElementNotification.RawData as byte[]).Length, (valueConverter.YAxis.CalEntity as ICICalAddressableEntity).size);
						throw new DataSizeMismatchException(Facility.Editor, 17, message2, "Source Addr", (iCIDataElementNotification.RawData as byte[]).Length, (valueConverter.YAxis.CalEntity as ICICalAddressableEntity).size);
					}
					lock (Data)
					{
						if (((valueConverter as IEntityModel).CalEntity as ICICalAddressableEntity).size == (iCIDataElementNotification.RawData as byte[]).Length)
						{
							((valueConverter as IEntityModel).CalEntity as ICICalAddressableEntity).RawData = iCIDataElementNotification.RawData;
							for (int j = 0; j < xCount; j++)
							{
								for (int k = 0; k < yCount; k++)
								{
									Data.Rows[j][k] = (valueConverter as IArrayXYZModel).GetValueByDataFormat(j, k, Radix);
								}
							}
							continue;
						}
						string message3 = string.Format(Editor.ResourceManager.GetString(EditorMessageIDs.DataSizeMismatch.ToString()), (iCIDataElementNotification.RawData as byte[]).Length, ((valueConverter as IEntityModel).CalEntity as ICICalAddressableEntity).size);
						throw new DataSizeMismatchException(Facility.Editor, 17, message3, "Source Addr", (iCIDataElementNotification.RawData as byte[]).Length, ((valueConverter as IEntityModel).CalEntity as ICICalAddressableEntity).size);
					}
				}
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
		}

		private void Refresh(DiskDataRefreshEventArgs e)
		{
			SortedList diskData = e.DiskData;
			try
			{
				base.EnableChangeEvents = false;
				for (int i = 0; i < diskData.Count; i++)
				{
					IParameterModel parameterModel = (IParameterModel)diskData.GetByIndex(i);
					if (parameterModel.FullName.ToString() == base.ParameterModel.XAxis.FullName)
					{
						Refresh(EditKind.XAxisEdit, xCount, parameterModel as IArray1DModel);
						continue;
					}
					if (parameterModel.FullName.ToString() == base.ParameterModel.YAxis.FullName)
					{
						Refresh(EditKind.YAxisEdit, yCount, parameterModel as IArray1DModel);
						continue;
					}
					lock (Data)
					{
						for (int j = 0; j < xCount; j++)
						{
							for (int k = 0; k < yCount; k++)
							{
								Data.Rows[j][k] = (parameterModel as IArrayXYZModel).GetValueByDataFormat(j, k, Radix);
							}
						}
					}
				}
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
		}

		private void Refresh(EditKind editKind, int count, IArray1DModel parameterModel)
		{
			lock (Data)
			{
				for (int i = 0; i < count; i++)
				{
					string valueByDataFormat = parameterModel.GetValueByDataFormat(i, Radix);
					RaiseChangeAxisValueEvent(editKind, i, valueByDataFormat);
				}
			}
		}

		private void Initialize()
		{
			if (valueConverter == null && base.Model.DataSource.Connected)
			{
				lock (model.DataSource)
				{
					bool cacheEnabled = model.DataSource.CacheEnabled;
					model.DataSource.CacheEnabled = false;
					valueConverter = (IArrayAxis)model.DataSource.Get(base.ParameterModel.FullName);
					model.DataSource.CacheEnabled = cacheEnabled;
				}
				(valueConverter as IParameterModel).CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
				xCount = valueConverter.XAxis.Count;
				yCount = valueConverter.YAxis.Count;
				_ = (valueConverter as IArrayModel).Count;
			}
		}

		public virtual void SaveSession(NewDataSet.ScreenRow screenRow)
		{
			ScreenDataSaver screenDataSaver = new ScreenDataSaver();
			NewDataSet.GroupRow groupRow = screenDataSaver.SaveSession(screenRow);
			model.SaveSession(groupRow);
			((NewDataSet)screenRow.Table.DataSet).Group.AddGroupRow(groupRow);
			screenDataSaver.PopulateParameterTableRows(groupRow, MetaDataTable);
			base.ParameterModel.IsDirty = false;
		}

		public virtual void CleanupResources()
		{
			model.DataSource.SaveChangesEvent -= OnSaveChangesEvent;
			Data.Clear();
		}

		private void OnSaveChangesEvent(object sender, EventArgs e)
		{
			Data.AcceptChanges();
			base.ParameterModel.XAxis.UpdateRevertValue();
			base.ParameterModel.YAxis.UpdateRevertValue();
			base.ParameterModel.UpdateRevertValue();
			RaiseAllCellsUnmodifiedEvent();
		}
	}
	public class MonitoredArrayXYZModel : MonitoredModel
	{
		private bool isChanged = true;

		private bool showComments = true;

		private DataFormat radix;

		private bool valueEnabled = true;

		public bool ShowComments
		{
			get
			{
				return showComments;
			}
			set
			{
				showComments = value;
				RaiseChangeShowCommentsEvent(showComments);
			}
		}

		public bool ValueEnabled
		{
			get
			{
				return valueEnabled;
			}
			set
			{
				valueEnabled = value;
				RaiseChangeValueEnabledEvent(value);
			}
		}

		public bool IsChanged
		{
			get
			{
				return isChanged;
			}
			set
			{
				isChanged = value;
			}
		}

		public DataFormat Radix
		{
			get
			{
				return radix;
			}
			set
			{
				radix = value;
			}
		}

		public event EventHandler ChangeShowCommentsState;

		public event StateChangedEventHandler ChangeValueEnabled;

		public MonitoredArrayXYZModel(IParameterModel parameterModel)
			: base(parameterModel)
		{
			base.DataType = ParameterType.ArrayXYZ;
		}

		public void Restore(NewDataSet.GroupRow groupRow)
		{
			try
			{
				base.ParameterModel.Name = groupRow.Name;
				base.ParameterModel.Comment = groupRow.Comment;
			}
			catch
			{
			}
		}

		public void SaveSession(NewDataSet.GroupRow groupRow)
		{
			groupRow.Name = base.ParameterModel.Name;
			groupRow.Comment = base.ParameterModel.Comment;
		}

		public void RaiseChangeValueEnabledEvent(bool enable)
		{
			if (this.ChangeValueEnabled != null)
			{
				this.ChangeValueEnabled(this, new BooleanStateEventArgs(enable));
			}
		}

		public void RaiseChangeShowCommentsEvent(bool show)
		{
			if (this.ChangeShowCommentsState != null)
			{
				this.ChangeShowCommentsState(this, EventArgs.Empty);
			}
		}
	}
}
namespace Cummins.Parameter
{
	public class ArrayXYZDataView : ParameterView
	{
		private ArrayXYZController controller;

		private TextBox textBoxName;

		private ComboBox comboBoxUnitSelection;

		private TextBox textBoxComment;

		private TextBox textBoxXName;

		private ComboBox comboBoxXUnit;

		private TextBox textBoxYName;

		private ComboBox comboBoxYUnit;

		private EditGrid dataGrid;

		private Panel panel;

		private Container components;

		private ContextMenu csmMenu;

		private int rowClicked;

		private StringCollection savedRowHeaderTitles = new StringCollection();

		private StringCollection savedColumnHeaderTitles = new StringCollection();

		public override Panel Panel => panel;

		protected EditGrid Grid => dataGrid;

		protected int ValueColumnWidth
		{
			set
			{
				//IL_0020: Unknown result type (might be due to invalid IL or missing references)
				//IL_0026: Expected O, but got Unknown
				for (int i = 0; i < ((BaseCollection)((DataGrid)dataGrid).TableStyles[0].GridColumnStyles).Count; i++)
				{
					DataGridTextBoxColumn val = (DataGridTextBoxColumn)((DataGrid)dataGrid).TableStyles[0].GridColumnStyles[i];
					((DataGridColumnStyle)val).Width = value;
				}
				dataGrid.RowHeaderWidth = value;
			}
		}

		protected ArrayXYZDataView()
		{
			InitializeComponent();
		}

		public ArrayXYZDataView(ArrayXYZController xyzController, Font font)
			: base(font)
		{
			//IL_0032: Unknown result type (might be due to invalid IL or missing references)
			//IL_003c: Expected O, but got Unknown
			//IL_0059: Unknown result type (might be due to invalid IL or missing references)
			//IL_0063: Expected O, but got Unknown
			//IL_0081: Unknown result type (might be due to invalid IL or missing references)
			//IL_008b: Expected O, but got Unknown
			//IL_00a9: Unknown result type (might be due to invalid IL or missing references)
			//IL_00b3: Expected O, but got Unknown
			//IL_00d2: Unknown result type (might be due to invalid IL or missing references)
			//IL_00dc: Expected O, but got Unknown
			//IL_03ad: Unknown result type (might be due to invalid IL or missing references)
			//IL_03b7: Expected O, but got Unknown
			controller = xyzController;
			rowClicked = -1;
			InitializeComponent();
			csmMenu = new ContextMenu();
			((Menu)csmMenu).MenuItems.Add(0, new MenuItem("Copy", (EventHandler)Copy_Click));
			((Menu)csmMenu).MenuItems.Add(1, new MenuItem("Paste", (EventHandler)Paste_Click));
			((Menu)csmMenu).MenuItems.Add(2, new MenuItem("Undo", (EventHandler)Undo_Click));
			((Menu)csmMenu).MenuItems.Add(3, new MenuItem("Properties", (EventHandler)Properties_Click));
			((Control)dataGrid).ContextMenu = csmMenu;
			((DataGrid)dataGrid).AllowSorting = false;
			((DataGrid)dataGrid).CaptionText = controller.Name;
			((DataGrid)dataGrid).RowHeadersVisible = false;
			((DataGrid)dataGrid).ColumnHeadersVisible = false;
			dataGrid.RowHeaderChange += OnRowHeaderChange;
			dataGrid.ColumnHeaderChange += OnColumnHeaderChange;
			dataGrid.OnAfterDataPasteEvent += controller.OnAfterPaste;
			((Control)textBoxName).Text = controller.YDisplayUnit;
			((Control)textBoxName).Text = controller.Name;
			if (controller.DisplayUnit.Length > 0)
			{
				comboBoxUnitSelection.Items.Add((object)controller.DisplayUnit);
				((Control)comboBoxUnitSelection).Text = controller.DisplayUnit;
			}
			else
			{
				comboBoxUnitSelection.Items.Add((object)"(null)");
				((Control)comboBoxUnitSelection).Text = "(null)";
			}
			((Control)textBoxComment).Text = controller.Comment;
			((Control)textBoxXName).Text = controller.XName;
			if (controller.XDisplayUnit.Length > 0)
			{
				comboBoxXUnit.Items.Add((object)controller.XDisplayUnit);
				((Control)comboBoxXUnit).Text = controller.XDisplayUnit;
			}
			else
			{
				comboBoxXUnit.Items.Add((object)"(null)");
				((Control)comboBoxXUnit).Text = "(null)";
			}
			((Control)textBoxYName).Text = controller.YName;
			if (controller.YDisplayUnit.Length > 0)
			{
				comboBoxYUnit.Items.Add((object)controller.YDisplayUnit);
				((Control)comboBoxYUnit).Text = controller.YDisplayUnit;
			}
			else
			{
				comboBoxYUnit.Items.Add((object)"(null)");
				((Control)comboBoxYUnit).Text = "(null)";
			}
			controller.CellChangedEvent += OnCellChanged;
			controller.UndoEvent += OnEditUndo;
			controller.AxisValueChangeEvent += OnAxisValueChanged;
			controller.ChangeAxisValueEvent += OnChangeAxisValueEvent;
			InitializeView();
			controller.DataChangedEvent += OnDataChanged;
			((Control)dataGrid).MouseDown += new MouseEventHandler(OnMouseDown);
			xyzController.AllCellsUnmodifiedEvent += OnAllCellsUnmodified;
			dataGrid.BeforeDataPasteEvent += controller.OnBeforeDataPaste;
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		public override void SetDisplayMode(DataFormat dataFormat)
		{
			base.DataViewFormat = dataFormat;
			if (base.DataViewFormat != DataFormat.Decimal)
			{
				((Control)comboBoxUnitSelection).Enabled = false;
				((Control)comboBoxXUnit).Enabled = false;
				((Control)comboBoxYUnit).Enabled = false;
			}
			else
			{
				((Control)comboBoxUnitSelection).Enabled = true;
				((Control)comboBoxXUnit).Enabled = true;
				((Control)comboBoxYUnit).Enabled = true;
			}
		}

		protected void Copy_Click(object sender, EventArgs e)
		{
			try
			{
				dataGrid.Copy();
			}
			catch
			{
			}
		}

		protected void Paste_Click(object sender, EventArgs e)
		{
			try
			{
				dataGrid.Paste();
			}
			catch
			{
			}
		}

		protected void Undo_Click(object sender, EventArgs e)
		{
			int currentRowIndex = 0;
			if (rowClicked != -1)
			{
				currentRowIndex = rowClicked;
			}
			controller.Undo();
			((DataGrid)dataGrid).CurrentRowIndex = currentRowIndex;
			((Control)dataGrid).Refresh();
		}

		protected override void Properties_Click(object sender, EventArgs e)
		{
			base.Properties_Click(this, e);
		}

		protected override void InitializeView()
		{
			//IL_006f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0075: Expected O, but got Unknown
			try
			{
				_ = controller.Data;
				if (controller.DataTableLoaded)
				{
					((DataGrid)dataGrid).DataSource = controller.Data;
					((DataGrid)dataGrid).AllowSorting = false;
					dataGrid.GridHeaderText = "X/Y";
					CurrencyManager val = (CurrencyManager)((Control)this).BindingContext[((DataGrid)dataGrid).DataSource, ((DataGrid)dataGrid).DataMember];
					((DataView)val.List).AllowNew = false;
					((DataView)val.List).AllowDelete = false;
					SetColumnStyles();
					PopulateHeaders();
					UnhighlightCells();
					((Control)dataGrid).Invalidate();
				}
			}
			catch (Exception e)
			{
				EventLogger.Error("XYZView", "Exception in updating the view after data change ", e);
			}
		}

		private void OnChangeAxisValueEvent(object sender, AxisValueChangeEventArgs e)
		{
			switch (e.EditKind)
			{
			case EditKind.XAxisEdit:
				dataGrid[HeaderType.Row, e.Index].TitleWithoutEditBox = e.Value;
				break;
			case EditKind.YAxisEdit:
				dataGrid[HeaderType.Column, e.Index].TitleWithoutEditBox = e.Value;
				break;
			}
		}

		private void SetColumnStyles()
		{
			//IL_001c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0022: Expected O, but got Unknown
			((DataGrid)dataGrid).TableStyles.Clear();
			DataTable data = controller.Data;
			DataGridTableStyle val = new DataGridTableStyle();
			val.MappingName = data.TableName;
			val.AllowSorting = false;
			int yCount = controller.YCount;
			for (int i = 0; i < yCount; i++)
			{
				string text = i.ToString();
				ColoredTextBoxColumn coloredTextBoxColumn = new ColoredTextBoxColumn((DataGrid)(object)dataGrid);
				SetColumnStyle((DataGridTextBoxColumn)(object)coloredTextBoxColumn, text, text, GetColumnWidth(controller.DataTableValueColumnChars), data.Columns[text].ReadOnly);
				val.GridColumnStyles.Add((DataGridColumnStyle)(object)coloredTextBoxColumn);
				((Control)((DataGridTextBoxColumn)coloredTextBoxColumn).TextBox).ContextMenu = csmMenu;
			}
			((DataGrid)dataGrid).TableStyles.Add(val);
			((Control)textBoxName).Width = GetColumnWidth(((Control)textBoxName).Text);
			((Control)comboBoxUnitSelection).Width = GetColumnWidth(((Control)comboBoxUnitSelection).Text) + (int)(2.0 * base.AverageCharacterWidth);
			((Control)textBoxComment).Width = GetColumnWidth(((Control)textBoxComment).Text);
			((Control)textBoxXName).Width = GetColumnWidth(((Control)textBoxXName).Text);
			((Control)comboBoxXUnit).Width = GetColumnWidth(((Control)comboBoxXUnit).Text) + (int)(2.0 * base.AverageCharacterWidth);
			((Control)textBoxYName).Width = GetColumnWidth(((Control)textBoxYName).Text);
			((Control)comboBoxYUnit).Width = GetColumnWidth(((Control)comboBoxYUnit).Text) + (int)(2.0 * base.AverageCharacterWidth);
			Point location = ((Control)textBoxName).Location;
			location.X += (int)((double)((Control)textBoxName).Width + 2.0 * base.AverageCharacterWidth);
			((Control)comboBoxUnitSelection).Location = location;
			location = ((Control)textBoxXName).Location;
			location.X += (int)((double)((Control)textBoxXName).Width + 2.0 * base.AverageCharacterWidth);
			((Control)comboBoxXUnit).Location = location;
			location = ((Control)comboBoxXUnit).Location;
			location.X += (int)((double)((Control)comboBoxXUnit).Width + 4.0 * base.AverageCharacterWidth);
			((Control)textBoxYName).Location = location;
			location = ((Control)textBoxYName).Location;
			location.X += (int)((double)((Control)textBoxYName).Width + 2.0 * base.AverageCharacterWidth);
			((Control)comboBoxYUnit).Location = location;
		}

		private void OnCellChanged(object sender, DataColumnChangeEventArgs e)
		{
			ColoredTextBoxColumn coloredTextBoxColumn = (ColoredTextBoxColumn)(object)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles[e.Column.ColumnName];
			AddModifiedParameter(controller.Name);
			int num = (int)e.Row["XIndex"];
			coloredTextBoxColumn.ShowCellModified(num);
			if (((DataGrid)dataGrid).CurrentRowIndex == num)
			{
				((Control)((DataGridTextBoxColumn)coloredTextBoxColumn).TextBox).Text = e.ProposedValue.ToString();
			}
		}

		private void OnMouseDown(object sender, MouseEventArgs e)
		{
			//IL_0008: Unknown result type (might be due to invalid IL or missing references)
			//IL_0012: Invalid comparison between Unknown and I4
			//IL_0035: Unknown result type (might be due to invalid IL or missing references)
			//IL_003b: Invalid comparison between Unknown and I4
			//IL_003e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0044: Invalid comparison between Unknown and I4
			rowClicked = -1;
			if ((int)e.Button == 2097152)
			{
				Point point = new Point(e.X, e.Y);
				HitTestInfo val = ((DataGrid)dataGrid).HitTest(point);
				if ((int)val.Type == 4 || (int)val.Type == 1)
				{
					rowClicked = val.Row;
				}
			}
		}

		private void UnhighlightCells()
		{
			try
			{
				ColoredTextBoxColumn coloredTextBoxColumn = (ColoredTextBoxColumn)(object)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles["XAxis"];
				coloredTextBoxColumn.ShowAllCellsUnmodified();
				int yCount = controller.YCount;
				for (int i = 0; i < yCount; i++)
				{
					string text = i.ToString();
					coloredTextBoxColumn = (ColoredTextBoxColumn)(object)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles[text];
					coloredTextBoxColumn.ShowAllCellsUnmodified();
				}
			}
			catch (Exception ex)
			{
				_ = ex.Message;
			}
		}

		private void OnRowHeaderChange(object sender, HeaderChangeEventArgs e)
		{
			try
			{
				e.NewValue = controller.SetXAxisValue(e.Index, e.NewValue, e.OldValue);
				if (e.NewValue != e.OldValue)
				{
					dataGrid[HeaderType.Row, e.Index].Title = e.NewValue;
					dataGrid[HeaderType.Row, e.Index].IsDirty = true;
				}
				else
				{
					e.ChangeWorked = false;
					dataGrid[HeaderType.Row, e.Index].Title = e.OldValue;
				}
			}
			catch (Exception e2)
			{
				EventLogger.Error("XYZView", "Exception in changing the X-Axis value", e2);
			}
		}

		private void OnColumnHeaderChange(object sender, HeaderChangeEventArgs e)
		{
			try
			{
				e.NewValue = controller.SetYAxisValue(e.Index, e.NewValue, e.OldValue);
				if (e.NewValue != e.OldValue)
				{
					dataGrid[HeaderType.Column, e.Index].Title = e.NewValue;
					dataGrid[HeaderType.Column, e.Index].IsDirty = true;
				}
				else
				{
					dataGrid[HeaderType.Column, e.Index].Title = e.OldValue;
				}
			}
			catch (Exception e2)
			{
				EventLogger.Error("XYZView", "Exception in changing the Y-Axis value", e2);
			}
		}

		private void OnEditUndo(object sender, AxisValueChangeEventArgs e)
		{
			switch (e.EditKind)
			{
			case EditKind.XAxisEdit:
				controller.previousValue = dataGrid[HeaderType.Row, e.Index].Title;
				if (e.Index == dataGrid.RowIndex)
				{
					dataGrid[HeaderType.Row, e.Index].Title = e.Value;
				}
				else
				{
					dataGrid[HeaderType.Row, e.Index].TitleWithoutEditBox = e.Value;
				}
				break;
			case EditKind.YAxisEdit:
				controller.previousValue = dataGrid[HeaderType.Column, e.Index].Title;
				if (e.Index == dataGrid.ColumnIndex)
				{
					dataGrid[HeaderType.Column, e.Index].Title = e.Value;
				}
				else
				{
					dataGrid[HeaderType.Column, e.Index].TitleWithoutEditBox = e.Value;
				}
				break;
			}
		}

		private void OnAxisValueChanged(object sender, AxisValueChangeEventArgs e)
		{
			switch (e.EditKind)
			{
			case EditKind.XAxisEdit:
				dataGrid[HeaderType.Row, e.Index].Title = e.Value;
				dataGrid[HeaderType.Row, e.Index].IsDirty = true;
				break;
			case EditKind.YAxisEdit:
				dataGrid[HeaderType.Column, e.Index].Title = e.Value;
				dataGrid[HeaderType.Column, e.Index].IsDirty = true;
				break;
			}
		}

		private void OnDataChanged(object sender, EventArgs e)
		{
			if (!((Control)this).InvokeRequired)
			{
				InitializeView();
				return;
			}
			((Control)this).BeginInvoke((Delegate)new EventHandler(OnDataChanged), new object[2] { sender, e });
		}

		private void OnAllCellsUnmodified(object sender, EventArgs e)
		{
			if (((DataGrid)dataGrid).TableStyles["DataTable"] != null)
			{
				for (int i = 0; i < ((BaseCollection)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles).Count; i++)
				{
					((ColoredTextBoxColumn)(object)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles[i])?.ShowAllCellsUnmodified();
				}
			}
			dataGrid.ResetDirty();
		}

		private void InitializeComponent()
		{
			//IL_0001: Unknown result type (might be due to invalid IL or missing references)
			//IL_000b: Expected O, but got Unknown
			//IL_0017: Unknown result type (might be due to invalid IL or missing references)
			//IL_0021: Expected O, but got Unknown
			//IL_0022: Unknown result type (might be due to invalid IL or missing references)
			//IL_002c: Expected O, but got Unknown
			//IL_002d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0037: Expected O, but got Unknown
			//IL_0038: Unknown result type (might be due to invalid IL or missing references)
			//IL_0042: Expected O, but got Unknown
			//IL_0043: Unknown result type (might be due to invalid IL or missing references)
			//IL_004d: Expected O, but got Unknown
			//IL_004e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0058: Expected O, but got Unknown
			//IL_0059: Unknown result type (might be due to invalid IL or missing references)
			//IL_0063: Expected O, but got Unknown
			panel = new Panel();
			dataGrid = new EditGrid();
			comboBoxYUnit = new ComboBox();
			textBoxYName = new TextBox();
			comboBoxXUnit = new ComboBox();
			textBoxXName = new TextBox();
			textBoxComment = new TextBox();
			comboBoxUnitSelection = new ComboBox();
			textBoxName = new TextBox();
			((Control)panel).SuspendLayout();
			((ISupportInitialize)dataGrid).BeginInit();
			((Control)this).SuspendLayout();
			((Control)panel).Controls.Add((Control)(object)dataGrid);
			((Control)panel).Controls.Add((Control)(object)comboBoxYUnit);
			((Control)panel).Controls.Add((Control)(object)textBoxYName);
			((Control)panel).Controls.Add((Control)(object)comboBoxXUnit);
			((Control)panel).Controls.Add((Control)(object)textBoxXName);
			((Control)panel).Controls.Add((Control)(object)textBoxComment);
			((Control)panel).Controls.Add((Control)(object)comboBoxUnitSelection);
			((Control)panel).Controls.Add((Control)(object)textBoxName);
			((Control)panel).Dock = (DockStyle)5;
			((Control)panel).Location = new Point(0, 0);
			((Control)panel).Name = "panel";
			((Control)panel).Size = new Size(528, 328);
			((Control)panel).TabIndex = 0;
			dataGrid.AddRowsOnPaste = false;
			((Control)dataGrid).Anchor = (AnchorStyles)15;
			dataGrid.ColumnCount = 0;
			((DataGrid)dataGrid).DataMember = "";
			dataGrid.DirtyColor = Color.Yellow;
			dataGrid.GridHeaderText = null;
			((DataGrid)dataGrid).HeaderForeColor = SystemColors.ControlText;
			((Control)dataGrid).Location = new Point(8, 8);
			((Control)dataGrid).Name = "dataGrid";
			dataGrid.RowHeaderWidth = 75;
			((Control)dataGrid).Size = new Size(512, 312);
			((Control)dataGrid).TabIndex = 7;
			comboBoxYUnit.DropDownStyle = (ComboBoxStyle)2;
			((Control)comboBoxYUnit).Location = new Point(352, 80);
			((Control)comboBoxYUnit).Name = "comboBoxYUnit";
			((Control)comboBoxYUnit).Size = new Size(121, 21);
			((Control)comboBoxYUnit).TabIndex = 6;
			((Control)comboBoxYUnit).Visible = false;
			((Control)textBoxYName).Location = new Point(248, 80);
			((Control)textBoxYName).Name = "textBoxYName";
			((TextBoxBase)textBoxYName).ReadOnly = true;
			((Control)textBoxYName).Size = new Size(100, 20);
			((Control)textBoxYName).TabIndex = 5;
			((Control)textBoxYName).Text = "YName";
			((Control)textBoxYName).Visible = false;
			comboBoxXUnit.DropDownStyle = (ComboBoxStyle)2;
			((Control)comboBoxXUnit).Location = new Point(112, 80);
			((Control)comboBoxXUnit).Name = "comboBoxXUnit";
			((Control)comboBoxXUnit).Size = new Size(121, 21);
			((Control)comboBoxXUnit).TabIndex = 4;
			((Control)comboBoxXUnit).Visible = false;
			((Control)textBoxXName).Location = new Point(8, 80);
			((Control)textBoxXName).Name = "textBoxXName";
			((TextBoxBase)textBoxXName).ReadOnly = true;
			((Control)textBoxXName).Size = new Size(100, 20);
			((Control)textBoxXName).TabIndex = 3;
			((Control)textBoxXName).Text = "X Name";
			((Control)textBoxXName).Visible = false;
			((Control)textBoxComment).Location = new Point(8, 40);
			((Control)textBoxComment).Name = "textBoxComment";
			((TextBoxBase)textBoxComment).ReadOnly = true;
			((Control)textBoxComment).Size = new Size(456, 20);
			((Control)textBoxComment).TabIndex = 2;
			((Control)textBoxComment).Text = "Comment";
			((Control)textBoxComment).Visible = false;
			comboBoxUnitSelection.DropDownStyle = (ComboBoxStyle)2;
			((Control)comboBoxUnitSelection).Location = new Point(192, 8);
			((Control)comboBoxUnitSelection).Name = "comboBoxUnitSelection";
			((Control)comboBoxUnitSelection).Size = new Size(121, 21);
			((Control)comboBoxUnitSelection).TabIndex = 1;
			((Control)comboBoxUnitSelection).Visible = false;
			((Control)textBoxName).Location = new Point(8, 8);
			((Control)textBoxName).Name = "textBoxName";
			((TextBoxBase)textBoxName).ReadOnly = true;
			((Control)textBoxName).Size = new Size(176, 20);
			((Control)textBoxName).TabIndex = 0;
			((Control)textBoxName).Text = "Name";
			((Control)textBoxName).Visible = false;
			((Control)this).Controls.Add((Control)(object)panel);
			((Control)this).Name = "ArrayXYZDataView";
			((Control)this).Size = new Size(528, 328);
			((Control)panel).ResumeLayout(false);
			((Control)panel).PerformLayout();
			((ISupportInitialize)dataGrid).EndInit();
			((Control)this).ResumeLayout(false);
		}

		protected override bool ProcessCmdKey(ref Message m, Keys keyData)
		{
			//IL_000f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0010: Unknown result type (might be due to invalid IL or missing references)
			//IL_0016: Unknown result type (might be due to invalid IL or missing references)
			//IL_001c: Invalid comparison between Unknown and I4
			//IL_0096: Unknown result type (might be due to invalid IL or missing references)
			//IL_009c: Unknown result type (might be due to invalid IL or missing references)
			//IL_00a2: Invalid comparison between Unknown and I4
			//IL_001e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0021: Invalid comparison between Unknown and I4
			//IL_00b5: Unknown result type (might be due to invalid IL or missing references)
			//IL_00a4: Unknown result type (might be due to invalid IL or missing references)
			//IL_00a7: Invalid comparison between Unknown and I4
			//IL_006e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0071: Invalid comparison between Unknown and I4
			//IL_0023: Unknown result type (might be due to invalid IL or missing references)
			//IL_0026: Invalid comparison between Unknown and I4
			Keys val = (Keys)((Message)(ref m)).WParam.ToInt32();
			if ((keyData & 0x40000) == 262144 && ((int)val == 38 || (int)val == 40))
			{
				try
				{
					BindingManagerBase val2 = ((Control)this).BindingContext[((DataGrid)dataGrid).DataSource, ((DataGrid)dataGrid).DataMember];
					_ = (DataRowView)val2.Current;
					int rowIndex = dataGrid.RowIndex;
					int columnIndex = dataGrid.ColumnIndex;
					if ((int)val == 38)
					{
						controller.Increment(rowIndex, columnIndex);
					}
					else
					{
						controller.Decrement(rowIndex, columnIndex);
					}
				}
				catch
				{
				}
				return true;
			}
			if ((keyData & 0x20000) == 131072 && (int)val == 73)
			{
				Properties_Click(this, null);
				return true;
			}
			return ((ContainerControl)this).ProcessCmdKey(ref m, keyData);
		}

		private void PopulateHeaders()
		{
			((DataGrid)dataGrid).RowHeadersVisible = true;
			((DataGrid)dataGrid).ColumnHeadersVisible = true;
			dataGrid.ColumnCount = controller.ParameterModel.YAxis.Count;
			if (controller.ParameterModel.XAxis != null)
			{
				int num = 50;
				IArray1DModel xAxis = controller.ParameterModel.XAxis;
				savedRowHeaderTitles.Clear();
				for (int i = 0; i < dataGrid.RowCount && i < xAxis.Count; i++)
				{
					switch (controller.DisplayFormat)
					{
					case DataFormat.Hex:
						dataGrid[HeaderType.Row, i].Title = xAxis.HexValue(i);
						break;
					case DataFormat.Binary:
						dataGrid[HeaderType.Row, i].Title = xAxis.BinaryValue(i);
						break;
					default:
						dataGrid[HeaderType.Row, i].Title = xAxis[i];
						break;
					}
					savedRowHeaderTitles.Add(dataGrid[HeaderType.Row, i].Title);
					dataGrid[HeaderType.Row, i].IsDirty = false;
					num = Math.Max(num, GetColumnWidth(dataGrid[HeaderType.Row, i].Title));
				}
				dataGrid.RowHeaderWidth = num;
			}
			if (controller.ParameterModel.YAxis == null)
			{
				return;
			}
			IArray1DModel yAxis = controller.ParameterModel.YAxis;
			savedColumnHeaderTitles.Clear();
			for (int j = 0; j < dataGrid.ColumnCount && j < yAxis.Count; j++)
			{
				switch (controller.DisplayFormat)
				{
				case DataFormat.Hex:
					dataGrid[HeaderType.Column, j].Title = yAxis.HexValue(j);
					break;
				case DataFormat.Binary:
					dataGrid[HeaderType.Column, j].Title = yAxis.BinaryValue(j);
					break;
				default:
					dataGrid[HeaderType.Column, j].Title = yAxis[j];
					break;
				}
				savedColumnHeaderTitles.Add(dataGrid[HeaderType.Column, j].Title);
				dataGrid[HeaderType.Column, j].IsDirty = false;
				int length = Math.Max(controller.DataTableValueColumnChars, dataGrid[HeaderType.Column, j].Title.Length);
				((DataGrid)dataGrid).TableStyles[controller.Data.TableName].GridColumnStyles[j].Width = GetColumnWidth(length);
			}
		}
	}
}
namespace Cummins.Editor
{
	public class MonitoredArrayXYZView : ArrayXYZDataView
	{
		private MonitoredArrayXYZController controller;

		public event KeyEventHandler GridKeyDown
		{
			add
			{
				base.Grid.GridKeyDown += value;
			}
			remove
			{
				base.Grid.GridKeyDown -= value;
			}
		}

		protected MonitoredArrayXYZView()
		{
		}

		public MonitoredArrayXYZView(MonitoredArrayXYZController controller, Font font)
			: base(controller, font)
		{
			this.controller = controller;
		}
	}
	public class MonitoredGroup : Cummins.Parameter.Parameter, IMonitorElement, IDisposable
	{
		private bool disposed;

		public override SortedList Calibrations
		{
			set
			{
				((MonitoredGroupController)base.Controller).ResetModuleNetwork(value);
			}
		}

		public bool ShowComments
		{
			get
			{
				return ((MonitoredGroupController)base.Controller).ShowComments;
			}
			set
			{
				((MonitoredGroupController)base.Controller).ShowComments = value;
			}
		}

		public bool ValueEnabled
		{
			set
			{
				((MonitoredGroupController)base.Controller).ValueEnabled = value;
			}
		}

		public DataFormat Radix
		{
			set
			{
				((MonitoredGroupController)base.Controller).Radix = value;
			}
		}

		public IAddressValue CurrentSourceAddress
		{
			get
			{
				return ((MonitoredGroupController)base.Controller).CurrentSourceAddress;
			}
			set
			{
				((MonitoredGroupController)base.Controller).CurrentSourceAddress = value;
			}
		}

		public ArrayList IDLParametersList => ((MonitoredGroupController)base.Controller).IDLParametersList;

		public bool IsDirty
		{
			get
			{
				return MonitoredGroupModel.IsChanged;
			}
			set
			{
				MonitoredGroupModel.IsChanged = value;
			}
		}

		public bool AddPending => MonitoredGroupModel.AddPending;

		public MonitoredGroupModel MonitoredGroupModel => (MonitoredGroupModel)base.Model;

		public MonitoredGroupView MonitoredGroupView => (MonitoredGroupView)base.DataView;

		public int UIRefreshRate
		{
			get
			{
				return MonitoredGroupModel.UIRefreshRate;
			}
			set
			{
				MonitoredGroupModel.UIRefreshRate = value;
			}
		}

		public bool IsMonitoring
		{
			get
			{
				return ((MonitoredGroupController)base.Controller).IsMonitoring;
			}
			set
			{
				((MonitoredGroupController)base.Controller).IsMonitoring = value;
			}
		}

		internal event UpdatedConnectionEventHandler UpdatedConnectionEvent;

		public event MonitoredElementAddingEventHandler MonitoredElementAddingEvent
		{
			add
			{
				(base.Controller as MonitoredGroupController).MonitoredElementAddingEvent += value;
			}
			remove
			{
				(base.Controller as MonitoredGroupController).MonitoredElementAddingEvent -= value;
			}
		}

		public event KeyEventHandler GridKeyDown
		{
			add
			{
				MonitoredGroupView.GridKeyDown += value;
			}
			remove
			{
				MonitoredGroupView.GridKeyDown -= value;
			}
		}

		public MonitoredGroup(MonitorScreenType screenType)
		{
			switch (screenType)
			{
			case MonitorScreenType.Normal:
				base.Model = new MonitoredGroupModel();
				base.ParameterModel = null;
				base.Controller = new MonitoredGroupController(MonitoredGroupModel);
				base.DataView = new MonitoredGroupView((MonitoredGroupController)base.Controller, base.Font);
				break;
			case MonitorScreenType.Graphical:
				base.Model = new GraphicalMonitoredGroupModel();
				base.ParameterModel = null;
				base.Controller = new GraphicalMonitoredGroupController((GraphicalMonitoredGroupModel)MonitoredGroupModel);
				UpdatedConnectionEvent += ((GraphicalMonitoredGroupController)base.Controller).OnUpdatedConnectionEvent;
				base.DataView = new GraphicalMonitoredGroupView((GraphicalMonitoredGroupController)base.Controller, (GraphicalMonitoredGroupModel)base.Model, base.Font);
				((GraphicalMonitoredGroupView)base.DataView).GraphSettingsChangedEvent += ((GraphicalMonitoredGroupModel)base.Model).OnGraphSettingChanged;
				break;
			}
			disposed = false;
		}

		public override void Restore(DataRow groupRow)
		{
			((MonitoredGroupController)base.Controller).Restore(groupRow as NewDataSet.GroupRow);
		}

		public void SaveSession(NewDataSet.ScreenRow screenRow)
		{
			((MonitoredGroupController)base.Controller).SaveSession(screenRow);
		}

		public void AddParameters(StringCollection parameters, bool isBroadcast, IAddressValue sourceAddress)
		{
			((MonitoredGroupView)base.DataView).AddParameters(parameters, isBroadcast, sourceAddress);
		}

		public override void Reconcile(IAddressValue deviceAddress)
		{
			((MonitoredGroupController)base.Controller).Reconcile(deviceAddress);
		}

		public override void Resynchronize()
		{
			((MonitoredGroupController)base.Controller).Resynchronize();
		}

		public override void BuildSomeRows()
		{
			((MonitoredGroupController)base.Controller).BuildSomeRows();
		}

		public void OnSuspendMonitoringChanged(object sender, SuspendMonitoringChangedEventArgs e)
		{
			if (!e.SuspendDataMonitoring)
			{
				return;
			}
			if (e.Suspend)
			{
				if (e.AllDevices)
				{
					IsMonitoring = false;
				}
			}
			else if (e.AllDevices)
			{
				IsMonitoring = true;
			}
		}

		public void OnNetworkConnectionLost(object sender, DeviceAddressEventArgs e)
		{
			RaiseUpdatedConnectionEvent(e.DeviceAddress, connected: false);
		}

		public void OnNetworkConnectionEstablished(object sender, DeviceAddressEventArgs e)
		{
			RaiseUpdatedConnectionEvent(e.DeviceAddress, connected: true);
		}

		public void SetGridFocus()
		{
			MonitoredGroupView.SetGridFocus();
		}

		public void Dispose()
		{
			Dispose(disposing: true);
			GC.SuppressFinalize(this);
		}

		protected virtual void Dispose(bool disposing)
		{
			if (!disposed && disposing)
			{
				CleaupResources();
			}
			disposed = true;
		}

		public void CleaupResources()
		{
			((Component)(object)base.DataView).Dispose();
			((MonitoredGroupController)base.Controller).CleanupResources();
		}

		private void RaiseUpdatedConnectionEvent(IAddressValue sourceAddress, bool connected)
		{
			if (this.UpdatedConnectionEvent != null)
			{
				UpdatedConnectionEventArgs e = new UpdatedConnectionEventArgs(sourceAddress, connected);
				this.UpdatedConnectionEvent(this, e);
			}
		}

		public void Refresh(DataRefreshEventArgs e, bool forceUpdate)
		{
			((MonitoredGroupController)base.Controller).Refresh(e, forceUpdate);
		}

		public void SaveDataPoint(DataRefreshEventArgs e)
		{
			((GraphicalMonitoredGroupController)base.Controller).SaveDataPoint(e);
		}

		public void CleanUpData()
		{
			((GraphicalMonitoredGroupController)base.Controller).CleanUpData();
		}
	}
	public delegate void MonitoredElementAddingEventHandler(object sender, IParameterModel e);
	public enum EditorState
	{
		Idle,
		Editing,
		EditOver,
		Refreshing,
		RefreshOver
	}
	public enum ArrayIndexChange
	{
		Increment,
		Decrement
	}
	public enum MonitorScreenType
	{
		Normal,
		Graphical,
		Complex
	}
	public delegate void RadixEventHandler(object sender, RadixEventArgs e);
	public class RadixEventArgs : EventArgs
	{
		private DataFormat Radix;

		public DataFormat RadixType => Radix;

		public RadixEventArgs(DataFormat Radix)
		{
			this.Radix = Radix;
		}
	}
	public delegate void ParameterEventHandler(object sender, ParameterEventArgs e);
	public delegate void ParameterListEventHandler(object sender, ParameterListEventArgs e);
	public delegate void StateChangedEventHandler(object sender, BooleanStateEventArgs e);
	internal delegate void UIRefreshRateChangedEventHandler(object sender, UIRefreshRateChangedEventArgs e);
	public class MonitoredStructure : Cummins.Parameter.Parameter, IMonitorElement, IDisposable
	{
		private bool disposed;

		private ArrayList iDLParametersList;

		public bool ShowComments
		{
			get
			{
				return ((MonitoredStructureController)base.Controller).ShowComments;
			}
			set
			{
				((MonitoredStructureController)base.Controller).ShowComments = value;
			}
		}

		public bool ValueEnabled
		{
			set
			{
				((MonitoredStructureController)base.Controller).ValueEnabled = value;
			}
		}

		public bool IsDirty => ((MonitoredStructureModel)base.ParameterModel).IsChanged;

		public DataFormat Radix
		{
			set
			{
				((MonitoredStructureController)base.Controller).Radix = value;
			}
		}

		public IAddressValue CurrentSourceAddress
		{
			get
			{
				return ((MonitoredStructureController)base.Controller).CurrentSourceAddress;
			}
			set
			{
				((MonitoredStructureController)base.Controller).CurrentSourceAddress = value;
			}
		}

		public ArrayList IDLParametersList
		{
			get
			{
				if (iDLParametersList == null)
				{
					iDLParametersList = new ArrayList();
					LogParameters logParameters = new LogParameters
					{
						parameterName = base.ParameterModel.Name,
						sourceAddess = base.ParameterModel.DataSource.SourceAddress
					};
					iDLParametersList.Add(logParameters);
				}
				return iDLParametersList;
			}
		}

		public event KeyEventHandler GridKeyDown
		{
			add
			{
				((MonitoredStructureView)base.DataView).GridKeyDown += value;
			}
			remove
			{
				((MonitoredStructureView)base.DataView).GridKeyDown -= value;
			}
		}

		public MonitoredStructure(IParameterModel parameterModel)
		{
			base.Model = new MonitoredStructureModel(parameterModel);
			base.ParameterModel = parameterModel;
			base.ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
			base.Controller = new MonitoredStructureController((MonitoredStructureModel)base.Model);
			base.DataView = new MonitoredStructureView((MonitoredStructureController)base.Controller, base.Font);
			base.ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.dataVolatile;
			disposed = false;
		}

		public void Refresh(DataRefreshEventArgs e, bool forceUpdate)
		{
			((MonitoredStructureController)base.Controller).Refresh(e);
		}

		public void SaveSession(NewDataSet.ScreenRow screenRow)
		{
			((MonitoredStructureController)base.Controller).SaveSession(screenRow);
		}

		public void Dispose()
		{
			Dispose(disposing: true);
			GC.SuppressFinalize(this);
		}

		protected virtual void Dispose(bool disposing)
		{
			if (!disposed && disposing)
			{
				CleaupResources();
			}
			disposed = true;
		}

		public void CleaupResources()
		{
			((Component)(object)base.DataView).Dispose();
			((MonitoredStructureController)base.Controller).CleanupResources();
		}
	}
	public class MonitoredStructureArray : Cummins.Parameter.Parameter, IMonitorElement, IDisposable
	{
		private bool disposed;

		private ArrayList iDLParametersList;

		public bool ShowComments
		{
			get
			{
				return ((MonitoredStructureArrayController)base.Controller).ShowComments;
			}
			set
			{
				((MonitoredStructureArrayController)base.Controller).ShowComments = value;
			}
		}

		public bool ValueEnabled
		{
			set
			{
				((MonitoredStructureArrayController)base.Controller).ValueEnabled = value;
			}
		}

		public bool IsDirty => ((MonitoredStructureArrayModel)base.ParameterModel).IsChanged;

		public DataFormat Radix
		{
			set
			{
				((MonitoredStructureArrayController)base.Controller).Radix = value;
			}
		}

		public IAddressValue CurrentSourceAddress
		{
			get
			{
				return ((MonitoredStructureArrayController)base.Controller).CurrentSourceAddress;
			}
			set
			{
				((MonitoredStructureArrayController)base.Controller).CurrentSourceAddress = value;
			}
		}

		public ArrayList IDLParametersList
		{
			get
			{
				if (iDLParametersList == null)
				{
					iDLParametersList = new ArrayList();
					LogParameters logParameters = new LogParameters
					{
						parameterName = base.ParameterModel.Name,
						sourceAddess = base.ParameterModel.DataSource.SourceAddress
					};
					iDLParametersList.Add(logParameters);
				}
				return iDLParametersList;
			}
		}

		public event KeyEventHandler GridKeyDown
		{
			add
			{
				((MonitoredStructureArrayView)base.DataView).GridKeyDown += value;
			}
			remove
			{
				((MonitoredStructureArrayView)base.DataView).GridKeyDown -= value;
			}
		}

		public MonitoredStructureArray(IParameterModel parameterModel)
		{
			base.Model = new MonitoredStructureArrayModel(parameterModel);
			base.ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
			base.Controller = new MonitoredStructureArrayController((MonitoredStructureArrayModel)base.Model);
			base.DataView = new MonitoredStructureArrayView((MonitoredStructureArrayController)base.Controller, base.Font);
			base.ParameterModel.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.dataVolatile;
			disposed = false;
		}

		public void Refresh(DataRefreshEventArgs e, bool forceUpdate)
		{
			((MonitoredStructureArrayController)base.Controller).Refresh(e);
		}

		public void SaveSession(NewDataSet.ScreenRow screenRow)
		{
			((MonitoredStructureArrayController)base.Controller).SaveSession(screenRow);
		}

		public void Dispose()
		{
			Dispose(disposing: true);
			GC.SuppressFinalize(this);
		}

		protected virtual void Dispose(bool disposing)
		{
			if (!disposed && disposing)
			{
				CleaupResources();
			}
			disposed = true;
		}

		public void CleaupResources()
		{
			((Component)(object)base.DataView).Dispose();
			((MonitoredStructureArrayController)base.Controller).CleanupResources();
		}
	}
}
namespace Cummins.Parameter
{
	public class StructureArrayController : GroupController
	{
		private IMonitoredModel model;

		public StructureArrayController(MonitoredGroupModel structureArrayModel)
			: base(structureArrayModel)
		{
			model = structureArrayModel;
			(model.ParameterModel as IStructureArrayModel).IndexChangedEvent += OnIndexChangedEvent;
		}

		private void OnIndexChangedEvent(object sender, EventArgs eventArgs)
		{
			lock (base.Model.Members.SyncRoot)
			{
				try
				{
					base.Model.Members.Clear();
					foreach (object key in (base.Model.ParameterModel as IStructureArrayModel).Members.Keys)
					{
						IParameterModel value = (base.Model.ParameterModel as IStructureArrayModel).Members[key] as IParameterModel;
						base.Model.Members.Add(key, value);
					}
					RefreshDataTable();
				}
				catch
				{
				}
			}
		}

		private void RefreshDataTable()
		{
			base.EnableChangeEvents = false;
			try
			{
				foreach (DataRow row in Data.Rows)
				{
					try
					{
						IParameterModel memberParameter = GetMemberParameter(row);
						if (memberParameter != null && (memberParameter.DataType == ParameterType.Value || memberParameter.DataType == ParameterType.Enumeration))
						{
							row["Value"] = GetValueByDataFormat(memberParameter as IValueModel);
						}
					}
					catch
					{
					}
				}
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
		}
	}
}
namespace Cummins.Editor
{
	public class MonitoredStructureArrayController : StructureArrayController
	{
		private IAddressValue currentSourceAddress;

		private MonitoredStructureArrayModel model;

		private IStructureArrayModel valueConverter;

		public bool ShowComments
		{
			get
			{
				return model.ShowComments;
			}
			set
			{
				if (model.ShowComments != value)
				{
					model.ShowComments = value;
				}
			}
		}

		public bool ValueEnabled
		{
			get
			{
				return model.ValueEnabled;
			}
			set
			{
				model.ValueEnabled = value;
			}
		}

		public DataFormat Radix
		{
			get
			{
				return model.Radix;
			}
			set
			{
				if (base.DisplayFormat != value)
				{
					model.Radix = value;
					DataMode(value);
				}
			}
		}

		public IAddressValue CurrentSourceAddress
		{
			get
			{
				return currentSourceAddress;
			}
			set
			{
				currentSourceAddress = value;
			}
		}

		public new MonitoredStructureArrayModel Model => model;

		public MonitoredStructureArrayController(MonitoredStructureArrayModel model)
			: base(model)
		{
			this.model = model;
			Initialize();
			this.model.DataSource.SaveChangesEvent += OnSaveChangesEvent;
		}

		public override void Reload()
		{
			base.Reload();
			Initialize();
		}

		public void Refresh(DataRefreshEventArgs e)
		{
			if (e != null)
			{
				switch (e.DataSourceType)
				{
				case DataSourceTypeEnum.ECM:
					Refresh(e as ECMDataRefreshEventArgs);
					break;
				case DataSourceTypeEnum.ASAM:
				case DataSourceTypeEnum.Disk:
					break;
				}
			}
		}

		private void Refresh(ECMDataRefreshEventArgs e)
		{
			if (e.IsProcessed)
			{
				return;
			}
			try
			{
				ArrayList eCMData = e.ECMData;
				Model.Update(eCMData);
				base.EnableChangeEvents = false;
				lock (Data)
				{
					SortedList members = (Model.ParameterModel as IStructureArrayModel).Members;
					foreach (DataRow row in Data.Rows)
					{
						if (members[row["Name"].ToString()] is IParameterModel parameterModel && (parameterModel.DataType == ParameterType.Value || parameterModel.DataType == ParameterType.Enumeration))
						{
							IValueModel valueModel = (IValueModel)parameterModel;
							row["Value"] = GetValueByDataFormat(valueModel);
						}
					}
				}
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
		}

		public virtual void SaveSession(NewDataSet.ScreenRow screenRow)
		{
			ScreenDataSaver screenDataSaver = new ScreenDataSaver();
			NewDataSet.GroupRow groupRow = screenDataSaver.SaveSession(screenRow);
			model.SaveSession(groupRow);
			((NewDataSet)screenRow.Table.DataSet).Group.AddGroupRow(groupRow);
			screenDataSaver.PopulateParameterTableRows(groupRow, MetaDataTable);
			model.IsDirty = false;
		}

		public virtual void CleanupResources()
		{
			model.DataSource.SaveChangesEvent -= OnSaveChangesEvent;
			Data.Clear();
		}

		private void OnSaveChangesEvent(object sender, EventArgs e)
		{
			Data.AcceptChanges();
			(model.ParameterModel as IEntityModel).UpdateRevertValue();
			RaiseAllCellsUnmodifiedEvent();
		}

		private void Initialize()
		{
			if (valueConverter == null && model.DataSource.Connected)
			{
				lock (model.DataSource)
				{
					bool cacheEnabled = model.DataSource.CacheEnabled;
					model.DataSource.CacheEnabled = false;
					valueConverter = (IStructureArrayModel)model.DataSource.Get(model.ParameterModel.FullName);
					model.DataSource.CacheEnabled = cacheEnabled;
				}
				valueConverter.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
			}
		}
	}
	public class MonitoredStructureArrayModel : MonitoredGroupModel
	{
		private bool isChanged = true;

		private bool showComments = true;

		private DataFormat radix;

		private bool valueEnabled = true;

		public new bool ShowComments
		{
			get
			{
				return showComments;
			}
			set
			{
				showComments = value;
				RaiseChangeShowCommentsEvent(showComments);
			}
		}

		public new bool ValueEnabled
		{
			get
			{
				return valueEnabled;
			}
			set
			{
				valueEnabled = value;
				RaiseChangeValueEnabledEvent(value);
			}
		}

		public override bool IsChanged
		{
			get
			{
				return isChanged;
			}
			set
			{
				isChanged = value;
			}
		}

		public new DataFormat Radix
		{
			get
			{
				return radix;
			}
			set
			{
				radix = value;
			}
		}

		public new event EventHandler ChangeShowCommentsState;

		public new event StateChangedEventHandler ChangeValueEnabled;

		public MonitoredStructureArrayModel(IParameterModel parameterModel)
		{
			base.ParameterModel = parameterModel;
			base.DataType = ParameterType.StructureArray;
			for (int i = 0; i < (parameterModel as IGroupModel).Members.Count; i++)
			{
				IParameterModel parameterModel2 = (IParameterModel)(parameterModel as IGroupModel).Members.GetByIndex(i);
				Members.Add(parameterModel2.Name, parameterModel2);
			}
			base.DataSource = parameterModel.DataSource;
		}

		public new void Restore(NewDataSet.GroupRow groupRow)
		{
			try
			{
				Name = groupRow.Name;
				Comment = groupRow.Comment;
			}
			catch
			{
			}
		}

		public new void SaveSession(NewDataSet.GroupRow groupRow)
		{
			groupRow.Name = Name;
			groupRow.Comment = Comment;
		}

		public new void RaiseChangeValueEnabledEvent(bool enable)
		{
			if (this.ChangeValueEnabled != null)
			{
				this.ChangeValueEnabled(this, new BooleanStateEventArgs(enable));
			}
		}

		public new void RaiseChangeShowCommentsEvent(bool show)
		{
			if (this.ChangeShowCommentsState != null)
			{
				this.ChangeShowCommentsState(this, EventArgs.Empty);
			}
		}

		public bool Update(ArrayList parameterValues)
		{
			bool result = false;
			try
			{
				for (int i = 0; i < parameterValues.Count; i++)
				{
					ICIDataElementNotification iCIDataElementNotification = (ICIDataElementNotification)parameterValues[i];
					if (iCIDataElementNotification.Status == tagCIDMStatusEnum.DM_STATUS_OK && iCIDataElementNotification.Changed)
					{
						(base.ParameterModel as IStructureArrayModel).UpdateFromMessage(iCIDataElementNotification);
					}
				}
				result = true;
			}
			catch
			{
			}
			return result;
		}
	}
}
namespace Cummins.Parameter
{
	public class StructureArrayView : GroupDataView
	{
		private Panel panelIndex;

		private Label lblIndex;

		private NumericUpDown numericUpDownIndex;

		private Container components;

		public StructureArrayView(StructureArrayController structureArrayController, Font font)
			: base(structureArrayController, font)
		{
			InitializeComponent();
			InitializeView();
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void InitializeComponent()
		{
			//IL_0001: Unknown result type (might be due to invalid IL or missing references)
			//IL_000b: Expected O, but got Unknown
			//IL_000c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0016: Expected O, but got Unknown
			//IL_0017: Unknown result type (might be due to invalid IL or missing references)
			//IL_0021: Expected O, but got Unknown
			panelIndex = new Panel();
			numericUpDownIndex = new NumericUpDown();
			lblIndex = new Label();
			((Control)panelIndex).SuspendLayout();
			((ISupportInitialize)numericUpDownIndex).BeginInit();
			((Control)this).SuspendLayout();
			((Control)panelIndex).Controls.Add((Control)(object)numericUpDownIndex);
			((Control)panelIndex).Controls.Add((Control)(object)lblIndex);
			((Control)panelIndex).Dock = (DockStyle)4;
			((ScrollableControl)panelIndex).DockPadding.Right = 10;
			((ScrollableControl)panelIndex).DockPadding.Top = 10;
			((Control)panelIndex).Location = new Point(200, 0);
			((Control)panelIndex).Name = "panelIndex";
			((Control)panelIndex).Size = new Size(136, 280);
			((Control)panelIndex).TabIndex = 0;
			((Control)numericUpDownIndex).Location = new Point(56, 0);
			((Control)numericUpDownIndex).Name = "numericUpDownIndex";
			((Control)numericUpDownIndex).Size = new Size(72, 20);
			((Control)numericUpDownIndex).TabIndex = 1;
			((Control)lblIndex).AutoSize = true;
			((Control)lblIndex).Location = new Point(8, 0);
			((Control)lblIndex).Name = "lblIndex";
			((Control)lblIndex).Size = new Size(32, 16);
			((Control)lblIndex).TabIndex = 0;
			((Control)lblIndex).Text = "Index";
			((Control)this).Controls.Add((Control)(object)panelIndex);
			((Control)this).Name = "StructureArrayView";
			((Control)this).Size = new Size(336, 280);
			((Control)panelIndex).ResumeLayout(false);
			((ISupportInitialize)numericUpDownIndex).EndInit();
			((Control)this).ResumeLayout(false);
		}

		protected override void InitializeView()
		{
			base.InitializeView();
			if (controller.Model.DataSource.Connected && numericUpDownIndex != null)
			{
				((Control)numericUpDownIndex).Dock = (DockStyle)4;
				((Control)numericUpDownIndex).Width = 50;
				((Control)lblIndex).Top = ((Control)numericUpDownIndex).Top;
				((Control)lblIndex).Left = ((Control)numericUpDownIndex).Left - ((Control)lblIndex).Width - 10;
				((Control)panelIndex).Dock = (DockStyle)4;
				numericUpDownIndex.ValueChanged += OnIndexChanged;
				numericUpDownIndex.Minimum = 0m;
				if ((controller.Model.ParameterModel as IStructureArrayModel).Count - 1 > 0)
				{
					numericUpDownIndex.Maximum = (controller.Model.ParameterModel as IStructureArrayModel).Count - 1;
					return;
				}
				numericUpDownIndex.Maximum = 0m;
				((Control)numericUpDownIndex).Enabled = false;
				EventLogger.Info("Editor", "The element length for the array of structure: " + (controller.Model.ParameterModel as IStructureArrayModel).Name.ToString() + " is zero");
			}
		}

		private void OnIndexChanged(object sender, EventArgs e)
		{
			try
			{
				Cursor.Current = Cursors.WaitCursor;
				(controller.Model.ParameterModel as IStructureArrayModel).Index = int.Parse(numericUpDownIndex.Value.ToString());
			}
			finally
			{
				Cursor.Current = Cursors.Default;
			}
		}
	}
}
namespace Cummins.Editor
{
	public class MonitoredStructureArrayView : StructureArrayView
	{
		private new MonitoredStructureArrayController controller;

		public event KeyEventHandler GridKeyDown
		{
			add
			{
				base.Grid.GridKeyDown += value;
			}
			remove
			{
				base.Grid.GridKeyDown -= value;
			}
		}

		public MonitoredStructureArrayView(MonitoredStructureArrayController controller, Font font)
			: base(controller, font)
		{
			this.controller = controller;
		}
	}
	public class MonitoredStructureController : GroupController
	{
		private const string StructureLoadingMessageFormat = "Cannot start monitoring {0} ";

		private const string StructureLoadingDetailedMessage = "The structure does not have any members. This might be a dynamic type parameter. Try connecting directly in online mode for monitoring/editing";

		private IAddressValue currentSourceAddress;

		private MonitoredStructureModel model;

		private IGroupModel valueConverter;

		public bool ShowComments
		{
			get
			{
				return model.ShowComments;
			}
			set
			{
				if (model.ShowComments != value)
				{
					model.ShowComments = value;
				}
			}
		}

		public bool ValueEnabled
		{
			get
			{
				return model.ValueEnabled;
			}
			set
			{
				model.ValueEnabled = value;
			}
		}

		public DataFormat Radix
		{
			get
			{
				return model.Radix;
			}
			set
			{
				if (base.DisplayFormat != value)
				{
					model.Radix = value;
					DataMode(value);
				}
			}
		}

		public IAddressValue CurrentSourceAddress
		{
			get
			{
				return currentSourceAddress;
			}
			set
			{
				currentSourceAddress = value;
			}
		}

		protected IGroupModel ParameterModel => model.ParameterModel as IGroupModel;

		public MonitoredStructureController(MonitoredStructureModel model)
			: base(model)
		{
			this.model = model;
			Initialize();
			this.model.DataSource.SaveChangesEvent += OnSaveChangesEvent;
		}

		public override void Reload()
		{
			if (base.Model.Members.Count == 0)
			{
				string message = $"Cannot start monitoring {base.Model.Name} ";
				EventLogger.Error("Editor", message, "The structure does not have any members. This might be a dynamic type parameter. Try connecting directly in online mode for monitoring/editing");
			}
			else
			{
				base.Reload();
				Initialize();
			}
		}

		public void Refresh(DataRefreshEventArgs e)
		{
			if (e != null)
			{
				switch (e.DataSourceType)
				{
				case DataSourceTypeEnum.ECM:
					Refresh(e as ECMDataRefreshEventArgs);
					break;
				case DataSourceTypeEnum.Disk:
					Refresh(e as DiskDataRefreshEventArgs);
					break;
				case DataSourceTypeEnum.ASAM:
					break;
				}
			}
		}

		private void Refresh(ECMDataRefreshEventArgs e)
		{
			if (e.IsProcessed)
			{
				return;
			}
			try
			{
				ArrayList eCMData = e.ECMData;
				base.EnableChangeEvents = false;
				for (int i = 0; i < eCMData.Count; i++)
				{
					ICIDataElementNotification iCIDataElementNotification = (ICIDataElementNotification)eCMData[i];
					if (iCIDataElementNotification.Status == tagCIDMStatusEnum.DM_STATUS_OK && iCIDataElementNotification.Changed)
					{
						((valueConverter as IEntityModel).CalEntity as ICICalAddressableEntity).RawData = iCIDataElementNotification.RawData;
						Refresh(valueConverter);
					}
				}
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
		}

		private void Refresh(IGroupModel sourceValue)
		{
			lock (Data)
			{
				foreach (DataRow row in Data.Rows)
				{
					IParameterModel parameterModel = (IParameterModel)sourceValue.Members[row["Name"].ToString()];
					if (parameterModel != null && (parameterModel.DataType == ParameterType.Value || parameterModel.DataType == ParameterType.Enumeration))
					{
						IValueModel valueModel = (IValueModel)parameterModel;
						row["Value"] = GetValueByDataFormat(valueModel);
					}
				}
			}
		}

		private void Refresh(DiskDataRefreshEventArgs e)
		{
			try
			{
				SortedList diskData = e.DiskData;
				base.EnableChangeEvents = false;
				for (int i = 0; i < diskData.Count; i++)
				{
					IParameterModel parameterModel = (IParameterModel)diskData.GetByIndex(i);
					Refresh(parameterModel as IGroupModel);
				}
			}
			finally
			{
				base.EnableChangeEvents = true;
			}
		}

		public virtual void SaveSession(NewDataSet.ScreenRow screenRow)
		{
			ScreenDataSaver screenDataSaver = new ScreenDataSaver();
			NewDataSet.GroupRow groupRow = screenDataSaver.SaveSession(screenRow);
			model.SaveSession(groupRow);
			((NewDataSet)screenRow.Table.DataSet).Group.AddGroupRow(groupRow);
			screenDataSaver.PopulateParameterTableRows(groupRow, MetaDataTable);
			ParameterModel.IsDirty = false;
		}

		public virtual void CleanupResources()
		{
			model.DataSource.SaveChangesEvent -= OnSaveChangesEvent;
			Data.Clear();
		}

		private void OnSaveChangesEvent(object sender, EventArgs e)
		{
			Data.AcceptChanges();
			(ParameterModel as IEntityModel).UpdateRevertValue();
			RaiseAllCellsUnmodifiedEvent();
		}

		private void Initialize()
		{
			if (model.DataSource.Connected && valueConverter == null)
			{
				lock (model.DataSource)
				{
					bool cacheEnabled = model.DataSource.CacheEnabled;
					model.DataSource.CacheEnabled = false;
					valueConverter = (IGroupModel)model.DataSource.Get(ParameterModel.FullName);
					model.DataSource.CacheEnabled = cacheEnabled;
				}
				valueConverter.CacheMode = Cummins.Interop.CalDataServer.tagCICacheMode.readWrite;
			}
		}
	}
	public class MonitoredStructureModel : MonitoredGroupModel
	{
		private bool isChanged = true;

		private bool showComments = true;

		private DataFormat radix;

		private bool valueEnabled = true;

		public new bool ShowComments
		{
			get
			{
				return showComments;
			}
			set
			{
				showComments = value;
				RaiseChangeShowCommentsEvent(showComments);
			}
		}

		public new bool ValueEnabled
		{
			get
			{
				return valueEnabled;
			}
			set
			{
				valueEnabled = value;
				RaiseChangeValueEnabledEvent(value);
			}
		}

		public new DataFormat Radix
		{
			get
			{
				return radix;
			}
			set
			{
				radix = value;
			}
		}

		public override SortedList Members => (base.ParameterModel as IGroupModel).Members;

		public override string Name
		{
			get
			{
				return base.ParameterModel.Name;
			}
			set
			{
			}
		}

		public override string Comment
		{
			get
			{
				return base.ParameterModel.Comment;
			}
			set
			{
			}
		}

		public new virtual bool IsDirty
		{
			get
			{
				return base.ParameterModel.IsDirty;
			}
			set
			{
				base.ParameterModel.IsDirty = value;
			}
		}

		public new event EventHandler ChangeShowCommentsState;

		public new event StateChangedEventHandler ChangeValueEnabled;

		public MonitoredStructureModel(IParameterModel parameterModel)
		{
			base.DataType = ParameterType.Structure;
			base.ParameterModel = parameterModel;
			base.DataSource = parameterModel.DataSource;
		}

		public new void Restore(NewDataSet.GroupRow groupRow)
		{
			try
			{
				Name = groupRow.Name;
				Comment = groupRow.Comment;
			}
			catch
			{
			}
		}

		public new void SaveSession(NewDataSet.GroupRow groupRow)
		{
			groupRow.Name = Name;
			groupRow.Comment = Comment;
		}

		public new void RaiseChangeValueEnabledEvent(bool enable)
		{
			if (this.ChangeValueEnabled != null)
			{
				this.ChangeValueEnabled(this, new BooleanStateEventArgs(enable));
			}
		}

		public new void RaiseChangeShowCommentsEvent(bool show)
		{
			if (this.ChangeShowCommentsState != null)
			{
				this.ChangeShowCommentsState(this, EventArgs.Empty);
			}
		}
	}
	public class MonitoredStructureView : GroupDataView
	{
		private new MonitoredStructureController controller;

		public event KeyEventHandler GridKeyDown
		{
			add
			{
				base.Grid.GridKeyDown += value;
			}
			remove
			{
				base.Grid.GridKeyDown -= value;
			}
		}

		public MonitoredStructureView(MonitoredStructureController controller, Font font)
			: base(controller, font)
		{
			this.controller = controller;
		}
	}
	public class MonitorModeEventArgs : EventArgs
	{
		private DataAcquisitionType mode;

		public DataAcquisitionType Mode => mode;

		public bool IsRequestReceive => Mode == DataAcquisitionType.RequestReceive;

		public bool IsBAM => Mode == DataAcquisitionType.BAM;

		public bool IsIDL => Mode == DataAcquisitionType.IDL;

		public bool IsBAMorIDL => Mode != DataAcquisitionType.RequestReceive;

		public bool IsEDM => Mode == DataAcquisitionType.EDM;

		public MonitorModeEventArgs(DataAcquisitionType mode)
		{
			this.mode = mode;
		}
	}
	public class ScreenLoadingFailedEventArgs : EventArgs
	{
		private string errorMessgae = string.Empty;

		public string ErrorMessage => errorMessgae;

		public ScreenLoadingFailedEventArgs(string errorMessgae)
		{
			this.errorMessgae = errorMessgae;
		}
	}
	[Serializable]
	[ToolboxItem(true)]
	[XmlSchemaProvider("GetTypedDataSetSchema")]
	[XmlRoot("NewDataSet")]
	[HelpKeyword("vs.data.DataSet")]
	[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
	[DesignerCategory("code")]
	public class NewDataSet : DataSet
	{
		public delegate void MonitorSessionRowChangeEventHandler(object sender, MonitorSessionRowChangeEvent e);

		public delegate void ScreenRowChangeEventHandler(object sender, ScreenRowChangeEvent e);

		public delegate void GroupRowChangeEventHandler(object sender, GroupRowChangeEvent e);

		public delegate void ParameterRowChangeEventHandler(object sender, ParameterRowChangeEvent e);

		public delegate void ParameterYAxisRowChangeEventHandler(object sender, ParameterYAxisRowChangeEvent e);

		public delegate void GaugeConfigurationRowChangeEventHandler(object sender, GaugeConfigurationRowChangeEvent e);

		public delegate void GaugeRowChangeEventHandler(object sender, GaugeRowChangeEvent e);

		public delegate void GraphConfigurationRowChangeEventHandler(object sender, GraphConfigurationRowChangeEvent e);

		public delegate void GeneralRowChangeEventHandler(object sender, GeneralRowChangeEvent e);

		public delegate void XAxisRowChangeEventHandler(object sender, XAxisRowChangeEvent e);

		public delegate void YAxesRowChangeEventHandler(object sender, YAxesRowChangeEvent e);

		[Serializable]
		[XmlSchemaProvider("GetTypedTableSchema")]
		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class MonitorSessionDataTable : DataTable, IEnumerable
		{
			private DataColumn columnVersion;

			private DataColumn columnActiveScreen;

			private DataColumn columnDotnetbarlayouts;

			private DataColumn columnMonitorSession_Id;

			[DebuggerNonUserCode]
			public DataColumn VersionColumn => columnVersion;

			[DebuggerNonUserCode]
			public DataColumn ActiveScreenColumn => columnActiveScreen;

			[DebuggerNonUserCode]
			public DataColumn DotnetbarlayoutsColumn => columnDotnetbarlayouts;

			[DebuggerNonUserCode]
			public DataColumn MonitorSession_IdColumn => columnMonitorSession_Id;

			[DebuggerNonUserCode]
			[Browsable(false)]
			public int Count => base.Rows.Count;

			[DebuggerNonUserCode]
			public MonitorSessionRow this[int index] => (MonitorSessionRow)base.Rows[index];

			public event MonitorSessionRowChangeEventHandler MonitorSessionRowChanging;

			public event MonitorSessionRowChangeEventHandler MonitorSessionRowChanged;

			public event MonitorSessionRowChangeEventHandler MonitorSessionRowDeleting;

			public event MonitorSessionRowChangeEventHandler MonitorSessionRowDeleted;

			[DebuggerNonUserCode]
			public MonitorSessionDataTable()
			{
				base.TableName = "MonitorSession";
				BeginInit();
				InitClass();
				EndInit();
			}

			[DebuggerNonUserCode]
			internal MonitorSessionDataTable(DataTable table)
			{
				base.TableName = table.TableName;
				if (table.CaseSensitive != table.DataSet.CaseSensitive)
				{
					base.CaseSensitive = table.CaseSensitive;
				}
				if (table.Locale.ToString() != table.DataSet.Locale.ToString())
				{
					base.Locale = table.Locale;
				}
				if (table.Namespace != table.DataSet.Namespace)
				{
					base.Namespace = table.Namespace;
				}
				base.Prefix = table.Prefix;
				base.MinimumCapacity = table.MinimumCapacity;
			}

			[DebuggerNonUserCode]
			protected MonitorSessionDataTable(SerializationInfo info, StreamingContext context)
				: base(info, context)
			{
				InitVars();
			}

			[DebuggerNonUserCode]
			public void AddMonitorSessionRow(MonitorSessionRow row)
			{
				base.Rows.Add(row);
			}

			[DebuggerNonUserCode]
			public MonitorSessionRow AddMonitorSessionRow(string Version, string ActiveScreen, string Dotnetbarlayouts)
			{
				MonitorSessionRow monitorSessionRow = (MonitorSessionRow)NewRow();
				monitorSessionRow.ItemArray = new object[4] { Version, ActiveScreen, Dotnetbarlayouts, null };
				base.Rows.Add(monitorSessionRow);
				return monitorSessionRow;
			}

			[DebuggerNonUserCode]
			public virtual IEnumerator GetEnumerator()
			{
				return base.Rows.GetEnumerator();
			}

			[DebuggerNonUserCode]
			public override DataTable Clone()
			{
				MonitorSessionDataTable monitorSessionDataTable = (MonitorSessionDataTable)base.Clone();
				monitorSessionDataTable.InitVars();
				return monitorSessionDataTable;
			}

			[DebuggerNonUserCode]
			protected override DataTable CreateInstance()
			{
				return new MonitorSessionDataTable();
			}

			[DebuggerNonUserCode]
			internal void InitVars()
			{
				columnVersion = base.Columns["Version"];
				columnActiveScreen = base.Columns["ActiveScreen"];
				columnDotnetbarlayouts = base.Columns["Dotnetbarlayouts"];
				columnMonitorSession_Id = base.Columns["MonitorSession_Id"];
			}

			[DebuggerNonUserCode]
			private void InitClass()
			{
				columnVersion = new DataColumn("Version", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnVersion);
				columnActiveScreen = new DataColumn("ActiveScreen", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnActiveScreen);
				columnDotnetbarlayouts = new DataColumn("Dotnetbarlayouts", typeof(string), null, MappingType.Element);
				base.Columns.Add(columnDotnetbarlayouts);
				columnMonitorSession_Id = new DataColumn("MonitorSession_Id", typeof(int), null, MappingType.Hidden);
				base.Columns.Add(columnMonitorSession_Id);
				base.Constraints.Add(new UniqueConstraint("Constraint1", new DataColumn[1] { columnMonitorSession_Id }, isPrimaryKey: true));
				columnVersion.AllowDBNull = false;
				columnVersion.Namespace = "";
				columnActiveScreen.Namespace = "";
				columnMonitorSession_Id.AutoIncrement = true;
				columnMonitorSession_Id.AllowDBNull = false;
				columnMonitorSession_Id.Unique = true;
			}

			[DebuggerNonUserCode]
			public MonitorSessionRow NewMonitorSessionRow()
			{
				return (MonitorSessionRow)NewRow();
			}

			[DebuggerNonUserCode]
			protected override DataRow NewRowFromBuilder(DataRowBuilder builder)
			{
				return new MonitorSessionRow(builder);
			}

			[DebuggerNonUserCode]
			protected override Type GetRowType()
			{
				return typeof(MonitorSessionRow);
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanged(DataRowChangeEventArgs e)
			{
				base.OnRowChanged(e);
				if (this.MonitorSessionRowChanged != null)
				{
					this.MonitorSessionRowChanged(this, new MonitorSessionRowChangeEvent((MonitorSessionRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanging(DataRowChangeEventArgs e)
			{
				base.OnRowChanging(e);
				if (this.MonitorSessionRowChanging != null)
				{
					this.MonitorSessionRowChanging(this, new MonitorSessionRowChangeEvent((MonitorSessionRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleted(DataRowChangeEventArgs e)
			{
				base.OnRowDeleted(e);
				if (this.MonitorSessionRowDeleted != null)
				{
					this.MonitorSessionRowDeleted(this, new MonitorSessionRowChangeEvent((MonitorSessionRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleting(DataRowChangeEventArgs e)
			{
				base.OnRowDeleting(e);
				if (this.MonitorSessionRowDeleting != null)
				{
					this.MonitorSessionRowDeleting(this, new MonitorSessionRowChangeEvent((MonitorSessionRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			public void RemoveMonitorSessionRow(MonitorSessionRow row)
			{
				base.Rows.Remove(row);
			}

			[DebuggerNonUserCode]
			public static XmlSchemaComplexType GetTypedTableSchema(XmlSchemaSet xs)
			{
				//IL_0000: Unknown result type (might be due to invalid IL or missing references)
				//IL_0006: Expected O, but got Unknown
				//IL_0006: Unknown result type (might be due to invalid IL or missing references)
				//IL_000c: Expected O, but got Unknown
				//IL_001f: Unknown result type (might be due to invalid IL or missing references)
				//IL_0025: Expected O, but got Unknown
				//IL_0060: Unknown result type (might be due to invalid IL or missing references)
				//IL_0067: Expected O, but got Unknown
				//IL_0096: Unknown result type (might be due to invalid IL or missing references)
				//IL_009d: Expected O, but got Unknown
				//IL_00c4: Unknown result type (might be due to invalid IL or missing references)
				//IL_00cb: Expected O, but got Unknown
				XmlSchemaComplexType val = new XmlSchemaComplexType();
				XmlSchemaSequence val2 = new XmlSchemaSequence();
				NewDataSet newDataSet = new NewDataSet();
				xs.Add(newDataSet.GetSchemaSerializable());
				XmlSchemaAny val3 = new XmlSchemaAny();
				val3.Namespace = "http://www.w3.org/2001/XMLSchema";
				((XmlSchemaParticle)val3).MinOccurs = 0m;
				((XmlSchemaParticle)val3).MaxOccurs = decimal.MaxValue;
				val3.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val3);
				XmlSchemaAny val4 = new XmlSchemaAny();
				val4.Namespace = "urn:schemas-microsoft-com:xml-diffgram-v1";
				((XmlSchemaParticle)val4).MinOccurs = 1m;
				val4.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val4);
				XmlSchemaAttribute val5 = new XmlSchemaAttribute();
				val5.Name = "namespace";
				val5.FixedValue = newDataSet.Namespace;
				val.Attributes.Add((XmlSchemaObject)(object)val5);
				XmlSchemaAttribute val6 = new XmlSchemaAttribute();
				val6.Name = "tableTypeName";
				val6.FixedValue = "MonitorSessionDataTable";
				val.Attributes.Add((XmlSchemaObject)(object)val6);
				val.Particle = (XmlSchemaParticle)(object)val2;
				return val;
			}
		}

		[Serializable]
		[XmlSchemaProvider("GetTypedTableSchema")]
		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class ScreenDataTable : DataTable, IEnumerable
		{
			private DataColumn columnName;

			private DataColumn columnTitle;

			private DataColumn columnDataRefreshRate;

			private DataColumn columnBAMRefreshRate;

			private DataColumn columnIDLRefreshRate;

			private DataColumn columnUIRefreshRate;

			private DataColumn columnEDMRefreshRate;

			private DataColumn columnDataRefreshUnits;

			private DataColumn columnUIRefreshUnits;

			private DataColumn columnMonitorType;

			private DataColumn columnBAMTrigger;

			private DataColumn columnIDLTrigger;

			private DataColumn columnRadix;

			private DataColumn columnScreenType;

			private DataColumn columnStatus;

			private DataColumn columnLogMode;

			private DataColumn columnLogRate;

			private DataColumn columnLogUnit;

			private DataColumn columnLogPrefix;

			private DataColumn columnPCTimestamp;

			private DataColumn columnActiveFaults;

			private DataColumn columnInactiveFaults;

			private DataColumn columnStartCondition;

			private DataColumn columnStopCondition;

			private DataColumn columnPreTrigger;

			private DataColumn columnPostTrigger;

			private DataColumn columnRepeatCount;

			private DataColumn columnPositionX;

			private DataColumn columnPositionY;

			private DataColumn columnHeight;

			private DataColumn columnWidth;

			private DataColumn columnDock;

			private DataColumn columnScreen_Id;

			private DataColumn columnMonitorSession_Id;

			[DebuggerNonUserCode]
			public DataColumn NameColumn => columnName;

			[DebuggerNonUserCode]
			public DataColumn TitleColumn => columnTitle;

			[DebuggerNonUserCode]
			public DataColumn DataRefreshRateColumn => columnDataRefreshRate;

			[DebuggerNonUserCode]
			public DataColumn BAMRefreshRateColumn => columnBAMRefreshRate;

			[DebuggerNonUserCode]
			public DataColumn IDLRefreshRateColumn => columnIDLRefreshRate;

			[DebuggerNonUserCode]
			public DataColumn UIRefreshRateColumn => columnUIRefreshRate;

			[DebuggerNonUserCode]
			public DataColumn EDMRefreshRateColumn => columnEDMRefreshRate;

			[DebuggerNonUserCode]
			public DataColumn DataRefreshUnitsColumn => columnDataRefreshUnits;

			[DebuggerNonUserCode]
			public DataColumn UIRefreshUnitsColumn => columnUIRefreshUnits;

			[DebuggerNonUserCode]
			public DataColumn MonitorTypeColumn => columnMonitorType;

			[DebuggerNonUserCode]
			public DataColumn BAMTriggerColumn => columnBAMTrigger;

			[DebuggerNonUserCode]
			public DataColumn IDLTriggerColumn => columnIDLTrigger;

			[DebuggerNonUserCode]
			public DataColumn RadixColumn => columnRadix;

			[DebuggerNonUserCode]
			public DataColumn ScreenTypeColumn => columnScreenType;

			[DebuggerNonUserCode]
			public DataColumn StatusColumn => columnStatus;

			[DebuggerNonUserCode]
			public DataColumn LogModeColumn => columnLogMode;

			[DebuggerNonUserCode]
			public DataColumn LogRateColumn => columnLogRate;

			[DebuggerNonUserCode]
			public DataColumn LogUnitColumn => columnLogUnit;

			[DebuggerNonUserCode]
			public DataColumn LogPrefixColumn => columnLogPrefix;

			[DebuggerNonUserCode]
			public DataColumn PCTimestampColumn => columnPCTimestamp;

			[DebuggerNonUserCode]
			public DataColumn ActiveFaultsColumn => columnActiveFaults;

			[DebuggerNonUserCode]
			public DataColumn InactiveFaultsColumn => columnInactiveFaults;

			[DebuggerNonUserCode]
			public DataColumn StartConditionColumn => columnStartCondition;

			[DebuggerNonUserCode]
			public DataColumn StopConditionColumn => columnStopCondition;

			[DebuggerNonUserCode]
			public DataColumn PreTriggerColumn => columnPreTrigger;

			[DebuggerNonUserCode]
			public DataColumn PostTriggerColumn => columnPostTrigger;

			[DebuggerNonUserCode]
			public DataColumn RepeatCountColumn => columnRepeatCount;

			[DebuggerNonUserCode]
			public DataColumn PositionXColumn => columnPositionX;

			[DebuggerNonUserCode]
			public DataColumn PositionYColumn => columnPositionY;

			[DebuggerNonUserCode]
			public DataColumn HeightColumn => columnHeight;

			[DebuggerNonUserCode]
			public DataColumn WidthColumn => columnWidth;

			[DebuggerNonUserCode]
			public DataColumn DockColumn => columnDock;

			[DebuggerNonUserCode]
			public DataColumn Screen_IdColumn => columnScreen_Id;

			[DebuggerNonUserCode]
			public DataColumn MonitorSession_IdColumn => columnMonitorSession_Id;

			[DebuggerNonUserCode]
			[Browsable(false)]
			public int Count => base.Rows.Count;

			[DebuggerNonUserCode]
			public ScreenRow this[int index] => (ScreenRow)base.Rows[index];

			public event ScreenRowChangeEventHandler ScreenRowChanging;

			public event ScreenRowChangeEventHandler ScreenRowChanged;

			public event ScreenRowChangeEventHandler ScreenRowDeleting;

			public event ScreenRowChangeEventHandler ScreenRowDeleted;

			[DebuggerNonUserCode]
			public ScreenDataTable()
			{
				base.TableName = "Screen";
				BeginInit();
				InitClass();
				EndInit();
			}

			[DebuggerNonUserCode]
			internal ScreenDataTable(DataTable table)
			{
				base.TableName = table.TableName;
				if (table.CaseSensitive != table.DataSet.CaseSensitive)
				{
					base.CaseSensitive = table.CaseSensitive;
				}
				if (table.Locale.ToString() != table.DataSet.Locale.ToString())
				{
					base.Locale = table.Locale;
				}
				if (table.Namespace != table.DataSet.Namespace)
				{
					base.Namespace = table.Namespace;
				}
				base.Prefix = table.Prefix;
				base.MinimumCapacity = table.MinimumCapacity;
			}

			[DebuggerNonUserCode]
			protected ScreenDataTable(SerializationInfo info, StreamingContext context)
				: base(info, context)
			{
				InitVars();
			}

			[DebuggerNonUserCode]
			public void AddScreenRow(ScreenRow row)
			{
				base.Rows.Add(row);
			}

			[DebuggerNonUserCode]
			public ScreenRow AddScreenRow(string Name, string Title, ushort DataRefreshRate, ushort BAMRefreshRate, ushort IDLRefreshRate, ushort UIRefreshRate, ushort EDMRefreshRate, string DataRefreshUnits, string UIRefreshUnits, string MonitorType, string BAMTrigger, string IDLTrigger, string Radix, string ScreenType, string Status, string LogMode, int LogRate, string LogUnit, string LogPrefix, bool PCTimestamp, bool ActiveFaults, bool InactiveFaults, string StartCondition, string StopCondition, int PreTrigger, int PostTrigger, int RepeatCount, int PositionX, int PositionY, int Height, int Width, string Dock, MonitorSessionRow parentMonitorSessionRowByMonitorSession_Screen)
			{
				ScreenRow screenRow = (ScreenRow)NewRow();
				screenRow.ItemArray = new object[34]
				{
					Name,
					Title,
					DataRefreshRate,
					BAMRefreshRate,
					IDLRefreshRate,
					UIRefreshRate,
					EDMRefreshRate,
					DataRefreshUnits,
					UIRefreshUnits,
					MonitorType,
					BAMTrigger,
					IDLTrigger,
					Radix,
					ScreenType,
					Status,
					LogMode,
					LogRate,
					LogUnit,
					LogPrefix,
					PCTimestamp,
					ActiveFaults,
					InactiveFaults,
					StartCondition,
					StopCondition,
					PreTrigger,
					PostTrigger,
					RepeatCount,
					PositionX,
					PositionY,
					Height,
					Width,
					Dock,
					null,
					parentMonitorSessionRowByMonitorSession_Screen[3]
				};
				base.Rows.Add(screenRow);
				return screenRow;
			}

			[DebuggerNonUserCode]
			public virtual IEnumerator GetEnumerator()
			{
				return base.Rows.GetEnumerator();
			}

			[DebuggerNonUserCode]
			public override DataTable Clone()
			{
				ScreenDataTable screenDataTable = (ScreenDataTable)base.Clone();
				screenDataTable.InitVars();
				return screenDataTable;
			}

			[DebuggerNonUserCode]
			protected override DataTable CreateInstance()
			{
				return new ScreenDataTable();
			}

			[DebuggerNonUserCode]
			internal void InitVars()
			{
				columnName = base.Columns["Name"];
				columnTitle = base.Columns["Title"];
				columnDataRefreshRate = base.Columns["DataRefreshRate"];
				columnBAMRefreshRate = base.Columns["BAMRefreshRate"];
				columnIDLRefreshRate = base.Columns["IDLRefreshRate"];
				columnUIRefreshRate = base.Columns["UIRefreshRate"];
				columnEDMRefreshRate = base.Columns["EDMRefreshRate"];
				columnDataRefreshUnits = base.Columns["DataRefreshUnits"];
				columnUIRefreshUnits = base.Columns["UIRefreshUnits"];
				columnMonitorType = base.Columns["MonitorType"];
				columnBAMTrigger = base.Columns["BAMTrigger"];
				columnIDLTrigger = base.Columns["IDLTrigger"];
				columnRadix = base.Columns["Radix"];
				columnScreenType = base.Columns["ScreenType"];
				columnStatus = base.Columns["Status"];
				columnLogMode = base.Columns["LogMode"];
				columnLogRate = base.Columns["LogRate"];
				columnLogUnit = base.Columns["LogUnit"];
				columnLogPrefix = base.Columns["LogPrefix"];
				columnPCTimestamp = base.Columns["PCTimestamp"];
				columnActiveFaults = base.Columns["ActiveFaults"];
				columnInactiveFaults = base.Columns["InactiveFaults"];
				columnStartCondition = base.Columns["StartCondition"];
				columnStopCondition = base.Columns["StopCondition"];
				columnPreTrigger = base.Columns["PreTrigger"];
				columnPostTrigger = base.Columns["PostTrigger"];
				columnRepeatCount = base.Columns["RepeatCount"];
				columnPositionX = base.Columns["PositionX"];
				columnPositionY = base.Columns["PositionY"];
				columnHeight = base.Columns["Height"];
				columnWidth = base.Columns["Width"];
				columnDock = base.Columns["Dock"];
				columnScreen_Id = base.Columns["Screen_Id"];
				columnMonitorSession_Id = base.Columns["MonitorSession_Id"];
			}

			[DebuggerNonUserCode]
			private void InitClass()
			{
				columnName = new DataColumn("Name", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnName);
				columnTitle = new DataColumn("Title", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnTitle);
				columnDataRefreshRate = new DataColumn("DataRefreshRate", typeof(ushort), null, MappingType.Attribute);
				base.Columns.Add(columnDataRefreshRate);
				columnBAMRefreshRate = new DataColumn("BAMRefreshRate", typeof(ushort), null, MappingType.Attribute);
				base.Columns.Add(columnBAMRefreshRate);
				columnIDLRefreshRate = new DataColumn("IDLRefreshRate", typeof(ushort), null, MappingType.Attribute);
				base.Columns.Add(columnIDLRefreshRate);
				columnUIRefreshRate = new DataColumn("UIRefreshRate", typeof(ushort), null, MappingType.Attribute);
				base.Columns.Add(columnUIRefreshRate);
				columnEDMRefreshRate = new DataColumn("EDMRefreshRate", typeof(ushort), null, MappingType.Attribute);
				base.Columns.Add(columnEDMRefreshRate);
				columnDataRefreshUnits = new DataColumn("DataRefreshUnits", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnDataRefreshUnits);
				columnUIRefreshUnits = new DataColumn("UIRefreshUnits", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnUIRefreshUnits);
				columnMonitorType = new DataColumn("MonitorType", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnMonitorType);
				columnBAMTrigger = new DataColumn("BAMTrigger", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnBAMTrigger);
				columnIDLTrigger = new DataColumn("IDLTrigger", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnIDLTrigger);
				columnRadix = new DataColumn("Radix", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnRadix);
				columnScreenType = new DataColumn("ScreenType", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnScreenType);
				columnStatus = new DataColumn("Status", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnStatus);
				columnLogMode = new DataColumn("LogMode", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnLogMode);
				columnLogRate = new DataColumn("LogRate", typeof(int), null, MappingType.Attribute);
				base.Columns.Add(columnLogRate);
				columnLogUnit = new DataColumn("LogUnit", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnLogUnit);
				columnLogPrefix = new DataColumn("LogPrefix", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnLogPrefix);
				columnPCTimestamp = new DataColumn("PCTimestamp", typeof(bool), null, MappingType.Attribute);
				base.Columns.Add(columnPCTimestamp);
				columnActiveFaults = new DataColumn("ActiveFaults", typeof(bool), null, MappingType.Attribute);
				base.Columns.Add(columnActiveFaults);
				columnInactiveFaults = new DataColumn("InactiveFaults", typeof(bool), null, MappingType.Attribute);
				base.Columns.Add(columnInactiveFaults);
				columnStartCondition = new DataColumn("StartCondition", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnStartCondition);
				columnStopCondition = new DataColumn("StopCondition", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnStopCondition);
				columnPreTrigger = new DataColumn("PreTrigger", typeof(int), null, MappingType.Attribute);
				base.Columns.Add(columnPreTrigger);
				columnPostTrigger = new DataColumn("PostTrigger", typeof(int), null, MappingType.Attribute);
				base.Columns.Add(columnPostTrigger);
				columnRepeatCount = new DataColumn("RepeatCount", typeof(int), null, MappingType.Attribute);
				base.Columns.Add(columnRepeatCount);
				columnPositionX = new DataColumn("PositionX", typeof(int), null, MappingType.Attribute);
				base.Columns.Add(columnPositionX);
				columnPositionY = new DataColumn("PositionY", typeof(int), null, MappingType.Attribute);
				base.Columns.Add(columnPositionY);
				columnHeight = new DataColumn("Height", typeof(int), null, MappingType.Attribute);
				base.Columns.Add(columnHeight);
				columnWidth = new DataColumn("Width", typeof(int), null, MappingType.Attribute);
				base.Columns.Add(columnWidth);
				columnDock = new DataColumn("Dock", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnDock);
				columnScreen_Id = new DataColumn("Screen_Id", typeof(int), null, MappingType.Hidden);
				base.Columns.Add(columnScreen_Id);
				columnMonitorSession_Id = new DataColumn("MonitorSession_Id", typeof(int), null, MappingType.Hidden);
				base.Columns.Add(columnMonitorSession_Id);
				base.Constraints.Add(new UniqueConstraint("Constraint1", new DataColumn[1] { columnScreen_Id }, isPrimaryKey: true));
				columnName.Namespace = "";
				columnTitle.Namespace = "";
				columnDataRefreshRate.Namespace = "";
				columnBAMRefreshRate.Namespace = "";
				columnIDLRefreshRate.Namespace = "";
				columnUIRefreshRate.Namespace = "";
				columnEDMRefreshRate.Namespace = "";
				columnDataRefreshUnits.Namespace = "";
				columnDataRefreshUnits.DefaultValue = "Milliseconds";
				columnUIRefreshUnits.Namespace = "";
				columnUIRefreshUnits.DefaultValue = "Milliseconds";
				columnMonitorType.Namespace = "";
				columnMonitorType.DefaultValue = "RequestReceive";
				columnBAMTrigger.Namespace = "";
				columnBAMTrigger.DefaultValue = "Clock";
				columnIDLTrigger.Namespace = "";
				columnIDLTrigger.DefaultValue = "Clock";
				columnRadix.Namespace = "";
				columnRadix.DefaultValue = "Decimal";
				columnScreenType.Namespace = "";
				columnScreenType.DefaultValue = "Normal";
				columnStatus.Namespace = "";
				columnStatus.DefaultValue = "Inactive";
				columnLogMode.Namespace = "";
				columnLogMode.DefaultValue = "Any Data";
				columnLogRate.Namespace = "";
				columnLogRate.DefaultValue = 1;
				columnLogUnit.Namespace = "";
				columnLogUnit.DefaultValue = "ms";
				columnLogPrefix.Namespace = "";
				columnLogPrefix.DefaultValue = "";
				columnPCTimestamp.Namespace = "";
				columnPCTimestamp.DefaultValue = false;
				columnActiveFaults.Namespace = "";
				columnActiveFaults.DefaultValue = false;
				columnInactiveFaults.Namespace = "";
				columnInactiveFaults.DefaultValue = false;
				columnStartCondition.Namespace = "";
				columnStartCondition.DefaultValue = "";
				columnStopCondition.Namespace = "";
				columnStopCondition.DefaultValue = "";
				columnPreTrigger.Namespace = "";
				columnPreTrigger.DefaultValue = 5;
				columnPostTrigger.Namespace = "";
				columnPostTrigger.DefaultValue = 60;
				columnRepeatCount.Namespace = "";
				columnRepeatCount.DefaultValue = 0;
				columnPositionX.Namespace = "";
				columnPositionY.Namespace = "";
				columnHeight.Namespace = "";
				columnWidth.Namespace = "";
				columnDock.Namespace = "";
				columnDock.DefaultValue = "Document";
				columnScreen_Id.AutoIncrement = true;
				columnScreen_Id.AllowDBNull = false;
				columnScreen_Id.Unique = true;
			}

			[DebuggerNonUserCode]
			public ScreenRow NewScreenRow()
			{
				return (ScreenRow)NewRow();
			}

			[DebuggerNonUserCode]
			protected override DataRow NewRowFromBuilder(DataRowBuilder builder)
			{
				return new ScreenRow(builder);
			}

			[DebuggerNonUserCode]
			protected override Type GetRowType()
			{
				return typeof(ScreenRow);
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanged(DataRowChangeEventArgs e)
			{
				base.OnRowChanged(e);
				if (this.ScreenRowChanged != null)
				{
					this.ScreenRowChanged(this, new ScreenRowChangeEvent((ScreenRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanging(DataRowChangeEventArgs e)
			{
				base.OnRowChanging(e);
				if (this.ScreenRowChanging != null)
				{
					this.ScreenRowChanging(this, new ScreenRowChangeEvent((ScreenRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleted(DataRowChangeEventArgs e)
			{
				base.OnRowDeleted(e);
				if (this.ScreenRowDeleted != null)
				{
					this.ScreenRowDeleted(this, new ScreenRowChangeEvent((ScreenRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleting(DataRowChangeEventArgs e)
			{
				base.OnRowDeleting(e);
				if (this.ScreenRowDeleting != null)
				{
					this.ScreenRowDeleting(this, new ScreenRowChangeEvent((ScreenRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			public void RemoveScreenRow(ScreenRow row)
			{
				base.Rows.Remove(row);
			}

			[DebuggerNonUserCode]
			public static XmlSchemaComplexType GetTypedTableSchema(XmlSchemaSet xs)
			{
				//IL_0000: Unknown result type (might be due to invalid IL or missing references)
				//IL_0006: Expected O, but got Unknown
				//IL_0006: Unknown result type (might be due to invalid IL or missing references)
				//IL_000c: Expected O, but got Unknown
				//IL_001f: Unknown result type (might be due to invalid IL or missing references)
				//IL_0025: Expected O, but got Unknown
				//IL_0060: Unknown result type (might be due to invalid IL or missing references)
				//IL_0067: Expected O, but got Unknown
				//IL_0096: Unknown result type (might be due to invalid IL or missing references)
				//IL_009d: Expected O, but got Unknown
				//IL_00c4: Unknown result type (might be due to invalid IL or missing references)
				//IL_00cb: Expected O, but got Unknown
				XmlSchemaComplexType val = new XmlSchemaComplexType();
				XmlSchemaSequence val2 = new XmlSchemaSequence();
				NewDataSet newDataSet = new NewDataSet();
				xs.Add(newDataSet.GetSchemaSerializable());
				XmlSchemaAny val3 = new XmlSchemaAny();
				val3.Namespace = "http://www.w3.org/2001/XMLSchema";
				((XmlSchemaParticle)val3).MinOccurs = 0m;
				((XmlSchemaParticle)val3).MaxOccurs = decimal.MaxValue;
				val3.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val3);
				XmlSchemaAny val4 = new XmlSchemaAny();
				val4.Namespace = "urn:schemas-microsoft-com:xml-diffgram-v1";
				((XmlSchemaParticle)val4).MinOccurs = 1m;
				val4.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val4);
				XmlSchemaAttribute val5 = new XmlSchemaAttribute();
				val5.Name = "namespace";
				val5.FixedValue = newDataSet.Namespace;
				val.Attributes.Add((XmlSchemaObject)(object)val5);
				XmlSchemaAttribute val6 = new XmlSchemaAttribute();
				val6.Name = "tableTypeName";
				val6.FixedValue = "ScreenDataTable";
				val.Attributes.Add((XmlSchemaObject)(object)val6);
				val.Particle = (XmlSchemaParticle)(object)val2;
				return val;
			}
		}

		[Serializable]
		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		[XmlSchemaProvider("GetTypedTableSchema")]
		public class GroupDataTable : DataTable, IEnumerable
		{
			private DataColumn columnName;

			private DataColumn columnComment;

			private DataColumn columnShowUnits;

			private DataColumn columnShowSourceAddress;

			private DataColumn columnSortExpression;

			private DataColumn columnColumnWidths;

			private DataColumn columnGroup_Id;

			private DataColumn columnScreen_Id;

			[DebuggerNonUserCode]
			public DataColumn NameColumn => columnName;

			[DebuggerNonUserCode]
			public DataColumn CommentColumn => columnComment;

			[DebuggerNonUserCode]
			public DataColumn ShowUnitsColumn => columnShowUnits;

			[DebuggerNonUserCode]
			public DataColumn ShowSourceAddressColumn => columnShowSourceAddress;

			[DebuggerNonUserCode]
			public DataColumn SortExpressionColumn => columnSortExpression;

			[DebuggerNonUserCode]
			public DataColumn ColumnWidthsColumn => columnColumnWidths;

			[DebuggerNonUserCode]
			public DataColumn Group_IdColumn => columnGroup_Id;

			[DebuggerNonUserCode]
			public DataColumn Screen_IdColumn => columnScreen_Id;

			[Browsable(false)]
			[DebuggerNonUserCode]
			public int Count => base.Rows.Count;

			[DebuggerNonUserCode]
			public GroupRow this[int index] => (GroupRow)base.Rows[index];

			public event GroupRowChangeEventHandler GroupRowChanging;

			public event GroupRowChangeEventHandler GroupRowChanged;

			public event GroupRowChangeEventHandler GroupRowDeleting;

			public event GroupRowChangeEventHandler GroupRowDeleted;

			[DebuggerNonUserCode]
			public GroupDataTable()
			{
				base.TableName = "Group";
				BeginInit();
				InitClass();
				EndInit();
			}

			[DebuggerNonUserCode]
			internal GroupDataTable(DataTable table)
			{
				base.TableName = table.TableName;
				if (table.CaseSensitive != table.DataSet.CaseSensitive)
				{
					base.CaseSensitive = table.CaseSensitive;
				}
				if (table.Locale.ToString() != table.DataSet.Locale.ToString())
				{
					base.Locale = table.Locale;
				}
				if (table.Namespace != table.DataSet.Namespace)
				{
					base.Namespace = table.Namespace;
				}
				base.Prefix = table.Prefix;
				base.MinimumCapacity = table.MinimumCapacity;
			}

			[DebuggerNonUserCode]
			protected GroupDataTable(SerializationInfo info, StreamingContext context)
				: base(info, context)
			{
				InitVars();
			}

			[DebuggerNonUserCode]
			public void AddGroupRow(GroupRow row)
			{
				base.Rows.Add(row);
			}

			[DebuggerNonUserCode]
			public GroupRow AddGroupRow(string Name, string Comment, bool ShowUnits, bool ShowSourceAddress, string SortExpression, string ColumnWidths, ScreenRow parentScreenRowByScreen_Group)
			{
				GroupRow groupRow = (GroupRow)NewRow();
				groupRow.ItemArray = new object[8]
				{
					Name,
					Comment,
					ShowUnits,
					ShowSourceAddress,
					SortExpression,
					ColumnWidths,
					null,
					parentScreenRowByScreen_Group[32]
				};
				base.Rows.Add(groupRow);
				return groupRow;
			}

			[DebuggerNonUserCode]
			public virtual IEnumerator GetEnumerator()
			{
				return base.Rows.GetEnumerator();
			}

			[DebuggerNonUserCode]
			public override DataTable Clone()
			{
				GroupDataTable groupDataTable = (GroupDataTable)base.Clone();
				groupDataTable.InitVars();
				return groupDataTable;
			}

			[DebuggerNonUserCode]
			protected override DataTable CreateInstance()
			{
				return new GroupDataTable();
			}

			[DebuggerNonUserCode]
			internal void InitVars()
			{
				columnName = base.Columns["Name"];
				columnComment = base.Columns["Comment"];
				columnShowUnits = base.Columns["ShowUnits"];
				columnShowSourceAddress = base.Columns["ShowSourceAddress"];
				columnSortExpression = base.Columns["SortExpression"];
				columnColumnWidths = base.Columns["ColumnWidths"];
				columnGroup_Id = base.Columns["Group_Id"];
				columnScreen_Id = base.Columns["Screen_Id"];
			}

			[DebuggerNonUserCode]
			private void InitClass()
			{
				columnName = new DataColumn("Name", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnName);
				columnComment = new DataColumn("Comment", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnComment);
				columnShowUnits = new DataColumn("ShowUnits", typeof(bool), null, MappingType.Attribute);
				base.Columns.Add(columnShowUnits);
				columnShowSourceAddress = new DataColumn("ShowSourceAddress", typeof(bool), null, MappingType.Attribute);
				base.Columns.Add(columnShowSourceAddress);
				columnSortExpression = new DataColumn("SortExpression", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnSortExpression);
				columnColumnWidths = new DataColumn("ColumnWidths", typeof(string), null, MappingType.Attribute);
				base.Columns.Add(columnColumnWidths);
				columnGroup_Id = new DataColumn("Group_Id", typeof(int), null, MappingType.Hidden);
				base.Columns.Add(columnGroup_Id);
				columnScreen_Id = new DataColumn("Screen_Id", typeof(int), null, MappingType.Hidden);
				base.Columns.Add(columnScreen_Id);
				base.Constraints.Add(new UniqueConstraint("Constraint1", new DataColumn[1] { columnGroup_Id }, isPrimaryKey: true));
				columnName.AllowDBNull = false;
				columnName.Namespace = "";
				columnComment.Namespace = "";
				columnShowUnits.Namespace = "";
				columnShowSourceAddress.Namespace = "";
				columnSortExpression.Namespace = "";
				columnColumnWidths.Namespace = "";
				columnGroup_Id.AutoIncrement = true;
				columnGroup_Id.AllowDBNull = false;
				columnGroup_Id.Unique = true;
			}

			[DebuggerNonUserCode]
			public GroupRow NewGroupRow()
			{
				return (GroupRow)NewRow();
			}

			[DebuggerNonUserCode]
			protected override DataRow NewRowFromBuilder(DataRowBuilder builder)
			{
				return new GroupRow(builder);
			}

			[DebuggerNonUserCode]
			protected override Type GetRowType()
			{
				return typeof(GroupRow);
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanged(DataRowChangeEventArgs e)
			{
				base.OnRowChanged(e);
				if (this.GroupRowChanged != null)
				{
					this.GroupRowChanged(this, new GroupRowChangeEvent((GroupRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanging(DataRowChangeEventArgs e)
			{
				base.OnRowChanging(e);
				if (this.GroupRowChanging != null)
				{
					this.GroupRowChanging(this, new GroupRowChangeEvent((GroupRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleted(DataRowChangeEventArgs e)
			{
				base.OnRowDeleted(e);
				if (this.GroupRowDeleted != null)
				{
					this.GroupRowDeleted(this, new GroupRowChangeEvent((GroupRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleting(DataRowChangeEventArgs e)
			{
				base.OnRowDeleting(e);
				if (this.GroupRowDeleting != null)
				{
					this.GroupRowDeleting(this, new GroupRowChangeEvent((GroupRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			public void RemoveGroupRow(GroupRow row)
			{
				base.Rows.Remove(row);
			}

			[DebuggerNonUserCode]
			public static XmlSchemaComplexType GetTypedTableSchema(XmlSchemaSet xs)
			{
				//IL_0000: Unknown result type (might be due to invalid IL or missing references)
				//IL_0006: Expected O, but got Unknown
				//IL_0006: Unknown result type (might be due to invalid IL or missing references)
				//IL_000c: Expected O, but got Unknown
				//IL_001f: Unknown result type (might be due to invalid IL or missing references)
				//IL_0025: Expected O, but got Unknown
				//IL_0060: Unknown result type (might be due to invalid IL or missing references)
				//IL_0067: Expected O, but got Unknown
				//IL_0096: Unknown result type (might be due to invalid IL or missing references)
				//IL_009d: Expected O, but got Unknown
				//IL_00c4: Unknown result type (might be due to invalid IL or missing references)
				//IL_00cb: Expected O, but got Unknown
				XmlSchemaComplexType val = new XmlSchemaComplexType();
				XmlSchemaSequence val2 = new XmlSchemaSequence();
				NewDataSet newDataSet = new NewDataSet();
				xs.Add(newDataSet.GetSchemaSerializable());
				XmlSchemaAny val3 = new XmlSchemaAny();
				val3.Namespace = "http://www.w3.org/2001/XMLSchema";
				((XmlSchemaParticle)val3).MinOccurs = 0m;
				((XmlSchemaParticle)val3).MaxOccurs = decimal.MaxValue;
				val3.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val3);
				XmlSchemaAny val4 = new XmlSchemaAny();
				val4.Namespace = "urn:schemas-microsoft-com:xml-diffgram-v1";
				((XmlSchemaParticle)val4).MinOccurs = 1m;
				val4.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val4);
				XmlSchemaAttribute val5 = new XmlSchemaAttribute();
				val5.Name = "namespace";
				val5.FixedValue = newDataSet.Namespace;
				val.Attributes.Add((XmlSchemaObject)(object)val5);
				XmlSchemaAttribute val6 = new XmlSchemaAttribute();
				val6.Name = "tableTypeName";
				val6.FixedValue = "GroupDataTable";
				val.Attributes.Add((XmlSchemaObject)(object)val6);
				val.Particle = (XmlSchemaParticle)(object)val2;
				return val;
			}
		}

		[Serializable]
		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		[XmlSchemaProvider("GetTypedTableSchema")]
		public class ParameterDataTable : DataTable, IEnumerable
		{
			private DataColumn columnSourceAddress;

			private DataColumn columnName;

			private DataColumn columnUnits;

			private DataColumn columnColor;

			private DataColumn columnGaugeIndex;

			private DataColumn columnViewType;

			private DataColumn columnIsBroadcast;

			private DataColumn columnParameter_Id;

			private DataColumn columnGroup_Id;

			[DebuggerNonUserCode]
			public DataColumn SourceAddressColumn => columnSourceAddress;

			[DebuggerNonUserCode]
			public DataColumn NameColumn => columnName;

			[DebuggerNonUserCode]
			public DataColumn UnitsColumn => columnUnits;

			[DebuggerNonUserCode]
			public DataColumn ColorColumn => columnColor;

			[DebuggerNonUserCode]
			public DataColumn GaugeIndexColumn => columnGaugeIndex;

			[DebuggerNonUserCode]
			public DataColumn ViewTypeColumn => columnViewType;

			[DebuggerNonUserCode]
			public DataColumn IsBroadcastColumn => columnIsBroadcast;

			[DebuggerNonUserCode]
			public DataColumn Parameter_IdColumn => columnParameter_Id;

			[DebuggerNonUserCode]
			public DataColumn Group_IdColumn => columnGroup_Id;

			[DebuggerNonUserCode]
			[Browsable(false)]
			public int Count => base.Rows.Count;

			[DebuggerNonUserCode]
			public ParameterRow this[int index] => (ParameterRow)base.Rows[index];

			public event ParameterRowChangeEventHandler ParameterRowChanging;

			public event ParameterRowChangeEventHandler ParameterRowChanged;

			public event ParameterRowChangeEventHandler ParameterRowDeleting;

			public event ParameterRowChangeEventHandler ParameterRowDeleted;

			[DebuggerNonUserCode]
			public ParameterDataTable()
			{
				base.TableName = "Parameter";
				BeginInit();
				InitClass();
				EndInit();
			}

			[DebuggerNonUserCode]
			internal ParameterDataTable(DataTable table)
			{
				base.TableName = table.TableName;
				if (table.CaseSensitive != table.DataSet.CaseSensitive)
				{
					base.CaseSensitive = table.CaseSensitive;
				}
				if (table.Locale.ToString() != table.DataSet.Locale.ToString())
				{
					base.Locale = table.Locale;
				}
				if (table.Namespace != table.DataSet.Namespace)
				{
					base.Namespace = table.Namespace;
				}
				base.Prefix = table.Prefix;
				base.MinimumCapacity = table.MinimumCapacity;
			}

			[DebuggerNonUserCode]
			protected ParameterDataTable(SerializationInfo info, StreamingContext context)
				: base(info, context)
			{
				InitVars();
			}

			[DebuggerNonUserCode]
			public void AddParameterRow(ParameterRow row)
			{
				base.Rows.Add(row);
			}

			[DebuggerNonUserCode]
			public ParameterRow AddParameterRow(string SourceAddress, string Name, string Units, string Color, short GaugeIndex, string ViewType, bool IsBroadcast, GroupRow parentGroupRowByGroup_Parameter)
			{
				ParameterRow parameterRow = (ParameterRow)NewRow();
				parameterRow.ItemArray = new object[9]
				{
					SourceAddress,
					Name,
					Units,
					Color,
					GaugeIndex,
					ViewType,
					IsBroadcast,
					null,
					parentGroupRowByGroup_Parameter[6]
				};
				base.Rows.Add(parameterRow);
				return parameterRow;
			}

			[DebuggerNonUserCode]
			public virtual IEnumerator GetEnumerator()
			{
				return base.Rows.GetEnumerator();
			}

			[DebuggerNonUserCode]
			public override DataTable Clone()
			{
				ParameterDataTable parameterDataTable = (ParameterDataTable)base.Clone();
				parameterDataTable.InitVars();
				return parameterDataTable;
			}

			[DebuggerNonUserCode]
			protected override DataTable CreateInstance()
			{
				return new ParameterDataTable();
			}

			[DebuggerNonUserCode]
			internal void InitVars()
			{
				columnSourceAddress = base.Columns["SourceAddress"];
				columnName = base.Columns["Name"];
				columnUnits = base.Columns["Units"];
				columnColor = base.Columns["Color"];
				columnGaugeIndex = base.Columns["GaugeIndex"];
				columnViewType = base.Columns["ViewType"];
				columnIsBroadcast = base.Columns["IsBroadcast"];
				columnParameter_Id = base.Columns["Parameter_Id"];
				columnGroup_Id = base.Columns["Group_Id"];
			}

			[DebuggerNonUserCode]
			private void InitClass()
			{
				columnSourceAddress = new DataColumn("SourceAddress", typeof(string), null, MappingType.Element);
				base.Columns.Add(columnSourceAddress);
				columnName = new DataColumn("Name", typeof(string), null, MappingType.Element);
				base.Columns.Add(columnName);
				columnUnits = new DataColumn("Units", typeof(string), null, MappingType.Element);
				base.Columns.Add(columnUnits);
				columnColor = new DataColumn("Color", typeof(string), null, MappingType.Element);
				base.Columns.Add(columnColor);
				columnGaugeIndex = new DataColumn("GaugeIndex", typeof(short), null, MappingType.Element);
				base.Columns.Add(columnGaugeIndex);
				columnViewType = new DataColumn("ViewType", typeof(string), null, MappingType.Element);
				base.Columns.Add(columnViewType);
				columnIsBroadcast = new DataColumn("IsBroadcast", typeof(bool), null, MappingType.Element);
				base.Columns.Add(columnIsBroadcast);
				columnParameter_Id = new DataColumn("Parameter_Id", typeof(int), null, MappingType.Hidden);
				base.Columns.Add(columnParameter_Id);
				columnGroup_Id = new DataColumn("Group_Id", typeof(int), null, MappingType.Hidden);
				base.Columns.Add(columnGroup_Id);
				base.Constraints.Add(new UniqueConstraint("Constraint1", new DataColumn[1] { columnParameter_Id }, isPrimaryKey: true));
				columnSourceAddress.AllowDBNull = false;
				columnSourceAddress.DefaultValue = "0";
				columnName.AllowDBNull = false;
				columnUnits.AllowDBNull = false;
				columnViewType.DefaultValue = "Normal";
				columnIsBroadcast.AllowDBNull = false;
				columnIsBroadcast.DefaultValue = false;
				columnParameter_Id.AutoIncrement = true;
				columnParameter_Id.AllowDBNull = false;
				columnParameter_Id.Unique = true;
			}

			[DebuggerNonUserCode]
			public ParameterRow NewParameterRow()
			{
				return (ParameterRow)NewRow();
			}

			[DebuggerNonUserCode]
			protected override DataRow NewRowFromBuilder(DataRowBuilder builder)
			{
				return new ParameterRow(builder);
			}

			[DebuggerNonUserCode]
			protected override Type GetRowType()
			{
				return typeof(ParameterRow);
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanged(DataRowChangeEventArgs e)
			{
				base.OnRowChanged(e);
				if (this.ParameterRowChanged != null)
				{
					this.ParameterRowChanged(this, new ParameterRowChangeEvent((ParameterRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanging(DataRowChangeEventArgs e)
			{
				base.OnRowChanging(e);
				if (this.ParameterRowChanging != null)
				{
					this.ParameterRowChanging(this, new ParameterRowChangeEvent((ParameterRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleted(DataRowChangeEventArgs e)
			{
				base.OnRowDeleted(e);
				if (this.ParameterRowDeleted != null)
				{
					this.ParameterRowDeleted(this, new ParameterRowChangeEvent((ParameterRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleting(DataRowChangeEventArgs e)
			{
				base.OnRowDeleting(e);
				if (this.ParameterRowDeleting != null)
				{
					this.ParameterRowDeleting(this, new ParameterRowChangeEvent((ParameterRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			public void RemoveParameterRow(ParameterRow row)
			{
				base.Rows.Remove(row);
			}

			[DebuggerNonUserCode]
			public static XmlSchemaComplexType GetTypedTableSchema(XmlSchemaSet xs)
			{
				//IL_0000: Unknown result type (might be due to invalid IL or missing references)
				//IL_0006: Expected O, but got Unknown
				//IL_0006: Unknown result type (might be due to invalid IL or missing references)
				//IL_000c: Expected O, but got Unknown
				//IL_001f: Unknown result type (might be due to invalid IL or missing references)
				//IL_0025: Expected O, but got Unknown
				//IL_0060: Unknown result type (might be due to invalid IL or missing references)
				//IL_0067: Expected O, but got Unknown
				//IL_0096: Unknown result type (might be due to invalid IL or missing references)
				//IL_009d: Expected O, but got Unknown
				//IL_00c4: Unknown result type (might be due to invalid IL or missing references)
				//IL_00cb: Expected O, but got Unknown
				XmlSchemaComplexType val = new XmlSchemaComplexType();
				XmlSchemaSequence val2 = new XmlSchemaSequence();
				NewDataSet newDataSet = new NewDataSet();
				xs.Add(newDataSet.GetSchemaSerializable());
				XmlSchemaAny val3 = new XmlSchemaAny();
				val3.Namespace = "http://www.w3.org/2001/XMLSchema";
				((XmlSchemaParticle)val3).MinOccurs = 0m;
				((XmlSchemaParticle)val3).MaxOccurs = decimal.MaxValue;
				val3.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val3);
				XmlSchemaAny val4 = new XmlSchemaAny();
				val4.Namespace = "urn:schemas-microsoft-com:xml-diffgram-v1";
				((XmlSchemaParticle)val4).MinOccurs = 1m;
				val4.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val4);
				XmlSchemaAttribute val5 = new XmlSchemaAttribute();
				val5.Name = "namespace";
				val5.FixedValue = newDataSet.Namespace;
				val.Attributes.Add((XmlSchemaObject)(object)val5);
				XmlSchemaAttribute val6 = new XmlSchemaAttribute();
				val6.Name = "tableTypeName";
				val6.FixedValue = "ParameterDataTable";
				val.Attributes.Add((XmlSchemaObject)(object)val6);
				val.Particle = (XmlSchemaParticle)(object)val2;
				return val;
			}
		}

		[Serializable]
		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		[XmlSchemaProvider("GetTypedTableSchema")]
		public class ParameterYAxisDataTable : DataTable, IEnumerable
		{
			private DataColumn columnMinValue;

			private DataColumn columnMaxValue;

			private DataColumn columnParameter_Id;

			[DebuggerNonUserCode]
			public DataColumn MinValueColumn => columnMinValue;

			[DebuggerNonUserCode]
			public DataColumn MaxValueColumn => columnMaxValue;

			[DebuggerNonUserCode]
			public DataColumn Parameter_IdColumn => columnParameter_Id;

			[Browsable(false)]
			[DebuggerNonUserCode]
			public int Count => base.Rows.Count;

			[DebuggerNonUserCode]
			public ParameterYAxisRow this[int index] => (ParameterYAxisRow)base.Rows[index];

			public event ParameterYAxisRowChangeEventHandler ParameterYAxisRowChanging;

			public event ParameterYAxisRowChangeEventHandler ParameterYAxisRowChanged;

			public event ParameterYAxisRowChangeEventHandler ParameterYAxisRowDeleting;

			public event ParameterYAxisRowChangeEventHandler ParameterYAxisRowDeleted;

			[DebuggerNonUserCode]
			public ParameterYAxisDataTable()
			{
				base.TableName = "ParameterYAxis";
				BeginInit();
				InitClass();
				EndInit();
			}

			[DebuggerNonUserCode]
			internal ParameterYAxisDataTable(DataTable table)
			{
				base.TableName = table.TableName;
				if (table.CaseSensitive != table.DataSet.CaseSensitive)
				{
					base.CaseSensitive = table.CaseSensitive;
				}
				if (table.Locale.ToString() != table.DataSet.Locale.ToString())
				{
					base.Locale = table.Locale;
				}
				if (table.Namespace != table.DataSet.Namespace)
				{
					base.Namespace = table.Namespace;
				}
				base.Prefix = table.Prefix;
				base.MinimumCapacity = table.MinimumCapacity;
			}

			[DebuggerNonUserCode]
			protected ParameterYAxisDataTable(SerializationInfo info, StreamingContext context)
				: base(info, context)
			{
				InitVars();
			}

			[DebuggerNonUserCode]
			public void AddParameterYAxisRow(ParameterYAxisRow row)
			{
				base.Rows.Add(row);
			}

			[DebuggerNonUserCode]
			public ParameterYAxisRow AddParameterYAxisRow(double MinValue, double MaxValue, ParameterRow parentParameterRowByParameter_ParameterYAxis)
			{
				ParameterYAxisRow parameterYAxisRow = (ParameterYAxisRow)NewRow();
				parameterYAxisRow.ItemArray = new object[3]
				{
					MinValue,
					MaxValue,
					parentParameterRowByParameter_ParameterYAxis[7]
				};
				base.Rows.Add(parameterYAxisRow);
				return parameterYAxisRow;
			}

			[DebuggerNonUserCode]
			public virtual IEnumerator GetEnumerator()
			{
				return base.Rows.GetEnumerator();
			}

			[DebuggerNonUserCode]
			public override DataTable Clone()
			{
				ParameterYAxisDataTable parameterYAxisDataTable = (ParameterYAxisDataTable)base.Clone();
				parameterYAxisDataTable.InitVars();
				return parameterYAxisDataTable;
			}

			[DebuggerNonUserCode]
			protected override DataTable CreateInstance()
			{
				return new ParameterYAxisDataTable();
			}

			[DebuggerNonUserCode]
			internal void InitVars()
			{
				columnMinValue = base.Columns["MinValue"];
				columnMaxValue = base.Columns["MaxValue"];
				columnParameter_Id = base.Columns["Parameter_Id"];
			}

			[DebuggerNonUserCode]
			private void InitClass()
			{
				columnMinValue = new DataColumn("MinValue", typeof(double), null, MappingType.Element);
				base.Columns.Add(columnMinValue);
				columnMaxValue = new DataColumn("MaxValue", typeof(double), null, MappingType.Element);
				base.Columns.Add(columnMaxValue);
				columnParameter_Id = new DataColumn("Parameter_Id", typeof(int), null, MappingType.Hidden);
				base.Columns.Add(columnParameter_Id);
				columnMinValue.DefaultValue = 0.0;
				columnMaxValue.DefaultValue = 100.0;
			}

			[DebuggerNonUserCode]
			public ParameterYAxisRow NewParameterYAxisRow()
			{
				return (ParameterYAxisRow)NewRow();
			}

			[DebuggerNonUserCode]
			protected override DataRow NewRowFromBuilder(DataRowBuilder builder)
			{
				return new ParameterYAxisRow(builder);
			}

			[DebuggerNonUserCode]
			protected override Type GetRowType()
			{
				return typeof(ParameterYAxisRow);
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanged(DataRowChangeEventArgs e)
			{
				base.OnRowChanged(e);
				if (this.ParameterYAxisRowChanged != null)
				{
					this.ParameterYAxisRowChanged(this, new ParameterYAxisRowChangeEvent((ParameterYAxisRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanging(DataRowChangeEventArgs e)
			{
				base.OnRowChanging(e);
				if (this.ParameterYAxisRowChanging != null)
				{
					this.ParameterYAxisRowChanging(this, new ParameterYAxisRowChangeEvent((ParameterYAxisRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleted(DataRowChangeEventArgs e)
			{
				base.OnRowDeleted(e);
				if (this.ParameterYAxisRowDeleted != null)
				{
					this.ParameterYAxisRowDeleted(this, new ParameterYAxisRowChangeEvent((ParameterYAxisRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleting(DataRowChangeEventArgs e)
			{
				base.OnRowDeleting(e);
				if (this.ParameterYAxisRowDeleting != null)
				{
					this.ParameterYAxisRowDeleting(this, new ParameterYAxisRowChangeEvent((ParameterYAxisRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			public void RemoveParameterYAxisRow(ParameterYAxisRow row)
			{
				base.Rows.Remove(row);
			}

			[DebuggerNonUserCode]
			public static XmlSchemaComplexType GetTypedTableSchema(XmlSchemaSet xs)
			{
				//IL_0000: Unknown result type (might be due to invalid IL or missing references)
				//IL_0006: Expected O, but got Unknown
				//IL_0006: Unknown result type (might be due to invalid IL or missing references)
				//IL_000c: Expected O, but got Unknown
				//IL_001f: Unknown result type (might be due to invalid IL or missing references)
				//IL_0025: Expected O, but got Unknown
				//IL_0060: Unknown result type (might be due to invalid IL or missing references)
				//IL_0067: Expected O, but got Unknown
				//IL_0096: Unknown result type (might be due to invalid IL or missing references)
				//IL_009d: Expected O, but got Unknown
				//IL_00c4: Unknown result type (might be due to invalid IL or missing references)
				//IL_00cb: Expected O, but got Unknown
				XmlSchemaComplexType val = new XmlSchemaComplexType();
				XmlSchemaSequence val2 = new XmlSchemaSequence();
				NewDataSet newDataSet = new NewDataSet();
				xs.Add(newDataSet.GetSchemaSerializable());
				XmlSchemaAny val3 = new XmlSchemaAny();
				val3.Namespace = "http://www.w3.org/2001/XMLSchema";
				((XmlSchemaParticle)val3).MinOccurs = 0m;
				((XmlSchemaParticle)val3).MaxOccurs = decimal.MaxValue;
				val3.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val3);
				XmlSchemaAny val4 = new XmlSchemaAny();
				val4.Namespace = "urn:schemas-microsoft-com:xml-diffgram-v1";
				((XmlSchemaParticle)val4).MinOccurs = 1m;
				val4.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val4);
				XmlSchemaAttribute val5 = new XmlSchemaAttribute();
				val5.Name = "namespace";
				val5.FixedValue = newDataSet.Namespace;
				val.Attributes.Add((XmlSchemaObject)(object)val5);
				XmlSchemaAttribute val6 = new XmlSchemaAttribute();
				val6.Name = "tableTypeName";
				val6.FixedValue = "ParameterYAxisDataTable";
				val.Attributes.Add((XmlSchemaObject)(object)val6);
				val.Particle = (XmlSchemaParticle)(object)val2;
				return val;
			}
		}

		[Serializable]
		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		[XmlSchemaProvider("GetTypedTableSchema")]
		public class GaugeConfigurationDataTable : DataTable, IEnumerable
		{
			private DataColumn columnShowGauges;

			private DataColumn columnGaugeConfiguration_Id;

			private DataColumn columnGroup_Id;

			[DebuggerNonUserCode]
			public DataColumn ShowGaugesColumn => columnShowGauges;

			[DebuggerNonUserCode]
			public DataColumn GaugeConfiguration_IdColumn => columnGaugeConfiguration_Id;

			[DebuggerNonUserCode]
			public DataColumn Group_IdColumn => columnGroup_Id;

			[DebuggerNonUserCode]
			[Browsable(false)]
			public int Count => base.Rows.Count;

			[DebuggerNonUserCode]
			public GaugeConfigurationRow this[int index] => (GaugeConfigurationRow)base.Rows[index];

			public event GaugeConfigurationRowChangeEventHandler GaugeConfigurationRowChanging;

			public event GaugeConfigurationRowChangeEventHandler GaugeConfigurationRowChanged;

			public event GaugeConfigurationRowChangeEventHandler GaugeConfigurationRowDeleting;

			public event GaugeConfigurationRowChangeEventHandler GaugeConfigurationRowDeleted;

			[DebuggerNonUserCode]
			public GaugeConfigurationDataTable()
			{
				base.TableName = "GaugeConfiguration";
				BeginInit();
				InitClass();
				EndInit();
			}

			[DebuggerNonUserCode]
			internal GaugeConfigurationDataTable(DataTable table)
			{
				base.TableName = table.TableName;
				if (table.CaseSensitive != table.DataSet.CaseSensitive)
				{
					base.CaseSensitive = table.CaseSensitive;
				}
				if (table.Locale.ToString() != table.DataSet.Locale.ToString())
				{
					base.Locale = table.Locale;
				}
				if (table.Namespace != table.DataSet.Namespace)
				{
					base.Namespace = table.Namespace;
				}
				base.Prefix = table.Prefix;
				base.MinimumCapacity = table.MinimumCapacity;
			}

			[DebuggerNonUserCode]
			protected GaugeConfigurationDataTable(SerializationInfo info, StreamingContext context)
				: base(info, context)
			{
				InitVars();
			}

			[DebuggerNonUserCode]
			public void AddGaugeConfigurationRow(GaugeConfigurationRow row)
			{
				base.Rows.Add(row);
			}

			[DebuggerNonUserCode]
			public GaugeConfigurationRow AddGaugeConfigurationRow(bool ShowGauges, GroupRow parentGroupRowByGroup_GaugeConfiguration)
			{
				GaugeConfigurationRow gaugeConfigurationRow = (GaugeConfigurationRow)NewRow();
				gaugeConfigurationRow.ItemArray = new object[3]
				{
					ShowGauges,
					null,
					parentGroupRowByGroup_GaugeConfiguration[6]
				};
				base.Rows.Add(gaugeConfigurationRow);
				return gaugeConfigurationRow;
			}

			[DebuggerNonUserCode]
			public virtual IEnumerator GetEnumerator()
			{
				return base.Rows.GetEnumerator();
			}

			[DebuggerNonUserCode]
			public override DataTable Clone()
			{
				GaugeConfigurationDataTable gaugeConfigurationDataTable = (GaugeConfigurationDataTable)base.Clone();
				gaugeConfigurationDataTable.InitVars();
				return gaugeConfigurationDataTable;
			}

			[DebuggerNonUserCode]
			protected override DataTable CreateInstance()
			{
				return new GaugeConfigurationDataTable();
			}

			[DebuggerNonUserCode]
			internal void InitVars()
			{
				columnShowGauges = base.Columns["ShowGauges"];
				columnGaugeConfiguration_Id = base.Columns["GaugeConfiguration_Id"];
				columnGroup_Id = base.Columns["Group_Id"];
			}

			[DebuggerNonUserCode]
			private void InitClass()
			{
				columnShowGauges = new DataColumn("ShowGauges", typeof(bool), null, MappingType.Element);
				base.Columns.Add(columnShowGauges);
				columnGaugeConfiguration_Id = new DataColumn("GaugeConfiguration_Id", typeof(int), null, MappingType.Hidden);
				base.Columns.Add(columnGaugeConfiguration_Id);
				columnGroup_Id = new DataColumn("Group_Id", typeof(int), null, MappingType.Hidden);
				base.Columns.Add(columnGroup_Id);
				base.Constraints.Add(new UniqueConstraint("Constraint1", new DataColumn[1] { columnGaugeConfiguration_Id }, isPrimaryKey: true));
				columnShowGauges.DefaultValue = false;
				columnGaugeConfiguration_Id.AutoIncrement = true;
				columnGaugeConfiguration_Id.AllowDBNull = false;
				columnGaugeConfiguration_Id.Unique = true;
			}

			[DebuggerNonUserCode]
			public GaugeConfigurationRow NewGaugeConfigurationRow()
			{
				return (GaugeConfigurationRow)NewRow();
			}

			[DebuggerNonUserCode]
			protected override DataRow NewRowFromBuilder(DataRowBuilder builder)
			{
				return new GaugeConfigurationRow(builder);
			}

			[DebuggerNonUserCode]
			protected override Type GetRowType()
			{
				return typeof(GaugeConfigurationRow);
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanged(DataRowChangeEventArgs e)
			{
				base.OnRowChanged(e);
				if (this.GaugeConfigurationRowChanged != null)
				{
					this.GaugeConfigurationRowChanged(this, new GaugeConfigurationRowChangeEvent((GaugeConfigurationRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanging(DataRowChangeEventArgs e)
			{
				base.OnRowChanging(e);
				if (this.GaugeConfigurationRowChanging != null)
				{
					this.GaugeConfigurationRowChanging(this, new GaugeConfigurationRowChangeEvent((GaugeConfigurationRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleted(DataRowChangeEventArgs e)
			{
				base.OnRowDeleted(e);
				if (this.GaugeConfigurationRowDeleted != null)
				{
					this.GaugeConfigurationRowDeleted(this, new GaugeConfigurationRowChangeEvent((GaugeConfigurationRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleting(DataRowChangeEventArgs e)
			{
				base.OnRowDeleting(e);
				if (this.GaugeConfigurationRowDeleting != null)
				{
					this.GaugeConfigurationRowDeleting(this, new GaugeConfigurationRowChangeEvent((GaugeConfigurationRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			public void RemoveGaugeConfigurationRow(GaugeConfigurationRow row)
			{
				base.Rows.Remove(row);
			}

			[DebuggerNonUserCode]
			public static XmlSchemaComplexType GetTypedTableSchema(XmlSchemaSet xs)
			{
				//IL_0000: Unknown result type (might be due to invalid IL or missing references)
				//IL_0006: Expected O, but got Unknown
				//IL_0006: Unknown result type (might be due to invalid IL or missing references)
				//IL_000c: Expected O, but got Unknown
				//IL_001f: Unknown result type (might be due to invalid IL or missing references)
				//IL_0025: Expected O, but got Unknown
				//IL_0060: Unknown result type (might be due to invalid IL or missing references)
				//IL_0067: Expected O, but got Unknown
				//IL_0096: Unknown result type (might be due to invalid IL or missing references)
				//IL_009d: Expected O, but got Unknown
				//IL_00c4: Unknown result type (might be due to invalid IL or missing references)
				//IL_00cb: Expected O, but got Unknown
				XmlSchemaComplexType val = new XmlSchemaComplexType();
				XmlSchemaSequence val2 = new XmlSchemaSequence();
				NewDataSet newDataSet = new NewDataSet();
				xs.Add(newDataSet.GetSchemaSerializable());
				XmlSchemaAny val3 = new XmlSchemaAny();
				val3.Namespace = "http://www.w3.org/2001/XMLSchema";
				((XmlSchemaParticle)val3).MinOccurs = 0m;
				((XmlSchemaParticle)val3).MaxOccurs = decimal.MaxValue;
				val3.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val3);
				XmlSchemaAny val4 = new XmlSchemaAny();
				val4.Namespace = "urn:schemas-microsoft-com:xml-diffgram-v1";
				((XmlSchemaParticle)val4).MinOccurs = 1m;
				val4.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val4);
				XmlSchemaAttribute val5 = new XmlSchemaAttribute();
				val5.Name = "namespace";
				val5.FixedValue = newDataSet.Namespace;
				val.Attributes.Add((XmlSchemaObject)(object)val5);
				XmlSchemaAttribute val6 = new XmlSchemaAttribute();
				val6.Name = "tableTypeName";
				val6.FixedValue = "GaugeConfigurationDataTable";
				val.Attributes.Add((XmlSchemaObject)(object)val6);
				val.Particle = (XmlSchemaParticle)(object)val2;
				return val;
			}
		}

		[Serializable]
		[XmlSchemaProvider("GetTypedTableSchema")]
		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class GaugeDataTable : DataTable, IEnumerable
		{
			private DataColumn columnIndex;

			private DataColumn columnRedLinesStart;

			private DataColumn columnRedLineVisible;

			private DataColumn columnMaxValue;

			private DataColumn columnMinValue;

			private DataColumn columnGaugeConfiguration_Id;

			[DebuggerNonUserCode]
			public DataColumn IndexColumn => columnIndex;

			[DebuggerNonUserCode]
			public DataColumn RedLinesStartColumn => columnRedLinesStart;

			[DebuggerNonUserCode]
			public DataColumn RedLineVisibleColumn => columnRedLineVisible;

			[DebuggerNonUserCode]
			public DataColumn MaxValueColumn => columnMaxValue;

			[DebuggerNonUserCode]
			public DataColumn MinValueColumn => columnMinValue;

			[DebuggerNonUserCode]
			public DataColumn GaugeConfiguration_IdColumn => columnGaugeConfiguration_Id;

			[Browsable(false)]
			[DebuggerNonUserCode]
			public int Count => base.Rows.Count;

			[DebuggerNonUserCode]
			public GaugeRow this[int index] => (GaugeRow)base.Rows[index];

			public event GaugeRowChangeEventHandler GaugeRowChanging;

			public event GaugeRowChangeEventHandler GaugeRowChanged;

			public event GaugeRowChangeEventHandler GaugeRowDeleting;

			public event GaugeRowChangeEventHandler GaugeRowDeleted;

			[DebuggerNonUserCode]
			public GaugeDataTable()
			{
				base.TableName = "Gauge";
				BeginInit();
				InitClass();
				EndInit();
			}

			[DebuggerNonUserCode]
			internal GaugeDataTable(DataTable table)
			{
				base.TableName = table.TableName;
				if (table.CaseSensitive != table.DataSet.CaseSensitive)
				{
					base.CaseSensitive = table.CaseSensitive;
				}
				if (table.Locale.ToString() != table.DataSet.Locale.ToString())
				{
					base.Locale = table.Locale;
				}
				if (table.Namespace != table.DataSet.Namespace)
				{
					base.Namespace = table.Namespace;
				}
				base.Prefix = table.Prefix;
				base.MinimumCapacity = table.MinimumCapacity;
			}

			[DebuggerNonUserCode]
			protected GaugeDataTable(SerializationInfo info, StreamingContext context)
				: base(info, context)
			{
				InitVars();
			}

			[DebuggerNonUserCode]
			public void AddGaugeRow(GaugeRow row)
			{
				base.Rows.Add(row);
			}

			[DebuggerNonUserCode]
			public GaugeRow AddGaugeRow(int Index, double RedLinesStart, bool RedLineVisible, double MaxValue, double MinValue, GaugeConfigurationRow parentGaugeConfigurationRowByGaugeConfiguration_Gauge)
			{
				GaugeRow gaugeRow = (GaugeRow)NewRow();
				gaugeRow.ItemArray = new object[6]
				{
					Index,
					RedLinesStart,
					RedLineVisible,
					MaxValue,
					MinValue,
					parentGaugeConfigurationRowByGaugeConfiguration_Gauge[1]
				};
				base.Rows.Add(gaugeRow);
				return gaugeRow;
			}

			[DebuggerNonUserCode]
			public virtual IEnumerator GetEnumerator()
			{
				return base.Rows.GetEnumerator();
			}

			[DebuggerNonUserCode]
			public override DataTable Clone()
			{
				GaugeDataTable gaugeDataTable = (GaugeDataTable)base.Clone();
				gaugeDataTable.InitVars();
				return gaugeDataTable;
			}

			[DebuggerNonUserCode]
			protected override DataTable CreateInstance()
			{
				return new GaugeDataTable();
			}

			[DebuggerNonUserCode]
			internal void InitVars()
			{
				columnIndex = base.Columns["Index"];
				columnRedLinesStart = base.Columns["RedLinesStart"];
				columnRedLineVisible = base.Columns["RedLineVisible"];
				columnMaxValue = base.Columns["MaxValue"];
				columnMinValue = base.Columns["MinValue"];
				columnGaugeConfiguration_Id = base.Columns["GaugeConfiguration_Id"];
			}

			[DebuggerNonUserCode]
			private void InitClass()
			{
				columnIndex = new DataColumn("Index", typeof(int), null, MappingType.Element);
				base.Columns.Add(columnIndex);
				columnRedLinesStart = new DataColumn("RedLinesStart", typeof(double), null, MappingType.Element);
				base.Columns.Add(columnRedLinesStart);
				columnRedLineVisible = new DataColumn("RedLineVisible", typeof(bool), null, MappingType.Element);
				base.Columns.Add(columnRedLineVisible);
				columnMaxValue = new DataColumn("MaxValue", typeof(double), null, MappingType.Element);
				base.Columns.Add(columnMaxValue);
				columnMinValue = new DataColumn("MinValue", typeof(double), null, MappingType.Element);
				base.Columns.Add(columnMinValue);
				columnGaugeConfiguration_Id = new DataColumn("GaugeConfiguration_Id", typeof(int), null, MappingType.Hidden);
				base.Columns.Add(columnGaugeConfiguration_Id);
				columnIndex.AllowDBNull = false;
				columnIndex.DefaultValue = -1;
				columnRedLinesStart.AllowDBNull = false;
				columnRedLinesStart.DefaultValue = 90.0;
				columnRedLineVisible.AllowDBNull = false;
				columnRedLineVisible.DefaultValue = true;
				columnMaxValue.DefaultValue = 100.0;
				columnMinValue.AllowDBNull = false;
				columnMinValue.DefaultValue = 0.0;
			}

			[DebuggerNonUserCode]
			public GaugeRow NewGaugeRow()
			{
				return (GaugeRow)NewRow();
			}

			[DebuggerNonUserCode]
			protected override DataRow NewRowFromBuilder(DataRowBuilder builder)
			{
				return new GaugeRow(builder);
			}

			[DebuggerNonUserCode]
			protected override Type GetRowType()
			{
				return typeof(GaugeRow);
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanged(DataRowChangeEventArgs e)
			{
				base.OnRowChanged(e);
				if (this.GaugeRowChanged != null)
				{
					this.GaugeRowChanged(this, new GaugeRowChangeEvent((GaugeRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanging(DataRowChangeEventArgs e)
			{
				base.OnRowChanging(e);
				if (this.GaugeRowChanging != null)
				{
					this.GaugeRowChanging(this, new GaugeRowChangeEvent((GaugeRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleted(DataRowChangeEventArgs e)
			{
				base.OnRowDeleted(e);
				if (this.GaugeRowDeleted != null)
				{
					this.GaugeRowDeleted(this, new GaugeRowChangeEvent((GaugeRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleting(DataRowChangeEventArgs e)
			{
				base.OnRowDeleting(e);
				if (this.GaugeRowDeleting != null)
				{
					this.GaugeRowDeleting(this, new GaugeRowChangeEvent((GaugeRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			public void RemoveGaugeRow(GaugeRow row)
			{
				base.Rows.Remove(row);
			}

			[DebuggerNonUserCode]
			public static XmlSchemaComplexType GetTypedTableSchema(XmlSchemaSet xs)
			{
				//IL_0000: Unknown result type (might be due to invalid IL or missing references)
				//IL_0006: Expected O, but got Unknown
				//IL_0006: Unknown result type (might be due to invalid IL or missing references)
				//IL_000c: Expected O, but got Unknown
				//IL_001f: Unknown result type (might be due to invalid IL or missing references)
				//IL_0025: Expected O, but got Unknown
				//IL_0060: Unknown result type (might be due to invalid IL or missing references)
				//IL_0067: Expected O, but got Unknown
				//IL_0096: Unknown result type (might be due to invalid IL or missing references)
				//IL_009d: Expected O, but got Unknown
				//IL_00c4: Unknown result type (might be due to invalid IL or missing references)
				//IL_00cb: Expected O, but got Unknown
				XmlSchemaComplexType val = new XmlSchemaComplexType();
				XmlSchemaSequence val2 = new XmlSchemaSequence();
				NewDataSet newDataSet = new NewDataSet();
				xs.Add(newDataSet.GetSchemaSerializable());
				XmlSchemaAny val3 = new XmlSchemaAny();
				val3.Namespace = "http://www.w3.org/2001/XMLSchema";
				((XmlSchemaParticle)val3).MinOccurs = 0m;
				((XmlSchemaParticle)val3).MaxOccurs = decimal.MaxValue;
				val3.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val3);
				XmlSchemaAny val4 = new XmlSchemaAny();
				val4.Namespace = "urn:schemas-microsoft-com:xml-diffgram-v1";
				((XmlSchemaParticle)val4).MinOccurs = 1m;
				val4.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val4);
				XmlSchemaAttribute val5 = new XmlSchemaAttribute();
				val5.Name = "namespace";
				val5.FixedValue = newDataSet.Namespace;
				val.Attributes.Add((XmlSchemaObject)(object)val5);
				XmlSchemaAttribute val6 = new XmlSchemaAttribute();
				val6.Name = "tableTypeName";
				val6.FixedValue = "GaugeDataTable";
				val.Attributes.Add((XmlSchemaObject)(object)val6);
				val.Particle = (XmlSchemaParticle)(object)val2;
				return val;
			}
		}

		[Serializable]
		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		[XmlSchemaProvider("GetTypedTableSchema")]
		public class GraphConfigurationDataTable : DataTable, IEnumerable
		{
			private DataColumn columnGraphConfiguration_Id;

			private DataColumn columnGroup_Id;

			[DebuggerNonUserCode]
			public DataColumn GraphConfiguration_IdColumn => columnGraphConfiguration_Id;

			[DebuggerNonUserCode]
			public DataColumn Group_IdColumn => columnGroup_Id;

			[DebuggerNonUserCode]
			[Browsable(false)]
			public int Count => base.Rows.Count;

			[DebuggerNonUserCode]
			public GraphConfigurationRow this[int index] => (GraphConfigurationRow)base.Rows[index];

			public event GraphConfigurationRowChangeEventHandler GraphConfigurationRowChanging;

			public event GraphConfigurationRowChangeEventHandler GraphConfigurationRowChanged;

			public event GraphConfigurationRowChangeEventHandler GraphConfigurationRowDeleting;

			public event GraphConfigurationRowChangeEventHandler GraphConfigurationRowDeleted;

			[DebuggerNonUserCode]
			public GraphConfigurationDataTable()
			{
				base.TableName = "GraphConfiguration";
				BeginInit();
				InitClass();
				EndInit();
			}

			[DebuggerNonUserCode]
			internal GraphConfigurationDataTable(DataTable table)
			{
				base.TableName = table.TableName;
				if (table.CaseSensitive != table.DataSet.CaseSensitive)
				{
					base.CaseSensitive = table.CaseSensitive;
				}
				if (table.Locale.ToString() != table.DataSet.Locale.ToString())
				{
					base.Locale = table.Locale;
				}
				if (table.Namespace != table.DataSet.Namespace)
				{
					base.Namespace = table.Namespace;
				}
				base.Prefix = table.Prefix;
				base.MinimumCapacity = table.MinimumCapacity;
			}

			[DebuggerNonUserCode]
			protected GraphConfigurationDataTable(SerializationInfo info, StreamingContext context)
				: base(info, context)
			{
				InitVars();
			}

			[DebuggerNonUserCode]
			public void AddGraphConfigurationRow(GraphConfigurationRow row)
			{
				base.Rows.Add(row);
			}

			[DebuggerNonUserCode]
			public GraphConfigurationRow AddGraphConfigurationRow(GroupRow parentGroupRowByGroup_GraphConfiguration)
			{
				GraphConfigurationRow graphConfigurationRow = (GraphConfigurationRow)NewRow();
				graphConfigurationRow.ItemArray = new object[2]
				{
					null,
					parentGroupRowByGroup_GraphConfiguration[6]
				};
				base.Rows.Add(graphConfigurationRow);
				return graphConfigurationRow;
			}

			[DebuggerNonUserCode]
			public virtual IEnumerator GetEnumerator()
			{
				return base.Rows.GetEnumerator();
			}

			[DebuggerNonUserCode]
			public override DataTable Clone()
			{
				GraphConfigurationDataTable graphConfigurationDataTable = (GraphConfigurationDataTable)base.Clone();
				graphConfigurationDataTable.InitVars();
				return graphConfigurationDataTable;
			}

			[DebuggerNonUserCode]
			protected override DataTable CreateInstance()
			{
				return new GraphConfigurationDataTable();
			}

			[DebuggerNonUserCode]
			internal void InitVars()
			{
				columnGraphConfiguration_Id = base.Columns["GraphConfiguration_Id"];
				columnGroup_Id = base.Columns["Group_Id"];
			}

			[DebuggerNonUserCode]
			private void InitClass()
			{
				columnGraphConfiguration_Id = new DataColumn("GraphConfiguration_Id", typeof(int), null, MappingType.Hidden);
				base.Columns.Add(columnGraphConfiguration_Id);
				columnGroup_Id = new DataColumn("Group_Id", typeof(int), null, MappingType.Hidden);
				base.Columns.Add(columnGroup_Id);
				base.Constraints.Add(new UniqueConstraint("Constraint1", new DataColumn[1] { columnGraphConfiguration_Id }, isPrimaryKey: true));
				columnGraphConfiguration_Id.AutoIncrement = true;
				columnGraphConfiguration_Id.AllowDBNull = false;
				columnGraphConfiguration_Id.Unique = true;
			}

			[DebuggerNonUserCode]
			public GraphConfigurationRow NewGraphConfigurationRow()
			{
				return (GraphConfigurationRow)NewRow();
			}

			[DebuggerNonUserCode]
			protected override DataRow NewRowFromBuilder(DataRowBuilder builder)
			{
				return new GraphConfigurationRow(builder);
			}

			[DebuggerNonUserCode]
			protected override Type GetRowType()
			{
				return typeof(GraphConfigurationRow);
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanged(DataRowChangeEventArgs e)
			{
				base.OnRowChanged(e);
				if (this.GraphConfigurationRowChanged != null)
				{
					this.GraphConfigurationRowChanged(this, new GraphConfigurationRowChangeEvent((GraphConfigurationRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanging(DataRowChangeEventArgs e)
			{
				base.OnRowChanging(e);
				if (this.GraphConfigurationRowChanging != null)
				{
					this.GraphConfigurationRowChanging(this, new GraphConfigurationRowChangeEvent((GraphConfigurationRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleted(DataRowChangeEventArgs e)
			{
				base.OnRowDeleted(e);
				if (this.GraphConfigurationRowDeleted != null)
				{
					this.GraphConfigurationRowDeleted(this, new GraphConfigurationRowChangeEvent((GraphConfigurationRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleting(DataRowChangeEventArgs e)
			{
				base.OnRowDeleting(e);
				if (this.GraphConfigurationRowDeleting != null)
				{
					this.GraphConfigurationRowDeleting(this, new GraphConfigurationRowChangeEvent((GraphConfigurationRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			public void RemoveGraphConfigurationRow(GraphConfigurationRow row)
			{
				base.Rows.Remove(row);
			}

			[DebuggerNonUserCode]
			public static XmlSchemaComplexType GetTypedTableSchema(XmlSchemaSet xs)
			{
				//IL_0000: Unknown result type (might be due to invalid IL or missing references)
				//IL_0006: Expected O, but got Unknown
				//IL_0006: Unknown result type (might be due to invalid IL or missing references)
				//IL_000c: Expected O, but got Unknown
				//IL_001f: Unknown result type (might be due to invalid IL or missing references)
				//IL_0025: Expected O, but got Unknown
				//IL_0060: Unknown result type (might be due to invalid IL or missing references)
				//IL_0067: Expected O, but got Unknown
				//IL_0096: Unknown result type (might be due to invalid IL or missing references)
				//IL_009d: Expected O, but got Unknown
				//IL_00c4: Unknown result type (might be due to invalid IL or missing references)
				//IL_00cb: Expected O, but got Unknown
				XmlSchemaComplexType val = new XmlSchemaComplexType();
				XmlSchemaSequence val2 = new XmlSchemaSequence();
				NewDataSet newDataSet = new NewDataSet();
				xs.Add(newDataSet.GetSchemaSerializable());
				XmlSchemaAny val3 = new XmlSchemaAny();
				val3.Namespace = "http://www.w3.org/2001/XMLSchema";
				((XmlSchemaParticle)val3).MinOccurs = 0m;
				((XmlSchemaParticle)val3).MaxOccurs = decimal.MaxValue;
				val3.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val3);
				XmlSchemaAny val4 = new XmlSchemaAny();
				val4.Namespace = "urn:schemas-microsoft-com:xml-diffgram-v1";
				((XmlSchemaParticle)val4).MinOccurs = 1m;
				val4.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val4);
				XmlSchemaAttribute val5 = new XmlSchemaAttribute();
				val5.Name = "namespace";
				val5.FixedValue = newDataSet.Namespace;
				val.Attributes.Add((XmlSchemaObject)(object)val5);
				XmlSchemaAttribute val6 = new XmlSchemaAttribute();
				val6.Name = "tableTypeName";
				val6.FixedValue = "GraphConfigurationDataTable";
				val.Attributes.Add((XmlSchemaObject)(object)val6);
				val.Particle = (XmlSchemaParticle)(object)val2;
				return val;
			}
		}

		[Serializable]
		[XmlSchemaProvider("GetTypedTableSchema")]
		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class GeneralDataTable : DataTable, IEnumerable
		{
			private DataColumn columnBackColor;

			private DataColumn columnTitle;

			private DataColumn columnTitlePosition;

			private DataColumn columnTitleVisble;

			private DataColumn columnIOCompSettings;

			private DataColumn columnGraphConfiguration_Id;

			[DebuggerNonUserCode]
			public DataColumn BackColorColumn => columnBackColor;

			[DebuggerNonUserCode]
			public DataColumn TitleColumn => columnTitle;

			[DebuggerNonUserCode]
			public DataColumn TitlePositionColumn => columnTitlePosition;

			[DebuggerNonUserCode]
			public DataColumn TitleVisbleColumn => columnTitleVisble;

			[DebuggerNonUserCode]
			public DataColumn IOCompSettingsColumn => columnIOCompSettings;

			[DebuggerNonUserCode]
			public DataColumn GraphConfiguration_IdColumn => columnGraphConfiguration_Id;

			[DebuggerNonUserCode]
			[Browsable(false)]
			public int Count => base.Rows.Count;

			[DebuggerNonUserCode]
			public GeneralRow this[int index] => (GeneralRow)base.Rows[index];

			public event GeneralRowChangeEventHandler GeneralRowChanging;

			public event GeneralRowChangeEventHandler GeneralRowChanged;

			public event GeneralRowChangeEventHandler GeneralRowDeleting;

			public event GeneralRowChangeEventHandler GeneralRowDeleted;

			[DebuggerNonUserCode]
			public GeneralDataTable()
			{
				base.TableName = "General";
				BeginInit();
				InitClass();
				EndInit();
			}

			[DebuggerNonUserCode]
			internal GeneralDataTable(DataTable table)
			{
				base.TableName = table.TableName;
				if (table.CaseSensitive != table.DataSet.CaseSensitive)
				{
					base.CaseSensitive = table.CaseSensitive;
				}
				if (table.Locale.ToString() != table.DataSet.Locale.ToString())
				{
					base.Locale = table.Locale;
				}
				if (table.Namespace != table.DataSet.Namespace)
				{
					base.Namespace = table.Namespace;
				}
				base.Prefix = table.Prefix;
				base.MinimumCapacity = table.MinimumCapacity;
			}

			[DebuggerNonUserCode]
			protected GeneralDataTable(SerializationInfo info, StreamingContext context)
				: base(info, context)
			{
				InitVars();
			}

			[DebuggerNonUserCode]
			public void AddGeneralRow(GeneralRow row)
			{
				base.Rows.Add(row);
			}

			[DebuggerNonUserCode]
			public GeneralRow AddGeneralRow(string BackColor, string Title, string TitlePosition, bool TitleVisble, string IOCompSettings, GraphConfigurationRow parentGraphConfigurationRowByGraphConfiguration_General)
			{
				GeneralRow generalRow = (GeneralRow)NewRow();
				generalRow.ItemArray = new object[6]
				{
					BackColor,
					Title,
					TitlePosition,
					TitleVisble,
					IOCompSettings,
					parentGraphConfigurationRowByGraphConfiguration_General[0]
				};
				base.Rows.Add(generalRow);
				return generalRow;
			}

			[DebuggerNonUserCode]
			public virtual IEnumerator GetEnumerator()
			{
				return base.Rows.GetEnumerator();
			}

			[DebuggerNonUserCode]
			public override DataTable Clone()
			{
				GeneralDataTable generalDataTable = (GeneralDataTable)base.Clone();
				generalDataTable.InitVars();
				return generalDataTable;
			}

			[DebuggerNonUserCode]
			protected override DataTable CreateInstance()
			{
				return new GeneralDataTable();
			}

			[DebuggerNonUserCode]
			internal void InitVars()
			{
				columnBackColor = base.Columns["BackColor"];
				columnTitle = base.Columns["Title"];
				columnTitlePosition = base.Columns["TitlePosition"];
				columnTitleVisble = base.Columns["TitleVisble"];
				columnIOCompSettings = base.Columns["IOCompSettings"];
				columnGraphConfiguration_Id = base.Columns["GraphConfiguration_Id"];
			}

			[DebuggerNonUserCode]
			private void InitClass()
			{
				columnBackColor = new DataColumn("BackColor", typeof(string), null, MappingType.Element);
				base.Columns.Add(columnBackColor);
				columnTitle = new DataColumn("Title", typeof(string), null, MappingType.Element);
				base.Columns.Add(columnTitle);
				columnTitlePosition = new DataColumn("TitlePosition", typeof(string), null, MappingType.Element);
				base.Columns.Add(columnTitlePosition);
				columnTitleVisble = new DataColumn("TitleVisble", typeof(bool), null, MappingType.Element);
				base.Columns.Add(columnTitleVisble);
				columnIOCompSettings = new DataColumn("IOCompSettings", typeof(string), null, MappingType.Element);
				base.Columns.Add(columnIOCompSettings);
				columnGraphConfiguration_Id = new DataColumn("GraphConfiguration_Id", typeof(int), null, MappingType.Hidden);
				base.Columns.Add(columnGraphConfiguration_Id);
				columnBackColor.AllowDBNull = false;
				columnTitle.AllowDBNull = false;
				columnTitlePosition.AllowDBNull = false;
				columnTitlePosition.DefaultValue = "Top";
				columnTitleVisble.AllowDBNull = false;
			}

			[DebuggerNonUserCode]
			public GeneralRow NewGeneralRow()
			{
				return (GeneralRow)NewRow();
			}

			[DebuggerNonUserCode]
			protected override DataRow NewRowFromBuilder(DataRowBuilder builder)
			{
				return new GeneralRow(builder);
			}

			[DebuggerNonUserCode]
			protected override Type GetRowType()
			{
				return typeof(GeneralRow);
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanged(DataRowChangeEventArgs e)
			{
				base.OnRowChanged(e);
				if (this.GeneralRowChanged != null)
				{
					this.GeneralRowChanged(this, new GeneralRowChangeEvent((GeneralRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanging(DataRowChangeEventArgs e)
			{
				base.OnRowChanging(e);
				if (this.GeneralRowChanging != null)
				{
					this.GeneralRowChanging(this, new GeneralRowChangeEvent((GeneralRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleted(DataRowChangeEventArgs e)
			{
				base.OnRowDeleted(e);
				if (this.GeneralRowDeleted != null)
				{
					this.GeneralRowDeleted(this, new GeneralRowChangeEvent((GeneralRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleting(DataRowChangeEventArgs e)
			{
				base.OnRowDeleting(e);
				if (this.GeneralRowDeleting != null)
				{
					this.GeneralRowDeleting(this, new GeneralRowChangeEvent((GeneralRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			public void RemoveGeneralRow(GeneralRow row)
			{
				base.Rows.Remove(row);
			}

			[DebuggerNonUserCode]
			public static XmlSchemaComplexType GetTypedTableSchema(XmlSchemaSet xs)
			{
				//IL_0000: Unknown result type (might be due to invalid IL or missing references)
				//IL_0006: Expected O, but got Unknown
				//IL_0006: Unknown result type (might be due to invalid IL or missing references)
				//IL_000c: Expected O, but got Unknown
				//IL_001f: Unknown result type (might be due to invalid IL or missing references)
				//IL_0025: Expected O, but got Unknown
				//IL_0060: Unknown result type (might be due to invalid IL or missing references)
				//IL_0067: Expected O, but got Unknown
				//IL_0096: Unknown result type (might be due to invalid IL or missing references)
				//IL_009d: Expected O, but got Unknown
				//IL_00c4: Unknown result type (might be due to invalid IL or missing references)
				//IL_00cb: Expected O, but got Unknown
				XmlSchemaComplexType val = new XmlSchemaComplexType();
				XmlSchemaSequence val2 = new XmlSchemaSequence();
				NewDataSet newDataSet = new NewDataSet();
				xs.Add(newDataSet.GetSchemaSerializable());
				XmlSchemaAny val3 = new XmlSchemaAny();
				val3.Namespace = "http://www.w3.org/2001/XMLSchema";
				((XmlSchemaParticle)val3).MinOccurs = 0m;
				((XmlSchemaParticle)val3).MaxOccurs = decimal.MaxValue;
				val3.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val3);
				XmlSchemaAny val4 = new XmlSchemaAny();
				val4.Namespace = "urn:schemas-microsoft-com:xml-diffgram-v1";
				((XmlSchemaParticle)val4).MinOccurs = 1m;
				val4.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val4);
				XmlSchemaAttribute val5 = new XmlSchemaAttribute();
				val5.Name = "namespace";
				val5.FixedValue = newDataSet.Namespace;
				val.Attributes.Add((XmlSchemaObject)(object)val5);
				XmlSchemaAttribute val6 = new XmlSchemaAttribute();
				val6.Name = "tableTypeName";
				val6.FixedValue = "GeneralDataTable";
				val.Attributes.Add((XmlSchemaObject)(object)val6);
				val.Particle = (XmlSchemaParticle)(object)val2;
				return val;
			}
		}

		[Serializable]
		[XmlSchemaProvider("GetTypedTableSchema")]
		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class XAxisDataTable : DataTable, IEnumerable
		{
			private DataColumn columnDisplayMode;

			private DataColumn columnStart;

			private DataColumn columnEnd;

			private DataColumn columnCursorColor;

			private DataColumn columnGraphConfiguration_Id;

			[DebuggerNonUserCode]
			public DataColumn DisplayModeColumn => columnDisplayMode;

			[DebuggerNonUserCode]
			public DataColumn StartColumn => columnStart;

			[DebuggerNonUserCode]
			public DataColumn EndColumn => columnEnd;

			[DebuggerNonUserCode]
			public DataColumn CursorColorColumn => columnCursorColor;

			[DebuggerNonUserCode]
			public DataColumn GraphConfiguration_IdColumn => columnGraphConfiguration_Id;

			[Browsable(false)]
			[DebuggerNonUserCode]
			public int Count => base.Rows.Count;

			[DebuggerNonUserCode]
			public XAxisRow this[int index] => (XAxisRow)base.Rows[index];

			public event XAxisRowChangeEventHandler XAxisRowChanging;

			public event XAxisRowChangeEventHandler XAxisRowChanged;

			public event XAxisRowChangeEventHandler XAxisRowDeleting;

			public event XAxisRowChangeEventHandler XAxisRowDeleted;

			[DebuggerNonUserCode]
			public XAxisDataTable()
			{
				base.TableName = "XAxis";
				BeginInit();
				InitClass();
				EndInit();
			}

			[DebuggerNonUserCode]
			internal XAxisDataTable(DataTable table)
			{
				base.TableName = table.TableName;
				if (table.CaseSensitive != table.DataSet.CaseSensitive)
				{
					base.CaseSensitive = table.CaseSensitive;
				}
				if (table.Locale.ToString() != table.DataSet.Locale.ToString())
				{
					base.Locale = table.Locale;
				}
				if (table.Namespace != table.DataSet.Namespace)
				{
					base.Namespace = table.Namespace;
				}
				base.Prefix = table.Prefix;
				base.MinimumCapacity = table.MinimumCapacity;
			}

			[DebuggerNonUserCode]
			protected XAxisDataTable(SerializationInfo info, StreamingContext context)
				: base(info, context)
			{
				InitVars();
			}

			[DebuggerNonUserCode]
			public void AddXAxisRow(XAxisRow row)
			{
				base.Rows.Add(row);
			}

			[DebuggerNonUserCode]
			public XAxisRow AddXAxisRow(string DisplayMode, long Start, long End, string CursorColor, GraphConfigurationRow parentGraphConfigurationRowByGraphConfiguration_XAxis)
			{
				XAxisRow xAxisRow = (XAxisRow)NewRow();
				xAxisRow.ItemArray = new object[5]
				{
					DisplayMode,
					Start,
					End,
					CursorColor,
					parentGraphConfigurationRowByGraphConfiguration_XAxis[0]
				};
				base.Rows.Add(xAxisRow);
				return xAxisRow;
			}

			[DebuggerNonUserCode]
			public virtual IEnumerator GetEnumerator()
			{
				return base.Rows.GetEnumerator();
			}

			[DebuggerNonUserCode]
			public override DataTable Clone()
			{
				XAxisDataTable xAxisDataTable = (XAxisDataTable)base.Clone();
				xAxisDataTable.InitVars();
				return xAxisDataTable;
			}

			[DebuggerNonUserCode]
			protected override DataTable CreateInstance()
			{
				return new XAxisDataTable();
			}

			[DebuggerNonUserCode]
			internal void InitVars()
			{
				columnDisplayMode = base.Columns["DisplayMode"];
				columnStart = base.Columns["Start"];
				columnEnd = base.Columns["End"];
				columnCursorColor = base.Columns["CursorColor"];
				columnGraphConfiguration_Id = base.Columns["GraphConfiguration_Id"];
			}

			[DebuggerNonUserCode]
			private void InitClass()
			{
				columnDisplayMode = new DataColumn("DisplayMode", typeof(string), null, MappingType.Element);
				base.Columns.Add(columnDisplayMode);
				columnStart = new DataColumn("Start", typeof(long), null, MappingType.Element);
				base.Columns.Add(columnStart);
				columnEnd = new DataColumn("End", typeof(long), null, MappingType.Element);
				base.Columns.Add(columnEnd);
				columnCursorColor = new DataColumn("CursorColor", typeof(string), null, MappingType.Element);
				base.Columns.Add(columnCursorColor);
				columnGraphConfiguration_Id = new DataColumn("GraphConfiguration_Id", typeof(int), null, MappingType.Hidden);
				base.Columns.Add(columnGraphConfiguration_Id);
				columnDisplayMode.AllowDBNull = false;
				columnDisplayMode.DefaultValue = "StripChart";
				columnStart.AllowDBNull = false;
				columnEnd.AllowDBNull = false;
				columnCursorColor.AllowDBNull = false;
			}

			[DebuggerNonUserCode]
			public XAxisRow NewXAxisRow()
			{
				return (XAxisRow)NewRow();
			}

			[DebuggerNonUserCode]
			protected override DataRow NewRowFromBuilder(DataRowBuilder builder)
			{
				return new XAxisRow(builder);
			}

			[DebuggerNonUserCode]
			protected override Type GetRowType()
			{
				return typeof(XAxisRow);
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanged(DataRowChangeEventArgs e)
			{
				base.OnRowChanged(e);
				if (this.XAxisRowChanged != null)
				{
					this.XAxisRowChanged(this, new XAxisRowChangeEvent((XAxisRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanging(DataRowChangeEventArgs e)
			{
				base.OnRowChanging(e);
				if (this.XAxisRowChanging != null)
				{
					this.XAxisRowChanging(this, new XAxisRowChangeEvent((XAxisRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleted(DataRowChangeEventArgs e)
			{
				base.OnRowDeleted(e);
				if (this.XAxisRowDeleted != null)
				{
					this.XAxisRowDeleted(this, new XAxisRowChangeEvent((XAxisRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleting(DataRowChangeEventArgs e)
			{
				base.OnRowDeleting(e);
				if (this.XAxisRowDeleting != null)
				{
					this.XAxisRowDeleting(this, new XAxisRowChangeEvent((XAxisRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			public void RemoveXAxisRow(XAxisRow row)
			{
				base.Rows.Remove(row);
			}

			[DebuggerNonUserCode]
			public static XmlSchemaComplexType GetTypedTableSchema(XmlSchemaSet xs)
			{
				//IL_0000: Unknown result type (might be due to invalid IL or missing references)
				//IL_0006: Expected O, but got Unknown
				//IL_0006: Unknown result type (might be due to invalid IL or missing references)
				//IL_000c: Expected O, but got Unknown
				//IL_001f: Unknown result type (might be due to invalid IL or missing references)
				//IL_0025: Expected O, but got Unknown
				//IL_0060: Unknown result type (might be due to invalid IL or missing references)
				//IL_0067: Expected O, but got Unknown
				//IL_0096: Unknown result type (might be due to invalid IL or missing references)
				//IL_009d: Expected O, but got Unknown
				//IL_00c4: Unknown result type (might be due to invalid IL or missing references)
				//IL_00cb: Expected O, but got Unknown
				XmlSchemaComplexType val = new XmlSchemaComplexType();
				XmlSchemaSequence val2 = new XmlSchemaSequence();
				NewDataSet newDataSet = new NewDataSet();
				xs.Add(newDataSet.GetSchemaSerializable());
				XmlSchemaAny val3 = new XmlSchemaAny();
				val3.Namespace = "http://www.w3.org/2001/XMLSchema";
				((XmlSchemaParticle)val3).MinOccurs = 0m;
				((XmlSchemaParticle)val3).MaxOccurs = decimal.MaxValue;
				val3.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val3);
				XmlSchemaAny val4 = new XmlSchemaAny();
				val4.Namespace = "urn:schemas-microsoft-com:xml-diffgram-v1";
				((XmlSchemaParticle)val4).MinOccurs = 1m;
				val4.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val4);
				XmlSchemaAttribute val5 = new XmlSchemaAttribute();
				val5.Name = "namespace";
				val5.FixedValue = newDataSet.Namespace;
				val.Attributes.Add((XmlSchemaObject)(object)val5);
				XmlSchemaAttribute val6 = new XmlSchemaAttribute();
				val6.Name = "tableTypeName";
				val6.FixedValue = "XAxisDataTable";
				val.Attributes.Add((XmlSchemaObject)(object)val6);
				val.Particle = (XmlSchemaParticle)(object)val2;
				return val;
			}
		}

		[Serializable]
		[XmlSchemaProvider("GetTypedTableSchema")]
		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class YAxesDataTable : DataTable, IEnumerable
		{
			private DataColumn columnAutoScale;

			private DataColumn columnScaleType;

			private DataColumn columnAxisPosition;

			private DataColumn columnMinValue;

			private DataColumn columnMaxValue;

			private DataColumn columnHideScale;

			private DataColumn columnHideCaption;

			private DataColumn columnYAxisDisplayMode;

			private DataColumn columnGraphConfiguration_Id;

			[DebuggerNonUserCode]
			public DataColumn AutoScaleColumn => columnAutoScale;

			[DebuggerNonUserCode]
			public DataColumn ScaleTypeColumn => columnScaleType;

			[DebuggerNonUserCode]
			public DataColumn AxisPositionColumn => columnAxisPosition;

			[DebuggerNonUserCode]
			public DataColumn MinValueColumn => columnMinValue;

			[DebuggerNonUserCode]
			public DataColumn MaxValueColumn => columnMaxValue;

			[DebuggerNonUserCode]
			public DataColumn HideScaleColumn => columnHideScale;

			[DebuggerNonUserCode]
			public DataColumn HideCaptionColumn => columnHideCaption;

			[DebuggerNonUserCode]
			public DataColumn YAxisDisplayModeColumn => columnYAxisDisplayMode;

			[DebuggerNonUserCode]
			public DataColumn GraphConfiguration_IdColumn => columnGraphConfiguration_Id;

			[Browsable(false)]
			[DebuggerNonUserCode]
			public int Count => base.Rows.Count;

			[DebuggerNonUserCode]
			public YAxesRow this[int index] => (YAxesRow)base.Rows[index];

			public event YAxesRowChangeEventHandler YAxesRowChanging;

			public event YAxesRowChangeEventHandler YAxesRowChanged;

			public event YAxesRowChangeEventHandler YAxesRowDeleting;

			public event YAxesRowChangeEventHandler YAxesRowDeleted;

			[DebuggerNonUserCode]
			public YAxesDataTable()
			{
				base.TableName = "YAxes";
				BeginInit();
				InitClass();
				EndInit();
			}

			[DebuggerNonUserCode]
			internal YAxesDataTable(DataTable table)
			{
				base.TableName = table.TableName;
				if (table.CaseSensitive != table.DataSet.CaseSensitive)
				{
					base.CaseSensitive = table.CaseSensitive;
				}
				if (table.Locale.ToString() != table.DataSet.Locale.ToString())
				{
					base.Locale = table.Locale;
				}
				if (table.Namespace != table.DataSet.Namespace)
				{
					base.Namespace = table.Namespace;
				}
				base.Prefix = table.Prefix;
				base.MinimumCapacity = table.MinimumCapacity;
			}

			[DebuggerNonUserCode]
			protected YAxesDataTable(SerializationInfo info, StreamingContext context)
				: base(info, context)
			{
				InitVars();
			}

			[DebuggerNonUserCode]
			public void AddYAxesRow(YAxesRow row)
			{
				base.Rows.Add(row);
			}

			[DebuggerNonUserCode]
			public YAxesRow AddYAxesRow(bool AutoScale, string ScaleType, string AxisPosition, double MinValue, double MaxValue, bool HideScale, bool HideCaption, string YAxisDisplayMode, GraphConfigurationRow parentGraphConfigurationRowByGraphConfiguration_YAxes)
			{
				YAxesRow yAxesRow = (YAxesRow)NewRow();
				yAxesRow.ItemArray = new object[9]
				{
					AutoScale,
					ScaleType,
					AxisPosition,
					MinValue,
					MaxValue,
					HideScale,
					HideCaption,
					YAxisDisplayMode,
					parentGraphConfigurationRowByGraphConfiguration_YAxes[0]
				};
				base.Rows.Add(yAxesRow);
				return yAxesRow;
			}

			[DebuggerNonUserCode]
			public virtual IEnumerator GetEnumerator()
			{
				return base.Rows.GetEnumerator();
			}

			[DebuggerNonUserCode]
			public override DataTable Clone()
			{
				YAxesDataTable yAxesDataTable = (YAxesDataTable)base.Clone();
				yAxesDataTable.InitVars();
				return yAxesDataTable;
			}

			[DebuggerNonUserCode]
			protected override DataTable CreateInstance()
			{
				return new YAxesDataTable();
			}

			[DebuggerNonUserCode]
			internal void InitVars()
			{
				columnAutoScale = base.Columns["AutoScale"];
				columnScaleType = base.Columns["ScaleType"];
				columnAxisPosition = base.Columns["AxisPosition"];
				columnMinValue = base.Columns["MinValue"];
				columnMaxValue = base.Columns["MaxValue"];
				columnHideScale = base.Columns["HideScale"];
				columnHideCaption = base.Columns["HideCaption"];
				columnYAxisDisplayMode = base.Columns["YAxisDisplayMode"];
				columnGraphConfiguration_Id = base.Columns["GraphConfiguration_Id"];
			}

			[DebuggerNonUserCode]
			private void InitClass()
			{
				columnAutoScale = new DataColumn("AutoScale", typeof(bool), null, MappingType.Element);
				base.Columns.Add(columnAutoScale);
				columnScaleType = new DataColumn("ScaleType", typeof(string), null, MappingType.Element);
				base.Columns.Add(columnScaleType);
				columnAxisPosition = new DataColumn("AxisPosition", typeof(string), null, MappingType.Element);
				base.Columns.Add(columnAxisPosition);
				columnMinValue = new DataColumn("MinValue", typeof(double), null, MappingType.Element);
				base.Columns.Add(columnMinValue);
				columnMaxValue = new DataColumn("MaxValue", typeof(double), null, MappingType.Element);
				base.Columns.Add(columnMaxValue);
				columnHideScale = new DataColumn("HideScale", typeof(bool), null, MappingType.Element);
				base.Columns.Add(columnHideScale);
				columnHideCaption = new DataColumn("HideCaption", typeof(bool), null, MappingType.Element);
				base.Columns.Add(columnHideCaption);
				columnYAxisDisplayMode = new DataColumn("YAxisDisplayMode", typeof(string), null, MappingType.Element);
				base.Columns.Add(columnYAxisDisplayMode);
				columnGraphConfiguration_Id = new DataColumn("GraphConfiguration_Id", typeof(int), null, MappingType.Hidden);
				base.Columns.Add(columnGraphConfiguration_Id);
				columnAutoScale.DefaultValue = false;
				columnScaleType.DefaultValue = "Linear";
				columnAxisPosition.DefaultValue = "Left";
				columnMinValue.DefaultValue = 0.0;
				columnMaxValue.DefaultValue = 100.0;
				columnYAxisDisplayMode.DefaultValue = "Individual";
			}

			[DebuggerNonUserCode]
			public YAxesRow NewYAxesRow()
			{
				return (YAxesRow)NewRow();
			}

			[DebuggerNonUserCode]
			protected override DataRow NewRowFromBuilder(DataRowBuilder builder)
			{
				return new YAxesRow(builder);
			}

			[DebuggerNonUserCode]
			protected override Type GetRowType()
			{
				return typeof(YAxesRow);
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanged(DataRowChangeEventArgs e)
			{
				base.OnRowChanged(e);
				if (this.YAxesRowChanged != null)
				{
					this.YAxesRowChanged(this, new YAxesRowChangeEvent((YAxesRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowChanging(DataRowChangeEventArgs e)
			{
				base.OnRowChanging(e);
				if (this.YAxesRowChanging != null)
				{
					this.YAxesRowChanging(this, new YAxesRowChangeEvent((YAxesRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleted(DataRowChangeEventArgs e)
			{
				base.OnRowDeleted(e);
				if (this.YAxesRowDeleted != null)
				{
					this.YAxesRowDeleted(this, new YAxesRowChangeEvent((YAxesRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			protected override void OnRowDeleting(DataRowChangeEventArgs e)
			{
				base.OnRowDeleting(e);
				if (this.YAxesRowDeleting != null)
				{
					this.YAxesRowDeleting(this, new YAxesRowChangeEvent((YAxesRow)e.Row, e.Action));
				}
			}

			[DebuggerNonUserCode]
			public void RemoveYAxesRow(YAxesRow row)
			{
				base.Rows.Remove(row);
			}

			[DebuggerNonUserCode]
			public static XmlSchemaComplexType GetTypedTableSchema(XmlSchemaSet xs)
			{
				//IL_0000: Unknown result type (might be due to invalid IL or missing references)
				//IL_0006: Expected O, but got Unknown
				//IL_0006: Unknown result type (might be due to invalid IL or missing references)
				//IL_000c: Expected O, but got Unknown
				//IL_001f: Unknown result type (might be due to invalid IL or missing references)
				//IL_0025: Expected O, but got Unknown
				//IL_0060: Unknown result type (might be due to invalid IL or missing references)
				//IL_0067: Expected O, but got Unknown
				//IL_0096: Unknown result type (might be due to invalid IL or missing references)
				//IL_009d: Expected O, but got Unknown
				//IL_00c4: Unknown result type (might be due to invalid IL or missing references)
				//IL_00cb: Expected O, but got Unknown
				XmlSchemaComplexType val = new XmlSchemaComplexType();
				XmlSchemaSequence val2 = new XmlSchemaSequence();
				NewDataSet newDataSet = new NewDataSet();
				xs.Add(newDataSet.GetSchemaSerializable());
				XmlSchemaAny val3 = new XmlSchemaAny();
				val3.Namespace = "http://www.w3.org/2001/XMLSchema";
				((XmlSchemaParticle)val3).MinOccurs = 0m;
				((XmlSchemaParticle)val3).MaxOccurs = decimal.MaxValue;
				val3.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val3);
				XmlSchemaAny val4 = new XmlSchemaAny();
				val4.Namespace = "urn:schemas-microsoft-com:xml-diffgram-v1";
				((XmlSchemaParticle)val4).MinOccurs = 1m;
				val4.ProcessContents = (XmlSchemaContentProcessing)2;
				((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val4);
				XmlSchemaAttribute val5 = new XmlSchemaAttribute();
				val5.Name = "namespace";
				val5.FixedValue = newDataSet.Namespace;
				val.Attributes.Add((XmlSchemaObject)(object)val5);
				XmlSchemaAttribute val6 = new XmlSchemaAttribute();
				val6.Name = "tableTypeName";
				val6.FixedValue = "YAxesDataTable";
				val.Attributes.Add((XmlSchemaObject)(object)val6);
				val.Particle = (XmlSchemaParticle)(object)val2;
				return val;
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class MonitorSessionRow : DataRow
		{
			private MonitorSessionDataTable tableMonitorSession;

			[DebuggerNonUserCode]
			public string Version
			{
				get
				{
					return (string)base[tableMonitorSession.VersionColumn];
				}
				set
				{
					base[tableMonitorSession.VersionColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string ActiveScreen
			{
				get
				{
					try
					{
						return (string)base[tableMonitorSession.ActiveScreenColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'ActiveScreen' in table 'MonitorSession' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableMonitorSession.ActiveScreenColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string Dotnetbarlayouts
			{
				get
				{
					try
					{
						return (string)base[tableMonitorSession.DotnetbarlayoutsColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'Dotnetbarlayouts' in table 'MonitorSession' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableMonitorSession.DotnetbarlayoutsColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int MonitorSession_Id
			{
				get
				{
					return (int)base[tableMonitorSession.MonitorSession_IdColumn];
				}
				set
				{
					base[tableMonitorSession.MonitorSession_IdColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			internal MonitorSessionRow(DataRowBuilder rb)
				: base(rb)
			{
				tableMonitorSession = (MonitorSessionDataTable)base.Table;
			}

			[DebuggerNonUserCode]
			public bool IsActiveScreenNull()
			{
				return IsNull(tableMonitorSession.ActiveScreenColumn);
			}

			[DebuggerNonUserCode]
			public void SetActiveScreenNull()
			{
				base[tableMonitorSession.ActiveScreenColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsDotnetbarlayoutsNull()
			{
				return IsNull(tableMonitorSession.DotnetbarlayoutsColumn);
			}

			[DebuggerNonUserCode]
			public void SetDotnetbarlayoutsNull()
			{
				base[tableMonitorSession.DotnetbarlayoutsColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public ScreenRow[] GetScreenRows()
			{
				return (ScreenRow[])GetChildRows(base.Table.ChildRelations["MonitorSession_Screen"]);
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class ScreenRow : DataRow
		{
			private ScreenDataTable tableScreen;

			[DebuggerNonUserCode]
			public string Name
			{
				get
				{
					try
					{
						return (string)base[tableScreen.NameColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'Name' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.NameColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string Title
			{
				get
				{
					try
					{
						return (string)base[tableScreen.TitleColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'Title' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.TitleColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public ushort DataRefreshRate
			{
				get
				{
					try
					{
						return (ushort)base[tableScreen.DataRefreshRateColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'DataRefreshRate' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.DataRefreshRateColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public ushort BAMRefreshRate
			{
				get
				{
					try
					{
						return (ushort)base[tableScreen.BAMRefreshRateColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'BAMRefreshRate' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.BAMRefreshRateColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public ushort IDLRefreshRate
			{
				get
				{
					try
					{
						return (ushort)base[tableScreen.IDLRefreshRateColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'IDLRefreshRate' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.IDLRefreshRateColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public ushort UIRefreshRate
			{
				get
				{
					try
					{
						return (ushort)base[tableScreen.UIRefreshRateColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'UIRefreshRate' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.UIRefreshRateColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public ushort EDMRefreshRate
			{
				get
				{
					try
					{
						return (ushort)base[tableScreen.EDMRefreshRateColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'EDMRefreshRate' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.EDMRefreshRateColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string DataRefreshUnits
			{
				get
				{
					try
					{
						return (string)base[tableScreen.DataRefreshUnitsColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'DataRefreshUnits' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.DataRefreshUnitsColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string UIRefreshUnits
			{
				get
				{
					try
					{
						return (string)base[tableScreen.UIRefreshUnitsColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'UIRefreshUnits' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.UIRefreshUnitsColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string MonitorType
			{
				get
				{
					try
					{
						return (string)base[tableScreen.MonitorTypeColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'MonitorType' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.MonitorTypeColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string BAMTrigger
			{
				get
				{
					try
					{
						return (string)base[tableScreen.BAMTriggerColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'BAMTrigger' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.BAMTriggerColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string IDLTrigger
			{
				get
				{
					try
					{
						return (string)base[tableScreen.IDLTriggerColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'IDLTrigger' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.IDLTriggerColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string Radix
			{
				get
				{
					try
					{
						return (string)base[tableScreen.RadixColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'Radix' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.RadixColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string ScreenType
			{
				get
				{
					try
					{
						return (string)base[tableScreen.ScreenTypeColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'ScreenType' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.ScreenTypeColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string Status
			{
				get
				{
					try
					{
						return (string)base[tableScreen.StatusColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'Status' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.StatusColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string LogMode
			{
				get
				{
					try
					{
						return (string)base[tableScreen.LogModeColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'LogMode' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.LogModeColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int LogRate
			{
				get
				{
					try
					{
						return (int)base[tableScreen.LogRateColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'LogRate' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.LogRateColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string LogUnit
			{
				get
				{
					try
					{
						return (string)base[tableScreen.LogUnitColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'LogUnit' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.LogUnitColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string LogPrefix
			{
				get
				{
					try
					{
						return (string)base[tableScreen.LogPrefixColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'LogPrefix' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.LogPrefixColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public bool PCTimestamp
			{
				get
				{
					try
					{
						return (bool)base[tableScreen.PCTimestampColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'PCTimestamp' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.PCTimestampColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public bool ActiveFaults
			{
				get
				{
					try
					{
						return (bool)base[tableScreen.ActiveFaultsColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'ActiveFaults' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.ActiveFaultsColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public bool InactiveFaults
			{
				get
				{
					try
					{
						return (bool)base[tableScreen.InactiveFaultsColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'InactiveFaults' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.InactiveFaultsColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string StartCondition
			{
				get
				{
					try
					{
						return (string)base[tableScreen.StartConditionColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'StartCondition' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.StartConditionColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string StopCondition
			{
				get
				{
					try
					{
						return (string)base[tableScreen.StopConditionColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'StopCondition' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.StopConditionColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int PreTrigger
			{
				get
				{
					try
					{
						return (int)base[tableScreen.PreTriggerColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'PreTrigger' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.PreTriggerColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int PostTrigger
			{
				get
				{
					try
					{
						return (int)base[tableScreen.PostTriggerColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'PostTrigger' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.PostTriggerColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int RepeatCount
			{
				get
				{
					try
					{
						return (int)base[tableScreen.RepeatCountColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'RepeatCount' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.RepeatCountColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int PositionX
			{
				get
				{
					try
					{
						return (int)base[tableScreen.PositionXColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'PositionX' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.PositionXColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int PositionY
			{
				get
				{
					try
					{
						return (int)base[tableScreen.PositionYColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'PositionY' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.PositionYColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int Height
			{
				get
				{
					try
					{
						return (int)base[tableScreen.HeightColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'Height' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.HeightColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int Width
			{
				get
				{
					try
					{
						return (int)base[tableScreen.WidthColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'Width' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.WidthColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string Dock
			{
				get
				{
					try
					{
						return (string)base[tableScreen.DockColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'Dock' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.DockColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int Screen_Id
			{
				get
				{
					return (int)base[tableScreen.Screen_IdColumn];
				}
				set
				{
					base[tableScreen.Screen_IdColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int MonitorSession_Id
			{
				get
				{
					try
					{
						return (int)base[tableScreen.MonitorSession_IdColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'MonitorSession_Id' in table 'Screen' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableScreen.MonitorSession_IdColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public MonitorSessionRow MonitorSessionRow
			{
				get
				{
					return (MonitorSessionRow)GetParentRow(base.Table.ParentRelations["MonitorSession_Screen"]);
				}
				set
				{
					SetParentRow(value, base.Table.ParentRelations["MonitorSession_Screen"]);
				}
			}

			[DebuggerNonUserCode]
			internal ScreenRow(DataRowBuilder rb)
				: base(rb)
			{
				tableScreen = (ScreenDataTable)base.Table;
			}

			[DebuggerNonUserCode]
			public bool IsNameNull()
			{
				return IsNull(tableScreen.NameColumn);
			}

			[DebuggerNonUserCode]
			public void SetNameNull()
			{
				base[tableScreen.NameColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsTitleNull()
			{
				return IsNull(tableScreen.TitleColumn);
			}

			[DebuggerNonUserCode]
			public void SetTitleNull()
			{
				base[tableScreen.TitleColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsDataRefreshRateNull()
			{
				return IsNull(tableScreen.DataRefreshRateColumn);
			}

			[DebuggerNonUserCode]
			public void SetDataRefreshRateNull()
			{
				base[tableScreen.DataRefreshRateColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsBAMRefreshRateNull()
			{
				return IsNull(tableScreen.BAMRefreshRateColumn);
			}

			[DebuggerNonUserCode]
			public void SetBAMRefreshRateNull()
			{
				base[tableScreen.BAMRefreshRateColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsIDLRefreshRateNull()
			{
				return IsNull(tableScreen.IDLRefreshRateColumn);
			}

			[DebuggerNonUserCode]
			public void SetIDLRefreshRateNull()
			{
				base[tableScreen.IDLRefreshRateColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsUIRefreshRateNull()
			{
				return IsNull(tableScreen.UIRefreshRateColumn);
			}

			[DebuggerNonUserCode]
			public void SetUIRefreshRateNull()
			{
				base[tableScreen.UIRefreshRateColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsEDMRefreshRateNull()
			{
				return IsNull(tableScreen.EDMRefreshRateColumn);
			}

			[DebuggerNonUserCode]
			public void SetEDMRefreshRateNull()
			{
				base[tableScreen.EDMRefreshRateColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsDataRefreshUnitsNull()
			{
				return IsNull(tableScreen.DataRefreshUnitsColumn);
			}

			[DebuggerNonUserCode]
			public void SetDataRefreshUnitsNull()
			{
				base[tableScreen.DataRefreshUnitsColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsUIRefreshUnitsNull()
			{
				return IsNull(tableScreen.UIRefreshUnitsColumn);
			}

			[DebuggerNonUserCode]
			public void SetUIRefreshUnitsNull()
			{
				base[tableScreen.UIRefreshUnitsColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsMonitorTypeNull()
			{
				return IsNull(tableScreen.MonitorTypeColumn);
			}

			[DebuggerNonUserCode]
			public void SetMonitorTypeNull()
			{
				base[tableScreen.MonitorTypeColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsBAMTriggerNull()
			{
				return IsNull(tableScreen.BAMTriggerColumn);
			}

			[DebuggerNonUserCode]
			public void SetBAMTriggerNull()
			{
				base[tableScreen.BAMTriggerColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsIDLTriggerNull()
			{
				return IsNull(tableScreen.IDLTriggerColumn);
			}

			[DebuggerNonUserCode]
			public void SetIDLTriggerNull()
			{
				base[tableScreen.IDLTriggerColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsRadixNull()
			{
				return IsNull(tableScreen.RadixColumn);
			}

			[DebuggerNonUserCode]
			public void SetRadixNull()
			{
				base[tableScreen.RadixColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsScreenTypeNull()
			{
				return IsNull(tableScreen.ScreenTypeColumn);
			}

			[DebuggerNonUserCode]
			public void SetScreenTypeNull()
			{
				base[tableScreen.ScreenTypeColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsStatusNull()
			{
				return IsNull(tableScreen.StatusColumn);
			}

			[DebuggerNonUserCode]
			public void SetStatusNull()
			{
				base[tableScreen.StatusColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsLogModeNull()
			{
				return IsNull(tableScreen.LogModeColumn);
			}

			[DebuggerNonUserCode]
			public void SetLogModeNull()
			{
				base[tableScreen.LogModeColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsLogRateNull()
			{
				return IsNull(tableScreen.LogRateColumn);
			}

			[DebuggerNonUserCode]
			public void SetLogRateNull()
			{
				base[tableScreen.LogRateColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsLogUnitNull()
			{
				return IsNull(tableScreen.LogUnitColumn);
			}

			[DebuggerNonUserCode]
			public void SetLogUnitNull()
			{
				base[tableScreen.LogUnitColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsLogPrefixNull()
			{
				return IsNull(tableScreen.LogPrefixColumn);
			}

			[DebuggerNonUserCode]
			public void SetLogPrefixNull()
			{
				base[tableScreen.LogPrefixColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsPCTimestampNull()
			{
				return IsNull(tableScreen.PCTimestampColumn);
			}

			[DebuggerNonUserCode]
			public void SetPCTimestampNull()
			{
				base[tableScreen.PCTimestampColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsActiveFaultsNull()
			{
				return IsNull(tableScreen.ActiveFaultsColumn);
			}

			[DebuggerNonUserCode]
			public void SetActiveFaultsNull()
			{
				base[tableScreen.ActiveFaultsColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsInactiveFaultsNull()
			{
				return IsNull(tableScreen.InactiveFaultsColumn);
			}

			[DebuggerNonUserCode]
			public void SetInactiveFaultsNull()
			{
				base[tableScreen.InactiveFaultsColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsStartConditionNull()
			{
				return IsNull(tableScreen.StartConditionColumn);
			}

			[DebuggerNonUserCode]
			public void SetStartConditionNull()
			{
				base[tableScreen.StartConditionColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsStopConditionNull()
			{
				return IsNull(tableScreen.StopConditionColumn);
			}

			[DebuggerNonUserCode]
			public void SetStopConditionNull()
			{
				base[tableScreen.StopConditionColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsPreTriggerNull()
			{
				return IsNull(tableScreen.PreTriggerColumn);
			}

			[DebuggerNonUserCode]
			public void SetPreTriggerNull()
			{
				base[tableScreen.PreTriggerColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsPostTriggerNull()
			{
				return IsNull(tableScreen.PostTriggerColumn);
			}

			[DebuggerNonUserCode]
			public void SetPostTriggerNull()
			{
				base[tableScreen.PostTriggerColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsRepeatCountNull()
			{
				return IsNull(tableScreen.RepeatCountColumn);
			}

			[DebuggerNonUserCode]
			public void SetRepeatCountNull()
			{
				base[tableScreen.RepeatCountColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsPositionXNull()
			{
				return IsNull(tableScreen.PositionXColumn);
			}

			[DebuggerNonUserCode]
			public void SetPositionXNull()
			{
				base[tableScreen.PositionXColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsPositionYNull()
			{
				return IsNull(tableScreen.PositionYColumn);
			}

			[DebuggerNonUserCode]
			public void SetPositionYNull()
			{
				base[tableScreen.PositionYColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsHeightNull()
			{
				return IsNull(tableScreen.HeightColumn);
			}

			[DebuggerNonUserCode]
			public void SetHeightNull()
			{
				base[tableScreen.HeightColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsWidthNull()
			{
				return IsNull(tableScreen.WidthColumn);
			}

			[DebuggerNonUserCode]
			public void SetWidthNull()
			{
				base[tableScreen.WidthColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsDockNull()
			{
				return IsNull(tableScreen.DockColumn);
			}

			[DebuggerNonUserCode]
			public void SetDockNull()
			{
				base[tableScreen.DockColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsMonitorSession_IdNull()
			{
				return IsNull(tableScreen.MonitorSession_IdColumn);
			}

			[DebuggerNonUserCode]
			public void SetMonitorSession_IdNull()
			{
				base[tableScreen.MonitorSession_IdColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public GroupRow[] GetGroupRows()
			{
				return (GroupRow[])GetChildRows(base.Table.ChildRelations["Screen_Group"]);
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class GroupRow : DataRow
		{
			private GroupDataTable tableGroup;

			[DebuggerNonUserCode]
			public string Name
			{
				get
				{
					return (string)base[tableGroup.NameColumn];
				}
				set
				{
					base[tableGroup.NameColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string Comment
			{
				get
				{
					try
					{
						return (string)base[tableGroup.CommentColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'Comment' in table 'Group' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableGroup.CommentColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public bool ShowUnits
			{
				get
				{
					try
					{
						return (bool)base[tableGroup.ShowUnitsColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'ShowUnits' in table 'Group' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableGroup.ShowUnitsColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public bool ShowSourceAddress
			{
				get
				{
					try
					{
						return (bool)base[tableGroup.ShowSourceAddressColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'ShowSourceAddress' in table 'Group' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableGroup.ShowSourceAddressColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string SortExpression
			{
				get
				{
					try
					{
						return (string)base[tableGroup.SortExpressionColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'SortExpression' in table 'Group' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableGroup.SortExpressionColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string ColumnWidths
			{
				get
				{
					try
					{
						return (string)base[tableGroup.ColumnWidthsColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'ColumnWidths' in table 'Group' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableGroup.ColumnWidthsColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int Group_Id
			{
				get
				{
					return (int)base[tableGroup.Group_IdColumn];
				}
				set
				{
					base[tableGroup.Group_IdColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int Screen_Id
			{
				get
				{
					try
					{
						return (int)base[tableGroup.Screen_IdColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'Screen_Id' in table 'Group' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableGroup.Screen_IdColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public ScreenRow ScreenRow
			{
				get
				{
					return (ScreenRow)GetParentRow(base.Table.ParentRelations["Screen_Group"]);
				}
				set
				{
					SetParentRow(value, base.Table.ParentRelations["Screen_Group"]);
				}
			}

			[DebuggerNonUserCode]
			internal GroupRow(DataRowBuilder rb)
				: base(rb)
			{
				tableGroup = (GroupDataTable)base.Table;
			}

			[DebuggerNonUserCode]
			public bool IsCommentNull()
			{
				return IsNull(tableGroup.CommentColumn);
			}

			[DebuggerNonUserCode]
			public void SetCommentNull()
			{
				base[tableGroup.CommentColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsShowUnitsNull()
			{
				return IsNull(tableGroup.ShowUnitsColumn);
			}

			[DebuggerNonUserCode]
			public void SetShowUnitsNull()
			{
				base[tableGroup.ShowUnitsColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsShowSourceAddressNull()
			{
				return IsNull(tableGroup.ShowSourceAddressColumn);
			}

			[DebuggerNonUserCode]
			public void SetShowSourceAddressNull()
			{
				base[tableGroup.ShowSourceAddressColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsSortExpressionNull()
			{
				return IsNull(tableGroup.SortExpressionColumn);
			}

			[DebuggerNonUserCode]
			public void SetSortExpressionNull()
			{
				base[tableGroup.SortExpressionColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsColumnWidthsNull()
			{
				return IsNull(tableGroup.ColumnWidthsColumn);
			}

			[DebuggerNonUserCode]
			public void SetColumnWidthsNull()
			{
				base[tableGroup.ColumnWidthsColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsScreen_IdNull()
			{
				return IsNull(tableGroup.Screen_IdColumn);
			}

			[DebuggerNonUserCode]
			public void SetScreen_IdNull()
			{
				base[tableGroup.Screen_IdColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public ParameterRow[] GetParameterRows()
			{
				return (ParameterRow[])GetChildRows(base.Table.ChildRelations["Group_Parameter"]);
			}

			[DebuggerNonUserCode]
			public GaugeConfigurationRow[] GetGaugeConfigurationRows()
			{
				return (GaugeConfigurationRow[])GetChildRows(base.Table.ChildRelations["Group_GaugeConfiguration"]);
			}

			[DebuggerNonUserCode]
			public GraphConfigurationRow[] GetGraphConfigurationRows()
			{
				return (GraphConfigurationRow[])GetChildRows(base.Table.ChildRelations["Group_GraphConfiguration"]);
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class ParameterRow : DataRow
		{
			private ParameterDataTable tableParameter;

			[DebuggerNonUserCode]
			public string SourceAddress
			{
				get
				{
					return (string)base[tableParameter.SourceAddressColumn];
				}
				set
				{
					base[tableParameter.SourceAddressColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string Name
			{
				get
				{
					return (string)base[tableParameter.NameColumn];
				}
				set
				{
					base[tableParameter.NameColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string Units
			{
				get
				{
					return (string)base[tableParameter.UnitsColumn];
				}
				set
				{
					base[tableParameter.UnitsColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string Color
			{
				get
				{
					try
					{
						return (string)base[tableParameter.ColorColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'Color' in table 'Parameter' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableParameter.ColorColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public short GaugeIndex
			{
				get
				{
					try
					{
						return (short)base[tableParameter.GaugeIndexColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'GaugeIndex' in table 'Parameter' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableParameter.GaugeIndexColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string ViewType
			{
				get
				{
					try
					{
						return (string)base[tableParameter.ViewTypeColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'ViewType' in table 'Parameter' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableParameter.ViewTypeColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public bool IsBroadcast
			{
				get
				{
					return (bool)base[tableParameter.IsBroadcastColumn];
				}
				set
				{
					base[tableParameter.IsBroadcastColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int Parameter_Id
			{
				get
				{
					return (int)base[tableParameter.Parameter_IdColumn];
				}
				set
				{
					base[tableParameter.Parameter_IdColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int Group_Id
			{
				get
				{
					try
					{
						return (int)base[tableParameter.Group_IdColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'Group_Id' in table 'Parameter' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableParameter.Group_IdColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public GroupRow GroupRow
			{
				get
				{
					return (GroupRow)GetParentRow(base.Table.ParentRelations["Group_Parameter"]);
				}
				set
				{
					SetParentRow(value, base.Table.ParentRelations["Group_Parameter"]);
				}
			}

			[DebuggerNonUserCode]
			internal ParameterRow(DataRowBuilder rb)
				: base(rb)
			{
				tableParameter = (ParameterDataTable)base.Table;
			}

			[DebuggerNonUserCode]
			public bool IsColorNull()
			{
				return IsNull(tableParameter.ColorColumn);
			}

			[DebuggerNonUserCode]
			public void SetColorNull()
			{
				base[tableParameter.ColorColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsGaugeIndexNull()
			{
				return IsNull(tableParameter.GaugeIndexColumn);
			}

			[DebuggerNonUserCode]
			public void SetGaugeIndexNull()
			{
				base[tableParameter.GaugeIndexColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsViewTypeNull()
			{
				return IsNull(tableParameter.ViewTypeColumn);
			}

			[DebuggerNonUserCode]
			public void SetViewTypeNull()
			{
				base[tableParameter.ViewTypeColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsGroup_IdNull()
			{
				return IsNull(tableParameter.Group_IdColumn);
			}

			[DebuggerNonUserCode]
			public void SetGroup_IdNull()
			{
				base[tableParameter.Group_IdColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public ParameterYAxisRow[] GetParameterYAxisRows()
			{
				return (ParameterYAxisRow[])GetChildRows(base.Table.ChildRelations["Parameter_ParameterYAxis"]);
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class ParameterYAxisRow : DataRow
		{
			private ParameterYAxisDataTable tableParameterYAxis;

			[DebuggerNonUserCode]
			public double MinValue
			{
				get
				{
					try
					{
						return (double)base[tableParameterYAxis.MinValueColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'MinValue' in table 'ParameterYAxis' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableParameterYAxis.MinValueColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public double MaxValue
			{
				get
				{
					try
					{
						return (double)base[tableParameterYAxis.MaxValueColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'MaxValue' in table 'ParameterYAxis' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableParameterYAxis.MaxValueColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int Parameter_Id
			{
				get
				{
					try
					{
						return (int)base[tableParameterYAxis.Parameter_IdColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'Parameter_Id' in table 'ParameterYAxis' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableParameterYAxis.Parameter_IdColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public ParameterRow ParameterRow
			{
				get
				{
					return (ParameterRow)GetParentRow(base.Table.ParentRelations["Parameter_ParameterYAxis"]);
				}
				set
				{
					SetParentRow(value, base.Table.ParentRelations["Parameter_ParameterYAxis"]);
				}
			}

			[DebuggerNonUserCode]
			internal ParameterYAxisRow(DataRowBuilder rb)
				: base(rb)
			{
				tableParameterYAxis = (ParameterYAxisDataTable)base.Table;
			}

			[DebuggerNonUserCode]
			public bool IsMinValueNull()
			{
				return IsNull(tableParameterYAxis.MinValueColumn);
			}

			[DebuggerNonUserCode]
			public void SetMinValueNull()
			{
				base[tableParameterYAxis.MinValueColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsMaxValueNull()
			{
				return IsNull(tableParameterYAxis.MaxValueColumn);
			}

			[DebuggerNonUserCode]
			public void SetMaxValueNull()
			{
				base[tableParameterYAxis.MaxValueColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsParameter_IdNull()
			{
				return IsNull(tableParameterYAxis.Parameter_IdColumn);
			}

			[DebuggerNonUserCode]
			public void SetParameter_IdNull()
			{
				base[tableParameterYAxis.Parameter_IdColumn] = Convert.DBNull;
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class GaugeConfigurationRow : DataRow
		{
			private GaugeConfigurationDataTable tableGaugeConfiguration;

			[DebuggerNonUserCode]
			public bool ShowGauges
			{
				get
				{
					try
					{
						return (bool)base[tableGaugeConfiguration.ShowGaugesColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'ShowGauges' in table 'GaugeConfiguration' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableGaugeConfiguration.ShowGaugesColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int GaugeConfiguration_Id
			{
				get
				{
					return (int)base[tableGaugeConfiguration.GaugeConfiguration_IdColumn];
				}
				set
				{
					base[tableGaugeConfiguration.GaugeConfiguration_IdColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int Group_Id
			{
				get
				{
					try
					{
						return (int)base[tableGaugeConfiguration.Group_IdColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'Group_Id' in table 'GaugeConfiguration' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableGaugeConfiguration.Group_IdColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public GroupRow GroupRow
			{
				get
				{
					return (GroupRow)GetParentRow(base.Table.ParentRelations["Group_GaugeConfiguration"]);
				}
				set
				{
					SetParentRow(value, base.Table.ParentRelations["Group_GaugeConfiguration"]);
				}
			}

			[DebuggerNonUserCode]
			internal GaugeConfigurationRow(DataRowBuilder rb)
				: base(rb)
			{
				tableGaugeConfiguration = (GaugeConfigurationDataTable)base.Table;
			}

			[DebuggerNonUserCode]
			public bool IsShowGaugesNull()
			{
				return IsNull(tableGaugeConfiguration.ShowGaugesColumn);
			}

			[DebuggerNonUserCode]
			public void SetShowGaugesNull()
			{
				base[tableGaugeConfiguration.ShowGaugesColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsGroup_IdNull()
			{
				return IsNull(tableGaugeConfiguration.Group_IdColumn);
			}

			[DebuggerNonUserCode]
			public void SetGroup_IdNull()
			{
				base[tableGaugeConfiguration.Group_IdColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public GaugeRow[] GetGaugeRows()
			{
				return (GaugeRow[])GetChildRows(base.Table.ChildRelations["GaugeConfiguration_Gauge"]);
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class GaugeRow : DataRow
		{
			private GaugeDataTable tableGauge;

			[DebuggerNonUserCode]
			public int Index
			{
				get
				{
					return (int)base[tableGauge.IndexColumn];
				}
				set
				{
					base[tableGauge.IndexColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public double RedLinesStart
			{
				get
				{
					return (double)base[tableGauge.RedLinesStartColumn];
				}
				set
				{
					base[tableGauge.RedLinesStartColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public bool RedLineVisible
			{
				get
				{
					return (bool)base[tableGauge.RedLineVisibleColumn];
				}
				set
				{
					base[tableGauge.RedLineVisibleColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public double MaxValue
			{
				get
				{
					try
					{
						return (double)base[tableGauge.MaxValueColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'MaxValue' in table 'Gauge' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableGauge.MaxValueColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public double MinValue
			{
				get
				{
					return (double)base[tableGauge.MinValueColumn];
				}
				set
				{
					base[tableGauge.MinValueColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int GaugeConfiguration_Id
			{
				get
				{
					try
					{
						return (int)base[tableGauge.GaugeConfiguration_IdColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'GaugeConfiguration_Id' in table 'Gauge' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableGauge.GaugeConfiguration_IdColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public GaugeConfigurationRow GaugeConfigurationRow
			{
				get
				{
					return (GaugeConfigurationRow)GetParentRow(base.Table.ParentRelations["GaugeConfiguration_Gauge"]);
				}
				set
				{
					SetParentRow(value, base.Table.ParentRelations["GaugeConfiguration_Gauge"]);
				}
			}

			[DebuggerNonUserCode]
			internal GaugeRow(DataRowBuilder rb)
				: base(rb)
			{
				tableGauge = (GaugeDataTable)base.Table;
			}

			[DebuggerNonUserCode]
			public bool IsMaxValueNull()
			{
				return IsNull(tableGauge.MaxValueColumn);
			}

			[DebuggerNonUserCode]
			public void SetMaxValueNull()
			{
				base[tableGauge.MaxValueColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsGaugeConfiguration_IdNull()
			{
				return IsNull(tableGauge.GaugeConfiguration_IdColumn);
			}

			[DebuggerNonUserCode]
			public void SetGaugeConfiguration_IdNull()
			{
				base[tableGauge.GaugeConfiguration_IdColumn] = Convert.DBNull;
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class GraphConfigurationRow : DataRow
		{
			private GraphConfigurationDataTable tableGraphConfiguration;

			[DebuggerNonUserCode]
			public int GraphConfiguration_Id
			{
				get
				{
					return (int)base[tableGraphConfiguration.GraphConfiguration_IdColumn];
				}
				set
				{
					base[tableGraphConfiguration.GraphConfiguration_IdColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int Group_Id
			{
				get
				{
					try
					{
						return (int)base[tableGraphConfiguration.Group_IdColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'Group_Id' in table 'GraphConfiguration' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableGraphConfiguration.Group_IdColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public GroupRow GroupRow
			{
				get
				{
					return (GroupRow)GetParentRow(base.Table.ParentRelations["Group_GraphConfiguration"]);
				}
				set
				{
					SetParentRow(value, base.Table.ParentRelations["Group_GraphConfiguration"]);
				}
			}

			[DebuggerNonUserCode]
			internal GraphConfigurationRow(DataRowBuilder rb)
				: base(rb)
			{
				tableGraphConfiguration = (GraphConfigurationDataTable)base.Table;
			}

			[DebuggerNonUserCode]
			public bool IsGroup_IdNull()
			{
				return IsNull(tableGraphConfiguration.Group_IdColumn);
			}

			[DebuggerNonUserCode]
			public void SetGroup_IdNull()
			{
				base[tableGraphConfiguration.Group_IdColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public GeneralRow[] GetGeneralRows()
			{
				return (GeneralRow[])GetChildRows(base.Table.ChildRelations["GraphConfiguration_General"]);
			}

			[DebuggerNonUserCode]
			public XAxisRow[] GetXAxisRows()
			{
				return (XAxisRow[])GetChildRows(base.Table.ChildRelations["GraphConfiguration_XAxis"]);
			}

			[DebuggerNonUserCode]
			public YAxesRow[] GetYAxesRows()
			{
				return (YAxesRow[])GetChildRows(base.Table.ChildRelations["GraphConfiguration_YAxes"]);
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class GeneralRow : DataRow
		{
			private GeneralDataTable tableGeneral;

			[DebuggerNonUserCode]
			public string BackColor
			{
				get
				{
					return (string)base[tableGeneral.BackColorColumn];
				}
				set
				{
					base[tableGeneral.BackColorColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string Title
			{
				get
				{
					return (string)base[tableGeneral.TitleColumn];
				}
				set
				{
					base[tableGeneral.TitleColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string TitlePosition
			{
				get
				{
					return (string)base[tableGeneral.TitlePositionColumn];
				}
				set
				{
					base[tableGeneral.TitlePositionColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public bool TitleVisble
			{
				get
				{
					return (bool)base[tableGeneral.TitleVisbleColumn];
				}
				set
				{
					base[tableGeneral.TitleVisbleColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string IOCompSettings
			{
				get
				{
					try
					{
						return (string)base[tableGeneral.IOCompSettingsColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'IOCompSettings' in table 'General' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableGeneral.IOCompSettingsColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int GraphConfiguration_Id
			{
				get
				{
					try
					{
						return (int)base[tableGeneral.GraphConfiguration_IdColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'GraphConfiguration_Id' in table 'General' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableGeneral.GraphConfiguration_IdColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public GraphConfigurationRow GraphConfigurationRow
			{
				get
				{
					return (GraphConfigurationRow)GetParentRow(base.Table.ParentRelations["GraphConfiguration_General"]);
				}
				set
				{
					SetParentRow(value, base.Table.ParentRelations["GraphConfiguration_General"]);
				}
			}

			[DebuggerNonUserCode]
			internal GeneralRow(DataRowBuilder rb)
				: base(rb)
			{
				tableGeneral = (GeneralDataTable)base.Table;
			}

			[DebuggerNonUserCode]
			public bool IsIOCompSettingsNull()
			{
				return IsNull(tableGeneral.IOCompSettingsColumn);
			}

			[DebuggerNonUserCode]
			public void SetIOCompSettingsNull()
			{
				base[tableGeneral.IOCompSettingsColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsGraphConfiguration_IdNull()
			{
				return IsNull(tableGeneral.GraphConfiguration_IdColumn);
			}

			[DebuggerNonUserCode]
			public void SetGraphConfiguration_IdNull()
			{
				base[tableGeneral.GraphConfiguration_IdColumn] = Convert.DBNull;
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class XAxisRow : DataRow
		{
			private XAxisDataTable tableXAxis;

			[DebuggerNonUserCode]
			public string DisplayMode
			{
				get
				{
					return (string)base[tableXAxis.DisplayModeColumn];
				}
				set
				{
					base[tableXAxis.DisplayModeColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public long Start
			{
				get
				{
					return (long)base[tableXAxis.StartColumn];
				}
				set
				{
					base[tableXAxis.StartColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public long End
			{
				get
				{
					return (long)base[tableXAxis.EndColumn];
				}
				set
				{
					base[tableXAxis.EndColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string CursorColor
			{
				get
				{
					return (string)base[tableXAxis.CursorColorColumn];
				}
				set
				{
					base[tableXAxis.CursorColorColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int GraphConfiguration_Id
			{
				get
				{
					try
					{
						return (int)base[tableXAxis.GraphConfiguration_IdColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'GraphConfiguration_Id' in table 'XAxis' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableXAxis.GraphConfiguration_IdColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public GraphConfigurationRow GraphConfigurationRow
			{
				get
				{
					return (GraphConfigurationRow)GetParentRow(base.Table.ParentRelations["GraphConfiguration_XAxis"]);
				}
				set
				{
					SetParentRow(value, base.Table.ParentRelations["GraphConfiguration_XAxis"]);
				}
			}

			[DebuggerNonUserCode]
			internal XAxisRow(DataRowBuilder rb)
				: base(rb)
			{
				tableXAxis = (XAxisDataTable)base.Table;
			}

			[DebuggerNonUserCode]
			public bool IsGraphConfiguration_IdNull()
			{
				return IsNull(tableXAxis.GraphConfiguration_IdColumn);
			}

			[DebuggerNonUserCode]
			public void SetGraphConfiguration_IdNull()
			{
				base[tableXAxis.GraphConfiguration_IdColumn] = Convert.DBNull;
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class YAxesRow : DataRow
		{
			private YAxesDataTable tableYAxes;

			[DebuggerNonUserCode]
			public bool AutoScale
			{
				get
				{
					try
					{
						return (bool)base[tableYAxes.AutoScaleColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'AutoScale' in table 'YAxes' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableYAxes.AutoScaleColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string ScaleType
			{
				get
				{
					try
					{
						return (string)base[tableYAxes.ScaleTypeColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'ScaleType' in table 'YAxes' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableYAxes.ScaleTypeColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string AxisPosition
			{
				get
				{
					try
					{
						return (string)base[tableYAxes.AxisPositionColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'AxisPosition' in table 'YAxes' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableYAxes.AxisPositionColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public double MinValue
			{
				get
				{
					try
					{
						return (double)base[tableYAxes.MinValueColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'MinValue' in table 'YAxes' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableYAxes.MinValueColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public double MaxValue
			{
				get
				{
					try
					{
						return (double)base[tableYAxes.MaxValueColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'MaxValue' in table 'YAxes' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableYAxes.MaxValueColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public bool HideScale
			{
				get
				{
					try
					{
						return (bool)base[tableYAxes.HideScaleColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'HideScale' in table 'YAxes' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableYAxes.HideScaleColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public bool HideCaption
			{
				get
				{
					try
					{
						return (bool)base[tableYAxes.HideCaptionColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'HideCaption' in table 'YAxes' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableYAxes.HideCaptionColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public string YAxisDisplayMode
			{
				get
				{
					try
					{
						return (string)base[tableYAxes.YAxisDisplayModeColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'YAxisDisplayMode' in table 'YAxes' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableYAxes.YAxisDisplayModeColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public int GraphConfiguration_Id
			{
				get
				{
					try
					{
						return (int)base[tableYAxes.GraphConfiguration_IdColumn];
					}
					catch (InvalidCastException innerException)
					{
						throw new StrongTypingException("The value for column 'GraphConfiguration_Id' in table 'YAxes' is DBNull.", innerException);
					}
				}
				set
				{
					base[tableYAxes.GraphConfiguration_IdColumn] = value;
				}
			}

			[DebuggerNonUserCode]
			public GraphConfigurationRow GraphConfigurationRow
			{
				get
				{
					return (GraphConfigurationRow)GetParentRow(base.Table.ParentRelations["GraphConfiguration_YAxes"]);
				}
				set
				{
					SetParentRow(value, base.Table.ParentRelations["GraphConfiguration_YAxes"]);
				}
			}

			[DebuggerNonUserCode]
			internal YAxesRow(DataRowBuilder rb)
				: base(rb)
			{
				tableYAxes = (YAxesDataTable)base.Table;
			}

			[DebuggerNonUserCode]
			public bool IsAutoScaleNull()
			{
				return IsNull(tableYAxes.AutoScaleColumn);
			}

			[DebuggerNonUserCode]
			public void SetAutoScaleNull()
			{
				base[tableYAxes.AutoScaleColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsScaleTypeNull()
			{
				return IsNull(tableYAxes.ScaleTypeColumn);
			}

			[DebuggerNonUserCode]
			public void SetScaleTypeNull()
			{
				base[tableYAxes.ScaleTypeColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsAxisPositionNull()
			{
				return IsNull(tableYAxes.AxisPositionColumn);
			}

			[DebuggerNonUserCode]
			public void SetAxisPositionNull()
			{
				base[tableYAxes.AxisPositionColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsMinValueNull()
			{
				return IsNull(tableYAxes.MinValueColumn);
			}

			[DebuggerNonUserCode]
			public void SetMinValueNull()
			{
				base[tableYAxes.MinValueColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsMaxValueNull()
			{
				return IsNull(tableYAxes.MaxValueColumn);
			}

			[DebuggerNonUserCode]
			public void SetMaxValueNull()
			{
				base[tableYAxes.MaxValueColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsHideScaleNull()
			{
				return IsNull(tableYAxes.HideScaleColumn);
			}

			[DebuggerNonUserCode]
			public void SetHideScaleNull()
			{
				base[tableYAxes.HideScaleColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsHideCaptionNull()
			{
				return IsNull(tableYAxes.HideCaptionColumn);
			}

			[DebuggerNonUserCode]
			public void SetHideCaptionNull()
			{
				base[tableYAxes.HideCaptionColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsYAxisDisplayModeNull()
			{
				return IsNull(tableYAxes.YAxisDisplayModeColumn);
			}

			[DebuggerNonUserCode]
			public void SetYAxisDisplayModeNull()
			{
				base[tableYAxes.YAxisDisplayModeColumn] = Convert.DBNull;
			}

			[DebuggerNonUserCode]
			public bool IsGraphConfiguration_IdNull()
			{
				return IsNull(tableYAxes.GraphConfiguration_IdColumn);
			}

			[DebuggerNonUserCode]
			public void SetGraphConfiguration_IdNull()
			{
				base[tableYAxes.GraphConfiguration_IdColumn] = Convert.DBNull;
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class MonitorSessionRowChangeEvent : EventArgs
		{
			private MonitorSessionRow eventRow;

			private DataRowAction eventAction;

			[DebuggerNonUserCode]
			public MonitorSessionRow Row => eventRow;

			[DebuggerNonUserCode]
			public DataRowAction Action => eventAction;

			[DebuggerNonUserCode]
			public MonitorSessionRowChangeEvent(MonitorSessionRow row, DataRowAction action)
			{
				eventRow = row;
				eventAction = action;
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class ScreenRowChangeEvent : EventArgs
		{
			private ScreenRow eventRow;

			private DataRowAction eventAction;

			[DebuggerNonUserCode]
			public ScreenRow Row => eventRow;

			[DebuggerNonUserCode]
			public DataRowAction Action => eventAction;

			[DebuggerNonUserCode]
			public ScreenRowChangeEvent(ScreenRow row, DataRowAction action)
			{
				eventRow = row;
				eventAction = action;
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class GroupRowChangeEvent : EventArgs
		{
			private GroupRow eventRow;

			private DataRowAction eventAction;

			[DebuggerNonUserCode]
			public GroupRow Row => eventRow;

			[DebuggerNonUserCode]
			public DataRowAction Action => eventAction;

			[DebuggerNonUserCode]
			public GroupRowChangeEvent(GroupRow row, DataRowAction action)
			{
				eventRow = row;
				eventAction = action;
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class ParameterRowChangeEvent : EventArgs
		{
			private ParameterRow eventRow;

			private DataRowAction eventAction;

			[DebuggerNonUserCode]
			public ParameterRow Row => eventRow;

			[DebuggerNonUserCode]
			public DataRowAction Action => eventAction;

			[DebuggerNonUserCode]
			public ParameterRowChangeEvent(ParameterRow row, DataRowAction action)
			{
				eventRow = row;
				eventAction = action;
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class ParameterYAxisRowChangeEvent : EventArgs
		{
			private ParameterYAxisRow eventRow;

			private DataRowAction eventAction;

			[DebuggerNonUserCode]
			public ParameterYAxisRow Row => eventRow;

			[DebuggerNonUserCode]
			public DataRowAction Action => eventAction;

			[DebuggerNonUserCode]
			public ParameterYAxisRowChangeEvent(ParameterYAxisRow row, DataRowAction action)
			{
				eventRow = row;
				eventAction = action;
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class GaugeConfigurationRowChangeEvent : EventArgs
		{
			private GaugeConfigurationRow eventRow;

			private DataRowAction eventAction;

			[DebuggerNonUserCode]
			public GaugeConfigurationRow Row => eventRow;

			[DebuggerNonUserCode]
			public DataRowAction Action => eventAction;

			[DebuggerNonUserCode]
			public GaugeConfigurationRowChangeEvent(GaugeConfigurationRow row, DataRowAction action)
			{
				eventRow = row;
				eventAction = action;
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class GaugeRowChangeEvent : EventArgs
		{
			private GaugeRow eventRow;

			private DataRowAction eventAction;

			[DebuggerNonUserCode]
			public GaugeRow Row => eventRow;

			[DebuggerNonUserCode]
			public DataRowAction Action => eventAction;

			[DebuggerNonUserCode]
			public GaugeRowChangeEvent(GaugeRow row, DataRowAction action)
			{
				eventRow = row;
				eventAction = action;
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class GraphConfigurationRowChangeEvent : EventArgs
		{
			private GraphConfigurationRow eventRow;

			private DataRowAction eventAction;

			[DebuggerNonUserCode]
			public GraphConfigurationRow Row => eventRow;

			[DebuggerNonUserCode]
			public DataRowAction Action => eventAction;

			[DebuggerNonUserCode]
			public GraphConfigurationRowChangeEvent(GraphConfigurationRow row, DataRowAction action)
			{
				eventRow = row;
				eventAction = action;
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class GeneralRowChangeEvent : EventArgs
		{
			private GeneralRow eventRow;

			private DataRowAction eventAction;

			[DebuggerNonUserCode]
			public GeneralRow Row => eventRow;

			[DebuggerNonUserCode]
			public DataRowAction Action => eventAction;

			[DebuggerNonUserCode]
			public GeneralRowChangeEvent(GeneralRow row, DataRowAction action)
			{
				eventRow = row;
				eventAction = action;
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class XAxisRowChangeEvent : EventArgs
		{
			private XAxisRow eventRow;

			private DataRowAction eventAction;

			[DebuggerNonUserCode]
			public XAxisRow Row => eventRow;

			[DebuggerNonUserCode]
			public DataRowAction Action => eventAction;

			[DebuggerNonUserCode]
			public XAxisRowChangeEvent(XAxisRow row, DataRowAction action)
			{
				eventRow = row;
				eventAction = action;
			}
		}

		[GeneratedCode("System.Data.Design.TypedDataSetGenerator", "2.0.0.0")]
		public class YAxesRowChangeEvent : EventArgs
		{
			private YAxesRow eventRow;

			private DataRowAction eventAction;

			[DebuggerNonUserCode]
			public YAxesRow Row => eventRow;

			[DebuggerNonUserCode]
			public DataRowAction Action => eventAction;

			[DebuggerNonUserCode]
			public YAxesRowChangeEvent(YAxesRow row, DataRowAction action)
			{
				eventRow = row;
				eventAction = action;
			}
		}

		private MonitorSessionDataTable tableMonitorSession;

		private ScreenDataTable tableScreen;

		private GroupDataTable tableGroup;

		private ParameterDataTable tableParameter;

		private ParameterYAxisDataTable tableParameterYAxis;

		private GaugeConfigurationDataTable tableGaugeConfiguration;

		private GaugeDataTable tableGauge;

		private GraphConfigurationDataTable tableGraphConfiguration;

		private GeneralDataTable tableGeneral;

		private XAxisDataTable tableXAxis;

		private YAxesDataTable tableYAxes;

		private DataRelation relationMonitorSession_Screen;

		private DataRelation relationScreen_Group;

		private DataRelation relationGroup_Parameter;

		private DataRelation relationParameter_ParameterYAxis;

		private DataRelation relationGroup_GaugeConfiguration;

		private DataRelation relationGaugeConfiguration_Gauge;

		private DataRelation relationGroup_GraphConfiguration;

		private DataRelation relationGraphConfiguration_General;

		private DataRelation relationGraphConfiguration_XAxis;

		private DataRelation relationGraphConfiguration_YAxes;

		private SchemaSerializationMode _schemaSerializationMode = SchemaSerializationMode.IncludeSchema;

		[DebuggerNonUserCode]
		[Browsable(false)]
		[DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
		public MonitorSessionDataTable MonitorSession => tableMonitorSession;

		[DebuggerNonUserCode]
		[DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
		[Browsable(false)]
		public ScreenDataTable Screen => tableScreen;

		[DebuggerNonUserCode]
		[Browsable(false)]
		[DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
		public GroupDataTable Group => tableGroup;

		[Browsable(false)]
		[DebuggerNonUserCode]
		[DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
		public ParameterDataTable Parameter => tableParameter;

		[DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
		[Browsable(false)]
		[DebuggerNonUserCode]
		public ParameterYAxisDataTable ParameterYAxis => tableParameterYAxis;

		[Browsable(false)]
		[DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
		[DebuggerNonUserCode]
		public GaugeConfigurationDataTable GaugeConfiguration => tableGaugeConfiguration;

		[DebuggerNonUserCode]
		[Browsable(false)]
		[DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
		public GaugeDataTable Gauge => tableGauge;

		[DebuggerNonUserCode]
		[Browsable(false)]
		[DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
		public GraphConfigurationDataTable GraphConfiguration => tableGraphConfiguration;

		[DebuggerNonUserCode]
		[DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
		[Browsable(false)]
		public GeneralDataTable General => tableGeneral;

		[DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
		[DebuggerNonUserCode]
		[Browsable(false)]
		public XAxisDataTable XAxis => tableXAxis;

		[DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
		[Browsable(false)]
		[DebuggerNonUserCode]
		public YAxesDataTable YAxes => tableYAxes;

		[Browsable(true)]
		[DesignerSerializationVisibility(DesignerSerializationVisibility.Visible)]
		[DebuggerNonUserCode]
		public override SchemaSerializationMode SchemaSerializationMode
		{
			get
			{
				return _schemaSerializationMode;
			}
			set
			{
				_schemaSerializationMode = value;
			}
		}

		[DebuggerNonUserCode]
		[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
		public new DataTableCollection Tables => base.Tables;

		[DebuggerNonUserCode]
		[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
		public new DataRelationCollection Relations => base.Relations;

		[DebuggerNonUserCode]
		public NewDataSet()
		{
			BeginInit();
			InitClass();
			CollectionChangeEventHandler value = SchemaChanged;
			base.Tables.CollectionChanged += value;
			base.Relations.CollectionChanged += value;
			EndInit();
		}

		[DebuggerNonUserCode]
		protected NewDataSet(SerializationInfo info, StreamingContext context)
			: base(info, context, ConstructSchema: false)
		{
			//IL_030d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0317: Expected O, but got Unknown
			//IL_007d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0087: Expected O, but got Unknown
			if (IsBinarySerialized(info, context))
			{
				InitVars(initTable: false);
				CollectionChangeEventHandler value = SchemaChanged;
				Tables.CollectionChanged += value;
				Relations.CollectionChanged += value;
				return;
			}
			string s = (string)info.GetValue("XmlSchema", typeof(string));
			if (DetermineSchemaSerializationMode(info, context) == SchemaSerializationMode.IncludeSchema)
			{
				DataSet dataSet = new DataSet();
				dataSet.ReadXmlSchema((XmlReader?)new XmlTextReader((TextReader)new StringReader(s)));
				if (dataSet.Tables["MonitorSession"] != null)
				{
					base.Tables.Add(new MonitorSessionDataTable(dataSet.Tables["MonitorSession"]));
				}
				if (dataSet.Tables["Screen"] != null)
				{
					base.Tables.Add(new ScreenDataTable(dataSet.Tables["Screen"]));
				}
				if (dataSet.Tables["Group"] != null)
				{
					base.Tables.Add(new GroupDataTable(dataSet.Tables["Group"]));
				}
				if (dataSet.Tables["Parameter"] != null)
				{
					base.Tables.Add(new ParameterDataTable(dataSet.Tables["Parameter"]));
				}
				if (dataSet.Tables["ParameterYAxis"] != null)
				{
					base.Tables.Add(new ParameterYAxisDataTable(dataSet.Tables["ParameterYAxis"]));
				}
				if (dataSet.Tables["GaugeConfiguration"] != null)
				{
					base.Tables.Add(new GaugeConfigurationDataTable(dataSet.Tables["GaugeConfiguration"]));
				}
				if (dataSet.Tables["Gauge"] != null)
				{
					base.Tables.Add(new GaugeDataTable(dataSet.Tables["Gauge"]));
				}
				if (dataSet.Tables["GraphConfiguration"] != null)
				{
					base.Tables.Add(new GraphConfigurationDataTable(dataSet.Tables["GraphConfiguration"]));
				}
				if (dataSet.Tables["General"] != null)
				{
					base.Tables.Add(new GeneralDataTable(dataSet.Tables["General"]));
				}
				if (dataSet.Tables["XAxis"] != null)
				{
					base.Tables.Add(new XAxisDataTable(dataSet.Tables["XAxis"]));
				}
				if (dataSet.Tables["YAxes"] != null)
				{
					base.Tables.Add(new YAxesDataTable(dataSet.Tables["YAxes"]));
				}
				base.DataSetName = dataSet.DataSetName;
				base.Prefix = dataSet.Prefix;
				base.Namespace = dataSet.Namespace;
				base.Locale = dataSet.Locale;
				base.CaseSensitive = dataSet.CaseSensitive;
				base.EnforceConstraints = dataSet.EnforceConstraints;
				Merge(dataSet, preserveChanges: false, MissingSchemaAction.Add);
				InitVars();
			}
			else
			{
				ReadXmlSchema((XmlReader?)new XmlTextReader((TextReader)new StringReader(s)));
			}
			GetSerializationData(info, context);
			CollectionChangeEventHandler value2 = SchemaChanged;
			base.Tables.CollectionChanged += value2;
			Relations.CollectionChanged += value2;
		}

		[DebuggerNonUserCode]
		protected override void InitializeDerivedDataSet()
		{
			BeginInit();
			InitClass();
			EndInit();
		}

		[DebuggerNonUserCode]
		public override DataSet Clone()
		{
			NewDataSet newDataSet = (NewDataSet)base.Clone();
			newDataSet.InitVars();
			newDataSet.SchemaSerializationMode = SchemaSerializationMode;
			return newDataSet;
		}

		[DebuggerNonUserCode]
		protected override bool ShouldSerializeTables()
		{
			return false;
		}

		[DebuggerNonUserCode]
		protected override bool ShouldSerializeRelations()
		{
			return false;
		}

		[DebuggerNonUserCode]
		protected override void ReadXmlSerializable(XmlReader reader)
		{
			if (DetermineSchemaSerializationMode(reader) == SchemaSerializationMode.IncludeSchema)
			{
				Reset();
				DataSet dataSet = new DataSet();
				dataSet.ReadXml(reader);
				if (dataSet.Tables["MonitorSession"] != null)
				{
					base.Tables.Add(new MonitorSessionDataTable(dataSet.Tables["MonitorSession"]));
				}
				if (dataSet.Tables["Screen"] != null)
				{
					base.Tables.Add(new ScreenDataTable(dataSet.Tables["Screen"]));
				}
				if (dataSet.Tables["Group"] != null)
				{
					base.Tables.Add(new GroupDataTable(dataSet.Tables["Group"]));
				}
				if (dataSet.Tables["Parameter"] != null)
				{
					base.Tables.Add(new ParameterDataTable(dataSet.Tables["Parameter"]));
				}
				if (dataSet.Tables["ParameterYAxis"] != null)
				{
					base.Tables.Add(new ParameterYAxisDataTable(dataSet.Tables["ParameterYAxis"]));
				}
				if (dataSet.Tables["GaugeConfiguration"] != null)
				{
					base.Tables.Add(new GaugeConfigurationDataTable(dataSet.Tables["GaugeConfiguration"]));
				}
				if (dataSet.Tables["Gauge"] != null)
				{
					base.Tables.Add(new GaugeDataTable(dataSet.Tables["Gauge"]));
				}
				if (dataSet.Tables["GraphConfiguration"] != null)
				{
					base.Tables.Add(new GraphConfigurationDataTable(dataSet.Tables["GraphConfiguration"]));
				}
				if (dataSet.Tables["General"] != null)
				{
					base.Tables.Add(new GeneralDataTable(dataSet.Tables["General"]));
				}
				if (dataSet.Tables["XAxis"] != null)
				{
					base.Tables.Add(new XAxisDataTable(dataSet.Tables["XAxis"]));
				}
				if (dataSet.Tables["YAxes"] != null)
				{
					base.Tables.Add(new YAxesDataTable(dataSet.Tables["YAxes"]));
				}
				base.DataSetName = dataSet.DataSetName;
				base.Prefix = dataSet.Prefix;
				base.Namespace = dataSet.Namespace;
				base.Locale = dataSet.Locale;
				base.CaseSensitive = dataSet.CaseSensitive;
				base.EnforceConstraints = dataSet.EnforceConstraints;
				Merge(dataSet, preserveChanges: false, MissingSchemaAction.Add);
				InitVars();
			}
			else
			{
				ReadXml(reader);
				InitVars();
			}
		}

		[DebuggerNonUserCode]
		protected override XmlSchema GetSchemaSerializable()
		{
			//IL_0009: Unknown result type (might be due to invalid IL or missing references)
			//IL_0013: Expected O, but got Unknown
			//IL_001c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0027: Expected O, but got Unknown
			MemoryStream memoryStream = new MemoryStream();
			WriteXmlSchema((XmlWriter?)new XmlTextWriter((Stream)memoryStream, (Encoding)null));
			memoryStream.Position = 0L;
			return XmlSchema.Read((XmlReader)new XmlTextReader((Stream)memoryStream), (ValidationEventHandler)null);
		}

		[DebuggerNonUserCode]
		internal void InitVars()
		{
			InitVars(initTable: true);
		}

		[DebuggerNonUserCode]
		internal void InitVars(bool initTable)
		{
			tableMonitorSession = (MonitorSessionDataTable)base.Tables["MonitorSession"];
			if (initTable && tableMonitorSession != null)
			{
				tableMonitorSession.InitVars();
			}
			tableScreen = (ScreenDataTable)base.Tables["Screen"];
			if (initTable && tableScreen != null)
			{
				tableScreen.InitVars();
			}
			tableGroup = (GroupDataTable)base.Tables["Group"];
			if (initTable && tableGroup != null)
			{
				tableGroup.InitVars();
			}
			tableParameter = (ParameterDataTable)base.Tables["Parameter"];
			if (initTable && tableParameter != null)
			{
				tableParameter.InitVars();
			}
			tableParameterYAxis = (ParameterYAxisDataTable)base.Tables["ParameterYAxis"];
			if (initTable && tableParameterYAxis != null)
			{
				tableParameterYAxis.InitVars();
			}
			tableGaugeConfiguration = (GaugeConfigurationDataTable)base.Tables["GaugeConfiguration"];
			if (initTable && tableGaugeConfiguration != null)
			{
				tableGaugeConfiguration.InitVars();
			}
			tableGauge = (GaugeDataTable)base.Tables["Gauge"];
			if (initTable && tableGauge != null)
			{
				tableGauge.InitVars();
			}
			tableGraphConfiguration = (GraphConfigurationDataTable)base.Tables["GraphConfiguration"];
			if (initTable && tableGraphConfiguration != null)
			{
				tableGraphConfiguration.InitVars();
			}
			tableGeneral = (GeneralDataTable)base.Tables["General"];
			if (initTable && tableGeneral != null)
			{
				tableGeneral.InitVars();
			}
			tableXAxis = (XAxisDataTable)base.Tables["XAxis"];
			if (initTable && tableXAxis != null)
			{
				tableXAxis.InitVars();
			}
			tableYAxes = (YAxesDataTable)base.Tables["YAxes"];
			if (initTable && tableYAxes != null)
			{
				tableYAxes.InitVars();
			}
			relationMonitorSession_Screen = Relations["MonitorSession_Screen"];
			relationScreen_Group = Relations["Screen_Group"];
			relationGroup_Parameter = Relations["Group_Parameter"];
			relationParameter_ParameterYAxis = Relations["Parameter_ParameterYAxis"];
			relationGroup_GaugeConfiguration = Relations["Group_GaugeConfiguration"];
			relationGaugeConfiguration_Gauge = Relations["GaugeConfiguration_Gauge"];
			relationGroup_GraphConfiguration = Relations["Group_GraphConfiguration"];
			relationGraphConfiguration_General = Relations["GraphConfiguration_General"];
			relationGraphConfiguration_XAxis = Relations["GraphConfiguration_XAxis"];
			relationGraphConfiguration_YAxes = Relations["GraphConfiguration_YAxes"];
		}

		[DebuggerNonUserCode]
		private void InitClass()
		{
			base.DataSetName = "NewDataSet";
			base.Prefix = "";
			base.Locale = new CultureInfo("");
			base.EnforceConstraints = true;
			SchemaSerializationMode = SchemaSerializationMode.IncludeSchema;
			tableMonitorSession = new MonitorSessionDataTable();
			base.Tables.Add(tableMonitorSession);
			tableScreen = new ScreenDataTable();
			base.Tables.Add(tableScreen);
			tableGroup = new GroupDataTable();
			base.Tables.Add(tableGroup);
			tableParameter = new ParameterDataTable();
			base.Tables.Add(tableParameter);
			tableParameterYAxis = new ParameterYAxisDataTable();
			base.Tables.Add(tableParameterYAxis);
			tableGaugeConfiguration = new GaugeConfigurationDataTable();
			base.Tables.Add(tableGaugeConfiguration);
			tableGauge = new GaugeDataTable();
			base.Tables.Add(tableGauge);
			tableGraphConfiguration = new GraphConfigurationDataTable();
			base.Tables.Add(tableGraphConfiguration);
			tableGeneral = new GeneralDataTable();
			base.Tables.Add(tableGeneral);
			tableXAxis = new XAxisDataTable();
			base.Tables.Add(tableXAxis);
			tableYAxes = new YAxesDataTable();
			base.Tables.Add(tableYAxes);
			ForeignKeyConstraint foreignKeyConstraint = new ForeignKeyConstraint("MonitorSession_Screen", new DataColumn[1] { tableMonitorSession.MonitorSession_IdColumn }, new DataColumn[1] { tableScreen.MonitorSession_IdColumn });
			tableScreen.Constraints.Add(foreignKeyConstraint);
			foreignKeyConstraint.AcceptRejectRule = AcceptRejectRule.None;
			foreignKeyConstraint.DeleteRule = Rule.Cascade;
			foreignKeyConstraint.UpdateRule = Rule.Cascade;
			foreignKeyConstraint = new ForeignKeyConstraint("Screen_Group", new DataColumn[1] { tableScreen.Screen_IdColumn }, new DataColumn[1] { tableGroup.Screen_IdColumn });
			tableGroup.Constraints.Add(foreignKeyConstraint);
			foreignKeyConstraint.AcceptRejectRule = AcceptRejectRule.None;
			foreignKeyConstraint.DeleteRule = Rule.Cascade;
			foreignKeyConstraint.UpdateRule = Rule.Cascade;
			foreignKeyConstraint = new ForeignKeyConstraint("Group_Parameter", new DataColumn[1] { tableGroup.Group_IdColumn }, new DataColumn[1] { tableParameter.Group_IdColumn });
			tableParameter.Constraints.Add(foreignKeyConstraint);
			foreignKeyConstraint.AcceptRejectRule = AcceptRejectRule.None;
			foreignKeyConstraint.DeleteRule = Rule.Cascade;
			foreignKeyConstraint.UpdateRule = Rule.Cascade;
			foreignKeyConstraint = new ForeignKeyConstraint("Parameter_ParameterYAxis", new DataColumn[1] { tableParameter.Parameter_IdColumn }, new DataColumn[1] { tableParameterYAxis.Parameter_IdColumn });
			tableParameterYAxis.Constraints.Add(foreignKeyConstraint);
			foreignKeyConstraint.AcceptRejectRule = AcceptRejectRule.None;
			foreignKeyConstraint.DeleteRule = Rule.Cascade;
			foreignKeyConstraint.UpdateRule = Rule.Cascade;
			foreignKeyConstraint = new ForeignKeyConstraint("Group_GaugeConfiguration", new DataColumn[1] { tableGroup.Group_IdColumn }, new DataColumn[1] { tableGaugeConfiguration.Group_IdColumn });
			tableGaugeConfiguration.Constraints.Add(foreignKeyConstraint);
			foreignKeyConstraint.AcceptRejectRule = AcceptRejectRule.None;
			foreignKeyConstraint.DeleteRule = Rule.Cascade;
			foreignKeyConstraint.UpdateRule = Rule.Cascade;
			foreignKeyConstraint = new ForeignKeyConstraint("GaugeConfiguration_Gauge", new DataColumn[1] { tableGaugeConfiguration.GaugeConfiguration_IdColumn }, new DataColumn[1] { tableGauge.GaugeConfiguration_IdColumn });
			tableGauge.Constraints.Add(foreignKeyConstraint);
			foreignKeyConstraint.AcceptRejectRule = AcceptRejectRule.None;
			foreignKeyConstraint.DeleteRule = Rule.Cascade;
			foreignKeyConstraint.UpdateRule = Rule.Cascade;
			foreignKeyConstraint = new ForeignKeyConstraint("Group_GraphConfiguration", new DataColumn[1] { tableGroup.Group_IdColumn }, new DataColumn[1] { tableGraphConfiguration.Group_IdColumn });
			tableGraphConfiguration.Constraints.Add(foreignKeyConstraint);
			foreignKeyConstraint.AcceptRejectRule = AcceptRejectRule.None;
			foreignKeyConstraint.DeleteRule = Rule.Cascade;
			foreignKeyConstraint.UpdateRule = Rule.Cascade;
			foreignKeyConstraint = new ForeignKeyConstraint("GraphConfiguration_General", new DataColumn[1] { tableGraphConfiguration.GraphConfiguration_IdColumn }, new DataColumn[1] { tableGeneral.GraphConfiguration_IdColumn });
			tableGeneral.Constraints.Add(foreignKeyConstraint);
			foreignKeyConstraint.AcceptRejectRule = AcceptRejectRule.None;
			foreignKeyConstraint.DeleteRule = Rule.Cascade;
			foreignKeyConstraint.UpdateRule = Rule.Cascade;
			foreignKeyConstraint = new ForeignKeyConstraint("GraphConfiguration_XAxis", new DataColumn[1] { tableGraphConfiguration.GraphConfiguration_IdColumn }, new DataColumn[1] { tableXAxis.GraphConfiguration_IdColumn });
			tableXAxis.Constraints.Add(foreignKeyConstraint);
			foreignKeyConstraint.AcceptRejectRule = AcceptRejectRule.None;
			foreignKeyConstraint.DeleteRule = Rule.Cascade;
			foreignKeyConstraint.UpdateRule = Rule.Cascade;
			foreignKeyConstraint = new ForeignKeyConstraint("GraphConfiguration_YAxes", new DataColumn[1] { tableGraphConfiguration.GraphConfiguration_IdColumn }, new DataColumn[1] { tableYAxes.GraphConfiguration_IdColumn });
			tableYAxes.Constraints.Add(foreignKeyConstraint);
			foreignKeyConstraint.AcceptRejectRule = AcceptRejectRule.None;
			foreignKeyConstraint.DeleteRule = Rule.Cascade;
			foreignKeyConstraint.UpdateRule = Rule.Cascade;
			relationMonitorSession_Screen = new DataRelation("MonitorSession_Screen", new DataColumn[1] { tableMonitorSession.MonitorSession_IdColumn }, new DataColumn[1] { tableScreen.MonitorSession_IdColumn }, createConstraints: false);
			relationMonitorSession_Screen.Nested = true;
			Relations.Add(relationMonitorSession_Screen);
			relationScreen_Group = new DataRelation("Screen_Group", new DataColumn[1] { tableScreen.Screen_IdColumn }, new DataColumn[1] { tableGroup.Screen_IdColumn }, createConstraints: false);
			relationScreen_Group.Nested = true;
			Relations.Add(relationScreen_Group);
			relationGroup_Parameter = new DataRelation("Group_Parameter", new DataColumn[1] { tableGroup.Group_IdColumn }, new DataColumn[1] { tableParameter.Group_IdColumn }, createConstraints: false);
			relationGroup_Parameter.Nested = true;
			Relations.Add(relationGroup_Parameter);
			relationParameter_ParameterYAxis = new DataRelation("Parameter_ParameterYAxis", new DataColumn[1] { tableParameter.Parameter_IdColumn }, new DataColumn[1] { tableParameterYAxis.Parameter_IdColumn }, createConstraints: false);
			relationParameter_ParameterYAxis.Nested = true;
			Relations.Add(relationParameter_ParameterYAxis);
			relationGroup_GaugeConfiguration = new DataRelation("Group_GaugeConfiguration", new DataColumn[1] { tableGroup.Group_IdColumn }, new DataColumn[1] { tableGaugeConfiguration.Group_IdColumn }, createConstraints: false);
			relationGroup_GaugeConfiguration.Nested = true;
			Relations.Add(relationGroup_GaugeConfiguration);
			relationGaugeConfiguration_Gauge = new DataRelation("GaugeConfiguration_Gauge", new DataColumn[1] { tableGaugeConfiguration.GaugeConfiguration_IdColumn }, new DataColumn[1] { tableGauge.GaugeConfiguration_IdColumn }, createConstraints: false);
			relationGaugeConfiguration_Gauge.Nested = true;
			Relations.Add(relationGaugeConfiguration_Gauge);
			relationGroup_GraphConfiguration = new DataRelation("Group_GraphConfiguration", new DataColumn[1] { tableGroup.Group_IdColumn }, new DataColumn[1] { tableGraphConfiguration.Group_IdColumn }, createConstraints: false);
			relationGroup_GraphConfiguration.Nested = true;
			Relations.Add(relationGroup_GraphConfiguration);
			relationGraphConfiguration_General = new DataRelation("GraphConfiguration_General", new DataColumn[1] { tableGraphConfiguration.GraphConfiguration_IdColumn }, new DataColumn[1] { tableGeneral.GraphConfiguration_IdColumn }, createConstraints: false);
			relationGraphConfiguration_General.Nested = true;
			Relations.Add(relationGraphConfiguration_General);
			relationGraphConfiguration_XAxis = new DataRelation("GraphConfiguration_XAxis", new DataColumn[1] { tableGraphConfiguration.GraphConfiguration_IdColumn }, new DataColumn[1] { tableXAxis.GraphConfiguration_IdColumn }, createConstraints: false);
			relationGraphConfiguration_XAxis.Nested = true;
			Relations.Add(relationGraphConfiguration_XAxis);
			relationGraphConfiguration_YAxes = new DataRelation("GraphConfiguration_YAxes", new DataColumn[1] { tableGraphConfiguration.GraphConfiguration_IdColumn }, new DataColumn[1] { tableYAxes.GraphConfiguration_IdColumn }, createConstraints: false);
			relationGraphConfiguration_YAxes.Nested = true;
			Relations.Add(relationGraphConfiguration_YAxes);
		}

		[DebuggerNonUserCode]
		private bool ShouldSerializeMonitorSession()
		{
			return false;
		}

		[DebuggerNonUserCode]
		private bool ShouldSerializeScreen()
		{
			return false;
		}

		[DebuggerNonUserCode]
		private bool ShouldSerializeGroup()
		{
			return false;
		}

		[DebuggerNonUserCode]
		private bool ShouldSerializeParameter()
		{
			return false;
		}

		[DebuggerNonUserCode]
		private bool ShouldSerializeParameterYAxis()
		{
			return false;
		}

		[DebuggerNonUserCode]
		private bool ShouldSerializeGaugeConfiguration()
		{
			return false;
		}

		[DebuggerNonUserCode]
		private bool ShouldSerializeGauge()
		{
			return false;
		}

		[DebuggerNonUserCode]
		private bool ShouldSerializeGraphConfiguration()
		{
			return false;
		}

		[DebuggerNonUserCode]
		private bool ShouldSerializeGeneral()
		{
			return false;
		}

		[DebuggerNonUserCode]
		private bool ShouldSerializeXAxis()
		{
			return false;
		}

		[DebuggerNonUserCode]
		private bool ShouldSerializeYAxes()
		{
			return false;
		}

		[DebuggerNonUserCode]
		private void SchemaChanged(object sender, CollectionChangeEventArgs e)
		{
			if (e.Action == CollectionChangeAction.Remove)
			{
				InitVars();
			}
		}

		[DebuggerNonUserCode]
		public static XmlSchemaComplexType GetTypedDataSetSchema(XmlSchemaSet xs)
		{
			//IL_0006: Unknown result type (might be due to invalid IL or missing references)
			//IL_000c: Expected O, but got Unknown
			//IL_000c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0012: Expected O, but got Unknown
			//IL_001f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0025: Expected O, but got Unknown
			NewDataSet newDataSet = new NewDataSet();
			XmlSchemaComplexType val = new XmlSchemaComplexType();
			XmlSchemaSequence val2 = new XmlSchemaSequence();
			xs.Add(newDataSet.GetSchemaSerializable());
			XmlSchemaAny val3 = new XmlSchemaAny();
			val3.Namespace = newDataSet.Namespace;
			((XmlSchemaGroupBase)val2).Items.Add((XmlSchemaObject)(object)val3);
			val.Particle = (XmlSchemaParticle)(object)val2;
			return val;
		}
	}
}
namespace Cummins.Parameter
{
	public enum EditKind
	{
		XAxisEdit,
		YAxisEdit,
		ZAxisEdit
	}
	public class AxisValueChangeEventArgs : EventArgs
	{
		public EditKind EditKind;

		public int Index;

		public string Value;

		public AxisValueChangeEventArgs(EditKind editKind, int index, string value)
		{
			EditKind = editKind;
			Index = index;
			Value = value;
		}
	}
	public delegate void AxisValueChangeEventHandler(object sender, AxisValueChangeEventArgs e);
	public class CopyThread
	{
		public delegate void Start(object object1);

		private class Arguments
		{
			public object object1;

			public Start start;

			public void Work()
			{
				start(object1);
			}
		}

		public static Thread CreateThread(object argument1)
		{
			Arguments arguments = new Arguments();
			arguments.object1 = argument1;
			arguments.start = Clipboard.SetDataObject;
			return new Thread(arguments.Work);
		}
	}
	public class EditErrorEventArgs : EventArgs
	{
		private string errorMessage;

		public string ErrorMessage
		{
			get
			{
				return errorMessage;
			}
			set
			{
				errorMessage = value;
			}
		}

		public EditErrorEventArgs()
		{
			errorMessage = "";
		}

		public EditErrorEventArgs(string message)
		{
			errorMessage = message;
		}
	}
	public class EnumerationController : ParameterController
	{
		private IMonitoredModel model;

		private string displayUnit;

		private int dataTableNameColumnChars;

		private int dataTableValueColumnChars;

		private int dataTableUnitColumnChars;

		private int dataTableCommentColumnChars;

		private int propertiesTablePropertyColumnChars;

		private int propertiesTableValueColumnChars;

		private string previousValue;

		public override DataTable Data
		{
			get
			{
				if (dataTable == null)
				{
					try
					{
						InitializeDataTable();
						dataTable.ColumnChanging += OnColumnChanging;
					}
					catch (Exception ex)
					{
						throw ex;
					}
				}
				return dataTable;
			}
		}

		public override DataTable Properties
		{
			get
			{
				if (propertiesTable == null)
				{
					try
					{
						InitializePropertiesTable();
					}
					catch (Exception ex)
					{
						throw ex;
					}
				}
				return propertiesTable;
			}
		}

		public string DisplayUnit
		{
			get
			{
				return displayUnit;
			}
			set
			{
				if (value.Length > 0)
				{
					displayUnit = value;
				}
			}
		}

		public int DataTableNameColumnChars
		{
			get
			{
				return dataTableNameColumnChars;
			}
			set
			{
				if (value > dataTableNameColumnChars)
				{
					dataTableNameColumnChars = value;
				}
			}
		}

		public int DataTableValueColumnChars
		{
			get
			{
				return dataTableValueColumnChars;
			}
			set
			{
				if (value > dataTableValueColumnChars)
				{
					dataTableValueColumnChars = value;
				}
			}
		}

		public int DataTableUnitColumnChars
		{
			get
			{
				return dataTableUnitColumnChars;
			}
			set
			{
				if (value > dataTableUnitColumnChars)
				{
					dataTableUnitColumnChars = value;
				}
			}
		}

		public int DataTableCommentColumnChars
		{
			get
			{
				return dataTableCommentColumnChars;
			}
			set
			{
				if (value > dataTableCommentColumnChars)
				{
					dataTableCommentColumnChars = value;
				}
			}
		}

		public override int PropertiesTablePropertyColumnChars
		{
			get
			{
				return propertiesTablePropertyColumnChars;
			}
			set
			{
				if (value > propertiesTablePropertyColumnChars)
				{
					propertiesTablePropertyColumnChars = value;
				}
			}
		}

		public override int PropertiesTableValueColumnChars
		{
			get
			{
				return propertiesTableValueColumnChars;
			}
			set
			{
				if (value > propertiesTableValueColumnChars)
				{
					propertiesTableValueColumnChars = value;
				}
			}
		}

		public EnumerationController(IMonitoredModel valueModel)
			: base(valueModel)
		{
			model = valueModel;
			previousValue = "";
			dataTableNameColumnChars = 4;
			dataTableValueColumnChars = 5;
			dataTableUnitColumnChars = 4;
			dataTableCommentColumnChars = 7;
			propertiesTablePropertyColumnChars = 8;
			propertiesTableValueColumnChars = 5;
			try
			{
				displayUnit = model.EngineeringUnits;
			}
			catch (Exception)
			{
			}
			if (displayUnit == null)
			{
				displayUnit = "(null)";
			}
		}

		public override void Undo()
		{
			DataRow dataRow = dataTable.Rows[0];
			dataRow["Value"] = previousValue;
		}

		public override void Revert()
		{
			model.ParameterModel.Revert();
			dataTable.RejectChanges();
			RaiseAllCellsUnmodifiedEvent();
		}

		public override void Save()
		{
			model.ParameterModel.Save();
			dataTable.AcceptChanges();
			RaiseAllCellsUnmodifiedEvent();
		}

		public override void DataMode(DataFormat displayFormat)
		{
			if (base.DisplayFormat != displayFormat)
			{
				base.DisplayFormat = displayFormat;
				try
				{
					dataTable.Rows.Clear();
					dataTable.ColumnChanging -= OnColumnChanging;
					LoadDataTable();
					dataTable.ColumnChanging += OnColumnChanging;
				}
				catch (Exception)
				{
				}
			}
		}

		private void InitializeDataTable()
		{
			try
			{
				dataTable = new DataTable();
				dataTable.TableName = "DataTable";
				CreateDataColumns();
				LoadDataTable();
			}
			catch (Exception ex)
			{
				throw ex;
			}
		}

		private void InitializePropertiesTable()
		{
			try
			{
				propertiesTable = new DataTable();
				propertiesTable.TableName = "PropertiesTable";
				CreatePropertyColumns(propertiesTable);
				LoadPropertiesTable();
			}
			catch (Exception ex)
			{
				throw ex;
			}
		}

		private void CreateDataColumns()
		{
			DataColumn column = MakeDataColumn("Name", "Name", Type.GetType("System.String"), isReadOnly: true, isUnique: true);
			dataTable.Columns.Add(column);
			column = MakeDataColumn("Value", "Value", Type.GetType("System.String"), isReadOnly: false, isUnique: false);
			dataTable.Columns.Add(column);
			column = MakeDataColumn("Unit", "Unit", Type.GetType("System.String"), isReadOnly: true, isUnique: false);
			dataTable.Columns.Add(column);
			column = MakeDataColumn("Comment", "Comment", Type.GetType("System.String"), isReadOnly: true, isUnique: false);
			dataTable.Columns.Add(column);
		}

		private void LoadDataTable()
		{
			try
			{
				DataRow dataRow = dataTable.NewRow();
				try
				{
					dataRow["Name"] = model.Name;
					DataTableNameColumnChars = dataRow["Name"].ToString().Length;
				}
				catch (Exception ex)
				{
					throw ex;
				}
				try
				{
					if (base.DisplayFormat == DataFormat.Hex)
					{
						dataRow["Value"] = (model.ParameterModel as IEnumerationModel).HexValue();
					}
					else if (base.DisplayFormat == DataFormat.Binary)
					{
						dataRow["Value"] = (model.ParameterModel as IEnumerationModel).BinaryValue();
					}
					else
					{
						dataRow["Value"] = (model.ParameterModel as IEnumerationModel).ScaledValue;
					}
					DataTableValueColumnChars = dataRow["Value"].ToString().Length;
					if (base.DisplayFormat == DataFormat.Hex)
					{
						previousValue = (model.ParameterModel as IEnumerationModel).HexValue();
					}
					else if (base.DisplayFormat == DataFormat.Binary)
					{
						previousValue = (model.ParameterModel as IEnumerationModel).BinaryValue();
					}
					else
					{
						previousValue = (model.ParameterModel as IEnumerationModel).ScaledValue;
					}
				}
				catch (Exception ex2)
				{
					throw ex2;
				}
				try
				{
					dataRow["Unit"] = displayUnit;
					DataTableUnitColumnChars = dataRow["Unit"].ToString().Length;
				}
				catch (Exception ex3)
				{
					throw ex3;
				}
				try
				{
					dataRow["Comment"] = model.Comment;
					DataTableCommentColumnChars = dataRow["Comment"].ToString().Length;
				}
				catch (Exception ex4)
				{
					throw ex4;
				}
				dataTable.Rows.Add(dataRow);
				dataTable.AcceptChanges();
			}
			catch (Exception ex5)
			{
				throw ex5;
			}
		}

		private void LoadPropertiesTable()
		{
			try
			{
				try
				{
					AddToPropertiesTable("Full Name", model.ParameterModel.FullName);
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Comment", model.ParameterModel.Comment);
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Address", model.ParameterModel.Address, "X8");
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Length", model.ParameterModel.Length.ToString());
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Data Type", (long)model.ParameterModel.DataType, "N0");
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Config Data Type", model.ParameterModel.ConfigFileType, "N0");
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Engineering Unit", model.ParameterModel.EngineeringUnits);
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Minimum Value", model.ParameterModel.LowerBound.ToString());
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Maximum Value", model.ParameterModel.UpperBound.ToString());
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Subfile Number", model.ParameterModel.SubfileNumber, "N0");
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Config Data Type", model.ParameterModel.ConfigFileType, "N0");
				}
				catch
				{
				}
				try
				{
					DataRow dataRow = propertiesTable.NewRow();
					dataRow["Property"] = "Available Offline";
					PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
					if (model.ParameterModel.AvailableOffline)
					{
						dataRow["Value"] = "Yes";
					}
					else
					{
						dataRow["Value"] = "No";
					}
					PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
					propertiesTable.Rows.Add(dataRow);
				}
				catch (Exception ex)
				{
					throw ex;
				}
			}
			catch (Exception ex2)
			{
				throw ex2;
			}
		}

		private void AddToPropertiesTable(string propertyName, string propertyValue)
		{
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = propertyName;
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = propertyValue;
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
		}

		private void AddToPropertiesTable(string propertyName, long propertyValue, string format)
		{
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = propertyName;
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = propertyValue.ToString(format);
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
		}

		private void OnColumnChanging(object sender, DataColumnChangeEventArgs e)
		{
			if (e.Column.ColumnName == "Value")
			{
				try
				{
					if (e.ProposedValue.ToString().Length == 0)
					{
						throw new Exception();
					}
					string text = "";
					text = ((base.DisplayFormat == DataFormat.Hex) ? (model.ParameterModel as IEnumerationModel).HexValue() : ((base.DisplayFormat != DataFormat.Binary) ? (model.ParameterModel as IEnumerationModel).ScaledValue : (model.ParameterModel as IEnumerationModel).BinaryValue()));
					if (base.DisplayFormat == DataFormat.Hex)
					{
						(model.ParameterModel as IEnumerationModel).HexValue(e.ProposedValue.ToString());
					}
					else if (base.DisplayFormat == DataFormat.Binary)
					{
						(model.ParameterModel as IEnumerationModel).BinaryValue(e.ProposedValue.ToString());
					}
					else
					{
						(model.ParameterModel as IEnumerationModel).ScaledValue = e.ProposedValue.ToString();
					}
					previousValue = text;
					RaiseCellChanged(this, e);
					return;
				}
				catch (Exception ex)
				{
					throw ex;
				}
			}
			_ = e.Column.ColumnName == "Unit";
		}
	}
	public class EnumerationDataView : ParameterView
	{
		private EnumerationController controller;

		private Panel panel;

		private CustomDataGrid dataGrid;

		private Container components;

		private ContextMenu csmMenu;

		private int rowClicked;

		public override Panel Panel => panel;

		public EnumerationDataView(EnumerationController enumerationController, Font font)
			: base(font)
		{
			//IL_001c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0026: Expected O, but got Unknown
			//IL_0043: Unknown result type (might be due to invalid IL or missing references)
			//IL_004d: Expected O, but got Unknown
			//IL_006b: Unknown result type (might be due to invalid IL or missing references)
			//IL_0075: Expected O, but got Unknown
			//IL_0093: Unknown result type (might be due to invalid IL or missing references)
			//IL_009d: Expected O, but got Unknown
			//IL_00bc: Unknown result type (might be due to invalid IL or missing references)
			//IL_00c6: Expected O, but got Unknown
			//IL_0131: Unknown result type (might be due to invalid IL or missing references)
			//IL_0137: Expected O, but got Unknown
			//IL_0172: Unknown result type (might be due to invalid IL or missing references)
			//IL_017c: Expected O, but got Unknown
			controller = enumerationController;
			rowClicked = -1;
			InitializeComponent();
			csmMenu = new ContextMenu();
			((Menu)csmMenu).MenuItems.Add(0, new MenuItem("Copy", (EventHandler)Copy_Click));
			((Menu)csmMenu).MenuItems.Add(1, new MenuItem("Paste", (EventHandler)Paste_Click));
			((Menu)csmMenu).MenuItems.Add(2, new MenuItem("Undo", (EventHandler)Undo_Click));
			((Menu)csmMenu).MenuItems.Add(3, new MenuItem("Properties", (EventHandler)Properties_Click));
			((Control)dataGrid).ContextMenu = csmMenu;
			((DataGrid)dataGrid).DataSource = controller.Data;
			((DataGrid)dataGrid).AllowSorting = false;
			((DataGrid)dataGrid).CaptionText = controller.Name;
			CurrencyManager val = (CurrencyManager)((Control)this).BindingContext[((DataGrid)dataGrid).DataSource, ((DataGrid)dataGrid).DataMember];
			((DataView)val.List).AllowNew = false;
			SetColumnStyles();
			controller.CellChangedEvent += OnCellChanged;
			((Control)dataGrid).MouseDown += new MouseEventHandler(OnMouseDown);
			controller.AllCellsUnmodifiedEvent += OnAllCellsUnmodified;
			((DataView)val.List).ListChanged += OnListChanged;
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		public override void SetDisplayMode(DataFormat dataFormat)
		{
			base.DataViewFormat = dataFormat;
			SetColumnStyles();
		}

		protected override void OnListChanged(object sender, ListChangedEventArgs args)
		{
			((DataGrid)dataGrid).CurrentRowIndex = 0;
		}

		protected void Copy_Click(object sender, EventArgs e)
		{
			try
			{
				dataGrid.Copy();
			}
			catch
			{
			}
		}

		protected void Paste_Click(object sender, EventArgs e)
		{
			try
			{
				dataGrid.Paste();
			}
			catch
			{
			}
		}

		protected void Undo_Click(object sender, EventArgs e)
		{
			int currentRowIndex = 0;
			if (rowClicked != -1)
			{
				currentRowIndex = rowClicked;
			}
			controller.Undo();
			((DataGrid)dataGrid).CurrentRowIndex = currentRowIndex;
		}

		protected override void Properties_Click(object sender, EventArgs e)
		{
			base.Properties_Click(this, e);
		}

		private void SetColumnStyles()
		{
			//IL_001c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0022: Expected O, but got Unknown
			//IL_003f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0045: Expected O, but got Unknown
			//IL_0057: Unknown result type (might be due to invalid IL or missing references)
			//IL_005e: Expected O, but got Unknown
			//IL_015f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0166: Expected O, but got Unknown
			//IL_01e0: Unknown result type (might be due to invalid IL or missing references)
			//IL_01e7: Expected O, but got Unknown
			((DataGrid)dataGrid).TableStyles.Clear();
			DataTable data = controller.Data;
			DataGridTableStyle val = new DataGridTableStyle();
			val.MappingName = data.TableName;
			CurrencyManager val2 = (CurrencyManager)((Control)dataGrid).BindingContext[(object)data];
			PropertyDescriptor propertyDescriptor = ((BindingManagerBase)val2).GetItemProperties()["Name"];
			DataGridTextBoxColumn val3 = new DataGridTextBoxColumn(propertyDescriptor);
			SetColumnStyle(val3, data.Columns["Name"].Caption, "Name", GetColumnWidth(controller.DataTableNameColumnChars), data.Columns["Name"].ReadOnly);
			val.GridColumnStyles.Add((DataGridColumnStyle)(object)val3);
			((Control)val3.TextBox).ContextMenu = csmMenu;
			propertyDescriptor = ((BindingManagerBase)val2).GetItemProperties()["Value"];
			ColoredTextBoxColumn coloredTextBoxColumn = new ColoredTextBoxColumn((DataGrid)(object)dataGrid, propertyDescriptor);
			SetColumnStyle((DataGridTextBoxColumn)(object)coloredTextBoxColumn, data.Columns["Value"].Caption, "Value", GetColumnWidth(controller.DataTableValueColumnChars), data.Columns["Value"].ReadOnly);
			val.GridColumnStyles.Add((DataGridColumnStyle)(object)coloredTextBoxColumn);
			((Control)((DataGridTextBoxColumn)coloredTextBoxColumn).TextBox).ContextMenu = csmMenu;
			propertyDescriptor = ((BindingManagerBase)val2).GetItemProperties()["Unit"];
			DataGridTextBoxColumn val4 = new DataGridTextBoxColumn(propertyDescriptor);
			SetColumnStyle(val4, data.Columns["Unit"].Caption, "Unit", GetColumnWidth(controller.DataTableUnitColumnChars), data.Columns["Unit"].ReadOnly);
			val.GridColumnStyles.Add((DataGridColumnStyle)(object)val4);
			((Control)val4.TextBox).ContextMenu = csmMenu;
			propertyDescriptor = ((BindingManagerBase)val2).GetItemProperties()["Comment"];
			DataGridTextBoxColumn val5 = new DataGridTextBoxColumn(propertyDescriptor);
			SetColumnStyle(val5, data.Columns["Comment"].Caption, "Comment", GetColumnWidth(controller.DataTableCommentColumnChars), data.Columns["Comment"].ReadOnly);
			val.GridColumnStyles.Add((DataGridColumnStyle)(object)val5);
			((DataGrid)dataGrid).TableStyles.Add(val);
			((Control)val5.TextBox).ContextMenu = csmMenu;
		}

		private void OnCellChanged(object sender, DataColumnChangeEventArgs e)
		{
			//IL_002a: Unknown result type (might be due to invalid IL or missing references)
			AddModifiedParameter(controller.Name);
			DataGridCell currentCell = default(DataGridCell);
			((DataGridCell)(ref currentCell))..ctor(0, e.Column.Ordinal);
			((DataGrid)dataGrid).CurrentCell = currentCell;
			ColoredTextBoxColumn coloredTextBoxColumn = (ColoredTextBoxColumn)(object)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles[e.Column.ColumnName];
			coloredTextBoxColumn.ShowCellModified(0);
		}

		private void OnMouseDown(object sender, MouseEventArgs e)
		{
			//IL_0008: Unknown result type (might be due to invalid IL or missing references)
			//IL_0012: Invalid comparison between Unknown and I4
			//IL_0035: Unknown result type (might be due to invalid IL or missing references)
			//IL_003b: Invalid comparison between Unknown and I4
			//IL_003e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0044: Invalid comparison between Unknown and I4
			rowClicked = -1;
			if ((int)e.Button == 2097152)
			{
				Point point = new Point(e.X, e.Y);
				HitTestInfo val = ((DataGrid)dataGrid).HitTest(point);
				if ((int)val.Type == 4 || (int)val.Type == 1)
				{
					rowClicked = val.Row;
				}
			}
		}

		private void OnAllCellsUnmodified(object sender, EventArgs e)
		{
			ColoredTextBoxColumn coloredTextBoxColumn = (ColoredTextBoxColumn)(object)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles["Value"];
			coloredTextBoxColumn.ShowAllCellsUnmodified();
		}

		private void InitializeComponent()
		{
			//IL_0001: Unknown result type (might be due to invalid IL or missing references)
			//IL_000b: Expected O, but got Unknown
			panel = new Panel();
			dataGrid = new CustomDataGrid();
			((Control)panel).SuspendLayout();
			((ISupportInitialize)dataGrid).BeginInit();
			((Control)this).SuspendLayout();
			((Control)panel).Controls.AddRange((Control[])(object)new Control[1] { (Control)dataGrid });
			((Control)panel).Location = new Point(24, 16);
			((Control)panel).Name = "panel";
			((Control)panel).Size = new Size(500, 150);
			((Control)panel).TabIndex = 0;
			((DataGrid)dataGrid).DataMember = "";
			((Control)dataGrid).Dock = (DockStyle)5;
			((DataGrid)dataGrid).HeaderForeColor = SystemColors.ControlText;
			((Control)dataGrid).Name = "dataGrid";
			((Control)dataGrid).Size = new Size(500, 150);
			((Control)dataGrid).TabIndex = 0;
			((Control)this).Controls.AddRange((Control[])(object)new Control[1] { (Control)panel });
			((Control)this).Name = "EnumerationDataView";
			((Control)this).Size = new Size(536, 184);
			((Control)panel).ResumeLayout(false);
			((ISupportInitialize)dataGrid).EndInit();
			((Control)this).ResumeLayout(false);
		}

		protected override bool ProcessCmdKey(ref Message m, Keys keyData)
		{
			//IL_000f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0010: Unknown result type (might be due to invalid IL or missing references)
			//IL_0016: Unknown result type (might be due to invalid IL or missing references)
			//IL_001c: Invalid comparison between Unknown and I4
			//IL_01eb: Unknown result type (might be due to invalid IL or missing references)
			//IL_01f1: Unknown result type (might be due to invalid IL or missing references)
			//IL_01f7: Invalid comparison between Unknown and I4
			//IL_0021: Unknown result type (might be due to invalid IL or missing references)
			//IL_0024: Invalid comparison between Unknown and I4
			//IL_0212: Unknown result type (might be due to invalid IL or missing references)
			//IL_01f9: Unknown result type (might be due to invalid IL or missing references)
			//IL_01fc: Invalid comparison between Unknown and I4
			//IL_0075: Unknown result type (might be due to invalid IL or missing references)
			//IL_007a: Unknown result type (might be due to invalid IL or missing references)
			//IL_0026: Unknown result type (might be due to invalid IL or missing references)
			//IL_0029: Invalid comparison between Unknown and I4
			//IL_0131: Unknown result type (might be due to invalid IL or missing references)
			//IL_0134: Invalid comparison between Unknown and I4
			try
			{
				Keys val = (Keys)((Message)(ref m)).WParam.ToInt32();
				if ((keyData & 0x40000) == 262144 && ((int)val == 38 || (int)val == 40))
				{
					long num = 0L;
					BindingManagerBase val2 = ((Control)this).BindingContext[((DataGrid)dataGrid).DataSource, ((DataGrid)dataGrid).DataMember];
					DataRowView dataRowView = (DataRowView)val2.Current;
					DataColumnCollection columns = dataRowView.DataView.Table.Columns;
					DataGridCell currentCell = ((DataGrid)dataGrid).CurrentCell;
					string columnName = columns[((DataGridCell)(ref currentCell)).ColumnNumber].ColumnName;
					string text = dataRowView.Row[columnName].ToString();
					if (controller.DisplayFormat == DataFormat.Binary)
					{
						num = Convert.ToInt32(text, 2);
					}
					else if (controller.DisplayFormat == DataFormat.Hex)
					{
						num = long.Parse(text, NumberStyles.HexNumber);
					}
					else
					{
						if (text.IndexOf(".") != -1)
						{
							text = text.Remove(text.IndexOf("."), text.Length - text.IndexOf("."));
						}
						num = long.Parse(text);
						text = Convert.ToString(num, 16);
						num = long.Parse(text, NumberStyles.HexNumber);
					}
					num = (((int)val != 40) ? (num + 1) : (num - 1));
					if (controller.DisplayFormat == DataFormat.Binary)
					{
						string text2 = text;
						text = Convert.ToString(num, 2);
						if (text2.Length > text.Length)
						{
							text = text.PadLeft(text2.Length, '0');
						}
					}
					else if (controller.DisplayFormat == DataFormat.Hex)
					{
						string text3 = text;
						text = num.ToString("X");
						if (text3.Length > text.Length)
						{
							text = text.PadLeft(text3.Length, '0');
						}
					}
					else
					{
						text = $"{num}";
					}
					dataRowView.Row[columnName] = text;
					return true;
				}
				if ((keyData & 0x20000) == 131072 && (int)val == 73)
				{
					Properties_Click(this, null);
					return true;
				}
			}
			catch
			{
			}
			return ((ContainerControl)this).ProcessCmdKey(ref m, keyData);
		}
	}
	public class MemoryMapController : ParameterController
	{
		private IMonitoredModel model;

		private string displayUnit;

		private string xDisplayUnit;

		private int dataTableXAxisColumnChars;

		private int dataTableValueColumnChars;

		private int propertiesTablePropertyColumnChars;

		private int propertiesTableValueColumnChars;

		private string previousColumnName;

		private int previousRowIndex;

		private string previousValue;

		public override DataTable Data
		{
			get
			{
				if (dataTable == null)
				{
					try
					{
						InitializeDataTable();
					}
					catch (Exception ex)
					{
						throw ex;
					}
				}
				return dataTable;
			}
		}

		public override DataTable Properties
		{
			get
			{
				if (propertiesTable == null)
				{
					try
					{
						InitializePropertiesTable();
					}
					catch (Exception ex)
					{
						throw ex;
					}
				}
				return propertiesTable;
			}
		}

		public string DisplayUnit
		{
			get
			{
				return displayUnit;
			}
			set
			{
				if (value.Length <= 0)
				{
					return;
				}
				displayUnit = value;
				if (dataTable != null)
				{
					try
					{
						dataTable.Columns["Value"].Caption = displayUnit;
					}
					catch (Exception ex)
					{
						throw ex;
					}
				}
			}
		}

		public string XDisplayUnit
		{
			get
			{
				return xDisplayUnit;
			}
			set
			{
				if (value.Length <= 0)
				{
					return;
				}
				xDisplayUnit = value;
				if (dataTable != null)
				{
					try
					{
						dataTable.Columns["XAxis"].Caption = xDisplayUnit;
					}
					catch (Exception ex)
					{
						throw ex;
					}
				}
			}
		}

		public int DataTableXAxisColumnChars
		{
			get
			{
				return dataTableXAxisColumnChars;
			}
			set
			{
				if (value > dataTableXAxisColumnChars)
				{
					dataTableXAxisColumnChars = value;
				}
			}
		}

		public int DataTableValueColumnChars
		{
			get
			{
				return dataTableValueColumnChars;
			}
			set
			{
				if (value > dataTableValueColumnChars)
				{
					dataTableValueColumnChars = value;
				}
			}
		}

		public override int PropertiesTablePropertyColumnChars
		{
			get
			{
				return propertiesTablePropertyColumnChars;
			}
			set
			{
				if (value > propertiesTablePropertyColumnChars)
				{
					propertiesTablePropertyColumnChars = value;
				}
			}
		}

		public override int PropertiesTableValueColumnChars
		{
			get
			{
				return propertiesTableValueColumnChars;
			}
			set
			{
				if (value > propertiesTableValueColumnChars)
				{
					propertiesTableValueColumnChars = value;
				}
			}
		}

		public MemoryMapController(IMonitoredModel memoryMapModel)
			: base(memoryMapModel)
		{
			model = memoryMapModel;
			previousColumnName = "";
			previousRowIndex = -1;
			previousValue = "";
		}

		public override void Undo()
		{
			try
			{
				DataRow dataRow = dataTable.Rows[previousRowIndex];
				dataRow[previousColumnName] = previousValue;
			}
			catch
			{
			}
		}

		public override void Revert()
		{
			try
			{
				try
				{
					model.ParameterModel.Revert();
				}
				catch
				{
				}
				RaiseAllCellsUnmodifiedEvent();
			}
			catch (Exception ex)
			{
				throw ex;
			}
		}

		public override void Save()
		{
			try
			{
				model.ParameterModel.Save();
				RaiseAllCellsUnmodifiedEvent();
			}
			catch (Exception ex)
			{
				throw ex;
			}
		}

		public override void DataMode(DataFormat displayFormat)
		{
			if (base.DisplayFormat != displayFormat)
			{
				base.DisplayFormat = displayFormat;
				try
				{
					dataTable.Rows.Clear();
				}
				catch (Exception)
				{
				}
			}
		}

		private void InitializeDataTable()
		{
			try
			{
				dataTable = new DataTable();
				dataTable.TableName = "DataTable";
				CreateDataColumns();
			}
			catch (Exception ex)
			{
				throw ex;
			}
		}

		private void InitializePropertiesTable()
		{
			try
			{
				propertiesTable = new DataTable();
				propertiesTable.TableName = "PropertiesTable";
				CreatePropertyColumns(propertiesTable);
				LoadPropertiesTable();
			}
			catch (Exception ex)
			{
				throw ex;
			}
		}

		private void CreateDataColumns()
		{
			DataColumn column = MakeDataColumn(XDisplayUnit, "XAxis", Type.GetType("System.String"), isReadOnly: false, isUnique: false);
			dataTable.Columns.Add(column);
			column = MakeDataColumn(DisplayUnit, "Value", Type.GetType("System.String"), isReadOnly: false, isUnique: false);
			dataTable.Columns.Add(column);
			column = MakeDataColumn("", "Index", Type.GetType("System.Int32"), isReadOnly: true, isUnique: true);
			column.ColumnMapping = MappingType.Hidden;
			dataTable.Columns.Add(column);
		}

		private void LoadPropertiesTable()
		{
			try
			{
				AddToPropertiesTable("Full Name", model.ParameterModel.FullName);
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Address", model.ParameterModel.Address, "X8");
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Length", model.ParameterModel.Length.ToString());
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Data Type", (long)model.ParameterModel.DataType, "N0");
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Config Data Type", model.ParameterModel.ConfigFileType, "N0");
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Minimum Value", model.ParameterModel.LowerBound.ToString());
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Maximum Value", model.ParameterModel.UpperBound.ToString());
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Subfile Number", model.ParameterModel.SubfileNumber, "N0");
			}
			catch
			{
			}
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = "Available Offline";
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
			try
			{
				AddToPropertiesTable("Raw Value (Hex)", (model.ParameterModel as IValueModel).HexValue().ToString());
			}
			catch
			{
			}
			try
			{
				AddToPropertiesTable("Floating Point Value", (model.ParameterModel as IMemoryMapModel).FixPointValue().ToString());
			}
			catch
			{
			}
		}

		private void AddToPropertiesTable(string propertyName, string propertyValue)
		{
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = propertyName;
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = propertyValue;
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
		}

		private void AddToPropertiesTable(string propertyName, long propertyValue, string format)
		{
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = propertyName;
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = propertyValue.ToString(format);
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
		}
	}
	public class MemoryMapDataView : ParameterView
	{
		private MemoryMapController controller;

		private DataGrid dataGrid;

		private Panel panel;

		private Container components;

		private ContextMenu csmMenu;

		private int rowClicked;

		public override Panel Panel => panel;

		public MemoryMapDataView(MemoryMapController memoryMapController, Font font)
			: base(font)
		{
			//IL_0080: Unknown result type (might be due to invalid IL or missing references)
			//IL_0086: Expected O, but got Unknown
			//IL_009e: Unknown result type (might be due to invalid IL or missing references)
			//IL_00a8: Expected O, but got Unknown
			//IL_00c5: Unknown result type (might be due to invalid IL or missing references)
			//IL_00cf: Expected O, but got Unknown
			//IL_00ed: Unknown result type (might be due to invalid IL or missing references)
			//IL_00f7: Expected O, but got Unknown
			//IL_0115: Unknown result type (might be due to invalid IL or missing references)
			//IL_011f: Expected O, but got Unknown
			//IL_013e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0148: Expected O, but got Unknown
			//IL_017e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0188: Expected O, but got Unknown
			controller = memoryMapController;
			rowClicked = -1;
			InitializeComponent();
			dataGrid.AllowSorting = false;
			dataGrid.CaptionText = controller.Name;
			dataGrid.DataSource = controller.Data;
			dataGrid.AllowSorting = false;
			CurrencyManager val = (CurrencyManager)((Control)this).BindingContext[dataGrid.DataSource, dataGrid.DataMember];
			((DataView)val.List).AllowNew = false;
			SetColumnStyles();
			csmMenu = new ContextMenu();
			((Menu)csmMenu).MenuItems.Add(0, new MenuItem("Copy", (EventHandler)Copy_Click));
			((Menu)csmMenu).MenuItems.Add(1, new MenuItem("Paste", (EventHandler)Paste_Click));
			((Menu)csmMenu).MenuItems.Add(2, new MenuItem("Undo", (EventHandler)Undo_Click));
			((Menu)csmMenu).MenuItems.Add(3, new MenuItem("Properties", (EventHandler)Properties_Click));
			((Control)dataGrid).ContextMenu = csmMenu;
			controller.CellChangedEvent += OnCellChanged;
			((Control)dataGrid).MouseDown += new MouseEventHandler(OnMouseDown);
			controller.AllCellsUnmodifiedEvent += OnAllCellsUnmodified;
			((DataView)val.List).ListChanged += OnListChanged;
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		public override void SetDisplayMode(DataFormat dataFormat)
		{
			base.DataViewFormat = dataFormat;
			SetColumnStyles();
		}

		protected override void OnListChanged(object sender, ListChangedEventArgs args)
		{
			dataGrid.CurrentRowIndex = 0;
		}

		protected void Copy_Click(object sender, EventArgs e)
		{
			try
			{
				StringBuilder stringBuilder = new StringBuilder();
				for (int i = 0; i < ((DataTable)dataGrid.DataSource).Rows.Count; i++)
				{
					if (dataGrid.IsSelected(i))
					{
						DataRow dataRow = ((DataTable)dataGrid.DataSource).Rows[i];
						object[] itemArray = dataRow.ItemArray;
						foreach (object obj in itemArray)
						{
							stringBuilder.Append(obj.ToString());
							stringBuilder.Append("\t");
						}
						stringBuilder.Append("\n");
					}
				}
				if (stringBuilder.Length != 0)
				{
					Thread thread = CopyThread.CreateThread(stringBuilder.ToString());
					thread.SetApartmentState(ApartmentState.STA);
					thread.Start();
				}
			}
			catch
			{
			}
		}

		protected void Paste_Click(object sender, EventArgs e)
		{
		}

		protected void Undo_Click(object sender, EventArgs e)
		{
			int currentRowIndex = 0;
			if (rowClicked != -1)
			{
				currentRowIndex = rowClicked;
			}
			controller.Undo();
			dataGrid.CurrentRowIndex = currentRowIndex;
		}

		protected override void Properties_Click(object sender, EventArgs e)
		{
			base.Properties_Click(this, e);
		}

		private void SetColumnStyles()
		{
			//IL_001c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0022: Expected O, but got Unknown
			//IL_0046: Unknown result type (might be due to invalid IL or missing references)
			//IL_004c: Expected O, but got Unknown
			dataGrid.TableStyles.Clear();
			DataTable data = controller.Data;
			DataGridTableStyle val = new DataGridTableStyle();
			val.MappingName = data.TableName;
			val.AllowSorting = false;
			CurrencyManager val2 = (CurrencyManager)((Control)dataGrid).BindingContext[(object)data];
			PropertyDescriptor pd = ((BindingManagerBase)val2).GetItemProperties()["XAxis"];
			ColoredTextBoxColumn coloredTextBoxColumn = new ColoredTextBoxColumn(dataGrid, pd);
			SetColumnStyle((DataGridTextBoxColumn)(object)coloredTextBoxColumn, "", "XAxis", GetColumnWidth(controller.DataTableXAxisColumnChars), data.Columns["XAxis"].ReadOnly);
			val.GridColumnStyles.Add((DataGridColumnStyle)(object)coloredTextBoxColumn);
			dataGrid.TableStyles.Add(val);
		}

		private void OnCellChanged(object sender, DataColumnChangeEventArgs e)
		{
			AddModifiedParameter(e.Row["Name"].ToString().Trim());
			ColoredTextBoxColumn coloredTextBoxColumn = (ColoredTextBoxColumn)(object)dataGrid.TableStyles["DataTable"].GridColumnStyles[e.Column.ColumnName];
			int rowNum = (int)e.Row["XIndex"] + 1;
			coloredTextBoxColumn.ShowCellModified(rowNum);
		}

		private void OnMouseDown(object sender, MouseEventArgs e)
		{
			//IL_0008: Unknown result type (might be due to invalid IL or missing references)
			//IL_0012: Invalid comparison between Unknown and I4
			//IL_0035: Unknown result type (might be due to invalid IL or missing references)
			//IL_003b: Invalid comparison between Unknown and I4
			//IL_003e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0044: Invalid comparison between Unknown and I4
			rowClicked = -1;
			if ((int)e.Button == 2097152)
			{
				Point point = new Point(e.X, e.Y);
				HitTestInfo val = dataGrid.HitTest(point);
				if ((int)val.Type == 4 || (int)val.Type == 1)
				{
					rowClicked = val.Row;
				}
			}
		}

		private void OnAllCellsUnmodified(object sender, EventArgs e)
		{
			try
			{
				ColoredTextBoxColumn coloredTextBoxColumn = (ColoredTextBoxColumn)(object)dataGrid.TableStyles["DataTable"].GridColumnStyles["XAxis"];
				coloredTextBoxColumn.ShowAllCellsUnmodified();
			}
			catch (Exception ex)
			{
				_ = ex.Message;
			}
		}

		private void InitializeComponent()
		{
			//IL_0001: Unknown result type (might be due to invalid IL or missing references)
			//IL_000b: Expected O, but got Unknown
			//IL_000c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0016: Expected O, but got Unknown
			panel = new Panel();
			dataGrid = new DataGrid();
			((Control)panel).SuspendLayout();
			((ISupportInitialize)dataGrid).BeginInit();
			((Control)this).SuspendLayout();
			((Control)panel).Controls.AddRange((Control[])(object)new Control[1] { (Control)dataGrid });
			((Control)panel).Location = new Point(16, 16);
			((Control)panel).Name = "panel";
			((Control)panel).Size = new Size(496, 296);
			((Control)panel).TabIndex = 0;
			((Control)dataGrid).Anchor = (AnchorStyles)15;
			dataGrid.DataMember = "";
			dataGrid.HeaderForeColor = SystemColors.ControlText;
			((Control)dataGrid).Location = new Point(8, 8);
			((Control)dataGrid).Name = "dataGrid";
			((Control)dataGrid).Size = new Size(480, 272);
			((Control)dataGrid).TabIndex = 7;
			((Control)this).Controls.AddRange((Control[])(object)new Control[1] { (Control)panel });
			((Control)this).Name = "MemoryMapDataView";
			((Control)this).Size = new Size(528, 328);
			((Control)panel).ResumeLayout(false);
			((ISupportInitialize)dataGrid).EndInit();
			((Control)this).ResumeLayout(false);
		}

		protected override bool ProcessCmdKey(ref Message m, Keys keyData)
		{
			//IL_000f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0010: Unknown result type (might be due to invalid IL or missing references)
			//IL_0016: Unknown result type (might be due to invalid IL or missing references)
			//IL_001c: Invalid comparison between Unknown and I4
			//IL_01eb: Unknown result type (might be due to invalid IL or missing references)
			//IL_01f1: Unknown result type (might be due to invalid IL or missing references)
			//IL_01f7: Invalid comparison between Unknown and I4
			//IL_0021: Unknown result type (might be due to invalid IL or missing references)
			//IL_0024: Invalid comparison between Unknown and I4
			//IL_0212: Unknown result type (might be due to invalid IL or missing references)
			//IL_01f9: Unknown result type (might be due to invalid IL or missing references)
			//IL_01fc: Invalid comparison between Unknown and I4
			//IL_0075: Unknown result type (might be due to invalid IL or missing references)
			//IL_007a: Unknown result type (might be due to invalid IL or missing references)
			//IL_0026: Unknown result type (might be due to invalid IL or missing references)
			//IL_0029: Invalid comparison between Unknown and I4
			//IL_0131: Unknown result type (might be due to invalid IL or missing references)
			//IL_0134: Invalid comparison between Unknown and I4
			try
			{
				Keys val = (Keys)((Message)(ref m)).WParam.ToInt32();
				if ((keyData & 0x40000) == 262144 && ((int)val == 38 || (int)val == 40))
				{
					long num = 0L;
					BindingManagerBase val2 = ((Control)this).BindingContext[dataGrid.DataSource, dataGrid.DataMember];
					DataRowView dataRowView = (DataRowView)val2.Current;
					DataColumnCollection columns = dataRowView.DataView.Table.Columns;
					DataGridCell currentCell = dataGrid.CurrentCell;
					string columnName = columns[((DataGridCell)(ref currentCell)).ColumnNumber].ColumnName;
					string text = dataRowView.Row[columnName].ToString();
					if (controller.DisplayFormat == DataFormat.Binary)
					{
						num = Convert.ToInt32(text, 2);
					}
					else if (controller.DisplayFormat == DataFormat.Hex)
					{
						num = long.Parse(text, NumberStyles.HexNumber);
					}
					else
					{
						if (text.IndexOf(".") != -1)
						{
							text = text.Remove(text.IndexOf("."), text.Length - text.IndexOf("."));
						}
						num = long.Parse(text);
						text = Convert.ToString(num, 16);
						num = long.Parse(text, NumberStyles.HexNumber);
					}
					num = (((int)val != 40) ? (num + 1) : (num - 1));
					if (controller.DisplayFormat == DataFormat.Binary)
					{
						string text2 = text;
						text = Convert.ToString(num, 2);
						if (text2.Length > text.Length)
						{
							text = text.PadLeft(text2.Length, '0');
						}
					}
					else if (controller.DisplayFormat == DataFormat.Hex)
					{
						string text3 = text;
						text = num.ToString("X");
						if (text3.Length > text.Length)
						{
							text = text.PadLeft(text3.Length, '0');
						}
					}
					else
					{
						text = $"{num}";
					}
					dataRowView.Row[columnName] = text;
					return true;
				}
				if ((keyData & 0x20000) == 131072 && (int)val == 73)
				{
					Properties_Click(this, null);
					return true;
				}
			}
			catch
			{
			}
			return ((ContainerControl)this).ProcessCmdKey(ref m, keyData);
		}
	}
	public class ParameterChangedEventArgs : EventArgs
	{
		private string parameterName;

		public string ParameterName => parameterName;

		public ParameterChangedEventArgs(string parameterName)
		{
			this.parameterName = parameterName;
		}
	}
	public enum DataAccessType
	{
		Proprietary,
		PublicDataRequestReceive,
		PublicDataBroadcast
	}
	public class ParameterEventArgs : EventArgs
	{
		private long order;

		private string name;

		private string fullName;

		private IAddressValue sourceAddress;

		private ParameterType type;

		private string units;

		private uint address;

		private int offset;

		private uint length;

		private bool readabilityCheckPassed;

		private IParameterModel parameterModel;

		private IParameterSpecification parameterSpecification;

		private DataAccessType _dataAccessType;

		public long Order
		{
			get
			{
				return order;
			}
			set
			{
				order = value;
			}
		}

		public string Name
		{
			get
			{
				return name;
			}
			set
			{
				name = value;
			}
		}

		public string FullName
		{
			get
			{
				return fullName;
			}
			set
			{
				fullName = value;
			}
		}

		public IAddressValue SourceAddress
		{
			get
			{
				return sourceAddress;
			}
			set
			{
				sourceAddress = value;
			}
		}

		public ParameterType Type
		{
			get
			{
				return type;
			}
			set
			{
				type = value;
			}
		}

		public string Units
		{
			get
			{
				return units;
			}
			set
			{
				units = value;
			}
		}

		public uint Address
		{
			get
			{
				return address;
			}
			set
			{
				address = value;
			}
		}

		public int Offset
		{
			get
			{
				return offset;
			}
			set
			{
				offset = value;
			}
		}

		public uint Length
		{
			get
			{
				return length;
			}
			set
			{
				length = value;
			}
		}

		public bool ReadabilityCheckPassed
		{
			get
			{
				return readabilityCheckPassed;
			}
			set
			{
				readabilityCheckPassed = value;
			}
		}

		public IParameterModel ParameterModel
		{
			get
			{
				return parameterModel;
			}
			set
			{
				parameterModel = value;
			}
		}

		public DataAccessType DataAccessType
		{
			get
			{
				return _dataAccessType;
			}
			set
			{
				_dataAccessType = value;
			}
		}

		public IParameterSpecification ParameterSpecification
		{
			get
			{
				if (parameterSpecification == null)
				{
					parameterSpecification = ParameterModel.DataSource.GetSpecification(name);
				}
				return parameterSpecification;
			}
		}
	}
	public class ParameterQuery : Form
	{
		private Label label1;

		private TextBox Query;

		private Button QueryStart;

		private Button btnOK;

		private Button btnCancel;

		private Container components;

		private DataGrid ctlQueryResult;

		private DataGridTableStyle dgtsParameter;

		private DataGridTextBoxColumn dgcsName;

		private DataGridTextBoxColumn dgcsComment;

		private DataGridTextBoxColumn dgcsValue;

		private DataGridTextBoxColumn dgcsUnit;

		private DataGridTextBoxColumn dgcsNameTableName;

		private DataGridTextBoxColumn dgcsDisplayFormat;

		private DataGridTextBoxColumn dgcsGroupNumber;

		private DataGridTextBoxColumn dgcsLowerBound;

		private DataGridTextBoxColumn dgcsUpperBound;

		private DataRow[] userChoice;

		private DataTable parameterTable;

		private CheckBox chkSearchComments;

		private DataView parameterView;

		private ComboBox filterParameterType;

		private bool processed;

		private ParameterFilterType currentFilterType;

		private DataGridBoolColumn dgcsSelectParameter;

		private IAppConfigService appConfigService;

		public DataRow[] UserChoice => userChoice;

		public DataTable ParameterTable
		{
			set
			{
				parameterTable = value;
				parameterView = new DataView(value);
				ctlQueryResult.DataSource = parameterView;
				parameterView.Sort = "Name";
			}
		}

		public ParameterQuery()
		{
			//IL_0020: Unknown result type (might be due to invalid IL or missing references)
			//IL_002a: Expected O, but got Unknown
			InitializeComponent();
			chkSearchComments.Checked = true;
			((Control)this).KeyUp += new KeyEventHandler(ParamQuery_KeyUp);
			processed = false;
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing)
			{
				if (components != null)
				{
					components.Dispose();
				}
				if (parameterView != null)
				{
					parameterView.Dispose();
				}
			}
			((Form)this).Dispose(disposing);
		}

		private void InitializeComponent()
		{
			//IL_0011: Unknown result type (might be due to invalid IL or missing references)
			//IL_001b: Expected O, but got Unknown
			//IL_001c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0026: Expected O, but got Unknown
			//IL_0027: Unknown result type (might be due to invalid IL or missing references)
			//IL_0031: Expected O, but got Unknown
			//IL_0032: Unknown result type (might be due to invalid IL or missing references)
			//IL_003c: Expected O, but got Unknown
			//IL_003d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0047: Expected O, but got Unknown
			//IL_0048: Unknown result type (might be due to invalid IL or missing references)
			//IL_0052: Expected O, but got Unknown
			//IL_0053: Unknown result type (might be due to invalid IL or missing references)
			//IL_005d: Expected O, but got Unknown
			//IL_005e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0068: Expected O, but got Unknown
			//IL_0069: Unknown result type (might be due to invalid IL or missing references)
			//IL_0073: Expected O, but got Unknown
			//IL_0074: Unknown result type (might be due to invalid IL or missing references)
			//IL_007e: Expected O, but got Unknown
			//IL_007f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0089: Expected O, but got Unknown
			//IL_008a: Unknown result type (might be due to invalid IL or missing references)
			//IL_0094: Expected O, but got Unknown
			//IL_0095: Unknown result type (might be due to invalid IL or missing references)
			//IL_009f: Expected O, but got Unknown
			//IL_00a0: Unknown result type (might be due to invalid IL or missing references)
			//IL_00aa: Expected O, but got Unknown
			//IL_00ab: Unknown result type (might be due to invalid IL or missing references)
			//IL_00b5: Expected O, but got Unknown
			//IL_00b6: Unknown result type (might be due to invalid IL or missing references)
			//IL_00c0: Expected O, but got Unknown
			//IL_00c1: Unknown result type (might be due to invalid IL or missing references)
			//IL_00cb: Expected O, but got Unknown
			//IL_00cc: Unknown result type (might be due to invalid IL or missing references)
			//IL_00d6: Expected O, but got Unknown
			//IL_00d7: Unknown result type (might be due to invalid IL or missing references)
			//IL_00e1: Expected O, but got Unknown
			//IL_0a5b: Unknown result type (might be due to invalid IL or missing references)
			//IL_0a65: Expected O, but got Unknown
			ResourceManager resourceManager = new ResourceManager(typeof(ParameterQuery));
			label1 = new Label();
			Query = new TextBox();
			QueryStart = new Button();
			btnOK = new Button();
			btnCancel = new Button();
			ctlQueryResult = new DataGrid();
			dgtsParameter = new DataGridTableStyle();
			dgcsSelectParameter = new DataGridBoolColumn();
			dgcsName = new DataGridTextBoxColumn();
			dgcsComment = new DataGridTextBoxColumn();
			dgcsValue = new DataGridTextBoxColumn();
			dgcsUnit = new DataGridTextBoxColumn();
			dgcsNameTableName = new DataGridTextBoxColumn();
			dgcsDisplayFormat = new DataGridTextBoxColumn();
			dgcsGroupNumber = new DataGridTextBoxColumn();
			dgcsLowerBound = new DataGridTextBoxColumn();
			dgcsUpperBound = new DataGridTextBoxColumn();
			chkSearchComments = new CheckBox();
			filterParameterType = new ComboBox();
			((ISupportInitialize)ctlQueryResult).BeginInit();
			((Control)this).SuspendLayout();
			((Control)label1).Location = new Point(8, 16);
			((Control)label1).Name = "label1";
			((Control)label1).Size = new Size(72, 16);
			((Control)label1).TabIndex = 7;
			((Control)label1).Text = "Query String:";
			Query.AcceptsReturn = true;
			((Control)Query).Location = new Point(80, 12);
			((Control)Query).Name = "Query";
			((Control)Query).Size = new Size(280, 20);
			((Control)Query).TabIndex = 0;
			((Control)Query).Text = "";
			((Control)Query).TextChanged += Query_TextChanged;
			((Control)QueryStart).Location = new Point(376, 8);
			((Control)QueryStart).Name = "QueryStart";
			((Control)QueryStart).Size = new Size(56, 24);
			((Control)QueryStart).TabIndex = 1;
			((Control)QueryStart).Text = "&Query";
			((Control)QueryStart).Click += QueryStart_Click;
			((Control)btnOK).Anchor = (AnchorStyles)10;
			btnOK.DialogResult = (DialogResult)1;
			((Control)btnOK).Location = new Point(272, 264);
			((Control)btnOK).Name = "btnOK";
			((Control)btnOK).TabIndex = 5;
			((Control)btnOK).Text = "&Ok";
			((Control)btnOK).Click += btnOK_Click;
			((Control)btnCancel).Anchor = (AnchorStyles)10;
			((Control)btnCancel).CausesValidation = false;
			btnCancel.DialogResult = (DialogResult)2;
			((Control)btnCancel).Location = new Point(360, 264);
			((Control)btnCancel).Name = "btnCancel";
			((Control)btnCancel).TabIndex = 6;
			((Control)btnCancel).Text = "&Cancel";
			((Control)btnCancel).Click += btnCancel_Click;
			ctlQueryResult.AllowNavigation = false;
			((Control)ctlQueryResult).Anchor = (AnchorStyles)15;
			ctlQueryResult.BackgroundColor = SystemColors.Window;
			ctlQueryResult.CaptionVisible = false;
			ctlQueryResult.DataMember = "";
			ctlQueryResult.HeaderForeColor = SystemColors.ControlText;
			((Control)ctlQueryResult).Location = new Point(8, 64);
			((Control)ctlQueryResult).Name = "ctlQueryResult";
			((Control)ctlQueryResult).Size = new Size(424, 192);
			((Control)ctlQueryResult).TabIndex = 4;
			ctlQueryResult.TableStyles.AddRange((DataGridTableStyle[])(object)new DataGridTableStyle[1] { dgtsParameter });
			dgtsParameter.DataGrid = ctlQueryResult;
			dgtsParameter.GridColumnStyles.AddRange((DataGridColumnStyle[])(object)new DataGridColumnStyle[10]
			{
				(DataGridColumnStyle)dgcsSelectParameter,
				(DataGridColumnStyle)dgcsName,
				(DataGridColumnStyle)dgcsComment,
				(DataGridColumnStyle)dgcsValue,
				(DataGridColumnStyle)dgcsUnit,
				(DataGridColumnStyle)dgcsNameTableName,
				(DataGridColumnStyle)dgcsDisplayFormat,
				(DataGridColumnStyle)dgcsGroupNumber,
				(DataGridColumnStyle)dgcsLowerBound,
				(DataGridColumnStyle)dgcsUpperBound
			});
			dgtsParameter.HeaderForeColor = SystemColors.ControlText;
			dgtsParameter.MappingName = "Parameter";
			dgtsParameter.PreferredColumnWidth = 200;
			dgtsParameter.RowHeadersVisible = false;
			dgcsSelectParameter.AllowNull = false;
			dgcsSelectParameter.FalseValue = false;
			((DataGridColumnStyle)dgcsSelectParameter).HeaderText = "Select";
			((DataGridColumnStyle)dgcsSelectParameter).MappingName = "";
			dgcsSelectParameter.NullValue = resourceManager.GetObject("dgcsSelectParameter.NullValue");
			dgcsSelectParameter.TrueValue = true;
			((DataGridColumnStyle)dgcsSelectParameter).Width = 40;
			dgcsName.Format = "";
			dgcsName.FormatInfo = null;
			((DataGridColumnStyle)dgcsName).HeaderText = "Name";
			((DataGridColumnStyle)dgcsName).MappingName = "Name";
			((DataGridColumnStyle)dgcsName).NullText = "";
			((DataGridColumnStyle)dgcsName).ReadOnly = true;
			((DataGridColumnStyle)dgcsName).Width = 200;
			dgcsComment.Format = "";
			dgcsComment.FormatInfo = null;
			((DataGridColumnStyle)dgcsComment).HeaderText = "Comment";
			((DataGridColumnStyle)dgcsComment).MappingName = "Comment";
			((DataGridColumnStyle)dgcsComment).NullText = "";
			((DataGridColumnStyle)dgcsComment).ReadOnly = true;
			((DataGridColumnStyle)dgcsComment).Width = 500;
			dgcsValue.Format = "";
			dgcsValue.FormatInfo = null;
			((DataGridColumnStyle)dgcsValue).HeaderText = "Value";
			((DataGridColumnStyle)dgcsValue).MappingName = "Value";
			((DataGridColumnStyle)dgcsValue).NullText = "";
			((DataGridColumnStyle)dgcsValue).ReadOnly = true;
			((DataGridColumnStyle)dgcsValue).Width = 0;
			dgcsUnit.Format = "";
			dgcsUnit.FormatInfo = null;
			((DataGridColumnStyle)dgcsUnit).HeaderText = "Unit";
			((DataGridColumnStyle)dgcsUnit).MappingName = "Unit";
			((DataGridColumnStyle)dgcsUnit).NullText = "";
			((DataGridColumnStyle)dgcsUnit).ReadOnly = true;
			((DataGridColumnStyle)dgcsUnit).Width = 0;
			dgcsNameTableName.Format = "";
			dgcsNameTableName.FormatInfo = null;
			((DataGridColumnStyle)dgcsNameTableName).HeaderText = "Name Table Name";
			((DataGridColumnStyle)dgcsNameTableName).MappingName = "NameTableName";
			((DataGridColumnStyle)dgcsNameTableName).NullText = "";
			((DataGridColumnStyle)dgcsNameTableName).ReadOnly = true;
			((DataGridColumnStyle)dgcsNameTableName).Width = 0;
			dgcsDisplayFormat.Format = "";
			dgcsDisplayFormat.FormatInfo = null;
			((DataGridColumnStyle)dgcsDisplayFormat).HeaderText = "Display Format";
			((DataGridColumnStyle)dgcsDisplayFormat).MappingName = "DisplayFormat";
			((DataGridColumnStyle)dgcsDisplayFormat).NullText = "";
			((DataGridColumnStyle)dgcsDisplayFormat).ReadOnly = true;
			((DataGridColumnStyle)dgcsDisplayFormat).Width = 0;
			dgcsGroupNumber.Format = "";
			dgcsGroupNumber.FormatInfo = null;
			((DataGridColumnStyle)dgcsGroupNumber).HeaderText = "Group Number";
			((DataGridColumnStyle)dgcsGroupNumber).MappingName = "GroupNumber";
			((DataGridColumnStyle)dgcsGroupNumber).NullText = "";
			((DataGridColumnStyle)dgcsGroupNumber).ReadOnly = true;
			((DataGridColumnStyle)dgcsGroupNumber).Width = 0;
			dgcsLowerBound.Format = "";
			dgcsLowerBound.FormatInfo = null;
			((DataGridColumnStyle)dgcsLowerBound).HeaderText = "Lower Bound";
			((DataGridColumnStyle)dgcsLowerBound).MappingName = "LowerBound";
			((DataGridColumnStyle)dgcsLowerBound).NullText = "";
			((DataGridColumnStyle)dgcsLowerBound).ReadOnly = true;
			((DataGridColumnStyle)dgcsLowerBound).Width = 0;
			dgcsUpperBound.Format = "";
			dgcsUpperBound.FormatInfo = null;
			((DataGridColumnStyle)dgcsUpperBound).HeaderText = "Upper Bound";
			((DataGridColumnStyle)dgcsUpperBound).MappingName = "UpperBound";
			((DataGridColumnStyle)dgcsUpperBound).NullText = "";
			((DataGridColumnStyle)dgcsUpperBound).ReadOnly = true;
			((DataGridColumnStyle)dgcsUpperBound).Width = 0;
			((Control)chkSearchComments).Location = new Point(304, 40);
			((Control)chkSearchComments).Name = "chkSearchComments";
			((Control)chkSearchComments).Size = new Size(128, 16);
			((Control)chkSearchComments).TabIndex = 3;
			((Control)chkSearchComments).Text = "Search Comments?";
			filterParameterType.DropDownStyle = (ComboBoxStyle)2;
			filterParameterType.Items.AddRange(new object[3] { "Show all parameters", "Show interface parameters", "Hide interface parameters" });
			((Control)filterParameterType).Location = new Point(136, 38);
			((Control)filterParameterType).Name = "filterParameterType";
			((Control)filterParameterType).Size = new Size(152, 21);
			((Control)filterParameterType).TabIndex = 2;
			filterParameterType.SelectedIndexChanged += filterParameterType_SelectedIndexChanged;
			((Form)this).AutoScaleBaseSize = new Size(5, 13);
			((Form)this).CancelButton = (IButtonControl)(object)btnCancel;
			((Form)this).ClientSize = new Size(440, 294);
			((Control)this).Controls.Add((Control)(object)filterParameterType);
			((Control)this).Controls.Add((Control)(object)chkSearchComments);
			((Control)this).Controls.Add((Control)(object)ctlQueryResult);
			((Control)this).Controls.Add((Control)(object)btnCancel);
			((Control)this).Controls.Add((Control)(object)btnOK);
			((Control)this).Controls.Add((Control)(object)QueryStart);
			((Control)this).Controls.Add((Control)(object)Query);
			((Control)this).Controls.Add((Control)(object)label1);
			((Form)this).Icon = (Icon)resourceManager.GetObject("$this.Icon");
			((Form)this).KeyPreview = true;
			((Form)this).MaximizeBox = false;
			((Control)this).Name = "ParameterQuery";
			((Control)this).Text = "Parameter Query";
			((Form)this).Load += ParameterQuery_Load;
			((ISupportInitialize)ctlQueryResult).EndInit();
			((Control)this).ResumeLayout(false);
		}

		private void Query_TextChanged(object sender, EventArgs e)
		{
		}

		private void QueryStart_Click(object sender, EventArgs e)
		{
			if (parameterView == null)
			{
				return;
			}
			if (((Control)Query).Text.Trim().Length == 0)
			{
				if (currentFilterType == ParameterFilterType.ShowAllParameters)
				{
					parameterView.RowFilter = "Name LIKE '*'";
				}
				else if (currentFilterType == ParameterFilterType.HideInterfaceParameters)
				{
					parameterView.RowFilter = "Name NOT LIKE '_*'";
				}
				else if (currentFilterType == ParameterFilterType.ShowInterfaceParameters)
				{
					parameterView.RowFilter = "Name LIKE '_*'";
				}
			}
			else if (currentFilterType == ParameterFilterType.ShowAllParameters)
			{
				if (chkSearchComments.Checked)
				{
					parameterView.RowFilter = "Name LIKE '*" + ((Control)Query).Text.Trim() + "*' OR Comment LIKE '*" + ((Control)Query).Text.Trim() + "*'";
				}
				else
				{
					parameterView.RowFilter = "Name LIKE '*" + ((Control)Query).Text.Trim() + "*'";
				}
			}
			else if (currentFilterType == ParameterFilterType.HideInterfaceParameters)
			{
				if (chkSearchComments.Checked)
				{
					parameterView.RowFilter = "Name NOT LIKE '_*' AND (Name LIKE '*" + ((Control)Query).Text.Trim() + "*' OR Comment LIKE '*" + ((Control)Query).Text.Trim() + "*')";
				}
				else
				{
					parameterView.RowFilter = "Name NOT LIKE '_*' AND Name LIKE '*" + ((Control)Query).Text.Trim() + "*'";
				}
			}
			else if (currentFilterType == ParameterFilterType.ShowInterfaceParameters)
			{
				if (chkSearchComments.Checked)
				{
					parameterView.RowFilter = "Name LIKE '_*' AND (Name LIKE '*" + ((Control)Query).Text.Trim() + "*' OR Comment LIKE '*" + ((Control)Query).Text.Trim() + "*')";
				}
				else
				{
					parameterView.RowFilter = "Name LIKE '_*' AND Name LIKE '*" + ((Control)Query).Text.Trim() + "*'";
				}
			}
		}

		private void btnOK_Click(object sender, EventArgs e)
		{
			try
			{
				if (appConfigService != null && ((Control)filterParameterType).Text != null)
				{
					appConfigService.SetAppSetting(ApplicationSettings.ParameterFilter, ((Control)filterParameterType).Text.Trim());
					appConfigService.SetAppSetting(ApplicationSettings.SearchCommentsChecked, chkSearchComments.Checked.ToString());
					appConfigService.SaveConfigSetting();
				}
				BindingManagerBase val = ((Control)this).BindingContext[ctlQueryResult.DataSource, ctlQueryResult.DataMember];
				if (val.Position >= 0)
				{
					try
					{
						DataRow[] array = parameterTable.Select("Select = 'true'");
						if (array.Length == 0)
						{
							DataRowView dataRowView = (DataRowView)val.Current;
							dataRowView.BeginEdit();
							dataRowView.Row["Select"] = true;
							dataRowView.EndEdit();
							array = parameterTable.Select("Select = 'true'");
							userChoice = array;
						}
						else
						{
							userChoice = array;
						}
					}
					catch
					{
						userChoice = null;
					}
				}
				else
				{
					userChoice = null;
				}
				if (parameterTable.Columns.Contains("Select"))
				{
					parameterTable.Columns.Remove("Select");
				}
			}
			catch
			{
				EventLogger.Warn("Parameter Query", "Parameter Query failed");
			}
		}

		private void ParamQuery_KeyUp(object sender, KeyEventArgs e)
		{
			//IL_0001: Unknown result type (might be due to invalid IL or missing references)
			//IL_0006: Unknown result type (might be due to invalid IL or missing references)
			//IL_0007: Unknown result type (might be due to invalid IL or missing references)
			//IL_000a: Invalid comparison between Unknown and I4
			//IL_000f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0012: Invalid comparison between Unknown and I4
			Keys keyCode = e.KeyCode;
			if ((int)keyCode != 9)
			{
				if ((int)keyCode == 13)
				{
					if ((object)((ContainerControl)this).ActiveControl == Query || (object)((ContainerControl)this).ActiveControl == QueryStart || (object)((ContainerControl)this).ActiveControl == filterParameterType || (object)((ContainerControl)this).ActiveControl == chkSearchComments)
					{
						QueryStart_Click(sender, (EventArgs)(object)e);
					}
					if ((object)((ContainerControl)this).ActiveControl == btnOK || (object)((ContainerControl)this).ActiveControl == ctlQueryResult || ((object)((ContainerControl)this).ActiveControl).GetType() == typeof(DataGridTextBox))
					{
						btnOK_Click(sender, (EventArgs)(object)e);
						((Form)this).DialogResult = (DialogResult)1;
					}
					if ((object)((ContainerControl)this).ActiveControl == btnCancel)
					{
						((Form)this).DialogResult = (DialogResult)2;
					}
				}
			}
			else if (((ContainerControl)this).ActiveControl != null && !e.Shift && !processed && ((object)((ContainerControl)this).ActiveControl).GetType() == typeof(DataGrid))
			{
				((Control)btnOK).Focus();
			}
		}

		private void ParameterQuery_Load(object sender, EventArgs e)
		{
			try
			{
				appConfigService = (IAppConfigService)ServiceManager.Services.GetService(typeof(IAppConfigService));
				if (appConfigService != null)
				{
					((Control)filterParameterType).Text = appConfigService.GetAppSetting(ApplicationSettings.ParameterFilter);
					chkSearchComments.Checked = bool.Parse(appConfigService.GetAppSetting(ApplicationSettings.SearchCommentsChecked));
				}
				if (!parameterTable.Columns.Contains("Select"))
				{
					DataColumn dataColumn = new DataColumn("Select", typeof(bool));
					dataColumn.ReadOnly = false;
					dataColumn.DefaultValue = false;
					((DataGridColumnStyle)dgcsSelectParameter).MappingName = "Select";
					dgcsSelectParameter.AllowNull = false;
					dgcsSelectParameter.TrueValue = true;
					dgcsSelectParameter.FalseValue = false;
					parameterTable.Columns.Add(dataColumn);
				}
				QueryStart_Click(this, null);
			}
			catch (Exception)
			{
			}
		}

		protected override bool ProcessCmdKey(ref Message m, Keys keyData)
		{
			//IL_0007: Unknown result type (might be due to invalid IL or missing references)
			//IL_000a: Invalid comparison between Unknown and I4
			//IL_00fc: Unknown result type (might be due to invalid IL or missing references)
			//IL_00db: Unknown result type (might be due to invalid IL or missing references)
			processed = false;
			if ((int)keyData == 9 && ((ContainerControl)this).ActiveControl != null)
			{
				if (((object)((ContainerControl)this).ActiveControl).GetType() == typeof(Label))
				{
					((Control)Query).Focus();
					return true;
				}
				if (((object)((ContainerControl)this).ActiveControl).GetType() == typeof(DataGrid))
				{
					((Control)btnOK).Focus();
					return true;
				}
				if (((ContainerControl)this).ActiveControl.Name == ((Control)chkSearchComments).Name)
				{
					((Control)ctlQueryResult).Focus();
					((ContainerControl)this).ActiveControl = (Control)(object)ctlQueryResult;
					int count = ((Control)ctlQueryResult).BindingContext[ctlQueryResult.DataSource, ctlQueryResult.DataMember].Count;
					if (count >= 0)
					{
						ctlQueryResult.CurrentCell = new DataGridCell(0, 0);
						ctlQueryResult.CurrentRowIndex = 0;
						processed = true;
						return true;
					}
				}
			}
			return ((Form)this).ProcessCmdKey(ref m, keyData);
		}

		private void filterParameterType_SelectedIndexChanged(object sender, EventArgs e)
		{
			switch (((Control)filterParameterType).Text)
			{
			case "Show all parameters":
				currentFilterType = ParameterFilterType.ShowAllParameters;
				break;
			case "Show interface parameters":
				currentFilterType = ParameterFilterType.ShowInterfaceParameters;
				break;
			case "Hide interface parameters":
				currentFilterType = ParameterFilterType.HideInterfaceParameters;
				break;
			}
		}

		private void btnCancel_Click(object sender, EventArgs e)
		{
			if (parameterTable.Columns.Contains("Select"))
			{
				parameterTable.Columns.Remove("Select");
			}
		}
	}
	internal enum ParameterFilterType
	{
		ShowAllParameters,
		ShowInterfaceParameters,
		HideInterfaceParameters
	}
	public delegate void ParameterChangedEventHandler(object sender, ParameterChangedEventArgs e);
	public class ParameterTextbox : UserControl
	{
		private string currentParameterName = string.Empty;

		private Parameter theParameter;

		private TextBox textBoxParameterName;

		private ContextMenu textBoxContextMenu;

		private MenuItem menuItemCopy;

		private MenuItem menuItemPaste;

		private MenuItem menuItemProperties;

		private MenuItem menuItemUndo;

		private Container components;

		[Browsable(false)]
		public Parameter Parameter
		{
			get
			{
				return theParameter;
			}
			set
			{
				if (value == null)
				{
					throw new ArgumentNullException("Try to setting NULL Parameter in ParameterTextBox");
				}
				if (value != theParameter)
				{
					theParameter = value;
					if (ParameterName.Length > 0)
					{
						ParameterName = theParameter.ParameterModel.Name;
					}
					else
					{
						ParameterName = GenerateParameterName();
					}
					currentParameterName = ParameterName;
				}
			}
		}

		public string ParameterName
		{
			get
			{
				return ((Control)textBoxParameterName).Text;
			}
			set
			{
				((Control)textBoxParameterName).Text = value;
			}
		}

		public event ParameterChangedEventHandler ParameterChangedEvent;

		public ParameterTextbox()
		{
			InitializeComponent();
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			((ContainerControl)this).Dispose(disposing);
		}

		protected void RaiseParameterChangedEvent()
		{
			if (this.ParameterChangedEvent != null)
			{
				ParameterChangedEventArgs e = new ParameterChangedEventArgs(ParameterName);
				this.ParameterChangedEvent(this, e);
			}
		}

		protected override bool ProcessCmdKey(ref Message m, Keys keyData)
		{
			//IL_000e: Unknown result type (might be due to invalid IL or missing references)
			//IL_000f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0010: Unknown result type (might be due to invalid IL or missing references)
			//IL_0011: Unknown result type (might be due to invalid IL or missing references)
			//IL_0014: Invalid comparison between Unknown and I4
			//IL_0016: Unknown result type (might be due to invalid IL or missing references)
			//IL_0019: Invalid comparison between Unknown and I4
			//IL_009a: Unknown result type (might be due to invalid IL or missing references)
			Keys val = (Keys)((Message)(ref m)).WParam.ToInt32();
			Keys val2 = val;
			if ((int)val2 != 13)
			{
				if ((int)val2 == 119)
				{
					try
					{
						EventLogger.Info("DataMonitor", ParameterName + " @ " + theParameter.ParameterModel.Address.ToString("X4"));
					}
					catch
					{
					}
				}
			}
			else if (ParameterName.Length > 0 && ParameterName.ToUpper() != currentParameterName.ToUpper())
			{
				currentParameterName = ParameterName;
				RaiseParameterChangedEvent();
			}
			return ((ContainerControl)this).ProcessCmdKey(ref m, keyData);
		}

		private void InitializeComponent()
		{
			//IL_0001: Unknown result type (might be due to invalid IL or missing references)
			//IL_000b: Expected O, but got Unknown
			//IL_000c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0016: Expected O, but got Unknown
			//IL_0017: Unknown result type (might be due to invalid IL or missing references)
			//IL_0021: Expected O, but got Unknown
			//IL_0022: Unknown result type (might be due to invalid IL or missing references)
			//IL_002c: Expected O, but got Unknown
			//IL_002d: Unknown result type (might be due to invalid IL or missing references)
			//IL_0037: Expected O, but got Unknown
			//IL_0038: Unknown result type (might be due to invalid IL or missing references)
			//IL_0042: Expected O, but got Unknown
			textBoxParameterName = new TextBox();
			textBoxContextMenu = new ContextMenu();
			menuItemCopy = new MenuItem();
			menuItemPaste = new MenuItem();
			menuItemUndo = new MenuItem();
			menuItemProperties = new MenuItem();
			((Control)this).SuspendLayout();
			((Control)textBoxParameterName).ContextMenu = textBoxContextMenu;
			((Control)textBoxParameterName).Dock = (DockStyle)5;
			((Control)textBoxParameterName).Location = new Point(0, 0);
			((Control)textBoxParameterName).Name = "textBoxParameterName";
			((Control)textBoxParameterName).Size = new Size(136, 20);
			((Control)textBoxParameterName).TabIndex = 0;
			((Control)textBoxParameterName).Text = "";
			((Control)textBoxParameterName).TextChanged += OnParameterTextBoxTextChanged;
			((Menu)textBoxContextMenu).MenuItems.AddRange((MenuItem[])(object)new MenuItem[4] { menuItemCopy, menuItemPaste, menuItemUndo, menuItemProperties });
			menuItemCopy.Index = 0;
			menuItemCopy.Text = "Copy";
			menuItemCopy.Click += menuItemCopy_Click;
			menuItemPaste.Index = 1;
			menuItemPaste.Text = "Paste";
			menuItemPaste.Click += menuItemPaste_Click;
			menuItemUndo.Index = 2;
			menuItemUndo.Text = "Undo";
			menuItemUndo.Click += menuItemUndo_Click;
			menuItemProperties.Index = 3;
			menuItemProperties.Text = "Properties";
			menuItemProperties.Click += menuItemProperties_Click;
			((Control)this).Controls.Add((Control)(object)textBoxParameterName);
			((Control)this).Name = "ParameterTextbox";
			((Control)this).Size = new Size(136, 0);
			((Control)this).ResumeLayout(false);
		}

		private void menuItemCopy_Click(object sender, EventArgs e)
		{
			SendKeys.Send("^C");
		}

		private void menuItemPaste_Click(object sender, EventArgs e)
		{
			SendKeys.Send("^V");
		}

		private void menuItemUndo_Click(object sender, EventArgs e)
		{
			SendKeys.Send("^Z");
		}

		private void menuItemProperties_Click(object sender, EventArgs e)
		{
			if (Parameter != null)
			{
				Parameter.ShowPropertiesView();
			}
		}

		private void OnParameterTextBoxTextChanged(object sender, EventArgs e)
		{
			if (ParameterName.Length == 0 && Parameter != null)
			{
				currentParameterName = string.Empty;
				theParameter = null;
				RaiseParameterChangedEvent();
			}
		}

		private string GenerateParameterName()
		{
			StringBuilder stringBuilder = new StringBuilder();
			if (Parameter != null)
			{
				stringBuilder.Append(Parameter.ParameterModel.Name);
				if (Parameter.ParameterModel is IArrayModel)
				{
					stringBuilder.Append('[');
					if (Parameter.ParameterModel is IArray1DModel)
					{
						stringBuilder.Append(((IArray1DModel)Parameter.ParameterModel).X);
					}
					if (Parameter.ParameterModel is IArray2DModel)
					{
						stringBuilder.Append(':');
						stringBuilder.Append(((IArray2DModel)Parameter.ParameterModel).Y);
					}
					stringBuilder.Append(']');
				}
			}
			return stringBuilder.ToString();
		}
	}
	public class PropertiesView : ParameterView
	{
		private ParameterController controller;

		private Panel panel;

		private DataGrid dataGrid;

		private Container components;

		public override Panel Panel => panel;

		public PropertiesView(ParameterController theController, Font font)
			: base(font)
		{
			controller = theController;
			InitializeComponent();
			dataGrid.DataSource = controller.Properties;
			dataGrid.AllowSorting = false;
			dataGrid.CaptionText = controller.Name;
			SetColumnStyles();
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		private void SetColumnStyles()
		{
			//IL_000c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0012: Expected O, but got Unknown
			//IL_001e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0024: Expected O, but got Unknown
			//IL_0078: Unknown result type (might be due to invalid IL or missing references)
			//IL_007e: Expected O, but got Unknown
			DataTable properties = controller.Properties;
			DataGridTableStyle val = new DataGridTableStyle();
			val.MappingName = properties.TableName;
			DataGridTextBoxColumn val2 = new DataGridTextBoxColumn();
			SetColumnStyle(val2, properties.Columns["Property"].Caption, "Property", GetColumnWidth(controller.PropertiesTablePropertyColumnChars), properties.Columns["Property"].ReadOnly);
			val.GridColumnStyles.Add((DataGridColumnStyle)(object)val2);
			DataGridTextBoxColumn val3 = new DataGridTextBoxColumn();
			SetColumnStyle(val3, properties.Columns["Value"].Caption, "Value", GetColumnWidth(controller.PropertiesTableValueColumnChars), properties.Columns["Value"].ReadOnly);
			val.GridColumnStyles.Add((DataGridColumnStyle)(object)val3);
			dataGrid.TableStyles.Add(val);
		}

		private void InitializeComponent()
		{
			//IL_0001: Unknown result type (might be due to invalid IL or missing references)
			//IL_000b: Expected O, but got Unknown
			//IL_000c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0016: Expected O, but got Unknown
			panel = new Panel();
			dataGrid = new DataGrid();
			((Control)panel).SuspendLayout();
			((ISupportInitialize)dataGrid).BeginInit();
			((Control)this).SuspendLayout();
			((Control)panel).Controls.AddRange((Control[])(object)new Control[1] { (Control)dataGrid });
			((Control)panel).Location = new Point(4, 4);
			((Control)panel).Name = "panel";
			((Control)panel).Size = new Size(490, 291);
			((Control)panel).TabIndex = 0;
			((Control)dataGrid).Anchor = (AnchorStyles)15;
			dataGrid.DataMember = "";
			dataGrid.HeaderForeColor = SystemColors.ControlText;
			((Control)dataGrid).Location = new Point(8, 8);
			((Control)dataGrid).Name = "dataGrid";
			((Control)dataGrid).Size = new Size(474, 275);
			((Control)dataGrid).TabIndex = 0;
			((Control)this).Controls.AddRange((Control[])(object)new Control[1] { (Control)panel });
			((Control)this).Name = "PropertiesView";
			((Control)this).Size = new Size(538, 323);
			((Control)panel).ResumeLayout(false);
			((ISupportInitialize)dataGrid).EndInit();
			((Control)this).ResumeLayout(false);
		}
	}
	public class PropertiesViewForm : Form
	{
		private Panel panel;

		private Button buttonOK;

		private Container components;

		public PropertiesViewForm(ParameterView propertiesView)
		{
			InitializeComponent();
			((Control)panel).SuspendLayout();
			((Control)panel).Anchor = (AnchorStyles)15;
			((Control)panel).Dock = (DockStyle)5;
			((Control)panel).ResumeLayout(false);
			((Control)panel).Controls.Add((Control)(object)propertiesView);
			((Control)propertiesView.Panel).Dock = (DockStyle)5;
			((Control)propertiesView).Dock = (DockStyle)5;
			((Control)propertiesView).Anchor = (AnchorStyles)15;
			((Control)panel).ResumeLayout();
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			((Form)this).Dispose(disposing);
		}

		private void buttonOK_Click(object sender, EventArgs e)
		{
			((Form)this).Close();
		}

		private void PropertiesViewForm_Load(object sender, EventArgs e)
		{
			((Form)this).TopMost = true;
		}

		private void InitializeComponent()
		{
			//IL_0011: Unknown result type (might be due to invalid IL or missing references)
			//IL_001b: Expected O, but got Unknown
			//IL_001c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0026: Expected O, but got Unknown
			//IL_0150: Unknown result type (might be due to invalid IL or missing references)
			//IL_015a: Expected O, but got Unknown
			ComponentResourceManager componentResourceManager = new ComponentResourceManager(typeof(PropertiesViewForm));
			panel = new Panel();
			buttonOK = new Button();
			((Control)this).SuspendLayout();
			((Control)panel).Anchor = (AnchorStyles)13;
			((Control)panel).Location = new Point(0, 0);
			((Control)panel).Name = "panel";
			((Control)panel).Size = new Size(544, 304);
			((Control)panel).TabIndex = 0;
			((Control)buttonOK).Anchor = (AnchorStyles)6;
			buttonOK.DialogResult = (DialogResult)1;
			((Control)buttonOK).Location = new Point(248, 320);
			((Control)buttonOK).Name = "buttonOK";
			((Control)buttonOK).Size = new Size(80, 31);
			((Control)buttonOK).TabIndex = 1;
			((Control)buttonOK).Text = "OK";
			((Form)this).AutoScaleBaseSize = new Size(5, 13);
			((Form)this).CancelButton = (IButtonControl)(object)buttonOK;
			((Form)this).ClientSize = new Size(544, 358);
			((Control)this).Controls.Add((Control)(object)buttonOK);
			((Control)this).Controls.Add((Control)(object)panel);
			((Form)this).Icon = (Icon)componentResourceManager.GetObject("$this.Icon");
			((Control)this).Name = "PropertiesViewForm";
			((Control)this).Text = "Detailed Properties";
			((Form)this).Load += PropertiesViewForm_Load;
			((Control)this).ResumeLayout(false);
		}
	}
	public class SubscriptionController
	{
		public void Pause()
		{
		}

		public void Resume()
		{
		}
	}
	public class ValueController : ParameterController
	{
		private IMonitoredModel model;

		private string displayUnit;

		private int dataTableNameColumnChars;

		private int dataTableValueColumnChars;

		private int dataTableUnitColumnChars;

		private int dataTableCommentColumnChars;

		private int propertiesTablePropertyColumnChars;

		private int propertiesTableValueColumnChars;

		private string previousValue;

		public override DataTable Data
		{
			get
			{
				if (dataTable == null)
				{
					try
					{
						InitializeDataTable();
						dataTable.ColumnChanging += OnColumnChanging;
					}
					catch (Exception ex)
					{
						throw ex;
					}
				}
				return dataTable;
			}
		}

		public override DataTable Properties
		{
			get
			{
				if (propertiesTable == null)
				{
					try
					{
						InitializePropertiesTable();
					}
					catch (Exception ex)
					{
						throw ex;
					}
				}
				return propertiesTable;
			}
		}

		public string DisplayUnit
		{
			get
			{
				return displayUnit;
			}
			set
			{
				if (value.Length > 0)
				{
					displayUnit = value;
				}
			}
		}

		public int DataTableNameColumnChars
		{
			get
			{
				return dataTableNameColumnChars;
			}
			set
			{
				if (value > dataTableNameColumnChars)
				{
					dataTableNameColumnChars = value;
				}
			}
		}

		public int DataTableValueColumnChars
		{
			get
			{
				return dataTableValueColumnChars;
			}
			set
			{
				if (value > dataTableValueColumnChars)
				{
					dataTableValueColumnChars = value;
				}
			}
		}

		public int DataTableUnitColumnChars
		{
			get
			{
				return dataTableUnitColumnChars;
			}
			set
			{
				if (value > dataTableUnitColumnChars)
				{
					dataTableUnitColumnChars = value;
				}
			}
		}

		public int DataTableCommentColumnChars
		{
			get
			{
				return dataTableCommentColumnChars;
			}
			set
			{
				if (value > dataTableCommentColumnChars)
				{
					dataTableCommentColumnChars = value;
				}
			}
		}

		public override int PropertiesTablePropertyColumnChars
		{
			get
			{
				return propertiesTablePropertyColumnChars;
			}
			set
			{
				if (value > propertiesTablePropertyColumnChars)
				{
					propertiesTablePropertyColumnChars = value;
				}
			}
		}

		public override int PropertiesTableValueColumnChars
		{
			get
			{
				return propertiesTableValueColumnChars;
			}
			set
			{
				if (value > propertiesTableValueColumnChars)
				{
					propertiesTableValueColumnChars = value;
				}
			}
		}

		public ValueController(IMonitoredModel valueModel)
			: base(valueModel)
		{
			model = valueModel;
			previousValue = "";
			dataTableNameColumnChars = 4;
			dataTableValueColumnChars = 5;
			dataTableUnitColumnChars = 4;
			dataTableCommentColumnChars = 7;
			propertiesTablePropertyColumnChars = 8;
			propertiesTableValueColumnChars = 5;
			try
			{
				displayUnit = model.EngineeringUnits;
			}
			catch (Exception)
			{
			}
			if (displayUnit == null)
			{
				displayUnit = "(null)";
			}
		}

		public override void Undo()
		{
			DataRow dataRow = dataTable.Rows[0];
			dataRow["Value"] = previousValue;
		}

		public override void Revert()
		{
			model.ParameterModel.Revert();
			dataTable.RejectChanges();
			RaiseAllCellsUnmodifiedEvent();
		}

		public override void Save()
		{
			model.ParameterModel.Save();
			dataTable.AcceptChanges();
			RaiseAllCellsUnmodifiedEvent();
		}

		public override void DataMode(DataFormat displayFormat)
		{
			if (base.DisplayFormat != displayFormat)
			{
				base.DisplayFormat = displayFormat;
				try
				{
					dataTable.Rows.Clear();
					dataTable.ColumnChanging -= OnColumnChanging;
					LoadDataTable();
					dataTable.ColumnChanging += OnColumnChanging;
				}
				catch (Exception)
				{
				}
			}
		}

		private void InitializeDataTable()
		{
			try
			{
				dataTable = new DataTable();
				dataTable.TableName = "DataTable";
				CreateDataColumns();
				LoadDataTable();
			}
			catch (Exception ex)
			{
				throw ex;
			}
		}

		private void InitializePropertiesTable()
		{
			try
			{
				propertiesTable = new DataTable();
				propertiesTable.TableName = "PropertiesTable";
				CreatePropertyColumns(propertiesTable);
				LoadPropertiesTable();
			}
			catch (Exception ex)
			{
				throw ex;
			}
		}

		private void CreateDataColumns()
		{
			DataColumn column = MakeDataColumn("Name", "Name", Type.GetType("System.String"), isReadOnly: true, isUnique: true);
			dataTable.Columns.Add(column);
			column = MakeDataColumn("Value", "Value", Type.GetType("System.String"), isReadOnly: false, isUnique: false);
			dataTable.Columns.Add(column);
			column = MakeDataColumn("Unit", "Unit", Type.GetType("System.String"), isReadOnly: true, isUnique: false);
			dataTable.Columns.Add(column);
			column = MakeDataColumn("Comment", "Comment", Type.GetType("System.String"), isReadOnly: true, isUnique: false);
			dataTable.Columns.Add(column);
		}

		private void LoadDataTable()
		{
			try
			{
				DataRow dataRow = dataTable.NewRow();
				try
				{
					dataRow["Name"] = model.Name;
					DataTableNameColumnChars = dataRow["Name"].ToString().Length;
				}
				catch (Exception ex)
				{
					throw ex;
				}
				try
				{
					if (base.DisplayFormat == DataFormat.Hex)
					{
						dataRow["Value"] = (model.ParameterModel as IValueModel).HexValue();
					}
					else if (base.DisplayFormat == DataFormat.Binary)
					{
						dataRow["Value"] = (model.ParameterModel as IValueModel).BinaryValue();
					}
					else
					{
						dataRow["Value"] = (model.ParameterModel as IValueModel).ScaledValue;
					}
					DataTableValueColumnChars = dataRow["Value"].ToString().Length;
					if (base.DisplayFormat == DataFormat.Hex)
					{
						previousValue = (model.ParameterModel as IValueModel).HexValue();
					}
					else if (base.DisplayFormat == DataFormat.Binary)
					{
						previousValue = (model.ParameterModel as IValueModel).BinaryValue();
					}
					else
					{
						previousValue = (model.ParameterModel as IValueModel).ScaledValue;
					}
				}
				catch (Exception ex2)
				{
					throw ex2;
				}
				try
				{
					dataRow["Unit"] = displayUnit;
					DataTableUnitColumnChars = dataRow["Unit"].ToString().Length;
				}
				catch (Exception ex3)
				{
					throw ex3;
				}
				try
				{
					dataRow["Comment"] = model.Comment;
					DataTableCommentColumnChars = dataRow["Comment"].ToString().Length;
				}
				catch (Exception ex4)
				{
					throw ex4;
				}
				dataTable.Rows.Add(dataRow);
			}
			catch (Exception ex5)
			{
				throw ex5;
			}
		}

		private void LoadPropertiesTable()
		{
			try
			{
				try
				{
					AddToPropertiesTable("Full Name", model.ParameterModel.FullName);
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Comment", model.ParameterModel.Comment);
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Address", model.ParameterModel.Address, "X8");
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Length", model.ParameterModel.Length.ToString());
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Data Type", (long)model.ParameterModel.DataType, "N0");
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Config Data Type", model.ParameterModel.ConfigFileType, "N0");
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Engineering Unit", model.ParameterModel.EngineeringUnits);
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Minimum Value", model.ParameterModel.LowerBound.ToString());
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Maximum Value", model.ParameterModel.UpperBound.ToString());
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Subfile Number", model.ParameterModel.SubfileNumber, "N0");
				}
				catch
				{
				}
				try
				{
					AddToPropertiesTable("Config Data Type", model.ParameterModel.ConfigFileType, "N0");
				}
				catch
				{
				}
				try
				{
					DataRow dataRow = propertiesTable.NewRow();
					dataRow["Property"] = "Available Offline";
					PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
					if (model.ParameterModel.AvailableOffline)
					{
						dataRow["Value"] = "Yes";
					}
					else
					{
						dataRow["Value"] = "No";
					}
					PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
					propertiesTable.Rows.Add(dataRow);
				}
				catch (Exception ex)
				{
					throw ex;
				}
			}
			catch (Exception ex2)
			{
				throw ex2;
			}
		}

		private void AddToPropertiesTable(string propertyName, string propertyValue)
		{
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = propertyName;
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = propertyValue;
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
		}

		private void AddToPropertiesTable(string propertyName, long propertyValue, string format)
		{
			try
			{
				DataRow dataRow = propertiesTable.NewRow();
				dataRow["Property"] = propertyName;
				PropertiesTablePropertyColumnChars = dataRow["Property"].ToString().Length;
				dataRow["Value"] = propertyValue.ToString(format);
				PropertiesTableValueColumnChars = dataRow["Value"].ToString().Length;
				propertiesTable.Rows.Add(dataRow);
			}
			catch (Exception)
			{
			}
		}

		private void OnColumnChanging(object sender, DataColumnChangeEventArgs e)
		{
			if (e.Column.ColumnName == "Value")
			{
				try
				{
					if (e.ProposedValue.ToString().Length == 0)
					{
						throw new Exception();
					}
					string text = "";
					text = ((base.DisplayFormat == DataFormat.Hex) ? (model.ParameterModel as IValueModel).HexValue() : ((base.DisplayFormat != DataFormat.Binary) ? (model.ParameterModel as IValueModel).ScaledValue : (model.ParameterModel as IValueModel).BinaryValue()));
					if (base.DisplayFormat == DataFormat.Hex)
					{
						(model.ParameterModel as IValueModel).HexValue(e.ProposedValue.ToString());
					}
					else if (base.DisplayFormat == DataFormat.Binary)
					{
						(model.ParameterModel as IValueModel).BinaryValue(e.ProposedValue.ToString());
					}
					else
					{
						(model.ParameterModel as IValueModel).ScaledValue = e.ProposedValue.ToString();
					}
					previousValue = text;
					RaiseCellChanged(this, e);
					return;
				}
				catch (Exception ex)
				{
					throw ex;
				}
			}
			_ = e.Column.ColumnName == "Unit";
		}
	}
	public class ValueDataView : ParameterView
	{
		private ValueController controller;

		private Panel panel;

		private CustomDataGrid dataGrid;

		private Container components;

		private ContextMenu csmMenu;

		private int rowClicked;

		public override Panel Panel => panel;

		public ValueDataView(ValueController valueController, Font font)
			: base(font)
		{
			//IL_0074: Unknown result type (might be due to invalid IL or missing references)
			//IL_007a: Expected O, but got Unknown
			//IL_0092: Unknown result type (might be due to invalid IL or missing references)
			//IL_009c: Expected O, but got Unknown
			//IL_00b9: Unknown result type (might be due to invalid IL or missing references)
			//IL_00c3: Expected O, but got Unknown
			//IL_00e1: Unknown result type (might be due to invalid IL or missing references)
			//IL_00eb: Expected O, but got Unknown
			//IL_0109: Unknown result type (might be due to invalid IL or missing references)
			//IL_0113: Expected O, but got Unknown
			//IL_0132: Unknown result type (might be due to invalid IL or missing references)
			//IL_013c: Expected O, but got Unknown
			//IL_0172: Unknown result type (might be due to invalid IL or missing references)
			//IL_017c: Expected O, but got Unknown
			controller = valueController;
			rowClicked = -1;
			InitializeComponent();
			((DataGrid)dataGrid).DataSource = controller.Data;
			((DataGrid)dataGrid).AllowSorting = false;
			((DataGrid)dataGrid).CaptionText = controller.Name;
			CurrencyManager val = (CurrencyManager)((Control)this).BindingContext[((DataGrid)dataGrid).DataSource, ((DataGrid)dataGrid).DataMember];
			((DataView)val.List).AllowNew = false;
			SetColumnStyles();
			csmMenu = new ContextMenu();
			((Menu)csmMenu).MenuItems.Add(0, new MenuItem("Copy", (EventHandler)Copy_Click));
			((Menu)csmMenu).MenuItems.Add(1, new MenuItem("Paste", (EventHandler)Paste_Click));
			((Menu)csmMenu).MenuItems.Add(2, new MenuItem("Undo", (EventHandler)Undo_Click));
			((Menu)csmMenu).MenuItems.Add(3, new MenuItem("Properties", (EventHandler)Properties_Click));
			((Control)dataGrid).ContextMenu = csmMenu;
			controller.CellChangedEvent += OnCellChanged;
			((Control)dataGrid).MouseDown += new MouseEventHandler(OnMouseDown);
			controller.AllCellsUnmodifiedEvent += OnAllCellsUnmodified;
			((DataView)val.List).ListChanged += OnListChanged;
		}

		protected override void Dispose(bool disposing)
		{
			if (disposing && components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);
		}

		public override void SetDisplayMode(DataFormat dataFormat)
		{
			base.DataViewFormat = dataFormat;
			SetColumnStyles();
		}

		protected override void OnListChanged(object sender, ListChangedEventArgs args)
		{
			((DataGrid)dataGrid).CurrentRowIndex = 0;
		}

		protected void Copy_Click(object sender, EventArgs e)
		{
			try
			{
				dataGrid.Copy();
			}
			catch
			{
			}
		}

		protected void Paste_Click(object sender, EventArgs e)
		{
			try
			{
				dataGrid.Paste();
			}
			catch
			{
			}
		}

		protected void Undo_Click(object sender, EventArgs e)
		{
			int currentRowIndex = 0;
			if (rowClicked != -1)
			{
				currentRowIndex = rowClicked;
			}
			controller.Undo();
			((DataGrid)dataGrid).CurrentRowIndex = currentRowIndex;
		}

		protected override void Properties_Click(object sender, EventArgs e)
		{
			base.Properties_Click(this, e);
		}

		private void SetColumnStyles()
		{
			//IL_001c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0022: Expected O, but got Unknown
			//IL_003f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0045: Expected O, but got Unknown
			//IL_0057: Unknown result type (might be due to invalid IL or missing references)
			//IL_005e: Expected O, but got Unknown
			//IL_013b: Unknown result type (might be due to invalid IL or missing references)
			//IL_0142: Expected O, but got Unknown
			//IL_01aa: Unknown result type (might be due to invalid IL or missing references)
			//IL_01b1: Expected O, but got Unknown
			((DataGrid)dataGrid).TableStyles.Clear();
			DataTable data = controller.Data;
			DataGridTableStyle val = new DataGridTableStyle();
			val.MappingName = data.TableName;
			CurrencyManager val2 = (CurrencyManager)((Control)dataGrid).BindingContext[(object)data];
			PropertyDescriptor propertyDescriptor = ((BindingManagerBase)val2).GetItemProperties()["Name"];
			DataGridTextBoxColumn val3 = new DataGridTextBoxColumn(propertyDescriptor);
			SetColumnStyle(val3, data.Columns["Name"].Caption, "Name", GetColumnWidth(controller.DataTableNameColumnChars), data.Columns["Name"].ReadOnly);
			val.GridColumnStyles.Add((DataGridColumnStyle)(object)val3);
			propertyDescriptor = ((BindingManagerBase)val2).GetItemProperties()["Value"];
			ColoredTextBoxColumn coloredTextBoxColumn = new ColoredTextBoxColumn((DataGrid)(object)dataGrid, propertyDescriptor);
			SetColumnStyle((DataGridTextBoxColumn)(object)coloredTextBoxColumn, data.Columns["Value"].Caption, "Value", GetColumnWidth(controller.DataTableValueColumnChars), data.Columns["Value"].ReadOnly);
			val.GridColumnStyles.Add((DataGridColumnStyle)(object)coloredTextBoxColumn);
			propertyDescriptor = ((BindingManagerBase)val2).GetItemProperties()["Unit"];
			DataGridTextBoxColumn val4 = new DataGridTextBoxColumn(propertyDescriptor);
			SetColumnStyle(val4, data.Columns["Unit"].Caption, "Unit", GetColumnWidth(controller.DataTableUnitColumnChars), data.Columns["Unit"].ReadOnly);
			val.GridColumnStyles.Add((DataGridColumnStyle)(object)val4);
			propertyDescriptor = ((BindingManagerBase)val2).GetItemProperties()["Comment"];
			DataGridTextBoxColumn val5 = new DataGridTextBoxColumn(propertyDescriptor);
			SetColumnStyle(val5, data.Columns["Comment"].Caption, "Comment", GetColumnWidth(controller.DataTableCommentColumnChars), data.Columns["Comment"].ReadOnly);
			val.GridColumnStyles.Add((DataGridColumnStyle)(object)val5);
			((DataGrid)dataGrid).TableStyles.Add(val);
		}

		private void OnCellChanged(object sender, DataColumnChangeEventArgs e)
		{
			//IL_0025: Unknown result type (might be due to invalid IL or missing references)
			((DataGrid)dataGrid).CurrentRowIndex = 0;
			DataGridCell currentCell = default(DataGridCell);
			((DataGridCell)(ref currentCell))..ctor(0, e.Column.Ordinal);
			((DataGrid)dataGrid).CurrentCell = currentCell;
			AddModifiedParameter(e.Row["Name"].ToString().Trim());
			ColoredTextBoxColumn coloredTextBoxColumn = (ColoredTextBoxColumn)(object)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles[e.Column.ColumnName];
			coloredTextBoxColumn.ShowCellModified(0);
		}

		private void OnMouseDown(object sender, MouseEventArgs e)
		{
			//IL_0008: Unknown result type (might be due to invalid IL or missing references)
			//IL_0012: Invalid comparison between Unknown and I4
			//IL_0035: Unknown result type (might be due to invalid IL or missing references)
			//IL_003b: Invalid comparison between Unknown and I4
			//IL_003e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0044: Invalid comparison between Unknown and I4
			rowClicked = -1;
			if ((int)e.Button == 2097152)
			{
				Point point = new Point(e.X, e.Y);
				HitTestInfo val = ((DataGrid)dataGrid).HitTest(point);
				if ((int)val.Type == 4 || (int)val.Type == 1)
				{
					rowClicked = val.Row;
				}
			}
		}

		private void OnAllCellsUnmodified(object sender, EventArgs e)
		{
			ColoredTextBoxColumn coloredTextBoxColumn = (ColoredTextBoxColumn)(object)((DataGrid)dataGrid).TableStyles["DataTable"].GridColumnStyles["Value"];
			coloredTextBoxColumn.ShowAllCellsUnmodified();
		}

		private void InitializeComponent()
		{
			//IL_0001: Unknown result type (might be due to invalid IL or missing references)
			//IL_000b: Expected O, but got Unknown
			panel = new Panel();
			dataGrid = new CustomDataGrid();
			((Control)panel).SuspendLayout();
			((ISupportInitialize)dataGrid).BeginInit();
			((Control)this).SuspendLayout();
			((Control)panel).Controls.AddRange((Control[])(object)new Control[1] { (Control)dataGrid });
			((Control)panel).Location = new Point(24, 16);
			((Control)panel).Name = "panel";
			((Control)panel).Size = new Size(500, 150);
			((Control)panel).TabIndex = 0;
			((DataGrid)dataGrid).DataMember = "";
			((Control)dataGrid).Dock = (DockStyle)5;
			((DataGrid)dataGrid).HeaderForeColor = SystemColors.ControlText;
			((Control)dataGrid).Name = "dataGrid";
			((Control)dataGrid).Size = new Size(500, 150);
			((Control)dataGrid).TabIndex = 0;
			((Control)this).Controls.AddRange((Control[])(object)new Control[1] { (Control)panel });
			((Control)this).Name = "ValueDataView";
			((Control)this).Size = new Size(536, 184);
			((Control)panel).ResumeLayout(false);
			((ISupportInitialize)dataGrid).EndInit();
			((Control)this).ResumeLayout(false);
		}

		protected override bool ProcessCmdKey(ref Message m, Keys keyData)
		{
			//IL_000f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0010: Unknown result type (might be due to invalid IL or missing references)
			//IL_0016: Unknown result type (might be due to invalid IL or missing references)
			//IL_001c: Invalid comparison between Unknown and I4
			//IL_01eb: Unknown result type (might be due to invalid IL or missing references)
			//IL_01f1: Unknown result type (might be due to invalid IL or missing references)
			//IL_01f7: Invalid comparison between Unknown and I4
			//IL_0021: Unknown result type (might be due to invalid IL or missing references)
			//IL_0024: Invalid comparison between Unknown and I4
			//IL_0212: Unknown result type (might be due to invalid IL or missing references)
			//IL_01f9: Unknown result type (might be due to invalid IL or missing references)
			//IL_01fc: Invalid comparison between Unknown and I4
			//IL_0075: Unknown result type (might be due to invalid IL or missing references)
			//IL_007a: Unknown result type (might be due to invalid IL or missing references)
			//IL_0026: Unknown result type (might be due to invalid IL or missing references)
			//IL_0029: Invalid comparison between Unknown and I4
			//IL_0131: Unknown result type (might be due to invalid IL or missing references)
			//IL_0134: Invalid comparison between Unknown and I4
			try
			{
				Keys val = (Keys)((Message)(ref m)).WParam.ToInt32();
				if ((keyData & 0x40000) == 262144 && ((int)val == 38 || (int)val == 40))
				{
					long num = 0L;
					BindingManagerBase val2 = ((Control)this).BindingContext[((DataGrid)dataGrid).DataSource, ((DataGrid)dataGrid).DataMember];
					DataRowView dataRowView = (DataRowView)val2.Current;
					DataColumnCollection columns = dataRowView.DataView.Table.Columns;
					DataGridCell currentCell = ((DataGrid)dataGrid).CurrentCell;
					string columnName = columns[((DataGridCell)(ref currentCell)).ColumnNumber].ColumnName;
					string text = dataRowView.Row[columnName].ToString();
					if (controller.DisplayFormat == DataFormat.Binary)
					{
						num = Convert.ToInt32(text, 2);
					}
					else if (controller.DisplayFormat == DataFormat.Hex)
					{
						num = long.Parse(text, NumberStyles.HexNumber);
					}
					else
					{
						if (text.IndexOf(".") != -1)
						{
							text = text.Remove(text.IndexOf("."), text.Length - text.IndexOf("."));
						}
						num = long.Parse(text);
						text = Convert.ToString(num, 16);
						num = long.Parse(text, NumberStyles.HexNumber);
					}
					num = (((int)val != 40) ? (num + 1) : (num - 1));
					if (controller.DisplayFormat == DataFormat.Binary)
					{
						string text2 = text;
						text = Convert.ToString(num, 2);
						if (text2.Length > text.Length)
						{
							text = text.PadLeft(text2.Length, '0');
						}
					}
					else if (controller.DisplayFormat == DataFormat.Hex)
					{
						string text3 = text;
						text = num.ToString("X");
						if (text3.Length > text.Length)
						{
							text = text.PadLeft(text3.Length, '0');
						}
					}
					else
					{
						text = $"{num}";
					}
					dataRowView.Row[columnName] = text;
					return true;
				}
				if ((keyData & 0x20000) == 131072 && (int)val == 73)
				{
					Properties_Click(this, null);
					return true;
				}
			}
			catch
			{
			}
			return ((ContainerControl)this).ProcessCmdKey(ref m, keyData);
		}
	}
}
namespace Cummins.Editor
{
	public class RemoveColumnMenuItem : MenuItem
	{
		private EventHandler _onClick;

		private ScreenController _controller;

		private MonitoredGroup _column;

		public RemoveColumnMenuItem(string text, EventHandler onClick, ScreenController controller, MonitoredGroup column)
			: base(text)
		{
			_onClick = onClick;
			_controller = controller;
			_column = column;
		}

		protected override void OnClick(EventArgs e)
		{
			if (_controller.Model.MonitorColumns.Count > 2)
			{
				for (int i = 0; i < _controller.Model.MonitorColumns.Count; i++)
				{
					if (_controller.Model.MonitorColumns[i] == _column)
					{
						_controller.RemoveColumn(i);
						_controller.IsDirty = true;
						break;
					}
				}
			}
			if (_onClick != null)
			{
				_onClick(this, e);
			}
		}
	}
	internal class ReqRecvMonitor : Monitor
	{
		private const int SlowestDataRefreshRate = 10000;

		private const int FastestDataRefreshRate = 5;

		private const int DefaultDataRefreshRate = 20;

		public ReqRecvMonitor(IModuleNetwork network)
			: base(network)
		{
		}

		public override void SetRefreshRate(int rate, RefreshUnitsType units)
		{
			int num = Convert(rate, RefreshUnitsType.Milliseconds, units);
			if (num <= 10000 && num >= 5)
			{
				dataRefreshRate = rate;
			}
			else
			{
				if (num >= 10000)
				{
					num = 10000;
				}
				else if (num <= 5)
				{
					num = 5;
				}
				dataRefreshRate = Convert(num, units, RefreshUnitsType.Milliseconds);
			}
			dataRefreshUnit = units;
			lock (base.NameSubscriptions)
			{
				foreach (ISubscription value in base.NameSubscriptions.Values)
				{
					if (value != null)
					{
						value.BaseRate = num;
					}
				}
			}
			lock (base.AddressSubscriptions)
			{
				foreach (ISubscription value2 in base.AddressSubscriptions.Values)
				{
					if (value2 != null)
					{
						value2.BaseRate = num;
					}
				}
			}
		}

		protected override bool ValidateParameter(ParameterEventArgs e)
		{
			return base.ValidateParameter(e);
		}

		protected override bool ValidateSubscription(ISubscription subscription)
		{
			return true;
		}

		protected override ISubscription GetSubscription(bool IsAddress, bool shouldStop, IAddressValue sourceAddress, DataAccessType dataAccessType)
		{
			ISubscription subscription = null;
			if (dataAccessType == DataAccessType.Proprietary)
			{
				if (IsAddress)
				{
					return GetAddressSubscription(sourceAddress);
				}
				return GetNameSubscription(sourceAddress);
			}
			return GetPublicDataSubscription(sourceAddress, dataAccessType);
		}

		protected override ISubscription CreateSubscription(IAddressValue sourceAddress)
		{
			ISubscription subscription = null;
			ICalibration calibration = (ICalibration)base.DataSources[sourceAddress];
			if (calibration != null)
			{
				subscription = SubscriptionProvider.Create(calibration, DataAcquisitionType.RequestReceive, NotifyType.Message);
				RegisterEvents(subscription);
				subscription.BaseRate = Convert(base.DataRefreshRate, RefreshUnitsType.Milliseconds, base.DataRefreshUnit);
				return subscription;
			}
			throw new UnableToFindCalibrationException(Facility.Editor, 1, "Could Not get the calibration", sourceAddress.ToString());
		}

		private void RegisterEvents(ISubscription subscription)
		{
			if (subscription is IECMSubscription)
			{
				IECMSubscription iECMSubscription = subscription as IECMSubscription;
				iECMSubscription.MonitorTimeoutEnabled = base.ConnectionTimeoutEnabled;
				iECMSubscription.MonitorTimeoutFloor = base.ConnectionTimeoutMinimum;
				iECMSubscription.MonitorTimeoutFactor = base.ConnectionTimeoutFactor;
				iECMSubscription.ConnectionLost += base.OnConnectionLost;
				iECMSubscription.PerformanceStatistics += base.OnPerformanceUpdate;
				iECMSubscription.RunLocationChange += OnRunLocationChange;
				iECMSubscription.StopBroadCast += base.OnStopBroadCast;
			}
			subscription.Notification += base.OnDataRefresh;
			subscription.LastParameterRemoved += base.OnLastParameterRemoved;
		}
	}
	public enum RefreshUnitsType
	{
		Milliseconds,
		Hertz
	}
	public enum ScreenStatus
	{
		Active,
		Inactive
	}
	public delegate void MonitorModeEventHandler(object sender, MonitorModeEventArgs e);
	public class Screen : IDisposable
	{
		private ScreenView view;

		private ScreenController controller;

		private ScreenModel model;

		private bool disposed;

		internal IAddressValue CurrentSourceAddress
		{
			get
			{
				return Model.CurrentSourceAddress;
			}
			set
			{
				Model.CurrentSourceAddress = value;
			}
		}

		public IModuleNetwork Network
		{
			set
			{
				Controller.Network = value;
			}
		}

		public ScreenStatus Status
		{
			get
			{
				return Model.Status;
			}
			set
			{
				Model.Status = value;
			}
		}

		public DataAcquisitionType MonitorMode
		{
			get
			{
				return Controller.MonitorMode;
			}
			set
			{
				Controller.MonitorMode = value;
			}
		}

		public bool ShowComments
		{
			get
			{
				return Controller.ShowComments;
			}
			set
			{
				Controller.ShowComments = value;
			}
		}

		public TriggerType BAMTriggerMode
		{
			get
			{
				return Controller.BAMTriggerMode;
			}
			set
			{
				Controller.BAMTriggerMode = value;
			}
		}

		public bool ConnectionTimeoutEnabled
		{
			get
			{
				return Controller.ConnectionTimeoutEnabled;
			}
			set
			{
				Controller.ConnectionTimeoutEnabled = value;
			}
		}

		public int ConnectionTimeoutMinimum
		{
			get
			{
				return Controller.ConnectionTimeoutMinimum;
			}
			set
			{
				Controller.ConnectionTimeoutMinimum = value;
			}
		}

		public int ConnectionTimeoutFactor
		{
			get
			{
				return Controller.ConnectionTimeoutFactor;
			}
			set
			{
				Controller.ConnectionTimeoutFactor = value;
			}
		}

		public int BAMRefreshRate => Controller.BAMRefreshRate;

		public int EDMRefreshRate => Controller.EDMRefreshRate;

		public int MonitorDataRefreshRate => Controller.MonitorDataRefreshRate;

		public int UIRefreshRate => Controller.UIRefreshRate;

		public RefreshUnitsType DataRefreshUnits => Controller.DataRefreshUnits;

		public RefreshUnitsType UIRefreshUnits => Controller.UIRefreshUnits;

		public DataFormat Radix
		{
			get
			{
				return Controller.Radix;
			}
			set
			{
				Controller.Radix = value;
			}
		}

		public bool Restored
		{
			get
			{
				return Controller.Restored;
			}
			set
			{
				Controller.Restored = value;
			}
		}

		public string ScreenFilename
		{
			get
			{
				return Model.ScreenFilename;
			}
			set
			{
				Model.ScreenFilename = value;
			}
		}

		public string Name
		{
			get
			{
				return Model.Name;
			}
			set
			{
				Model.Name = value;
			}
		}

		public string Title => View.CurrentScreenName;

		public string ComplexParameterName
		{
			get
			{
				string result = string.Empty;
				if (controller is ComplexScreenController)
				{
					result = (controller as ComplexScreenController).ComplexParameterName;
				}
				return result;
			}
		}

		public ScreenView View => view;

		public string DatasourceName
		{
			get
			{
				return Model.DataSourceName;
			}
			set
			{
				Model.DataSourceName = value;
			}
		}

		public ScreenController Controller => controller;

		public ScreenModel Model => model;

		public bool IsDirty
		{
			get
			{
				return Controller.IsDirty;
			}
			set
			{
				Controller.IsDirty = value;
			}
		}

		public bool IsMonitoring => Controller.IsMonitoring;

		public ArrayList IDLParametersList => Controller.IDLParametersList;

		public List<string> ModifiedParameters => Model.ModifiedParameters;

		public MonitorScreenType ScreenType => Controller.ScreenType;

		public event MonitorModeEventHandler MonitorModeChanged;

		public event EventHandler MonitoringStarted;

		public event EventHandler MonitoringStopped;

		public event ScreenNameChangingEventHandler ScreenNameChangingEvent
		{
			add
			{
				View.ScreenNameChangingEvent += value;
			}
			remove
			{
				View.ScreenNameChangingEvent -= value;
			}
		}

		public event ScreenNameChangedEventHandler ScreenNameChangedEvent
		{
			add
			{
				Model.ScreenNameChangedEvent += value;
			}
			remove
			{
				Model.ScreenNameChangedEvent += value;
			}
		}

		public event ParameterEventHandler ParameterAddedToScreen;

		public event ParameterListEventHandler ParametersAddedToScreen;

		public event ParameterEventHandler ParameterRemovedFromScreen;

		internal event ScreenMonitorStatusChangedEventHandler ScreenMonitorStatusChangedEvent
		{
			add
			{
				Model.ScreenMonitorStatusChangedEvent += value;
			}
			remove
			{
				Model.ScreenMonitorStatusChangedEvent -= value;
			}
		}

		public event MonitoredElementAddingEventHandler MonitoredElementAddingEvent
		{
			add
			{
				view.MonitoredElementAddingEvent += value;
			}
			remove
			{
				view.MonitoredElementAddingEvent -= value;
			}
		}

		public Screen(MonitorScreenType typeOfScreen, SortedList dataSources, IAddressValue currentSourceAddress, string dataSourceName)
		{
			model = new ScreenModel(typeOfScreen, dataSources, currentSourceAddress, dataSourceName);
			GetScreenController(typeOfScreen);
			view = new ScreenView(controller);
			model.ChangeMonitorModeEventHandler += OnMonitorModeChanged;
			model.MonitorStartedEventHandler += OnMonitoringStarted;
			model.MonitorStoppedEventHandler += OnMonitoringStopped;
			Controller.ParameterAdded += OnParameterAdded;
			Controller.ParameterListAdded += OnParameterListAdded;
			Controller.ParameterRemoved += OnParameterRemoved;
			disposed = false;
		}

		private void OnParameterRemoved(object sender, ParameterEventArgs e)
		{
			if (this.ParameterRemovedFromScreen != null)
			{
				this.ParameterRemovedFromScreen(this, e);
			}
		}

		private void OnParameterListAdded(object sender, ParameterListEventArgs e)
		{
			if (this.ParametersAddedToScreen != null)
			{
				this.ParametersAddedToScreen(this, e);
			}
		}

		private void OnParameterAdded(object sender, ParameterEventArgs e)
		{
			if (this.ParameterAddedToScreen != null)
			{
				this.ParameterAddedToScreen(this, e);
			}
		}

		private void GetScreenController(MonitorScreenType typeOfScreen)
		{
			switch (typeOfScreen)
			{
			case MonitorScreenType.Graphical:
				controller = new GraphicalScreenController(model);
				break;
			case MonitorScreenType.Complex:
				controller = new ComplexScreenController(model);
				break;
			default:
				controller = new ScreenController(model);
				break;
			}
		}

		public void Initialize(NewDataSet.ScreenRow screenRow)
		{
			controller.Initialize(screenRow);
		}

		public void Restore(NewDataSet.ScreenRow screenRow)
		{
			controller.Restore(screenRow);
		}

		public void Save(NewDataSet.ScreenRow screenRow)
		{
			controller.Save(screenRow);
		}

		public void Cleanse(NewDataSet.ScreenRow screenRow)
		{
			Controller.Cleanse(screenRow);
		}

		public void AddMonitoredElement(IParameterModel parameterModel)
		{
			(Controller as ComplexScreenController).AddMonitoredElement(parameterModel);
		}

		public void AddColumn()
		{
			Controller.AddColumn();
		}

		public void PauseMonitoring()
		{
			Controller.PauseMonitoring();
		}

		public void PauseMonitoring(IAddressValue deviceAddress)
		{
			Controller.PauseMonitoring(deviceAddress);
		}

		public void ResumeMonitoring()
		{
			Controller.ResumeMonitoring();
		}

		public void ResumeMonitoring(IAddressValue deviceAddress)
		{
			Controller.ResumeMonitoring(deviceAddress);
		}

		public void StartMonitoring()
		{
			Controller.StartMonitoring();
		}

		public void LoadScreen()
		{
			Controller.LoadScreen();
		}

		public void StartScreen()
		{
			Controller.StartScreen();
		}

		public void StartMonitoring(IAddressValue deviceAddress)
		{
			Controller.StartMonitoring(deviceAddress);
		}

		public void StopMonitoring()
		{
			Controller.StopMonitoring();
		}

		public void StopMonitoring(IAddressValue deviceAddress)
		{
			Controller.StopMonitoring(deviceAddress);
		}

		private void OnMonitorModeChanged(object sender, EventArgs e)
		{
			RaiseMonitorModeChangedEvent(MonitorMode);
		}

		private void OnMonitoringStarted(object sender, EventArgs e)
		{
			RaiseMonitoringStartedEvent();
		}

		private void OnMonitoringStopped(object sender, EventArgs e)
		{
			RaiseMonitoringStoppedEvent();
		}

		private void RaiseMonitorModeChangedEvent(DataAcquisitionType mode)
		{
			if (this.MonitorModeChanged != null)
			{
				this.MonitorModeChanged(this, new MonitorModeEventArgs(mode));
			}
		}

		private void RaiseMonitoringStartedEvent()
		{
			if (this.MonitoringStarted != null)
			{
				this.MonitoringStarted(this, EventArgs.Empty);
			}
		}

		private void RaiseMonitoringStoppedEvent()
		{
			if (this.MonitoringStopped != null)
			{
				this.MonitoringStopped(this, EventArgs.Empty);
			}
		}

		public void SetBAMRefreshRate(int rate, RefreshUnitsType units)
		{
			Controller.SetBAMRefreshRate(rate, units);
		}

		public void SetEDMRefreshRate(int rate, RefreshUnitsType units)
		{
			Controller.SetEDMRefreshRate(rate, units);
		}

		public void SetRequestReceiveRefreshRate(int rate, RefreshUnitsType units)
		{
			Controller.SetMonitorDataRefreshRate(rate, units);
		}

		public void SetUIRefreshRate(int rate, RefreshUnitsType units)
		{
			Controller.SetUIRefreshRate(rate, units);
		}

		public void SetCommonOptions()
		{
			Controller.SetCommonOptions();
		}

		public void SetGridFocus()
		{
			foreach (IMonitorElement monitorColumn in model.MonitorColumns)
			{
				if (monitorColumn is MonitoredGroup)
				{
					(monitorColumn as MonitoredGroup).SetGridFocus();
				}
			}
		}

		public void AddParameters(StringCollection parameters, bool isAppend, bool isBroadcast, IAddressValue sourceAddress)
		{
			Controller.AddParameters(parameters, isAppend, isBroadcast, sourceAddress);
		}

		public ListDictionary GetParameterList()
		{
			return Model.GetParameterList();
		}

		public ICollection GetDataProvider()
		{
			return Controller.GetDataProvider();
		}

		public void Dispose()
		{
			Dispose(disposing: true);
			GC.SuppressFinalize(this);
		}

		protected virtual void Dispose(bool disposing)
		{
			if (!disposed && disposing)
			{
				CleaupResources();
			}
			disposed = true;
		}

		public void CleaupResources()
		{
			((Component)(object)View).Dispose();
			Controller.CleanupResources();
		}
	}
	public delegate void ScreenLoadingFailedEventHandler(object sender, ScreenLoadingFailedEventArgs args);
	public class ScreenDataSaver
	{
		public NewDataSet.GroupRow SaveSession(NewDataSet.ScreenRow screenRow)
		{
			NewDataSet.GroupRow groupRow = ((NewDataSet)screenRow.Table.DataSet).Group.NewGroupRow();
			groupRow.ScreenRow = screenRow;
			return groupRow;
		}

		public void PopulateParameterTableRows(NewDataSet.GroupRow groupRow, DataTable dataTable)
		{
			NewDataSet.ParameterDataTable parameter = ((NewDataSet)groupRow.Table.DataSet).Parameter;
			DataRow[] array = dataTable.Select("Name <> ''");
			DataRow[] array2 = array;
			foreach (DataRow dataRow in array2)
			{
				try
				{
					NewDataSet.ParameterRow parameterRow = parameter.NewParameterRow();
					if (dataRow["Name"] != DBNull.Value)
					{
						parameterRow.SourceAddress = dataRow["SourceAddress"].ToString();
						parameterRow.Name = (string)dataRow["Name"];
						parameterRow.Units = (string)dataRow["Unit"];
						try
						{
							parameterRow.IsBroadcast = (bool)dataRow["IsBroadcast"];
						}
						catch
						{
							parameterRow.IsBroadcast = false;
						}
					}
					else
					{
						parameterRow.Name = "";
						parameterRow.Units = "";
					}
					parameterRow.GroupRow = groupRow;
					parameter.AddParameterRow(parameterRow);
				}
				catch (Exception)
				{
				}
			}
		}
	}
	public delegate void ScreenNameChangedEventHandler(object sender, ScreenNameChangedEventArgs args);
	public delegate void ScreenMonitorStatusChangedEventHandler(object sender, ScreenMonitorStatusChangedEventArgs e);
	public class ScreenModel
	{
		private const int SlowestScreenRefreshRate = 5000;

		private const int FastestScreenRefreshRate = 20;

		private const int DefaultScreenRefreshRate = 200;

		private const string Separator = " : ";

		private string dataSourceName = string.Empty;

		private string name;

		private ArrayList monitorColumns;

		private DataAcquisitionType monitorMode;

		private TriggerType bamTriggerMode;

		private ScreenStatus screenStatus;

		private bool connectionTimeoutEnabled;

		private int connectionTimeoutMinimum;

		private int connectionTimeoutFactor;

		private int refreshRateBAM;

		private int refreshRateEDM;

		private double actualMonitorRate;

		private int refreshRateRequestReceive;

		private int uiRefreshRate;

		private RefreshUnitsType dataRefreshUnits;

		private RefreshUnitsType uiRefreshUnits;

		private IModuleNetwork network;

		private bool showComments;

		private string screenFilename;

		private string longScreenName = string.Empty;

		private DataFormat radix;

		private bool restored;

		private bool dirty;

		private MonitorScreenType screenType;

		private SortedList datasources;

		private IAddressValue currentSourceAddress;

		public DataAcquisitionType MonitorMode
		{
			get
			{
				return monitorMode;
			}
			set
			{
				if (monitorMode != value)
				{
					if (value == DataAcquisitionType.BAM && Cummins.IDLLogger.IDLLogger.IDLLoggerInstance.IDLState != IDLState.Idle)
					{
						EventLogger.Error("Data Monitor", "Failed to change the Monitor mode to BAM as IDL is in running state");
						throw new Exception("IDL is in" + Cummins.IDLLogger.IDLLogger.IDLLoggerInstance.IDLState.ToString() + "state");
					}
					monitorMode = value;
					RaiseChangeMonitorModeEvent(monitorMode);
					EventLogger.Log("DataMonitor", "Monitor mode set to " + value);
					IsDirty = true;
				}
			}
		}

		internal ScreenStatus Status
		{
			get
			{
				return screenStatus;
			}
			set
			{
				if (value != screenStatus)
				{
					screenStatus = value;
					RaiseScreenMonitorStatusChangedEvent();
				}
			}
		}

		public bool ShowComments
		{
			get
			{
				return showComments;
			}
			set
			{
				showComments = value;
				foreach (MonitoredGroup monitorColumn in MonitorColumns)
				{
					monitorColumn.ShowComments = showComments;
				}
			}
		}

		public TriggerType BAMTriggerMode
		{
			get
			{
				return bamTriggerMode;
			}
			set
			{
				if (bamTriggerMode == value || Network == null)
				{
					return;
				}
				TriggerType triggerType = ((GTISVersion.GTIS45 == Network.GTISLevel) ? TriggerType.Clock : TriggerType.ForeGroundActivated);
				if (Enum.IsDefined(typeof(TriggerType), value.ToString()))
				{
					if (GTISVersion.GTIS45 == Network.GTISLevel)
					{
						try
						{
							triggerType = (TriggerType)(BAM45TriggerType)Enum.Parse(typeof(BAM45TriggerType), value.ToString(), ignoreCase: true);
						}
						catch
						{
							triggerType = TriggerType.Clock;
						}
					}
					else
					{
						try
						{
							triggerType = (TriggerType)(BAMPre45TriggerType)Enum.Parse(typeof(BAMPre45TriggerType), value.ToString(), ignoreCase: true);
						}
						catch
						{
							triggerType = TriggerType.ForeGroundActivated;
						}
					}
				}
				bamTriggerMode = triggerType;
				EventLogger.Log("Editor", "BAM trigger mode set to " + triggerType);
				IsDirty = true;
				RaiseChangeBAMTriggerTypeEventHandler();
			}
		}

		public bool ConnectionTimeoutEnabled
		{
			get
			{
				return connectionTimeoutEnabled;
			}
			set
			{
				if (connectionTimeoutEnabled != value)
				{
					connectionTimeoutEnabled = value;
					IsDirty = true;
				}
			}
		}

		public int ConnectionTimeoutMinimum
		{
			get
			{
				return connectionTimeoutMinimum;
			}
			set
			{
				if (connectionTimeoutMinimum != value)
				{
					connectionTimeoutMinimum = value;
					IsDirty = true;
				}
			}
		}

		public int ConnectionTimeoutFactor
		{
			get
			{
				return connectionTimeoutFactor;
			}
			set
			{
				if (connectionTimeoutFactor != value)
				{
					connectionTimeoutFactor = value;
					IsDirty = true;
				}
			}
		}

		public int BAMRefreshRate
		{
			get
			{
				return refreshRateBAM;
			}
			set
			{
				if (refreshRateBAM != value)
				{
					refreshRateBAM = value;
					EventLogger.Log("Editor", "BAM refresh rate set to " + value + " " + DataRefreshUnits);
					IsDirty = true;
				}
			}
		}

		public int EDMRefreshRate
		{
			get
			{
				return refreshRateEDM;
			}
			set
			{
				if (refreshRateEDM != value)
				{
					IsDirty = true;
					refreshRateEDM = value;
				}
				RaiseChangeDataMonitorRateEvent(refreshRateEDM);
			}
		}

		public double ActualMonitorRate
		{
			get
			{
				return actualMonitorRate;
			}
			set
			{
				actualMonitorRate = value;
				RaiseChangeActualMonitorRateEvent(actualMonitorRate);
			}
		}

		public int RequestReceiveRefreshRate
		{
			get
			{
				return refreshRateRequestReceive;
			}
			set
			{
				refreshRateRequestReceive = value;
				EventLogger.Log("Editor", "Request/receive refresh rate set to " + value + " " + DataRefreshUnits);
				RaiseChangeDataMonitorRateEvent(refreshRateRequestReceive);
				IsDirty = true;
			}
		}

		public int UIRefreshRate
		{
			get
			{
				return uiRefreshRate;
			}
			set
			{
				if (value != uiRefreshRate)
				{
					if (value == 0)
					{
						uiRefreshRate = 0;
					}
					else if (value <= 5000 && value >= 20)
					{
						uiRefreshRate = value;
					}
					else
					{
						uiRefreshRate = 200;
					}
					IsDirty = true;
					RaiseUIRefreshRateChangedEvent();
				}
			}
		}

		public RefreshUnitsType DataRefreshUnits
		{
			get
			{
				return dataRefreshUnits;
			}
			set
			{
				if (dataRefreshUnits != value)
				{
					dataRefreshUnits = value;
					EventLogger.Log("Editor", "Data refresh rate set to " + value);
					if (MonitorMode == DataAcquisitionType.EDM)
					{
						RaiseChangeDataMonitorRateEvent(EDMRefreshRate);
					}
					else
					{
						RaiseChangeDataMonitorRateEvent(RequestReceiveRefreshRate);
					}
					IsDirty = true;
				}
			}
		}

		public RefreshUnitsType UIRefreshUnits
		{
			get
			{
				return uiRefreshUnits;
			}
			set
			{
				if (uiRefreshUnits != value)
				{
					uiRefreshUnits = value;
					IsDirty = true;
				}
			}
		}

		public IModuleNetwork Network
		{
			get
			{
				return network;
			}
			set
			{
				if (value != network && value != null)
				{
					network = value;
				}
			}
		}

		public DataFormat Radix
		{
			get
			{
				return radix;
			}
			set
			{
				if (radix == value)
				{
					return;
				}
				radix = value;
				foreach (IMonitorElement monitorColumn in MonitorColumns)
				{
					monitorColumn.Radix = value;
				}
				IsDirty = true;
			}
		}

		public bool Restored
		{
			get
			{
				return restored;
			}
			set
			{
				restored = value;
			}
		}

		public string DataSourceName
		{
			get
			{
				return dataSourceName;
			}
			set
			{
				if (dataSourceName != value)
				{
					dataSourceName = value;
					longScreenName = string.Empty;
				}
			}
		}

		public string Name
		{
			get
			{
				return name;
			}
			set
			{
				if (name != value)
				{
					string previousScreenName = name;
					name = value;
					string previousTitle = LongScreenName;
					longScreenName = string.Empty;
					RaiseScreenNameChangedEvent(value, previousScreenName, LongScreenName, previousTitle);
					IsDirty = true;
				}
			}
		}

		public string LongScreenName
		{
			get
			{
				if (longScreenName == string.Empty)
				{
					longScreenName = GenerateScreenTitle();
				}
				return longScreenName;
			}
		}

		public string ScreenFilename
		{
			get
			{
				return screenFilename;
			}
			set
			{
				if (screenFilename != value)
				{
					screenFilename = value;
					RaiseScreenFilenameChangedEvent();
				}
			}
		}

		public List<string> ModifiedParameters
		{
			get
			{
				List<string> list = new List<string>();
				foreach (Cummins.Parameter.Parameter monitorColumn in MonitorColumns)
				{
					for (int i = 0; i < monitorColumn.DataView.ModifiedParameters.Count; i++)
					{
						if (!list.Contains(monitorColumn.DataView.ModifiedParameters[i]))
						{
							list.Add(monitorColumn.DataView.ModifiedParameters[i]);
						}
					}
				}
				return list;
			}
		}

		public IList MonitorColumns
		{
			get
			{
				if (monitorColumns == null)
				{
					monitorColumns = new ArrayList();
				}
				return monitorColumns;
			}
		}

		public SortedList DataSources
		{
			get
			{
				if (datasources == null)
				{
					datasources = new SortedList();
				}
				return datasources;
			}
		}

		internal IAddressValue CurrentSourceAddress
		{
			get
			{
				return currentSourceAddress;
			}
			set
			{
				if (ScreenType == MonitorScreenType.Complex)
				{
					return;
				}
				currentSourceAddress = value;
				foreach (IMonitorElement monitorColumn in MonitorColumns)
				{
					monitorColumn.CurrentSourceAddress = value;
				}
			}
		}

		public bool IsDirty
		{
			get
			{
				return dirty;
			}
			set
			{
				dirty = value;
			}
		}

		public MonitorScreenType ScreenType
		{
			get
			{
				return screenType;
			}
			set
			{
				screenType = value;
			}
		}

		internal event ScreenNameChangedEventHandler ScreenNameChangedEvent;

		internal event ScreenMonitorStatusChangedEventHandler ScreenMonitorStatusChangedEvent;

		public event EventHandler ChangeMonitorModeEventHandler;

		public event EventHandler ChangeBAMTriggerTypeEventHandler;

		public event EventHandler MonitorStartedEventHandler;

		public event EventHandler MonitorStoppedEventHandler;

		public event EventHandler ChangeDataMonitorRateEventHandler;

		public event EventHandler ChangeActualMonitorRateEventHandler;

		public event EventHandler AddColumnEventHandler;

		public event EventHandler RemoveColumnEventHandler;

		public event EventHandler ScreenFilenameChangedEventHandler;

		public event EventHandler UIRefreshRateChangedEvent;

		public ScreenModel(MonitorScreenType screenType, SortedList dataSources, IAddressValue currentSourceAddress, string dataSourceName)
		{
			name = "Screen #";
			datasources = dataSources;
			this.currentSourceAddress = currentSourceAddress;
			this.dataSourceName = dataSourceName;
			Restored = true;
			dirty = false;
			ScreenType = screenType;
			IAppConfigService appConfigService = ServiceManager.Services.GetService(typeof(IAppConfigService)) as IAppConfigService;
			try
			{
				if (ScreenType == MonitorScreenType.Complex)
				{
					Status = ScreenStatus.Inactive;
					UIRefreshRate = int.Parse(appConfigService.GetAppSetting(ApplicationSettings.ComplexScreenRequestReceiveRefreshRate));
				}
				else
				{
					UIRefreshRate = int.Parse(appConfigService.GetAppSetting(ApplicationSettings.ScreenRefreshRate));
				}
			}
			catch
			{
				if (ScreenType == MonitorScreenType.Graphical)
				{
					UIRefreshRate = 250;
				}
				else
				{
					UIRefreshRate = 200;
				}
			}
		}

		public void Restore(NewDataSet.ScreenRow screenRow)
		{
			try
			{
				dirty = false;
				Name = screenRow.Name;
				RequestReceiveRefreshRate = screenRow.DataRefreshRate;
				try
				{
					Status = (ScreenStatus)Enum.Parse(typeof(ScreenStatus), screenRow.Status.ToString(), ignoreCase: true);
				}
				catch
				{
					screenStatus = ScreenStatus.Inactive;
				}
				UIRefreshRate = screenRow.UIRefreshRate;
				try
				{
					BAMRefreshRate = screenRow.BAMRefreshRate;
					EDMRefreshRate = screenRow.EDMRefreshRate;
				}
				catch
				{
					BAMRefreshRate = RequestReceiveRefreshRate;
					EDMRefreshRate = EDMRefreshRate;
				}
				try
				{
					DataRefreshUnits = TranslateRefreshUnits(screenRow.DataRefreshUnits);
					UIRefreshUnits = TranslateRefreshUnits(screenRow.UIRefreshUnits);
				}
				catch
				{
				}
				try
				{
					BAMTriggerMode = TranslateTriggerMode(screenRow.BAMTrigger);
				}
				catch
				{
				}
				if (currentSourceAddress.Type == AddressType.ECM)
				{
					switch (screenRow.MonitorType)
					{
					case "BAM":
						MonitorMode = DataAcquisitionType.BAM;
						break;
					case "EDM":
						MonitorMode = DataAcquisitionType.EDM;
						break;
					default:
						MonitorMode = DataAcquisitionType.RequestReceive;
						break;
					}
				}
				else if (screenRow.MonitorType != DataAcquisitionType.RequestReceive.ToString())
				{
					MonitorMode = DataAcquisitionType.RequestReceive;
					string message = string.Format(Editor.ResourceManager.GetString(EditorMessageIDs.MonitorModeNotSupported.ToString()), screenRow.MonitorType);
					EventLogger.Info("Editor", message);
					dirty = true;
				}
				switch (screenRow.Radix.ToUpper().Trim())
				{
				case "DECIMAL":
					Radix = DataFormat.Decimal;
					break;
				case "HEX":
					Radix = DataFormat.Hex;
					break;
				case "BINARY":
					Radix = DataFormat.Binary;
					break;
				default:
					Radix = DataFormat.Decimal;
					break;
				}
			}
			catch (Exception)
			{
			}
		}

		protected void RaiseUIRefreshRateChangedEvent()
		{
			if (this.UIRefreshRateChangedEvent != null)
			{
				this.UIRefreshRateChangedEvent(this, EventArgs.Empty);
			}
		}

		private RefreshUnitsType TranslateRefreshUnits(string units)
		{
			RefreshUnitsType refreshUnitsType = RefreshUnitsType.Milliseconds;
			switch (units.ToUpper())
			{
			case "HZ":
			case "HERTZ":
				return RefreshUnitsType.Hertz;
			default:
				return RefreshUnitsType.Milliseconds;
			}
		}

		private TriggerType TranslateTriggerMode(string trigger)
		{
			return (TriggerType)Enum.Parse(typeof(TriggerType), trigger);
		}

		public void Save(NewDataSet.ScreenRow screenRow)
		{
			try
			{
				screenRow.Name = Name;
				screenRow.ScreenType = ScreenType.ToString();
				screenRow.DataRefreshRate = (ushort)RequestReceiveRefreshRate;
				screenRow.UIRefreshRate = (ushort)UIRefreshRate;
				screenRow.BAMRefreshRate = (ushort)BAMRefreshRate;
				screenRow.EDMRefreshRate = (ushort)EDMRefreshRate;
				screenRow.DataRefreshUnits = DataRefreshUnits.ToString();
				screenRow.UIRefreshUnits = UIRefreshUnits.ToString();
				screenRow.BAMTrigger = BAMTriggerMode.ToString();
				screenRow.Status = screenStatus.ToString();
				switch (MonitorMode)
				{
				case DataAcquisitionType.BAM:
					screenRow.MonitorType = "BAM";
					break;
				case DataAcquisitionType.EDM:
					screenRow.MonitorType = "EDM";
					break;
				default:
					screenRow.MonitorType = "RequestReceive";
					break;
				}
				switch (Radix)
				{
				case DataFormat.Decimal:
					screenRow.Radix = "Decimal";
					break;
				case DataFormat.Hex:
					screenRow.Radix = "Hex";
					break;
				case DataFormat.Binary:
					screenRow.Radix = "Binary";
					break;
				default:
					screenRow.Radix = "Decimal";
					break;
				}
			}
			catch (Exception)
			{
			}
		}

		private void RaiseScreenMonitorStatusChangedEvent()
		{
			if (this.ScreenMonitorStatusChangedEvent != null)
			{
				ScreenMonitorStatusChangedEventArgs e = new ScreenMonitorStatusChangedEventArgs(Name, Status);
				this.ScreenMonitorStatusChangedEvent(this, e);
			}
		}

		public void RaiseChangeMonitorModeEvent(DataAcquisitionType mode)
		{
			if (this.ChangeMonitorModeEventHandler != null)
			{
				this.ChangeMonitorModeEventHandler(this, EventArgs.Empty);
			}
		}

		public void RaiseChangeBAMTriggerTypeEventHandler()
		{
			if (this.ChangeBAMTriggerTypeEventHandler != null)
			{
				this.ChangeBAMTriggerTypeEventHandler(this, EventArgs.Empty);
			}
		}

		public void RaiseMonitorStartedEvent()
		{
			if (this.MonitorStartedEventHandler != null)
			{
				this.MonitorStartedEventHandler(this, EventArgs.Empty);
			}
		}

		public void RaiseMonitorStoppedEvent()
		{
			if (this.MonitorStoppedEventHandler != null)
			{
				this.MonitorStoppedEventHandler(this, EventArgs.Empty);
			}
		}

		public void RaiseChangeActualMonitorRateEvent(double rate)
		{
			if (this.ChangeActualMonitorRateEventHandler != null)
			{
				this.ChangeActualMonitorRateEventHandler(this, EventArgs.Empty);
			}
		}

		public void RaiseChangeDataMonitorRateEvent(int rate)
		{
			if (this.ChangeDataMonitorRateEventHandler != null)
			{
				this.ChangeDataMonitorRateEventHandler(this, EventArgs.Empty);
			}
		}

		public void RaiseAddColumnEvent()
		{
			if (this.AddColumnEventHandler != null)
			{
				this.AddColumnEventHandler(this, EventArgs.Empty);
			}
		}

		public void RaiseRemoveColumnEvent()
		{
			if (this.RemoveColumnEventHandler != null)
			{
				this.RemoveColumnEventHandler(this, EventArgs.Empty);
			}
		}

		public void RaiseScreenNameChangedEvent(string newScreenName, string previousScreenName, string newTitle, string previousTitle)
		{
			if (this.ScreenNameChangedEvent != null)
			{
				ScreenNameChangedEventArgs args = new ScreenNameChangedEventArgs(newScreenName, previousScreenName, newTitle, previousTitle);
				this.ScreenNameChangedEvent(this, args);
			}
		}

		public void RaiseScreenFilenameChangedEvent()
		{
			if (this.ScreenFilenameChangedEventHandler != null)
			{
				this.ScreenFilenameChangedEventHandler(this, EventArgs.Empty);
			}
		}

		private string GenerateScreenTitle()
		{
			string text = string.Empty;
			if (DataSources != null && DataSources.Count > 0)
			{
				text = Name + " : ";
				ICalibration calibration = (ICalibration)DataSources[CurrentSourceAddress];
				if (ScreenType == MonitorScreenType.Complex && calibration is ICalibrationOnline)
				{
					if (calibration.SourceAddress is IPAddressValue)
					{
						IPAddressValue iPAddressValue = calibration.SourceAddress as IPAddressValue;
						text = text + iPAddressValue.IPAddress + " : " + iPAddressValue.Port;
					}
					else
					{
						text = string.Concat(text, calibration.SourceAddress, " : ", DataSourceName);
					}
				}
				else
				{
					text += DataSourceName;
				}
				if (calibration != null)
				{
					int num = calibration.ConfigFileProperties.FileName.LastIndexOf("\\") + 1;
					string text2 = calibration.ConfigFileProperties.FileName.Substring(num, calibration.ConfigFileProperties.FileName.Length - num);
					text = text + " : " + text2;
				}
			}
			return text;
		}

		public ListDictionary GetParameterList()
		{
			SortedList sortedList = new SortedList();
			int num = 0;
			foreach (IMonitorElement monitorColumn in MonitorColumns)
			{
				if (!(monitorColumn is MonitoredGroup))
				{
					continue;
				}
				MonitoredGroup monitoredGroup = monitorColumn as MonitoredGroup;
				foreach (object key in monitoredGroup.MonitoredGroupModel.Members.Keys)
				{
					int num2 = int.Parse(key.ToString().Substring(0, key.ToString().IndexOf(":")));
					string text = key.ToString().Substring(key.ToString().IndexOf(":"));
					sortedList.Add(num + "_" + num2.ToString("X8") + text, monitoredGroup.MonitoredGroupModel.Members[key]);
				}
				num++;
			}
			ListDictionary listDictionary = new ListDictionary();
			foreach (object key2 in sortedList.Keys)
			{
				listDictionary.Add(key2.ToString(), sortedList[key2]);
			}
			return listDictionary;
		}

		public void AddColumn(IMonitorElement column)
		{
			MonitorColumns.Add(column);
			RaiseAddColumnEvent();
		}

		public void RemoveColumn(int index)
		{
			IMonitorElement monitorElement = (IMonitorElement)MonitorColumns[index];
			monitorElement.Dispose();
			MonitorColumns.RemoveAt(index);
			RaiseRemoveColumnEvent();
		}

		public void RemoveColumn(MonitoredGroup column)
		{
			column.Dispose();
			MonitorColumns.Remove(column);
			RaiseRemoveColumnEvent();
		}
	}
	internal class ScreenSynchronize
	{
		private IAddressValue deviceAddress;

		private Screen screen;

		private ManualResetEvent screenStateEvent;

		public IAddressValue DeviceAddress => deviceAddress;

		public Screen Screen => screen;

		public ManualResetEvent ScreenStateEvent => screenStateEvent;

		public ScreenSynchronize(Screen screen, ManualResetEvent screenStateEvent)
		{
			this.screen = screen;
			this.screenStateEvent = screenStateEvent;
		}

		public ScreenSynchronize(Screen screen, ManualResetEvent screenStateEvent, IAddressValue deviceAddress)
			: this(screen, screenStateEvent)
		{
			this.deviceAddress = deviceAddress;
		}
	}
	public class ScreenTabChangedEventArgs : EventArgs
	{
		private string screenName = string.Empty;

		public string ScreenName => screenName;

		public ScreenTabChangedEventArgs(string screenName)
		{
			this.screenName = screenName;
		}
	}
	public class ScreenTitleUpdatedEventArgs : EventArgs
	{
		private string previousScreenTitle = string.Empty;

		private string updatedScreenTitle = string.Empty;

		public string PreviousScreenTitle => previousScreenTitle;

		public string UpdatedScreenTitle => updatedScreenTitle;

		public ScreenTitleUpdatedEventArgs(string previousScreenTitle, string updatedScreenTitle)
		{
			this.previousScreenTitle = previousScreenTitle;
			this.updatedScreenTitle = updatedScreenTitle;
		}
	}
	public delegate void ScreenNameChangingEventHandler(object sender, ScreenNameChangingEventArgs e);
	public class ScreenView : UserControl
	{
		private bool _autoLogging;

		private ScreenController controller;

		private int timeForRefreshRate;

		private ScreenModel model;

		private string currentScreenName = string.Empty;

		private bool updatingMode;

		private bool disposed;

		private Timer refreshTimer;

		private Panel panelScreenView;

		private List<Splitter> splitters = new List<Splitter>();

		private ComboBox comboBoxMonitorMode;

		private TextBox textBoxRefreshRate;

		private TextBox textBoxScreenName;

		private Label labelScreenFilename;

		private Label labelScreenFile;

		private Label labelScreenName;

		private Label labelMonitorMode;

		private Label labelDesiredRate;

		private Label labelActualRefreshRate;

		private ComboBox comboBoxDataRefreshRateUnits;

		private Panel panelDashboard;

		private Plot refreshRateGraph;

		private Label labelErrorMessage;

		public ScreenController Controller => controller;

		public ScreenModel Model => model;

		public string CurrentScreenName
		{
			get
			{
				if (currentScreenName == string.Empty)
				{
					currentScreenName = ((Control)this).Name;
				}
				return currentScreenName;
			}
			set
			{
				currentScreenName = value;
			}
		}

		public event MonitoredElementAddingEventHandler MonitoredElementAddingEvent;

		public event KeyEventHandler GridKeyDown
		{
			add
			{
				for (int i = 0; i < model.MonitorColumns.Count; i++)
				{
					(model.MonitorColumns[i] as IMonitorElement).GridKeyDown += value;
				}
			}
			remove
			{
				for (int i = 0; i < model.MonitorColumns.Count; i++)
				{
					(model.MonitorColumns[i] as IMonitorElement).GridKeyDown -= value;
				}
			}
		}

		internal event ScreenNameChangingEventHandler ScreenNameChangingEvent;

		public ScreenView(ScreenController controller)
		{
			//IL_0023: Unknown result type (might be due to invalid IL or missing references)
			//IL_002d: Expected O, but got Unknown
			InitializeComponent();
			refreshTimer = new Timer();
			refreshTimer.Tick += OnRefreshTimerTick;
			disposed = false;
			updatingMode = false;
			this.controller = controller;
			model = controller.Model;
			UpdateRefreshRate();
			((ListControl)comboBoxMonitorMode).SelectedIndex = 1;
			((ListControl)comboBoxDataRefreshRateUnits).SelectedIndex = 1;
			comboBoxMonitorMode.SelectedIndexChanged += OnMonitorModeChanged;
			model.AddColumnEventHandler += OnAddColumn;
			model.RemoveColumnEventHandler += OnRemoveColumn;
			model.ScreenNameChangedEvent += OnScreenNameChangedEvent;
			model.ChangeActualMonitorRateEventHandler += OnPerformanceUpdate;
			model.ChangeMonitorModeEventHandler += OnChangeMonitorMode;
			model.ChangeBAMTriggerTypeEventHandler += OnChangeBAMTriggerType;
			model.ChangeDataMonitorRateEventHandler += OnChangeDataMonitorRate;
			model.ScreenFilenameChangedEventHandler += OnScreenFilenameChanged;
			controller.RunLocationChange += OnRunLocationChange;
			controller.StopBroadCast += OnStopBroadCast;
			controller.ScreenLoadingFailedEvent += OnScreenLoadingFailedEvent;
			comboBoxDataRefreshRateUnits.SelectedIndexChanged += OnDataRefreshRateUnitsChanged;
			((Control)textBoxScreenName).Text = Model.Name;
			Model.UIRefreshRateChangedEvent += OnUIRefreshRateChanged;
			RefreshView();
			IAppConfigService appConfigService = ServiceManager.Services.GetService(typeof(IAppConfigService)) as IAppConfigService;
			_autoLogging = bool.Parse(appConfigService.GetAppSetting(ApplicationSettings.AutoLoggingChecked));
			if (Model.UIRefreshRate == 0)
			{
				refreshTimer.Stop();
				return;
			}
			refreshTimer.Interval = Model.UIRefreshRate;
			refreshTimer.Start();
		}

		private void OnScreenLoadingFailedEvent(object sender, ScreenLoadingFailedEventArgs args)
		{
			((Control)labelErrorMessage).Visible = true;
			((Control)labelErrorMessage).Text = args.ErrorMessage;
		}

		protected override void Dispose(bool disposing)
		{
			if (disposed && disposing)
			{
				CleaupResources();
			}
			disposed = true;
		}

		public void CleaupResources()
		{
			model.AddColumnEventHandler -= OnAddColumn;
			model.RemoveColumnEventHandler -= OnRemoveColumn;
			model.ChangeActualMonitorRateEventHandler -= OnPerformanceUpdate;
			model.ChangeMonitorModeEventHandler -= OnChangeMonitorMode;
			model.ScreenNameChangedEvent -= OnScreenNameChangedEvent;
			controller.RunLocationChange -= OnRunLocationChange;
			controller.StopBroadCast -= OnStopBroadCast;
		}

		private void OnMonitoredElementAddingEvent(object sender, IParameterModel e)
		{
			this.MonitoredElementAddingEvent(sender, e);
		}

		private void InitializeComponent()
		{
			//IL_002e: Unknown result type (might be due to invalid IL or missing references)
			//IL_0038: Expected O, but got Unknown
			//IL_0039: Unknown result type (might be due to invalid IL or missing references)
			//IL_0043: Expected O, but got Unknown
			//IL_0044: Unknown result type (might be due to invalid IL or missing references)
			//IL_004e: Expected O, but got Unknown
			//IL_004f: Unknown result type (might be due to invalid IL or missing references)
			//IL_0059: Expected O, but got Unknown
			//IL_005a: Unknown result type (might be due to invalid IL or missing references)
			//IL_0064: Expected O, but got Unknown
			//IL_0065: Unknown result type (might be due to invalid IL or missing references)
			//IL_006f: Expected O, but got Unknown
			//IL_0070: Unknown result type (might be due to invalid IL or missing references)
			//IL_007a: Expected O, but got Unknown
			//IL_007b: Unknown result type (might be due to invalid IL or missing references)
			//IL_0085: Expected O, but got Unknown
			//IL_0086: Unknown result type (might be due to invalid IL or missing references)
			//IL_0090: Expected O, but got Unknown
			//IL_0091: Unknown result type (might be due to invalid IL or missing references)
			//IL_009b: Expected O, but got Unknown
			//IL_009c: Unknown result type (might be due to invalid IL or missing references)
			//IL_00a6: Expected O, but got Unknown
			//IL_00a7: Unknown result type (might be due to invalid IL or missing references)
			//IL_00b1: Expected O, but got Unknown
			//IL_00b2: Unknown result type (might be due to invalid IL or missing references)
			//IL_00bc: Expected O, but got Unknown
			//IL_0190: Unknown result type (might be due to invalid IL or missing references)
			//IL_019a: Expected O, but got Unknown
			//IL_0344: Unknown result type (might be due to invalid IL or missing references)
			//IL_034e: Expected O, but got Unknown
			//IL_035b: Unknown result type (might be due to invalid IL or missing references)
			//IL_0365: Expected O, but got Unknown
			//IL_0409: Unknown result type (might be due to invalid IL or missing references)
			//IL_0413: Expected O, but got Unknown
			//IL_048a: Unknown result type (might be due to invalid IL or missing references)
			//IL_0494: Expected O, but got Unknown
			//IL_0517: Unknown result type (might be due to invalid IL or missing references)
			//IL_0521: Expected O, but got Unknown
			//IL_05b5: Unknown result type (might be due to invalid IL or missing references)
			//IL_05bf: Expected O, but got Unknown
			//IL_0653: Unknown result type (might be due to invalid IL or missing references)
			//IL_065d: Expected O, but got Unknown
			//IL_0c2c: Unknown result type (might be due to invalid IL or missing references)
			//IL_0c36: Expected O, but got Unknown
			PlotChannelTrace plotChannelTrace = new PlotChannelTrace();
			PlotDataCursorXY plotDataCursorXY = new PlotDataCursorXY();
			PlotDataView plotDataView = new PlotDataView();
			PlotLabelBasic plotLabelBasic = new PlotLabelBasic();
			PlotLegendBasic plotLegendBasic = new PlotLegendBasic();
			PlotXAxis plotXAxis = new PlotXAxis();
			PlotYAxis plotYAxis = new PlotYAxis();
			panelScreenView = new Panel();
			labelErrorMessage = new Label();
			comboBoxMonitorMode = new ComboBox();
			textBoxRefreshRate = new TextBox();
			textBoxScreenName = new TextBox();
			labelScreenFilename = new Label();
			labelScreenFile = new Label();
			labelScreenName = new Label();
			labelMonitorMode = new Label();
			labelDesiredRate = new Label();
			labelActualRefreshRate = new Label();
			comboBoxDataRefreshRateUnits = new ComboBox();
			panelDashboard = new Panel();
			refreshRateGraph = new Plot();
			((Control)panelScreenView).SuspendLayout();
			((Control)panelDashboard).SuspendLayout();
			((Control)this).SuspendLayout();
			((Control)panelScreenView).Controls.Add((Control)(object)labelErrorMessage);
			((Control)panelScreenView).Dock = (DockStyle)5;
			((Control)panelScreenView).Location = new Point(0, 32);
			((Control)panelScreenView).Name = "panelScreenView";
			((Control)panelScreenView).Size = new Size(783, 559);
			((Control)panelScreenView).TabIndex = 1;
			((Control)panelScreenView).Resize += panelScreenView_Resize;
			((Control)labelErrorMessage).AutoSize = true;
			((Control)labelErrorMessage).Dock = (DockStyle)5;
			((Control)labelErrorMessage).Font = new Font("Microsoft Sans Serif", 8.25f, (FontStyle)1, (GraphicsUnit)3, (byte)0);
			((Control)labelErrorMessage).ForeColor = Color.Red;
			((Control)labelErrorMessage).Location = new Point(0, 0);
			((Control)labelErrorMessage).Name = "labelErrorMessage";
			((Control)labelErrorMessage).Size = new Size(88, 13);
			((Control)labelErrorMessage).TabIndex = 0;
			((Control)labelErrorMessage).Text = "Error Message";
			labelErrorMessage.TextAlign = (ContentAlignment)32;
			((Control)labelErrorMessage).Visible = false;
			((Control)comboBoxMonitorMode).Anchor = (AnchorStyles)9;
			comboBoxMonitorMode.DropDownStyle = (ComboBoxStyle)2;
			comboBoxMonitorMode.Items.AddRange(new object[3] { "BAM", "Request/Receive", "EDM" });
			((Control)comboBoxMonitorMode).Location = new Point(368, 6);
			((Control)comboBoxMonitorMode).Name = "comboBoxMonitorMode";
			((Control)comboBoxMonitorMode).Size = new Size(120, 21);
			((Control)comboBoxMonitorMode).TabIndex = 15;
			((Control)textBoxRefreshRate).Anchor = (AnchorStyles)9;
			((Control)textBoxRefreshRate).Location = new Point(536, 6);
			((Control)textBoxRefreshRate).Name = "textBoxRefreshRate";
			((Control)textBoxRefreshRate).Size = new Size(40, 20);
			((Control)textBoxRefreshRate).TabIndex = 7;
			textBoxRefreshRate.TextAlign = (HorizontalAlignment)1;
			((Control)textBoxRefreshRate).Enter += textBoxRefreshRate_Enter;
			((Control)textBoxRefreshRate).Leave += textBoxRefreshRate_Leave;
			((Control)textBoxRefreshRate).KeyUp += new KeyEventHandler(textBoxRefreshRate_KeyUp);
			((Control)textBoxRefreshRate).KeyDown += new KeyEventHandler(textBoxRefreshRate_KeyDown);
			((Control)textBoxScreenName).Location = new Point(248, 6);
			((Control)textBoxScreenName).Name = "textBoxScreenName";
			((Control)textBoxScreenName).Size = new Size(72, 20);
			((Control)textBoxScreenName).TabIndex = 8;
			((TextBoxBase)textBoxScreenName).WordWrap = false;
			((Control)textBoxScreenName).DoubleClick += textBoxScreenName_DoubleClick;
			((Control)textBoxScreenName).GotFocus += textBoxScreenName_Focus;
			((Control)textBoxScreenName).Leave += textBoxScreenName_Leave;
			((Control)textBoxScreenName).KeyDown += new KeyEventHandler(textBoxScreenName_KeyDown);
			((Control)labelScreenFilename).ForeColor = SystemColors.ActiveCaptionText;
			((Control)labelScreenFilename).Location = new Point(64, 6);
			((Control)labelScreenFilename).Name = "labelScreenFilename";
			((Control)labelScreenFilename).Size = new Size(136, 20);
			((Control)labelScreenFilename).TabIndex = 9;
			labelScreenFilename.TextAlign = (ContentAlignment)16;
			((Control)labelScreenFile).Font = new Font("Microsoft Sans Serif", 8.25f, (FontStyle)1, (GraphicsUnit)3, (byte)0);
			((Control)labelScreenFile).ForeColor = SystemColors.ActiveCaptionText;
			((Control)labelScreenFile).Location = new Point(0, 6);
			((Control)labelScreenFile).Name = "labelScreenFile";
			((Control)labelScreenFile).Size = new Size(56, 20);
			((Control)labelScreenFile).TabIndex = 10;
			((Control)labelScreenFile).Text = "Filename";
			labelScreenFile.TextAlign = (ContentAlignment)16;
			((Control)labelScreenName).Font = new Font("Microsoft Sans Serif", 8.25f, (FontStyle)1, (GraphicsUnit)3, (byte)0);
			((Control)labelScreenName).ForeColor = SystemColors.ActiveCaptionText;
			((Control)labelScreenName).Location = new Point(208, 6);
			((Control)labelScreenName).Name = "labelScreenName";
			((Control)labelScreenName).Size = new Size(40, 20);
			((Control)labelScreenName).TabIndex = 11;
			((Control)labelScreenName).Text = "Name";
			labelScreenName.TextAlign = (ContentAlignment)16;
			((Control)labelMonitorMode).Anchor = (AnchorStyles)9;
			((Control)labelMonitorMode).Font = new Font("Microsoft Sans Serif", 8.25f, (FontStyle)1, (GraphicsUnit)3, (byte)0);
			((Control)labelMonitorMode).ForeColor = SystemColors.ActiveCaptionText;
			((Control)labelMonitorMode).Location = new Point(328, 6);
			((Control)labelMonitorMode).Name = "labelMonitorMode";
			((Control)labelMonitorMode).Size = new Size(40, 20);
			((Control)labelMonitorMode).TabIndex = 12;
			((Control)labelMonitorMode).Text = "Mode";
			labelMonitorMode.TextAlign = (ContentAlignment)16;
			((Control)labelDesiredRate).Anchor = (AnchorStyles)9;
			((Control)labelDesiredRate).Font = new Font("Microsoft Sans Serif", 8.25f, (FontStyle)1, (GraphicsUnit)3, (byte)0);
			((Control)labelDesiredRate).ForeColor = SystemColors.ActiveCaptionText;
			((Control)labelDesiredRate).Location = new Point(488, 8);
			((Control)labelDesiredRate).Name = "labelDesiredRate";
			((Control)labelDesiredRate).Size = new Size(48, 20);
			((Control)labelDesiredRate).TabIndex = 13;
			((Control)labelDesiredRate).Text = "Desired";
			labelDesiredRate.TextAlign = (ContentAlignment)16;
			((Control)labelActualRefreshRate).Dock = (DockStyle)4;
			((Control)labelActualRefreshRate).ForeColor = SystemColors.ActiveCaptionText;
			((Control)labelActualRefreshRate).Location = new Point(732, 0);
			((Control)labelActualRefreshRate).Name = "labelActualRefreshRate";
			((Control)labelActualRefreshRate).Size = new Size(51, 32);
			((Control)labelActualRefreshRate).TabIndex = 15;
			labelActualRefreshRate.TextAlign = (ContentAlignment)64;
			((Control)comboBoxDataRefreshRateUnits).Anchor = (AnchorStyles)9;
			comboBoxDataRefreshRateUnits.DropDownStyle = (ComboBoxStyle)2;
			comboBoxDataRefreshRateUnits.Items.AddRange(new object[2] { "Hz", "ms" });
			((Control)comboBoxDataRefreshRateUnits).Location = new Point(584, 6);
			((Control)comboBoxDataRefreshRateUnits).Name = "comboBoxDataRefreshRateUnits";
			((Control)comboBoxDataRefreshRateUnits).Size = new Size(48, 21);
			((Control)comboBoxDataRefreshRateUnits).TabIndex = 16;
			((Control)panelDashboard).BackColor = SystemColors.ActiveCaption;
			((Control)panelDashboard).Controls.Add((Control)(object)refreshRateGraph);
			((Control)panelDashboard).Controls.Add((Control)(object)comboBoxDataRefreshRateUnits);
			((Control)panelDashboard).Controls.Add((Control)(object)labelActualRefreshRate);
			((Control)panelDashboard).Controls.Add((Control)(object)labelDesiredRate);
			((Control)panelDashboard).Controls.Add((Control)(object)labelMonitorMode);
			((Control)panelDashboard).Controls.Add((Control)(object)labelScreenName);
			((Control)panelDashboard).Controls.Add((Control)(object)labelScreenFile);
			((Control)panelDashboard).Controls.Add((Control)(object)labelScreenFilename);
			((Control)panelDashboard).Controls.Add((Control)(object)textBoxScreenName);
			((Control)panelDashboard).Controls.Add((Control)(object)textBoxRefreshRate);
			((Control)panelDashboard).Controls.Add((Control)(object)comboBoxMonitorMode);
			((Control)panelDashboard).Dock = (DockStyle)1;
			((Control)panelDashboard).Location = new Point(0, 0);
			((Control)panelDashboard).Name = "panelDashboard";
			((Control)panelDashboard).Size = new Size(783, 32);
			((Control)panelDashboard).TabIndex = 15;
			refreshRateGraph.LoadingBegin();
			refreshRateGraph.Border.Margin = 0;
			plotChannelTrace.CanFocus = false;
			plotChannelTrace.Capacity = 64;
			plotChannelTrace.Color = Color.Red;
			plotChannelTrace.ContextMenuEnabled = false;
			plotChannelTrace.Name = "Channel 1";
			plotChannelTrace.TitleText = "Channel 1";
			plotChannelTrace.UserCanEdit = false;
			plotChannelTrace.VisibleInLegend = false;
			refreshRateGraph.Channels.Add(plotChannelTrace);
			plotDataCursorXY.Hint.Fill.Pen.Color = SystemColors.InfoText;
			plotDataCursorXY.Name = "Data-Cursor 1";
			plotDataCursorXY.TitleText = "Data-Cursor 1";
			refreshRateGraph.DataCursors.Add(plotDataCursorXY);
			plotDataView.AxesControlEnabled = false;
			plotDataView.CanFocus = false;
			plotDataView.ContextMenuEnabled = false;
			plotDataView.DockMargin = 0;
			plotDataView.Name = "Data-View 1";
			plotDataView.TitleText = "Data-View 1";
			plotDataView.UserCanEdit = false;
			refreshRateGraph.DataViews.Add(plotDataView);
			((Control)refreshRateGraph).Dock = (DockStyle)4;
			plotLabelBasic.DockOrder = 0;
			plotLabelBasic.Name = "Label 1";
			plotLabelBasic.TitleText = "Label 1";
			plotLabelBasic.Visible = false;
			refreshRateGraph.Labels.Add(plotLabelBasic);
			plotLegendBasic.DockOrder = 0;
			plotLegendBasic.Name = "Legend 1";
			plotLegendBasic.TitleText = "Legend 1";
			plotLegendBasic.Visible = false;
			refreshRateGraph.Legends.Add(plotLegendBasic);
			((Control)refreshRateGraph).Location = new Point(632, 0);
			((Control)refreshRateGraph).Name = "refreshRateGraph";
			refreshRateGraph.Size = new Size(100, 32);
			((Control)refreshRateGraph).TabIndex = 17;
			refreshRateGraph.UpdateFrameRate = 50.0;
			plotXAxis.CanFocus = false;
			plotXAxis.Color = Color.White;
			plotXAxis.ContextMenuEnabled = false;
			plotXAxis.ControlKeyToggleEnabled = false;
			plotXAxis.DockOrder = 0;
			plotXAxis.Name = "X-Axis 1";
			plotXAxis.ScaleRange.Span = 10.0;
			plotXAxis.Title.Text = "X-Axis 1";
			plotXAxis.UserCanEdit = false;
			plotXAxis.Visible = false;
			refreshRateGraph.XAxes.Add(plotXAxis);
			plotYAxis.CanFocus = false;
			plotYAxis.Color = Color.White;
			plotYAxis.ContextMenuEnabled = false;
			plotYAxis.ControlKeyToggleEnabled = false;
			plotYAxis.DockOrder = 0;
			plotYAxis.Name = "Y-Axis 1";
			plotYAxis.ScaleDisplay.GeneratorAuto.MinorCount = 2;
			plotYAxis.ScaleDisplay.LineInnerVisible = false;
			plotYAxis.ScaleDisplay.Margin = 0;
			plotYAxis.ScaleDisplay.TextAlignment = (StringAlignment)2;
			plotYAxis.ScaleDisplay.TextFormatting.Precision = 0;
			plotYAxis.ScaleDisplay.TextWidthMinValue = 0.0;
			plotYAxis.ScaleDisplay.TickMajor.Font = new Font("Microsoft Sans Serif", 8.25f, (FontStyle)0, (GraphicsUnit)3, (byte)0, true);
			plotYAxis.ScaleDisplay.TickMajor.Length = 0;
			plotYAxis.ScaleDisplay.TickMajor.TextMargin = 0;
			plotYAxis.ScaleDisplay.TickMajor.TextVisible = false;
			plotYAxis.ScaleDisplay.TickMajor.Thickness = 0;
			plotYAxis.ScaleDisplay.TickMid.TextMargin = 0;
			plotYAxis.ScaleDisplay.TickMid.TextVisible = false;
			plotYAxis.ScaleRange.LimitMaxUpperValue = 120.0;
			plotYAxis.ScaleRange.Min = 20.0;
			plotYAxis.ScaleRange.Span = 85.0;
			plotYAxis.Title.MarginSpacing = 0.0;
			plotYAxis.Title.Text = "Y-Axis 1";
			plotYAxis.Title.TextLayout.AlignmentHorizontal.Margin = 0.0;
			plotYAxis.Title.TextLayout.AlignmentVertical.Margin = 0.0;
			plotYAxis.UserCanEdit = false;
			plotYAxis.Visible = false;
			refreshRateGraph.YAxes.Add(plotYAxis);
			refreshRateGraph.LoadingEnd();
			((Control)this).Controls.Add((Control)(object)panelScreenView);
			((Control)this).Controls.Add((Control)(object)panelDashboard);
			((Control)this).Name = "ScreenView";
			((Control)this).Size = new Size(783, 591);
			((Control)panelScreenView).ResumeLayout(false);
			((Control)panelScreenView).PerformLayout();
			((Control)panelDashboard).ResumeLayout(false);
			((Control)panelDashboard).PerformLayout();
			((Control)this).ResumeLayout(false);
		}

		public void OnAddColumn(object sender, EventArgs e)
		{
			IMonitorElement monitorElement = (IMonitorElement)Model.MonitorColumns[Model.MonitorColumns.Count - 1];
			if (monitorElement is MonitoredGroup)
			{
				(monitorElement as MonitoredGroup).MonitoredElementAddingEvent += OnMonitoredElementAddingEvent;
			}
			if (sender is ScreenModel)
			{
				RefreshView();
			}
		}

		public void OnRemoveColumn(object sender, EventArgs e)
		{
			if (sender is ScreenModel)
			{
				RefreshView();
			}
		}

		public void OnPerformanceUpdate(object sender, EventArgs e)
		{
			if (!((Control)this).InvokeRequired)
			{
				if (Model.ActualMonitorRate == 0.0 && Model.ActualMonitorRate != double.PositiveInfinity)
				{
					((Control)labelActualRefreshRate).Text = "0";
					refreshRateGraph.Channels[0].Clear();
					timeForRefreshRate = 0;
				}
				else
				{
					((Control)labelActualRefreshRate).Text = Model.ActualMonitorRate.ToString("0");
					refreshRateGraph.Channels[0].AddXY(timeForRefreshRate++, Model.ActualMonitorRate);
				}
			}
			else
			{
				((Control)this).BeginInvoke((Delegate)new EventHandler(OnPerformanceUpdate), new object[2] { sender, e });
			}
		}

		public void Undo()
		{
			Controller.Undo();
		}

		public void Revert()
		{
			Controller.Revert();
		}

		private void UpdateRefreshRate()
		{
			int num = 0;
			num = Controller.MonitorMode switch
			{
				DataAcquisitionType.BAM => Controller.BAMRefreshRate, 
				DataAcquisitionType.EDM => Controller.EDMRefreshRate, 
				_ => Controller.MonitorDataRefreshRate, 
			};
			((Control)textBoxRefreshRate).Text = num.ToString();
			Controller.dataMonitorRefreshRate = ((Control)textBoxRefreshRate).Text;
			switch (Controller.DataRefreshUnits)
			{
			case RefreshUnitsType.Hertz:
				((ListControl)comboBoxDataRefreshRateUnits).SelectedIndex = 0;
				break;
			default:
				((ListControl)comboBoxDataRefreshRateUnits).SelectedIndex = 1;
				break;
			}
		}

		private void UpdateDataRefreshRateUnits()
		{
			if (Controller.MonitorMode != DataAcquisitionType.BAM || Controller.BAMTriggerMode == TriggerType.Clock || Controller.BAMTriggerMode == TriggerType.Frame || Controller.BAMTriggerMode == TriggerType.ForeGroundActivated)
			{
				((Control)comboBoxDataRefreshRateUnits).Visible = true;
			}
			else
			{
				((Control)comboBoxDataRefreshRateUnits).Visible = false;
			}
		}

		protected void OnChangeDataMonitorRate(object sender, EventArgs e)
		{
			UpdateRefreshRate();
		}

		protected void OnMonitorModeChanged(object sender, EventArgs e)
		{
			if (updatingMode)
			{
				return;
			}
			updatingMode = true;
			DataAcquisitionType dataAcquisitionType = ((Control)comboBoxMonitorMode).Text switch
			{
				"BAM" => DataAcquisitionType.BAM, 
				"EDM" => DataAcquisitionType.EDM, 
				_ => DataAcquisitionType.RequestReceive, 
			};
			_ = Cursor.Current;
			Cursor.Current = Cursors.WaitCursor;
			MsgBoxResult msgBoxResult = MsgBoxResult.None;
			if (dataAcquisitionType == DataAcquisitionType.BAM)
			{
				string message = "The broadcast needs to be turned off which is required for BAM data monitoring. Do you want to start BAM and stop broadcast now?";
				msgBoxResult = MsgBox.Show(message, "Data Monitoring", MsgBoxButtons.YesNo, MsgBoxIcon.Question);
			}
			if (msgBoxResult == MsgBoxResult.None || msgBoxResult == MsgBoxResult.Yes)
			{
				Controller.MonitorMode = dataAcquisitionType;
				Cursor.Current = Cursors.Default;
				UpdateRefreshRate();
			}
			else
			{
				dataAcquisitionType = Controller.MonitorMode;
				switch (Controller.MonitorMode)
				{
				case DataAcquisitionType.RequestReceive:
					((Control)comboBoxMonitorMode).Text = "Request/Receive";
					break;
				case DataAcquisitionType.EDM:
					((Control)comboBoxMonitorMode).Text = "EDM";
					break;
				case DataAcquisitionType.BAM:
					Controller.MonitorMode = DataAcquisitionType.RequestReceive;
					dataAcquisitionType = DataAcquisitionType.RequestReceive;
					Cursor.Current = Cursors.Default;
					UpdateRefreshRate();
					break;
				}
			}
			updatingMode = false;
		}

		protected void OnDataRefreshRateUnitsChanged(object sender, EventArgs e)
		{
			Controller.SetRefreshRate(((Control)textBoxRefreshRate).Text, ((Control)comboBoxDataRefreshRateUnits).Text);
		}

		protected void OnChangeMonitorMode(object sender, EventArgs e)
		{
			int num = 0;
			DataAcquisitionType monitorMode = Controller.MonitorMode;
			((ListControl)comboBoxMonitorMode).SelectedIndex = monitorMode switch
			{
				DataAcquisitionType.BAM => 0, 
				DataAcquisitionType.EDM => 2, 
				_ => 1, 
			};
			UpdateRefreshRate();
			UpdateDataRefreshRateUnits();
		}

		private void OnChangeBAMTriggerType(object sender, EventArgs e)
		{
			UpdateDataRefreshRateUnits();
		}

		protected void OnScreenFilenameChanged(object sender, EventArgs e)
		{
			((Control)labelScreenFilename).Text = Model.ScreenFilename;
		}

		private void OnRunLocationChange(object sender, RunLocationChangeEventArgs args)
		{
			EventLogger.Log("Editor", "Switching to " + args.EcmRunLocation.ToString() + " mode");
			args.ReturnType = InteropMessageReturnType.Yes;
		}

		private void OnStopBroadCast(object sender, StopBroadCastEventArgs args)
		{
			EventLogger.Info("Editor", "Stopping broadcast");
			args.ReturnType = InteropMessageReturnType.Yes;
		}

		private void RaiseAndLookupScreenNameChanging(string proposedName, string currentScreenName)
		{
			if (this.ScreenNameChangingEvent == null)
			{
				return;
			}
			ScreenNameChangingEventArgs e = new ScreenNameChangingEventArgs(proposedName, currentScreenName, CurrentScreenName);
			this.ScreenNameChangingEvent(this, e);
			if (e.Cancel)
			{
				((Control)textBoxScreenName).Text = e.CurrentName;
				if (string.Empty != e.CancelMessage)
				{
					EventLogger.Info("Screen", e.CancelMessage);
				}
			}
		}

		private void RefreshView()
		{
			//IL_01aa: Unknown result type (might be due to invalid IL or missing references)
			//IL_01b1: Expected O, but got Unknown
			((Control)panelScreenView).SuspendLayout();
			((Control)this).SuspendLayout();
			switch (Model.MonitorColumns.Count)
			{
			case 1:
			{
				Cummins.Parameter.Parameter parameter3 = (Cummins.Parameter.Parameter)Model.MonitorColumns[0];
				((Control)parameter3.DataView).Dock = (DockStyle)5;
				((Control)panelScreenView).Controls.Add((Control)(object)parameter3.DataView);
				((Control)parameter3.DataView).Focus();
				break;
			}
			default:
			{
				foreach (Splitter splitter in splitters)
				{
					((Control)panelScreenView).Controls.Remove((Control)(object)splitter);
				}
				splitters.Clear();
				foreach (Cummins.Parameter.Parameter monitorColumn in Model.MonitorColumns)
				{
					if (((Control)monitorColumn.DataView).Parent != null)
					{
						((Control)panelScreenView).Controls.Remove((Control)(object)monitorColumn.DataView);
					}
				}
				int num = 0;
				int num2 = ((Control)panelScreenView).Width / Model.MonitorColumns.Count;
				int num3 = 0;
				foreach (Cummins.Parameter.Parameter monitorColumn2 in Model.MonitorColumns)
				{
					((Control)monitorColumn2.DataView).Dock = (DockStyle)4;
					((Control)monitorColumn2.DataView).Parent = (Control)(object)panelScreenView;
					if (num != Model.MonitorColumns.Count - 1)
					{
						Splitter val = new Splitter();
						num3 += num2;
						((Control)val).Location = new Point(num3, 0);
						((Control)val).Dock = (DockStyle)4;
						((Control)val).Enabled = false;
						((Control)val).Parent = (Control)(object)panelScreenView;
						splitters.Add(val);
					}
					num++;
				}
				((Control)((Cummins.Parameter.Parameter)Model.MonitorColumns[0]).DataView).Focus();
				break;
			}
			case 0:
				break;
			}
			((Control)panelScreenView).ResumeLayout(false);
			((Control)this).ResumeLayout(false);
			((Control)panelScreenView).Scale(1f);
			panelScreenView_Resize(null, EventArgs.Empty);
		}

		private void panelScreenView_Resize(object sender, EventArgs e)
		{
			if (Model.MonitorColumns.Count <= 1)
			{
				return;
			}
			int num = ((Control)panelScreenView).Width / Model.MonitorColumns.Count;
			int num2 = 0;
			MonitoredGroupView monitoredGroupView = null;
			foreach (IMonitorElement monitorColumn in Model.MonitorColumns)
			{
				monitoredGroupView = (MonitoredGroupView)((MonitoredGroup)monitorColumn).DataView;
				((Control)monitoredGroupView).Location = new Point(num2, 0);
				((Control)monitoredGroupView).Width = num;
				num2 += num;
			}
		}

		private void textBoxRefreshRate_KeyDown(object sender, KeyEventArgs e)
		{
			//IL_0001: Unknown result type (might be due to invalid IL or missing references)
			//IL_0008: Invalid comparison between Unknown and I4
			if ((int)e.KeyCode == 13)
			{
				Controller.SetRefreshRate(((Control)textBoxRefreshRate).Text, ((Control)comboBoxDataRefreshRateUnits).Text);
			}
		}

		private void textBoxScreenName_DoubleClick(object sender, EventArgs e)
		{
			((TextBoxBase)textBoxScreenName).SelectAll();
		}

		private void textBoxScreenName_Focus(object sender, EventArgs e)
		{
			GlobalEventNumber.doNotActivateTrigger = true;
		}

		private void textBoxScreenName_KeyDown(object sender, KeyEventArgs e)
		{
			//IL_0001: Unknown result type (might be due to invalid IL or missing references)
			//IL_0008: Invalid comparison between Unknown and I4
			if ((int)e.KeyCode == 13)
			{
				string name = Model.Name;
				string text = ((Control)textBoxScreenName).Text.ToString();
				if (name != text)
				{
					RaiseAndLookupScreenNameChanging(text, name);
				}
			}
		}

		private void textBoxScreenName_Leave(object sender, EventArgs e)
		{
			string name = Model.Name;
			string text = ((Control)textBoxScreenName).Text.ToString();
			if (name != text)
			{
				RaiseAndLookupScreenNameChanging(text, name);
			}
			GlobalEventNumber.doNotActivateTrigger = false;
		}

		private void textBoxRefreshRate_Enter(object sender, EventArgs e)
		{
			((TextBoxBase)textBoxRefreshRate).SelectAll();
		}

		private void textBoxRefreshRate_Leave(object sender, EventArgs e)
		{
			Controller.SetRefreshRate(((Control)textBoxRefreshRate).Text, ((Control)comboBoxDataRefreshRateUnits).Text);
		}

		private void textBoxRefreshRate_KeyUp(object sender, KeyEventArgs e)
		{
			Controller.dataMonitorRefreshRate = ((Control)textBoxRefreshRate).Text;
			Controller.IsDirty = true;
		}

		private void OnRefreshTimerTick(object sender, EventArgs e)
		{
			if (!Controller.IsMonitoring)
			{
				return;
			}
			if (_autoLogging)
			{
				if (Editor.CurrentScreenName == currentScreenName)
				{
					Controller.Refresh();
				}
			}
			else
			{
				Controller.Refresh();
			}
		}

		private void OnUIRefreshRateChanged(object sender, EventArgs e)
		{
			if (Model.UIRefreshRate == 0)
			{
				refreshTimer.Stop();
				return;
			}
			refreshTimer.Interval = Model.UIRefreshRate;
			refreshTimer.Start();
		}

		private void OnScreenNameChangedEvent(object sender, ScreenNameChangedEventArgs args)
		{
			((Control)textBoxScreenName).Text = args.NewScreenName;
			if (CurrentScreenName == args.PreviousLongScreenName)
			{
				CurrentScreenName = args.NewLongScreenName;
			}
			else
			{
				CurrentScreenName = args.NewScreenName;
			}
		}

		public string ChangeScreenTitle(bool isDocked, string dataSourceName)
		{
			if (isDocked)
			{
				CurrentScreenName = Model.Name;
			}
			else
			{
				CurrentScreenName = Model.LongScreenName;
			}
			return CurrentScreenName;
		}
	}
	public class SubscriptionRemovedEventArgument : EventArgs
	{
		private int hashCode;

		public int HashCode
		{
			get
			{
				return hashCode;
			}
			set
			{
				hashCode = value;
			}
		}
	}
}
