/*
 * Decompiled from: XceedZip.dll
 * Using Ghidra 11.4.1
 */

// Function: FUN_67671000 at 67671000

void __cdecl FUN_67671000(int param_1)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  int *piVar4;
  int iVar5;
  int in_stack_ffffffe8;
  int *piVar6;
  uint *puVar7;
  int local_8;
  
  piVar6 = *(int **)(param_1 + 0x20);
  uVar1 = *(uint *)(param_1 + 0x44);
  puVar7 = *(uint **)(param_1 + 0x18);
  iVar2 = *(int *)(param_1 + 0x268);
  iVar5 = *(int *)(param_1 + 0x30);
  if (9999 < (int)uVar1) {
    uVar3 = uVar1 + 0x22;
    if ((uVar3 & 1) != 0) {
      uVar3 = uVar1 + 0x23;
    }
    if (iVar5 < 1) {
      iVar5 = 1;
    }
    if (100 < iVar5) {
      iVar5 = 100;
    }
    iVar5 = ((iVar5 + -1) / 3) * uVar1;
    local_8 = iVar5;
    FUN_676717bc((int)piVar6,*(byte **)(param_1 + 0x24),(int)(*(byte **)(param_1 + 0x24) + uVar3),
                 puVar7,uVar1,iVar2,&local_8);
    if (2 < iVar2) {
      in_stack_ffffffe8 = iVar5 - local_8;
      FUN_676afdac((int *)&DAT_676c2138,(byte *)s__d_work___d_block__ratio__5_2f_676bf0c0);
    }
    if (-1 < local_8) goto LAB_676710ec;
    if (1 < iVar2) {
      FUN_676afdac((int *)&DAT_676c2138,(byte *)s_too_repetitive__using_fallback_s_676bf088);
    }
  }
  FUN_67671124(*(int **)(param_1 + 0x10),*(int *)(param_1 + 0x14),puVar7,uVar1,iVar2);
LAB_676710ec:
  *(undefined4 *)(param_1 + 0x1c) = 0xffffffff;
  iVar2 = 0;
  piVar4 = piVar6;
  if (0 < *(int *)(param_1 + 0x44)) {
    do {
      if (*piVar4 == 0) {
        *(int *)(param_1 + 0x1c) = iVar2;
        break;
      }
      iVar2 = iVar2 + 1;
      piVar4 = piVar4 + 1;
    } while (iVar2 < *(int *)(param_1 + 0x44));
  }
  if (*(int *)(param_1 + 0x1c) == -1) {
    FUN_6767268b(0x3eb,in_stack_ffffffe8,(int)piVar6,(char)puVar7);
  }
  return;
}



// Function: FUN_67671124 at 67671124

void __cdecl FUN_67671124(int *param_1,int param_2,undefined4 *param_3,int param_4,int param_5)

{
  uint uVar1;
  undefined4 *puVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  undefined4 unaff_EBX;
  int unaff_ESI;
  int unaff_EDI;
  int *piVar7;
  undefined4 *puVar8;
  uint uVar9;
  undefined1 uVar10;
  int local_814 [256];
  int local_414 [257];
  int local_10;
  int local_c;
  int local_8;
  
  puVar2 = param_3;
  if (3 < param_5) {
    FUN_676afdac((int *)&DAT_676c2138,(byte *)s_bucket_sorting_____676bf13c);
  }
  piVar5 = local_414;
  for (iVar4 = 0x101; iVar4 != 0; iVar4 = iVar4 + -1) {
    *piVar5 = 0;
    piVar5 = piVar5 + 1;
  }
  iVar4 = 0;
  if (0 < param_4) {
    do {
      local_414[*(byte *)(iVar4 + param_2)] = local_414[*(byte *)(iVar4 + param_2)] + 1;
      iVar4 = iVar4 + 1;
    } while (iVar4 < param_4);
  }
  iVar6 = 0x100;
  piVar5 = local_414;
  piVar7 = local_814;
  for (iVar4 = 0x100; iVar4 != 0; iVar4 = iVar4 + -1) {
    *piVar7 = *piVar5;
    piVar5 = piVar5 + 1;
    piVar7 = piVar7 + 1;
  }
  piVar5 = local_414;
  do {
    piVar5 = piVar5 + 1;
    *piVar5 = *piVar5 + piVar5[-1];
    iVar6 = iVar6 + -1;
  } while (iVar6 != 0);
  iVar4 = 0;
  if (0 < param_4) {
    do {
      iVar6 = local_414[*(byte *)(iVar4 + param_2)];
      local_414[*(byte *)(iVar4 + param_2)] = iVar6 + -1;
      param_1[iVar6 + -1] = iVar4;
      iVar4 = iVar4 + 1;
    } while (iVar4 < param_4);
  }
  iVar4 = param_4 / 0x20 + 2;
  puVar8 = param_3;
  if (0 < iVar4) {
    for (; iVar4 != 0; iVar4 = iVar4 + -1) {
      *puVar8 = 0;
      puVar8 = puVar8 + 1;
    }
  }
  piVar5 = local_414;
  iVar4 = 0x100;
  do {
    iVar6 = *piVar5;
    piVar5 = piVar5 + 1;
    param_3[iVar6 >> 5] = param_3[iVar6 >> 5] | 1 << ((byte)iVar6 & 0x1f);
    iVar4 = iVar4 + -1;
  } while (iVar4 != 0);
  iVar4 = 0x20;
  iVar6 = param_4;
  do {
    param_3[iVar6 >> 5] = param_3[iVar6 >> 5] | 1 << ((byte)iVar6 & 0x1f);
    param_3[iVar6 + 1 >> 5] = param_3[iVar6 + 1 >> 5] & ~(1 << ((byte)(iVar6 + 1) & 0x1f));
    iVar6 = iVar6 + 2;
    iVar4 = iVar4 + -1;
  } while (iVar4 != 0);
  param_3 = (undefined4 *)0x1;
LAB_67671242:
  if (3 < param_5) {
    FUN_676afdac((int *)&DAT_676c2138,(byte *)s_depth__6d_has_676bf124);
  }
  iVar6 = 0;
  iVar4 = 0;
  piVar5 = param_1;
  if (0 < param_4) {
    do {
      if ((puVar2[iVar6 >> 5] & 1 << ((byte)iVar6 & 0x1f)) != 0) {
        iVar4 = iVar6;
      }
      iVar3 = *piVar5 - (int)param_3;
      if (iVar3 < 0) {
        iVar3 = iVar3 + param_4;
      }
      iVar6 = iVar6 + 1;
      *(int *)(param_2 + iVar3 * 4) = iVar4;
      piVar5 = piVar5 + 1;
    } while (iVar6 < param_4);
  }
  local_8 = 0;
  uVar9 = 0xffffffff;
LAB_676712a2:
  uVar9 = uVar9 + 1;
  if ((puVar2[(int)uVar9 >> 5] & 1 << (sbyte)(uVar9 & 0x1f)) != 0) goto code_r0x676712b6;
  goto LAB_676712bd;
code_r0x676712b6:
  if ((uVar9 & 0x1f) != 0) goto LAB_676712a2;
LAB_676712bd:
  uVar1 = puVar2[(int)uVar9 >> 5];
  if ((uVar1 & 1 << ((byte)uVar9 & 0x1f)) != 0) {
    while (uVar1 == 0xffffffff) {
      uVar9 = uVar9 + 0x20;
      uVar1 = puVar2[(int)uVar9 >> 5];
    }
    while ((puVar2[(int)uVar9 >> 5] & 1 << ((byte)uVar9 & 0x1f)) != 0) {
      uVar9 = uVar9 + 1;
    }
  }
  iVar4 = uVar9 - 1;
  local_c = iVar4;
  if (iVar4 < param_4) {
    while( true ) {
      if (((puVar2[(int)uVar9 >> 5] & 1 << (sbyte)(uVar9 & 0x1f)) != 0) || ((uVar9 & 0x1f) == 0))
      break;
      uVar9 = uVar9 + 1;
    }
    uVar1 = puVar2[(int)uVar9 >> 5];
    if ((uVar1 & 1 << ((byte)uVar9 & 0x1f)) == 0) {
      while (uVar1 == 0) {
        uVar9 = uVar9 + 0x20;
        uVar1 = puVar2[(int)uVar9 >> 5];
      }
      while ((puVar2[(int)uVar9 >> 5] & 1 << ((byte)uVar9 & 0x1f)) == 0) {
        uVar9 = uVar9 + 1;
      }
    }
    uVar9 = uVar9 - 1;
    if (param_4 <= (int)uVar9) goto LAB_676713eb;
    if (iVar4 < (int)uVar9) {
      local_8 = local_8 + 1 + (uVar9 - iVar4);
      FUN_6767147e(param_1,param_2,iVar4,uVar9);
      iVar6 = -1;
      if (iVar4 <= (int)uVar9) {
        piVar5 = param_1 + iVar4;
        do {
          local_10 = *(int *)(param_2 + *piVar5 * 4);
          if (iVar6 != local_10) {
            puVar2[iVar4 >> 5] = puVar2[iVar4 >> 5] | 1 << ((byte)iVar4 & 0x1f);
            iVar6 = local_10;
          }
          iVar4 = iVar4 + 1;
          piVar5 = piVar5 + 1;
        } while (iVar4 <= (int)uVar9);
      }
    }
    goto LAB_676712a2;
  }
LAB_676713eb:
  if (3 < param_5) {
    FUN_676afdac((int *)&DAT_676c2138,(byte *)s__6d_unresolved_strings_676bf10c);
  }
  uVar10 = (undefined1)unaff_EBX;
  param_3 = (undefined4 *)((int)param_3 * 2);
  if ((param_4 < (int)param_3) || (local_8 == 0)) {
    if (3 < param_5) {
      FUN_676afdac((int *)&DAT_676c2138,(byte *)s_reconstructing_block_____676bf0e8);
    }
    iVar4 = 0;
    if (0 < param_4) {
      do {
        for (piVar5 = local_814 + iVar4; *piVar5 == 0; piVar5 = piVar5 + 1) {
          iVar4 = iVar4 + 1;
        }
        iVar6 = *param_1;
        local_814[iVar4] = local_814[iVar4] + -1;
        param_1 = param_1 + 1;
        param_4 = param_4 + -1;
        *(char *)(iVar6 + param_2) = (char)iVar4;
      } while (param_4 != 0);
      if (0xff < iVar4) {
        FUN_6767268b(0x3ed,unaff_EDI,unaff_ESI,uVar10);
      }
    }
    return;
  }
  goto LAB_67671242;
}



// Function: FUN_6767147e at 6767147e

void __cdecl FUN_6767147e(int *param_1,int param_2,int param_3,int param_4)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  int *piVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  undefined4 unaff_EBX;
  int *piVar10;
  int iVar11;
  int unaff_ESI;
  int unaff_EDI;
  int *piVar12;
  int local_340 [99];
  int local_1b4;
  int local_1b0 [99];
  uint local_24;
  int *local_20;
  int local_1c;
  int local_18;
  int local_14;
  int local_10;
  int local_c;
  int *local_8;
  
  piVar4 = param_1;
  local_24 = 0;
  local_1b4 = param_4;
  param_4 = 1;
  param_1 = local_340;
  piVar10 = local_1b0;
LAB_676714be:
  if (99 < param_4) {
    FUN_6767268b(0x3ec,unaff_EDI,unaff_ESI,(char)unaff_EBX);
  }
  iVar1 = param_1[-1];
  local_8 = piVar10 + -1;
  piVar12 = param_1 + -1;
  local_c = *local_8;
  local_1c = iVar1;
  iVar7 = param_4 + -1;
  if (9 < local_c - iVar1) {
    local_24 = local_24 * 0x1dc5 + 1 & 0x7fff;
    uVar9 = local_24 % 3;
    if (uVar9 == 0) {
      iVar8 = piVar4[iVar1];
    }
    else if (uVar9 == 1) {
      iVar8 = piVar4[local_c + iVar1 >> 1];
    }
    else {
      iVar8 = piVar4[local_c];
    }
    local_14 = iVar1;
    local_10 = local_c;
    local_18 = *(int *)(param_2 + iVar8 * 4);
    iVar8 = local_c;
    iVar11 = local_c;
    param_3 = iVar1;
LAB_6767154d:
    local_20 = piVar4 + local_14;
    piVar5 = piVar4 + param_3;
    do {
      piVar6 = local_20;
      if (iVar8 < param_3) goto LAB_676715e7;
      iVar2 = *piVar5;
      iVar3 = *(int *)(param_2 + iVar2 * 4);
      if (iVar3 == local_18) {
        local_14 = local_14 + 1;
        *piVar5 = *local_20;
        local_20 = local_20 + 1;
        *piVar6 = iVar2;
      }
      else if (iVar3 != local_18 && -1 < iVar3 - local_18) goto code_r0x67671591;
      param_3 = param_3 + 1;
      piVar5 = piVar5 + 1;
    } while( true );
  }
  FUN_676716e5((int)piVar4,param_2,iVar1,local_c);
  goto LAB_676716d6;
code_r0x67671591:
  piVar5 = piVar4 + local_10;
  piVar6 = piVar4 + iVar8;
  do {
    iVar11 = local_c;
    if (iVar8 < param_3) goto LAB_676715e7;
    iVar11 = *piVar6;
    iVar2 = *(int *)(param_2 + iVar11 * 4);
    if (iVar2 == local_18) {
      local_10 = local_10 + -1;
      *piVar6 = *piVar5;
      *piVar5 = iVar11;
      piVar5 = piVar5 + -1;
    }
    else if (iVar2 - local_18 < 0) break;
    iVar8 = iVar8 + -1;
    piVar6 = piVar6 + -1;
  } while( true );
  iVar11 = local_c;
  if (iVar8 < param_3) goto LAB_676715e7;
  iVar11 = piVar4[param_3];
  piVar4[param_3] = piVar4[iVar8];
  piVar4[iVar8] = iVar11;
  iVar8 = iVar8 + -1;
  iVar11 = local_c;
  param_3 = param_3 + 1;
  goto LAB_6767154d;
LAB_676715e7:
  if (local_14 <= local_10) {
    local_18 = param_3 - local_14;
    iVar7 = local_18;
    if (local_14 - iVar1 < local_18) {
      iVar7 = local_14 - iVar1;
    }
    if (0 < iVar7) {
      piVar5 = piVar4 + iVar1;
      piVar6 = piVar4 + (param_3 - iVar7);
      local_c = iVar7;
      do {
        local_14 = *piVar5;
        *piVar5 = *piVar6;
        *piVar6 = local_14;
        piVar5 = piVar5 + 1;
        piVar6 = piVar6 + 1;
        local_c = local_c + -1;
      } while (local_c != 0);
    }
    iVar7 = local_10 - iVar8;
    if (iVar11 - local_10 < local_10 - iVar8) {
      iVar7 = iVar11 - local_10;
    }
    if (0 < iVar7) {
      piVar5 = piVar4 + param_3;
      piVar6 = piVar4 + (iVar11 - iVar7) + 1;
      param_3 = iVar7;
      do {
        local_c = *piVar5;
        *piVar5 = *piVar6;
        *piVar6 = local_c;
        piVar5 = piVar5 + 1;
        piVar6 = piVar6 + 1;
        param_3 = param_3 + -1;
      } while (param_3 != 0);
    }
    iVar7 = local_18 + -1 + iVar1;
    iVar8 = (iVar8 - local_10) + 1 + iVar11;
    if (iVar11 - iVar8 < iVar7 - iVar1) {
      *local_8 = iVar7;
      *piVar10 = iVar11;
      *param_1 = iVar8;
      local_8 = piVar10 + 1;
      piVar12 = param_1 + 1;
      iVar7 = param_4 + 1;
    }
    else {
      *piVar12 = iVar8;
      piVar10 = local_8 + 1;
      *param_1 = iVar1;
      local_8 = local_8 + 2;
      *piVar10 = iVar7;
      piVar12 = param_1 + 1;
      iVar7 = param_4 + 1;
    }
  }
LAB_676716d6:
  param_4 = iVar7;
  param_1 = piVar12;
  piVar10 = local_8;
  if (param_4 < 1) {
    return;
  }
  goto LAB_676714be;
}



// Function: FUN_676716e5 at 676716e5

void __cdecl FUN_676716e5(int param_1,int param_2,int param_3,int param_4)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  int *piVar7;
  
  if (param_3 != param_4) {
    if ((3 < param_4 - param_3) && (iVar6 = param_4 + -4, param_3 <= iVar6)) {
      piVar7 = (int *)(param_1 + iVar6 * 4);
      do {
        iVar1 = *piVar7;
        uVar2 = *(uint *)(param_2 + iVar1 * 4);
        piVar5 = piVar7;
        iVar4 = iVar6;
        while (iVar4 = iVar4 + 4, iVar4 <= param_4) {
          iVar3 = piVar5[4];
          if (uVar2 <= *(uint *)(param_2 + iVar3 * 4)) break;
          *piVar5 = iVar3;
          piVar5 = piVar5 + 4;
        }
        iVar6 = iVar6 + -1;
        piVar7 = piVar7 + -1;
        *(int *)(param_1 + -0x10 + iVar4 * 4) = iVar1;
      } while (param_3 <= iVar6);
    }
    iVar6 = param_4 + -1;
    if (param_3 <= iVar6) {
      piVar7 = (int *)(param_1 + iVar6 * 4);
      do {
        iVar1 = *piVar7;
        uVar2 = *(uint *)(param_2 + iVar1 * 4);
        piVar5 = piVar7;
        iVar4 = iVar6;
        while (iVar4 = iVar4 + 1, iVar4 <= param_4) {
          iVar3 = piVar5[1];
          if (uVar2 <= *(uint *)(param_2 + iVar3 * 4)) break;
          *piVar5 = iVar3;
          piVar5 = piVar5 + 1;
        }
        iVar6 = iVar6 + -1;
        piVar7 = piVar7 + -1;
        *(int *)(param_1 + -4 + iVar4 * 4) = iVar1;
      } while (param_3 <= iVar6);
    }
  }
  return;
}



// Function: FUN_676717bc at 676717bc

void __cdecl
FUN_676717bc(int param_1,byte *param_2,int param_3,uint *param_4,uint param_5,int param_6,
            int *param_7)

{
  byte *pbVar1;
  byte bVar2;
  byte bVar3;
  uint uVar4;
  ushort uVar5;
  byte *pbVar6;
  uint *puVar7;
  int iVar8;
  uint *puVar9;
  int iVar10;
  uint *puVar11;
  int iVar12;
  uint uVar13;
  undefined2 *puVar14;
  int *piVar15;
  undefined2 uVar16;
  undefined4 unaff_EBX;
  int unaff_ESI;
  int unaff_EDI;
  char *pcVar17;
  int aiStack_d30 [256];
  uint auStack_930 [256];
  int local_530 [256];
  char local_130 [256];
  char *local_30;
  uint *local_2c;
  uint *local_28;
  int *local_24;
  uint *local_20;
  uint *local_1c;
  uint *local_18;
  int *local_14;
  byte *local_10;
  uint *local_c;
  uint *local_8;
  
  puVar7 = param_4;
  pbVar6 = param_2;
  if (3 < param_6) {
    FUN_676afdac((int *)&DAT_676c2138,(byte *)s_main_sort_initialise_____676bf1b4);
  }
  iVar12 = 0x10001;
  puVar11 = param_4 + 0x10000;
  do {
    *puVar11 = 0;
    puVar11 = puVar11 + -1;
    iVar12 = iVar12 + -1;
  } while (iVar12 != 0);
  uVar13 = (uint)*param_2 << 8;
  iVar12 = param_5 - 1;
  iVar8 = iVar12;
  if (2 < iVar12) {
    iVar10 = iVar12;
    puVar14 = (undefined2 *)(param_3 + -4 + iVar12 * 2);
    do {
      puVar14[2] = 0;
      iVar8 = iVar10 + -4;
      uVar13 = (int)uVar13 >> 8 | (uint)param_2[iVar10] << 8;
      param_4[uVar13] = param_4[uVar13] + 1;
      puVar14[1] = 0;
      uVar13 = (int)uVar13 >> 8 | (uint)param_2[iVar10 + -1] << 8;
      param_4[uVar13] = param_4[uVar13] + 1;
      *puVar14 = 0;
      uVar13 = (int)uVar13 >> 8 | (uint)param_2[iVar10 + -2] << 8;
      param_4[uVar13] = param_4[uVar13] + 1;
      puVar14[-1] = 0;
      uVar13 = (int)uVar13 >> 8 | (uint)param_2[iVar10 + -3] << 8;
      param_4[uVar13] = param_4[uVar13] + 1;
      iVar10 = iVar8;
      puVar14 = puVar14 + -4;
    } while (2 < iVar8);
  }
  if (-1 < iVar8) {
    param_4 = (uint *)(param_3 + iVar8 * 2);
    do {
      *(undefined2 *)param_4 = 0;
      uVar13 = (int)uVar13 >> 8 | (uint)param_2[iVar8] << 8;
      puVar7[uVar13] = puVar7[uVar13] + 1;
      iVar8 = iVar8 + -1;
      param_4 = (uint *)((int)param_4 + -2);
    } while (-1 < iVar8);
  }
  iVar8 = 0;
  puVar14 = (undefined2 *)(param_3 + param_5 * 2);
  do {
    param_2[iVar8 + param_5] = param_2[iVar8];
    *puVar14 = 0;
    iVar8 = iVar8 + 1;
    puVar14 = puVar14 + 1;
  } while (iVar8 < 0x22);
  if (3 < param_6) {
    FUN_676afdac((int *)&DAT_676c2138,(byte *)s_bucket_sorting_____676bf13c);
  }
  iVar8 = 0x10000;
  puVar11 = puVar7;
  do {
    puVar9 = puVar11 + 1;
    *puVar9 = *puVar9 + *puVar11;
    iVar8 = iVar8 + -1;
    puVar11 = puVar9;
  } while (iVar8 != 0);
  param_4 = (uint *)((uint)*param_2 << 8);
  for (; 2 < iVar12; iVar12 = iVar12 + -4) {
    bVar2 = param_2[iVar12];
    uVar5 = CONCAT11(bVar2,param_4._1_1_);
    uVar13 = puVar7[uVar5];
    puVar7[uVar5] = uVar13 - 1;
    *(int *)(param_1 + (uVar13 - 1) * 4) = iVar12;
    bVar3 = param_2[iVar12 + -1];
    uVar5 = CONCAT11(bVar3,bVar2);
    uVar13 = puVar7[uVar5];
    puVar7[uVar5] = uVar13 - 1;
    *(int *)(param_1 + (uVar13 - 1) * 4) = iVar12 + -1;
    bVar2 = param_2[iVar12 + -2];
    uVar5 = CONCAT11(bVar2,bVar3);
    uVar13 = puVar7[uVar5];
    puVar7[uVar5] = uVar13 - 1;
    *(int *)(param_1 + (uVar13 - 1) * 4) = iVar12 + -2;
    param_4 = (uint *)(uint)CONCAT11(param_2[iVar12 + -3],bVar2);
    uVar13 = puVar7[(int)param_4];
    puVar7[(int)param_4] = uVar13 - 1;
    *(int *)(param_1 + (uVar13 - 1) * 4) = iVar12 + -3;
  }
  for (; -1 < iVar12; iVar12 = iVar12 + -1) {
    param_4._1_1_ = (undefined1)((uint)param_4 >> 8);
    param_4 = (uint *)(uint)CONCAT11(param_2[iVar12],param_4._1_1_);
    uVar13 = puVar7[(int)param_4];
    puVar7[(int)param_4] = uVar13 - 1;
    *(int *)(param_1 + (uVar13 - 1) * 4) = iVar12;
  }
  param_2 = (byte *)0x0;
  piVar15 = local_530;
  pcVar17 = local_130;
  for (iVar12 = 0x40; iVar12 != 0; iVar12 = iVar12 + -1) {
    pcVar17[0] = '\0';
    pcVar17[1] = '\0';
    pcVar17[2] = '\0';
    pcVar17[3] = '\0';
    pcVar17 = pcVar17 + 4;
  }
  do {
    pbVar1 = param_2 + 1;
    *piVar15 = (int)param_2;
    piVar15 = piVar15 + 1;
    param_2 = pbVar1;
  } while ((int)pbVar1 < 0x100);
  local_10 = (byte *)0x1;
  do {
    local_10 = (byte *)((int)local_10 * 3 + 1);
  } while ((int)local_10 < 0x101);
  do {
    local_10 = (byte *)((int)local_10 / 3);
    if ((int)local_10 < 0x100) {
      local_8 = (uint *)((int)local_10 << 2);
      param_2 = local_10;
      do {
        param_4 = (uint *)param_2;
        iVar12 = *(int *)((int)local_530 + (int)local_8);
        local_18 = local_8;
        local_1c = local_8 + -(int)local_10;
        uVar13 = puVar7[(iVar12 + 1) * 0x100];
        uVar4 = puVar7[iVar12 * 0x100];
        if (uVar13 - uVar4 <
            puVar7[(*(int *)((int)local_530 + (int)(local_8 + -(int)local_10)) + 1) * 0x100] -
            puVar7[*(int *)((int)local_530 + (int)(local_8 + -(int)local_10)) * 0x100]) {
          local_c = local_8;
          do {
            *(undefined4 *)((int)local_530 + (int)local_c) =
                 *(undefined4 *)((int)local_530 + (int)(local_c + -(int)local_10));
            param_4 = (uint *)((int)param_4 - (int)local_10);
            local_c = local_c + -(int)local_10;
            if ((int)param_4 <= (int)(local_10 + -1)) break;
            local_1c = local_c + -(int)local_10;
          } while (uVar13 - uVar4 <
                   puVar7[(*(int *)((int)local_530 + (int)(local_c + -(int)local_10)) + 1) * 0x100]
                   - puVar7[*(int *)((int)local_530 + (int)(local_c + -(int)local_10)) * 0x100]);
        }
        puVar11 = local_8 + 1;
        local_8 = puVar11;
        param_2 = param_2 + 1;
        local_530[(int)param_4] = iVar12;
      } while ((int)puVar11 < 0x3fd);
    }
    if (local_10 == (byte *)0x1) {
      local_10 = (byte *)0x0;
      param_2 = (byte *)0x0;
      local_c = (uint *)local_530;
      do {
        param_4 = (uint *)0x0;
        do {
          if (param_4 != (uint *)*local_c) {
            puVar11 = param_4 + (int)*local_c * 0x40;
            local_18 = puVar7 + (int)puVar11;
            if ((puVar7[(int)puVar11] & 0x200000) == 0) {
              local_8 = (uint *)(puVar7[(int)puVar11] & 0xffdfffff);
              iVar12 = (puVar7[(int)puVar11 + 1] & 0xffdfffff) - 1;
              if ((int)local_8 < iVar12) {
                if (3 < param_6) {
                  FUN_676afdac((int *)&DAT_676c2138,
                               (byte *)s_qsort__0x_x__0x_x__done__d_this___676bf184);
                }
                FUN_67671df4(param_1,(uint)pbVar6,param_3,param_5,local_8,iVar12,2,param_7);
                local_10 = (byte *)((int)local_10 + 1 + (iVar12 - (int)local_8));
                if (*param_7 < 0) {
                  return;
                }
              }
            }
            *(byte *)((int)local_18 + 2) = *(byte *)((int)local_18 + 2) | 0x20;
          }
          param_4 = (uint *)((int)param_4 + 1);
        } while ((int)param_4 < 0x100);
        local_30 = local_130 + *local_c;
        if (local_130[*local_c] != '\0') {
          FUN_6767268b(0x3ee,unaff_EDI,unaff_ESI,(char)unaff_EBX);
        }
        iVar12 = *local_c;
        piVar15 = (int *)(iVar12 * 4);
        local_24 = piVar15;
        local_28 = (uint *)((int)piVar15 + (int)puVar7);
        iVar8 = 0;
        param_4 = (uint *)((int)piVar15 + (int)puVar7);
        do {
          iVar10 = iVar8 + 4;
          *(uint *)((int)auStack_930 + iVar8) = *param_4 & 0xffdfffff;
          *(uint *)((int)aiStack_d30 + iVar8) = (param_4[1] & 0xffdfffff) - 1;
          iVar8 = iVar10;
          param_4 = param_4 + 0x100;
        } while (iVar10 < 0x3fd);
        local_18 = auStack_930 + iVar12;
        local_2c = puVar7 + *local_c * 0x100;
        uVar13 = puVar7[*local_c * 0x100] & 0xffdfffff;
        if ((int)uVar13 < (int)auStack_930[iVar12]) {
          local_14 = (int *)(param_1 + uVar13 * 4);
          do {
            local_8 = (uint *)(*local_14 + -1);
            if ((int)local_8 < 0) {
              local_8 = (uint *)((int)local_8 + param_5);
            }
            if (local_130[*(byte *)((int)local_8 + (int)pbVar6)] == '\0') {
              local_20 = auStack_930 + *(byte *)((int)local_8 + (int)pbVar6);
              uVar4 = *local_20;
              *(uint **)(param_1 + uVar4 * 4) = local_8;
              *local_20 = uVar4 + 1;
              piVar15 = local_24;
            }
            local_14 = local_14 + 1;
            uVar13 = uVar13 + 1;
          } while ((int)uVar13 < (int)*local_18);
        }
        puVar11 = (uint *)((int)aiStack_d30 + (int)piVar15);
        local_20 = puVar11;
        local_1c = puVar7 + (*local_c + 1) * 0x100;
        iVar12 = (puVar7[(*local_c + 1) * 0x100] & 0xffdfffff) - 1;
        if ((int)*puVar11 < iVar12) {
          local_14 = (int *)(param_1 + iVar12 * 4);
          do {
            local_8 = (uint *)(*local_14 + -1);
            if ((int)local_8 < 0) {
              local_8 = (uint *)((int)local_8 + param_5);
            }
            if (local_130[*(byte *)((int)local_8 + (int)pbVar6)] == '\0') {
              local_24 = aiStack_d30 + *(byte *)((int)local_8 + (int)pbVar6);
              iVar8 = *local_24;
              *(uint **)(param_1 + iVar8 * 4) = local_8;
              *local_24 = iVar8 + -1;
              puVar11 = local_20;
            }
            local_14 = local_14 + -1;
            iVar12 = iVar12 + -1;
          } while ((int)*puVar11 < iVar12);
        }
        if (*local_18 - 1 != *puVar11) {
          FUN_6767268b(0x3ef,unaff_EDI,unaff_ESI,(char)unaff_EBX);
        }
        iVar12 = 0x100;
        puVar11 = local_28;
        do {
          *(byte *)((int)puVar11 + 2) = *(byte *)((int)puVar11 + 2) | 0x20;
          puVar11 = puVar11 + 0x100;
          iVar12 = iVar12 + -1;
        } while (iVar12 != 0);
        *local_30 = '\x01';
        if ((int)param_2 < 0xff) {
          local_8 = (uint *)0x0;
          iVar8 = (*local_1c & 0xffdfffff) - (*local_2c & 0xffdfffff);
          iVar12 = iVar8;
          while (0xfffe < iVar12) {
            local_8 = (uint *)((int)local_8 + 1);
            iVar12 = iVar8 >> ((byte)local_8 & 0x1f);
          }
          local_1c = (uint *)(iVar8 + -1);
          if (-1 < (int)local_1c) {
            piVar15 = (int *)(param_1 + ((*local_2c & 0xffdfffff) + (int)local_1c) * 4);
            param_4 = local_1c;
            do {
              iVar12 = *piVar15;
              uVar16 = (undefined2)((int)param_4 >> ((byte)local_8 & 0x1f));
              *(undefined2 *)(param_3 + iVar12 * 2) = uVar16;
              if (iVar12 < 0x22) {
                *(undefined2 *)(param_3 + (iVar12 + param_5) * 2) = uVar16;
              }
              param_4 = (uint *)((int)param_4 + -1);
              piVar15 = piVar15 + -1;
            } while (-1 < (int)param_4);
          }
          if (0xffff < (int)local_1c >> ((byte)local_8 & 0x1f)) {
            FUN_6767268b(0x3ea,unaff_EDI,unaff_ESI,(char)unaff_EBX);
          }
        }
        param_2 = param_2 + 1;
        local_c = local_c + 1;
      } while ((int)param_2 < 0x100);
      if (3 < param_6) {
        FUN_676afdac((int *)&DAT_676c2138,(byte *)s__d_pointers___d_sorted___d_scann_676bf158);
      }
      return;
    }
  } while( true );
}



// Function: FUN_67671df4 at 67671df4

void __cdecl
FUN_67671df4(int param_1,uint param_2,int param_3,uint param_4,int *param_5,int param_6,int param_7,
            int *param_8)

{
  int iVar1;
  int iVar2;
  byte bVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  int *piVar7;
  int iVar8;
  int *piVar9;
  undefined4 unaff_EBX;
  uint uVar10;
  int *piVar11;
  int unaff_ESI;
  uint *puVar12;
  int unaff_EDI;
  int iVar13;
  uint local_4fc [99];
  int local_370;
  int local_36c [99];
  int local_1e0;
  int local_1dc [99];
  int *local_50;
  uint local_4c;
  uint local_48;
  uint local_44;
  int local_40;
  int local_3c;
  int local_38;
  int local_34;
  int local_30;
  int local_2c;
  uint local_28;
  uint local_24;
  int *local_20;
  uint *local_1c;
  uint local_18;
  int *local_14;
  int local_10;
  int *local_c;
  int *local_8;
  
  local_1e0 = param_6;
  local_370 = param_7;
  param_6 = 1;
  piVar9 = local_36c;
  puVar12 = local_4fc;
  piVar7 = local_1dc;
LAB_67671e3c:
  if (99 < param_6) {
    FUN_6767268b(0x3e9,unaff_EDI,unaff_ESI,(char)unaff_EBX);
  }
  local_24 = puVar12[-1];
  local_20 = piVar7 + -1;
  piVar11 = piVar9 + -1;
  iVar8 = piVar7[-1];
  local_1c = puVar12 + -1;
  iVar2 = *piVar11;
  local_50 = piVar11;
  if ((0x13 < (int)(iVar8 - local_24)) && (iVar2 < 0xf)) {
    local_14 = (int *)(param_1 + local_24 * 4);
    bVar3 = FUN_67672668(*(byte *)(param_2 + iVar2 + *local_14),
                         *(byte *)(*(int *)(param_1 + iVar8 * 4) + iVar2 + param_2),
                         *(byte *)(*(int *)(param_1 + ((int)(local_24 + iVar8) >> 1) * 4) + iVar2 +
                                  param_2));
    local_28 = (uint)bVar3;
    local_18 = local_24;
    param_5 = (int *)local_24;
    iVar4 = iVar8;
    param_7 = iVar8;
LAB_67671ecb:
    local_c = (int *)(param_1 + local_18 * 4);
    local_8 = (int *)(param_1 + (int)param_5 * 4);
    do {
      piVar7 = local_c;
      if (iVar4 < (int)param_5) goto LAB_67671fa2;
      local_10 = *local_8;
      uVar6 = (uint)*(byte *)(local_10 + iVar2 + param_2);
      if (uVar6 == local_28) {
        local_18 = local_18 + 1;
        *local_8 = *local_c;
        local_c = local_c + 1;
        *piVar7 = local_10;
      }
      else if (uVar6 != local_28 && -1 < (int)(uVar6 - local_28)) goto code_r0x67671f25;
      param_5 = (int *)((int)param_5 + 1);
      local_8 = local_8 + 1;
    } while( true );
  }
  FUN_67672178(param_1,param_2,param_3,param_4,local_24,iVar8,iVar2,param_8);
  param_6 = param_6 + -1;
  if (*param_8 < 0) {
    return;
  }
  goto LAB_67672169;
code_r0x67671f25:
  local_c = (int *)(param_1 + param_7 * 4);
  local_8 = (int *)(param_1 + iVar4 * 4);
  do {
    piVar7 = local_c;
    if (iVar4 < (int)param_5) goto LAB_67671fa2;
    local_10 = *local_8;
    uVar6 = (uint)*(byte *)(local_10 + iVar2 + param_2);
    if (uVar6 == local_28) {
      param_7 = param_7 + -1;
      *local_8 = *local_c;
      local_c = local_c + -1;
      *piVar7 = local_10;
    }
    else if ((int)(uVar6 - local_28) < 0) break;
    iVar4 = iVar4 + -1;
    local_8 = local_8 + -1;
  } while( true );
  if (iVar4 < (int)param_5) goto LAB_67671fa2;
  piVar7 = (int *)(param_1 + (int)param_5 * 4);
  local_10 = *piVar7;
  *piVar7 = *(int *)(param_1 + iVar4 * 4);
  *(int *)(param_1 + iVar4 * 4) = local_10;
  iVar4 = iVar4 + -1;
  param_5 = (int *)((int)param_5 + 1);
  goto LAB_67671ecb;
LAB_67671fa2:
  if (param_7 < (int)local_18) {
    local_1c = local_1c + 1;
    local_20 = local_20 + 1;
    *piVar11 = iVar2 + 1;
    piVar11 = piVar9;
  }
  else {
    uVar6 = (int)param_5 - local_18;
    local_28 = local_18 - local_24;
    local_18 = uVar6;
    if ((int)uVar6 <= (int)local_28) {
      local_28 = uVar6;
    }
    if (0 < (int)local_28) {
      piVar9 = (int *)(param_1 + ((int)param_5 - local_28) * 4);
      piVar7 = local_14;
      local_14 = (int *)local_28;
      do {
        local_10 = *piVar7;
        *piVar7 = *piVar9;
        *piVar9 = local_10;
        piVar7 = piVar7 + 1;
        piVar9 = piVar9 + 1;
        local_14 = (int *)((int)local_14 - 1);
      } while (local_14 != (int *)0x0);
    }
    local_14 = (int *)(param_7 - iVar4);
    if (iVar8 - param_7 < param_7 - iVar4) {
      local_14 = (int *)(iVar8 - param_7);
    }
    if (0 < (int)local_14) {
      piVar9 = (int *)(param_1 + (int)param_5 * 4);
      piVar7 = (int *)(param_1 + 4 + (iVar8 - (int)local_14) * 4);
      param_5 = local_14;
      do {
        local_10 = *piVar9;
        *piVar9 = *piVar7;
        *piVar7 = local_10;
        piVar9 = piVar9 + 1;
        piVar7 = piVar7 + 1;
        param_5 = (int *)((int)param_5 + -1);
      } while (param_5 != (int *)0x0);
    }
    local_4c = local_24;
    iVar1 = (uVar6 - 1) + local_24;
    local_34 = iVar2;
    local_40 = iVar1;
    local_48 = (iVar4 - param_7) + 1 + iVar8;
    uVar6 = iVar1 + 1;
    local_44 = uVar6;
    iVar4 = local_48 - 1;
    local_38 = iVar4;
    local_2c = iVar2 + 1;
    local_3c = iVar8;
    local_30 = iVar2;
    uVar5 = local_48;
    uVar10 = local_24;
    if ((int)(iVar1 - local_24) < (int)(iVar8 - local_48)) {
      local_40 = iVar8;
      uVar5 = local_24;
      iVar8 = iVar1;
      uVar10 = local_48;
    }
    iVar1 = local_40;
    if ((int)(iVar8 - uVar5) < (int)(iVar4 - uVar6)) {
      local_44 = uVar5;
      local_38 = iVar8;
      local_2c = iVar2;
      local_30 = iVar2 + 1;
      uVar5 = uVar6;
      iVar8 = iVar4;
    }
    iVar4 = local_30;
    uVar6 = uVar5;
    iVar13 = iVar2;
    if ((int)(local_40 - uVar10) < (int)(iVar8 - uVar5)) {
      local_40 = iVar8;
      local_30 = iVar2;
      uVar6 = uVar10;
      iVar8 = iVar1;
      uVar10 = uVar5;
      iVar13 = iVar4;
    }
    *local_1c = uVar10;
    *local_20 = local_40;
    piVar11 = local_50;
    *local_50 = iVar13;
    local_1c[1] = uVar6;
    piVar11[1] = local_30;
    local_20[1] = iVar8;
    local_1c[2] = local_44;
    local_20[2] = local_38;
    piVar11[2] = local_2c;
    local_1c = local_1c + 3;
    local_20 = local_20 + 3;
    piVar11 = piVar11 + 3;
    param_6 = param_6 + 2;
  }
LAB_67672169:
  piVar9 = piVar11;
  puVar12 = local_1c;
  piVar7 = local_20;
  if (param_6 < 1) {
    return;
  }
  goto LAB_67671e3c;
}



// Function: FUN_67672178 at 67672178

void __cdecl
FUN_67672178(int param_1,uint param_2,int param_3,uint param_4,int param_5,int param_6,int param_7,
            int *param_8)

{
  int iVar1;
  int iVar2;
  char cVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  int *piVar8;
  int iVar9;
  int iVar10;
  int local_14;
  int local_c;
  
  iVar2 = param_7;
  iVar4 = (param_6 - param_5) + 1;
  if (1 < iVar4) {
    local_14 = 0;
    if (DAT_676bf050 < iVar4) {
      piVar8 = &DAT_676bf050;
      do {
        piVar8 = piVar8 + 1;
        local_14 = local_14 + 1;
      } while (*piVar8 < iVar4);
    }
    local_14 = local_14 + -1;
    if (-1 < local_14) {
      piVar8 = &DAT_676bf050 + local_14;
      do {
        iVar4 = *piVar8;
        iVar5 = param_5 + iVar4;
        iVar10 = iVar5 * 4;
        local_c = iVar5;
        while (local_c <= param_6) {
          iVar9 = *(int *)(iVar10 + param_1);
          uVar6 = FUN_676723e9((ushort *)(*(int *)(iVar10 + iVar4 * -4 + param_1) + iVar2),
                               iVar9 + iVar2,param_2,param_3,param_4,param_8);
          cVar3 = (char)uVar6;
          iVar7 = iVar10;
          param_7 = local_c;
          while (cVar3 != '\0') {
            *(undefined4 *)(iVar7 + param_1) = *(undefined4 *)(iVar7 + iVar4 * -4 + param_1);
            param_7 = param_7 - iVar4;
            iVar7 = iVar7 + iVar4 * -4;
            if (param_7 <= iVar5 + -1) break;
            uVar6 = FUN_676723e9((ushort *)(*(int *)(iVar7 + iVar4 * -4 + param_1) + iVar2),
                                 iVar9 + iVar2,param_2,param_3,param_4,param_8);
            cVar3 = (char)uVar6;
          }
          iVar7 = iVar10 + 4;
          *(int *)(param_1 + param_7 * 4) = iVar9;
          param_7 = local_c + 1;
          if (param_6 < param_7) break;
          iVar9 = *(int *)(iVar7 + param_1);
          uVar6 = FUN_676723e9((ushort *)(*(int *)(iVar7 + iVar4 * -4 + param_1) + iVar2),
                               iVar9 + iVar2,param_2,param_3,param_4,param_8);
          cVar3 = (char)uVar6;
          while (cVar3 != '\0') {
            *(undefined4 *)(iVar7 + param_1) = *(undefined4 *)(iVar7 + iVar4 * -4 + param_1);
            param_7 = param_7 - iVar4;
            iVar7 = iVar7 + iVar4 * -4;
            if (param_7 <= iVar5 + -1) break;
            uVar6 = FUN_676723e9((ushort *)(*(int *)(iVar7 + iVar4 * -4 + param_1) + iVar2),
                                 iVar9 + iVar2,param_2,param_3,param_4,param_8);
            cVar3 = (char)uVar6;
          }
          iVar7 = iVar10 + 8;
          *(int *)(param_1 + param_7 * 4) = iVar9;
          iVar9 = local_c + 2;
          if (param_6 < iVar9) break;
          iVar1 = *(int *)(iVar7 + param_1);
          uVar6 = FUN_676723e9((ushort *)(*(int *)(iVar7 + iVar4 * -4 + param_1) + iVar2),
                               iVar1 + iVar2,param_2,param_3,param_4,param_8);
          cVar3 = (char)uVar6;
          while (cVar3 != '\0') {
            *(undefined4 *)(iVar7 + param_1) = *(undefined4 *)(iVar7 + iVar4 * -4 + param_1);
            iVar9 = iVar9 - iVar4;
            iVar7 = iVar7 + iVar4 * -4;
            if (iVar9 <= iVar5 + -1) break;
            uVar6 = FUN_676723e9((ushort *)(*(int *)(iVar7 + iVar4 * -4 + param_1) + iVar2),
                                 iVar1 + iVar2,param_2,param_3,param_4,param_8);
            cVar3 = (char)uVar6;
          }
          local_c = local_c + 3;
          *(int *)(param_1 + iVar9 * 4) = iVar1;
          iVar10 = iVar10 + 0xc;
          if (*param_8 < 0) {
            return;
          }
        }
        local_14 = local_14 + -1;
        piVar8 = piVar8 + -1;
      } while (-1 < local_14);
    }
  }
  return;
}



// Function: FUN_676723e9 at 676723e9

uint __cdecl
FUN_676723e9(ushort *param_1,int param_2,uint param_3,int param_4,uint param_5,int *param_6)

{
  byte bVar1;
  byte bVar2;
  uint uVar3;
  ushort *puVar4;
  ushort *puVar5;
  uint uVar6;
  bool bVar7;
  
  uVar3 = param_3;
  bVar7 = *(byte *)(param_2 + param_3) < *(byte *)((int)param_1 + param_3);
  if (((((((*(byte *)(param_2 + param_3) == *(byte *)((int)param_1 + param_3)) &&
          (bVar1 = *(byte *)((int)param_1 + param_3 + 1), bVar2 = *(byte *)(param_2 + 1 + param_3),
          bVar7 = bVar2 < bVar1, bVar2 == bVar1)) &&
         (bVar1 = *(byte *)((int)param_1 + param_3 + 2), bVar2 = *(byte *)(param_2 + 2 + param_3),
         bVar7 = bVar2 < bVar1, bVar2 == bVar1)) &&
        ((bVar1 = *(byte *)((int)param_1 + param_3 + 3), bVar2 = *(byte *)(param_2 + 3 + param_3),
         bVar7 = bVar2 < bVar1, bVar2 == bVar1 &&
         (bVar1 = *(byte *)((int)param_1 + param_3 + 4), bVar2 = *(byte *)(param_2 + 4 + param_3),
         bVar7 = bVar2 < bVar1, bVar2 == bVar1)))) &&
       ((bVar1 = *(byte *)((int)param_1 + param_3 + 5), bVar2 = *(byte *)(param_2 + 5 + param_3),
        bVar7 = bVar2 < bVar1, bVar2 == bVar1 &&
        ((bVar1 = *(byte *)((int)param_1 + param_3 + 6), bVar2 = *(byte *)(param_2 + 6 + param_3),
         bVar7 = bVar2 < bVar1, bVar2 == bVar1 &&
         (bVar1 = *(byte *)((int)param_1 + param_3 + 7), bVar2 = *(byte *)(param_2 + 7 + param_3),
         bVar7 = bVar2 < bVar1, bVar2 == bVar1)))))) &&
      (bVar1 = *(byte *)((int)param_1 + param_3 + 8), bVar2 = *(byte *)(param_2 + 8 + param_3),
      bVar7 = bVar2 < bVar1, bVar2 == bVar1)) &&
     (((bVar1 = *(byte *)((int)param_1 + param_3 + 9), bVar2 = *(byte *)(param_2 + 9 + param_3),
       bVar7 = bVar2 < bVar1, bVar2 == bVar1 &&
       (bVar1 = *(byte *)((int)param_1 + param_3 + 10), bVar2 = *(byte *)(param_2 + 10 + param_3),
       bVar7 = bVar2 < bVar1, bVar2 == bVar1)) &&
      (bVar1 = *(byte *)((int)param_1 + param_3 + 0xb), bVar2 = *(byte *)(param_2 + 0xb + param_3),
      bVar7 = bVar2 < bVar1, bVar2 == bVar1)))) {
    bVar1 = *(byte *)((int)param_1 + param_3 + 0xc);
    bVar2 = *(byte *)(param_2 + 0xc + param_3);
    puVar5 = param_1 + 6;
    uVar6 = param_2 + 0xc;
    param_3 = param_5 + 8;
    bVar7 = bVar2 < bVar1;
    if (bVar2 == bVar1) {
      puVar4 = (ushort *)(param_4 + uVar6 * 2);
      param_1 = (ushort *)(param_4 + (int)puVar5 * 2);
      while (bVar7 = *puVar4 < *param_1, *puVar4 == *param_1) {
        bVar1 = *(byte *)((int)puVar5 + uVar3 + 1);
        bVar2 = *(byte *)(uVar6 + 1 + uVar3);
        bVar7 = bVar2 < bVar1;
        if ((bVar2 != bVar1) || (bVar7 = puVar4[1] < param_1[1], puVar4[1] != param_1[1])) break;
        bVar1 = *(byte *)((int)puVar5 + uVar3 + 2);
        bVar2 = *(byte *)(uVar6 + 2 + uVar3);
        bVar7 = bVar2 < bVar1;
        if ((bVar2 != bVar1) || (bVar7 = puVar4[2] < param_1[2], puVar4[2] != param_1[2])) break;
        bVar1 = *(byte *)((int)puVar5 + uVar3 + 3);
        bVar2 = *(byte *)(uVar6 + 3 + uVar3);
        bVar7 = bVar2 < bVar1;
        if ((bVar2 != bVar1) || (bVar7 = puVar4[3] < param_1[3], puVar4[3] != param_1[3])) break;
        bVar1 = *(byte *)((int)puVar5 + uVar3 + 4);
        bVar2 = *(byte *)(uVar6 + 4 + uVar3);
        bVar7 = bVar2 < bVar1;
        if ((bVar2 != bVar1) || (bVar7 = puVar4[4] < param_1[4], puVar4[4] != param_1[4])) break;
        bVar1 = *(byte *)((int)puVar5 + uVar3 + 5);
        bVar2 = *(byte *)(uVar6 + 5 + uVar3);
        bVar7 = bVar2 < bVar1;
        if ((bVar2 != bVar1) || (bVar7 = puVar4[5] < param_1[5], puVar4[5] != param_1[5])) break;
        bVar1 = *(byte *)((int)puVar5 + uVar3 + 6);
        bVar2 = *(byte *)(uVar6 + 6 + uVar3);
        bVar7 = bVar2 < bVar1;
        if ((bVar2 != bVar1) || (bVar7 = puVar4[6] < param_1[6], puVar4[6] != param_1[6])) break;
        bVar1 = *(byte *)((int)puVar5 + uVar3 + 7);
        bVar2 = *(byte *)(uVar6 + 7 + uVar3);
        bVar7 = bVar2 < bVar1;
        if ((bVar2 != bVar1) || (bVar7 = puVar4[7] < param_1[7], puVar4[7] != param_1[7])) break;
        param_1 = param_1 + 8;
        puVar5 = puVar5 + 4;
        uVar6 = uVar6 + 8;
        puVar4 = puVar4 + 8;
        if (param_5 <= puVar5) {
          puVar5 = (ushort *)((int)puVar5 - param_5);
          param_1 = param_1 + -param_5;
        }
        if (param_5 <= uVar6) {
          uVar6 = uVar6 - param_5;
          puVar4 = puVar4 + -param_5;
        }
        param_3 = param_3 - 8;
        *param_6 = *param_6 + -1;
        if ((int)param_3 < 0) {
          return uVar3 & 0xffffff00;
        }
        bVar7 = *(byte *)(uVar6 + uVar3) < *(byte *)((int)puVar5 + uVar3);
        if (*(byte *)(uVar6 + uVar3) != *(byte *)((int)puVar5 + uVar3)) break;
      }
    }
  }
  return (uint)bVar7;
}



// Function: FUN_67672668 at 67672668

byte __cdecl FUN_67672668(byte param_1,byte param_2,byte param_3)

{
  byte bVar1;
  
  bVar1 = param_2;
  if (param_2 < param_1) {
    bVar1 = param_1;
    param_1 = param_2;
  }
  if ((param_3 < bVar1) && (bVar1 = param_3, param_3 < param_1)) {
    bVar1 = param_1;
  }
  return bVar1;
}



// Function: FUN_6767268b at 6767268b

undefined4 FUN_6767268b(int param_1,int param_2,int param_3,undefined1 param_4)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int unaff_retaddr;
  undefined4 uVar4;
  
  FUN_67673a6d();
  FUN_676afdac((int *)&DAT_676c2138,(byte *)s_bzip2_libbzip2__internal_error_n_676bf2a4);
  FUN_676affc5(3);
  iVar1 = FUN_67672851();
  if (iVar1 == 0) {
    uVar4 = 0xfffffff7;
  }
  else if ((((unaff_retaddr == 0) || (param_1 < 1)) || (9 < param_1)) ||
          ((param_3 < 0 || (0xfa < param_3)))) {
    uVar4 = 0xfffffffe;
  }
  else {
    if (param_3 == 0) {
      param_3 = 0x1e;
    }
    if (*(int *)(unaff_retaddr + 0x24) == 0) {
      *(code **)(unaff_retaddr + 0x24) = FUN_67672855;
    }
    if (*(int *)(unaff_retaddr + 0x28) == 0) {
      *(code **)(unaff_retaddr + 0x28) = FUN_67672866;
    }
    piVar2 = (int *)(**(code **)(unaff_retaddr + 0x24))
                              (*(undefined4 *)(unaff_retaddr + 0x2c),0xd9b4,1);
    if (piVar2 != (int *)0x0) {
      piVar2[4] = 0;
      piVar2[5] = 0;
      piVar2[6] = 0;
      *piVar2 = unaff_retaddr;
      iVar1 = (**(code **)(unaff_retaddr + 0x24))
                        (*(undefined4 *)(unaff_retaddr + 0x2c),param_1 * 400000,1);
      piVar2[4] = iVar1;
      iVar1 = (**(code **)(unaff_retaddr + 0x24))
                        (*(undefined4 *)(unaff_retaddr + 0x2c),param_1 * 400000 + 0x88,1);
      piVar2[5] = iVar1;
      iVar3 = (**(code **)(unaff_retaddr + 0x24))(*(undefined4 *)(unaff_retaddr + 0x2c),0x40004,1);
      iVar1 = piVar2[4];
      piVar2[6] = iVar3;
      if (iVar1 != 0) {
        if ((piVar2[5] != 0) && (iVar3 != 0)) {
          piVar2[0x9b] = 0;
          piVar2[2] = 2;
          piVar2[1] = 2;
          piVar2[0x99] = 0;
          piVar2[0x9c] = param_1;
          piVar2[0x9a] = param_2;
          piVar2[0xc] = param_3;
          piVar2[0x12] = param_1 * 100000 + -0x13;
          piVar2[9] = piVar2[5];
          piVar2[10] = iVar1;
          piVar2[0xb] = 0;
          piVar2[8] = iVar1;
          *(int **)(unaff_retaddr + 0x20) = piVar2;
          *(undefined4 *)(unaff_retaddr + 8) = 0;
          *(undefined4 *)(unaff_retaddr + 0xc) = 0;
          *(undefined4 *)(unaff_retaddr + 0x18) = 0;
          *(undefined4 *)(unaff_retaddr + 0x1c) = 0;
          FUN_6767289f((int)piVar2);
          FUN_67672878((int)piVar2);
          *(undefined1 *)(piVar2 + 0x366c) = param_4;
          return 0;
        }
        if (iVar1 != 0) {
          (**(code **)(unaff_retaddr + 0x28))(*(undefined4 *)(unaff_retaddr + 0x2c),iVar1);
        }
      }
      if (piVar2[5] != 0) {
        (**(code **)(unaff_retaddr + 0x28))(*(undefined4 *)(unaff_retaddr + 0x2c),piVar2[5]);
      }
      if (piVar2[6] != 0) {
        (**(code **)(unaff_retaddr + 0x28))(*(undefined4 *)(unaff_retaddr + 0x2c),piVar2[6]);
      }
      (**(code **)(unaff_retaddr + 0x28))(*(undefined4 *)(unaff_retaddr + 0x2c),piVar2);
    }
    uVar4 = 0xfffffffd;
  }
  return uVar4;
}



// Function: FUN_676726ae at 676726ae

undefined4 FUN_676726ae(int param_1,int param_2,int param_3,int param_4,undefined1 param_5)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  undefined4 uVar4;
  
  iVar1 = FUN_67672851();
  if (iVar1 == 0) {
    uVar4 = 0xfffffff7;
  }
  else if ((((param_1 == 0) || (param_2 < 1)) || (9 < param_2)) ||
          ((param_4 < 0 || (0xfa < param_4)))) {
    uVar4 = 0xfffffffe;
  }
  else {
    if (param_4 == 0) {
      param_4 = 0x1e;
    }
    if (*(int *)(param_1 + 0x24) == 0) {
      *(code **)(param_1 + 0x24) = FUN_67672855;
    }
    if (*(int *)(param_1 + 0x28) == 0) {
      *(code **)(param_1 + 0x28) = FUN_67672866;
    }
    piVar2 = (int *)(**(code **)(param_1 + 0x24))(*(undefined4 *)(param_1 + 0x2c),0xd9b4,1);
    if (piVar2 != (int *)0x0) {
      piVar2[4] = 0;
      piVar2[5] = 0;
      piVar2[6] = 0;
      *piVar2 = param_1;
      iVar1 = (**(code **)(param_1 + 0x24))(*(undefined4 *)(param_1 + 0x2c),param_2 * 400000,1);
      piVar2[4] = iVar1;
      iVar1 = (**(code **)(param_1 + 0x24))
                        (*(undefined4 *)(param_1 + 0x2c),param_2 * 400000 + 0x88,1);
      piVar2[5] = iVar1;
      iVar3 = (**(code **)(param_1 + 0x24))(*(undefined4 *)(param_1 + 0x2c),0x40004,1);
      iVar1 = piVar2[4];
      piVar2[6] = iVar3;
      if (iVar1 != 0) {
        if ((piVar2[5] != 0) && (iVar3 != 0)) {
          piVar2[0x9b] = 0;
          piVar2[2] = 2;
          piVar2[1] = 2;
          piVar2[0x99] = 0;
          piVar2[0x9c] = param_2;
          piVar2[0x9a] = param_3;
          piVar2[0xc] = param_4;
          piVar2[0x12] = param_2 * 100000 + -0x13;
          piVar2[9] = piVar2[5];
          piVar2[10] = iVar1;
          piVar2[0xb] = 0;
          piVar2[8] = iVar1;
          *(int **)(param_1 + 0x20) = piVar2;
          *(undefined4 *)(param_1 + 8) = 0;
          *(undefined4 *)(param_1 + 0xc) = 0;
          *(undefined4 *)(param_1 + 0x18) = 0;
          *(undefined4 *)(param_1 + 0x1c) = 0;
          FUN_6767289f((int)piVar2);
          FUN_67672878((int)piVar2);
          *(undefined1 *)(piVar2 + 0x366c) = param_5;
          return 0;
        }
        if (iVar1 != 0) {
          (**(code **)(param_1 + 0x28))(*(undefined4 *)(param_1 + 0x2c),iVar1);
        }
      }
      if (piVar2[5] != 0) {
        (**(code **)(param_1 + 0x28))(*(undefined4 *)(param_1 + 0x2c),piVar2[5]);
      }
      if (piVar2[6] != 0) {
        (**(code **)(param_1 + 0x28))(*(undefined4 *)(param_1 + 0x2c),piVar2[6]);
      }
      (**(code **)(param_1 + 0x28))(*(undefined4 *)(param_1 + 0x2c),piVar2);
    }
    uVar4 = 0xfffffffd;
  }
  return uVar4;
}



// Function: FUN_67672851 at 67672851

undefined4 FUN_67672851(void)

{
  return 1;
}



// Function: FUN_67672855 at 67672855

void __cdecl FUN_67672855(undefined4 param_1,int param_2,int param_3)

{
  _malloc(param_2 * param_3);
  return;
}



// Function: FUN_67672866 at 67672866

void __cdecl FUN_67672866(undefined4 param_1,undefined *param_2)

{
  if (param_2 != (undefined *)0x0) {
    FUN_676b0201(param_2);
  }
  return;
}



// Function: FUN_67672878 at 67672878

void __cdecl FUN_67672878(int param_1)

{
  int iVar1;
  undefined4 *puVar2;
  
  *(undefined4 *)(param_1 + 0x260) = 0xffffffff;
  *(undefined4 *)(param_1 + 0x44) = 0;
  *(undefined4 *)(param_1 + 0x4c) = 0;
  *(undefined4 *)(param_1 + 0x50) = 0;
  puVar2 = (undefined4 *)(param_1 + 0x58);
  for (iVar1 = 0x40; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  *(int *)(param_1 + 0x26c) = *(int *)(param_1 + 0x26c) + 1;
  return;
}



// Function: FUN_6767289f at 6767289f

void __cdecl FUN_6767289f(int param_1)

{
  *(undefined4 *)(param_1 + 0x38) = 0;
  *(undefined4 *)(param_1 + 0x34) = 0x100;
  return;
}



// Function: FUN_676728af at 676728af

int FUN_676728af(int param_1,int param_2)

{
  int *piVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  
  if (((param_1 == 0) || (piVar1 = *(int **)(param_1 + 0x20), piVar1 == (int *)0x0)) ||
     (iVar4 = *piVar1, iVar4 != param_1)) {
LAB_676728ba:
    iVar4 = -2;
  }
  else {
    while (iVar2 = piVar1[1], iVar2 != 1) {
      if (iVar2 != 2) {
        if (iVar2 == 3) {
          if ((param_2 == 1) && (piVar1[3] == *(int *)(iVar4 + 4))) {
            FUN_676729ce(param_1);
            if (piVar1[3] != 0) {
              return 2;
            }
            uVar3 = FUN_676729b5((int)piVar1);
            if ((char)uVar3 != '\0') {
              if (piVar1[0x13] <= piVar1[0x14]) {
                piVar1[1] = 2;
                return 1;
              }
              return 2;
            }
            return 2;
          }
        }
        else {
          if (iVar2 != 4) {
            return 0;
          }
          if (((param_2 == 2) && (piVar1[3] == *(int *)(iVar4 + 4))) &&
             (uVar3 = FUN_676729ce(param_1), (char)uVar3 != '\0')) {
            if (((piVar1[3] == 0) && (uVar3 = FUN_676729b5((int)piVar1), (char)uVar3 != '\0')) &&
               (piVar1[0x13] <= piVar1[0x14])) {
              piVar1[1] = 1;
              return 4;
            }
            return 3;
          }
        }
        break;
      }
      if (param_2 == 0) {
        uVar3 = FUN_676729ce(param_1);
        return (-(uint)((char)uVar3 != '\0') & 3) - 2;
      }
      if (param_2 == 1) {
        iVar2 = *(int *)(param_1 + 4);
        piVar1[1] = 3;
        piVar1[3] = iVar2;
      }
      else {
        if (param_2 != 2) goto LAB_676728ba;
        iVar2 = *(int *)(param_1 + 4);
        piVar1[1] = 4;
        piVar1[3] = iVar2;
      }
    }
    iVar4 = -1;
  }
  return iVar4;
}



// Function: FUN_676729b5 at 676729b5

int __cdecl FUN_676729b5(int param_1)

{
  uint3 uVar1;
  
  uVar1 = (uint3)((uint)param_1 >> 8);
  if ((*(uint *)(param_1 + 0x34) < 0x100) && (0 < *(int *)(param_1 + 0x38))) {
    return (uint)uVar1 << 8;
  }
  return CONCAT31(uVar1,1);
}



// Function: FUN_676729ce at 676729ce

undefined4 __cdecl FUN_676729ce(int param_1)

{
  ushort *puVar1;
  ushort uVar2;
  byte bVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uStack_8;
  
  puVar1 = *(ushort **)(param_1 + 0x20);
  uStack_8 = 0;
  uVar5 = 1;
  do {
    while( true ) {
      do {
        if (*(int *)(puVar1 + 4) == 1) {
          bVar3 = FUN_67672d50((int *)puVar1);
          uVar2 = CONCAT11(uStack_8._3_1_,uStack_8._2_1_ | bVar3);
          uStack_8 = (uint)uVar2 << 0x10;
          if ((*(int *)(puVar1 + 0x28) < *(int *)(puVar1 + 0x26)) ||
             (((*(int *)(puVar1 + 2) == 4 && (*(int *)(puVar1 + 6) == 0)) &&
              (uVar4 = FUN_676729b5((int)puVar1), (char)uVar4 != '\0')))) goto LAB_67672a93;
          FUN_67672878((int)puVar1);
          puVar1[4] = 2;
          puVar1[5] = 0;
          if (((*(int *)(puVar1 + 2) == 3) && (*(int *)(puVar1 + 6) == 0)) &&
             (uVar4 = FUN_676729b5((int)puVar1), (char)uVar4 != '\0')) goto LAB_67672a93;
        }
      } while (*(int *)(puVar1 + 4) != 2);
      uVar4 = FUN_67672bab((int *)puVar1);
      uStack_8 = CONCAT13(uStack_8._3_1_ | (byte)uVar4,(undefined3)uStack_8);
      if ((*(int *)(puVar1 + 2) == 2) || (*(int *)(puVar1 + 6) != 0)) break;
      FUN_67672aa8((int)puVar1);
      FUN_67673a86(puVar1,*(int *)(puVar1 + 2) == 4);
LAB_67672a80:
      puVar1[4] = 1;
      puVar1[5] = 0;
    }
    if (*(int *)(puVar1 + 0x24) <= *(int *)(puVar1 + 0x22)) {
      FUN_67673a86(puVar1,'\0');
      goto LAB_67672a80;
    }
    uVar2 = uStack_8._2_2_;
  } while (*(int *)(*(int *)puVar1 + 4) != 0);
LAB_67672a93:
  uStack_8._2_2_ = uVar2;
  if ((uStack_8._3_1_ == '\0') && (uStack_8._2_1_ == '\0')) {
    uVar5 = 0;
  }
  return uVar5;
}



// Function: FUN_67672aa8 at 67672aa8

void __cdecl FUN_67672aa8(int param_1)

{
  if (*(uint *)(param_1 + 0x34) < 0x100) {
    FUN_67672ac6(param_1);
  }
  FUN_6767289f(param_1);
  return;
}



// Function: FUN_67672ac6 at 67672ac6

void __cdecl FUN_67672ac6(int param_1)

{
  int *piVar1;
  byte bVar2;
  int iVar3;
  
  iVar3 = *(int *)(param_1 + 0x38);
  bVar2 = *(byte *)(param_1 + 0x34);
  if (0 < iVar3) {
    do {
      iVar3 = iVar3 + -1;
      *(uint *)(param_1 + 0x260) =
           *(uint *)(&DAT_676bf614 + (*(uint *)(param_1 + 0x260) >> 0x18 ^ (uint)bVar2) * 4) ^
           *(uint *)(param_1 + 0x260) << 8;
    } while (iVar3 != 0);
  }
  *(undefined1 *)(param_1 + 0x58 + *(int *)(param_1 + 0x34)) = 1;
  iVar3 = *(int *)(param_1 + 0x38);
  if (iVar3 == 1) {
    *(byte *)(*(int *)(param_1 + 0x24) + *(int *)(param_1 + 0x44)) = bVar2;
  }
  else {
    if (iVar3 == 2) {
      piVar1 = (int *)(param_1 + 0x44);
      *(byte *)(*(int *)(param_1 + 0x24) + *(int *)(param_1 + 0x44)) = bVar2;
      *piVar1 = *piVar1 + 1;
      *(byte *)(*(int *)(param_1 + 0x24) + *piVar1) = bVar2;
      *piVar1 = *piVar1 + 1;
      return;
    }
    if (iVar3 == 3) {
      *(byte *)(*(int *)(param_1 + 0x24) + *(int *)(param_1 + 0x44)) = bVar2;
      *(int *)(param_1 + 0x44) = *(int *)(param_1 + 0x44) + 1;
      *(byte *)(*(int *)(param_1 + 0x24) + *(int *)(param_1 + 0x44)) = bVar2;
      *(int *)(param_1 + 0x44) = *(int *)(param_1 + 0x44) + 1;
      *(byte *)(*(int *)(param_1 + 0x24) + *(int *)(param_1 + 0x44)) = bVar2;
    }
    else {
      *(undefined1 *)(iVar3 + 0x54 + param_1) = 1;
      *(byte *)(*(int *)(param_1 + 0x24) + *(int *)(param_1 + 0x44)) = bVar2;
      *(int *)(param_1 + 0x44) = *(int *)(param_1 + 0x44) + 1;
      *(byte *)(*(int *)(param_1 + 0x24) + *(int *)(param_1 + 0x44)) = bVar2;
      *(int *)(param_1 + 0x44) = *(int *)(param_1 + 0x44) + 1;
      *(byte *)(*(int *)(param_1 + 0x24) + *(int *)(param_1 + 0x44)) = bVar2;
      *(int *)(param_1 + 0x44) = *(int *)(param_1 + 0x44) + 1;
      *(byte *)(*(int *)(param_1 + 0x24) + *(int *)(param_1 + 0x44)) = bVar2;
      *(int *)(param_1 + 0x44) = *(int *)(param_1 + 0x44) + 1;
      *(char *)(*(int *)(param_1 + 0x24) + *(int *)(param_1 + 0x44)) =
           *(char *)(param_1 + 0x38) + -4;
    }
  }
  *(int *)(param_1 + 0x44) = *(int *)(param_1 + 0x44) + 1;
  return;
}



// Function: FUN_67672bab at 67672bab

undefined4 __cdecl FUN_67672bab(int *param_1)

{
  int *piVar1;
  uint uVar2;
  uint uVar3;
  undefined4 *puVar4;
  uint uVar5;
  undefined1 local_5;
  
  local_5 = 0;
  if (param_1[1] == 2) {
    while ((puVar4 = (undefined4 *)param_1[0x11], (int)puVar4 < param_1[0x12] &&
           (puVar4 = (undefined4 *)*param_1, puVar4[1] != 0))) {
      local_5 = 1;
      uVar5 = (uint)*(byte *)*puVar4;
      uVar2 = param_1[0xd];
      if (uVar5 == uVar2) {
LAB_67672c36:
        if (param_1[0xe] == 0xff) {
LAB_67672c47:
          if (uVar2 < 0x100) {
            FUN_67672ac6((int)param_1);
          }
          param_1[0xd] = uVar5;
          param_1[0xe] = 1;
        }
        else {
          param_1[0xe] = param_1[0xe] + 1;
        }
      }
      else {
        if (param_1[0xe] != 1) {
          if (uVar5 == uVar2) goto LAB_67672c36;
          goto LAB_67672c47;
        }
        uVar3 = param_1[0x98];
        param_1[0x98] = *(uint *)(&DAT_676bf614 + (uVar3 >> 0x18 ^ uVar2 & 0xff) * 4) ^ uVar3 << 8;
        *(undefined1 *)(param_1[0xd] + 0x58 + (int)param_1) = 1;
        *(char *)(param_1[9] + param_1[0x11]) = (char)uVar2;
        param_1[0x11] = param_1[0x11] + 1;
        param_1[0xd] = uVar5;
      }
      *(int *)*param_1 = *(int *)*param_1 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar1 = (int *)(*param_1 + 0xc);
        *piVar1 = *piVar1 + 1;
      }
    }
  }
  else {
    while (((puVar4 = (undefined4 *)param_1[0x11], (int)puVar4 < param_1[0x12] &&
            (puVar4 = (undefined4 *)*param_1, puVar4[1] != 0)) && (param_1[3] != 0))) {
      local_5 = 1;
      uVar5 = (uint)*(byte *)*puVar4;
      uVar2 = param_1[0xd];
      if (uVar5 == uVar2) {
LAB_67672cfe:
        if (param_1[0xe] == 0xff) {
LAB_67672d0f:
          if (uVar2 < 0x100) {
            FUN_67672ac6((int)param_1);
          }
          param_1[0xd] = uVar5;
          param_1[0xe] = 1;
        }
        else {
          param_1[0xe] = param_1[0xe] + 1;
        }
      }
      else {
        if (param_1[0xe] != 1) {
          if (uVar5 == uVar2) goto LAB_67672cfe;
          goto LAB_67672d0f;
        }
        uVar3 = param_1[0x98];
        param_1[0x98] = *(uint *)(&DAT_676bf614 + (uVar3 >> 0x18 ^ uVar2 & 0xff) * 4) ^ uVar3 << 8;
        *(undefined1 *)(param_1[0xd] + 0x58 + (int)param_1) = 1;
        *(char *)(param_1[9] + param_1[0x11]) = (char)uVar2;
        param_1[0x11] = param_1[0x11] + 1;
        param_1[0xd] = uVar5;
      }
      *(int *)*param_1 = *(int *)*param_1 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar1 = (int *)(*param_1 + 0xc);
        *piVar1 = *piVar1 + 1;
      }
      param_1[3] = param_1[3] + -1;
    }
  }
  return CONCAT31((int3)((uint)puVar4 >> 8),local_5);
}



// Function: FUN_67672d50 at 67672d50

undefined1 __cdecl FUN_67672d50(int *param_1)

{
  int *piVar1;
  undefined1 uVar2;
  
  uVar2 = 0;
  while ((*(int *)(*param_1 + 0x14) != 0 && (param_1[0x14] < param_1[0x13]))) {
    uVar2 = 1;
    **(undefined1 **)(*param_1 + 0x10) = *(undefined1 *)(param_1[0xb] + param_1[0x14]);
    param_1[0x14] = param_1[0x14] + 1;
    *(int *)(*param_1 + 0x14) = *(int *)(*param_1 + 0x14) + -1;
    *(int *)(*param_1 + 0x10) = *(int *)(*param_1 + 0x10) + 1;
    *(int *)(*param_1 + 0x18) = *(int *)(*param_1 + 0x18) + 1;
    if (*(int *)(*param_1 + 0x18) == 0) {
      piVar1 = (int *)(*param_1 + 0x1c);
      *piVar1 = *piVar1 + 1;
    }
  }
  return uVar2;
}



// Function: FUN_67672d99 at 67672d99

undefined4 FUN_67672d99(int param_1)

{
  int *piVar1;
  undefined4 uVar2;
  
  if (((param_1 == 0) || (piVar1 = *(int **)(param_1 + 0x20), piVar1 == (int *)0x0)) ||
     (*piVar1 != param_1)) {
    uVar2 = 0xfffffffe;
  }
  else {
    if (piVar1[4] != 0) {
      (**(code **)(param_1 + 0x28))(*(undefined4 *)(param_1 + 0x2c),piVar1[4]);
    }
    if (piVar1[5] != 0) {
      (**(code **)(param_1 + 0x28))(*(undefined4 *)(param_1 + 0x2c),piVar1[5]);
    }
    if (piVar1[6] != 0) {
      (**(code **)(param_1 + 0x28))(*(undefined4 *)(param_1 + 0x2c),piVar1[6]);
    }
    (**(code **)(param_1 + 0x28))(*(undefined4 *)(param_1 + 0x2c),*(undefined4 *)(param_1 + 0x20));
    *(undefined4 *)(param_1 + 0x20) = 0;
    uVar2 = 0;
  }
  return uVar2;
}



// Function: FUN_67672df9 at 67672df9

undefined4 FUN_67672df9(int param_1,int param_2,int param_3,char param_4)

{
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  
  iVar1 = FUN_67672851();
  if (iVar1 == 0) {
    uVar3 = 0xfffffff7;
  }
  else if (((param_1 == 0) || (((param_3 != 0 && (param_3 != 1)) || (param_2 < 0)))) ||
          (4 < param_2)) {
    uVar3 = 0xfffffffe;
  }
  else {
    if (*(int *)(param_1 + 0x24) == 0) {
      *(code **)(param_1 + 0x24) = FUN_67672855;
    }
    if (*(int *)(param_1 + 0x28) == 0) {
      *(code **)(param_1 + 0x28) = FUN_67672866;
    }
    piVar2 = (int *)(**(code **)(param_1 + 0x24))(*(undefined4 *)(param_1 + 0x2c),0xfa78,1);
    if (piVar2 == (int *)0x0) {
      uVar3 = 0xfffffffd;
    }
    else {
      *piVar2 = param_1;
      *(int **)(param_1 + 0x20) = piVar2;
      piVar2[8] = 0;
      piVar2[7] = 0;
      piVar2[0x319] = 0;
      piVar2[1] = (-(uint)(param_4 != '\0') & 3) + 10;
      *(undefined4 *)(param_1 + 8) = 0;
      *(undefined4 *)(param_1 + 0xc) = 0;
      *(undefined4 *)(param_1 + 0x18) = 0;
      *(undefined4 *)(param_1 + 0x1c) = 0;
      *(undefined1 *)(piVar2 + 10) = (undefined1)param_3;
      piVar2[0x315] = 0;
      piVar2[0x314] = 0;
      piVar2[0x313] = 0;
      piVar2[0xb] = 0;
      piVar2[0xc] = param_2;
      *(char *)(piVar2 + 0x3e9d) = param_4;
      uVar3 = 0;
    }
  }
  return uVar3;
}



// Function: FUN_67672ed0 at 67672ed0

void __cdecl FUN_67672ed0(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar1 = 0;
  iVar3 = 0x100;
  do {
    iVar2 = iVar3 + iVar1 >> 1;
    if (*(int *)(param_2 + iVar2 * 4) <= param_1) {
      iVar1 = iVar2;
      iVar2 = iVar3;
    }
    iVar3 = iVar2;
  } while (iVar2 - iVar1 != 1);
  return;
}



// Function: FUN_67672efd at 67672efd

int FUN_67672efd(int param_1)

{
  int *piVar1;
  int iStack_c;
  
  if (((param_1 == 0) || (piVar1 = *(int **)(param_1 + 0x20), piVar1 == (int *)0x0)) ||
     (*piVar1 != param_1)) {
    iStack_c = -2;
  }
  else {
    do {
      do {
        if (piVar1[1] == 1) {
          return -1;
        }
        if (piVar1[1] == 2) {
          if ((char)piVar1[10] == '\0') {
            FUN_6767304c(piVar1);
          }
          else {
            FUN_6767347b(piVar1);
          }
          if ((piVar1[0x110] != piVar1[0x3e90] + 1) || (piVar1[3] != 0)) {
            return 0;
          }
          piVar1[0x318] = ~piVar1[0x318];
          if (2 < piVar1[0xc]) {
            FUN_676afdac((int *)&DAT_676c2138,(byte *)s__0x_x__0x_x__676bf494);
          }
          if (1 < piVar1[0xc]) {
            FUN_676afdac((int *)&DAT_676c2138,&DAT_676bf490);
          }
          if (((char)piVar1[0x3e9d] == '\0') && (piVar1[0x318] != piVar1[0x316])) {
            return -4;
          }
          piVar1[1] = 0xe;
          piVar1[0x319] = ((uint)piVar1[0x319] >> 0x1f | piVar1[0x319] * 2) ^ piVar1[0x318];
        }
      } while (piVar1[1] < 10);
      iStack_c = FUN_676757cd(piVar1);
      if (iStack_c == 4) {
        if (2 < piVar1[0xc]) {
          FUN_676afdac((int *)&DAT_676c2138,(byte *)s_combined_CRCs__stored___0x_x__co_676bf45c);
        }
        if (((char)piVar1[0x3e9d] == '\0') && (piVar1[0x319] != piVar1[0x317])) {
          return -4;
        }
        return 4;
      }
    } while (piVar1[1] == 2);
  }
  return iStack_c;
}



// Function: FUN_6767304c at 6767304c

void __cdecl FUN_6767304c(int *param_1)

{
  int *piVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  uint uVar9;
  int iStack_34;
  byte *local_1c;
  uint local_18;
  int local_14;
  uint local_10;
  int local_c;
  byte local_5;
  
  if ((char)param_1[4] == '\0') {
    local_18 = param_1[0x318];
    local_5 = *(byte *)(param_1 + 2);
    local_1c = *(byte **)(*param_1 + 0x10);
    iVar6 = *(int *)(*param_1 + 0x14);
    iVar4 = param_1[0x313];
    iVar7 = param_1[0x3e90] + 1;
    uVar8 = param_1[0xe];
    iStack_34 = param_1[3];
    local_14 = iVar6;
    uVar9 = param_1[0xf];
    iVar3 = param_1[0x110];
LAB_676732fe:
    local_c = iVar3;
    local_10 = uVar9;
    if (iStack_34 < 1) goto LAB_6767333f;
    while( true ) {
      if (local_14 == 0) goto LAB_67673349;
      uVar9 = local_10;
      iVar3 = local_c;
      if (iStack_34 == 1) break;
      *local_1c = local_5;
      local_18 = *(uint *)(&DAT_676bf614 + (local_18 >> 0x18 ^ (uint)local_5) * 4) ^ local_18 << 8;
      iStack_34 = iStack_34 + -1;
      local_1c = local_1c + 1;
      local_14 = local_14 + -1;
    }
LAB_676733cf:
    local_c = iVar3;
    local_10 = uVar9;
    if (local_14 == 0) {
      iStack_34 = 1;
      goto LAB_67673349;
    }
    *local_1c = local_5;
    local_18 = *(uint *)(&DAT_676bf614 + (local_18 >> 0x18 ^ (uint)local_5) * 4) ^ local_18 << 8;
    local_1c = local_1c + 1;
    local_14 = local_14 + -1;
LAB_6767333f:
    if (local_c != iVar7) {
      uVar8 = *(uint *)(iVar4 + uVar8 * 4);
      uVar9 = uVar8 & 0xff;
      local_5 = (byte)local_10;
      uVar8 = uVar8 >> 8;
      iVar3 = local_c + 1;
      if ((uVar9 != local_10) || (uVar9 = local_10, iVar3 == iVar7)) goto LAB_676733cf;
      uVar5 = *(uint *)(iVar4 + uVar8 * 4);
      iStack_34 = 2;
      uVar8 = uVar5 >> 8;
      iVar3 = local_c + 2;
      if ((iVar3 != iVar7) && (uVar9 = uVar5 & 0xff, iStack_34 = 2, uVar9 == local_10)) {
        uVar5 = *(uint *)(iVar4 + uVar8 * 4);
        iStack_34 = 3;
        uVar8 = uVar5 >> 8;
        iVar3 = local_c + 3;
        uVar9 = local_10;
        if ((iVar3 != iVar7) && (uVar9 = uVar5 & 0xff, uVar9 == local_10)) {
          uVar9 = *(uint *)(iVar4 + uVar8 * 4);
          uVar5 = *(uint *)(iVar4 + (uVar9 >> 8) * 4);
          uVar8 = uVar5 >> 8;
          iStack_34 = (uVar9 & 0xff) + 4;
          uVar9 = uVar5 & 0xff;
          iVar3 = local_c + 5;
        }
      }
      goto LAB_676732fe;
    }
    iStack_34 = 0;
LAB_67673349:
    uVar9 = *(uint *)(*param_1 + 0x18);
    *(uint *)(*param_1 + 0x18) = (uVar9 - local_14) + iVar6;
    if (*(uint *)(*param_1 + 0x18) < uVar9) {
      piVar1 = (int *)(*param_1 + 0x1c);
      *piVar1 = *piVar1 + 1;
    }
    param_1[0xe] = uVar8;
    param_1[0x318] = local_18;
    *(byte *)(param_1 + 2) = local_5;
    param_1[3] = iStack_34;
    param_1[0x110] = local_c;
    param_1[0xf] = local_10;
    param_1[0x313] = iVar4;
    *(byte **)(*param_1 + 0x10) = local_1c;
    *(int *)(*param_1 + 0x14) = local_14;
  }
  else {
LAB_67673062:
    if (*(int *)(*param_1 + 0x14) != 0) {
      if (param_1[3] == 0) {
        iVar3 = param_1[0x110];
        iVar6 = param_1[0x3e90] + 1;
        if (iVar3 == iVar6) {
          return;
        }
        iVar4 = param_1[0x313];
        *(char *)(param_1 + 2) = (char)param_1[0xf];
        param_1[3] = 1;
        uVar8 = *(uint *)(iVar4 + param_1[0xe] * 4);
        param_1[0xe] = uVar8;
        param_1[0xe] = uVar8 >> 8;
        if (param_1[5] == 0) {
          iVar7 = param_1[6] + 1;
          param_1[5] = (&DAT_676bfa30)[param_1[6]];
          param_1[6] = iVar7;
          if (iVar7 == 0x200) {
            param_1[6] = 0;
          }
        }
        param_1[5] = param_1[5] + -1;
        param_1[0x110] = iVar3 + 1;
        if (iVar3 + 1 != iVar6) {
          uVar8 = (uint)(byte)((byte)uVar8 ^ param_1[5] == 1);
          if (uVar8 == param_1[0xf]) {
            param_1[3] = 2;
            uVar8 = *(uint *)(iVar4 + param_1[0xe] * 4);
            param_1[0xe] = uVar8;
            param_1[0xe] = uVar8 >> 8;
            if (param_1[5] == 0) {
              iVar7 = param_1[6] + 1;
              param_1[5] = (&DAT_676bfa30)[param_1[6]];
              param_1[6] = iVar7;
              if (iVar7 == 0x200) {
                param_1[6] = 0;
              }
            }
            param_1[5] = param_1[5] + -1;
            param_1[0x110] = iVar3 + 2;
            if (iVar3 + 2 == iVar6) goto LAB_67673062;
            uVar8 = (uint)(byte)((byte)uVar8 ^ param_1[5] == 1);
            if (uVar8 == param_1[0xf]) {
              param_1[3] = 3;
              uVar8 = *(uint *)(iVar4 + param_1[0xe] * 4);
              param_1[0xe] = uVar8;
              param_1[0xe] = uVar8 >> 8;
              if (param_1[5] == 0) {
                iVar7 = param_1[6] + 1;
                param_1[5] = (&DAT_676bfa30)[param_1[6]];
                param_1[6] = iVar7;
                if (iVar7 == 0x200) {
                  param_1[6] = 0;
                }
              }
              param_1[5] = param_1[5] + -1;
              param_1[0x110] = iVar3 + 3;
              if (iVar3 + 3 == iVar6) goto LAB_67673062;
              uVar8 = (uint)(byte)((byte)uVar8 ^ param_1[5] == 1);
              if (uVar8 == param_1[0xf]) {
                uVar8 = *(uint *)(iVar4 + param_1[0xe] * 4);
                param_1[0xe] = uVar8;
                param_1[0xe] = uVar8 >> 8;
                if (param_1[5] == 0) {
                  iVar6 = param_1[6] + 1;
                  param_1[5] = (&DAT_676bfa30)[param_1[6]];
                  param_1[6] = iVar6;
                  if (iVar6 == 0x200) {
                    param_1[6] = 0;
                  }
                }
                param_1[5] = param_1[5] + -1;
                param_1[0x110] = iVar3 + 4;
                param_1[3] = (byte)(param_1[5] == 1 ^ (byte)uVar8) + 4;
                param_1[0xe] = *(int *)(iVar4 + param_1[0xe] * 4);
                bVar2 = *(byte *)(param_1 + 0xe);
                param_1[0xe] = (uint)param_1[0xe] >> 8;
                param_1[0xf] = (uint)bVar2;
                if (param_1[5] == 0) {
                  iVar6 = param_1[6] + 1;
                  param_1[5] = (&DAT_676bfa30)[param_1[6]];
                  param_1[6] = iVar6;
                  if (iVar6 == 0x200) {
                    param_1[6] = 0;
                  }
                }
                param_1[5] = param_1[5] + -1;
                param_1[0xf] = param_1[0xf] ^ (uint)(param_1[5] == 1);
                param_1[0x110] = iVar3 + 5;
                goto LAB_67673062;
              }
            }
          }
          param_1[0xf] = uVar8;
        }
      }
      else {
        **(undefined1 **)(*param_1 + 0x10) = (char)param_1[2];
        uVar8 = *(uint *)(&DAT_676bf614 +
                         ((uint)param_1[0x318] >> 0x18 ^ (uint)*(byte *)(param_1 + 2)) * 4);
        param_1[3] = param_1[3] + -1;
        param_1[0x318] = uVar8 ^ param_1[0x318] << 8;
        *(int *)(*param_1 + 0x10) = *(int *)(*param_1 + 0x10) + 1;
        *(int *)(*param_1 + 0x14) = *(int *)(*param_1 + 0x14) + -1;
        *(int *)(*param_1 + 0x18) = *(int *)(*param_1 + 0x18) + 1;
        if (*(int *)(*param_1 + 0x18) == 0) {
          piVar1 = (int *)(*param_1 + 0x1c);
          *piVar1 = *piVar1 + 1;
        }
      }
      goto LAB_67673062;
    }
  }
  return;
}



// Function: FUN_6767347b at 6767347b

void __cdecl FUN_6767347b(int *param_1)

{
  int *piVar1;
  ushort uVar2;
  byte bVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  
  if ((char)param_1[4] == '\0') {
LAB_676737c5:
    if (*(int *)(*param_1 + 0x14) != 0) {
      if (param_1[3] == 0) {
        if (param_1[0x110] == param_1[0x3e90] + 1) {
          return;
        }
        piVar1 = param_1 + 0x111;
        param_1[3] = 1;
        *(char *)(param_1 + 2) = (char)param_1[0xf];
        uVar5 = FUN_67672ed0(param_1[0xe],(int)piVar1);
        uVar4 = param_1[0xe];
        bVar3 = *(byte *)((uVar4 >> 1) + param_1[0x315]);
        uVar2 = *(ushort *)(param_1[0x314] + uVar4 * 2);
        param_1[0x110] = param_1[0x110] + 1;
        param_1[0xe] = (bVar3 >> (((byte)uVar4 & 1) << 2) & 0xf) << 0x10 | (uint)uVar2;
        if (param_1[0x110] != param_1[0x3e90] + 1) {
          uVar5 = uVar5 & 0xff;
          if (uVar5 == param_1[0xf]) {
            param_1[3] = 2;
            uVar5 = FUN_67672ed0(param_1[0xe],(int)piVar1);
            uVar4 = param_1[0xe];
            uVar4 = (*(byte *)((uVar4 >> 1) + param_1[0x315]) >> (((byte)uVar4 & 1) << 2) & 0xf) <<
                    0x10 | (uint)*(ushort *)(param_1[0x314] + uVar4 * 2);
            param_1[0x110] = param_1[0x110] + 1;
            param_1[0xe] = uVar4;
            if (param_1[0x110] == param_1[0x3e90] + 1) goto LAB_676737c5;
            uVar5 = uVar5 & 0xff;
            if (uVar5 == param_1[0xf]) {
              param_1[3] = 3;
              uVar5 = FUN_67672ed0(uVar4,(int)piVar1);
              uVar4 = param_1[0xe];
              uVar4 = (*(byte *)((uVar4 >> 1) + param_1[0x315]) >> (((byte)uVar4 & 1) << 2) & 0xf)
                      << 0x10 | (uint)*(ushort *)(param_1[0x314] + uVar4 * 2);
              param_1[0x110] = param_1[0x110] + 1;
              param_1[0xe] = uVar4;
              if (param_1[0x110] == param_1[0x3e90] + 1) goto LAB_676737c5;
              uVar5 = uVar5 & 0xff;
              if (uVar5 == param_1[0xf]) {
                uVar5 = FUN_67672ed0(uVar4,(int)piVar1);
                uVar4 = param_1[0xe];
                bVar3 = *(byte *)((uVar4 >> 1) + param_1[0x315]);
                uVar2 = *(ushort *)(param_1[0x314] + uVar4 * 2);
                param_1[3] = (uVar5 & 0xff) + 4;
                uVar4 = (bVar3 >> (((byte)uVar4 & 1) << 2) & 0xf) << 0x10 | (uint)uVar2;
                param_1[0x110] = param_1[0x110] + 1;
                param_1[0xe] = uVar4;
                iVar6 = FUN_67672ed0(uVar4,(int)piVar1);
                param_1[0xf] = iVar6;
                uVar4 = param_1[0xe];
                bVar3 = *(byte *)((uVar4 >> 1) + param_1[0x315]);
                uVar2 = *(ushort *)(param_1[0x314] + uVar4 * 2);
                param_1[0x110] = param_1[0x110] + 1;
                param_1[0xe] = (bVar3 >> (((byte)uVar4 & 1) << 2) & 0xf) << 0x10 | (uint)uVar2;
                goto LAB_676737c5;
              }
            }
          }
          param_1[0xf] = uVar5;
        }
      }
      else {
        **(undefined1 **)(*param_1 + 0x10) = (char)param_1[2];
        uVar4 = *(uint *)(&DAT_676bf614 +
                         ((uint)param_1[0x318] >> 0x18 ^ (uint)*(byte *)(param_1 + 2)) * 4);
        param_1[3] = param_1[3] + -1;
        param_1[0x318] = uVar4 ^ param_1[0x318] << 8;
        *(int *)(*param_1 + 0x10) = *(int *)(*param_1 + 0x10) + 1;
        *(int *)(*param_1 + 0x14) = *(int *)(*param_1 + 0x14) + -1;
        *(int *)(*param_1 + 0x18) = *(int *)(*param_1 + 0x18) + 1;
        if (*(int *)(*param_1 + 0x18) == 0) {
          piVar1 = (int *)(*param_1 + 0x1c);
          *piVar1 = *piVar1 + 1;
        }
      }
      goto LAB_676737c5;
    }
  }
  else {
LAB_67673490:
    if (*(int *)(*param_1 + 0x14) != 0) {
      if (param_1[3] == 0) {
        if (param_1[0x110] == param_1[0x3e90] + 1) {
          return;
        }
        piVar1 = param_1 + 0x111;
        param_1[3] = 1;
        *(char *)(param_1 + 2) = (char)param_1[0xf];
        bVar3 = FUN_67672ed0(param_1[0xe],(int)piVar1);
        uVar4 = param_1[0xe];
        param_1[0xe] = (*(byte *)((uVar4 >> 1) + param_1[0x315]) >> (((byte)uVar4 & 1) << 2) & 0xf)
                       << 0x10 | (uint)*(ushort *)(param_1[0x314] + uVar4 * 2);
        if (param_1[5] == 0) {
          iVar6 = param_1[6] + 1;
          param_1[5] = (&DAT_676bfa30)[param_1[6]];
          param_1[6] = iVar6;
          if (iVar6 == 0x200) {
            param_1[6] = 0;
          }
        }
        param_1[5] = param_1[5] + -1;
        param_1[0x110] = param_1[0x110] + 1;
        if (param_1[0x110] != param_1[0x3e90] + 1) {
          uVar4 = (uint)(bVar3 ^ param_1[5] == 1);
          if (uVar4 == param_1[0xf]) {
            param_1[3] = 2;
            bVar3 = FUN_67672ed0(param_1[0xe],(int)piVar1);
            uVar4 = param_1[0xe];
            param_1[0xe] = (*(byte *)((uVar4 >> 1) + param_1[0x315]) >> (((byte)uVar4 & 1) << 2) &
                           0xf) << 0x10 | (uint)*(ushort *)(param_1[0x314] + uVar4 * 2);
            if (param_1[5] == 0) {
              iVar6 = param_1[6] + 1;
              param_1[5] = (&DAT_676bfa30)[param_1[6]];
              param_1[6] = iVar6;
              if (iVar6 == 0x200) {
                param_1[6] = 0;
              }
            }
            param_1[5] = param_1[5] + -1;
            param_1[0x110] = param_1[0x110] + 1;
            if (param_1[0x110] == param_1[0x3e90] + 1) goto LAB_67673490;
            uVar4 = (uint)(bVar3 ^ param_1[5] == 1);
            if (uVar4 == param_1[0xf]) {
              param_1[3] = 3;
              bVar3 = FUN_67672ed0(param_1[0xe],(int)piVar1);
              uVar4 = param_1[0xe];
              param_1[0xe] = (*(byte *)((uVar4 >> 1) + param_1[0x315]) >> (((byte)uVar4 & 1) << 2) &
                             0xf) << 0x10 | (uint)*(ushort *)(param_1[0x314] + uVar4 * 2);
              if (param_1[5] == 0) {
                iVar6 = param_1[6] + 1;
                param_1[5] = (&DAT_676bfa30)[param_1[6]];
                param_1[6] = iVar6;
                if (iVar6 == 0x200) {
                  param_1[6] = 0;
                }
              }
              param_1[5] = param_1[5] + -1;
              param_1[0x110] = param_1[0x110] + 1;
              if (param_1[0x110] == param_1[0x3e90] + 1) goto LAB_67673490;
              uVar4 = (uint)(bVar3 ^ param_1[5] == 1);
              if (uVar4 == param_1[0xf]) {
                uVar5 = FUN_67672ed0(param_1[0xe],(int)piVar1);
                uVar4 = param_1[0xe];
                param_1[0xe] = (*(byte *)((uVar4 >> 1) + param_1[0x315]) >> (((byte)uVar4 & 1) << 2)
                               & 0xf) << 0x10 | (uint)*(ushort *)(param_1[0x314] + uVar4 * 2);
                if (param_1[5] == 0) {
                  iVar6 = param_1[6] + 1;
                  param_1[5] = (&DAT_676bfa30)[param_1[6]];
                  param_1[6] = iVar6;
                  if (iVar6 == 0x200) {
                    param_1[6] = 0;
                  }
                }
                param_1[5] = param_1[5] + -1;
                param_1[0x110] = param_1[0x110] + 1;
                param_1[3] = ((uint)(param_1[5] == 1) ^ uVar5 & 0xff) + 4;
                uVar5 = FUN_67672ed0(param_1[0xe],(int)piVar1);
                uVar4 = param_1[0xe];
                param_1[0xf] = uVar5;
                param_1[0xe] = (*(byte *)((uVar4 >> 1) + param_1[0x315]) >> (((byte)uVar4 & 1) << 2)
                               & 0xf) << 0x10 | (uint)*(ushort *)(param_1[0x314] + uVar4 * 2);
                if (param_1[5] == 0) {
                  iVar6 = param_1[6] + 1;
                  param_1[5] = (&DAT_676bfa30)[param_1[6]];
                  param_1[6] = iVar6;
                  if (iVar6 == 0x200) {
                    param_1[6] = 0;
                  }
                }
                param_1[5] = param_1[5] + -1;
                param_1[0x110] = param_1[0x110] + 1;
                param_1[0xf] = param_1[5] == 1 ^ uVar5;
                goto LAB_67673490;
              }
            }
          }
          param_1[0xf] = uVar4;
        }
      }
      else {
        **(undefined1 **)(*param_1 + 0x10) = (char)param_1[2];
        uVar4 = *(uint *)(&DAT_676bf614 +
                         ((uint)param_1[0x318] >> 0x18 ^ (uint)*(byte *)(param_1 + 2)) * 4);
        param_1[3] = param_1[3] + -1;
        param_1[0x318] = uVar4 ^ param_1[0x318] << 8;
        *(int *)(*param_1 + 0x10) = *(int *)(*param_1 + 0x10) + 1;
        *(int *)(*param_1 + 0x14) = *(int *)(*param_1 + 0x14) + -1;
        *(int *)(*param_1 + 0x18) = *(int *)(*param_1 + 0x18) + 1;
        if (*(int *)(*param_1 + 0x18) == 0) {
          piVar1 = (int *)(*param_1 + 0x1c);
          *piVar1 = *piVar1 + 1;
        }
      }
      goto LAB_67673490;
    }
  }
  return;
}



// Function: FUN_67673a04 at 67673a04

undefined4 FUN_67673a04(int param_1)

{
  int *piVar1;
  undefined4 uVar2;
  
  if (((param_1 == 0) || (piVar1 = *(int **)(param_1 + 0x20), piVar1 == (int *)0x0)) ||
     (*piVar1 != param_1)) {
    uVar2 = 0xfffffffe;
  }
  else {
    if (piVar1[0x313] != 0) {
      (**(code **)(param_1 + 0x28))(*(undefined4 *)(param_1 + 0x2c),piVar1[0x313]);
    }
    if (piVar1[0x314] != 0) {
      (**(code **)(param_1 + 0x28))(*(undefined4 *)(param_1 + 0x2c),piVar1[0x314]);
    }
    if (piVar1[0x315] != 0) {
      (**(code **)(param_1 + 0x28))(*(undefined4 *)(param_1 + 0x2c),piVar1[0x315]);
    }
    (**(code **)(param_1 + 0x28))(*(undefined4 *)(param_1 + 0x2c),*(undefined4 *)(param_1 + 0x20));
    *(undefined4 *)(param_1 + 0x20) = 0;
    uVar2 = 0;
  }
  return uVar2;
}



// Function: FUN_67673a6d at 67673a6d

char * FUN_67673a6d(void)

{
  return s_1_0_1__23_June_2000_676bf4a4;
}



// Function: FUN_67673a73 at 67673a73

void __cdecl FUN_67673a73(int param_1)

{
  *(undefined4 *)(param_1 + 0x25c) = 0;
  *(undefined4 *)(param_1 + 600) = 0;
  return;
}



// Function: FUN_67673a86 at 67673a86

void __cdecl FUN_67673a86(ushort *param_1,char param_2)

{
  uint uVar1;
  
  if (0 < *(int *)(param_1 + 0x22)) {
    uVar1 = *(uint *)(param_1 + 0x130);
    *(uint *)(param_1 + 0x130) = ~uVar1;
    *(uint *)(param_1 + 0x132) =
         (*(uint *)(param_1 + 0x132) >> 0x1f | *(uint *)(param_1 + 0x132) * 2) ^ ~uVar1;
    if (1 < *(int *)(param_1 + 0x136)) {
      param_1[0x26] = 0;
      param_1[0x27] = 0;
    }
    if (1 < *(int *)(param_1 + 0x134)) {
      FUN_676afdac((int *)&DAT_676c2138,(byte *)s_block__d__crc___0x_8x__combined_C_676bf4dc);
    }
    FUN_67671000((int)param_1);
  }
  *(int *)(param_1 + 0x16) = *(int *)(param_1 + 10) + *(int *)(param_1 + 0x22);
  if (*(int *)(param_1 + 0x136) == 1) {
    FUN_67673a73((int)param_1);
    if ((char)param_1[0x6cd8] == '\0') {
      FUN_67673d17((int)param_1,0x42);
      FUN_67673d17((int)param_1,0x5a);
      FUN_67673d17((int)param_1,0x68);
    }
    FUN_67673d17((int)param_1,(char)param_1[0x138] + 0x30);
  }
  if (0 < *(int *)(param_1 + 0x22)) {
    FUN_67673d17((int)param_1,0x31);
    if ((char)param_1[0x6cd8] == '\0') {
      FUN_67673d17((int)param_1,0x41);
      FUN_67673d17((int)param_1,0x59);
      FUN_67673d17((int)param_1,0x26);
      FUN_67673d17((int)param_1,0x53);
      FUN_67673d17((int)param_1,0x59);
      FUN_67673cce((int)param_1,*(uint *)(param_1 + 0x130));
    }
    FUN_67673c72((int)param_1,1,0);
    FUN_67673c72((int)param_1,0x18,*(int *)(param_1 + 0xe));
    FUN_67673d2c((uint)param_1);
    FUN_67673ef6(param_1);
  }
  if (param_2 != '\0') {
    FUN_67673d17((int)param_1,0x17);
    if ((char)param_1[0x6cd8] == '\0') {
      FUN_67673d17((int)param_1,0x72);
      FUN_67673d17((int)param_1,0x45);
      FUN_67673d17((int)param_1,0x38);
      FUN_67673d17((int)param_1,0x50);
      FUN_67673d17((int)param_1,0x90);
      FUN_67673cce((int)param_1,*(uint *)(param_1 + 0x132));
      if (1 < *(int *)(param_1 + 0x134)) {
        FUN_676afdac((int *)&DAT_676c2138,(byte *)s_final_combined_CRC___0x_x_676bf4b8);
      }
    }
    FUN_67673c36((int)param_1);
  }
  return;
}



// Function: FUN_67673c36 at 67673c36

void __cdecl FUN_67673c36(int param_1)

{
  int iVar1;
  
  iVar1 = *(int *)(param_1 + 0x25c);
  while (0 < iVar1) {
    *(char *)(*(int *)(param_1 + 0x2c) + *(int *)(param_1 + 0x4c)) =
         (char)((uint)*(undefined4 *)(param_1 + 600) >> 0x18);
    *(int *)(param_1 + 0x4c) = *(int *)(param_1 + 0x4c) + 1;
    *(int *)(param_1 + 600) = *(int *)(param_1 + 600) << 8;
    *(int *)(param_1 + 0x25c) = *(int *)(param_1 + 0x25c) + -8;
    iVar1 = *(int *)(param_1 + 0x25c);
  }
  return;
}



// Function: FUN_67673c72 at 67673c72

void __cdecl FUN_67673c72(int param_1,int param_2,int param_3)

{
  int iVar1;
  
  while (7 < *(int *)(param_1 + 0x25c)) {
    *(char *)(*(int *)(param_1 + 0x2c) + *(int *)(param_1 + 0x4c)) =
         (char)((uint)*(undefined4 *)(param_1 + 600) >> 0x18);
    *(int *)(param_1 + 0x4c) = *(int *)(param_1 + 0x4c) + 1;
    *(int *)(param_1 + 600) = *(int *)(param_1 + 600) << 8;
    *(int *)(param_1 + 0x25c) = *(int *)(param_1 + 0x25c) + -8;
  }
  iVar1 = *(int *)(param_1 + 0x25c);
  *(int *)(param_1 + 0x25c) = iVar1 + param_2;
  *(uint *)(param_1 + 600) =
       *(uint *)(param_1 + 600) | param_3 << ((' ' - (char)iVar1) - (char)param_2 & 0x1fU);
  return;
}



// Function: FUN_67673cce at 67673cce

void __cdecl FUN_67673cce(int param_1,uint param_2)

{
  FUN_67673c72(param_1,8,param_2 >> 0x18);
  FUN_67673c72(param_1,8,param_2 >> 0x10 & 0xff);
  FUN_67673c72(param_1,8,param_2 >> 8 & 0xff);
  FUN_67673c72(param_1,8,param_2 & 0xff);
  return;
}



// Function: FUN_67673d17 at 67673d17

void __cdecl FUN_67673d17(int param_1,byte param_2)

{
  FUN_67673c72(param_1,8,(uint)param_2);
  return;
}



// Function: FUN_67673d2c at 67673d2c

int __cdecl FUN_67673d2c(uint param_1)

{
  char cVar1;
  char cVar2;
  int *piVar3;
  uint uVar4;
  char *pcVar5;
  uint uVar6;
  int iVar7;
  int iVar8;
  undefined2 *puVar9;
  int iVar10;
  undefined4 *puVar11;
  int iVar12;
  char local_118 [256];
  int local_18;
  int *local_14;
  int local_10;
  int local_c;
  int local_8;
  
  uVar4 = param_1;
  local_18 = *(int *)(param_1 + 0x24);
  piVar3 = *(int **)(param_1 + 0x20);
  local_8 = *(int *)(param_1 + 0x28);
  FUN_67673ece(param_1);
  iVar10 = *(int *)(param_1 + 0x54) + 1;
  local_10 = iVar10;
  if (-1 < iVar10) {
    puVar11 = (undefined4 *)(param_1 + 0x278);
    for (iVar7 = *(int *)(param_1 + 0x54) + 2; iVar7 != 0; iVar7 = iVar7 + -1) {
      *puVar11 = 0;
      puVar11 = puVar11 + 1;
    }
  }
  iVar7 = *(int *)(param_1 + 0x54);
  iVar8 = 0;
  iVar12 = 0;
  param_1 = 0;
  if (0 < iVar7) {
    do {
      local_118[iVar8] = (char)iVar8;
      iVar8 = iVar8 + 1;
    } while (iVar8 < iVar7);
  }
  iVar7 = *(int *)(uVar4 + 0x44);
  local_c = 0;
  if (0 < iVar7) {
    local_14 = piVar3;
    do {
      cVar2 = local_118[1];
      iVar8 = *local_14 + -1;
      if (iVar8 < 0) {
        iVar8 = iVar8 + iVar7;
      }
      cVar1 = *(char *)(*(byte *)(iVar8 + local_18) + 0x158 + uVar4);
      if (local_118[0] == cVar1) {
        param_1 = param_1 + 1;
      }
      else {
        if (0 < (int)param_1) {
          param_1 = param_1 - 1;
          puVar9 = (undefined2 *)(local_8 + iVar12 * 2);
          while( true ) {
            if ((param_1 & 1) == 0) {
              *puVar9 = 0;
              *(int *)(uVar4 + 0x278) = *(int *)(uVar4 + 0x278) + 1;
            }
            else {
              *puVar9 = 1;
              *(int *)(uVar4 + 0x27c) = *(int *)(uVar4 + 0x27c) + 1;
            }
            iVar12 = iVar12 + 1;
            puVar9 = puVar9 + 1;
            if ((int)param_1 < 2) break;
            param_1 = (int)(param_1 - 2) / 2;
            iVar10 = local_10;
          }
          param_1 = 0;
        }
        local_118[1] = local_118[0];
        pcVar5 = local_118 + 1;
        local_118[0] = cVar2;
        while (cVar1 != local_118[0]) {
          pcVar5 = pcVar5 + 1;
          cVar2 = *pcVar5;
          *pcVar5 = local_118[0];
          iVar10 = local_10;
          local_118[0] = cVar2;
        }
        piVar3 = (int *)(uVar4 + 0x27c + ((int)pcVar5 - (int)local_118) * 4);
        *(short *)(local_8 + iVar12 * 2) = (short)((int)pcVar5 - (int)local_118) + 1;
        iVar12 = iVar12 + 1;
        *piVar3 = *piVar3 + 1;
      }
      local_c = local_c + 1;
      iVar7 = *(int *)(uVar4 + 0x44);
      local_14 = local_14 + 1;
    } while (local_c < iVar7);
    if (0 < (int)param_1) {
      uVar6 = param_1 - 1;
      puVar9 = (undefined2 *)(local_8 + iVar12 * 2);
      while( true ) {
        if ((uVar6 & 1) == 0) {
          *puVar9 = 0;
          *(int *)(uVar4 + 0x278) = *(int *)(uVar4 + 0x278) + 1;
        }
        else {
          *puVar9 = 1;
          *(int *)(uVar4 + 0x27c) = *(int *)(uVar4 + 0x27c) + 1;
        }
        iVar12 = iVar12 + 1;
        puVar9 = puVar9 + 1;
        if ((int)uVar6 < 2) break;
        uVar6 = (int)(uVar6 - 2) / 2;
        iVar10 = local_10;
      }
    }
  }
  *(short *)(local_8 + iVar12 * 2) = (short)iVar10;
  piVar3 = (int *)(uVar4 + 0x278 + iVar10 * 4);
  *piVar3 = *piVar3 + 1;
  *(int *)(uVar4 + 0x274) = iVar12 + 1;
  return uVar4 + 0x278 + iVar10 * 4;
}



// Function: FUN_67673ece at 67673ece

void __cdecl FUN_67673ece(int param_1)

{
  int iVar1;
  
  *(undefined4 *)(param_1 + 0x54) = 0;
  iVar1 = 0;
  do {
    if (*(char *)(param_1 + 0x58 + iVar1) != '\0') {
      *(undefined1 *)(iVar1 + 0x158 + param_1) = *(undefined1 *)(param_1 + 0x54);
      *(int *)(param_1 + 0x54) = *(int *)(param_1 + 0x54) + 1;
    }
    iVar1 = iVar1 + 1;
  } while (iVar1 < 0x100);
  return;
}



// Function: FUN_67673ef6 at 67673ef6

void __cdecl FUN_67673ef6(ushort *param_1)

{
  byte bVar1;
  int iVar2;
  ushort *puVar3;
  int iVar4;
  ushort *puVar5;
  int *piVar6;
  int iVar7;
  uint uVar8;
  ushort *puVar9;
  uint *puVar10;
  uint uVar11;
  byte *pbVar12;
  undefined1 unaff_BL;
  int unaff_ESI;
  int unaff_EDI;
  int iVar13;
  undefined4 *puVar14;
  ushort *puVar15;
  byte *pbVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  uint uVar20;
  uint uVar21;
  uint uVar22;
  uint uVar23;
  uint uVar24;
  uint uVar25;
  uint uVar26;
  uint uVar27;
  uint uVar28;
  uint uVar29;
  uint uVar30;
  uint uVar31;
  uint uVar32;
  uint uVar33;
  uint uVar34;
  uint uVar35;
  uint uVar36;
  uint uVar37;
  uint uVar38;
  uint uVar39;
  uint uVar40;
  uint uVar41;
  uint uVar42;
  uint uVar43;
  uint uVar44;
  uint uVar45;
  uint uVar46;
  uint uVar47;
  uint uVar48;
  uint uVar49;
  uint uVar50;
  uint uVar51;
  uint uVar52;
  uint uVar53;
  uint uVar54;
  uint uVar55;
  uint uVar56;
  uint uVar57;
  uint uVar58;
  uint uVar59;
  uint uVar60;
  uint uVar61;
  uint uVar62;
  uint uVar63;
  int in_stack_ffffffac;
  int in_stack_ffffffb0;
  undefined1 in_stack_ffffffb4;
  char local_40 [4];
  int local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  ushort *local_28;
  ushort *local_24;
  ushort *local_20;
  ushort *local_1c;
  ushort *local_18;
  ushort *local_14;
  ushort *local_10;
  ushort *local_c;
  undefined1 local_5;
  
  puVar3 = param_1;
  iVar2 = *(int *)(param_1 + 0x14);
  if (2 < *(int *)(param_1 + 0x134)) {
    FUN_676afdac((int *)&DAT_676c2138,(byte *)s__d_in_block___d_after_MTF___1_2_c_676bf5d4);
  }
  puVar5 = param_1 + 0x2a;
  param_1 = param_1 + 0x4992;
  local_14 = (ushort *)(*(int *)puVar5 + 2);
  local_30 = (ushort *)0x6;
  do {
    if (0 < (int)local_14) {
      puVar5 = param_1;
      for (uVar8 = (uint)local_14 >> 2; uVar8 != 0; uVar8 = uVar8 - 1) {
        puVar5[0] = 0xf0f;
        puVar5[1] = 0xf0f;
        puVar5 = puVar5 + 2;
      }
      for (uVar8 = (uint)local_14 & 3; uVar8 != 0; uVar8 = uVar8 - 1) {
        *(undefined1 *)puVar5 = 0xf;
        puVar5 = (ushort *)((int)puVar5 + 1);
      }
    }
    param_1 = param_1 + 0x81;
    local_30 = (ushort *)((int)local_30 + -1);
  } while (local_30 != (ushort *)0x0);
  if (*(int *)(puVar3 + 0x13a) < 1) {
    FUN_6767268b(0xbb9,unaff_EDI,unaff_ESI,unaff_BL);
  }
  local_c = *(ushort **)(puVar3 + 0x13a);
  if ((int)local_c < 200) {
    local_10 = (ushort *)0x2;
  }
  else if ((int)local_c < 600) {
    local_10 = (ushort *)0x3;
  }
  else if ((int)local_c < 0x4b0) {
    local_10 = (ushort *)0x4;
  }
  else {
    local_10 = (ushort *)((0x95f < (int)local_c) + 5);
  }
  param_1 = (ushort *)0x0;
  local_20 = local_10;
  if (local_10 != (ushort *)0x0) {
    local_24 = (ushort *)0x0;
    local_18 = puVar3 + ((int)local_10 + 0x91U) * 0x81;
    do {
      local_30 = (ushort *)((int)local_c / (int)local_20);
      local_1c = (ushort *)0x0;
      iVar13 = (int)param_1 + -1;
      if (0 < (int)local_30) {
        puVar5 = puVar3 + iVar13 * 2 + 0x13c;
        do {
          if ((int)((int)local_14 - 1U) <= iVar13) break;
          puVar9 = puVar5 + 2;
          puVar5 = puVar5 + 2;
          local_1c = (ushort *)((int)local_1c + *(int *)puVar9);
          iVar13 = iVar13 + 1;
        } while ((int)local_1c < (int)local_30);
      }
      if (((((int)param_1 < iVar13) && (local_20 != local_10)) && (local_20 != (ushort *)0x1)) &&
         ((int)local_24 % 2 == 1)) {
        local_1c = (ushort *)((int)local_1c - *(int *)(puVar3 + iVar13 * 2 + 0x13c));
        iVar13 = iVar13 + -1;
      }
      if (2 < *(int *)(puVar3 + 0x134)) {
        FUN_676afdac((int *)&DAT_676c2138,(byte *)s_initial_group__d____d_____d___ha_676bf598);
      }
      iVar4 = 0;
      if (0 < (int)local_14) {
        do {
          if ((iVar4 < (int)param_1) || (iVar13 < iVar4)) {
            *(undefined1 *)((int)local_18 + iVar4) = 0xf;
          }
          else {
            *(undefined1 *)((int)local_18 + iVar4) = 0;
          }
          iVar4 = iVar4 + 1;
        } while (iVar4 < (int)local_14);
      }
      local_20 = (ushort *)((int)local_20 - 1);
      local_24 = (ushort *)((int)local_24 + 1);
      local_18 = local_18 + -0x81;
      local_c = (ushort *)((int)local_c - (int)local_1c);
      param_1 = (ushort *)(iVar13 + 1);
    } while (0 < (int)local_20);
  }
  local_20 = (ushort *)0x0;
  do {
    if (0 < (int)local_10) {
      puVar5 = puVar3 + 0x58b0;
      puVar14 = (undefined4 *)&stack0xffffffa8;
      for (puVar9 = local_10; puVar9 != (ushort *)0x0; puVar9 = (ushort *)((int)puVar9 - 1)) {
        *puVar14 = 0;
        puVar14 = puVar14 + 1;
      }
      param_1 = local_10;
      do {
        puVar9 = local_14;
        puVar15 = puVar5;
        if (0 < (int)local_14) {
          for (; puVar9 != (ushort *)0x0; puVar9 = (ushort *)((int)puVar9 - 1)) {
            puVar15[0] = 0;
            puVar15[1] = 0;
            puVar15 = puVar15 + 2;
          }
        }
        puVar5 = puVar5 + 0x204;
        param_1 = (ushort *)((int)param_1 + -1);
      } while (param_1 != (ushort *)0x0);
    }
    if ((local_10 == (ushort *)0x6) && (0 < (int)local_14)) {
      puVar5 = puVar3 + 0x4992;
      puVar10 = (uint *)(puVar3 + 0x64ca);
      do {
        puVar10[-1] = (uint)(byte)puVar5[0x81] << 0x10 | (uint)(byte)*puVar5;
        *puVar10 = (uint)(byte)puVar5[0x183] << 0x10 | (uint)(byte)puVar5[0x102];
        puVar9 = puVar5 + 0x285;
        puVar15 = puVar5 + 0x204;
        puVar5 = (ushort *)((int)puVar5 + 1);
        puVar10[1] = (uint)(byte)*puVar9 << 0x10 | (uint)(byte)*puVar15;
        puVar10 = puVar10 + 4;
      } while ((int)((-0x9324 - (int)puVar3) + (int)puVar5) < (int)local_14);
    }
    local_18 = (ushort *)0x0;
    local_30 = (ushort *)0x0;
    pbVar16 = (byte *)0x0;
    while (iVar13 = *(int *)(puVar3 + 0x13a), (int)pbVar16 < iVar13) {
      puVar5 = (ushort *)(pbVar16 + 0x31);
      local_24 = puVar5;
      local_1c = puVar5;
      if (iVar13 <= (int)puVar5) {
        puVar5 = (ushort *)(iVar13 + -1);
        local_1c = puVar5;
      }
      local_1c = puVar5;
      if (0 < (int)local_10) {
        uVar8 = (uint)local_10 & 1;
        piVar6 = &local_3c;
        for (uVar11 = (uint)local_10 >> 1; uVar11 != 0; uVar11 = uVar11 - 1) {
          *piVar6 = 0;
          piVar6 = piVar6 + 1;
        }
        for (uVar8 = (uint)(uVar8 != 0); uVar8 != 0; uVar8 = uVar8 - 1) {
          *(undefined2 *)piVar6 = 0;
          piVar6 = (int *)((int)piVar6 + 2);
        }
      }
      if ((local_10 == (ushort *)0x6) && ((int)puVar5 - (int)pbVar16 == 0x31)) {
        uVar8 = (uint)*(ushort *)(iVar2 + (int)pbVar16 * 2);
        uVar11 = (uint)*(ushort *)(iVar2 + 2 + (int)pbVar16 * 2);
        uVar17 = (uint)*(ushort *)(iVar2 + 4 + (int)pbVar16 * 2);
        uVar18 = (uint)*(ushort *)(iVar2 + 6 + (int)pbVar16 * 2);
        uVar19 = (uint)*(ushort *)(iVar2 + 8 + (int)pbVar16 * 2);
        uVar20 = (uint)*(ushort *)(iVar2 + 10 + (int)pbVar16 * 2);
        uVar21 = (uint)*(ushort *)(iVar2 + 0xc + (int)pbVar16 * 2);
        uVar22 = (uint)*(ushort *)(iVar2 + 0xe + (int)pbVar16 * 2);
        uVar23 = (uint)*(ushort *)(iVar2 + 0x10 + (int)pbVar16 * 2);
        uVar24 = (uint)*(ushort *)(iVar2 + 0x12 + (int)pbVar16 * 2);
        uVar25 = (uint)*(ushort *)(iVar2 + 0x14 + (int)pbVar16 * 2);
        uVar26 = (uint)*(ushort *)(iVar2 + 0x16 + (int)pbVar16 * 2);
        uVar27 = (uint)*(ushort *)(iVar2 + 0x18 + (int)pbVar16 * 2);
        uVar28 = (uint)*(ushort *)(iVar2 + 0x1a + (int)pbVar16 * 2);
        uVar29 = (uint)*(ushort *)(iVar2 + 0x1c + (int)pbVar16 * 2);
        uVar30 = (uint)*(ushort *)(iVar2 + 0x1e + (int)pbVar16 * 2);
        uVar31 = (uint)*(ushort *)(iVar2 + 0x20 + (int)pbVar16 * 2);
        uVar32 = (uint)*(ushort *)(iVar2 + 0x22 + (int)pbVar16 * 2);
        uVar33 = (uint)*(ushort *)(iVar2 + 0x24 + (int)pbVar16 * 2);
        uVar34 = (uint)*(ushort *)(iVar2 + 0x26 + (int)pbVar16 * 2);
        uVar35 = (uint)*(ushort *)(iVar2 + 0x28 + (int)pbVar16 * 2);
        uVar36 = (uint)*(ushort *)(iVar2 + 0x2a + (int)pbVar16 * 2);
        uVar37 = (uint)*(ushort *)(iVar2 + 0x2c + (int)pbVar16 * 2);
        uVar38 = (uint)*(ushort *)(iVar2 + 0x2e + (int)pbVar16 * 2);
        uVar39 = (uint)*(ushort *)(iVar2 + 0x30 + (int)pbVar16 * 2);
        uVar40 = (uint)*(ushort *)(iVar2 + 0x32 + (int)pbVar16 * 2);
        uVar41 = (uint)*(ushort *)(iVar2 + 0x34 + (int)pbVar16 * 2);
        uVar42 = (uint)*(ushort *)(iVar2 + 0x36 + (int)pbVar16 * 2);
        uVar43 = (uint)*(ushort *)(iVar2 + 0x38 + (int)pbVar16 * 2);
        uVar44 = (uint)*(ushort *)(iVar2 + 0x3a + (int)pbVar16 * 2);
        uVar45 = (uint)*(ushort *)(iVar2 + 0x3c + (int)pbVar16 * 2);
        uVar46 = (uint)*(ushort *)(iVar2 + 0x3e + (int)pbVar16 * 2);
        uVar47 = (uint)*(ushort *)(iVar2 + 0x40 + (int)pbVar16 * 2);
        uVar48 = (uint)*(ushort *)(iVar2 + 0x42 + (int)pbVar16 * 2);
        uVar49 = (uint)*(ushort *)(iVar2 + 0x44 + (int)pbVar16 * 2);
        uVar50 = (uint)*(ushort *)(iVar2 + 0x46 + (int)pbVar16 * 2);
        uVar51 = (uint)*(ushort *)(iVar2 + 0x48 + (int)pbVar16 * 2);
        uVar52 = (uint)*(ushort *)(iVar2 + 0x4a + (int)pbVar16 * 2);
        uVar53 = (uint)*(ushort *)(iVar2 + 0x4c + (int)pbVar16 * 2);
        uVar54 = (uint)*(ushort *)(iVar2 + 0x4e + (int)pbVar16 * 2);
        uVar55 = (uint)*(ushort *)(iVar2 + 0x50 + (int)pbVar16 * 2);
        uVar56 = (uint)*(ushort *)(iVar2 + 0x52 + (int)pbVar16 * 2);
        uVar57 = (uint)*(ushort *)(iVar2 + 0x54 + (int)pbVar16 * 2);
        uVar58 = (uint)*(ushort *)(iVar2 + 0x56 + (int)pbVar16 * 2);
        uVar59 = (uint)*(ushort *)(iVar2 + 0x58 + (int)pbVar16 * 2);
        uVar60 = (uint)*(ushort *)(iVar2 + 0x5a + (int)pbVar16 * 2);
        uVar61 = (uint)*(ushort *)(iVar2 + 0x5c + (int)pbVar16 * 2);
        uVar62 = (uint)*(ushort *)(iVar2 + 0x5e + (int)pbVar16 * 2);
        uVar63 = (uint)*(ushort *)(iVar2 + 0x60 + (int)pbVar16 * 2);
        local_c = (ushort *)(uint)*(ushort *)(iVar2 + (int)local_24 * 2);
        local_38 = *(int *)(puVar3 + uVar8 * 8 + 0x64ca) + *(int *)(puVar3 + uVar11 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar17 * 8 + 0x64ca) + *(int *)(puVar3 + uVar18 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar19 * 8 + 0x64ca) + *(int *)(puVar3 + uVar20 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar21 * 8 + 0x64ca) + *(int *)(puVar3 + uVar22 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar23 * 8 + 0x64ca) + *(int *)(puVar3 + uVar24 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar25 * 8 + 0x64ca) + *(int *)(puVar3 + uVar26 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar27 * 8 + 0x64ca) + *(int *)(puVar3 + uVar28 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar29 * 8 + 0x64ca) + *(int *)(puVar3 + uVar30 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar31 * 8 + 0x64ca) + *(int *)(puVar3 + uVar32 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar33 * 8 + 0x64ca) + *(int *)(puVar3 + uVar34 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar35 * 8 + 0x64ca) + *(int *)(puVar3 + uVar36 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar37 * 8 + 0x64ca) + *(int *)(puVar3 + uVar38 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar39 * 8 + 0x64ca) + *(int *)(puVar3 + uVar40 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar41 * 8 + 0x64ca) + *(int *)(puVar3 + uVar42 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar43 * 8 + 0x64ca) + *(int *)(puVar3 + uVar44 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar45 * 8 + 0x64ca) + *(int *)(puVar3 + uVar46 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar47 * 8 + 0x64ca) + *(int *)(puVar3 + uVar48 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar49 * 8 + 0x64ca) + *(int *)(puVar3 + uVar50 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar51 * 8 + 0x64ca) + *(int *)(puVar3 + uVar52 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar53 * 8 + 0x64ca) + *(int *)(puVar3 + uVar54 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar55 * 8 + 0x64ca) + *(int *)(puVar3 + uVar56 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar57 * 8 + 0x64ca) + *(int *)(puVar3 + uVar58 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar59 * 8 + 0x64ca) + *(int *)(puVar3 + uVar60 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar61 * 8 + 0x64ca) + *(int *)(puVar3 + uVar62 * 8 + 0x64ca) +
                   *(int *)(puVar3 + uVar63 * 8 + 0x64ca) +
                   *(int *)(puVar3 + (int)local_c * 8 + 0x64ca);
        local_34 = *(int *)(puVar3 + uVar8 * 8 + 0x64cc) + *(int *)(puVar3 + uVar11 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar17 * 8 + 0x64cc) + *(int *)(puVar3 + uVar18 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar19 * 8 + 0x64cc) + *(int *)(puVar3 + uVar20 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar21 * 8 + 0x64cc) + *(int *)(puVar3 + uVar22 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar23 * 8 + 0x64cc) + *(int *)(puVar3 + uVar24 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar25 * 8 + 0x64cc) + *(int *)(puVar3 + uVar26 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar27 * 8 + 0x64cc) + *(int *)(puVar3 + uVar28 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar29 * 8 + 0x64cc) + *(int *)(puVar3 + uVar30 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar31 * 8 + 0x64cc) + *(int *)(puVar3 + uVar32 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar33 * 8 + 0x64cc) + *(int *)(puVar3 + uVar34 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar35 * 8 + 0x64cc) + *(int *)(puVar3 + uVar36 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar37 * 8 + 0x64cc) + *(int *)(puVar3 + uVar38 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar39 * 8 + 0x64cc) + *(int *)(puVar3 + uVar40 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar41 * 8 + 0x64cc) + *(int *)(puVar3 + uVar42 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar43 * 8 + 0x64cc) + *(int *)(puVar3 + uVar44 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar45 * 8 + 0x64cc) + *(int *)(puVar3 + uVar46 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar47 * 8 + 0x64cc) + *(int *)(puVar3 + uVar48 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar49 * 8 + 0x64cc) + *(int *)(puVar3 + uVar50 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar51 * 8 + 0x64cc) + *(int *)(puVar3 + uVar52 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar53 * 8 + 0x64cc) + *(int *)(puVar3 + uVar54 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar55 * 8 + 0x64cc) + *(int *)(puVar3 + uVar56 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar57 * 8 + 0x64cc) + *(int *)(puVar3 + uVar58 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar59 * 8 + 0x64cc) + *(int *)(puVar3 + uVar60 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar61 * 8 + 0x64cc) + *(int *)(puVar3 + uVar62 * 8 + 0x64cc) +
                   *(int *)(puVar3 + uVar63 * 8 + 0x64cc) +
                   *(int *)(puVar3 + (int)local_c * 8 + 0x64cc);
        local_3c = *(int *)(puVar3 + (uVar8 + 0xc99) * 8) + *(int *)(puVar3 + (uVar11 + 0xc99) * 8)
                   + *(int *)(puVar3 + (uVar17 + 0xc99) * 8) +
                   *(int *)(puVar3 + (uVar18 + 0xc99) * 8) + *(int *)(puVar3 + (uVar19 + 0xc99) * 8)
                   + *(int *)(puVar3 + (uVar20 + 0xc99) * 8) +
                   *(int *)(puVar3 + (uVar21 + 0xc99) * 8) + *(int *)(puVar3 + (uVar22 + 0xc99) * 8)
                   + *(int *)(puVar3 + (uVar23 + 0xc99) * 8) +
                   *(int *)(puVar3 + (uVar24 + 0xc99) * 8) + *(int *)(puVar3 + (uVar25 + 0xc99) * 8)
                   + *(int *)(puVar3 + (uVar26 + 0xc99) * 8) +
                   *(int *)(puVar3 + (uVar27 + 0xc99) * 8) + *(int *)(puVar3 + (uVar28 + 0xc99) * 8)
                   + *(int *)(puVar3 + (uVar29 + 0xc99) * 8) +
                   *(int *)(puVar3 + (uVar30 + 0xc99) * 8) + *(int *)(puVar3 + (uVar31 + 0xc99) * 8)
                   + *(int *)(puVar3 + (uVar32 + 0xc99) * 8) +
                   *(int *)(puVar3 + (uVar33 + 0xc99) * 8) + *(int *)(puVar3 + (uVar34 + 0xc99) * 8)
                   + *(int *)(puVar3 + (uVar35 + 0xc99) * 8) +
                   *(int *)(puVar3 + (uVar36 + 0xc99) * 8) + *(int *)(puVar3 + (uVar37 + 0xc99) * 8)
                   + *(int *)(puVar3 + (uVar38 + 0xc99) * 8) +
                   *(int *)(puVar3 + (uVar39 + 0xc99) * 8) + *(int *)(puVar3 + (uVar40 + 0xc99) * 8)
                   + *(int *)(puVar3 + (uVar41 + 0xc99) * 8) +
                   *(int *)(puVar3 + (uVar42 + 0xc99) * 8) + *(int *)(puVar3 + (uVar43 + 0xc99) * 8)
                   + *(int *)(puVar3 + (uVar44 + 0xc99) * 8) +
                   *(int *)(puVar3 + (uVar45 + 0xc99) * 8) + *(int *)(puVar3 + (uVar46 + 0xc99) * 8)
                   + *(int *)(puVar3 + (uVar47 + 0xc99) * 8) +
                   *(int *)(puVar3 + (uVar48 + 0xc99) * 8) + *(int *)(puVar3 + (uVar49 + 0xc99) * 8)
                   + *(int *)(puVar3 + (uVar50 + 0xc99) * 8) +
                   *(int *)(puVar3 + (uVar51 + 0xc99) * 8) + *(int *)(puVar3 + (uVar52 + 0xc99) * 8)
                   + *(int *)(puVar3 + (uVar53 + 0xc99) * 8) +
                   *(int *)(puVar3 + (uVar54 + 0xc99) * 8) + *(int *)(puVar3 + (uVar55 + 0xc99) * 8)
                   + *(int *)(puVar3 + (uVar56 + 0xc99) * 8) +
                   *(int *)(puVar3 + (uVar57 + 0xc99) * 8) + *(int *)(puVar3 + (uVar58 + 0xc99) * 8)
                   + *(int *)(puVar3 + (uVar59 + 0xc99) * 8) +
                   *(int *)(puVar3 + (uVar60 + 0xc99) * 8) + *(int *)(puVar3 + (uVar61 + 0xc99) * 8)
                   + *(int *)(puVar3 + (uVar62 + 0xc99) * 8) +
                   *(int *)(puVar3 + (uVar63 + 0xc99) * 8) +
                   *(int *)(puVar3 + (int)((int)local_c + 0xc99) * 8);
      }
      else if ((int)pbVar16 <= (int)puVar5) {
        param_1 = (ushort *)(iVar2 + (int)pbVar16 * 2);
        local_c = (ushort *)((int)puVar5 + (1 - (int)pbVar16));
        do {
          if (0 < (int)local_10) {
            piVar6 = &local_3c;
            local_28 = local_10;
            pbVar12 = (byte *)(*param_1 + 0x9324 + (int)puVar3);
            do {
              *(ushort *)piVar6 = (short)*piVar6 + (ushort)*pbVar12;
              pbVar12 = pbVar12 + 0x102;
              piVar6 = (int *)((int)piVar6 + 2);
              local_28 = (ushort *)((int)local_28 + -1);
            } while (local_28 != (ushort *)0x0);
          }
          param_1 = param_1 + 1;
          local_c = (ushort *)((int)local_c + -1);
        } while (local_c != (ushort *)0x0);
      }
      param_1 = (ushort *)0x0;
      puVar5 = (ushort *)0xffffffff;
      local_28 = (ushort *)0x3b9ac9ff;
      if (0 < (int)local_10) {
        local_c = (ushort *)&local_3c;
        do {
          if ((ushort *)(uint)*local_c < local_28) {
            local_28 = (ushort *)(uint)*local_c;
            puVar5 = param_1;
          }
          param_1 = (ushort *)((int)param_1 + 1);
          local_c = local_c + 1;
        } while ((int)param_1 < (int)local_10);
      }
      local_30 = (ushort *)((int)local_30 + (int)local_28);
      *(int *)(&stack0xffffffa8 + (int)puVar5 * 4) =
           *(int *)(&stack0xffffffa8 + (int)puVar5 * 4) + 1;
      puVar9 = local_18;
      local_18 = (ushort *)((int)local_18 + 1);
      *(char *)((int)puVar9 + 0x680 + (int)puVar3) = (char)puVar5;
      if ((local_10 == (ushort *)0x6) && ((int)local_1c - (int)pbVar16 == 0x31)) {
        iVar13 = (int)(puVar5 + 0x16) * 0x102;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + (int)pbVar16 * 2) + iVar13) * 2) + 1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 2 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 2 + (int)pbVar16 * 2) + iVar13) * 2) + 1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 4 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 4 + (int)pbVar16 * 2) + iVar13) * 2) + 1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 6 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 6 + (int)pbVar16 * 2) + iVar13) * 2) + 1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 8 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 8 + (int)pbVar16 * 2) + iVar13) * 2) + 1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 10 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 10 + (int)pbVar16 * 2) + iVar13) * 2) + 1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0xc + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0xc + (int)pbVar16 * 2) + iVar13) * 2) + 1
        ;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0xe + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0xe + (int)pbVar16 * 2) + iVar13) * 2) + 1
        ;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x10 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x10 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x12 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x12 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x14 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x14 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x16 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x16 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x18 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x18 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x1a + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x1a + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x1c + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x1c + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x1e + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x1e + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x20 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x20 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x22 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x22 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x24 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x24 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x26 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x26 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x28 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x28 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x2a + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x2a + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x2c + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x2c + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x2e + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x2e + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x30 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x30 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x32 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x32 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x34 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x34 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x36 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x36 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x38 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x38 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x3a + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x3a + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x3c + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x3c + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x3e + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x3e + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x40 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x40 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x42 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x42 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x44 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x44 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x46 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x46 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x48 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x48 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x4a + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x4a + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x4c + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x4c + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x4e + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x4e + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x50 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x50 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x52 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x52 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x54 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x54 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x56 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x56 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x58 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x58 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x5a + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x5a + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x5c + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x5c + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x5e + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x5e + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x60 + (int)pbVar16 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + 0x60 + (int)pbVar16 * 2) + iVar13) * 2) +
             1;
        *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + (int)local_24 * 2) + iVar13) * 2) =
             *(int *)(puVar3 + ((uint)*(ushort *)(iVar2 + (int)local_24 * 2) + iVar13) * 2) + 1;
      }
      else if ((int)pbVar16 <= (int)local_1c) {
        puVar9 = (ushort *)(iVar2 + (int)pbVar16 * 2);
        pbVar16 = (byte *)((int)local_1c + (1 - (int)pbVar16));
        do {
          *(int *)(puVar3 + ((uint)*puVar9 + (int)(puVar5 + 0x16) * 0x102) * 2) =
               *(int *)(puVar3 + ((uint)*puVar9 + (int)(puVar5 + 0x16) * 0x102) * 2) + 1;
          puVar9 = puVar9 + 1;
          pbVar16 = pbVar16 + -1;
        } while (pbVar16 != (byte *)0x0);
      }
      pbVar16 = (byte *)((int)local_1c + 1);
    }
    if (2 < *(int *)(puVar3 + 0x134)) {
      FUN_676afdac((int *)&DAT_676c2138,(byte *)s_pass__d__size_is__d__grp_uses_ar_676bf56c);
      if (0 < (int)local_10) {
        local_30 = local_10;
        do {
          FUN_676afdac((int *)&DAT_676c2138,&DAT_676bf568);
          local_30 = (ushort *)((int)local_30 - 1);
        } while (local_30 != (ushort *)0x0);
      }
      FUN_676afdac((int *)&DAT_676c2138,&DAT_676bf564);
    }
    if (0 < (int)local_10) {
      param_1 = puVar3 + 0x4992;
      puVar5 = puVar3 + 0x58b0;
      local_30 = local_10;
      do {
        FUN_67677748((int)param_1,(int *)puVar5,(int)local_14,0x14);
        param_1 = param_1 + 0x81;
        puVar5 = puVar5 + 0x204;
        local_30 = (ushort *)((int)local_30 - 1);
      } while (local_30 != (ushort *)0x0);
    }
    local_20 = (ushort *)((int)local_20 + 1);
  } while ((int)local_20 < 4);
  if (7 < (int)local_10) {
    FUN_6767268b(0xbba,in_stack_ffffffac,in_stack_ffffffb0,in_stack_ffffffb4);
  }
  if ((0x7fff < (int)local_18) || (0x4652 < (int)local_18)) {
    FUN_6767268b(0xbbb,in_stack_ffffffac,in_stack_ffffffb0,in_stack_ffffffb4);
  }
  iVar4 = 0;
  iVar13 = 0;
  if (0 < (int)local_10) {
    do {
      *(char *)((int)&local_30 + iVar13) = (char)iVar13;
      iVar13 = iVar13 + 1;
    } while (iVar13 < (int)local_10);
  }
  if (0 < (int)local_18) {
    do {
      iVar7 = 0;
      iVar13 = iVar7;
      param_1._3_1_ = (byte)local_30;
      puVar5 = local_30;
      if (*(byte *)((int)puVar3 + iVar4 + 0x680) != (byte)local_30) {
        do {
          param_1._3_1_ = (byte)puVar5;
          iVar7 = iVar13 + 1;
          local_5 = param_1._3_1_;
          bVar1 = *(byte *)((int)&local_30 + iVar13 + 1);
          puVar5 = (ushort *)(uint)bVar1;
          *(byte *)((int)&local_30 + iVar13 + 1) = param_1._3_1_;
          iVar13 = iVar7;
          param_1._3_1_ = bVar1;
        } while (*(byte *)((int)puVar3 + iVar4 + 0x680) != bVar1);
      }
      *(char *)(iVar4 + 0x4cd2 + (int)puVar3) = (char)iVar7;
      iVar4 = iVar4 + 1;
      local_30 = (ushort *)CONCAT31(local_30._1_3_,param_1._3_1_);
    } while (iVar4 < (int)local_18);
  }
  if (0 < (int)local_10) {
    local_30 = puVar3 + 0x4c98;
    local_28 = local_10;
    puVar5 = puVar3 + 0x4992;
    do {
      iVar13 = 0;
      local_20 = (ushort *)0x20;
      param_1 = (ushort *)0x0;
      if (0 < (int)local_14) {
        do {
          puVar9 = (ushort *)(uint)*(byte *)((int)puVar5 + iVar13);
          if (param_1 < puVar9) {
            param_1 = puVar9;
          }
          if (puVar9 < local_20) {
            local_20 = puVar9;
          }
          iVar13 = iVar13 + 1;
        } while (iVar13 < (int)local_14);
        if ((ushort *)0x14 < param_1) {
          FUN_6767268b(0xbbc,in_stack_ffffffac,in_stack_ffffffb0,in_stack_ffffffb4);
        }
        if ((int)local_20 < 1) {
          FUN_6767268b(0xbbd,in_stack_ffffffac,in_stack_ffffffb0,in_stack_ffffffb4);
        }
      }
      FUN_67677a85((int *)local_30,(int)puVar5,(uint)local_20,(int)param_1,(int)local_14);
      local_30 = local_30 + 0x204;
      puVar5 = puVar5 + 0x81;
      local_28 = (ushort *)((int)local_28 - 1);
    } while (local_28 != (ushort *)0x0);
  }
  puVar5 = puVar3 + 0x2c;
  iVar13 = 0;
  do {
    local_40[iVar13] = '\0';
    iVar4 = 0;
    do {
      if (*(char *)(iVar4 + (int)puVar5) != '\0') {
        local_40[iVar13] = '\x01';
      }
      iVar4 = iVar4 + 1;
    } while (iVar4 < 0x10);
    iVar13 = iVar13 + 1;
    puVar5 = puVar5 + 8;
  } while (iVar13 < 0x10);
  iVar13 = 0;
  local_20 = (ushort *)*(undefined4 *)(puVar3 + 0x26);
  do {
    FUN_67673c72((int)puVar3,1,(uint)(local_40[iVar13] != '\0'));
    iVar13 = iVar13 + 1;
  } while (iVar13 < 0x10);
  param_1 = (ushort *)0x0;
  local_30 = puVar3 + 0x2c;
  do {
    if (local_40[(int)param_1] != '\0') {
      iVar13 = 0;
      do {
        FUN_67673c72((int)puVar3,1,(uint)(*(char *)(iVar13 + (int)local_30) != '\0'));
        iVar13 = iVar13 + 1;
      } while (iVar13 < 0x10);
    }
    param_1 = (ushort *)((int)param_1 + 1);
    local_30 = local_30 + 8;
  } while ((int)param_1 < 0x10);
  if (2 < *(int *)(puVar3 + 0x134)) {
    FUN_676afdac((int *)&DAT_676c2138,(byte *)s_bytes__mapping__d__676bf548);
  }
  local_20 = *(ushort **)(puVar3 + 0x26);
  FUN_67673c72((int)puVar3,3,(int)local_10);
  FUN_67673c72((int)puVar3,0xf,(int)local_18);
  if (0 < (int)local_18) {
    local_30 = (ushort *)(-(int)puVar3 - 0x4cd2);
    puVar5 = puVar3 + 0x2669;
    do {
      param_1 = (ushort *)0x0;
      if ((byte)*puVar5 != 0) {
        do {
          FUN_67673c72((int)puVar3,1,1);
          param_1 = (ushort *)((int)param_1 + 1);
        } while ((int)param_1 < (int)(uint)(byte)*puVar5);
      }
      FUN_67673c72((int)puVar3,1,0);
      puVar5 = (ushort *)((int)puVar5 + 1);
    } while ((int)((int)local_30 + (int)puVar5) < (int)local_18);
  }
  if (2 < *(int *)(puVar3 + 0x134)) {
    FUN_676afdac((int *)&DAT_676c2138,(byte *)s_selectors__d__676bf538);
  }
  local_20 = *(ushort **)(puVar3 + 0x26);
  if (0 < (int)local_10) {
    local_1c = puVar3 + 0x4992;
    local_28 = local_10;
    do {
      param_1 = (ushort *)(uint)(byte)*local_1c;
      FUN_67673c72((int)puVar3,5,(int)param_1);
      if (0 < (int)local_14) {
        local_30 = local_14;
        puVar5 = local_1c;
        do {
          for (; (int)param_1 < (int)(uint)(byte)*puVar5; param_1 = (ushort *)((int)param_1 + 1)) {
            FUN_67673c72((int)puVar3,2,2);
          }
          for (; (int)(uint)(byte)*puVar5 < (int)param_1; param_1 = (ushort *)((int)param_1 + -1)) {
            FUN_67673c72((int)puVar3,2,3);
          }
          FUN_67673c72((int)puVar3,1,0);
          puVar5 = (ushort *)((int)puVar5 + 1);
          local_30 = (ushort *)((int)local_30 - 1);
        } while (local_30 != (ushort *)0x0);
      }
      local_1c = local_1c + 0x81;
      local_28 = (ushort *)((int)local_28 - 1);
    } while (local_28 != (ushort *)0x0);
  }
  if (2 < *(int *)(puVar3 + 0x134)) {
    FUN_676afdac((int *)&DAT_676c2138,(byte *)s_code_lengths__d__676bf524);
  }
  local_20 = *(ushort **)(puVar3 + 0x26);
  local_14 = (ushort *)0x0;
  local_30 = puVar3 + 0x340;
  param_1 = (ushort *)0x0;
  while (iVar13 = *(int *)(puVar3 + 0x13a), (int)param_1 < iVar13) {
    local_24 = (ushort *)((int)param_1 + 0x31);
    local_1c = local_24;
    if (iVar13 <= (int)local_24) {
      local_1c = (ushort *)(iVar13 + -1);
    }
    iVar13 = (int)local_14 + 0x680;
    if ((int)local_10 <= (int)(uint)*(byte *)((int)local_14 + 0x680 + (int)puVar3)) {
      FUN_6767268b(0xbbe,in_stack_ffffffac,in_stack_ffffffb0,in_stack_ffffffb4);
    }
    if ((local_10 == (ushort *)0x6) && ((int)local_1c - (int)param_1 == 0x31)) {
      uVar8 = (uint)*(byte *)(iVar13 + (int)puVar3);
      iVar13 = uVar8 + 0x92;
      uVar11 = (uint)*(ushort *)(iVar2 + (int)param_1 * 2);
      local_c = puVar3 + (uVar8 + 0x26) * 0x204;
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar11 + iVar13 * 0x102),
                   *(int *)(local_c + uVar11 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 2 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 4 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 6 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 8 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 10 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0xc + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0xe + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x10 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x12 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x14 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x16 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x18 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x1a + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x1c + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x1e + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x20 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x22 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x24 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x26 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x28 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x2a + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x2c + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x2e + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x30 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x32 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x34 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x36 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x38 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x3a + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x3c + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x3e + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x40 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x42 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x44 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x46 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x48 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x4a + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x4c + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x4e + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x50 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x52 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x54 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x56 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x58 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x5a + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x5c + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x5e + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + 0x60 + (int)param_1 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
      uVar8 = (uint)*(ushort *)(iVar2 + (int)local_24 * 2);
      FUN_67673c72((int)puVar3,(uint)*(byte *)((int)puVar3 + uVar8 + iVar13 * 0x102),
                   *(int *)(local_c + uVar8 * 2));
    }
    else if ((int)param_1 <= (int)local_1c) {
      pbVar16 = (byte *)((int)local_1c + (1 - (int)param_1));
      param_1 = (ushort *)(iVar2 + (int)param_1 * 2);
      do {
        FUN_67673c72((int)puVar3,
                     (uint)*(byte *)(((byte)*local_30 + 0x92) * 0x102 + (uint)*param_1 + (int)puVar3
                                    ),
                     *(int *)(puVar3 + (((byte)*local_30 + 0x26) * 0x102 + (uint)*param_1) * 2));
        param_1 = param_1 + 1;
        pbVar16 = pbVar16 + -1;
      } while (pbVar16 != (byte *)0x0);
    }
    local_14 = (ushort *)((int)local_14 + 1);
    local_30 = (ushort *)((int)local_30 + 1);
    param_1 = (ushort *)((int)local_1c + 1);
  }
  if (local_14 != local_18) {
    FUN_6767268b(0xbbf,in_stack_ffffffac,in_stack_ffffffb0,in_stack_ffffffb4);
  }
  if (2 < *(int *)(puVar3 + 0x134)) {
    FUN_676afdac((int *)&DAT_676c2138,(byte *)s_codes__d_676bf518);
  }
  return;
}



// Function: FUN_676757cd at 676757cd

undefined4 FUN_676757cd(int *param_1)

{
  ushort *puVar1;
  uint *puVar2;
  undefined1 uVar3;
  ushort uVar4;
  char cVar5;
  int *piVar6;
  int *piVar7;
  int iVar8;
  undefined1 *puVar9;
  int *piVar10;
  int iVar11;
  byte bVar12;
  uint uVar13;
  int iVar14;
  int *piVar15;
  int *piVar16;
  undefined1 unaff_BL;
  int iVar17;
  int unaff_ESI;
  int unaff_EDI;
  undefined4 uVar18;
  int iVar19;
  uint uVar20;
  byte *pbVar21;
  bool bVar22;
  int iVar23;
  int in_stack_ffffff88;
  int in_stack_ffffff8c;
  undefined1 in_stack_ffffff90;
  uint local_60;
  uint local_5c;
  uint local_58;
  int *local_54;
  int local_50;
  int local_4c;
  int local_48;
  int local_44;
  int *local_40;
  int *local_3c;
  int *local_38;
  uint local_34;
  int local_30;
  uint local_2c;
  uint local_28;
  uint local_24;
  int local_20;
  uint local_1c;
  uint local_18;
  int local_14;
  int local_10;
  int local_c;
  uint local_8;
  
  piVar6 = param_1;
  uVar18 = 0;
  iVar8 = *param_1;
  if ((param_1[1] == 10) || ((param_1[1] == 0xd && ((char)param_1[0x3e9d] != '\0')))) {
    param_1[0x3e85] = 0;
    param_1[0x3e86] = 0;
    param_1[0x3e87] = 0;
    param_1[0x3e88] = 0;
    param_1[0x3e89] = 0;
    param_1[0x3e8a] = 0;
    param_1[0x3e8b] = 0;
    param_1[0x3e8c] = 0;
    param_1[0x3e8d] = 0;
    param_1[0x3e8e] = 0;
    param_1[0x3e8f] = 0;
    param_1[0x3e90] = 0;
    param_1[0x3e91] = 0;
    param_1[0x3e92] = 0;
    param_1[0x3e93] = 0;
    param_1[0x3e94] = 0;
    param_1[0x3e95] = 0;
    param_1[0x3e96] = 0;
    param_1[0x3e97] = 0;
    param_1[0x3e98] = 0;
    param_1[0x3e99] = 0;
    param_1[0x3e9a] = 0;
    param_1[0x3e9b] = 0;
    param_1[0x3e9c] = 0;
  }
  local_8 = param_1[0x3e85];
  local_18 = param_1[0x3e86];
  local_28 = param_1[0x3e87];
  local_44 = param_1[0x3e88];
  local_2c = param_1[0x3e89];
  local_34 = param_1[0x3e8a];
  local_60 = param_1[0x3e8b];
  local_48 = param_1[0x3e8c];
  local_20 = param_1[0x3e8d];
  local_30 = param_1[0x3e8e];
  local_54 = (int *)param_1[0x3e8f];
  local_14 = param_1[0x3e90];
  local_10 = param_1[0x3e91];
  local_4c = param_1[0x3e92];
  local_24 = param_1[0x3e93];
  iVar23 = param_1[0x3e94];
  local_c = param_1[0x3e95];
  local_1c = param_1[0x3e96];
  local_58 = param_1[0x3e97];
  local_5c = param_1[0x3e98];
  local_50 = param_1[0x3e99];
  local_38 = (int *)param_1[0x3e9a];
  local_3c = (int *)param_1[0x3e9b];
  local_40 = (int *)param_1[0x3e9c];
  iVar11 = local_48;
  switch(param_1[1]) {
  case 10:
    param_1[1] = 10;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar19 = param_1[8];
    param_1[8] = iVar19 + -8;
    if ((char)((uint)param_1[7] >> ((char)iVar19 - 8U & 0x1f)) == 'B')
    goto switchD_67675972_caseD_b;
    goto LAB_676759de;
  case 0xb:
switchD_67675972_caseD_b:
    param_1[1] = 0xb;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      if (piVar10[1] == 0) goto LAB_67677195;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar19 = param_1[8];
    param_1[8] = iVar19 + -8;
    if ((char)((uint)param_1[7] >> ((char)iVar19 - 8U & 0x1f)) == 'Z')
    goto switchD_67675972_caseD_c;
    goto LAB_676759de;
  case 0xc:
switchD_67675972_caseD_c:
    param_1[1] = 0xc;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      if (piVar10[1] == 0) goto LAB_67677195;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar19 = param_1[8];
    param_1[8] = iVar19 + -8;
    if ((char)((uint)param_1[7] >> ((char)iVar19 - 8U & 0x1f)) == 'h')
    goto switchD_67675972_caseD_d;
    goto LAB_676759de;
  case 0xd:
switchD_67675972_caseD_d:
    param_1[1] = 0xd;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      if (piVar10[1] == 0) goto LAB_67677195;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar19 = param_1[8];
    param_1[8] = iVar19 + -8;
    uVar13 = (uint)param_1[7] >> ((char)iVar19 - 8U & 0x1f) & 0xff;
    param_1[9] = uVar13;
    if ((0x30 < uVar13) && (uVar13 < 0x3a)) {
      iVar19 = uVar13 - 0x30;
      param_1[9] = iVar19;
      if ((char)param_1[10] == '\0') {
        iVar8 = (**(code **)(iVar8 + 0x24))(*(undefined4 *)(iVar8 + 0x2c),iVar19 * 400000,1);
        param_1[0x313] = iVar8;
LAB_67675b6e:
        if (iVar8 != 0) goto switchD_67675972_caseD_e;
      }
      else {
        iVar19 = (**(code **)(iVar8 + 0x24))(*(undefined4 *)(iVar8 + 0x2c),iVar19 * 200000);
        param_1[0x314] = iVar19;
        iVar8 = (**(code **)(iVar8 + 0x24))
                          (*(undefined4 *)(iVar8 + 0x2c),param_1[9] * 100000 + 1 >> 1,1);
        param_1[0x315] = iVar8;
        if (param_1[0x314] != 0) goto LAB_67675b6e;
      }
      uVar18 = 0xfffffffd;
      goto LAB_67677591;
    }
LAB_676759de:
    uVar18 = 0xfffffffb;
    goto LAB_67677591;
  case 0xe:
switchD_67675972_caseD_e:
    param_1[1] = 0xe;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      if (piVar10[1] == 0) goto LAB_67677195;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    cVar5 = (char)((uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f));
    if ((char)param_1[0x3e9d] == '\0') {
      if (cVar5 != '\x17') {
        if (cVar5 != '1') break;
        goto switchD_67675972_caseD_f;
      }
      goto switchD_67675972_caseD_2a;
    }
    if (cVar5 != '\x17') {
      if (cVar5 == '1') goto switchD_67675972_caseD_18;
      break;
    }
    param_1[0x317] = 0;
    goto LAB_6767756e;
  case 0xf:
switchD_67675972_caseD_f:
    param_1[1] = 0xf;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    if ((char)((uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f)) == 'A')
    goto switchD_67675972_caseD_10;
    break;
  case 0x10:
switchD_67675972_caseD_10:
    param_1[1] = 0x10;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    if ((char)((uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f)) == 'Y')
    goto switchD_67675972_caseD_11;
    break;
  case 0x11:
switchD_67675972_caseD_11:
    param_1[1] = 0x11;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    if ((char)((uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f)) == '&')
    goto switchD_67675972_caseD_12;
    break;
  case 0x12:
switchD_67675972_caseD_12:
    param_1[1] = 0x12;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    if ((char)((uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f)) == 'S')
    goto switchD_67675972_caseD_13;
    break;
  case 0x13:
switchD_67675972_caseD_13:
    param_1[1] = 0x13;
    uVar18 = 0;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    if ((char)((uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f)) == 'Y') {
      param_1[0xb] = param_1[0xb] + 1;
      if (1 < param_1[0xc]) {
        FUN_676afdac((int *)&DAT_676c2138,(byte *)s___d__huff_mtf_676bfa1c);
      }
      param_1[0x316] = 0;
      goto switchD_67675972_caseD_14;
    }
    break;
  case 0x14:
switchD_67675972_caseD_14:
    param_1[1] = 0x14;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    param_1[0x316] = param_1[0x316] << 8 | (uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f) & 0xff;
  case 0x15:
    param_1[1] = 0x15;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    param_1[0x316] = param_1[0x316] << 8 | (uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f) & 0xff;
switchD_67675972_caseD_16:
    param_1[1] = 0x16;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    param_1[0x316] = param_1[0x316] << 8 | (uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f) & 0xff;
switchD_67675972_caseD_17:
    param_1[1] = 0x17;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    param_1[0x316] = param_1[0x316] << 8 | (uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f) & 0xff;
switchD_67675972_caseD_18:
    param_1[1] = 0x18;
    while (param_1[8] < 1) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[0xd] = 0;
    param_1[8] = iVar8 + -1;
    *(byte *)(param_1 + 4) = (byte)((uint)param_1[7] >> ((char)iVar8 - 1U & 0x1f)) & 1;
switchD_67675972_caseD_19:
    param_1[1] = 0x19;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    param_1[0xd] = param_1[0xd] << 8 | (uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f) & 0xff;
switchD_67675972_caseD_1a:
    param_1[1] = 0x1a;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    param_1[0xd] = param_1[0xd] << 8 | (uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f) & 0xff;
switchD_67675972_caseD_1b:
    param_1[1] = 0x1b;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    uVar13 = param_1[0xd] << 8 | (uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f) & 0xff;
    param_1[0xd] = uVar13;
    if ((-1 < (int)uVar13) && ((int)uVar13 <= param_1[9] * 100000 + 10)) {
      for (local_8 = 0; (int)local_8 < 0x10; local_8 = local_8 + 1) {
switchD_67675972_caseD_1c:
        param_1[1] = 0x1c;
        while (param_1[8] < 1) {
          piVar10 = (int *)*param_1;
          uVar18 = 0;
          if (piVar10[1] == 0) goto LAB_67677591;
          param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
          param_1[8] = param_1[8] + 8;
          *piVar10 = *piVar10 + 1;
          *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
          *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
          if (*(int *)(*param_1 + 8) == 0) {
            piVar10 = (int *)(*param_1 + 0xc);
            *piVar10 = *piVar10 + 1;
          }
        }
        iVar8 = param_1[8];
        param_1[8] = iVar8 + -1;
        if (((byte)((uint)param_1[7] >> ((char)iVar8 - 1U & 0x1f)) & 1) == 1) {
          *(undefined1 *)(local_8 + 0xd6c + (int)param_1) = 1;
        }
        else {
          *(undefined1 *)(local_8 + 0xd6c + (int)param_1) = 0;
        }
      }
      local_8 = 0;
      piVar10 = param_1 + 0x31b;
      for (iVar8 = 0x40; iVar8 != 0; iVar8 = iVar8 + -1) {
        *piVar10 = 0;
        piVar10 = piVar10 + 1;
      }
      for (; (int)local_8 < 0x10; local_8 = local_8 + 1) {
        if (*(char *)(local_8 + 0xd6c + (int)param_1) != '\0') {
          for (local_18 = 0; (int)local_18 < 0x10; local_18 = local_18 + 1) {
switchD_67675972_caseD_1d:
            param_1[1] = 0x1d;
            while (param_1[8] < 1) {
              piVar10 = (int *)*param_1;
              uVar18 = 0;
              if (piVar10[1] == 0) goto LAB_67677591;
              param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
              param_1[8] = param_1[8] + 8;
              *piVar10 = *piVar10 + 1;
              *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
              *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
              if (*(int *)(*param_1 + 8) == 0) {
                piVar10 = (int *)(*param_1 + 0xc);
                *piVar10 = *piVar10 + 1;
              }
            }
            iVar8 = param_1[8];
            param_1[8] = iVar8 + -1;
            if (((byte)((uint)param_1[7] >> ((char)iVar8 - 1U & 0x1f)) & 1) == 1) {
              *(undefined1 *)(local_8 * 0x10 + local_18 + 0xc6c + (int)param_1) = 1;
            }
          }
        }
      }
      FUN_67677714((int)param_1);
      if (param_1[0x31a] != 0) {
        local_44 = param_1[0x31a] + 2;
switchD_67675972_caseD_1e:
        param_1[1] = 0x1e;
        while (param_1[8] < 3) {
          piVar10 = (int *)*param_1;
          uVar18 = 0;
          if (piVar10[1] == 0) goto LAB_67677591;
          param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
          param_1[8] = param_1[8] + 8;
          *piVar10 = *piVar10 + 1;
          *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
          *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
          if (*(int *)(*param_1 + 8) == 0) {
            piVar10 = (int *)(*param_1 + 0xc);
            *piVar10 = *piVar10 + 1;
          }
        }
        iVar8 = param_1[8];
        param_1[8] = iVar8 + -3;
        local_2c = (uint)param_1[7] >> ((char)iVar8 - 3U & 0x1f) & 7;
        if ((1 < local_2c) && (local_2c < 7)) {
switchD_67675972_caseD_1f:
          param_1[1] = 0x1f;
          uVar18 = 0;
          while (param_1[8] < 0xf) {
            piVar10 = (int *)*param_1;
            if (piVar10[1] == 0) goto LAB_67677591;
            param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
            param_1[8] = param_1[8] + 8;
            *piVar10 = *piVar10 + 1;
            *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
            *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
            if (*(int *)(*param_1 + 8) == 0) {
              piVar10 = (int *)(*param_1 + 0xc);
              *piVar10 = *piVar10 + 1;
            }
          }
          iVar8 = param_1[8];
          param_1[8] = iVar8 + -0xf;
          local_34 = (uint)param_1[7] >> ((char)iVar8 - 0xfU & 0x1f) & 0x7fff;
          if (local_34 != 0) {
            local_8 = 0;
            while ((int)local_8 < (int)local_34) {
              local_18 = 0;
switchD_67675972_caseD_20:
              while( true ) {
                param_1[1] = 0x20;
                while (param_1[8] < 1) {
                  piVar10 = (int *)*param_1;
                  uVar18 = 0;
                  if (piVar10[1] == 0) goto LAB_67677591;
                  param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
                  param_1[8] = param_1[8] + 8;
                  *piVar10 = *piVar10 + 1;
                  *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
                  *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
                  if (*(int *)(*param_1 + 8) == 0) {
                    piVar10 = (int *)(*param_1 + 0xc);
                    *piVar10 = *piVar10 + 1;
                  }
                }
                iVar8 = param_1[8];
                param_1[8] = iVar8 + -1;
                if (((uint)param_1[7] >> ((char)iVar8 - 1U & 0x1f) & 1) == 0) break;
                local_18 = local_18 + 1;
                if ((int)local_2c <= (int)local_18) goto LAB_67675c06;
              }
              *(undefined1 *)(local_8 + 0x650e + (int)param_1) = (undefined1)local_18;
              local_8 = local_8 + 1;
            }
            bVar12 = 0;
            if (0 < (int)local_2c) {
              uVar13 = 0;
              do {
                (&stack0xffffff88)[uVar13] = bVar12;
                bVar12 = bVar12 + 1;
                uVar13 = (uint)bVar12;
              } while ((int)uVar13 < (int)local_2c);
            }
            local_8 = 0;
            if (0 < (int)local_34) {
              do {
                bVar12 = *(byte *)((int)param_1 + local_8 + 0x650e);
                uVar13 = (uint)bVar12;
                uVar3 = (&stack0xffffff88)[uVar13];
                puVar9 = &stack0xffffff88 + uVar13;
                if (bVar12 != 0) {
                  do {
                    *puVar9 = puVar9[-1];
                    uVar13 = uVar13 - 1;
                    puVar9 = puVar9 + -1;
                  } while (uVar13 != 0);
                }
                *(undefined1 *)(local_8 + 0x1ebc + (int)param_1) = uVar3;
                local_8 = local_8 + 1;
              } while ((int)local_8 < (int)local_34);
            }
            for (local_28 = 0; (int)local_28 < (int)local_2c; local_28 = local_28 + 1) {
switchD_67675972_caseD_21:
              param_1[1] = 0x21;
              while (param_1[8] < 5) {
                piVar10 = (int *)*param_1;
                uVar18 = 0;
                if (piVar10[1] == 0) goto LAB_67677591;
                param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
                param_1[8] = param_1[8] + 8;
                *piVar10 = *piVar10 + 1;
                *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
                *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
                if (*(int *)(*param_1 + 8) == 0) {
                  piVar10 = (int *)(*param_1 + 0xc);
                  *piVar10 = *piVar10 + 1;
                }
              }
              iVar8 = param_1[8];
              param_1[8] = iVar8 + -5;
              local_24 = (uint)param_1[7] >> ((char)iVar8 - 5U & 0x1f) & 0x1f;
              local_8 = 0;
              while ((int)local_8 < local_44) {
                while( true ) {
                  if (((int)local_24 < 1) || (0x14 < (int)local_24)) goto LAB_67675c06;
switchD_67675972_caseD_22:
                  param_1[1] = 0x22;
                  while (param_1[8] < 1) {
                    piVar10 = (int *)*param_1;
                    uVar18 = 0;
                    if (piVar10[1] == 0) goto LAB_67677591;
                    param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
                    param_1[8] = param_1[8] + 8;
                    *piVar10 = *piVar10 + 1;
                    *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
                    *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
                    if (*(int *)(*param_1 + 8) == 0) {
                      piVar10 = (int *)(*param_1 + 0xc);
                      *piVar10 = *piVar10 + 1;
                    }
                  }
                  iVar8 = param_1[8];
                  param_1[8] = iVar8 + -1;
                  if (((uint)param_1[7] >> ((char)iVar8 - 1U & 0x1f) & 1) == 0) break;
switchD_67675972_caseD_23:
                  param_1[1] = 0x23;
                  while (param_1[8] < 1) {
                    piVar10 = (int *)*param_1;
                    uVar18 = 0;
                    if (piVar10[1] == 0) goto LAB_67677591;
                    param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
                    param_1[8] = param_1[8] + 8;
                    *piVar10 = *piVar10 + 1;
                    *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
                    *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
                    if (*(int *)(*param_1 + 8) == 0) {
                      piVar10 = (int *)(*param_1 + 0xc);
                      *piVar10 = *piVar10 + 1;
                    }
                  }
                  iVar8 = param_1[8];
                  param_1[8] = iVar8 + -1;
                  if (((uint)param_1[7] >> ((char)iVar8 - 1U & 0x1f) & 1) == 0) {
                    local_24 = local_24 + 1;
                  }
                  else {
                    local_24 = local_24 - 1;
                  }
                }
                iVar8 = local_28 * 0x102 + local_8;
                local_8 = local_8 + 1;
                *(undefined1 *)(iVar8 + 0xab60 + (int)param_1) = (undefined1)local_24;
              }
            }
            local_28 = 0;
            if (0 < (int)local_2c) {
              local_54 = param_1 + 0x2ad8;
              piVar10 = param_1 + 15999;
              piVar15 = param_1 + 0x3267;
              local_60 = local_2c;
              local_28 = local_2c;
              do {
                piVar16 = (int *)0x0;
                iVar8 = 0;
                param_1 = (int *)0x20;
                if (0 < local_44) {
                  do {
                    piVar7 = (int *)(uint)*(byte *)((int)local_54 + iVar8);
                    if (piVar16 < piVar7) {
                      piVar16 = piVar7;
                    }
                    if (piVar7 < param_1) {
                      param_1 = piVar7;
                    }
                    iVar8 = iVar8 + 1;
                  } while (iVar8 < local_44);
                }
                FUN_67677ac1(piVar15 + -0x60c,piVar15,(int)(piVar15 + 0x60c),(int)local_54,
                             (uint)param_1,(int)piVar16,local_44);
                local_54 = (int *)((int)local_54 + 0x102);
                *piVar10 = (int)param_1;
                piVar10 = piVar10 + 1;
                piVar15 = piVar15 + 0x102;
                local_60 = local_60 - 1;
              } while (local_60 != 0);
            }
            local_20 = 0;
            local_60 = piVar6[0x31a] + 1;
            local_54 = (int *)(piVar6[9] * 100000);
            piVar10 = piVar6 + 0x10;
            for (iVar8 = 0x100; iVar8 != 0; iVar8 = iVar8 + -1) {
              *piVar10 = 0;
              piVar10 = piVar10 + 1;
            }
            local_8 = 0x100;
            iVar11 = 0xfff;
            iVar8 = 0xf;
            piVar10 = piVar6 + 0x7ae;
            do {
              param_1 = (int *)0xf;
              do {
                iVar19 = iVar11;
                *(char *)(iVar19 + 0xe7c + (int)piVar6) = (char)param_1 + (char)iVar8 * '\x10';
                iVar11 = iVar19 + -1;
                param_1 = (int *)((int)param_1 + -1);
              } while (-1 < (int)param_1);
              iVar8 = iVar8 + -1;
              *piVar10 = iVar19;
              piVar10 = piVar10 + -1;
            } while (-1 < iVar8);
            local_14 = 0;
            local_48 = 0;
            iVar11 = local_48;
            if (0 < (int)local_34) {
              local_5c = (uint)*(byte *)(piVar6 + 0x7af);
              local_20 = 0x31;
              local_50 = piVar6[local_5c + 15999];
              local_38 = piVar6 + local_5c * 0x102 + 0x2c5b;
              local_40 = piVar6 + local_5c * 0x102 + 0x3873;
              local_3c = piVar6 + local_5c * 0x102 + 0x3267;
              local_c = local_50;
switchD_67675972_caseD_24:
              piVar6[1] = 0x24;
              while (piVar6[8] < local_c) {
                piVar10 = (int *)*piVar6;
                uVar18 = 0;
                if (piVar10[1] == 0) goto LAB_67677591;
                piVar6[7] = piVar6[7] << 8 | (uint)*(byte *)*piVar10;
                piVar6[8] = piVar6[8] + 8;
                *piVar10 = *piVar10 + 1;
                *(int *)(*piVar6 + 4) = *(int *)(*piVar6 + 4) + -1;
                *(int *)(*piVar6 + 8) = *(int *)(*piVar6 + 8) + 1;
                if (*(int *)(*piVar6 + 8) == 0) {
                  piVar10 = (int *)(*piVar6 + 0xc);
                  *piVar10 = *piVar10 + 1;
                }
              }
              iVar8 = piVar6[8];
              piVar6[8] = iVar8 - local_c;
              local_1c = (uint)piVar6[7] >> ((byte)(iVar8 - local_c) & 0x1f) &
                         (1 << ((byte)local_c & 0x1f)) - 1U;
              while (iVar11 = local_48, local_c < 0x15) {
                if ((int)local_1c <= local_38[local_c]) {
                  iVar8 = local_1c - local_3c[local_c];
                  goto LAB_67676954;
                }
                local_c = local_c + 1;
switchD_67675972_caseD_25:
                piVar6[1] = 0x25;
                while (piVar6[8] < 1) {
                  piVar10 = (int *)*piVar6;
                  uVar18 = 0;
                  if (piVar10[1] == 0) goto LAB_67677591;
                  piVar6[7] = piVar6[7] << 8 | (uint)*(byte *)*piVar10;
                  piVar6[8] = piVar6[8] + 8;
                  *piVar10 = *piVar10 + 1;
                  *(int *)(*piVar6 + 4) = *(int *)(*piVar6 + 4) + -1;
                  *(int *)(*piVar6 + 8) = *(int *)(*piVar6 + 8) + 1;
                  if (*(int *)(*piVar6 + 8) == 0) {
                    piVar10 = (int *)(*piVar6 + 0xc);
                    *piVar10 = *piVar10 + 1;
                  }
                }
                local_58 = (uint)piVar6[7] >> ((char)piVar6[8] - 1U & 0x1f) & 1;
                local_1c = local_1c * 2 | local_58;
                piVar6[8] = piVar6[8] + -1;
              }
            }
          }
        }
      }
    }
    break;
  case 0x16:
    goto switchD_67675972_caseD_16;
  case 0x17:
    goto switchD_67675972_caseD_17;
  case 0x18:
    goto switchD_67675972_caseD_18;
  case 0x19:
    goto switchD_67675972_caseD_19;
  case 0x1a:
    goto switchD_67675972_caseD_1a;
  case 0x1b:
    goto switchD_67675972_caseD_1b;
  case 0x1c:
    goto switchD_67675972_caseD_1c;
  case 0x1d:
    goto switchD_67675972_caseD_1d;
  case 0x1e:
    goto switchD_67675972_caseD_1e;
  case 0x1f:
    goto switchD_67675972_caseD_1f;
  case 0x20:
    goto switchD_67675972_caseD_20;
  case 0x21:
    goto switchD_67675972_caseD_21;
  case 0x22:
    goto switchD_67675972_caseD_22;
  case 0x23:
    goto switchD_67675972_caseD_23;
  case 0x24:
    goto switchD_67675972_caseD_24;
  case 0x25:
    goto switchD_67675972_caseD_25;
  case 0x26:
    goto switchD_67675972_caseD_26;
  case 0x27:
    goto switchD_67675972_caseD_27;
  case 0x28:
    goto switchD_67675972_caseD_28;
  case 0x29:
    goto switchD_67675972_caseD_29;
  case 0x2a:
switchD_67675972_caseD_2a:
    param_1[1] = 0x2a;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    if ((char)((uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f)) == 'r')
    goto switchD_67675972_caseD_2b;
    break;
  case 0x2b:
switchD_67675972_caseD_2b:
    param_1[1] = 0x2b;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    if ((char)((uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f)) == 'E')
    goto switchD_67675972_caseD_2c;
    break;
  case 0x2c:
switchD_67675972_caseD_2c:
    param_1[1] = 0x2c;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    if ((char)((uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f)) == '8')
    goto switchD_67675972_caseD_2d;
    break;
  case 0x2d:
switchD_67675972_caseD_2d:
    param_1[1] = 0x2d;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    if ((char)((uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f)) == 'P')
    goto switchD_67675972_caseD_2e;
    break;
  case 0x2e:
switchD_67675972_caseD_2e:
    param_1[1] = 0x2e;
    uVar18 = 0;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    if ((char)((uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f)) == -0x70) {
      param_1[0x317] = 0;
      goto switchD_67675972_caseD_2f;
    }
    break;
  case 0x2f:
switchD_67675972_caseD_2f:
    param_1[1] = 0x2f;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    param_1[0x317] = param_1[0x317] << 8 | (uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f) & 0xff;
  case 0x30:
    param_1[1] = 0x30;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    param_1[0x317] = param_1[0x317] << 8 | (uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f) & 0xff;
switchD_67675972_caseD_31:
    param_1[1] = 0x31;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    param_1[0x317] = param_1[0x317] << 8 | (uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f) & 0xff;
switchD_67675972_caseD_32:
    param_1[1] = 0x32;
    while (param_1[8] < 8) {
      piVar10 = (int *)*param_1;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      param_1[7] = param_1[7] << 8 | (uint)*(byte *)*piVar10;
      param_1[8] = param_1[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*param_1 + 4) = *(int *)(*param_1 + 4) + -1;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) + 1;
      if (*(int *)(*param_1 + 8) == 0) {
        piVar10 = (int *)(*param_1 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    iVar8 = param_1[8];
    param_1[8] = iVar8 + -8;
    param_1[0x317] = param_1[0x317] << 8 | (uint)param_1[7] >> ((char)iVar8 - 8U & 0x1f) & 0xff;
LAB_6767756e:
    param_1[1] = 1;
    uVar18 = 4;
    goto LAB_67677591;
  case 0x31:
    goto switchD_67675972_caseD_31;
  case 0x32:
    goto switchD_67675972_caseD_32;
  default:
    FUN_6767268b(0xfa1,unaff_EDI,unaff_ESI,unaff_BL);
    iVar23 = 0xfa2;
    FUN_6767268b(0xfa2,in_stack_ffffff88,in_stack_ffffff8c,in_stack_ffffff90);
    goto LAB_67677591;
  }
LAB_67675c06:
  local_48 = iVar11;
  uVar18 = 0xfffffffc;
LAB_67677591:
  piVar6[0x3e85] = local_8;
  piVar6[0x3e86] = local_18;
  piVar6[0x3e87] = local_28;
  piVar6[0x3e88] = local_44;
  piVar6[0x3e89] = local_2c;
  piVar6[0x3e8a] = local_34;
  piVar6[0x3e8b] = local_60;
  piVar6[0x3e8c] = local_48;
  piVar6[0x3e8d] = local_20;
  piVar6[0x3e8e] = local_30;
  piVar6[0x3e8f] = (int)local_54;
  piVar6[0x3e90] = local_14;
  piVar6[0x3e91] = local_10;
  piVar6[0x3e92] = local_4c;
  piVar6[0x3e93] = local_24;
  piVar6[0x3e94] = iVar23;
  piVar6[0x3e95] = local_c;
  piVar6[0x3e96] = local_1c;
  piVar6[0x3e97] = local_58;
  piVar6[0x3e98] = local_5c;
  piVar6[0x3e99] = local_50;
  piVar6[0x3e9a] = (int)local_38;
  piVar6[0x3e9b] = (int)local_3c;
  piVar6[0x3e9c] = (int)local_40;
  return uVar18;
LAB_67676954:
  iVar11 = local_48;
  if ((iVar8 < 0) || (0x101 < iVar8)) goto LAB_67675c06;
  local_30 = local_40[iVar8];
  while( true ) {
    iVar11 = local_48;
    if (local_30 == local_60) {
      if ((-1 < piVar6[0xd]) && (piVar6[0xd] < local_14)) {
        piVar6[3] = 0;
        *(undefined1 *)(piVar6 + 2) = 0;
        piVar6[0x318] = -1;
        piVar6[1] = 2;
        if (1 < piVar6[0xc]) {
          FUN_676afdac((int *)&DAT_676c2138,(byte *)s_rt_rld_676bfa14);
        }
        piVar6[0x111] = 0;
        piVar10 = piVar6 + 0x112;
        iVar8 = 0x100;
        piVar15 = piVar10;
        do {
          *piVar15 = piVar15[-0x102];
          piVar15 = piVar15 + 1;
          iVar8 = iVar8 + -1;
        } while (iVar8 != 0);
        iVar8 = 0x100;
        do {
          *piVar10 = *piVar10 + piVar10[-1];
          piVar10 = piVar10 + 1;
          iVar8 = iVar8 + -1;
        } while (iVar8 != 0);
        if ((char)piVar6[10] == '\0') {
          uVar13 = 0;
          local_8 = 0;
          if (0 < local_14) {
            do {
              uVar20 = (uint)*(byte *)(piVar6[0x313] + uVar13 * 4);
              puVar2 = (uint *)(piVar6[0x313] + piVar6[uVar20 + 0x111] * 4);
              *puVar2 = *puVar2 | uVar13 << 8;
              piVar6[uVar20 + 0x111] = piVar6[uVar20 + 0x111] + 1;
              uVar13 = uVar13 + 1;
              local_8 = uVar13;
            } while ((int)uVar13 < local_14);
          }
          iVar8 = piVar6[0x313];
          uVar13 = *(uint *)(iVar8 + piVar6[0xd] * 4);
          piVar6[0x110] = 0;
          uVar13 = uVar13 >> 8;
          piVar6[0xe] = uVar13;
          if ((char)piVar6[4] == '\0') {
            uVar13 = *(uint *)(iVar8 + piVar6[0xe] * 4);
            piVar6[0x110] = 1;
            piVar6[0xe] = uVar13;
            piVar6[0xe] = (uint)piVar6[0xe] >> 8;
            piVar6[0xf] = uVar13 & 0xff;
          }
          else {
            piVar6[5] = 0;
            piVar6[6] = 0;
            uVar13 = *(uint *)(iVar8 + uVar13 * 4);
            piVar6[0xe] = uVar13;
            piVar6[0xe] = (uint)piVar6[0xe] >> 8;
            piVar6[0xf] = uVar13 & 0xff;
            piVar6[0x110] = 1;
            piVar6[5] = DAT_676bfa30;
            piVar6[5] = piVar6[5] + -1;
            piVar6[6] = 1;
            piVar6[0xf] = piVar6[0xf] ^ (uint)(piVar6[5] == 1);
          }
        }
        else {
          piVar10 = piVar6 + 0x212;
          iVar8 = 0x101;
          do {
            *piVar10 = piVar10[-0x101];
            piVar10 = piVar10 + 1;
            iVar8 = iVar8 + -1;
          } while (iVar8 != 0);
          uVar13 = 0;
          if (0 < local_14) {
            do {
              uVar20 = (uint)*(byte *)(piVar6[0x314] + uVar13 * 2);
              piVar10 = piVar6 + uVar20 + 0x212;
              *(short *)(piVar6[0x314] + uVar13 * 2) = (short)piVar6[uVar20 + 0x212];
              if ((uVar13 & 1) == 0) {
                pbVar21 = (byte *)(piVar6[0x315] + ((int)uVar13 >> 1));
                *pbVar21 = (byte)((uint)*piVar10 >> 0x10) | *pbVar21 & 0xf0;
              }
              else {
                pbVar21 = (byte *)(piVar6[0x315] + ((int)uVar13 >> 1));
                bVar12 = (byte)(*piVar10 >> 0xc);
                *pbVar21 = (bVar12 ^ *pbVar21) & 0xf ^ bVar12;
              }
              *piVar10 = *piVar10 + 1;
              uVar13 = uVar13 + 1;
            } while ((int)uVar13 < local_14);
          }
          local_8 = piVar6[0xd];
          local_18 = (*(byte *)(((int)local_8 >> 1) + piVar6[0x315]) >> (((byte)local_8 & 1) << 2) &
                     0xf) << 0x10 | (uint)*(ushort *)(piVar6[0x314] + local_8 * 2);
          do {
            puVar1 = (ushort *)(piVar6[0x314] + local_18 * 2);
            iVar11 = (int)local_18 >> 1;
            uVar13 = (*(byte *)(piVar6[0x315] + iVar11) >> ((char)(local_18 & 1) << 2) & 0xf) <<
                     0x10 | (uint)*puVar1;
            *puVar1 = (ushort)local_8;
            iVar8 = piVar6[0x315];
            if ((local_18 & 1) == 0) {
              *(byte *)(iVar11 + iVar8) = (byte)(local_8 >> 0x10) | *(byte *)(iVar11 + iVar8) & 0xf0
              ;
            }
            else {
              bVar12 = (byte)((int)local_8 >> 0xc);
              *(byte *)(iVar11 + iVar8) = (bVar12 ^ *(byte *)(iVar11 + iVar8)) & 0xf ^ bVar12;
            }
            bVar22 = local_18 != piVar6[0xd];
            local_8 = local_18;
            local_18 = uVar13;
          } while (bVar22);
          iVar8 = piVar6[0xd];
          piVar6[0xe] = iVar8;
          piVar6[0x110] = 0;
          if ((char)piVar6[4] == '\0') {
            iVar8 = FUN_67672ed0(iVar8,(int)(piVar6 + 0x111));
            piVar6[0xf] = iVar8;
            uVar13 = piVar6[0xe];
            bVar12 = *(byte *)((uVar13 >> 1) + piVar6[0x315]);
            uVar4 = *(ushort *)(piVar6[0x314] + uVar13 * 2);
            piVar6[0x110] = piVar6[0x110] + 1;
            piVar6[0xe] = (bVar12 >> (((byte)uVar13 & 1) << 2) & 0xf) << 0x10 | (uint)uVar4;
          }
          else {
            piVar6[5] = 0;
            piVar6[6] = 0;
            uVar20 = FUN_67672ed0(iVar8,(int)(piVar6 + 0x111));
            uVar13 = piVar6[0xe];
            piVar6[0xf] = uVar20;
            bVar12 = *(byte *)((uVar13 >> 1) + piVar6[0x315]);
            uVar4 = *(ushort *)(piVar6[0x314] + uVar13 * 2);
            piVar6[0x110] = piVar6[0x110] + 1;
            piVar6[0xe] = (bVar12 >> (((byte)uVar13 & 1) << 2) & 0xf) << 0x10 | (uint)uVar4;
            if (piVar6[5] == 0) {
              iVar8 = piVar6[6] + 1;
              piVar6[5] = (&DAT_676bfa30)[piVar6[6]];
              piVar6[6] = iVar8;
              if (iVar8 == 0x200) {
                piVar6[6] = 0;
              }
            }
            piVar6[5] = piVar6[5] + -1;
            piVar6[0xf] = piVar6[5] == 1 ^ uVar20;
          }
        }
        goto LAB_67677195;
      }
      goto LAB_67675c06;
    }
    if ((local_30 != 0) && (local_30 != 1)) break;
    local_10 = -1;
    local_4c = 1;
    do {
      if (local_30 == 0) {
        local_10 = local_10 + local_4c;
      }
      else if (local_30 == 1) {
        local_10 = local_10 + local_4c * 2;
      }
      local_4c = local_4c * 2;
      if (local_20 == 0) {
        iVar11 = local_48 + 1;
        if ((int)local_34 <= iVar11) goto LAB_67675c06;
        local_5c = (uint)*(byte *)(local_48 + 0x1ebd + (int)piVar6);
        local_20 = 0x32;
        local_50 = piVar6[local_5c + 15999];
        local_38 = piVar6 + local_5c * 0x102 + 0x2c5b;
        local_40 = piVar6 + local_5c * 0x102 + 0x3873;
        local_3c = piVar6 + local_5c * 0x102 + 0x3267;
        local_48 = iVar11;
      }
      local_20 = local_20 + -1;
      local_c = local_50;
switchD_67675972_caseD_26:
      piVar6[1] = 0x26;
      while (piVar6[8] < local_c) {
        piVar10 = (int *)*piVar6;
        uVar18 = 0;
        if (piVar10[1] == 0) goto LAB_67677591;
        piVar6[7] = piVar6[7] << 8 | (uint)*(byte *)*piVar10;
        piVar6[8] = piVar6[8] + 8;
        *piVar10 = *piVar10 + 1;
        *(int *)(*piVar6 + 4) = *(int *)(*piVar6 + 4) + -1;
        *(int *)(*piVar6 + 8) = *(int *)(*piVar6 + 8) + 1;
        if (*(int *)(*piVar6 + 8) == 0) {
          piVar10 = (int *)(*piVar6 + 0xc);
          *piVar10 = *piVar10 + 1;
        }
      }
      iVar8 = piVar6[8];
      piVar6[8] = iVar8 - local_c;
      local_1c = (uint)piVar6[7] >> ((byte)(iVar8 - local_c) & 0x1f) &
                 (1 << ((byte)local_c & 0x1f)) - 1U;
      while( true ) {
        iVar11 = local_48;
        if (0x14 < local_c) goto LAB_67675c06;
        if ((int)local_1c <= local_38[local_c]) break;
        local_c = local_c + 1;
switchD_67675972_caseD_27:
        piVar6[1] = 0x27;
        while (piVar6[8] < 1) {
          piVar10 = (int *)*piVar6;
          uVar18 = 0;
          if (piVar10[1] == 0) goto LAB_67677591;
          piVar6[7] = piVar6[7] << 8 | (uint)*(byte *)*piVar10;
          piVar6[8] = piVar6[8] + 8;
          *piVar10 = *piVar10 + 1;
          *(int *)(*piVar6 + 4) = *(int *)(*piVar6 + 4) + -1;
          *(int *)(*piVar6 + 8) = *(int *)(*piVar6 + 8) + 1;
          if (*(int *)(*piVar6 + 8) == 0) {
            piVar10 = (int *)(*piVar6 + 0xc);
            *piVar10 = *piVar10 + 1;
          }
        }
        local_58 = (uint)piVar6[7] >> ((char)piVar6[8] - 1U & 0x1f) & 1;
        local_1c = local_1c * 2 | local_58;
        piVar6[8] = piVar6[8] + -1;
      }
      iVar8 = local_1c - local_3c[local_c];
      if ((iVar8 < 0) || (0x101 < iVar8)) goto LAB_67675c06;
      local_30 = local_40[iVar8];
    } while ((local_30 == 0) || (local_30 == 1));
    local_10 = local_10 + 1;
    bVar12 = *(byte *)(*(byte *)(piVar6[0x79f] + 0xe7c + (int)piVar6) + 0xd7c + (int)piVar6);
    piVar6[bVar12 + 0x10] = piVar6[bVar12 + 0x10] + local_10;
    if ((char)piVar6[10] == '\0') {
      for (; 0 < local_10; local_10 = local_10 + -1) {
        if ((int)local_54 <= local_14) goto LAB_67675c06;
        *(uint *)(piVar6[0x313] + local_14 * 4) = (uint)bVar12;
        local_14 = local_14 + 1;
      }
    }
    else {
      for (; 0 < local_10; local_10 = local_10 + -1) {
        if ((int)local_54 <= local_14) goto LAB_67675c06;
        *(ushort *)(piVar6[0x314] + local_14 * 2) = (ushort)bVar12;
        local_14 = local_14 + 1;
      }
    }
  }
  if ((int)local_54 <= local_14) goto LAB_67675c06;
  uVar13 = local_30 - 1;
  if (uVar13 < 0x10) {
    iVar8 = piVar6[0x79f];
    bVar12 = *(byte *)(iVar8 + uVar13 + 0xe7c + (int)piVar6);
    param_1 = (int *)((uint)bVar12 << 0x18);
    if (3 < uVar13) {
      iVar11 = (int)piVar6 + 0xe7b;
      puVar9 = (undefined1 *)(iVar8 + uVar13 + iVar11);
      iVar19 = (int)piVar6 + (0xe79 - iVar11);
      uVar20 = uVar13 >> 2;
      do {
        uVar13 = uVar13 - 4;
        puVar9[(int)piVar6 + (0xe7c - iVar11)] = *puVar9;
        *puVar9 = puVar9[(int)piVar6 + (0xe7a - iVar11)];
        puVar9[(int)piVar6 + (0xe7a - iVar11)] = puVar9[iVar19];
        puVar9[iVar19] = puVar9[(int)piVar6 + (0xe78 - iVar11)];
        puVar9 = puVar9 + -4;
        uVar20 = uVar20 - 1;
      } while (uVar20 != 0);
    }
    if (uVar13 != 0) {
      do {
        *(undefined1 *)((int)piVar6 + uVar13 + iVar8 + 0xe7c) =
             *(undefined1 *)((int)piVar6 + (uVar13 - 1) + iVar8 + 0xe7c);
        uVar13 = uVar13 - 1;
      } while (uVar13 != 0);
    }
    *(byte *)(iVar8 + 0xe7c + (int)piVar6) = bVar12;
  }
  else {
    uVar20 = uVar13 >> 4;
    piVar10 = piVar6 + uVar20 + 0x79f;
    iVar8 = (uVar13 & 0xf) + piVar6[uVar20 + 0x79f];
    bVar12 = *(byte *)(iVar8 + 0xe7c + (int)piVar6);
    param_1 = (int *)((uint)bVar12 << 0x18);
    if (piVar6[uVar20 + 0x79f] < iVar8) {
      do {
        *(undefined1 *)(iVar8 + 0xe7c + (int)piVar6) = *(undefined1 *)(iVar8 + 0xe7b + (int)piVar6);
        iVar8 = iVar8 + -1;
      } while (*piVar10 < iVar8);
    }
    *piVar10 = *piVar10 + 1;
    for (; uVar20 != 0; uVar20 = uVar20 - 1) {
      *piVar10 = *piVar10 + -1;
      iVar8 = *piVar10;
      piVar15 = piVar10 + -1;
      piVar10 = piVar10 + -1;
      *(undefined1 *)(iVar8 + 0xe7c + (int)piVar6) = *(undefined1 *)(*piVar15 + 0xe8b + (int)piVar6)
      ;
    }
    piVar6[0x79f] = piVar6[0x79f] + -1;
    *(byte *)(piVar6[0x79f] + 0xe7c + (int)piVar6) = bVar12;
    if (piVar6[0x79f] == 0) {
      iVar11 = 0xfff;
      piVar10 = piVar6 + 0x7ae;
      iVar8 = 0x10;
      do {
        iVar19 = 0xf;
        do {
          iVar14 = iVar11;
          iVar17 = iVar19 + *piVar10;
          iVar11 = iVar14 + -1;
          iVar19 = iVar19 + -1;
          *(undefined1 *)(iVar14 + 0xe7c + (int)piVar6) =
               *(undefined1 *)(iVar17 + 0xe7c + (int)piVar6);
        } while (-1 < iVar19);
        *piVar10 = iVar14;
        piVar10 = piVar10 + -1;
        iVar8 = iVar8 + -1;
      } while (iVar8 != 0);
    }
  }
  pbVar21 = (byte *)(((uint)param_1 >> 0x18) + 0xd7c + (int)piVar6);
  piVar6[*(byte *)(((uint)param_1 >> 0x18) + 0xd7c + (int)piVar6) + 0x10] =
       piVar6[*(byte *)(((uint)param_1 >> 0x18) + 0xd7c + (int)piVar6) + 0x10] + 1;
  if ((char)piVar6[10] == '\0') {
    *(uint *)(piVar6[0x313] + local_14 * 4) = (uint)*pbVar21;
  }
  else {
    *(ushort *)(piVar6[0x314] + local_14 * 2) = (ushort)*pbVar21;
  }
  local_14 = local_14 + 1;
  if (local_20 == 0) {
    iVar11 = local_48 + 1;
    if ((int)local_34 <= iVar11) goto LAB_67675c06;
    local_5c = (uint)*(byte *)(local_48 + 0x1ebd + (int)piVar6);
    local_20 = 0x32;
    local_50 = piVar6[local_5c + 15999];
    local_38 = piVar6 + local_5c * 0x102 + 0x2c5b;
    local_40 = piVar6 + local_5c * 0x102 + 0x3873;
    local_3c = piVar6 + local_5c * 0x102 + 0x3267;
    local_48 = iVar11;
  }
  local_20 = local_20 + -1;
  local_c = local_50;
switchD_67675972_caseD_28:
  piVar6[1] = 0x28;
  while (piVar6[8] < local_c) {
    piVar10 = (int *)*piVar6;
    uVar18 = 0;
    if (piVar10[1] == 0) goto LAB_67677591;
    piVar6[7] = piVar6[7] << 8 | (uint)*(byte *)*piVar10;
    piVar6[8] = piVar6[8] + 8;
    *piVar10 = *piVar10 + 1;
    *(int *)(*piVar6 + 4) = *(int *)(*piVar6 + 4) + -1;
    *(int *)(*piVar6 + 8) = *(int *)(*piVar6 + 8) + 1;
    if (*(int *)(*piVar6 + 8) == 0) {
      piVar10 = (int *)(*piVar6 + 0xc);
      *piVar10 = *piVar10 + 1;
    }
  }
  iVar8 = piVar6[8];
  piVar6[8] = iVar8 - local_c;
  local_1c = (uint)piVar6[7] >> ((byte)(iVar8 - local_c) & 0x1f) &
             (1 << ((byte)local_c & 0x1f)) - 1U;
  while( true ) {
    iVar11 = local_48;
    if (0x14 < local_c) goto LAB_67675c06;
    if ((int)local_1c <= local_38[local_c]) break;
    local_c = local_c + 1;
switchD_67675972_caseD_29:
    piVar6[1] = 0x29;
    while (piVar6[8] < 1) {
      piVar10 = (int *)*piVar6;
      uVar18 = 0;
      if (piVar10[1] == 0) goto LAB_67677591;
      piVar6[7] = piVar6[7] << 8 | (uint)*(byte *)*piVar10;
      piVar6[8] = piVar6[8] + 8;
      *piVar10 = *piVar10 + 1;
      *(int *)(*piVar6 + 4) = *(int *)(*piVar6 + 4) + -1;
      *(int *)(*piVar6 + 8) = *(int *)(*piVar6 + 8) + 1;
      if (*(int *)(*piVar6 + 8) == 0) {
        piVar10 = (int *)(*piVar6 + 0xc);
        *piVar10 = *piVar10 + 1;
      }
    }
    local_58 = (uint)piVar6[7] >> ((char)piVar6[8] - 1U & 0x1f) & 1;
    local_1c = local_1c * 2 | local_58;
    piVar6[8] = piVar6[8] + -1;
  }
  iVar8 = local_1c - local_3c[local_c];
  goto LAB_67676954;
LAB_67677195:
  uVar18 = 0;
  goto LAB_67677591;
}



// Function: FUN_67677714 at 67677714

void __cdecl FUN_67677714(int param_1)

{
  int iVar1;
  
  *(undefined4 *)(param_1 + 0xc68) = 0;
  iVar1 = 0;
  do {
    if (*(char *)(param_1 + 0xc6c + iVar1) != '\0') {
      *(char *)(param_1 + 0xd7c + *(int *)(param_1 + 0xc68)) = (char)iVar1;
      *(int *)(param_1 + 0xc68) = *(int *)(param_1 + 0xc68) + 1;
    }
    iVar1 = iVar1 + 1;
  } while (iVar1 < 0x100);
  return;
}



// Function: FUN_67677748 at 67677748

/* WARNING: Type propagation algorithm not settling */

void __cdecl FUN_67677748(int param_1,int *param_2,int param_3,int param_4)

{
  uint uVar1;
  bool bVar2;
  int *piVar3;
  uint uVar4;
  int iVar5;
  uint *puVar6;
  int iVar7;
  uint uVar8;
  int unaff_EBX;
  int iVar9;
  int iVar10;
  int *piVar11;
  uint uVar12;
  int unaff_ESI;
  int iVar13;
  int unaff_EDI;
  int *piVar14;
  int local_1444 [516];
  uint local_c34 [516];
  int *local_424;
  int local_420 [258];
  undefined4 uStackY_18;
  int *piVar15;
  int iVar16;
  int iVar17;
  
  FUN_676b06a0();
  if (0 < param_3) {
    iVar7 = 4 - (int)param_2;
    iVar13 = param_3;
    do {
      iVar5 = *param_2;
      if (iVar5 == 0) {
        iVar5 = 1;
      }
      *(int *)((int)local_c34 + iVar7 + (int)param_2) = iVar5 << 8;
      param_2 = param_2 + 1;
      iVar13 = iVar13 + -1;
    } while (iVar13 != 0);
  }
  do {
    iVar7 = 1;
    local_424 = (int *)0x0;
    local_c34[0] = 0;
    local_1444[0] = -2;
    iVar13 = param_3;
    if (0 < param_3) {
      param_2 = (int *)&local_424;
      piVar14 = local_1444;
      unaff_ESI = 0;
      for (iVar5 = param_3; piVar14 = piVar14 + 1, iVar10 = 0, iVar5 != 0; iVar5 = iVar5 + -1) {
        *piVar14 = -1;
      }
      do {
        iVar9 = iVar10;
        param_2 = param_2 + 1;
        iVar10 = iVar9 + 1;
        *param_2 = iVar7;
        iVar5 = local_420[(iVar10 >> 1) + -1];
        iVar17 = *(int *)((int)(local_c34 + 1) + unaff_ESI);
        uVar12 = local_c34[iVar5];
        unaff_EDI = iVar10;
        iVar16 = iVar10 >> 1;
        while (iVar17 < (int)uVar12) {
          local_420[unaff_EDI + -1] = iVar5;
          unaff_EBX = iVar16 >> 1;
          iVar5 = local_420[unaff_EBX + -1];
          unaff_EDI = iVar16;
          iVar16 = unaff_EBX;
          uVar12 = local_c34[iVar5];
        }
        unaff_ESI = unaff_ESI + 4;
        local_420[unaff_EDI + -1] = iVar7;
        iVar7 = iVar7 + 1;
      } while (iVar7 <= param_3);
      if (0x103 < iVar10) {
        uStackY_18 = 0x67677837;
        FUN_6767268b(0x7d1,unaff_EDI,unaff_ESI,(char)unaff_EBX);
      }
      if (1 < iVar10) {
        piVar14 = local_420 + iVar9;
        do {
          unaff_EDI = local_420[0];
          iVar7 = *piVar14;
          local_420[0] = iVar7;
          piVar14 = piVar14 + -1;
          piVar3 = (int *)0x1;
          while (param_2 = (int *)((int)piVar3 * 2), (int)param_2 <= iVar10 + -1) {
            if (((int)param_2 < iVar10 + -1) &&
               ((int)local_c34[local_420[(int)piVar3 * 2]] <
                (int)local_c34[local_420[(int)piVar3 * 2 + -1]])) {
              param_2 = (int *)((int)param_2 + 1);
            }
            if ((int)local_c34[iVar7] < (int)local_c34[local_420[(int)param_2 + -1]]) break;
            local_420[(int)piVar3 + -1] = local_420[(int)param_2 + -1];
            piVar3 = param_2;
          }
          piVar11 = (int *)(iVar10 + -2);
          local_420[(int)piVar3 + -1] = iVar7;
          unaff_ESI = local_420[0];
          unaff_EBX = *piVar14;
          local_420[0] = unaff_EBX;
          piVar3 = piVar11;
          piVar15 = piVar11;
          while (param_2 = (int *)((int)piVar3 * 2), (int)param_2 <= (int)piVar11) {
            if (((int)param_2 < (int)piVar11) &&
               ((int)local_c34[local_420[(int)piVar3 * 2]] <
                (int)local_c34[local_420[(int)piVar3 * 2 + -1]])) {
              param_2 = (int *)((int)param_2 + 1);
            }
            if ((int)local_c34[unaff_EBX] < (int)local_c34[local_420[(int)param_2 + -1]]) break;
            local_420[(int)piVar3 + -1] = local_420[(int)param_2 + -1];
            piVar3 = param_2;
          }
          iVar13 = iVar13 + 1;
          local_420[(int)piVar3 + -1] = unaff_EBX;
          uVar4 = local_c34[unaff_ESI];
          local_1444[unaff_ESI] = iVar13;
          uVar1 = local_c34[unaff_EDI];
          local_1444[unaff_EDI] = iVar13;
          uVar12 = uVar4 & 0xff;
          uVar8 = uVar1 & 0xff;
          if (uVar12 < uVar8) {
            uVar12 = uVar8;
          }
          local_1444[iVar13] = -1;
          uVar4 = (uVar1 & 0xffffff00) + (uVar4 & 0xffffff00) | uVar12 + 1;
          iVar10 = (int)piVar15 + 1;
          local_c34[iVar13] = uVar4;
          *piVar14 = iVar13;
          iVar7 = local_420[(iVar10 >> 1) + -1];
          uVar12 = local_c34[iVar7];
          iVar5 = iVar10;
          iVar17 = iVar10 >> 1;
          while ((int)uVar4 < (int)uVar12) {
            local_420[iVar5 + -1] = iVar7;
            unaff_EBX = iVar17 >> 1;
            iVar7 = local_420[unaff_EBX + -1];
            iVar5 = iVar17;
            iVar17 = unaff_EBX;
            uVar12 = local_c34[iVar7];
          }
          local_420[iVar5 + -1] = iVar13;
        } while (1 < iVar10);
      }
    }
    if (0x203 < iVar13) {
      uStackY_18 = 0x67677a14;
      FUN_6767268b(0x7d2,unaff_EDI,unaff_ESI,(char)unaff_EBX);
    }
    iVar7 = 1;
    bVar2 = false;
    if (param_3 < 1) {
      return;
    }
    piVar14 = local_1444;
    do {
      piVar14 = piVar14 + 1;
      iVar5 = 0;
      for (iVar13 = *piVar14; -1 < iVar13; iVar13 = local_1444[iVar13]) {
        iVar5 = iVar5 + 1;
      }
      *(char *)(iVar7 + -1 + param_1) = (char)iVar5;
      if (param_4 < iVar5) {
        bVar2 = true;
      }
      iVar7 = iVar7 + 1;
    } while (iVar7 <= param_3);
    if (!bVar2) {
      return;
    }
    if (1 < param_3) {
      puVar6 = local_c34;
      iVar7 = param_3 + -1;
      do {
        puVar6 = puVar6 + 1;
        *puVar6 = (((int)*puVar6 >> 8) / 2 + 1) * 0x100;
        iVar7 = iVar7 + -1;
      } while (iVar7 != 0);
    }
  } while( true );
}



// Function: FUN_67677a85 at 67677a85

void __cdecl FUN_67677a85(int *param_1,int param_2,uint param_3,int param_4,int param_5)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  
  iVar3 = 0;
  if ((int)param_3 <= param_4) {
    do {
      iVar1 = 0;
      piVar2 = param_1;
      if (0 < param_5) {
        do {
          if (*(byte *)(iVar1 + param_2) == param_3) {
            *piVar2 = iVar3;
            iVar3 = iVar3 + 1;
          }
          iVar1 = iVar1 + 1;
          piVar2 = piVar2 + 1;
        } while (iVar1 < param_5);
      }
      iVar3 = iVar3 << 1;
      param_3 = param_3 + 1;
    } while ((int)param_3 <= param_4);
  }
  return;
}



// Function: FUN_67677ac1 at 67677ac1

void __cdecl
FUN_67677ac1(undefined4 *param_1,int *param_2,int param_3,int param_4,uint param_5,int param_6,
            int param_7)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  int iVar4;
  undefined4 *puVar5;
  uint local_8;
  
  iVar4 = 0;
  local_8 = param_5;
  if ((int)param_5 <= param_6) {
    do {
      iVar1 = 0;
      if (0 < param_7) {
        piVar2 = (int *)(param_3 + iVar4 * 4);
        do {
          if (*(byte *)(iVar1 + param_4) == local_8) {
            *piVar2 = iVar1;
            iVar4 = iVar4 + 1;
            piVar2 = piVar2 + 1;
          }
          iVar1 = iVar1 + 1;
        } while (iVar1 < param_7);
      }
      local_8 = local_8 + 1;
    } while ((int)local_8 <= param_6);
  }
  piVar2 = param_2;
  for (iVar4 = 0x17; iVar4 != 0; iVar4 = iVar4 + -1) {
    *piVar2 = 0;
    piVar2 = piVar2 + 1;
  }
  iVar4 = 0;
  if (0 < param_7) {
    do {
      param_2[*(byte *)(iVar4 + param_4) + 1] = param_2[*(byte *)(iVar4 + param_4) + 1] + 1;
      iVar4 = iVar4 + 1;
    } while (iVar4 < param_7);
  }
  iVar4 = 0x16;
  piVar2 = param_2;
  do {
    piVar3 = piVar2 + 1;
    *piVar3 = *piVar3 + *piVar2;
    iVar4 = iVar4 + -1;
    piVar2 = piVar3;
  } while (iVar4 != 0);
  param_7 = 0;
  puVar5 = param_1;
  for (iVar4 = 0x17; iVar4 != 0; iVar4 = iVar4 + -1) {
    *puVar5 = 0;
    puVar5 = puVar5 + 1;
  }
  if ((int)param_5 <= param_6) {
    iVar4 = (param_6 - param_5) + 1;
    piVar2 = param_2 + param_5;
    do {
      iVar1 = param_7 + (piVar2[1] - *piVar2);
      param_7 = iVar1 * 2;
      iVar4 = iVar4 + -1;
      *(int *)(((int)param_1 - (int)param_2) + (int)piVar2) = iVar1 + -1;
      piVar2 = piVar2 + 1;
    } while (iVar4 != 0);
  }
  iVar4 = param_5 + 1;
  if (iVar4 <= param_6) {
    piVar2 = param_2 + iVar4;
    iVar4 = (param_6 - iVar4) + 1;
    piVar3 = param_1 + param_5;
    do {
      iVar1 = *piVar3;
      piVar3 = piVar3 + 1;
      *piVar2 = (iVar1 * 2 + 2) - *piVar2;
      piVar2 = piVar2 + 1;
      iVar4 = iVar4 + -1;
    } while (iVar4 != 0);
  }
  return;
}



// Function: FUN_67677bad at 67677bad

uint __cdecl FUN_67677bad(uint param_1,byte *param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  int iVar18;
  uint uVar19;
  
  uVar3 = param_1 & 0xffff;
  uVar19 = param_1 >> 0x10;
  if (param_2 == (byte *)0x0) {
    uVar3 = 1;
  }
  else {
    if (param_3 != 0) {
      do {
        uVar2 = 0x15b0;
        if (param_3 < 0x15b0) {
          uVar2 = param_3;
        }
        param_3 = param_3 - uVar2;
        if (0xf < (int)uVar2) {
          uVar1 = uVar2 >> 4;
          uVar2 = uVar2 + uVar1 * -0x10;
          do {
            iVar4 = uVar3 + *param_2;
            iVar5 = iVar4 + (uint)param_2[1];
            iVar6 = iVar5 + (uint)param_2[2];
            iVar7 = iVar6 + (uint)param_2[3];
            iVar8 = iVar7 + (uint)param_2[4];
            iVar9 = iVar8 + (uint)param_2[5];
            iVar10 = iVar9 + (uint)param_2[6];
            iVar11 = iVar10 + (uint)param_2[7];
            iVar12 = iVar11 + (uint)param_2[8];
            iVar13 = iVar12 + (uint)param_2[9];
            iVar14 = iVar13 + (uint)param_2[10];
            iVar15 = iVar14 + (uint)param_2[0xb];
            iVar16 = iVar15 + (uint)param_2[0xc];
            iVar17 = iVar16 + (uint)param_2[0xd];
            iVar18 = iVar17 + (uint)param_2[0xe];
            uVar3 = iVar18 + (uint)param_2[0xf];
            uVar19 = uVar19 + iVar4 + iVar5 + iVar6 + iVar7 + iVar8 + iVar9 + iVar10 + iVar11 +
                     iVar12 + iVar13 + iVar14 + iVar15 + iVar16 + iVar17 + iVar18 + uVar3;
            param_2 = param_2 + 0x10;
            uVar1 = uVar1 - 1;
          } while (uVar1 != 0);
        }
        for (; uVar2 != 0; uVar2 = uVar2 - 1) {
          uVar3 = uVar3 + *param_2;
          param_2 = param_2 + 1;
          uVar19 = uVar19 + uVar3;
        }
        uVar3 = uVar3 % 0xfff1;
        uVar19 = uVar19 % 0xfff1;
      } while (param_3 != 0);
    }
    uVar3 = uVar19 << 0x10 | uVar3;
  }
  return uVar3;
}



// Function: FUN_67677cc6 at 67677cc6

uint __cdecl FUN_67677cc6(uint param_1,byte *param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  
  if (param_2 == (byte *)0x0) {
    return 0;
  }
  uVar1 = ~param_1;
  if (7 < param_3) {
    uVar2 = param_3 >> 3;
    do {
      param_3 = param_3 - 8;
      uVar1 = *(uint *)(&DAT_676b84e8 + (uVar1 & 0xff ^ (uint)*param_2) * 4) ^ uVar1 >> 8;
      uVar1 = *(uint *)(&DAT_676b84e8 + (uVar1 & 0xff ^ (uint)param_2[1]) * 4) ^ uVar1 >> 8;
      uVar1 = *(uint *)(&DAT_676b84e8 + (uVar1 & 0xff ^ (uint)param_2[2]) * 4) ^ uVar1 >> 8;
      uVar1 = *(uint *)(&DAT_676b84e8 + (uVar1 & 0xff ^ (uint)param_2[3]) * 4) ^ uVar1 >> 8;
      uVar1 = *(uint *)(&DAT_676b84e8 + (uVar1 & 0xff ^ (uint)param_2[4]) * 4) ^ uVar1 >> 8;
      uVar1 = *(uint *)(&DAT_676b84e8 + (uVar1 & 0xff ^ (uint)param_2[5]) * 4) ^ uVar1 >> 8;
      uVar1 = *(uint *)(&DAT_676b84e8 + (uVar1 & 0xff ^ (uint)param_2[6]) * 4) ^ uVar1 >> 8;
      uVar1 = uVar1 >> 8 ^ *(uint *)(&DAT_676b84e8 + (uVar1 & 0xff ^ (uint)param_2[7]) * 4);
      param_2 = param_2 + 8;
      uVar2 = uVar2 - 1;
    } while (uVar2 != 0);
  }
  for (; param_3 != 0; param_3 = param_3 - 1) {
    uVar1 = uVar1 >> 8 ^ *(uint *)(&DAT_676b84e8 + (uVar1 & 0xff ^ (uint)*param_2) * 4);
    param_2 = param_2 + 1;
  }
  return ~uVar1;
}



// Function: FUN_67677ddc at 67677ddc

uint __cdecl FUN_67677ddc(uint param_1,uint param_2)

{
  return *(uint *)(&DAT_676b84e8 + ((param_1 ^ param_2) & 0xff) * 4) ^ param_1 >> 8;
}



// Function: FUN_67677df8 at 67677df8

undefined4 __cdecl
FUN_67677df8(int param_1,int param_2,int param_3,int param_4,int param_5,int param_6,char *param_7,
            int param_8)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  undefined4 uVar4;
  int iVar5;
  bool bVar6;
  uint local_8;
  
  if (((param_7 == (char *)0x0) || (*param_7 != *PTR_s_1_1_3_676c0230)) || (param_8 != 0x38)) {
    return 0xfffffffa;
  }
  if (param_1 != 0) {
    *(undefined4 *)(param_1 + 0x18) = 0;
    if (*(int *)(param_1 + 0x20) == 0) {
      *(code **)(param_1 + 0x20) = FUN_6767c7e8;
      *(undefined4 *)(param_1 + 0x28) = 0;
    }
    if (*(int *)(param_1 + 0x24) == 0) {
      *(undefined1 **)(param_1 + 0x24) = &LAB_6767c7f8;
    }
    if (param_2 == -1) {
      param_2 = 6;
    }
    bVar6 = param_4 < 0;
    if (bVar6) {
      param_4 = -param_4;
    }
    local_8 = (uint)bVar6;
    if ((((0 < param_5) && (param_5 < 10)) && ((-1 < param_2 && ((param_2 < 10 && (-1 < param_6)))))
        ) && (param_6 < 3)) {
      if (param_3 == 8) {
        if ((7 < param_4) && (param_4 < 0x10)) {
LAB_67677eb7:
          piVar1 = (int *)(**(code **)(param_1 + 0x20))(*(undefined4 *)(param_1 + 0x28),1,0x16d4);
          if (piVar1 != (int *)0x0) {
            *(int **)(param_1 + 0x1c) = piVar1;
            piVar1[10] = param_4;
            iVar5 = 1 << ((byte)param_4 & 0x1f);
            piVar1[6] = local_8;
            *piVar1 = param_1;
            piVar1[0xf] = 0x102;
            piVar1[0x10] = 0x106;
            piVar1[9] = iVar5;
            piVar1[0xb] = iVar5 + -1;
            piVar1[0xe] = iVar5 + -0x106;
            if (param_3 == 9) {
              piVar1[0xe] = iVar5 + -1;
              piVar1[0xf] = iVar5 + -0xe;
              piVar1[0x10] = iVar5 + -10;
            }
            iVar2 = 1 << ((byte)(param_5 + 7) & 0x1f);
            piVar1[0x15] = param_5 + 7;
            piVar1[0x14] = iVar2;
            piVar1[0x16] = iVar2 + -1;
            piVar1[0x17] = (param_5 + 9U) / 3;
            if (param_3 == 8) {
              iVar5 = iVar5 * 2;
            }
            else {
              iVar5 = piVar1[0x10] + iVar5 * 2;
            }
            iVar5 = (**(code **)(param_1 + 0x20))(*(undefined4 *)(param_1 + 0x28),iVar5,1);
            piVar1[0xc] = iVar5;
            iVar5 = (**(code **)(param_1 + 0x20))(*(undefined4 *)(param_1 + 0x28),piVar1[9],4);
            piVar1[0x11] = iVar5;
            iVar5 = (**(code **)(param_1 + 0x20))(*(undefined4 *)(param_1 + 0x28),piVar1[0x14],4);
            piVar1[0x12] = iVar5;
            uVar3 = 1 << ((char)param_5 + 6U & 0x1f);
            piVar1[0x5ac] = uVar3;
            iVar5 = (**(code **)(param_1 + 0x20))(*(undefined4 *)(param_1 + 0x28),uVar3,5);
            uVar3 = piVar1[0x5ac];
            piVar1[2] = iVar5;
            piVar1[3] = uVar3 * 5;
            if (((piVar1[0xc] != 0) && (piVar1[0x11] != 0)) && ((piVar1[0x12] != 0 && (iVar5 != 0)))
               ) {
              piVar1[0x22] = param_2;
              piVar1[0x23] = param_6;
              piVar1[0x5ae] = iVar5 + (uVar3 & 0xfffffffe);
              piVar1[0x5ab] = iVar5 + uVar3 * 3;
              *(undefined1 *)((int)piVar1 + 0x1d) = (undefined1)param_3;
              uVar4 = FUN_6767800a(param_1);
              return uVar4;
            }
            *(undefined **)(param_1 + 0x18) = PTR_s_insufficient_memory_676c04fc;
            FUN_6767833e(param_1);
          }
          return 0xfffffffc;
        }
      }
      else if (((param_3 == 9) && (7 < param_4)) && (param_4 < 0x11)) goto LAB_67677eb7;
    }
  }
  return 0xfffffffe;
}



// Function: FUN_6767800a at 6767800a

undefined4 __cdecl FUN_6767800a(int param_1)

{
  int iVar1;
  
  if ((((param_1 != 0) && (iVar1 = *(int *)(param_1 + 0x1c), iVar1 != 0)) &&
      (*(int *)(param_1 + 0x20) != 0)) && (*(int *)(param_1 + 0x24) != 0)) {
    *(undefined4 *)(param_1 + 0x14) = 0;
    *(undefined4 *)(param_1 + 8) = 0;
    *(undefined4 *)(param_1 + 0x18) = 0;
    *(undefined4 *)(param_1 + 0x2c) = 2;
    *(undefined4 *)(iVar1 + 0x14) = 0;
    *(undefined4 *)(iVar1 + 0x10) = *(undefined4 *)(iVar1 + 8);
    if (*(int *)(iVar1 + 0x18) < 0) {
      *(undefined4 *)(iVar1 + 0x18) = 0;
    }
    *(uint *)(iVar1 + 4) = (-(uint)(*(int *)(iVar1 + 0x18) != 0) & 0x47) + 0x2a;
    *(undefined4 *)(param_1 + 0x30) = 1;
    *(undefined4 *)(iVar1 + 0x20) = 0;
    FUN_6767ad8c(iVar1);
    FUN_676783d3(iVar1);
    return 0;
  }
  return 0xfffffffe;
}



// Function: FUN_67678078 at 67678078

uint __cdecl FUN_67678078(int *param_1,int param_2)

{
  undefined4 *puVar1;
  uint uVar2;
  int iVar3;
  
  if ((((param_1 == (int *)0x0) || (puVar1 = (undefined4 *)param_1[7], puVar1 == (undefined4 *)0x0))
      || (4 < param_2)) || (param_2 < 0)) {
    return 0xfffffffe;
  }
  if (((param_1[3] == 0) || ((*param_1 == 0 && (param_1[1] != 0)))) ||
     ((puVar1[1] == 0x29a && (param_2 != 4)))) {
    param_1[6] = (int)PTR_s_stream_error_676c04f4;
    return 0xfffffffe;
  }
  if (param_1[4] == 0) goto LAB_676781ac;
  iVar3 = puVar1[8];
  *puVar1 = param_1;
  puVar1[8] = param_2;
  if (puVar1[1] == 0x2a) {
    uVar2 = puVar1[0x22] + -1 >> 1;
    if (3 < uVar2) {
      uVar2 = 3;
    }
    uVar2 = ((puVar1[10] + 0xffff8) * 0x10 + (uint)*(byte *)((int)puVar1 + 0x1d)) * 0x100 |
            uVar2 << 6;
    if (puVar1[0x1c] != 0) {
      uVar2 = uVar2 | 0x20;
    }
    puVar1[1] = 0x71;
    FUN_676782c5((int)puVar1,(uVar2 - uVar2 % 0x1f) + 0x1f);
    if (puVar1[0x1c] != 0) {
      FUN_676782c5((int)puVar1,(uint)param_1[0xc] >> 0x10);
      FUN_676782c5((int)puVar1,param_1[0xc] & 0xffff);
    }
    param_1[0xc] = 1;
  }
  if (puVar1[5] == 0) {
    if (((param_1[1] == 0) && (param_2 <= iVar3)) && (param_2 != 4)) goto LAB_676781ac;
LAB_6767819b:
    if (puVar1[1] == 0x29a) {
      if (param_1[1] != 0) {
LAB_676781ac:
        param_1[6] = (int)PTR_s_buffer_error_676c0500;
        return 0xfffffffb;
      }
LAB_676781c0:
      if ((puVar1[0x1e] != 0) || ((param_2 != 0 && (puVar1[1] != 0x29a)))) goto LAB_676781d5;
    }
    else {
      if (param_1[1] == 0) goto LAB_676781c0;
LAB_676781d5:
      iVar3 = (**(code **)(&DAT_676b8928 + puVar1[0x22] * 0xc))(puVar1,param_2);
      if ((iVar3 == 2) || (iVar3 == 3)) {
        puVar1[1] = 0x29a;
      }
      if ((iVar3 == 0) || (iVar3 == 2)) {
        if (param_1[4] != 0) {
          return 0;
        }
        goto LAB_67678260;
      }
      if (iVar3 == 1) {
        if (param_2 == 1) {
          FUN_6767aefe((int)puVar1);
        }
        else {
          FUN_6767ae69((int)puVar1,(undefined1 *)0x0,0,0);
          if (param_2 == 3) {
            *(undefined4 *)(puVar1[0x12] + -4 + puVar1[0x14] * 4) = 0;
            _memset((void *)puVar1[0x12],0,puVar1[0x14] * 4 - 4);
          }
        }
        FUN_676782ef((int)param_1);
        if (param_1[4] == 0) goto LAB_67678260;
      }
    }
    if (param_2 == 4) {
      if (puVar1[6] == 0) {
        FUN_676782c5((int)puVar1,(uint)param_1[0xc] >> 0x10);
        FUN_676782c5((int)puVar1,param_1[0xc] & 0xffff);
        FUN_676782ef((int)param_1);
        puVar1[6] = 0xffffffff;
        return (uint)(puVar1[5] == 0);
      }
      return 1;
    }
  }
  else {
    FUN_676782ef((int)param_1);
    if (param_1[4] != 0) goto LAB_6767819b;
LAB_67678260:
    puVar1[8] = 0xffffffff;
  }
  return 0;
}



// Function: FUN_676782c5 at 676782c5

void __cdecl FUN_676782c5(int param_1,undefined4 param_2)

{
  *(char *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) = (char)((uint)param_2 >> 8);
  *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
  *(char *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) = (char)param_2;
  *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
  return;
}



// Function: FUN_676782ef at 676782ef

void __cdecl FUN_676782ef(int param_1)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  
  uVar3 = *(uint *)(*(int *)(param_1 + 0x1c) + 0x14);
  if (*(uint *)(param_1 + 0x10) < uVar3) {
    uVar3 = *(uint *)(param_1 + 0x10);
  }
  if (uVar3 != 0) {
    FUN_676b06d0(*(undefined4 **)(param_1 + 0xc),*(undefined4 **)(*(int *)(param_1 + 0x1c) + 0x10),
                 uVar3);
    *(int *)(param_1 + 0xc) = *(int *)(param_1 + 0xc) + uVar3;
    piVar1 = (int *)(*(int *)(param_1 + 0x1c) + 0x10);
    *piVar1 = *piVar1 + uVar3;
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + uVar3;
    *(int *)(param_1 + 0x10) = *(int *)(param_1 + 0x10) - uVar3;
    piVar1 = (int *)(*(int *)(param_1 + 0x1c) + 0x14);
    *piVar1 = *piVar1 - uVar3;
    iVar2 = *(int *)(param_1 + 0x1c);
    if (*(int *)(iVar2 + 0x14) == 0) {
      *(undefined4 *)(iVar2 + 0x10) = *(undefined4 *)(iVar2 + 8);
    }
  }
  return;
}



// Function: FUN_6767833e at 6767833e

undefined4 __cdecl FUN_6767833e(int param_1)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  
  if (((param_1 == 0) || (iVar1 = *(int *)(param_1 + 0x1c), iVar1 == 0)) ||
     ((iVar2 = *(int *)(iVar1 + 4), iVar2 != 0x2a && ((iVar2 != 0x71 && (iVar2 != 0x29a)))))) {
    uVar3 = 0xfffffffe;
  }
  else {
    if (*(int *)(iVar1 + 8) != 0) {
      (**(code **)(param_1 + 0x24))(*(undefined4 *)(param_1 + 0x28),*(int *)(iVar1 + 8));
    }
    iVar1 = *(int *)(*(int *)(param_1 + 0x1c) + 0x48);
    if (iVar1 != 0) {
      (**(code **)(param_1 + 0x24))(*(undefined4 *)(param_1 + 0x28),iVar1);
    }
    iVar1 = *(int *)(*(int *)(param_1 + 0x1c) + 0x44);
    if (iVar1 != 0) {
      (**(code **)(param_1 + 0x24))(*(undefined4 *)(param_1 + 0x28),iVar1);
    }
    iVar1 = *(int *)(*(int *)(param_1 + 0x1c) + 0x30);
    if (iVar1 != 0) {
      (**(code **)(param_1 + 0x24))(*(undefined4 *)(param_1 + 0x28),iVar1);
    }
    (**(code **)(param_1 + 0x24))(*(undefined4 *)(param_1 + 0x28),*(undefined4 *)(param_1 + 0x1c));
    *(undefined4 *)(param_1 + 0x1c) = 0;
    if (iVar2 == 0x71) {
      uVar3 = 0xfffffffd;
    }
    else {
      uVar3 = 0;
    }
  }
  return uVar3;
}



// Function: FUN_676783d3 at 676783d3

void __cdecl FUN_676783d3(int param_1)

{
  int iVar1;
  
  iVar1 = *(int *)(param_1 + 0x24) * 2;
  *(int *)(param_1 + 0x34) = iVar1;
  if (*(char *)(param_1 + 0x1d) == '\t') {
    *(int *)(param_1 + 0x34) = *(int *)(param_1 + 0x40) + iVar1;
  }
  *(undefined4 *)(*(int *)(param_1 + 0x48) + -4 + *(int *)(param_1 + 0x50) * 4) = 0;
  _memset(*(void **)(param_1 + 0x48),0,*(int *)(param_1 + 0x50) * 4 - 4);
  iVar1 = *(int *)(param_1 + 0x88) * 0xc;
  *(uint *)(param_1 + 0x84) = (uint)*(ushort *)(&DAT_676b8922 + iVar1);
  *(uint *)(param_1 + 0x90) = (uint)*(ushort *)(&DAT_676b8920 + iVar1);
  *(uint *)(param_1 + 0x94) = (uint)*(ushort *)(&DAT_676b8924 + iVar1);
  *(uint *)(param_1 + 0x80) = (uint)*(ushort *)(&DAT_676b8926 + iVar1);
  *(undefined4 *)(param_1 + 0x70) = 0;
  *(undefined4 *)(param_1 + 0x60) = 0;
  *(undefined4 *)(param_1 + 0x78) = 0;
  *(undefined4 *)(param_1 + 0x6c) = 0;
  *(undefined4 *)(param_1 + 0x4c) = 0;
  *(undefined4 *)(param_1 + 0x7c) = 2;
  *(undefined4 *)(param_1 + 100) = 2;
  return;
}



// Function: FUN_6767846d at 6767846d

char __cdecl FUN_6767846d(int *param_1,int param_2)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  undefined1 *puVar4;
  uint uVar5;
  
  uVar5 = 0xffff;
  if (param_1[3] - 5U < 0xffff) {
    uVar5 = param_1[3] - 5U;
  }
  do {
    uVar3 = param_1[0x1e];
    if (uVar3 < 2) {
      FUN_676785a5(param_1);
      uVar3 = param_1[0x1e];
      if (uVar3 == 0) {
        if (param_2 == 0) {
          return '\0';
        }
        iVar2 = param_1[0x18];
        if (iVar2 < 0) {
          puVar4 = (undefined1 *)0x0;
        }
        else {
          puVar4 = (undefined1 *)(param_1[0xc] + iVar2);
        }
        FUN_6767b12d((short *)param_1,puVar4,param_1[0x1c] - iVar2,(uint)(param_2 == 4));
        param_1[0x18] = param_1[0x1c];
        FUN_676782ef(*param_1);
        if (*(int *)(*param_1 + 0x10) == 0) {
          if (param_2 != 4) {
            return '\0';
          }
          return '\x02';
        }
        return ((param_2 != 4) - 1U & 2) + 1;
      }
    }
    iVar2 = param_1[0x18];
    piVar1 = param_1 + 0x1c;
    *piVar1 = *piVar1 + uVar3;
    param_1[0x1e] = 0;
    uVar3 = iVar2 + uVar5;
    if ((*piVar1 == 0) || (uVar3 <= (uint)param_1[0x1c])) {
      param_1[0x1e] = param_1[0x1c] - uVar3;
      param_1[0x1c] = uVar3;
      if (iVar2 < 0) {
        puVar4 = (undefined1 *)0x0;
      }
      else {
        puVar4 = (undefined1 *)(param_1[0xc] + iVar2);
      }
      FUN_6767b12d((short *)param_1,puVar4,uVar3 - iVar2,0);
      param_1[0x18] = param_1[0x1c];
      FUN_676782ef(*param_1);
      if (*(int *)(*param_1 + 0x10) == 0) {
        return '\0';
      }
    }
    iVar2 = param_1[0x18];
    if ((uint)param_1[0xe] <= (uint)(param_1[0x1c] - iVar2)) {
      if (iVar2 < 0) {
        puVar4 = (undefined1 *)0x0;
      }
      else {
        puVar4 = (undefined1 *)(param_1[0xc] + iVar2);
      }
      FUN_6767b12d((short *)param_1,puVar4,param_1[0x1c] - iVar2,0);
      param_1[0x18] = param_1[0x1c];
      FUN_676782ef(*param_1);
      if (*(int *)(*param_1 + 0x10) == 0) {
        return '\0';
      }
    }
  } while( true );
}



// Function: FUN_676785a5 at 676785a5

void __cdecl FUN_676785a5(int *param_1)

{
  uint *puVar1;
  int *piVar2;
  int *piVar3;
  int *piVar4;
  uint *puVar5;
  uint uVar6;
  int iVar7;
  int *piVar8;
  
  piVar3 = param_1;
  piVar2 = (int *)param_1[9];
  piVar4 = piVar2;
  if (*(char *)((int)param_1 + 0x1d) == '\t') {
    piVar4 = (int *)((int)piVar2 + param_1[0x10]);
  }
  do {
    param_1 = piVar4;
    uVar6 = piVar3[0x1c];
    piVar4 = (int *)((piVar3[0xd] - uVar6) - piVar3[0x1e]);
    if (piVar4 == (int *)0x0) {
      if ((uVar6 != 0) || (piVar8 = piVar2, piVar3[0x1e] != 0)) {
LAB_676785eb:
        piVar8 = piVar4;
        if ((uint)(piVar3[0xe] + (int)piVar2) <= uVar6) {
          FUN_676b06d0((undefined4 *)piVar3[0xc],(undefined4 *)(piVar3[0xc] + (int)piVar2),
                       (uint)param_1);
          iVar7 = piVar3[0x14];
          piVar3[0x1d] = piVar3[0x1d] - (int)piVar2;
          piVar3[0x1c] = piVar3[0x1c] - (int)piVar2;
          piVar3[0x18] = piVar3[0x18] - (int)piVar2;
          puVar5 = (uint *)(piVar3[0x12] + iVar7 * 4);
          do {
            puVar1 = puVar5 + -1;
            puVar5 = puVar5 + -1;
            iVar7 = iVar7 + -1;
            *puVar5 = ~-(uint)((int *)*puVar1 < piVar2) & (int)*puVar1 - (int)piVar2;
          } while (iVar7 != 0);
          puVar5 = (uint *)(piVar3[0x11] + (int)piVar2 * 4);
          piVar8 = piVar2;
          do {
            puVar1 = puVar5 + -1;
            puVar5 = puVar5 + -1;
            piVar8 = (int *)((int)piVar8 - 1);
            *puVar5 = ~-(uint)((int *)*puVar1 < piVar2) & (int)*puVar1 - (int)piVar2;
          } while (piVar8 != (int *)0x0);
          piVar8 = (int *)((int)piVar4 + (int)piVar2);
        }
      }
    }
    else {
      if (piVar4 != (int *)0xffffffff) goto LAB_676785eb;
      piVar8 = (int *)0xfffffffe;
    }
    if (((int *)*piVar3)[1] == 0) {
      return;
    }
    uVar6 = FUN_676786b1((int *)*piVar3,(undefined4 *)(piVar3[0x1e] + piVar3[0x1c] + piVar3[0xc]),
                         (uint)piVar8);
    piVar3[0x1e] = piVar3[0x1e] + uVar6;
    if (2 < (uint)piVar3[0x1e]) {
      uVar6 = (uint)*(byte *)(piVar3[0x1c] + piVar3[0xc]);
      piVar3[0x13] = uVar6;
      piVar3[0x13] = (uVar6 << ((byte)piVar3[0x17] & 0x1f) ^
                     (uint)((byte *)(piVar3[0x1c] + piVar3[0xc]))[1]) & piVar3[0x16];
    }
    if ((uint)piVar3[0x10] <= (uint)piVar3[0x1e]) {
      return;
    }
    piVar4 = param_1;
    if (*(int *)(*piVar3 + 4) == 0) {
      return;
    }
  } while( true );
}



// Function: FUN_676786b1 at 676786b1

uint __cdecl FUN_676786b1(int *param_1,undefined4 *param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  
  uVar2 = param_1[1];
  uVar1 = uVar2;
  if (param_3 < uVar2) {
    uVar1 = param_3;
  }
  if (uVar1 == 0) {
    uVar1 = 0;
  }
  else {
    param_1[1] = uVar2 - uVar1;
    if (*(int *)(param_1[7] + 0x18) == 0) {
      uVar2 = FUN_67677bad(param_1[0xc],(byte *)*param_1,uVar1);
      param_1[0xc] = uVar2;
    }
    FUN_676b06d0(param_2,(undefined4 *)*param_1,uVar1);
    *param_1 = *param_1 + uVar1;
    param_1[2] = param_1[2] + uVar1;
  }
  return uVar1;
}



// Function: FUN_67678706 at 67678706

char __cdecl FUN_67678706(int *param_1,int param_2)

{
  int *piVar1;
  byte bVar2;
  int iVar3;
  ushort uVar4;
  char *pcVar5;
  undefined1 *puVar6;
  short sVar7;
  ushort uVar8;
  uint uVar9;
  uint uVar10;
  bool bVar11;
  
  uVar10 = 0;
  do {
    uVar9 = param_1[0x1e];
    if (uVar9 < (uint)param_1[0x10]) {
      FUN_676785a5(param_1);
      uVar9 = param_1[0x1e];
      if ((uVar9 < (uint)param_1[0x10]) && (param_2 == 0)) {
        return '\0';
      }
      if (uVar9 == 0) {
        iVar3 = param_1[0x18];
        if (iVar3 < 0) {
          puVar6 = (undefined1 *)0x0;
        }
        else {
          puVar6 = (undefined1 *)(param_1[0xc] + iVar3);
        }
        FUN_6767b12d((short *)param_1,puVar6,param_1[0x1c] - iVar3,(uint)(param_2 == 4));
        param_1[0x18] = param_1[0x1c];
        FUN_676782ef(*param_1);
        if (*(int *)(*param_1 + 0x10) == 0) {
          if (param_2 != 4) {
            return '\0';
          }
          return '\x02';
        }
        return ((param_2 != 4) - 1U & 2) + 1;
      }
    }
    if (2 < uVar9) {
      uVar10 = (param_1[0x13] << ((byte)param_1[0x17] & 0x1f) ^
               (uint)*(byte *)(param_1[0xc] + 2 + param_1[0x1c])) & param_1[0x16];
      param_1[0x13] = uVar10;
      uVar10 = *(uint *)(param_1[0x12] + uVar10 * 4);
      *(uint *)(param_1[0x11] + (param_1[0xb] & param_1[0x1c]) * 4) = uVar10;
      *(int *)(param_1[0x12] + param_1[0x13] * 4) = param_1[0x1c];
    }
    if (((uVar10 != 0) && (param_1[0x1c] - uVar10 <= (uint)param_1[0xe])) && (param_1[0x23] != 2)) {
      pcVar5 = FUN_676789d9((int)param_1,uVar10);
      param_1[0x19] = (int)pcVar5;
    }
    if ((uint)param_1[0x19] < 3) {
      bVar2 = *(byte *)(param_1[0xc] + param_1[0x1c]);
      *(undefined2 *)(param_1[0x5ae] + param_1[0x5ad] * 2) = 0;
      *(ushort *)(param_1[0x5ab] + param_1[0x5ad] * 2) = (ushort)bVar2;
      param_1[0x5ad] = param_1[0x5ad] + 1;
      *(short *)(param_1 + bVar2 + 0x26) = (short)param_1[bVar2 + 0x26] + 1;
      bVar11 = param_1[0x5ad] == param_1[0x5ac] + -1;
      param_1[0x1e] = param_1[0x1e] + -1;
LAB_67678933:
      param_1[0x1c] = param_1[0x1c] + 1;
    }
    else {
      sVar7 = (short)param_1[0x1c] - (short)param_1[0x1d];
      iVar3 = param_1[0x19];
      *(short *)(param_1[0x5ae] + param_1[0x5ad] * 2) = sVar7;
      uVar4 = (short)iVar3 - 3;
      uVar8 = sVar7 - 1;
      *(ushort *)(param_1[0x5ab] + param_1[0x5ad] * 2) = uVar4;
      param_1[0x5ad] = param_1[0x5ad] + 1;
      if ((*(char *)((int)param_1 + 0x1d) == '\b') ||
         ((uVar9 = 0x1c, uVar4 < 0x100 && (uVar9 = 0x1b, uVar4 != 0xff)))) {
        uVar9 = (uint)(byte)(&DAT_676b96d0)[uVar4];
      }
      *(short *)(param_1 + uVar9 + 0x127) = (short)param_1[uVar9 + 0x127] + 1;
      if (uVar8 < 0x100) {
        bVar2 = (&DAT_676b93d0)[uVar8];
      }
      else {
        bVar2 = (&DAT_676b94d0)[uVar8 >> 7];
      }
      *(short *)(param_1 + bVar2 + 0x263) = (short)param_1[bVar2 + 0x263] + 1;
      bVar11 = param_1[0x5ad] == param_1[0x5ac] + -1;
      uVar9 = param_1[0x19];
      param_1[0x1e] = param_1[0x1e] - uVar9;
      if ((uVar9 <= (uint)param_1[0x21]) && (2 < (uint)param_1[0x1e])) {
        param_1[0x19] = uVar9 - 1;
        do {
          param_1[0x1c] = param_1[0x1c] + 1;
          uVar10 = ((uint)*(byte *)(param_1[0xc] + 2 + param_1[0x1c]) ^
                   param_1[0x13] << ((byte)param_1[0x17] & 0x1f)) & param_1[0x16];
          param_1[0x13] = uVar10;
          uVar10 = *(uint *)(param_1[0x12] + uVar10 * 4);
          *(uint *)(param_1[0x11] + (param_1[0x1c] & param_1[0xb]) * 4) = uVar10;
          *(int *)(param_1[0x12] + param_1[0x13] * 4) = param_1[0x1c];
          piVar1 = param_1 + 0x19;
          *piVar1 = *piVar1 + -1;
        } while (*piVar1 != 0);
        goto LAB_67678933;
      }
      param_1[0x1c] = param_1[0x1c] + uVar9;
      param_1[0x19] = 0;
      uVar9 = (uint)*(byte *)(param_1[0xc] + param_1[0x1c]);
      param_1[0x13] = uVar9;
      param_1[0x13] =
           (uVar9 << ((byte)param_1[0x17] & 0x1f) ^
           (uint)((byte *)(param_1[0xc] + param_1[0x1c]))[1]) & param_1[0x16];
    }
    if (bVar11) {
      iVar3 = param_1[0x18];
      if (iVar3 < 0) {
        puVar6 = (undefined1 *)0x0;
      }
      else {
        puVar6 = (undefined1 *)(param_1[0xc] + iVar3);
      }
      FUN_6767b12d((short *)param_1,puVar6,param_1[0x1c] - iVar3,0);
      param_1[0x18] = param_1[0x1c];
      FUN_676782ef(*param_1);
      if (*(int *)(*param_1 + 0x10) == 0) {
        return '\0';
      }
    }
  } while( true );
}



// Function: FUN_676789d9 at 676789d9

char * __cdecl FUN_676789d9(int param_1,uint param_2)

{
  undefined4 *puVar1;
  uint *puVar2;
  int iVar3;
  char *pcVar4;
  char *pcVar5;
  char *pcVar6;
  char *pcVar7;
  char *pcVar8;
  char *pcVar9;
  uint local_18;
  char *local_14;
  uint local_c;
  char local_5;
  
  iVar3 = param_1;
  local_c = *(uint *)(param_1 + 0x80);
  puVar1 = (undefined4 *)(param_1 + 0x94);
  local_18 = *(uint *)(param_1 + 0x70);
  pcVar9 = *(char **)(param_1 + 0x7c);
  pcVar7 = (char *)(*(int *)(param_1 + 0x30) + local_18);
  if (*(uint *)(param_1 + 0x38) < local_18) {
    local_18 = local_18 - *(uint *)(param_1 + 0x38);
  }
  else {
    local_18 = 0;
  }
  pcVar4 = (char *)(*(int *)(param_1 + 0x30) + *(int *)(param_1 + 0x3c) + *(int *)(param_1 + 0x70));
  puVar2 = (uint *)(param_1 + 0x90);
  param_1 = (uint)(byte)(pcVar9 + -1)[(int)pcVar7] << 0x18;
  local_5 = pcVar9[(int)pcVar7];
  if ((char *)*puVar2 <= pcVar9) {
    local_c = local_c >> 2;
  }
  pcVar5 = *(char **)(iVar3 + 0x78);
  local_14 = (char *)*puVar1;
  if (pcVar5 < (char *)*puVar1) {
    local_14 = pcVar5;
  }
  do {
    pcVar8 = (char *)(*(int *)(iVar3 + 0x30) + param_2);
    if ((((pcVar8[(int)pcVar9] == local_5) && ((pcVar8 + -1)[(int)pcVar9] == param_1._3_1_)) &&
        (*pcVar8 == *pcVar7)) && (pcVar8[1] == pcVar7[1])) {
      pcVar8 = pcVar8 + 2;
      pcVar7 = pcVar7 + 2;
      while (((((pcVar6 = pcVar7 + 1, pcVar7[1] == pcVar8[1] &&
                (pcVar6 = pcVar7 + 2, pcVar7[2] == pcVar8[2])) &&
               ((pcVar6 = pcVar7 + 3, pcVar7[3] == pcVar8[3] &&
                ((pcVar6 = pcVar7 + 4, pcVar7[4] == pcVar8[4] &&
                 (pcVar6 = pcVar7 + 5, pcVar7[5] == pcVar8[5])))))) &&
              (pcVar6 = pcVar7 + 6, pcVar7[6] == pcVar8[6])) &&
             (pcVar6 = pcVar7 + 7, pcVar7[7] == pcVar8[7]))) {
        pcVar6 = pcVar7 + 8;
        pcVar8 = pcVar8 + 8;
        if ((pcVar7[8] != *pcVar8) || (pcVar7 = pcVar6, pcVar4 <= pcVar6)) break;
      }
      pcVar6 = pcVar6 + (*(int *)(iVar3 + 0x3c) - (int)pcVar4);
      pcVar7 = pcVar4 + -*(int *)(iVar3 + 0x3c);
      if ((int)pcVar9 < (int)pcVar6) {
        *(uint *)(iVar3 + 0x74) = param_2;
        if ((int)local_14 <= (int)pcVar6) {
LAB_67678b17:
          if (pcVar6 <= pcVar5) {
            pcVar5 = pcVar6;
          }
          return pcVar5;
        }
        param_1 = (uint)(byte)(pcVar6 + -1)[(int)pcVar7] << 0x18;
        local_5 = pcVar6[(int)pcVar7];
        pcVar9 = pcVar6;
      }
    }
    pcVar6 = pcVar9;
    param_2 = *(uint *)(*(int *)(iVar3 + 0x44) + (*(uint *)(iVar3 + 0x2c) & param_2) * 4);
    if ((param_2 <= local_18) || (local_c = local_c - 1, pcVar9 = pcVar6, local_c == 0))
    goto LAB_67678b17;
  } while( true );
}



// Function: FUN_67678b25 at 67678b25

char __cdecl FUN_67678b25(int *param_1,int param_2)

{
  int *piVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  short sVar7;
  ushort uVar8;
  char *pcVar9;
  ushort uVar10;
  undefined1 *puVar11;
  uint uVar12;
  uint uVar13;
  
  uVar13 = 0;
  do {
    uVar12 = param_1[0x1e];
    if (uVar12 < (uint)param_1[0x10]) {
      FUN_676785a5(param_1);
      uVar12 = param_1[0x1e];
      if ((uVar12 < (uint)param_1[0x10]) && (param_2 == 0)) {
        return '\0';
      }
      if (uVar12 == 0) {
        if (param_1[0x1b] != 0) {
          bVar2 = *(byte *)(param_1[0x1c] + -1 + param_1[0xc]);
          piVar1 = param_1 + 0x5ad;
          *(undefined2 *)(param_1[0x5ae] + param_1[0x5ad] * 2) = 0;
          *(ushort *)(param_1[0x5ab] + *piVar1 * 2) = (ushort)bVar2;
          *piVar1 = *piVar1 + 1;
          *(short *)(param_1 + bVar2 + 0x26) = (short)param_1[bVar2 + 0x26] + 1;
          param_1[0x1b] = 0;
        }
        iVar3 = param_1[0x18];
        if (iVar3 < 0) {
          puVar11 = (undefined1 *)0x0;
        }
        else {
          puVar11 = (undefined1 *)(param_1[0xc] + iVar3);
        }
        FUN_6767b12d((short *)param_1,puVar11,param_1[0x1c] - iVar3,(uint)(param_2 == 4));
        param_1[0x18] = param_1[0x1c];
        FUN_676782ef(*param_1);
        if (*(int *)(*param_1 + 0x10) == 0) {
          if (param_2 != 4) {
            return '\0';
          }
          return '\x02';
        }
        return ((param_2 != 4) - 1U & 2) + 1;
      }
    }
    if (2 < uVar12) {
      uVar13 = (param_1[0x13] << ((byte)param_1[0x17] & 0x1f) ^
               (uint)*(byte *)(param_1[0xc] + 2 + param_1[0x1c])) & param_1[0x16];
      param_1[0x13] = uVar13;
      uVar13 = *(uint *)(param_1[0x12] + uVar13 * 4);
      *(uint *)(param_1[0x11] + (param_1[0xb] & param_1[0x1c]) * 4) = uVar13;
      *(int *)(param_1[0x12] + param_1[0x13] * 4) = param_1[0x1c];
    }
    param_1[0x1f] = param_1[0x19];
    param_1[0x1a] = param_1[0x1d];
    param_1[0x19] = 2;
    if (((uVar13 != 0) && ((uint)param_1[0x1f] < (uint)param_1[0x21])) &&
       (param_1[0x1c] - uVar13 <= (uint)param_1[0xe])) {
      if (param_1[0x23] != 2) {
        pcVar9 = FUN_676789d9((int)param_1,uVar13);
        param_1[0x19] = (int)pcVar9;
      }
      if (((uint)param_1[0x19] < 6) &&
         ((param_1[0x23] == 1 ||
          ((param_1[0x19] == 3 && (0x1000 < (uint)(param_1[0x1c] - param_1[0x1d]))))))) {
        param_1[0x19] = 2;
      }
    }
    if (((uint)param_1[0x1f] < 3) || ((uint)param_1[0x1f] < (uint)param_1[0x19])) {
      if (param_1[0x1b] == 0) {
        param_1[0x1c] = param_1[0x1c] + 1;
        param_1[0x1e] = param_1[0x1e] + -1;
        param_1[0x1b] = 1;
      }
      else {
        bVar2 = *(byte *)(param_1[0xc] + -1 + param_1[0x1c]);
        *(undefined2 *)(param_1[0x5ae] + param_1[0x5ad] * 2) = 0;
        *(ushort *)(param_1[0x5ab] + param_1[0x5ad] * 2) = (ushort)bVar2;
        param_1[0x5ad] = param_1[0x5ad] + 1;
        *(short *)(param_1 + bVar2 + 0x26) = (short)param_1[bVar2 + 0x26] + 1;
        if (param_1[0x5ad] == param_1[0x5ac] + -1) {
          iVar3 = param_1[0x18];
          if (iVar3 < 0) {
            puVar11 = (undefined1 *)0x0;
          }
          else {
            puVar11 = (undefined1 *)(param_1[0xc] + iVar3);
          }
          FUN_6767b12d((short *)param_1,puVar11,param_1[0x1c] - iVar3,0);
          param_1[0x18] = param_1[0x1c];
          FUN_676782ef(*param_1);
        }
        param_1[0x1c] = param_1[0x1c] + 1;
        param_1[0x1e] = param_1[0x1e] + -1;
        if (*(int *)(*param_1 + 0x10) == 0) {
          return '\0';
        }
      }
    }
    else {
      iVar3 = param_1[0x1c];
      iVar4 = param_1[0x1e];
      sVar7 = (short)iVar3 - (short)param_1[0x1a];
      uVar10 = (short)param_1[0x1f] - 3;
      *(short *)(param_1[0x5ae] + param_1[0x5ad] * 2) = sVar7 + -1;
      uVar8 = sVar7 - 2;
      *(ushort *)(param_1[0x5ab] + param_1[0x5ad] * 2) = uVar10;
      param_1[0x5ad] = param_1[0x5ad] + 1;
      if ((*(char *)((int)param_1 + 0x1d) == '\b') ||
         ((uVar12 = 0x1c, uVar10 < 0x100 && (uVar12 = 0x1b, uVar10 != 0xff)))) {
        uVar12 = (uint)(byte)(&DAT_676b96d0)[uVar10];
      }
      *(short *)(param_1 + uVar12 + 0x127) = (short)param_1[uVar12 + 0x127] + 1;
      if (uVar8 < 0x100) {
        bVar2 = (&DAT_676b93d0)[uVar8];
      }
      else {
        bVar2 = (&DAT_676b94d0)[uVar8 >> 7];
      }
      *(short *)(param_1 + bVar2 + 0x263) = (short)param_1[bVar2 + 0x263] + 1;
      iVar5 = param_1[0x5ac];
      iVar6 = param_1[0x5ad];
      param_1[0x1e] = param_1[0x1e] + (1 - param_1[0x1f]);
      param_1[0x1f] = param_1[0x1f] + -2;
      do {
        param_1[0x1c] = param_1[0x1c] + 1;
        uVar12 = param_1[0x1c];
        if (uVar12 <= (uint)(iVar3 + -3 + iVar4)) {
          uVar13 = (param_1[0x13] << ((byte)param_1[0x17] & 0x1f) ^
                   (uint)*(byte *)(param_1[0xc] + 2 + uVar12)) & param_1[0x16];
          param_1[0x13] = uVar13;
          uVar13 = *(uint *)(param_1[0x12] + uVar13 * 4);
          *(uint *)(param_1[0x11] + (param_1[0xb] & uVar12) * 4) = uVar13;
          *(int *)(param_1[0x12] + param_1[0x13] * 4) = param_1[0x1c];
        }
        piVar1 = param_1 + 0x1f;
        *piVar1 = *piVar1 + -1;
      } while (*piVar1 != 0);
      param_1[0x1b] = 0;
      param_1[0x1c] = param_1[0x1c] + 1;
      param_1[0x19] = 2;
      if (iVar6 == iVar5 + -1) {
        iVar3 = param_1[0x18];
        if (iVar3 < 0) {
          puVar11 = (undefined1 *)0x0;
        }
        else {
          puVar11 = (undefined1 *)(param_1[0xc] + iVar3);
        }
        FUN_6767b12d((short *)param_1,puVar11,param_1[0x1c] - iVar3,0);
        param_1[0x18] = param_1[0x1c];
        FUN_676782ef(*param_1);
        if (*(int *)(*param_1 + 0x10) == 0) {
          return '\0';
        }
      }
    }
  } while( true );
}



// Function: FUN_67678ed6 at 67678ed6

void __cdecl FUN_67678ed6(int *param_1,int param_2,int *param_3)

{
  int iVar1;
  
  if (param_3 != (int *)0x0) {
    *param_3 = param_1[0x14];
  }
  if ((*param_1 == 4) || (*param_1 == 5)) {
    (**(code **)(param_2 + 0x24))(*(undefined4 *)(param_2 + 0x28),param_1[3]);
  }
  if (*param_1 == 6) {
    FUN_67679e31(param_1[1],param_2);
  }
  *param_1 = 0;
  param_1[0x12] = param_1[0xf];
  param_1[0x11] = param_1[0xf];
  param_1[6] = 0;
  param_1[0xc] = 0;
  param_1[0xd] = 0;
  if ((code *)param_1[0x13] != (code *)0x0) {
    iVar1 = (*(code *)param_1[0x13])(0,0,0);
    param_1[0x14] = iVar1;
    *(int *)(param_2 + 0x30) = iVar1;
  }
  return;
}



// Function: FUN_67678f44 at 67678f44

int * __cdecl FUN_67678f44(int param_1,int param_2,int param_3)

{
  int *piVar1;
  int iVar2;
  
  piVar1 = (int *)(**(code **)(param_1 + 0x20))(*(undefined4 *)(param_1 + 0x28),1,0x54);
  if (piVar1 != (int *)0x0) {
    iVar2 = (**(code **)(param_1 + 0x20))(*(undefined4 *)(param_1 + 0x28),8,0x5a0);
    piVar1[0xe] = iVar2;
    if (iVar2 == 0) {
      (**(code **)(param_1 + 0x24))(*(undefined4 *)(param_1 + 0x28),piVar1);
    }
    else {
      iVar2 = (**(code **)(param_1 + 0x20))(*(undefined4 *)(param_1 + 0x28),1,param_3);
      piVar1[0xf] = iVar2;
      if (iVar2 != 0) {
        *piVar1 = 0;
        piVar1[0x10] = iVar2 + param_3;
        piVar1[0x13] = param_2;
        FUN_67678ed6(piVar1,param_1,(int *)0x0);
        return piVar1;
      }
      (**(code **)(param_1 + 0x24))(*(undefined4 *)(param_1 + 0x28),piVar1[0xe]);
      (**(code **)(param_1 + 0x24))(*(undefined4 *)(param_1 + 0x28),piVar1);
    }
  }
  return (int *)0x0;
}



// Function: FUN_67678fcf at 67678fcf

void __cdecl FUN_67678fcf(uint *param_1,int *param_2,uint param_3)

{
  uint *puVar1;
  byte bVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  uint *puVar5;
  int *piVar6;
  int iVar7;
  undefined4 uVar8;
  uint uVar9;
  byte *pbVar10;
  int local_20;
  int local_1c;
  uint local_18;
  uint local_14;
  uint local_10;
  undefined4 *local_c;
  uint local_8;
  
  piVar6 = param_2;
  puVar5 = param_1;
  local_c = (undefined4 *)param_1[0x12];
  local_8 = param_2[1];
  pbVar10 = (byte *)*param_2;
  param_2 = (int *)param_1[0xc];
  if (local_c < (undefined4 *)param_1[0x11]) {
    local_14 = (int)param_1[0x11] + (-1 - (int)local_c);
    param_1 = (uint *)param_1[0xd];
  }
  else {
    local_14 = param_1[0x10] - (int)local_c;
    param_1 = (uint *)param_1[0xd];
  }
LAB_6767900c:
  switch(*puVar5) {
  case 0:
    for (; param_2 < (int *)0x3; param_2 = param_2 + 2) {
      if (local_8 == 0) goto LAB_67679652;
      param_3 = 0;
      local_8 = local_8 - 1;
      param_1 = (uint *)((uint)param_1 | (uint)*pbVar10 << ((byte)param_2 & 0x1f));
      pbVar10 = pbVar10 + 1;
    }
    uVar9 = ((uint)param_1 & 7) >> 1;
    puVar5[0xb] = (uint)param_1 & 1;
    if (uVar9 == 0) {
      *puVar5 = 1;
      uVar9 = (int)param_2 - 3U & 7;
      param_2 = (int *)(((int)param_2 - 3U) - uVar9);
      param_1 = (uint *)(((uint)param_1 >> 3) >> (sbyte)uVar9);
    }
    else if (uVar9 == 1) {
      if (puVar5[6] != *(uint *)(piVar6[7] + 0xc)) {
        puVar5[6] = *(uint *)(piVar6[7] + 0xc);
        FUN_6767ab77(*(int *)(piVar6[7] + 0xc),puVar5 + 7,puVar5 + 8,(int *)(puVar5 + 9),
                     (int *)(puVar5 + 10),puVar5[0xe],(int)piVar6);
      }
      uVar9 = FUN_6767982a((char)puVar5[7],(char)puVar5[8],puVar5[9],puVar5[10],(int)piVar6);
      puVar5[1] = uVar9;
      if (uVar9 == 0) {
LAB_67679701:
        param_3 = 0xfffffffc;
        puVar5[0xd] = (uint)param_1;
        puVar5[0xc] = (uint)param_2;
        piVar6[1] = local_8;
        iVar7 = *piVar6;
        *piVar6 = (int)pbVar10;
        piVar6[2] = (int)(pbVar10 + (piVar6[2] - iVar7));
        puVar5[0x12] = (uint)local_c;
        goto LAB_676797bf;
      }
      param_2 = (int *)((int)param_2 + -3);
      *puVar5 = 6;
      param_1 = (uint *)((uint)param_1 >> 3);
    }
    else {
      if (uVar9 != 2) goto code_r0x67679064;
      param_2 = (int *)((int)param_2 + -3);
      *puVar5 = 3;
      param_1 = (uint *)((uint)param_1 >> 3);
    }
    goto LAB_6767900c;
  case 1:
    for (; param_2 < (int *)0x20; param_2 = param_2 + 2) {
      if (local_8 == 0) goto LAB_67679652;
      param_3 = 0;
      local_8 = local_8 - 1;
      param_1 = (uint *)((uint)param_1 | (uint)*pbVar10 << ((byte)param_2 & 0x1f));
      pbVar10 = pbVar10 + 1;
    }
    if (~(uint)param_1 >> 0x10 != ((uint)param_1 & 0xffff)) {
      *puVar5 = 9;
      piVar6[6] = (int)s_invalid_stored_block_lengths_676c027c;
      goto switchD_67679017_caseD_9;
    }
    puVar5[1] = (uint)param_1 & 0xffff;
    param_2 = (int *)0x0;
    param_1 = (uint *)0x0;
    if (puVar5[1] == 0) goto LAB_67679154;
    uVar9 = 2;
    break;
  case 2:
    if (local_8 == 0) {
LAB_67679652:
      puVar5[0xd] = (uint)param_1;
      puVar5[0xc] = (uint)param_2;
      piVar6[1] = 0;
LAB_67679662:
      iVar7 = *piVar6;
      *piVar6 = (int)pbVar10;
      piVar6[2] = (int)(pbVar10 + (piVar6[2] - iVar7));
      puVar5[0x12] = (uint)local_c;
      goto LAB_676797bf;
    }
    if (local_14 == 0) {
      if (local_c == (undefined4 *)puVar5[0x10]) {
        puVar3 = (undefined4 *)puVar5[0x11];
        puVar4 = (undefined4 *)puVar5[0xf];
        if (puVar4 != puVar3) {
          if (puVar4 < puVar3) {
            local_14 = (int)puVar3 + (-1 - (int)puVar4);
          }
          else {
            local_14 = (int)puVar5[0x10] - (int)puVar4;
          }
          local_c = puVar4;
          if (local_14 != 0) goto LAB_67679205;
        }
      }
      puVar5[0x12] = (uint)local_c;
      param_3 = FUN_6767aca0((int)puVar5,(int)piVar6,param_3);
      puVar3 = (undefined4 *)puVar5[0x11];
      local_c = (undefined4 *)puVar5[0x12];
      if (local_c < puVar3) {
        local_14 = (int)puVar3 + (-1 - (int)local_c);
      }
      else {
        local_14 = puVar5[0x10] - (int)local_c;
      }
      if (local_c == (undefined4 *)puVar5[0x10]) {
        puVar4 = (undefined4 *)puVar5[0xf];
        if (puVar4 != puVar3) {
          local_c = puVar4;
          if (puVar4 < puVar3) {
            local_14 = (int)puVar3 + (-1 - (int)puVar4);
          }
          else {
            local_14 = (int)puVar5[0x10] - (int)puVar4;
          }
        }
      }
      if (local_14 == 0) {
        puVar5[0xd] = (uint)param_1;
        puVar5[0xc] = (uint)param_2;
        piVar6[1] = local_8;
        goto LAB_67679662;
      }
    }
LAB_67679205:
    local_10 = puVar5[1];
    param_3 = 0;
    if (local_8 < local_10) {
      local_10 = local_8;
    }
    if (local_14 < local_10) {
      local_10 = local_14;
    }
    FUN_676b06d0(local_c,(undefined4 *)pbVar10,local_10);
    local_8 = local_8 - local_10;
    local_c = (undefined4 *)((int)local_c + local_10);
    local_14 = local_14 - local_10;
    pbVar10 = pbVar10 + local_10;
    puVar1 = puVar5 + 1;
    *puVar1 = *puVar1 - local_10;
    if (*puVar1 != 0) goto LAB_6767900c;
LAB_67679154:
    uVar9 = -(uint)(puVar5[0xb] != 0) & 7;
    break;
  case 3:
    for (; param_2 < (int *)0xe; param_2 = param_2 + 2) {
      if (local_8 == 0) goto LAB_67679652;
      param_3 = 0;
      local_8 = local_8 - 1;
      param_1 = (uint *)((uint)param_1 | (uint)*pbVar10 << ((byte)param_2 & 0x1f));
      pbVar10 = pbVar10 + 1;
    }
    puVar5[1] = (uint)param_1 & 0x3fff;
    if (((uint)param_1 & 0x1f) < 0x1e) {
      uVar9 = (*(code *)piVar6[8])
                        (piVar6[10],
                         (((uint)param_1 & 0x3fff) >> 5 & 0x1f) + 0x102 + ((uint)param_1 & 0x1f),4);
      puVar5[3] = uVar9;
      if (uVar9 == 0) goto LAB_67679701;
      param_1 = (uint *)((uint)param_1 >> 0xe);
      param_2 = (int *)((int)param_2 + -0xe);
      puVar5[2] = 0;
      *puVar5 = 4;
      goto switchD_67679017_caseD_4;
    }
    *puVar5 = 9;
    piVar6[6] = (int)s_too_many_length_or_distance_symb_676c0258;
  case 9:
switchD_67679017_caseD_9:
    puVar5[0xd] = (uint)param_1;
    goto LAB_6767960a;
  case 4:
switchD_67679017_caseD_4:
    if (puVar5[2] < (puVar5[1] >> 10) + 4) {
      do {
        for (; param_2 < (int *)0x3; param_2 = param_2 + 2) {
          if (local_8 == 0) goto LAB_67679652;
          param_3 = 0;
          local_8 = local_8 - 1;
          param_1 = (uint *)((uint)param_1 | (uint)*pbVar10 << ((byte)param_2 & 0x1f));
          pbVar10 = pbVar10 + 1;
        }
        uVar9 = (uint)param_1 & 7;
        param_2 = (int *)((int)param_2 + -3);
        param_1 = (uint *)((uint)param_1 >> 3);
        *(uint *)(puVar5[3] + *(int *)(&DAT_676b8998 + puVar5[2] * 4) * 4) = uVar9;
        puVar5[2] = puVar5[2] + 1;
      } while (puVar5[2] < (puVar5[1] >> 10) + 4);
    }
    while (puVar5[2] < 0x13) {
      *(undefined4 *)(puVar5[3] + *(int *)(&DAT_676b8998 + puVar5[2] * 4) * 4) = 0;
      puVar5[2] = puVar5[2] + 1;
    }
    puVar5[4] = 7;
    local_10 = FUN_6767a646((int *)puVar5[3],puVar5 + 4,(int *)(puVar5 + 5),puVar5[0xe],(int)piVar6)
    ;
    if (local_10 == 0) {
      puVar5[2] = 0;
      *puVar5 = 5;
      goto switchD_67679017_caseD_5;
    }
    goto LAB_676796c5;
  case 5:
switchD_67679017_caseD_5:
    while (puVar5[2] < (puVar5[1] >> 5 & 0x1f) + 0x102 + (puVar5[1] & 0x1f)) {
      for (; param_2 < (int *)puVar5[4]; param_2 = param_2 + 2) {
        if (local_8 == 0) goto LAB_67679652;
        param_3 = 0;
        local_8 = local_8 - 1;
        param_1 = (uint *)((uint)param_1 | (uint)*pbVar10 << ((byte)param_2 & 0x1f));
        pbVar10 = pbVar10 + 1;
      }
      local_18 = *(uint *)(puVar5[5] + 4 +
                          (*(uint *)(&DAT_676c0444 + (int)puVar5[4] * 4) & (uint)param_1) * 8);
      bVar2 = *(byte *)(puVar5[5] +
                        (*(uint *)(&DAT_676c0444 + (int)puVar5[4] * 4) & (uint)param_1) * 8 + 1);
      local_10 = (uint)bVar2;
      if (local_18 < 0x10) {
        param_1 = (uint *)((uint)param_1 >> (bVar2 & 0x1f));
        param_2 = (int *)((int)param_2 - local_10);
        *(uint *)(puVar5[3] + puVar5[2] * 4) = local_18;
        puVar5[2] = puVar5[2] + 1;
      }
      else {
        if (local_18 == 0x12) {
          iVar7 = 7;
        }
        else {
          iVar7 = local_18 - 0xe;
        }
        local_14 = ((local_18 != 0x12) - 1 & 8) + 3;
        for (; param_2 < (int *)(iVar7 + local_10); param_2 = param_2 + 2) {
          if (local_8 == 0) goto LAB_67679652;
          param_3 = 0;
          local_8 = local_8 - 1;
          param_1 = (uint *)((uint)param_1 | (uint)*pbVar10 << ((byte)param_2 & 0x1f));
          pbVar10 = pbVar10 + 1;
        }
        uVar9 = (uint)param_1 >> (bVar2 & 0x1f);
        local_14 = local_14 + (*(uint *)(&DAT_676c0444 + iVar7 * 4) & uVar9);
        param_1 = (uint *)(uVar9 >> ((byte)iVar7 & 0x1f));
        uVar9 = puVar5[2];
        param_2 = (int *)((int)param_2 - (iVar7 + local_10));
        if ((puVar5[1] >> 5 & 0x1f) + 0x102 + (puVar5[1] & 0x1f) < local_14 + uVar9) {
LAB_67679679:
          (*(code *)piVar6[9])(piVar6[10],puVar5[3]);
          *puVar5 = 9;
          piVar6[6] = (int)s_invalid_bit_length_repeat_676c023c;
          puVar5[0xd] = (uint)param_1;
          puVar5[0xc] = (uint)param_2;
          piVar6[1] = local_8;
          iVar7 = *piVar6;
          *piVar6 = (int)pbVar10;
          piVar6[2] = (int)(pbVar10 + (piVar6[2] - iVar7));
          puVar5[0x12] = (uint)local_c;
          FUN_6767aca0((int)puVar5,(int)piVar6,-3);
          return;
        }
        if (local_18 == 0x10) {
          if (uVar9 == 0) goto LAB_67679679;
          uVar8 = *(undefined4 *)((puVar5[3] - 4) + uVar9 * 4);
        }
        else {
          uVar8 = 0;
        }
        do {
          *(undefined4 *)(puVar5[3] + uVar9 * 4) = uVar8;
          uVar9 = uVar9 + 1;
          local_14 = local_14 - 1;
        } while (local_14 != 0);
        puVar5[2] = uVar9;
        local_14 = 0;
      }
    }
    puVar5[5] = 0;
    puVar5[6] = 0;
    local_18 = 9;
    local_14 = 6;
    local_10 = FUN_6767aa4c(*(int *)(piVar6[7] + 0xc),(puVar5[1] & 0x1f) + 0x101,
                            (puVar5[1] >> 5 & 0x1f) + 1,(int *)puVar5[3],&local_18,&local_14,
                            &local_20,&local_1c,puVar5[0xe],(int)piVar6);
    if (local_10 == 0) {
      uVar9 = FUN_6767982a((char)local_18,(char)local_14,local_20,local_1c,(int)piVar6);
      if (uVar9 == 0) goto LAB_67679701;
      puVar5[1] = uVar9;
      (*(code *)piVar6[9])(piVar6[10],puVar5[3]);
      *puVar5 = 6;
      goto switchD_67679017_caseD_6;
    }
LAB_676796c5:
    if (local_10 == 0xfffffffd) {
      (*(code *)piVar6[9])(piVar6[10],puVar5[3]);
      *puVar5 = 9;
    }
    puVar5[0xd] = (uint)param_1;
    puVar5[0xc] = (uint)param_2;
    piVar6[1] = local_8;
    iVar7 = *piVar6;
    *piVar6 = (int)pbVar10;
    piVar6[2] = (int)(pbVar10 + (piVar6[2] - iVar7));
    puVar5[0x12] = (uint)local_c;
    param_3 = local_10;
    goto LAB_676797bf;
  case 6:
switchD_67679017_caseD_6:
    puVar5[0xd] = (uint)param_1;
    puVar5[0xc] = (uint)param_2;
    piVar6[1] = local_8;
    iVar7 = *piVar6;
    *piVar6 = (int)pbVar10;
    piVar6[2] = (int)(pbVar10 + (piVar6[2] - iVar7));
    puVar5[0x12] = (uint)local_c;
    param_3 = FUN_6767985e((uint)puVar5,piVar6,param_3);
    if (param_3 != 1) goto LAB_676797bf;
    param_3 = 0;
    FUN_67679e31(puVar5[1],(int)piVar6);
    local_8 = piVar6[1];
    pbVar10 = (byte *)*piVar6;
    param_1 = (uint *)puVar5[0xd];
    param_2 = (int *)puVar5[0xc];
    local_c = (undefined4 *)puVar5[0x12];
    if (local_c < (undefined4 *)puVar5[0x11]) {
      local_14 = (int)puVar5[0x11] + (-1 - (int)local_c);
    }
    else {
      local_14 = puVar5[0x10] - (int)local_c;
    }
    if (puVar5[0xb] != 0) {
      *puVar5 = 7;
      goto switchD_67679017_caseD_7;
    }
    *puVar5 = 0;
    goto LAB_6767900c;
  case 7:
switchD_67679017_caseD_7:
    puVar5[0x12] = (uint)local_c;
    param_3 = FUN_6767aca0((int)puVar5,(int)piVar6,param_3);
    local_c = (undefined4 *)puVar5[0x12];
    if ((undefined4 *)puVar5[0x11] == local_c) {
      *puVar5 = 8;
switchD_67679017_caseD_8:
      param_3 = 1;
      puVar5[0xd] = (uint)param_1;
      puVar5[0xc] = (uint)param_2;
      piVar6[1] = local_8;
      iVar7 = *piVar6;
      *piVar6 = (int)pbVar10;
      piVar6[2] = (int)(pbVar10 + (piVar6[2] - iVar7));
      puVar5[0x12] = (uint)local_c;
    }
    else {
      puVar5[0xd] = (uint)param_1;
      puVar5[0xc] = (uint)param_2;
      piVar6[1] = local_8;
      iVar7 = *piVar6;
      *piVar6 = (int)pbVar10;
      piVar6[2] = (int)(pbVar10 + (piVar6[2] - iVar7));
      puVar5[0x12] = (uint)local_c;
    }
    goto LAB_676797bf;
  case 8:
    goto switchD_67679017_caseD_8;
  default:
    param_3 = 0xfffffffe;
    puVar5[0xd] = (uint)param_1;
    puVar5[0xc] = (uint)param_2;
    piVar6[1] = local_8;
    iVar7 = *piVar6;
    *piVar6 = (int)pbVar10;
    piVar6[2] = (int)(pbVar10 + (piVar6[2] - iVar7));
    puVar5[0x12] = (uint)local_c;
    goto LAB_676797bf;
  }
  *puVar5 = uVar9;
  goto LAB_6767900c;
code_r0x67679064:
  if (uVar9 == 3) {
    *puVar5 = 9;
    piVar6[6] = (int)s_invalid_block_type_676c029c;
    puVar5[0xd] = (uint)param_1 >> 3;
    param_2 = (int *)((int)param_2 - 3);
LAB_6767960a:
    puVar5[0xc] = (uint)param_2;
    piVar6[1] = local_8;
    iVar7 = *piVar6;
    *piVar6 = (int)pbVar10;
    param_3 = 0xfffffffd;
    piVar6[2] = (int)(pbVar10 + (piVar6[2] - iVar7));
    puVar5[0x12] = (uint)local_c;
LAB_676797bf:
    FUN_6767aca0((int)puVar5,(int)piVar6,param_3);
    return;
  }
  goto LAB_6767900c;
}



// Function: FUN_676797f6 at 676797f6

undefined4 __cdecl FUN_676797f6(int *param_1,int param_2)

{
  FUN_67678ed6(param_1,param_2,(int *)0x0);
  (**(code **)(param_2 + 0x24))(*(undefined4 *)(param_2 + 0x28),param_1[0xf]);
  (**(code **)(param_2 + 0x24))(*(undefined4 *)(param_2 + 0x28),param_1[0xe]);
  (**(code **)(param_2 + 0x24))(*(undefined4 *)(param_2 + 0x28),param_1);
  return 0;
}



// Function: FUN_6767982a at 6767982a

void __cdecl
FUN_6767982a(undefined1 param_1,undefined1 param_2,undefined4 param_3,undefined4 param_4,int param_5
            )

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)(**(code **)(param_5 + 0x20))(*(undefined4 *)(param_5 + 0x28),1,0x1c);
  if (puVar1 != (undefined4 *)0x0) {
    *puVar1 = 0;
    *(undefined1 *)(puVar1 + 4) = param_1;
    *(undefined1 *)((int)puVar1 + 0x11) = param_2;
    puVar1[5] = param_3;
    puVar1[6] = param_4;
  }
  return;
}



// Function: FUN_6767985e at 6767985e

void __cdecl FUN_6767985e(uint param_1,int *param_2,int param_3)

{
  int *piVar1;
  byte bVar2;
  int *piVar3;
  undefined1 *puVar4;
  int iVar5;
  uint uVar6;
  int *piVar7;
  uint uVar8;
  undefined1 *puVar9;
  undefined1 *puVar10;
  undefined1 *local_20;
  byte *local_18;
  undefined1 *local_14;
  undefined1 *local_10;
  uint local_c;
  byte *local_8;
  
  piVar7 = param_2;
  uVar6 = param_1;
  local_20 = (undefined1 *)0x102;
  piVar3 = *(int **)(param_1 + 4);
  if (*(int *)(param_2[7] + 0xc) == 9) {
    local_20 = (undefined1 *)0xffff;
  }
  local_8 = (byte *)*param_2;
  puVar10 = *(undefined1 **)(param_1 + 0x48);
  local_c = param_2[1];
  param_2 = *(int **)(param_1 + 0x34);
  if (puVar10 < *(undefined1 **)(param_1 + 0x44)) {
    local_10 = *(undefined1 **)(param_1 + 0x44) + (-1 - (int)puVar10);
    param_1 = *(uint *)(param_1 + 0x30);
  }
  else {
    local_10 = (undefined1 *)(*(int *)(param_1 + 0x40) - (int)puVar10);
    param_1 = *(uint *)(param_1 + 0x30);
  }
  do {
    switch(*piVar3) {
    case 0:
      if ((local_20 <= local_10) && (9 < local_c)) {
        *(int **)(uVar6 + 0x34) = param_2;
        *(uint *)(uVar6 + 0x30) = param_1;
        piVar7[1] = local_c;
        iVar5 = *piVar7;
        *piVar7 = (int)local_8;
        piVar7[2] = (int)(local_8 + (piVar7[2] - iVar5));
        *(undefined1 **)(uVar6 + 0x48) = puVar10;
        param_3 = FUN_67679e42((uint)*(byte *)(piVar3 + 4),
                               (byte *)(uint)*(byte *)((int)piVar3 + 0x11),piVar3[5],piVar3[6],uVar6
                               ,piVar7);
        local_8 = (byte *)*piVar7;
        local_c = piVar7[1];
        puVar10 = *(undefined1 **)(uVar6 + 0x48);
        param_2 = *(int **)(uVar6 + 0x34);
        param_1 = *(uint *)(uVar6 + 0x30);
        if (puVar10 < *(undefined1 **)(uVar6 + 0x44)) {
          local_10 = *(undefined1 **)(uVar6 + 0x44) + (-1 - (int)puVar10);
        }
        else {
          local_10 = (undefined1 *)(*(int *)(uVar6 + 0x40) - (int)puVar10);
        }
        if (param_3 != 0) {
          *piVar3 = (-(uint)(param_3 != 1) & 2) + 7;
          break;
        }
      }
      piVar3[3] = (uint)*(byte *)(piVar3 + 4);
      piVar3[2] = piVar3[5];
      *piVar3 = 1;
    case 1:
      for (; param_1 < (uint)piVar3[3]; param_1 = param_1 + 8) {
        if (local_c == 0) goto LAB_67679ce1;
        param_3 = 0;
        local_c = local_c - 1;
        param_2 = (int *)((uint)param_2 | (uint)*local_8 << ((byte)param_1 & 0x1f));
        local_8 = local_8 + 1;
      }
      local_18 = (byte *)(piVar3[2] + (*(uint *)(&DAT_676c0444 + piVar3[3] * 4) & (uint)param_2) * 8
                         );
      param_1 = param_1 - local_18[1];
      param_2 = (int *)((uint)param_2 >> (local_18[1] & 0x1f));
      bVar2 = *local_18;
      uVar8 = (uint)bVar2;
      if (uVar8 == 0) {
        iVar5 = *(int *)(local_18 + 4);
        *piVar3 = 6;
        piVar3[2] = iVar5;
      }
      else if ((bVar2 & 0x20) == 0) {
        if ((bVar2 & 0xe0) == 0) {
LAB_67679af3:
          piVar3[3] = uVar8;
          piVar3[2] = (int)(local_18 + *(int *)(local_18 + 4) * 8);
        }
        else {
          if ((bVar2 & 0x40) == 0) {
            *piVar3 = 9;
            piVar7[6] = (int)s_invalid_literal_length_code_676c02c8;
switchD_676798c0_caseD_9:
            param_3 = -3;
            *(int **)(uVar6 + 0x34) = param_2;
            *(uint *)(uVar6 + 0x30) = param_1;
            piVar7[1] = local_c;
            iVar5 = *piVar7;
            *piVar7 = (int)local_8;
            piVar7[2] = (int)(local_8 + (piVar7[2] - iVar5));
            *(undefined1 **)(uVar6 + 0x48) = puVar10;
            goto LAB_67679dfa;
          }
          *piVar3 = 7;
        }
      }
      else {
        piVar3[2] = uVar8 & 0x1f;
        piVar3[1] = *(int *)(local_18 + 4);
        *piVar3 = 2;
      }
      break;
    case 2:
      for (; param_1 < (uint)piVar3[2]; param_1 = param_1 + 8) {
        if (local_c == 0) goto LAB_67679ce1;
        param_3 = 0;
        local_c = local_c - 1;
        param_2 = (int *)((uint)param_2 | (uint)*local_8 << ((byte)param_1 & 0x1f));
        local_8 = local_8 + 1;
      }
      uVar8 = *(uint *)(&DAT_676c0444 + piVar3[2] * 4) & (uint)param_2;
      *piVar3 = 3;
      param_2 = (int *)((uint)param_2 >> ((byte)piVar3[2] & 0x1f));
      piVar3[1] = piVar3[1] + uVar8;
      param_1 = param_1 - piVar3[2];
      piVar3[3] = (uint)*(byte *)((int)piVar3 + 0x11);
      piVar3[2] = piVar3[6];
    case 3:
      for (; param_1 < (uint)piVar3[3]; param_1 = param_1 + 8) {
        if (local_c == 0) goto LAB_67679ce1;
        param_3 = 0;
        local_c = local_c - 1;
        param_2 = (int *)((uint)param_2 | (uint)*local_8 << ((byte)param_1 & 0x1f));
        local_8 = local_8 + 1;
      }
      local_18 = (byte *)(piVar3[2] + (*(uint *)(&DAT_676c0444 + piVar3[3] * 4) & (uint)param_2) * 8
                         );
      param_1 = param_1 - local_18[1];
      param_2 = (int *)((uint)param_2 >> (local_18[1] & 0x1f));
      bVar2 = *local_18;
      uVar8 = (uint)bVar2;
      if ((bVar2 & 0x20) == 0) {
        if ((bVar2 & 0xe0) == 0) goto LAB_67679af3;
        *piVar3 = 9;
        piVar7[6] = (int)s_invalid_distance_code_676c02b0;
        goto switchD_676798c0_caseD_9;
      }
      piVar3[2] = uVar8 & 0x1f;
      piVar3[3] = *(int *)(local_18 + 4);
      *piVar3 = 4;
      break;
    case 4:
      for (; param_1 < (uint)piVar3[2]; param_1 = param_1 + 8) {
        if (local_c == 0) goto LAB_67679ce1;
        param_3 = 0;
        local_c = local_c - 1;
        param_2 = (int *)((uint)param_2 | (uint)*local_8 << ((byte)param_1 & 0x1f));
        local_8 = local_8 + 1;
      }
      uVar8 = *(uint *)(&DAT_676c0444 + piVar3[2] * 4) & (uint)param_2;
      *piVar3 = 5;
      param_2 = (int *)((uint)param_2 >> ((byte)piVar3[2] & 0x1f));
      piVar3[3] = piVar3[3] + uVar8;
      param_1 = param_1 - piVar3[2];
    case 5:
      local_14 = puVar10 + -piVar3[3];
      if (local_14 < *(undefined1 **)(uVar6 + 0x3c)) {
        do {
          local_14 = local_14 + (*(int *)(uVar6 + 0x40) - (int)*(undefined1 **)(uVar6 + 0x3c));
        } while (local_14 < *(undefined1 **)(uVar6 + 0x3c));
      }
      iVar5 = piVar3[1];
      while (iVar5 != 0) {
        puVar9 = puVar10;
        if (local_10 == (undefined1 *)0x0) {
          if (puVar10 == *(undefined1 **)(uVar6 + 0x40)) {
            local_10 = *(undefined1 **)(uVar6 + 0x44);
            puVar9 = *(undefined1 **)(uVar6 + 0x3c);
            if (local_10 != puVar9) {
              if (puVar9 < local_10) {
                local_10 = local_10 + (-1 - (int)puVar9);
              }
              else {
                local_10 = *(undefined1 **)(uVar6 + 0x40) + -(int)puVar9;
              }
              puVar10 = puVar9;
              if (local_10 != (undefined1 *)0x0) goto LAB_67679c12;
            }
          }
          *(undefined1 **)(uVar6 + 0x48) = puVar10;
          param_3 = FUN_6767aca0(uVar6,(int)piVar7,param_3);
          puVar9 = *(undefined1 **)(uVar6 + 0x48);
          puVar10 = *(undefined1 **)(uVar6 + 0x44);
          if (puVar9 < puVar10) {
            local_10 = puVar10 + (-1 - (int)puVar9);
          }
          else {
            local_10 = (undefined1 *)(*(int *)(uVar6 + 0x40) - (int)puVar9);
          }
          if ((puVar9 == *(undefined1 **)(uVar6 + 0x40)) &&
             (puVar4 = *(undefined1 **)(uVar6 + 0x3c), puVar10 != puVar4)) {
            puVar9 = puVar4;
            if (puVar4 < puVar10) {
              local_10 = puVar10 + (-1 - (int)puVar4);
            }
            else {
              local_10 = *(undefined1 **)(uVar6 + 0x40) + -(int)puVar4;
            }
          }
          if (local_10 == (undefined1 *)0x0) goto LAB_67679d37;
        }
LAB_67679c12:
        param_3 = 0;
        *puVar9 = *local_14;
        puVar10 = puVar9 + 1;
        local_14 = local_14 + 1;
        local_10 = local_10 + -1;
        if (local_14 == *(undefined1 **)(uVar6 + 0x40)) {
          local_14 = *(undefined1 **)(uVar6 + 0x3c);
        }
        piVar1 = piVar3 + 1;
        *piVar1 = *piVar1 + -1;
        iVar5 = *piVar1;
      }
LAB_67679c3c:
      *piVar3 = 0;
      break;
    case 6:
      puVar9 = puVar10;
      if (local_10 != (undefined1 *)0x0) {
LAB_67679cce:
        param_3 = 0;
        *puVar9 = (char)piVar3[2];
        puVar10 = puVar9 + 1;
        local_10 = local_10 + -1;
        goto LAB_67679c3c;
      }
      if (puVar10 == *(undefined1 **)(uVar6 + 0x40)) {
        local_10 = *(undefined1 **)(uVar6 + 0x44);
        puVar9 = *(undefined1 **)(uVar6 + 0x3c);
        if (local_10 != puVar9) {
          if (puVar9 < local_10) {
            local_10 = local_10 + (-1 - (int)puVar9);
          }
          else {
            local_10 = *(undefined1 **)(uVar6 + 0x40) + -(int)puVar9;
          }
          puVar10 = puVar9;
          if (local_10 != (undefined1 *)0x0) goto LAB_67679cce;
        }
      }
      *(undefined1 **)(uVar6 + 0x48) = puVar10;
      param_3 = FUN_6767aca0(uVar6,(int)piVar7,param_3);
      puVar9 = *(undefined1 **)(uVar6 + 0x48);
      puVar10 = *(undefined1 **)(uVar6 + 0x44);
      if (puVar9 < puVar10) {
        local_10 = puVar10 + (-1 - (int)puVar9);
      }
      else {
        local_10 = (undefined1 *)(*(int *)(uVar6 + 0x40) - (int)puVar9);
      }
      if ((puVar9 == *(undefined1 **)(uVar6 + 0x40)) &&
         (puVar4 = *(undefined1 **)(uVar6 + 0x3c), puVar10 != puVar4)) {
        puVar9 = puVar4;
        if (puVar4 < puVar10) {
          local_10 = puVar10 + (-1 - (int)puVar4);
        }
        else {
          local_10 = *(undefined1 **)(uVar6 + 0x40) + -(int)puVar4;
        }
      }
      if (local_10 != (undefined1 *)0x0) goto LAB_67679cce;
LAB_67679d37:
      *(int **)(uVar6 + 0x34) = param_2;
      *(uint *)(uVar6 + 0x30) = param_1;
      piVar7[1] = local_c;
      puVar10 = puVar9;
      goto LAB_67679d49;
    case 7:
      if (7 < param_1) {
        param_1 = param_1 - 8;
        local_c = local_c + 1;
        local_8 = local_8 + -1;
      }
      *(undefined1 **)(uVar6 + 0x48) = puVar10;
      param_3 = FUN_6767aca0(uVar6,(int)piVar7,param_3);
      puVar10 = *(undefined1 **)(uVar6 + 0x48);
      if (*(undefined1 **)(uVar6 + 0x44) == puVar10) {
        *piVar3 = 8;
switchD_676798c0_caseD_8:
        param_3 = 1;
        *(int **)(uVar6 + 0x34) = param_2;
        *(uint *)(uVar6 + 0x30) = param_1;
        piVar7[1] = local_c;
        iVar5 = *piVar7;
        *piVar7 = (int)local_8;
        piVar7[2] = (int)(local_8 + (piVar7[2] - iVar5));
        *(undefined1 **)(uVar6 + 0x48) = puVar10;
      }
      else {
        *(int **)(uVar6 + 0x34) = param_2;
        *(uint *)(uVar6 + 0x30) = param_1;
        piVar7[1] = local_c;
        iVar5 = *piVar7;
        *piVar7 = (int)local_8;
        piVar7[2] = (int)(local_8 + (piVar7[2] - iVar5));
        *(undefined1 **)(uVar6 + 0x48) = puVar10;
      }
LAB_67679dfa:
      FUN_6767aca0(uVar6,(int)piVar7,param_3);
      return;
    case 8:
      goto switchD_676798c0_caseD_8;
    case 9:
      goto switchD_676798c0_caseD_9;
    default:
      param_3 = -2;
      *(int **)(uVar6 + 0x34) = param_2;
      *(uint *)(uVar6 + 0x30) = param_1;
      piVar7[1] = local_c;
      iVar5 = *piVar7;
      *piVar7 = (int)local_8;
      piVar7[2] = (int)(local_8 + (piVar7[2] - iVar5));
      *(undefined1 **)(uVar6 + 0x48) = puVar10;
      goto LAB_67679dfa;
    }
  } while( true );
LAB_67679ce1:
  *(int **)(uVar6 + 0x34) = param_2;
  *(uint *)(uVar6 + 0x30) = param_1;
  piVar7[1] = 0;
LAB_67679d49:
  iVar5 = *piVar7;
  *piVar7 = (int)local_8;
  piVar7[2] = (int)(local_8 + (piVar7[2] - iVar5));
  *(undefined1 **)(uVar6 + 0x48) = puVar10;
  goto LAB_67679dfa;
}



// Function: FUN_67679e31 at 67679e31

void __cdecl FUN_67679e31(undefined4 param_1,int param_2)

{
  (**(code **)(param_2 + 0x24))(*(undefined4 *)(param_2 + 0x28),param_1);
  return;
}



// Function: FUN_67679e42 at 67679e42

int * __cdecl
FUN_67679e42(uint param_1,byte *param_2,int param_3,int param_4,int param_5,int *param_6)

{
  byte bVar1;
  uint uVar2;
  int *piVar3;
  byte *pbVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  byte *pbVar11;
  byte *local_14;
  byte *local_10;
  byte *local_c;
  uint local_8;
  
  piVar3 = param_6;
  pbVar11 = param_2;
  local_c = (byte *)*param_6;
  local_8 = param_6[1];
  local_14 = *(byte **)(param_5 + 0x48);
  uVar10 = *(uint *)(param_5 + 0x34);
  uVar8 = *(uint *)(param_5 + 0x30);
  if (local_14 < *(byte **)(param_5 + 0x44)) {
    local_10 = *(byte **)(param_5 + 0x44) + (-1 - (int)local_14);
  }
  else {
    local_10 = (byte *)(*(int *)(param_5 + 0x40) - (int)local_14);
  }
  uVar7 = *(uint *)(&DAT_676c0444 + param_1 * 4);
  param_2 = (byte *)0x102;
  uVar2 = *(uint *)(&DAT_676c0444 + (int)pbVar11 * 4);
  pbVar11 = local_14;
  if (*(int *)(param_6[7] + 0xc) == 9) {
    param_2 = (byte *)0xffff;
  }
  do {
    for (; uVar8 < 0x14; uVar8 = uVar8 + 8) {
      local_8 = local_8 - 1;
      uVar10 = uVar10 | (uint)*local_c << ((byte)uVar8 & 0x1f);
      local_c = local_c + 1;
    }
    pbVar4 = (byte *)(param_3 + (uVar7 & uVar10) * 8);
    bVar1 = *pbVar4;
LAB_67679edf:
    uVar9 = (uint)bVar1;
    if (uVar9 != 0) {
      uVar10 = uVar10 >> (pbVar4[1] & 0x1f);
      uVar8 = uVar8 - pbVar4[1];
      if ((bVar1 & 0x20) != 0) {
        uVar9 = uVar9 & 0x1f;
        uVar5 = (*(uint *)(&DAT_676c0444 + uVar9 * 4) & uVar10) + *(int *)(pbVar4 + 4);
        if (uVar5 == 0) goto LAB_6767a0ef;
        uVar10 = uVar10 >> (sbyte)uVar9;
        for (uVar8 = uVar8 - uVar9; uVar8 < 0xf; uVar8 = uVar8 + 8) {
          local_8 = local_8 - 1;
          uVar10 = uVar10 | (uint)*local_c << ((byte)uVar8 & 0x1f);
          local_c = local_c + 1;
        }
        pbVar11 = (byte *)(param_4 + (uVar2 & uVar10) * 8);
        uVar10 = uVar10 >> (pbVar11[1] & 0x1f);
        uVar8 = uVar8 - pbVar11[1];
        bVar1 = *pbVar11;
        while ((bVar1 & 0x20) == 0) {
          if ((bVar1 & 0xe0) != 0) {
            piVar3[6] = (int)s_invalid_distance_code_676c02b0;
            uVar7 = piVar3[1] - local_8;
            if (uVar8 >> 3 < piVar3[1] - local_8) {
              uVar7 = uVar8 >> 3;
            }
            param_6 = (int *)0xfffffffd;
            goto LAB_6767a10e;
          }
          iVar6 = (*(uint *)(&DAT_676c0444 + (uint)bVar1 * 4) & uVar10) + *(int *)(pbVar11 + 4);
          pbVar4 = pbVar11 + iVar6 * 8;
          pbVar11 = pbVar11 + iVar6 * 8;
          uVar10 = uVar10 >> (pbVar11[1] & 0x1f);
          uVar8 = uVar8 - pbVar11[1];
          bVar1 = *pbVar4;
        }
        uVar9 = bVar1 & 0x1f;
        param_1 = uVar10;
        for (; uVar8 < uVar9; uVar8 = uVar8 + 8) {
          local_8 = local_8 - 1;
          param_1 = param_1 | (uint)*local_c << ((byte)uVar8 & 0x1f);
          local_c = local_c + 1;
        }
        uVar8 = uVar8 - uVar9;
        local_10 = local_10 + -uVar5;
        uVar10 = param_1 >> (sbyte)uVar9;
        pbVar4 = local_14 +
                 -((*(uint *)(&DAT_676c0444 + uVar9 * 4) & param_1) + *(int *)(pbVar11 + 4));
        pbVar11 = *(byte **)(param_5 + 0x3c);
        if (pbVar4 < pbVar11) {
          do {
            pbVar4 = pbVar4 + (*(int *)(param_5 + 0x40) - (int)pbVar11);
          } while (pbVar4 < pbVar11);
          uVar9 = *(int *)(param_5 + 0x40) - (int)pbVar4;
          if (uVar9 < uVar5) {
            param_6 = (int *)(uVar5 - uVar9);
            do {
              *local_14 = *pbVar4;
              local_14 = local_14 + 1;
              pbVar4 = pbVar4 + 1;
              uVar9 = uVar9 - 1;
            } while (uVar9 != 0);
            pbVar11 = *(byte **)(param_5 + 0x3c);
            do {
              *local_14 = *pbVar11;
              local_14 = local_14 + 1;
              pbVar11 = pbVar11 + 1;
              param_6 = (int *)((int)param_6 + -1);
            } while (param_6 != (int *)0x0);
          }
          else {
            *local_14 = *pbVar4;
            local_14[1] = pbVar4[1];
            local_14 = local_14 + 2;
            pbVar4 = pbVar4 + 2;
            param_6 = (int *)(uVar5 - 2);
            do {
              *local_14 = *pbVar4;
              local_14 = local_14 + 1;
              pbVar4 = pbVar4 + 1;
              param_6 = (int *)((int)param_6 + -1);
            } while (param_6 != (int *)0x0);
          }
        }
        else {
          *local_14 = *pbVar4;
          local_14[1] = pbVar4[1];
          local_14 = local_14 + 2;
          pbVar4 = pbVar4 + 2;
          param_6 = (int *)(uVar5 - 2);
          do {
            *local_14 = *pbVar4;
            local_14 = local_14 + 1;
            pbVar4 = pbVar4 + 1;
            param_6 = (int *)((int)param_6 + -1);
          } while (param_6 != (int *)0x0);
        }
        goto LAB_6767a082;
      }
      if ((bVar1 & 0xe0) == 0) break;
      if ((bVar1 & 0x40) == 0) {
LAB_6767a0ef:
        piVar3[6] = (int)s_invalid_literal_length_code_676c02c8;
        uVar7 = piVar3[1] - local_8;
        if (uVar8 >> 3 < piVar3[1] - local_8) {
          uVar7 = uVar8 >> 3;
        }
        param_6 = (int *)0xfffffffd;
        local_14 = pbVar11;
      }
      else {
        uVar7 = piVar3[1] - local_8;
        if (uVar8 >> 3 < piVar3[1] - local_8) {
          uVar7 = uVar8 >> 3;
        }
        param_6 = (int *)0x1;
        local_14 = pbVar11;
      }
      goto LAB_6767a10e;
    }
    uVar10 = uVar10 >> (pbVar4[1] & 0x1f);
    uVar8 = uVar8 - pbVar4[1];
    *pbVar11 = pbVar4[4];
    local_14 = pbVar11 + 1;
    local_10 = local_10 + -1;
LAB_6767a082:
    if ((local_10 < param_2) || (pbVar11 = local_14, local_8 < 10)) {
      uVar7 = piVar3[1] - local_8;
      if (uVar8 >> 3 < piVar3[1] - local_8) {
        uVar7 = uVar8 >> 3;
      }
      param_6 = (int *)0x0;
LAB_6767a10e:
      *(uint *)(param_5 + 0x34) = uVar10;
      *(uint *)(param_5 + 0x30) = uVar8 + uVar7 * -8;
      piVar3[1] = uVar7 + local_8;
      iVar6 = *piVar3;
      *piVar3 = (int)local_c - uVar7;
      piVar3[2] = piVar3[2] + (((int)local_c - uVar7) - iVar6);
      *(byte **)(param_5 + 0x48) = local_14;
      return param_6;
    }
  } while( true );
  pbVar4 = pbVar4 + ((*(uint *)(&DAT_676c0444 + uVar9 * 4) & uVar10) + *(int *)(pbVar4 + 4)) * 8;
  bVar1 = *pbVar4;
  goto LAB_67679edf;
}



// Function: FUN_6767a140 at 6767a140

undefined4 __cdecl FUN_6767a140(int param_1)

{
  uint *puVar1;
  
  if ((param_1 != 0) && (puVar1 = *(uint **)(param_1 + 0x1c), puVar1 != (uint *)0x0)) {
    *(undefined4 *)(param_1 + 0x14) = 0;
    *(undefined4 *)(param_1 + 8) = 0;
    *(undefined4 *)(param_1 + 0x18) = 0;
    *puVar1 = -(uint)(puVar1[4] != 0) & 7;
    FUN_67678ed6(*(int **)(*(int *)(param_1 + 0x1c) + 0x18),param_1,(int *)0x0);
    return 0;
  }
  return 0xfffffffe;
}



// Function: FUN_6767a17f at 6767a17f

undefined4 __cdecl FUN_6767a17f(int param_1)

{
  int *piVar1;
  
  if (((param_1 != 0) && (*(int *)(param_1 + 0x1c) != 0)) && (*(int *)(param_1 + 0x24) != 0)) {
    piVar1 = *(int **)(*(int *)(param_1 + 0x1c) + 0x18);
    if (piVar1 != (int *)0x0) {
      FUN_676797f6(piVar1,param_1);
    }
    (**(code **)(param_1 + 0x24))(*(undefined4 *)(param_1 + 0x28),*(undefined4 *)(param_1 + 0x1c));
    *(undefined4 *)(param_1 + 0x1c) = 0;
    return 0;
  }
  return 0xfffffffe;
}



// Function: FUN_6767a1bd at 6767a1bd

undefined4 __cdecl FUN_6767a1bd(int param_1,int param_2,int param_3,char *param_4,int param_5)

{
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  
  if (((param_4 == (char *)0x0) || (*param_4 != s_1_1_3_676c0234[0])) || (param_5 != 0x38)) {
    uVar3 = 0xfffffffa;
  }
  else if (((param_2 == 8) || (param_2 == 9)) && (param_1 != 0)) {
    *(undefined4 *)(param_1 + 0x18) = 0;
    if (*(int *)(param_1 + 0x20) == 0) {
      *(code **)(param_1 + 0x20) = FUN_6767c7e8;
      *(undefined4 *)(param_1 + 0x28) = 0;
    }
    if (*(int *)(param_1 + 0x24) == 0) {
      *(undefined1 **)(param_1 + 0x24) = &LAB_6767c7f8;
    }
    iVar1 = (**(code **)(param_1 + 0x20))(*(undefined4 *)(param_1 + 0x28),1,0x1c);
    *(int *)(param_1 + 0x1c) = iVar1;
    if (iVar1 == 0) {
      uVar3 = 0xfffffffc;
    }
    else {
      *(undefined4 *)(iVar1 + 0x18) = 0;
      *(undefined4 *)(*(int *)(param_1 + 0x1c) + 0x10) = 0;
      if (param_3 < 0) {
        param_3 = -param_3;
        *(undefined4 *)(*(int *)(param_1 + 0x1c) + 0x10) = 1;
      }
      if ((param_3 < 8) || (0x10 < param_3)) {
        uVar3 = 0xfffffffe;
      }
      else {
        *(int *)(*(int *)(param_1 + 0x1c) + 0xc) = param_2;
        *(int *)(*(int *)(param_1 + 0x1c) + 0x14) = param_3;
        piVar2 = FUN_67678f44(param_1,~-(uint)(*(int *)(*(int *)(param_1 + 0x1c) + 0x10) != 0) &
                                      0x67677bad,1 << ((byte)param_3 & 0x1f));
        *(int **)(*(int *)(param_1 + 0x1c) + 0x18) = piVar2;
        if (*(int *)(*(int *)(param_1 + 0x1c) + 0x18) != 0) {
          FUN_6767a140(param_1);
          return 0;
        }
        uVar3 = 0xfffffffc;
      }
      FUN_6767a17f(param_1);
    }
  }
  else {
    uVar3 = 0xfffffffe;
  }
  return uVar3;
}



// Function: FUN_6767a2bc at 6767a2bc

void __cdecl FUN_6767a2bc(int param_1,int param_2,char *param_3,int param_4)

{
  FUN_6767a1bd(param_1,8,param_2,param_3,param_4);
  return;
}



// Function: FUN_6767a2d7 at 6767a2d7

uint __cdecl FUN_6767a2d7(int *param_1,uint param_2)

{
  byte bVar1;
  undefined4 *puVar2;
  bool bVar3;
  uint uVar4;
  
  if (((param_1 == (int *)0x0) || (param_1[7] == 0)) || (*param_1 == 0)) {
switchD_6767a31a_default:
    uVar4 = 0xfffffffe;
  }
  else {
    bVar3 = param_2 != 4;
    param_2 = 0xfffffffb;
    uVar4 = 0xfffffffb;
    if (bVar3) {
      param_2 = 0;
    }
LAB_6767a30d:
    puVar2 = (undefined4 *)param_1[7];
    switch(*puVar2) {
    case 0:
      if (param_1[1] == 0) {
        return uVar4;
      }
      param_1[2] = param_1[2] + 1;
      param_1[1] = param_1[1] + -1;
      uVar4 = (uint)*(byte *)*param_1;
      *param_1 = (int)((byte *)*param_1 + 1);
      puVar2[1] = uVar4;
      uVar4 = uVar4 & 0xf;
      if ((uVar4 == 8) || (uVar4 == 9)) {
        *(uint *)(param_1[7] + 0xc) = uVar4;
        puVar2 = (undefined4 *)param_1[7];
        if (((uint)puVar2[1] >> 4) + 8 <= (uint)puVar2[5]) {
          *puVar2 = 1;
          uVar4 = param_2;
          goto switchD_6767a31a_caseD_1;
        }
        *puVar2 = 0xd;
        param_1[6] = (int)s_invalid_window_size_676c0324;
      }
      else {
        *(undefined4 *)param_1[7] = 0xd;
        param_1[6] = (int)s_unknown_compression_method_676c0338;
      }
      goto LAB_6767a35a;
    case 1:
switchD_6767a31a_caseD_1:
      if (param_1[1] == 0) {
        return uVar4;
      }
      param_1[2] = param_1[2] + 1;
      param_1[1] = param_1[1] + -1;
      puVar2 = (undefined4 *)param_1[7];
      bVar1 = *(byte *)*param_1;
      *param_1 = (int)((byte *)*param_1 + 1);
      if ((puVar2[1] * 0x100 + (uint)bVar1) % 0x1f == 0) {
        if ((bVar1 & 0x20) != 0) {
          *(undefined4 *)param_1[7] = 2;
          uVar4 = param_2;
          goto switchD_6767a31a_caseD_2;
        }
        *puVar2 = 7;
        uVar4 = param_2;
      }
      else {
        *puVar2 = 0xd;
        param_1[6] = (int)s_incorrect_header_check_676c030c;
        *(undefined4 *)(param_1[7] + 4) = 5;
        uVar4 = param_2;
      }
      goto LAB_6767a30d;
    case 2:
switchD_6767a31a_caseD_2:
      if (param_1[1] != 0) {
        param_1[2] = param_1[2] + 1;
        param_1[1] = param_1[1] + -1;
        *(uint *)(param_1[7] + 8) = (uint)*(byte *)*param_1 << 0x18;
        *param_1 = *param_1 + 1;
        *(undefined4 *)param_1[7] = 3;
        uVar4 = param_2;
switchD_6767a31a_caseD_3:
        if (param_1[1] != 0) {
          param_1[2] = param_1[2] + 1;
          param_1[1] = param_1[1] + -1;
          *(int *)(param_1[7] + 8) = *(int *)(param_1[7] + 8) + (uint)*(byte *)*param_1 * 0x10000;
          *param_1 = *param_1 + 1;
          *(undefined4 *)param_1[7] = 4;
          uVar4 = param_2;
switchD_6767a31a_caseD_4:
          if (param_1[1] != 0) {
            param_1[2] = param_1[2] + 1;
            param_1[1] = param_1[1] + -1;
            *(int *)(param_1[7] + 8) = *(int *)(param_1[7] + 8) + (uint)*(byte *)*param_1 * 0x100;
            *param_1 = *param_1 + 1;
            *(undefined4 *)param_1[7] = 5;
            uVar4 = param_2;
switchD_6767a31a_caseD_5:
            if (param_1[1] != 0) {
              param_1[2] = param_1[2] + 1;
              param_1[1] = param_1[1] + -1;
              uVar4 = 2;
              *(int *)(param_1[7] + 8) = *(int *)(param_1[7] + 8) + (uint)*(byte *)*param_1;
              *param_1 = *param_1 + 1;
              param_1[0xc] = ((undefined4 *)param_1[7])[2];
              *(undefined4 *)param_1[7] = 6;
            }
          }
        }
      }
      break;
    case 3:
      goto switchD_6767a31a_caseD_3;
    case 4:
      goto switchD_6767a31a_caseD_4;
    case 5:
      goto switchD_6767a31a_caseD_5;
    case 6:
      *(undefined4 *)param_1[7] = 0xd;
      param_1[6] = (int)s_need_dictionary_676c02e4;
      *(undefined4 *)(param_1[7] + 4) = 0;
      goto switchD_6767a31a_default;
    case 7:
      uVar4 = FUN_67678fcf((uint *)puVar2[6],param_1,uVar4);
      if (uVar4 == 0xfffffffd) {
        *(undefined4 *)param_1[7] = 0xd;
        *(undefined4 *)(param_1[7] + 4) = 0;
        uVar4 = 0xfffffffd;
      }
      else {
        if (uVar4 == 0) {
          uVar4 = param_2;
        }
        if (uVar4 != 1) {
          return uVar4;
        }
        FUN_67678ed6(*(int **)(param_1[7] + 0x18),(int)param_1,(int *)(param_1[7] + 4));
        puVar2 = (undefined4 *)param_1[7];
        if (puVar2[4] == 0) {
          *puVar2 = 8;
          uVar4 = param_2;
          goto switchD_6767a31a_caseD_8;
        }
        *puVar2 = 0xc;
        uVar4 = param_2;
      }
      goto LAB_6767a30d;
    case 8:
switchD_6767a31a_caseD_8:
      if (param_1[1] == 0) {
        return uVar4;
      }
      param_1[2] = param_1[2] + 1;
      param_1[1] = param_1[1] + -1;
      *(uint *)(param_1[7] + 8) = (uint)*(byte *)*param_1 << 0x18;
      *param_1 = *param_1 + 1;
      *(undefined4 *)param_1[7] = 9;
      uVar4 = param_2;
    case 9:
      if (param_1[1] == 0) {
        return uVar4;
      }
      param_1[2] = param_1[2] + 1;
      param_1[1] = param_1[1] + -1;
      *(int *)(param_1[7] + 8) = *(int *)(param_1[7] + 8) + (uint)*(byte *)*param_1 * 0x10000;
      *param_1 = *param_1 + 1;
      *(undefined4 *)param_1[7] = 10;
      uVar4 = param_2;
switchD_6767a31a_caseD_a:
      if (param_1[1] == 0) {
        return uVar4;
      }
      param_1[2] = param_1[2] + 1;
      param_1[1] = param_1[1] + -1;
      *(int *)(param_1[7] + 8) = *(int *)(param_1[7] + 8) + (uint)*(byte *)*param_1 * 0x100;
      *param_1 = *param_1 + 1;
      *(undefined4 *)param_1[7] = 0xb;
      uVar4 = param_2;
switchD_6767a31a_caseD_b:
      if (param_1[1] == 0) {
        return uVar4;
      }
      param_1[2] = param_1[2] + 1;
      param_1[1] = param_1[1] + -1;
      *(int *)(param_1[7] + 8) = *(int *)(param_1[7] + 8) + (uint)*(byte *)*param_1;
      puVar2 = (undefined4 *)param_1[7];
      *param_1 = *param_1 + 1;
      if (puVar2[1] == puVar2[2]) {
        *(undefined4 *)param_1[7] = 0xc;
LAB_6767a5f8:
        return 1;
      }
      *puVar2 = 0xd;
      param_1[6] = (int)s_incorrect_data_check_676c02f4;
LAB_6767a35a:
      *(undefined4 *)(param_1[7] + 4) = 5;
      uVar4 = param_2;
      goto LAB_6767a30d;
    case 10:
      goto switchD_6767a31a_caseD_a;
    case 0xb:
      goto switchD_6767a31a_caseD_b;
    case 0xc:
      goto LAB_6767a5f8;
    case 0xd:
      return 0xfffffffd;
    default:
      goto switchD_6767a31a_default;
    }
  }
  return uVar4;
}



// Function: FUN_6767a646 at 6767a646

int __cdecl FUN_6767a646(int *param_1,uint *param_2,int *param_3,int param_4,int param_5)

{
  uint *puVar1;
  int iVar2;
  uint local_8;
  
  local_8 = 0;
  puVar1 = (uint *)(**(code **)(param_5 + 0x20))(*(undefined4 *)(param_5 + 0x28),0x13,4);
  if (puVar1 == (uint *)0x0) {
    iVar2 = -4;
  }
  else {
    iVar2 = FUN_6767a6c5(param_1,0x13,0x13,0,0,param_3,param_2,param_4,&local_8,puVar1);
    if (iVar2 == -3) {
      *(char **)(param_5 + 0x18) = s_oversubscribed_dynamic_bit_lengt_676c0378;
    }
    else if ((iVar2 == -5) || (*param_2 == 0)) {
      *(char **)(param_5 + 0x18) = s_incomplete_dynamic_bit_lengths_t_676c0354;
      iVar2 = -3;
    }
    (**(code **)(param_5 + 0x24))(*(undefined4 *)(param_5 + 0x28),puVar1);
  }
  return iVar2;
}



// Function: FUN_6767a6c5 at 6767a6c5

undefined4 __cdecl
FUN_6767a6c5(int *param_1,uint param_2,uint param_3,int param_4,int param_5,int *param_6,
            uint *param_7,int param_8,uint *param_9,uint *param_10)

{
  undefined4 uVar1;
  uint *puVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint *puVar6;
  uint *puVar7;
  int iVar8;
  int *piVar9;
  undefined4 *puVar10;
  byte bVar11;
  int iVar12;
  uint uVar13;
  uint *puVar14;
  uint uVar15;
  int local_f4 [15];
  uint local_b8 [16];
  uint local_78 [19];
  undefined4 local_2c;
  uint local_28;
  uint *local_24;
  int local_20;
  uint *local_1c;
  uint local_18;
  uint *local_14;
  uint local_10;
  int local_c;
  uint *local_8;
  
  puVar6 = param_7;
  local_78[0] = 0;
  local_78[1] = 0;
  local_78[2] = 0;
  local_78[3] = 0;
  local_78[4] = 0;
  local_78[5] = 0;
  local_78[6] = 0;
  local_78[7] = 0;
  local_78[8] = 0;
  local_78[9] = 0;
  local_78[10] = 0;
  local_78[0xb] = 0;
  local_78[0xc] = 0;
  local_78[0xd] = 0;
  local_78[0xe] = 0;
  local_78[0xf] = 0;
  piVar9 = param_1;
  uVar13 = param_2;
  do {
    iVar12 = *piVar9;
    piVar9 = piVar9 + 1;
    local_78[iVar12] = local_78[iVar12] + 1;
    uVar13 = uVar13 - 1;
  } while (uVar13 != 0);
  if (local_78[0] == param_2) {
    *param_6 = 0;
    *param_7 = 0;
  }
  else {
    puVar7 = (uint *)0x1;
    puVar14 = local_78;
    param_7 = (uint *)*param_7;
    do {
      puVar14 = puVar14 + 1;
      if (*puVar14 != 0) break;
      puVar7 = (uint *)((int)puVar7 + 1);
    } while (puVar7 < (uint *)0x10);
    local_8 = puVar7;
    if (param_7 < puVar7) {
      param_7 = puVar7;
    }
    puVar14 = local_78 + 0xf;
    puVar2 = (uint *)0xf;
    do {
      if (*puVar14 != 0) break;
      puVar2 = (uint *)((int)puVar2 - 1);
      puVar14 = puVar14 + -1;
    } while (puVar2 != (uint *)0x0);
    local_1c = puVar2;
    if (puVar2 < param_7) {
      param_7 = puVar2;
    }
    iVar12 = 1 << ((byte)puVar7 & 0x1f);
    *puVar6 = (uint)param_7;
    if (puVar7 < puVar2) {
      puVar6 = local_78 + (int)puVar7;
      do {
        uVar13 = *puVar6;
        if ((int)(iVar12 - uVar13) < 0) {
          return 0xfffffffd;
        }
        puVar7 = (uint *)((int)puVar7 + 1);
        puVar6 = puVar6 + 1;
        iVar12 = (iVar12 - uVar13) * 2;
      } while (puVar7 < puVar2);
    }
    local_78[0x11] = iVar12 - local_78[(int)puVar2];
    if ((int)local_78[0x11] < 0) {
      return 0xfffffffd;
    }
    local_b8[1] = 0;
    local_78[(int)puVar2] = local_78[(int)puVar2] + local_78[0x11];
    iVar8 = 0;
    iVar12 = (int)puVar2 - 1;
    if (iVar12 != 0) {
      iVar4 = 0;
      do {
        iVar8 = iVar8 + *(int *)((int)local_78 + iVar4 + 4);
        iVar12 = iVar12 + -1;
        *(int *)((int)local_b8 + iVar4 + 8) = iVar8;
        iVar4 = iVar4 + 4;
      } while (iVar12 != 0);
    }
    uVar13 = 0;
    do {
      iVar12 = *param_1;
      param_1 = param_1 + 1;
      if (iVar12 != 0) {
        uVar15 = local_b8[iVar12];
        param_10[uVar15] = uVar13;
        local_b8[iVar12] = uVar15 + 1;
      }
      uVar13 = uVar13 + 1;
    } while (uVar13 < param_2);
    uVar13 = local_b8[(int)puVar2];
    local_c = -1;
    local_10 = 0;
    local_14 = param_10;
    iVar12 = -(int)param_7;
    local_b8[0] = 0;
    local_f4[0] = 0;
    local_20 = 0;
    param_1 = (int *)0x0;
    if ((int)local_8 <= (int)local_1c) {
      local_78[0x12] = (int)local_8 - 1;
      local_24 = local_78 + (int)local_8;
      uVar15 = local_28;
      do {
        uVar3 = *local_24;
        local_18 = uVar3 - 1;
        uVar1 = local_2c;
        while (uVar3 != 0) {
          local_2c._2_2_ = (undefined2)((uint)uVar1 >> 0x10);
          local_78[0x10] = (int)param_7 + iVar12;
          if ((int)local_78[0x10] < (int)local_8) {
            do {
              local_2c = uVar1;
              iVar8 = local_c;
              local_c = local_c + 1;
              iVar12 = iVar12 + (int)param_7;
              local_78[0x10] = local_78[0x10] + (int)param_7;
              param_1 = (int *)((int)local_1c - iVar12);
              if (param_7 < param_1) {
                param_1 = (int *)param_7;
              }
              piVar9 = (int *)((int)local_8 - iVar12);
              uVar3 = 1 << ((byte)piVar9 & 0x1f);
              if ((local_18 + 1 < uVar3) &&
                 (iVar4 = uVar3 + (-1 - local_18), puVar6 = local_24, piVar9 < param_1)) {
                while (piVar9 = (int *)((int)piVar9 + 1), piVar9 < param_1) {
                  uVar3 = puVar6[1];
                  puVar6 = puVar6 + 1;
                  uVar5 = iVar4 * 2;
                  if (uVar5 < uVar3 || uVar5 - uVar3 == 0) break;
                  iVar4 = uVar5 - uVar3;
                }
              }
              param_1 = (int *)(1 << ((byte)piVar9 & 0x1f));
              uVar3 = *param_9 + (int)param_1;
              if (0x5a0 < uVar3) {
                return 0xfffffffd;
              }
              local_20 = param_8 + *param_9 * 8;
              local_f4[local_c] = local_20;
              uVar5 = local_10;
              iVar4 = local_20;
              *param_9 = uVar3;
              if (local_c == 0) {
                *param_6 = local_20;
              }
              else {
                local_b8[local_c] = local_10;
                local_2c._0_2_ = CONCAT11((char)param_7,(byte)piVar9);
                uVar5 = uVar5 >> ((char)iVar12 - (char)param_7 & 0x1fU);
                iVar8 = local_f4[iVar8];
                uVar15 = (iVar4 - iVar8 >> 3) - uVar5;
                *(undefined4 *)(iVar8 + uVar5 * 8) = local_2c;
                *(uint *)(iVar8 + 4 + uVar5 * 8) = uVar15;
              }
              uVar1 = local_2c;
            } while ((int)local_78[0x10] < (int)local_8);
          }
          uVar3 = local_18;
          bVar11 = (byte)iVar12;
          if (local_14 < param_10 + uVar13) {
            uVar15 = *local_14;
            if (uVar15 < param_3) {
              local_2c._0_1_ = (-(uVar15 < 0x100) & 0xc0U) + 0x40;
            }
            else {
              iVar8 = (uVar15 - param_3) * 4;
              local_2c._0_1_ = *(char *)(iVar8 + param_5) + ' ';
              uVar15 = *(uint *)(iVar8 + param_4);
            }
            local_14 = local_14 + 1;
          }
          else {
            local_2c._0_1_ = -0x80;
          }
          local_2c = CONCAT31(CONCAT21(local_2c._2_2_,(char)local_8 - bVar11),(char)local_2c);
          iVar8 = 1 << ((char)local_8 - bVar11 & 0x1f);
          piVar9 = (int *)(local_10 >> (bVar11 & 0x1f));
          if (piVar9 < param_1) {
            puVar10 = (undefined4 *)(local_20 + (int)piVar9 * 8);
            do {
              piVar9 = (int *)((int)piVar9 + iVar8);
              *puVar10 = local_2c;
              puVar10[1] = uVar15;
              puVar10 = puVar10 + iVar8 * 2;
            } while (piVar9 < param_1);
          }
          uVar5 = 1 << ((byte)local_78[0x12] & 0x1f);
          while ((local_10 & uVar5) != 0) {
            local_10 = local_10 ^ uVar5;
            uVar5 = uVar5 >> 1;
          }
          local_10 = local_10 ^ uVar5;
          for (puVar6 = local_b8 + local_c;
              ((1 << ((byte)iVar12 & 0x1f)) - 1U & local_10) != *puVar6; puVar6 = puVar6 + -1) {
            local_c = local_c + -1;
            iVar12 = iVar12 - (int)param_7;
          }
          local_18 = local_18 - 1;
          uVar1 = local_2c;
        }
        local_8 = (uint *)((int)local_8 + 1);
        local_24 = local_24 + 1;
        local_78[0x12] = local_78[0x12] + 1;
        local_2c = uVar1;
      } while ((int)local_8 <= (int)local_1c);
    }
    if ((local_78[0x11] != 0) && (local_1c != (uint *)0x1)) {
      return 0xfffffffb;
    }
  }
  return 0;
}



// Function: FUN_6767aa4c at 6767aa4c

int __cdecl
FUN_6767aa4c(int param_1,uint param_2,uint param_3,int *param_4,uint *param_5,uint *param_6,
            int *param_7,int *param_8,int param_9,int param_10)

{
  undefined *puVar1;
  int iVar2;
  undefined *puVar3;
  uint local_c;
  uint *local_8;
  
  local_c = 0;
  local_8 = (uint *)(**(code **)(param_10 + 0x20))(*(undefined4 *)(param_10 + 0x28),0x120,4);
  if (local_8 == (uint *)0x0) {
    return -4;
  }
  if (param_1 == 8) {
    puVar3 = &DAT_676b8a94;
    puVar1 = &DAT_676b8a18;
  }
  else {
    puVar3 = &DAT_676b8b8c;
    puVar1 = &DAT_676b8b10;
  }
  iVar2 = FUN_6767a6c5(param_4,param_2,0x101,(int)puVar1,(int)puVar3,param_7,param_5,param_9,
                       &local_c,local_8);
  if (iVar2 == 0) {
    if (*param_5 == 0) goto LAB_6767ab53;
    iVar2 = FUN_6767a6c5(param_4 + param_2,param_3,0,0x676b8c08,0x676b8c88,param_8,param_6,param_9,
                         &local_c,local_8);
    if (iVar2 == 0) {
      if ((*param_6 != 0) || (param_2 < 0x102)) {
        iVar2 = 0;
        goto LAB_6767ab62;
      }
LAB_6767ab31:
      *(char **)(param_10 + 0x18) = s_empty_distance_tree_with_lengths_676c03e4;
    }
    else {
      if (iVar2 == -3) {
        *(char **)(param_10 + 0x18) = s_oversubscribed_distance_tree_676c0424;
        goto LAB_6767ab62;
      }
      if (iVar2 != -5) {
        if (iVar2 == -4) goto LAB_6767ab62;
        goto LAB_6767ab31;
      }
      *(char **)(param_10 + 0x18) = s_incomplete_distance_tree_676c0408;
    }
  }
  else {
    if (iVar2 == -3) {
      *(char **)(param_10 + 0x18) = s_oversubscribed_literal_length_tr_676c03c0;
      goto LAB_6767ab62;
    }
    if (iVar2 == -4) goto LAB_6767ab62;
LAB_6767ab53:
    *(char **)(param_10 + 0x18) = s_incomplete_literal_length_tree_676c03a0;
  }
  iVar2 = -3;
LAB_6767ab62:
  (**(code **)(param_10 + 0x24))(*(undefined4 *)(param_10 + 0x28),local_8);
  return iVar2;
}



// Function: FUN_6767ab77 at 6767ab77

undefined4 __cdecl
FUN_6767ab77(int param_1,uint *param_2,uint *param_3,int *param_4,int *param_5,int param_6,
            int param_7)

{
  int *piVar1;
  uint *puVar2;
  int iVar3;
  undefined *puVar4;
  uint uVar5;
  undefined *puVar6;
  int *piVar7;
  uint local_c;
  uint local_8;
  
  local_c = 0;
  local_8 = 0x1e;
  piVar1 = (int *)(**(code **)(param_7 + 0x20))(*(undefined4 *)(param_7 + 0x28),0x120,4);
  if (piVar1 != (int *)0x0) {
    puVar2 = (uint *)(**(code **)(param_7 + 0x20))(*(undefined4 *)(param_7 + 0x28),0x120,4);
    if (puVar2 != (uint *)0x0) {
      piVar7 = piVar1;
      for (iVar3 = 0x90; iVar3 != 0; iVar3 = iVar3 + -1) {
        *piVar7 = 8;
        piVar7 = piVar7 + 1;
      }
      piVar7 = piVar1 + 0x90;
      for (iVar3 = 0x70; iVar3 != 0; iVar3 = iVar3 + -1) {
        *piVar7 = 9;
        piVar7 = piVar7 + 1;
      }
      piVar7 = piVar1 + 0x100;
      for (iVar3 = 0x18; iVar3 != 0; iVar3 = iVar3 + -1) {
        *piVar7 = 7;
        piVar7 = piVar7 + 1;
      }
      piVar7 = piVar1 + 0x118;
      for (iVar3 = 8; iVar3 != 0; iVar3 = iVar3 + -1) {
        *piVar7 = 8;
        piVar7 = piVar7 + 1;
      }
      *param_2 = 9;
      if (param_1 == 8) {
        puVar6 = &DAT_676b8a94;
        puVar4 = &DAT_676b8a18;
      }
      else {
        puVar6 = &DAT_676b8b8c;
        puVar4 = &DAT_676b8b10;
      }
      FUN_6767a6c5(piVar1,0x120,0x101,(int)puVar4,(int)puVar6,param_4,param_2,param_6,&local_c,
                   puVar2);
      if (param_1 == 9) {
        local_8 = 0x20;
      }
      uVar5 = local_8;
      piVar7 = piVar1;
      if (0 < (int)local_8) {
        for (; uVar5 != 0; uVar5 = uVar5 - 1) {
          *piVar7 = 5;
          piVar7 = piVar7 + 1;
        }
      }
      *param_3 = 5;
      FUN_6767a6c5(piVar1,local_8,0,0x676b8c08,0x676b8c88,param_5,param_3,param_6,&local_c,puVar2);
      (**(code **)(param_7 + 0x24))(*(undefined4 *)(param_7 + 0x28),puVar2);
      (**(code **)(param_7 + 0x24))(*(undefined4 *)(param_7 + 0x28),piVar1);
      return 0;
    }
    (**(code **)(param_7 + 0x24))(*(undefined4 *)(param_7 + 0x28),piVar1);
  }
  return 0xfffffffc;
}



// Function: FUN_6767aca0 at 6767aca0

int __cdecl FUN_6767aca0(int param_1,int param_2,int param_3)

{
  undefined4 *puVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  undefined4 *puVar6;
  uint uVar7;
  undefined4 local_8;
  
  iVar3 = param_2;
  puVar1 = *(undefined4 **)(param_1 + 0x44);
  puVar6 = *(undefined4 **)(param_1 + 0x48);
  local_8 = *(undefined4 **)(param_2 + 0xc);
  if (puVar6 < puVar1) {
    puVar6 = *(undefined4 **)(param_1 + 0x40);
  }
  uVar2 = *(uint *)(param_2 + 0x10);
  uVar7 = (int)puVar6 - (int)puVar1;
  if (uVar2 < (uint)((int)puVar6 - (int)puVar1)) {
    uVar7 = uVar2;
  }
  if ((uVar7 != 0) && (param_3 == -5)) {
    param_3 = 0;
  }
  *(int *)(param_2 + 0x14) = *(int *)(param_2 + 0x14) + uVar7;
  *(uint *)(param_2 + 0x10) = uVar2 - uVar7;
  if (*(code **)(param_1 + 0x4c) != (code *)0x0) {
    uVar5 = (**(code **)(param_1 + 0x4c))(*(undefined4 *)(param_1 + 0x50),puVar1,uVar7);
    *(undefined4 *)(param_1 + 0x50) = uVar5;
    *(undefined4 *)(param_2 + 0x30) = uVar5;
  }
  FUN_676b06d0(local_8,puVar1,uVar7);
  local_8 = (undefined4 *)((int)local_8 + uVar7);
  iVar4 = (int)puVar1 + uVar7;
  if ((int)puVar1 + uVar7 == *(int *)(param_1 + 0x40)) {
    puVar1 = *(undefined4 **)(param_1 + 0x3c);
    if (*(int *)(param_1 + 0x48) == *(int *)(param_1 + 0x40)) {
      *(undefined4 **)(param_1 + 0x48) = puVar1;
    }
    uVar2 = *(uint *)(param_2 + 0x10);
    uVar7 = *(int *)(param_1 + 0x48) - (int)puVar1;
    if (uVar2 < uVar7) {
      uVar7 = uVar2;
    }
    if ((uVar7 != 0) && (param_3 == -5)) {
      param_3 = 0;
    }
    *(int *)(param_2 + 0x14) = *(int *)(param_2 + 0x14) + uVar7;
    *(uint *)(param_2 + 0x10) = uVar2 - uVar7;
    if (*(code **)(param_1 + 0x4c) != (code *)0x0) {
      uVar5 = (**(code **)(param_1 + 0x4c))(*(undefined4 *)(param_1 + 0x50),puVar1,uVar7);
      *(undefined4 *)(param_1 + 0x50) = uVar5;
      *(undefined4 *)(param_2 + 0x30) = uVar5;
    }
    FUN_676b06d0(local_8,puVar1,uVar7);
    local_8 = (undefined4 *)((int)local_8 + uVar7);
    iVar4 = (int)puVar1 + uVar7;
  }
  param_2 = iVar4;
  *(undefined4 **)(iVar3 + 0xc) = local_8;
  *(int *)(param_1 + 0x44) = param_2;
  return param_3;
}



// Function: FUN_6767ad8c at 6767ad8c

void __cdecl FUN_6767ad8c(int param_1)

{
  FUN_6767ae06();
  *(int *)(param_1 + 0xb2c) = param_1 + 0x98;
  *(undefined4 *)(param_1 + 0xb34) = &PTR_DAT_676c0488;
  if (*(char *)(param_1 + 0x1d) == '\t') {
    *(undefined4 *)(param_1 + 0xb34) = &PTR_DAT_676c04a0;
  }
  *(undefined2 *)(param_1 + 0x16cc) = 0;
  *(undefined4 *)(param_1 + 0x16d0) = 0;
  *(int *)(param_1 + 0xb38) = param_1 + 0x98c;
  *(undefined ***)(param_1 + 0xb40) = &PTR_DAT_676c04b8;
  *(int *)(param_1 + 0xb44) = param_1 + 0xa90;
  *(undefined **)(param_1 + 0xb4c) = &DAT_676c04d0;
  *(undefined4 *)(param_1 + 0x16c8) = 8;
  FUN_6767ae07(param_1);
  return;
}



// Function: FUN_6767ae06 at 6767ae06

void FUN_6767ae06(void)

{
  return;
}



// Function: FUN_6767ae07 at 6767ae07

void __cdecl FUN_6767ae07(int param_1)

{
  undefined2 *puVar1;
  int iVar2;
  
  iVar2 = 0x11e;
  puVar1 = (undefined2 *)(param_1 + 0x98);
  do {
    *puVar1 = 0;
    puVar1 = puVar1 + 2;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  puVar1 = (undefined2 *)(param_1 + 0x98c);
  iVar2 = 0x20;
  do {
    *puVar1 = 0;
    puVar1 = puVar1 + 2;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  puVar1 = (undefined2 *)(param_1 + 0xa90);
  iVar2 = 0x13;
  do {
    *puVar1 = 0;
    puVar1 = puVar1 + 2;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  *(undefined4 *)(param_1 + 0x16c0) = 0;
  *(undefined4 *)(param_1 + 0x16bc) = 0;
  *(undefined4 *)(param_1 + 0x16c4) = 0;
  *(undefined4 *)(param_1 + 0x16b4) = 0;
  *(undefined2 *)(param_1 + 0x498) = 1;
  return;
}



// Function: FUN_6767ae69 at 6767ae69

void __cdecl FUN_6767ae69(int param_1,undefined1 *param_2,int param_3,int param_4)

{
  int iVar1;
  
  iVar1 = *(int *)(param_1 + 0x16d0);
  if (iVar1 < 0xe) {
    *(ushort *)(param_1 + 0x16cc) =
         *(ushort *)(param_1 + 0x16cc) | (ushort)(param_4 << ((byte)iVar1 & 0x1f));
    *(int *)(param_1 + 0x16d0) = iVar1 + 3;
  }
  else {
    *(ushort *)(param_1 + 0x16cc) =
         *(ushort *)(param_1 + 0x16cc) | (ushort)(param_4 << ((byte)iVar1 & 0x1f));
    *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
         *(undefined1 *)(param_1 + 0x16cc);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
         *(undefined1 *)(param_1 + 0x16cd);
    iVar1 = *(int *)(param_1 + 0x16d0);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(int *)(param_1 + 0x16d0) = iVar1 + -0xd;
    *(ushort *)(param_1 + 0x16cc) = (ushort)param_4 >> (0x10U - (char)iVar1 & 0x1f);
  }
  FUN_6767c5cd(param_1,param_2,param_3,1);
  return;
}



// Function: FUN_6767aefe at 6767aefe

void __cdecl FUN_6767aefe(int param_1)

{
  int iVar1;
  
  iVar1 = *(int *)(param_1 + 0x16d0);
  if (iVar1 < 0xe) {
    *(ushort *)(param_1 + 0x16cc) =
         *(ushort *)(param_1 + 0x16cc) | (ushort)(2 << ((byte)iVar1 & 0x1f));
    *(int *)(param_1 + 0x16d0) = iVar1 + 3;
  }
  else {
    *(ushort *)(param_1 + 0x16cc) =
         *(ushort *)(param_1 + 0x16cc) | (ushort)(2 << ((byte)iVar1 & 0x1f));
    *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
         *(undefined1 *)(param_1 + 0x16cc);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
         *(undefined1 *)(param_1 + 0x16cd);
    iVar1 = *(int *)(param_1 + 0x16d0);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(int *)(param_1 + 0x16d0) = iVar1 + -0xd;
    *(ushort *)(param_1 + 0x16cc) = 2 >> (0x10U - (char)iVar1 & 0x1f);
  }
  iVar1 = *(int *)(param_1 + 0x16d0);
  if (iVar1 < 10) {
    *(ushort *)(param_1 + 0x16cc) =
         *(ushort *)(param_1 + 0x16cc) | (ushort)(0x70000 << ((byte)iVar1 & 0x1f));
    *(int *)(param_1 + 0x16d0) = iVar1 + 7;
  }
  else {
    *(ushort *)(param_1 + 0x16cc) =
         *(ushort *)(param_1 + 0x16cc) | (ushort)(0 << ((byte)iVar1 & 0x1f));
    *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
         *(undefined1 *)(param_1 + 0x16cc);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
         *(undefined1 *)(param_1 + 0x16cd);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(ushort *)(param_1 + 0x16cc) = 0 >> (0x10U - (char)*(int *)(param_1 + 0x16d0) & 0x1f);
    *(int *)(param_1 + 0x16d0) = *(int *)(param_1 + 0x16d0) + -9;
  }
  FUN_6767c4f2(param_1);
  iVar1 = *(int *)(param_1 + 0x16d0);
  if ((*(int *)(param_1 + 0x16c8) - iVar1) + 0xb < 9) {
    if (iVar1 < 0xe) {
      *(ushort *)(param_1 + 0x16cc) =
           *(ushort *)(param_1 + 0x16cc) | (ushort)(2 << ((byte)iVar1 & 0x1f));
      *(int *)(param_1 + 0x16d0) = iVar1 + 3;
    }
    else {
      *(ushort *)(param_1 + 0x16cc) =
           *(ushort *)(param_1 + 0x16cc) | (ushort)(2 << ((byte)iVar1 & 0x1f));
      *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
           *(undefined1 *)(param_1 + 0x16cc);
      *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
      *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
           *(undefined1 *)(param_1 + 0x16cd);
      iVar1 = *(int *)(param_1 + 0x16d0);
      *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
      *(int *)(param_1 + 0x16d0) = iVar1 + -0xd;
      *(ushort *)(param_1 + 0x16cc) = 2 >> (0x10U - (char)iVar1 & 0x1f);
    }
    iVar1 = *(int *)(param_1 + 0x16d0);
    if (iVar1 < 10) {
      *(ushort *)(param_1 + 0x16cc) =
           *(ushort *)(param_1 + 0x16cc) | (ushort)(0x70000 << ((byte)iVar1 & 0x1f));
      *(int *)(param_1 + 0x16d0) = iVar1 + 7;
    }
    else {
      *(ushort *)(param_1 + 0x16cc) =
           *(ushort *)(param_1 + 0x16cc) | (ushort)(0 << ((byte)iVar1 & 0x1f));
      *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
           *(undefined1 *)(param_1 + 0x16cc);
      *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
      *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
           *(undefined1 *)(param_1 + 0x16cd);
      *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
      *(ushort *)(param_1 + 0x16cc) = 0 >> (0x10U - (char)*(int *)(param_1 + 0x16d0) & 0x1f);
      *(int *)(param_1 + 0x16d0) = *(int *)(param_1 + 0x16d0) + -9;
    }
    FUN_6767c4f2(param_1);
  }
  *(undefined4 *)(param_1 + 0x16c8) = 7;
  return;
}



// Function: FUN_6767b12d at 6767b12d

void __cdecl FUN_6767b12d(short *param_1,undefined1 *param_2,int param_3,int param_4)

{
  int iVar1;
  int iVar2;
  byte bVar3;
  uint uVar4;
  uint uVar5;
  
  iVar2 = 0;
  if (*(int *)(param_1 + 0x44) < 1) {
    uVar4 = param_3 + 5;
  }
  else {
    if ((char)param_1[0xe] == '\x02') {
      FUN_6767c47a((int)param_1);
    }
    FUN_6767b30c(param_1,(int *)(param_1 + 0x596));
    FUN_6767b30c(param_1,(int *)(param_1 + 0x59c));
    iVar2 = FUN_6767b808(param_1);
    uVar5 = *(int *)(param_1 + 0xb5e) + 10U >> 3;
    uVar4 = *(int *)(param_1 + 0xb60) + 10U >> 3;
    if (uVar5 < uVar4) goto LAB_6767b195;
  }
  uVar5 = uVar4;
LAB_6767b195:
  if ((uVar5 < param_3 + 4U) || (param_2 == (undefined1 *)0x0)) {
    iVar1 = *(int *)(param_1 + 0xb68);
    bVar3 = (byte)iVar1;
    if (uVar4 == uVar5) {
      if (iVar1 < 0xe) {
        param_1[0xb66] = param_1[0xb66] | (ushort)(param_4 + 2 << (bVar3 & 0x1f));
        *(int *)(param_1 + 0xb68) = iVar1 + 3;
      }
      else {
        param_1[0xb66] = param_1[0xb66] | (ushort)(param_4 + 2 << (bVar3 & 0x1f));
        *(char *)(*(int *)(param_1 + 4) + *(int *)(param_1 + 10)) = (char)param_1[0xb66];
        *(int *)(param_1 + 10) = *(int *)(param_1 + 10) + 1;
        *(undefined1 *)(*(int *)(param_1 + 4) + *(int *)(param_1 + 10)) =
             *(undefined1 *)((int)param_1 + 0x16cd);
        iVar2 = *(int *)(param_1 + 0xb68);
        *(int *)(param_1 + 10) = *(int *)(param_1 + 10) + 1;
        *(int *)(param_1 + 0xb68) = iVar2 + -0xd;
        param_1[0xb66] = (ushort)(param_4 + 2) >> (0x10U - (char)iVar2 & 0x1f);
      }
      FUN_6767c083((int)param_1,0x676b8ed0,0x676b9350);
    }
    else {
      if (iVar1 < 0xe) {
        param_1[0xb66] = param_1[0xb66] | (ushort)(param_4 + 4 << (bVar3 & 0x1f));
        *(int *)(param_1 + 0xb68) = iVar1 + 3;
      }
      else {
        param_1[0xb66] = param_1[0xb66] | (ushort)(param_4 + 4 << (bVar3 & 0x1f));
        *(char *)(*(int *)(param_1 + 4) + *(int *)(param_1 + 10)) = (char)param_1[0xb66];
        *(int *)(param_1 + 10) = *(int *)(param_1 + 10) + 1;
        *(undefined1 *)(*(int *)(param_1 + 4) + *(int *)(param_1 + 10)) =
             *(undefined1 *)((int)param_1 + 0x16cd);
        iVar1 = *(int *)(param_1 + 0xb68);
        *(int *)(param_1 + 10) = *(int *)(param_1 + 10) + 1;
        *(int *)(param_1 + 0xb68) = iVar1 + -0xd;
        param_1[0xb66] = (ushort)(param_4 + 4) >> (0x10U - (char)iVar1 & 0x1f);
      }
      FUN_6767b92c((int)param_1,*(int *)(param_1 + 0x598) + 1,*(int *)(param_1 + 0x59e) + 1,
                   iVar2 + 1);
      FUN_6767c083((int)param_1,(int)(param_1 + 0x4c),(int)(param_1 + 0x4c6));
    }
  }
  else {
    FUN_6767ae69((int)param_1,param_2,param_3,param_4);
  }
  FUN_6767ae07((int)param_1);
  if (param_4 != 0) {
    FUN_6767c569((int)param_1);
  }
  return;
}



// Function: FUN_6767b30c at 6767b30c

void __cdecl FUN_6767b30c(short *param_1,int *param_2)

{
  byte bVar1;
  byte bVar2;
  short *psVar3;
  short *psVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int local_c;
  int local_8;
  
  psVar4 = param_1;
  local_8 = -1;
  psVar3 = (short *)*param_2;
  iVar7 = *(int *)param_2[2];
  local_c = ((int *)param_2[2])[3];
  iVar5 = 0;
  param_1[0xa32] = 0;
  param_1[0xa33] = 0;
  param_1[0xa34] = 0x23d;
  param_1[0xa35] = 0;
  param_1 = psVar3;
  if (0 < local_c) {
    do {
      if (*param_1 == 0) {
        param_1[1] = 0;
      }
      else {
        *(int *)(psVar4 + 0xa32) = *(int *)(psVar4 + 0xa32) + 1;
        *(int *)(psVar4 + *(int *)(psVar4 + 0xa32) * 2 + 0x5b8) = iVar5;
        *(undefined1 *)(iVar5 + 0x146c + (int)psVar4) = 0;
        local_8 = iVar5;
      }
      iVar5 = iVar5 + 1;
      param_1 = param_1 + 2;
    } while (iVar5 < local_c);
  }
  iVar5 = *(int *)(psVar4 + 0xa32);
  while (iVar5 < 2) {
    if (local_8 < 2) {
      iVar6 = local_8 + 1;
      local_8 = iVar6;
    }
    else {
      iVar6 = 0;
    }
    *(int *)(psVar4 + 0xa32) = iVar5 + 1;
    *(int *)(psVar4 + (iVar5 + 1) * 2 + 0x5b8) = iVar6;
    psVar3[iVar6 * 2] = 1;
    *(undefined1 *)((int)psVar4 + iVar6 + 0x146c) = 0;
    *(int *)(psVar4 + 0xb5e) = *(int *)(psVar4 + 0xb5e) + -1;
    if (iVar7 != 0) {
      *(uint *)(psVar4 + 0xb60) =
           *(int *)(psVar4 + 0xb60) - (uint)*(ushort *)(iVar6 * 4 + 2 + iVar7);
    }
    iVar5 = *(int *)(psVar4 + 0xa32);
  }
  param_2[1] = local_8;
  for (iVar7 = *(int *)(psVar4 + 0xa32) / 2; 0 < iVar7; iVar7 = iVar7 + -1) {
    FUN_6767b522((int)psVar4,(int)psVar3,iVar7);
  }
  param_1 = psVar3 + local_c * 2;
  do {
    iVar7 = *(int *)(psVar4 + 0x5ba);
    *(undefined4 *)(psVar4 + 0x5ba) = *(undefined4 *)(psVar4 + *(int *)(psVar4 + 0xa32) * 2 + 0x5b8)
    ;
    *(int *)(psVar4 + 0xa32) = *(int *)(psVar4 + 0xa32) + -1;
    FUN_6767b522((int)psVar4,(int)psVar3,1);
    iVar5 = *(int *)(psVar4 + 0x5ba);
    *(int *)(psVar4 + 0xa34) = *(int *)(psVar4 + 0xa34) + -1;
    *(int *)(psVar4 + *(int *)(psVar4 + 0xa34) * 2 + 0x5b8) = iVar7;
    *(int *)(psVar4 + 0xa34) = *(int *)(psVar4 + 0xa34) + -1;
    *(int *)(psVar4 + *(int *)(psVar4 + 0xa34) * 2 + 0x5b8) = iVar5;
    *param_1 = psVar3[iVar5 * 2] + psVar3[iVar7 * 2];
    bVar1 = *(byte *)((int)psVar4 + iVar7 + 0x146c);
    bVar2 = *(byte *)((int)psVar4 + iVar5 + 0x146c);
    if (bVar2 <= bVar1) {
      bVar2 = bVar1;
    }
    param_1 = param_1 + 2;
    *(byte *)((int)psVar4 + local_c + 0x146c) = bVar2 + 1;
    (psVar3 + iVar5 * 2)[1] = (short)local_c;
    (psVar3 + iVar7 * 2)[1] = (short)local_c;
    *(int *)(psVar4 + 0x5ba) = local_c;
    local_c = local_c + 1;
    FUN_6767b522((int)psVar4,(int)psVar3,1);
  } while (1 < *(int *)(psVar4 + 0xa32));
  *(int *)(psVar4 + 0xa34) = *(int *)(psVar4 + 0xa34) + -1;
  *(undefined4 *)(psVar4 + *(int *)(psVar4 + 0xa34) * 2 + 0x5b8) = *(undefined4 *)(psVar4 + 0x5ba);
  FUN_6767b5d5((uint)psVar4,param_2);
  FUN_6767b7a0(psVar3,local_8,(int)(psVar4 + 0x5a8));
  return;
}



// Function: FUN_6767b522 at 6767b522

void __cdecl FUN_6767b522(int param_1,int param_2,int param_3)

{
  ushort uVar1;
  ushort uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  bool bVar8;
  
  iVar3 = *(int *)(param_1 + 0xb70 + param_3 * 4);
  iVar7 = param_3 * 2;
  iVar6 = *(int *)(param_1 + 0x1464);
  bVar8 = SBORROW4(iVar7,iVar6);
  iVar5 = iVar7 - iVar6;
  if (iVar7 <= iVar6) {
    do {
      iVar6 = iVar7;
      if (bVar8 != iVar5 < 0) {
        iVar5 = *(int *)(param_1 + 0xb74 + iVar7 * 4);
        uVar1 = *(ushort *)(param_2 + iVar5 * 4);
        uVar2 = *(ushort *)(param_2 + *(int *)(param_1 + 0xb70 + iVar7 * 4) * 4);
        if ((uVar1 < uVar2) ||
           ((uVar1 == uVar2 &&
            (*(byte *)(iVar5 + 0x146c + param_1) <=
             *(byte *)(*(int *)(param_1 + 0xb70 + iVar7 * 4) + 0x146c + param_1))))) {
          iVar6 = iVar7 + 1;
        }
      }
      iVar5 = *(int *)(param_1 + 0xb70 + iVar6 * 4);
      uVar1 = *(ushort *)(param_2 + iVar3 * 4);
      uVar2 = *(ushort *)(param_2 + iVar5 * 4);
      if ((uVar1 < uVar2) ||
         ((uVar1 == uVar2 &&
          (*(byte *)(iVar3 + 0x146c + param_1) <= *(byte *)(iVar5 + 0x146c + param_1))))) break;
      iVar7 = iVar6 * 2;
      *(int *)(param_1 + 0xb70 + param_3 * 4) = iVar5;
      iVar4 = *(int *)(param_1 + 0x1464);
      bVar8 = SBORROW4(iVar7,iVar4);
      iVar5 = iVar7 - iVar4;
      param_3 = iVar6;
    } while (iVar5 == 0 || iVar7 < iVar4);
  }
  *(int *)(param_1 + 0xb70 + param_3 * 4) = iVar3;
  return;
}



// Function: FUN_6767b5d5 at 6767b5d5

void __cdecl FUN_6767b5d5(uint param_1,int *param_2)

{
  ushort *puVar1;
  ushort uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  int iVar9;
  int iVar10;
  int *piVar11;
  int iVar12;
  ushort *puVar13;
  int *piVar14;
  undefined4 *puVar15;
  short *psVar16;
  int local_18;
  int *local_c;
  int local_8;
  
  uVar8 = param_1;
  iVar3 = *param_2;
  iVar4 = param_2[1];
  piVar14 = (int *)param_2[2];
  iVar12 = *piVar14;
  iVar5 = piVar14[1];
  iVar6 = piVar14[2];
  piVar14 = (int *)piVar14[4];
  param_2 = (int *)0x0;
  puVar15 = (undefined4 *)(param_1 + 0xb50);
  for (iVar9 = 8; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar15 = 0;
    puVar15 = puVar15 + 1;
  }
  *(undefined2 *)(iVar3 + 2 + *(int *)(param_1 + 0xb70 + *(int *)(param_1 + 0x1468) * 4) * 4) = 0;
  iVar9 = *(int *)(param_1 + 0x1468) + 1;
  if (iVar9 < 0x23d) {
    local_c = (int *)(param_1 + 0xb70 + iVar9 * 4);
    local_18 = 0x23d - iVar9;
    iVar9 = iVar9 + local_18;
    do {
      iVar7 = *local_c;
      iVar10 = iVar7 * 4;
      piVar11 = (int *)(*(ushort *)(iVar3 + 2 + (uint)*(ushort *)(iVar10 + 2 + iVar3) * 4) + 1);
      if ((int)piVar14 < (int)piVar11) {
        param_2 = (int *)((int)param_2 + 1);
        piVar11 = piVar14;
      }
      *(short *)(iVar10 + 2 + iVar3) = (short)piVar11;
      if (iVar7 <= iVar4) {
        psVar16 = (short *)(param_1 + 0xb50 + (int)piVar11 * 2);
        *psVar16 = *psVar16 + 1;
        local_8 = 0;
        if (iVar6 <= iVar7) {
          local_8 = *(int *)(iVar5 + (iVar7 - iVar6) * 4);
        }
        uVar2 = *(ushort *)(iVar10 + iVar3);
        *(int *)(param_1 + 0x16bc) =
             *(int *)(param_1 + 0x16bc) + (local_8 + (int)piVar11) * (uint)uVar2;
        if (iVar12 != 0) {
          *(int *)(param_1 + 0x16c0) =
               *(int *)(param_1 + 0x16c0) +
               ((uint)*(ushort *)(iVar10 + 2 + iVar12) + local_8) * (uint)uVar2;
        }
      }
      local_c = local_c + 1;
      local_18 = local_18 + -1;
    } while (local_18 != 0);
    if (param_2 != (int *)0x0) {
      do {
        iVar12 = (int)piVar14 + -1;
        for (psVar16 = (short *)(param_1 + 0xb50 + iVar12 * 2); *psVar16 == 0;
            psVar16 = psVar16 + -1) {
          iVar12 = iVar12 + -1;
        }
        psVar16 = (short *)(param_1 + 0xb50 + iVar12 * 2);
        *psVar16 = *psVar16 + -1;
        psVar16 = (short *)(param_1 + 0xb52 + iVar12 * 2);
        *psVar16 = *psVar16 + 2;
        param_2 = (int *)((int)param_2 + -2);
        psVar16 = (short *)(param_1 + 0xb50 + (int)piVar14 * 2);
        *psVar16 = *psVar16 + -1;
      } while (0 < (int)param_2);
      if (piVar14 != (int *)0x0) {
        puVar13 = (ushort *)(param_1 + 0xb50 + (int)piVar14 * 2);
        param_2 = piVar14;
        do {
          param_1 = (uint)*puVar13;
          if (param_1 != 0) {
            iVar12 = uVar8 + 0xb70 + iVar9 * 4;
            do {
              iVar5 = *(int *)(iVar12 + -4);
              iVar12 = iVar12 + -4;
              iVar9 = iVar9 + -1;
              if (iVar5 <= iVar4) {
                piVar14 = (int *)(uint)*(ushort *)(iVar3 + 2 + iVar5 * 4);
                puVar1 = (ushort *)(iVar3 + iVar5 * 4);
                if (piVar14 != param_2) {
                  piVar11 = (int *)(uVar8 + 0x16bc);
                  *piVar11 = *piVar11 + ((int)param_2 - (int)piVar14) * (uint)*puVar1;
                  puVar1[1] = (ushort)param_2;
                }
                param_1 = param_1 - 1;
              }
            } while (param_1 != 0);
          }
          param_2 = (int *)((int)param_2 + -1);
          puVar13 = puVar13 + -1;
        } while (param_2 != (int *)0x0);
      }
    }
  }
  return;
}



// Function: FUN_6767b7a0 at 6767b7a0

/* WARNING: Type propagation algorithm not settling */

void __cdecl FUN_6767b7a0(undefined2 *param_1,int param_2,int param_3)

{
  ushort *puVar1;
  ushort uVar2;
  uint uVar3;
  int iVar4;
  ushort auStack_24 [16];
  
  uVar2 = 0;
  puVar1 = auStack_24;
  iVar4 = 0xf;
  do {
    puVar1 = (ushort *)((int)puVar1 + 2);
    uVar2 = (*(short *)((param_3 - (int)(auStack_24 + 1)) + (int)puVar1) + uVar2) * 2;
    *puVar1 = uVar2;
    iVar4 = iVar4 + -1;
  } while (iVar4 != 0);
  if (-1 < param_2) {
    iVar4 = param_2 + 1;
    do {
      uVar3 = (uint)(ushort)param_1[1];
      if (uVar3 != 0) {
        uVar2 = auStack_24[uVar3];
        auStack_24[uVar3] = uVar2 + 1;
        uVar3 = FUN_6767c4d3((uint)uVar2,uVar3);
        *param_1 = (short)uVar3;
      }
      param_1 = param_1 + 2;
      iVar4 = iVar4 + -1;
    } while (iVar4 != 0);
  }
  return;
}



// Function: FUN_6767b808 at 6767b808

void __cdecl FUN_6767b808(short *param_1)

{
  int iVar1;
  
  FUN_6767b86a((int)param_1,(ushort *)(param_1 + 0x4c),*(int *)(param_1 + 0x598));
  FUN_6767b86a((int)param_1,(ushort *)(param_1 + 0x4c6),*(int *)(param_1 + 0x59e));
  FUN_6767b30c(param_1,(int *)(param_1 + 0x5a2));
  iVar1 = 0x12;
  do {
    if (param_1[(uint)(byte)(&DAT_676b8ebc)[iVar1] * 2 + 0x549] != 0) break;
    iVar1 = iVar1 + -1;
  } while (2 < iVar1);
  *(int *)(param_1 + 0xb5e) = *(int *)(param_1 + 0xb5e) + iVar1 * 3 + 0x11;
  return;
}



// Function: FUN_6767b86a at 6767b86a

void __cdecl FUN_6767b86a(int param_1,ushort *param_2,int param_3)

{
  short *psVar1;
  ushort uVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  int iStack_18;
  uint local_8;
  
  local_8 = 0xffffffff;
  uVar2 = param_2[1];
  iVar6 = 7;
  iVar5 = 0;
  iStack_18 = 4;
  if (uVar2 == 0) {
    iVar6 = 0x8a;
    iStack_18 = 3;
  }
  param_2[param_3 * 2 + 3] = 0xffff;
  if (-1 < param_3) {
    param_2 = param_2 + 3;
    param_3 = param_3 + 1;
    uVar3 = (uint)uVar2;
    do {
      iVar5 = iVar5 + 1;
      uVar4 = (uint)*param_2;
      if ((iVar6 <= iVar5) || (uVar3 != uVar4)) {
        if (iVar5 < iStack_18) {
          psVar1 = (short *)(param_1 + 0xa90 + uVar3 * 4);
          *psVar1 = *psVar1 + (short)iVar5;
        }
        else if (uVar3 == 0) {
          if (iVar5 < 0xb) {
            *(short *)(param_1 + 0xad4) = *(short *)(param_1 + 0xad4) + 1;
          }
          else {
            *(short *)(param_1 + 0xad8) = *(short *)(param_1 + 0xad8) + 1;
          }
        }
        else {
          if (uVar3 != local_8) {
            psVar1 = (short *)(param_1 + 0xa90 + uVar3 * 4);
            *psVar1 = *psVar1 + 1;
          }
          *(short *)(param_1 + 0xad0) = *(short *)(param_1 + 0xad0) + 1;
        }
        iVar5 = 0;
        local_8 = uVar3;
        if (uVar4 == 0) {
          iVar6 = 0x8a;
        }
        else {
          if (uVar3 != uVar4) {
            iVar6 = 7;
            iStack_18 = 4;
            goto LAB_6767b91e;
          }
          iVar6 = 6;
        }
        iStack_18 = 3;
      }
LAB_6767b91e:
      param_2 = param_2 + 2;
      param_3 = param_3 + -1;
      uVar3 = uVar4;
    } while (param_3 != 0);
  }
  return;
}



// Function: FUN_6767b92c at 6767b92c

void __cdecl FUN_6767b92c(int param_1,int param_2,int param_3,int param_4)

{
  ushort uVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = *(int *)(param_1 + 0x16d0);
  if (iVar3 < 0xc) {
    *(ushort *)(param_1 + 0x16cc) =
         *(ushort *)(param_1 + 0x16cc) | (ushort)(param_2 + -0x101 << ((byte)iVar3 & 0x1f));
    *(int *)(param_1 + 0x16d0) = iVar3 + 5;
  }
  else {
    *(ushort *)(param_1 + 0x16cc) =
         *(ushort *)(param_1 + 0x16cc) | (ushort)(param_2 + -0x101 << ((byte)iVar3 & 0x1f));
    *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
         *(undefined1 *)(param_1 + 0x16cc);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
         *(undefined1 *)(param_1 + 0x16cd);
    iVar3 = *(int *)(param_1 + 0x16d0);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(int *)(param_1 + 0x16d0) = iVar3 + -0xb;
    *(ushort *)(param_1 + 0x16cc) = (ushort)(param_2 + -0x101) >> (0x10U - (char)iVar3 & 0x1f);
  }
  iVar3 = *(int *)(param_1 + 0x16d0);
  if (iVar3 < 0xc) {
    *(ushort *)(param_1 + 0x16cc) =
         *(ushort *)(param_1 + 0x16cc) | (ushort)(param_3 + -1 << ((byte)iVar3 & 0x1f));
    *(int *)(param_1 + 0x16d0) = iVar3 + 5;
  }
  else {
    *(ushort *)(param_1 + 0x16cc) =
         *(ushort *)(param_1 + 0x16cc) | (ushort)(param_3 + -1 << ((byte)iVar3 & 0x1f));
    *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
         *(undefined1 *)(param_1 + 0x16cc);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
         *(undefined1 *)(param_1 + 0x16cd);
    iVar3 = *(int *)(param_1 + 0x16d0);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(int *)(param_1 + 0x16d0) = iVar3 + -0xb;
    *(ushort *)(param_1 + 0x16cc) = (ushort)(param_3 + -1) >> (0x10U - (char)iVar3 & 0x1f);
  }
  iVar2 = *(int *)(param_1 + 0x16d0);
  iVar3 = param_4 + -4;
  if (iVar2 < 0xd) {
    *(ushort *)(param_1 + 0x16cc) =
         *(ushort *)(param_1 + 0x16cc) | (ushort)(iVar3 << ((byte)iVar2 & 0x1f));
    *(int *)(param_1 + 0x16d0) = iVar2 + 4;
  }
  else {
    *(ushort *)(param_1 + 0x16cc) =
         *(ushort *)(param_1 + 0x16cc) | (ushort)(iVar3 << ((byte)iVar2 & 0x1f));
    *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
         *(undefined1 *)(param_1 + 0x16cc);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
         *(undefined1 *)(param_1 + 0x16cd);
    iVar2 = *(int *)(param_1 + 0x16d0);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(int *)(param_1 + 0x16d0) = iVar2 + -0xc;
    *(ushort *)(param_1 + 0x16cc) = (ushort)iVar3 >> (0x10U - (char)iVar2 & 0x1f);
  }
  iVar3 = 0;
  if (0 < param_4) {
    do {
      iVar2 = *(int *)(param_1 + 0x16d0);
      if (iVar2 < 0xe) {
        *(ushort *)(param_1 + 0x16cc) =
             *(ushort *)(param_1 + 0x16cc) |
             *(short *)(param_1 + 0xa92 + (uint)(byte)(&DAT_676b8ebc)[iVar3] * 4) <<
             ((byte)iVar2 & 0x1f);
        *(int *)(param_1 + 0x16d0) = iVar2 + 3;
      }
      else {
        uVar1 = *(ushort *)(param_1 + 0xa92 + (uint)(byte)(&DAT_676b8ebc)[iVar3] * 4);
        *(ushort *)(param_1 + 0x16cc) =
             *(ushort *)(param_1 + 0x16cc) | uVar1 << ((byte)iVar2 & 0x1f);
        *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
             *(undefined1 *)(param_1 + 0x16cc);
        *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
        *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
             *(undefined1 *)(param_1 + 0x16cd);
        iVar2 = *(int *)(param_1 + 0x16d0);
        *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
        *(int *)(param_1 + 0x16d0) = iVar2 + -0xd;
        *(ushort *)(param_1 + 0x16cc) = uVar1 >> (0x10U - (char)iVar2 & 0x1f);
      }
      iVar3 = iVar3 + 1;
    } while (iVar3 < param_4);
  }
  FUN_6767bb65(param_1,param_1 + 0x98,param_2 + -1);
  FUN_6767bb65(param_1,param_1 + 0x98c,param_3 + -1);
  return;
}



// Function: FUN_6767bb65 at 6767bb65

void __cdecl FUN_6767bb65(int param_1,int param_2,int param_3)

{
  ushort uVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  int iStack_20;
  int local_10;
  uint local_c;
  ushort *local_8;
  
  local_c = 0xffffffff;
  iVar3 = 7;
  iStack_20 = 4;
  if (*(ushort *)(param_2 + 2) == 0) {
    iVar3 = 0x8a;
    iStack_20 = 3;
  }
  if (-1 < param_3) {
    local_8 = (ushort *)(param_2 + 6);
    local_10 = param_3 + 1;
    iVar4 = 0;
    uVar6 = (uint)*(ushort *)(param_2 + 2);
    do {
      iVar5 = iVar4 + 1;
      uVar7 = (uint)*local_8;
      if ((iVar3 <= iVar5) || (uVar6 != uVar7)) {
        if (iVar5 < iStack_20) {
          do {
            uVar8 = (uint)*(ushort *)(param_1 + 0xa92 + uVar6 * 4);
            bVar2 = (byte)*(int *)(param_1 + 0x16d0);
            if ((int)(0x10 - uVar8) < *(int *)(param_1 + 0x16d0)) {
              uVar1 = *(ushort *)(param_1 + 0xa90 + uVar6 * 4);
              *(ushort *)(param_1 + 0x16cc) =
                   *(ushort *)(param_1 + 0x16cc) | uVar1 << (bVar2 & 0x1f);
              *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
                   *(undefined1 *)(param_1 + 0x16cc);
              *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
              *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
                   *(undefined1 *)(param_1 + 0x16cd);
              iVar3 = *(int *)(param_1 + 0x16d0);
              *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
              *(uint *)(param_1 + 0x16d0) = iVar3 + -0x10 + uVar8;
              *(ushort *)(param_1 + 0x16cc) = uVar1 >> (0x10U - (char)iVar3 & 0x1f);
            }
            else {
              *(ushort *)(param_1 + 0x16cc) =
                   *(ushort *)(param_1 + 0x16cc) |
                   *(short *)(param_1 + 0xa90 + uVar6 * 4) << (bVar2 & 0x1f);
              *(uint *)(param_1 + 0x16d0) = *(int *)(param_1 + 0x16d0) + uVar8;
            }
            iVar5 = iVar5 + -1;
          } while (iVar5 != 0);
        }
        else {
          if (uVar6 == 0) {
            if (iVar5 < 0xb) {
              uVar8 = (uint)*(ushort *)(param_1 + 0xad6);
              iVar3 = *(int *)(param_1 + 0x16d0);
              if ((int)(0x10 - uVar8) < iVar3) {
                uVar1 = *(ushort *)(param_1 + 0xad4);
                *(ushort *)(param_1 + 0x16cc) =
                     *(ushort *)(param_1 + 0x16cc) | uVar1 << ((byte)iVar3 & 0x1f);
                *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
                     *(undefined1 *)(param_1 + 0x16cc);
                *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
                *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
                     *(undefined1 *)(param_1 + 0x16cd);
                *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
                *(ushort *)(param_1 + 0x16cc) =
                     uVar1 >> (0x10U - (char)*(int *)(param_1 + 0x16d0) & 0x1f);
                *(uint *)(param_1 + 0x16d0) = *(int *)(param_1 + 0x16d0) + -0x10 + uVar8;
              }
              else {
                *(ushort *)(param_1 + 0x16cc) =
                     *(ushort *)(param_1 + 0x16cc) |
                     *(short *)(param_1 + 0xad4) << ((byte)iVar3 & 0x1f);
                *(uint *)(param_1 + 0x16d0) = iVar3 + uVar8;
              }
              iVar3 = *(int *)(param_1 + 0x16d0);
              if (iVar3 < 0xe) {
                *(ushort *)(param_1 + 0x16cc) =
                     *(ushort *)(param_1 + 0x16cc) | (ushort)(iVar4 + -2 << ((byte)iVar3 & 0x1f));
                iVar3 = iVar3 + 3;
LAB_6767c048:
                *(int *)(param_1 + 0x16d0) = iVar3;
                goto LAB_6767c04e;
              }
              *(ushort *)(param_1 + 0x16cc) =
                   *(ushort *)(param_1 + 0x16cc) | (ushort)(iVar4 + -2 << ((byte)iVar3 & 0x1f));
              *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
                   *(undefined1 *)(param_1 + 0x16cc);
              *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
              *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
                   *(undefined1 *)(param_1 + 0x16cd);
              *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
              iVar3 = *(int *)(param_1 + 0x16d0) + -0xd;
              *(ushort *)(param_1 + 0x16cc) =
                   (ushort)(iVar4 + -2) >> (0x10U - (char)*(int *)(param_1 + 0x16d0) & 0x1f);
            }
            else {
              uVar8 = (uint)*(ushort *)(param_1 + 0xada);
              iVar3 = *(int *)(param_1 + 0x16d0);
              if ((int)(0x10 - uVar8) < iVar3) {
                uVar1 = *(ushort *)(param_1 + 0xad8);
                *(ushort *)(param_1 + 0x16cc) =
                     *(ushort *)(param_1 + 0x16cc) | uVar1 << ((byte)iVar3 & 0x1f);
                *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
                     *(undefined1 *)(param_1 + 0x16cc);
                *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
                *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
                     *(undefined1 *)(param_1 + 0x16cd);
                *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
                *(ushort *)(param_1 + 0x16cc) =
                     uVar1 >> (0x10U - (char)*(int *)(param_1 + 0x16d0) & 0x1f);
                *(uint *)(param_1 + 0x16d0) = *(int *)(param_1 + 0x16d0) + -0x10 + uVar8;
              }
              else {
                *(ushort *)(param_1 + 0x16cc) =
                     *(ushort *)(param_1 + 0x16cc) |
                     *(short *)(param_1 + 0xad8) << ((byte)iVar3 & 0x1f);
                *(uint *)(param_1 + 0x16d0) = iVar3 + uVar8;
              }
              iVar3 = *(int *)(param_1 + 0x16d0);
              if (iVar3 < 10) {
                *(ushort *)(param_1 + 0x16cc) =
                     *(ushort *)(param_1 + 0x16cc) | (ushort)(iVar4 + -10 << ((byte)iVar3 & 0x1f));
                iVar3 = iVar3 + 7;
                goto LAB_6767c048;
              }
              *(ushort *)(param_1 + 0x16cc) =
                   *(ushort *)(param_1 + 0x16cc) | (ushort)(iVar4 + -10 << ((byte)iVar3 & 0x1f));
              *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
                   *(undefined1 *)(param_1 + 0x16cc);
              *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
              *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
                   *(undefined1 *)(param_1 + 0x16cd);
              *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
              iVar3 = *(int *)(param_1 + 0x16d0) + -9;
              *(ushort *)(param_1 + 0x16cc) =
                   (ushort)(iVar4 + -10) >> (0x10U - (char)*(int *)(param_1 + 0x16d0) & 0x1f);
            }
          }
          else {
            if (uVar6 != local_c) {
              uVar8 = (uint)*(ushort *)(param_1 + 0xa92 + uVar6 * 4);
              bVar2 = (byte)*(int *)(param_1 + 0x16d0);
              iVar5 = iVar4;
              if ((int)(0x10 - uVar8) < *(int *)(param_1 + 0x16d0)) {
                uVar1 = *(ushort *)(param_1 + 0xa90 + uVar6 * 4);
                *(ushort *)(param_1 + 0x16cc) =
                     *(ushort *)(param_1 + 0x16cc) | uVar1 << (bVar2 & 0x1f);
                *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
                     *(undefined1 *)(param_1 + 0x16cc);
                *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
                *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
                     *(undefined1 *)(param_1 + 0x16cd);
                iVar3 = *(int *)(param_1 + 0x16d0);
                *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
                *(uint *)(param_1 + 0x16d0) = iVar3 + -0x10 + uVar8;
                *(ushort *)(param_1 + 0x16cc) = uVar1 >> (0x10U - (char)iVar3 & 0x1f);
              }
              else {
                *(ushort *)(param_1 + 0x16cc) =
                     *(ushort *)(param_1 + 0x16cc) |
                     *(short *)(param_1 + 0xa90 + uVar6 * 4) << (bVar2 & 0x1f);
                *(uint *)(param_1 + 0x16d0) = *(int *)(param_1 + 0x16d0) + uVar8;
              }
            }
            uVar8 = (uint)*(ushort *)(param_1 + 0xad2);
            iVar3 = *(int *)(param_1 + 0x16d0);
            if ((int)(0x10 - uVar8) < iVar3) {
              uVar1 = *(ushort *)(param_1 + 0xad0);
              *(ushort *)(param_1 + 0x16cc) =
                   *(ushort *)(param_1 + 0x16cc) | uVar1 << ((byte)iVar3 & 0x1f);
              *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
                   *(undefined1 *)(param_1 + 0x16cc);
              *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
              *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
                   *(undefined1 *)(param_1 + 0x16cd);
              *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
              *(ushort *)(param_1 + 0x16cc) =
                   uVar1 >> (0x10U - (char)*(int *)(param_1 + 0x16d0) & 0x1f);
              *(uint *)(param_1 + 0x16d0) = *(int *)(param_1 + 0x16d0) + -0x10 + uVar8;
            }
            else {
              *(ushort *)(param_1 + 0x16cc) =
                   *(ushort *)(param_1 + 0x16cc) |
                   *(short *)(param_1 + 0xad0) << ((byte)iVar3 & 0x1f);
              *(uint *)(param_1 + 0x16d0) = iVar3 + uVar8;
            }
            iVar3 = *(int *)(param_1 + 0x16d0);
            if (iVar3 < 0xf) {
              *(ushort *)(param_1 + 0x16cc) =
                   *(ushort *)(param_1 + 0x16cc) | (ushort)(iVar5 + -3 << ((byte)iVar3 & 0x1f));
              iVar3 = iVar3 + 2;
              goto LAB_6767c048;
            }
            *(ushort *)(param_1 + 0x16cc) =
                 *(ushort *)(param_1 + 0x16cc) | (ushort)(iVar5 + -3 << ((byte)iVar3 & 0x1f));
            *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
                 *(undefined1 *)(param_1 + 0x16cc);
            *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
            *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
                 *(undefined1 *)(param_1 + 0x16cd);
            *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
            iVar3 = *(int *)(param_1 + 0x16d0) + -0xe;
            *(ushort *)(param_1 + 0x16cc) =
                 (ushort)(iVar5 + -3) >> (0x10U - (char)*(int *)(param_1 + 0x16d0) & 0x1f);
          }
          *(int *)(param_1 + 0x16d0) = iVar3;
        }
LAB_6767c04e:
        iVar5 = 0;
        local_c = uVar6;
        if (uVar7 == 0) {
          iVar3 = 0x8a;
        }
        else {
          if (uVar6 != uVar7) {
            iVar3 = 7;
            iStack_20 = 4;
            goto LAB_6767c071;
          }
          iVar3 = 6;
        }
        iStack_20 = 3;
      }
LAB_6767c071:
      local_8 = local_8 + 2;
      local_10 = local_10 + -1;
      iVar4 = iVar5;
      uVar6 = uVar7;
    } while (local_10 != 0);
  }
  return;
}



// Function: FUN_6767c083 at 6767c083

void __cdecl FUN_6767c083(int param_1,int param_2,int param_3)

{
  ushort *puVar1;
  byte bVar2;
  ushort uVar3;
  ushort uVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  int iVar11;
  uint uVar12;
  int iVar13;
  int local_8;
  
  iVar5 = param_1;
  uVar6 = 0;
  if (*(int *)(param_1 + 0x16b4) != 0) {
    do {
      uVar12 = (uint)*(ushort *)(*(int *)(iVar5 + 0x16b8) + uVar6 * 2);
      uVar9 = (uint)*(ushort *)(*(int *)(iVar5 + 0x16ac) + uVar6 * 2);
      uVar6 = uVar6 + 1;
      if (uVar12 == 0) {
        uVar12 = (uint)*(ushort *)(param_2 + 2 + uVar9 * 4);
        iVar7 = *(int *)(iVar5 + 0x16d0);
        puVar1 = (ushort *)(param_2 + uVar9 * 4);
        if ((int)(0x10 - uVar12) < iVar7) {
          uVar3 = *puVar1;
          *(ushort *)(iVar5 + 0x16cc) = *(ushort *)(iVar5 + 0x16cc) | uVar3 << ((byte)iVar7 & 0x1f);
          *(undefined1 *)(*(int *)(iVar5 + 8) + *(int *)(iVar5 + 0x14)) =
               *(undefined1 *)(iVar5 + 0x16cc);
          *(int *)(iVar5 + 0x14) = *(int *)(iVar5 + 0x14) + 1;
          *(undefined1 *)(*(int *)(iVar5 + 0x14) + *(int *)(iVar5 + 8)) =
               *(undefined1 *)(iVar5 + 0x16cd);
          *(int *)(iVar5 + 0x14) = *(int *)(iVar5 + 0x14) + 1;
          iVar7 = *(int *)(iVar5 + 0x16d0) + -0x10 + uVar12;
          *(ushort *)(iVar5 + 0x16cc) = uVar3 >> (0x10U - (char)*(int *)(iVar5 + 0x16d0) & 0x1f);
        }
        else {
          *(ushort *)(iVar5 + 0x16cc) =
               *(ushort *)(iVar5 + 0x16cc) | *puVar1 << ((byte)iVar7 & 0x1f);
          iVar7 = iVar7 + uVar12;
        }
LAB_6767c3c9:
        *(int *)(iVar5 + 0x16d0) = iVar7;
      }
      else {
        if (*(char *)(iVar5 + 0x1d) == '\b') {
LAB_6767c165:
          uVar10 = (uint)(byte)(&DAT_676b96d0)[uVar9];
LAB_6767c16c:
          param_1 = *(int *)(&DAT_676b8d08 + uVar10 * 4);
          local_8 = *(int *)(&DAT_676b97d0 + uVar10 * 4);
        }
        else {
          local_8 = 0;
          uVar10 = 0x1c;
          param_1 = 0x10;
          if (uVar9 < 0x100) {
            uVar10 = 0x1b;
            if (uVar9 != 0xff) goto LAB_6767c165;
            goto LAB_6767c16c;
          }
        }
        uVar8 = (uint)*(ushort *)(param_2 + 0x406 + uVar10 * 4);
        iVar7 = *(int *)(iVar5 + 0x16d0);
        if ((int)(0x10 - uVar8) < iVar7) {
          uVar3 = *(ushort *)(param_2 + 0x404 + uVar10 * 4);
          *(ushort *)(iVar5 + 0x16cc) = *(ushort *)(iVar5 + 0x16cc) | uVar3 << ((byte)iVar7 & 0x1f);
          *(undefined1 *)(*(int *)(iVar5 + 8) + *(int *)(iVar5 + 0x14)) =
               *(undefined1 *)(iVar5 + 0x16cc);
          *(int *)(iVar5 + 0x14) = *(int *)(iVar5 + 0x14) + 1;
          *(undefined1 *)(*(int *)(iVar5 + 0x14) + *(int *)(iVar5 + 8)) =
               *(undefined1 *)(iVar5 + 0x16cd);
          *(int *)(iVar5 + 0x14) = *(int *)(iVar5 + 0x14) + 1;
          *(ushort *)(iVar5 + 0x16cc) = uVar3 >> (0x10U - (char)*(int *)(iVar5 + 0x16d0) & 0x1f);
          *(uint *)(iVar5 + 0x16d0) = *(int *)(iVar5 + 0x16d0) + -0x10 + uVar8;
        }
        else {
          *(ushort *)(iVar5 + 0x16cc) =
               *(ushort *)(iVar5 + 0x16cc) |
               *(short *)(param_2 + 0x404 + uVar10 * 4) << ((byte)iVar7 & 0x1f);
          *(uint *)(iVar5 + 0x16d0) = iVar7 + uVar8;
        }
        if (param_1 != 0) {
          iVar7 = *(int *)(iVar5 + 0x16d0);
          local_8 = uVar9 - local_8;
          if (0x10 - param_1 < iVar7) {
            *(ushort *)(iVar5 + 0x16cc) =
                 *(ushort *)(iVar5 + 0x16cc) | (ushort)(local_8 << ((byte)iVar7 & 0x1f));
            *(undefined1 *)(*(int *)(iVar5 + 8) + *(int *)(iVar5 + 0x14)) =
                 *(undefined1 *)(iVar5 + 0x16cc);
            *(int *)(iVar5 + 0x14) = *(int *)(iVar5 + 0x14) + 1;
            *(undefined1 *)(*(int *)(iVar5 + 0x14) + *(int *)(iVar5 + 8)) =
                 *(undefined1 *)(iVar5 + 0x16cd);
            *(int *)(iVar5 + 0x14) = *(int *)(iVar5 + 0x14) + 1;
            iVar7 = *(int *)(iVar5 + 0x16d0) + -0x10;
            *(ushort *)(iVar5 + 0x16cc) =
                 (ushort)local_8 >> (0x10U - (char)*(int *)(iVar5 + 0x16d0) & 0x1f);
          }
          else {
            *(ushort *)(iVar5 + 0x16cc) =
                 *(ushort *)(iVar5 + 0x16cc) | (ushort)(local_8 << ((byte)iVar7 & 0x1f));
          }
          *(int *)(iVar5 + 0x16d0) = iVar7 + param_1;
        }
        uVar9 = uVar12 - 1;
        if (uVar9 < 0x100) {
          bVar2 = (&DAT_676b93cf)[uVar12];
        }
        else {
          bVar2 = (&DAT_676b94d0)[uVar9 >> 7];
        }
        iVar11 = (uint)bVar2 * 4;
        puVar1 = (ushort *)(iVar11 + param_3);
        uVar12 = (uint)puVar1[1];
        iVar7 = *(int *)(iVar5 + 0x16d0);
        if ((int)(0x10 - uVar12) < iVar7) {
          uVar3 = *puVar1;
          *(ushort *)(iVar5 + 0x16cc) = *(ushort *)(iVar5 + 0x16cc) | uVar3 << ((byte)iVar7 & 0x1f);
          *(undefined1 *)(*(int *)(iVar5 + 8) + *(int *)(iVar5 + 0x14)) =
               *(undefined1 *)(iVar5 + 0x16cc);
          *(int *)(iVar5 + 0x14) = *(int *)(iVar5 + 0x14) + 1;
          *(undefined1 *)(*(int *)(iVar5 + 0x14) + *(int *)(iVar5 + 8)) =
               *(undefined1 *)(iVar5 + 0x16cd);
          *(int *)(iVar5 + 0x14) = *(int *)(iVar5 + 0x14) + 1;
          *(ushort *)(iVar5 + 0x16cc) = uVar3 >> (0x10U - (char)*(int *)(iVar5 + 0x16d0) & 0x1f);
          *(uint *)(iVar5 + 0x16d0) = *(int *)(iVar5 + 0x16d0) + -0x10 + uVar12;
        }
        else {
          *(ushort *)(iVar5 + 0x16cc) =
               *(ushort *)(iVar5 + 0x16cc) | *puVar1 << ((byte)iVar7 & 0x1f);
          *(uint *)(iVar5 + 0x16d0) = iVar7 + uVar12;
        }
        iVar7 = *(int *)(&DAT_676b8df0 + iVar11);
        if (iVar7 != 0) {
          iVar13 = uVar9 - *(int *)(&DAT_676b9844 + iVar11);
          iVar11 = *(int *)(iVar5 + 0x16d0);
          if (0x10 - iVar7 < iVar11) {
            *(ushort *)(iVar5 + 0x16cc) =
                 *(ushort *)(iVar5 + 0x16cc) | (ushort)(iVar13 << ((byte)iVar11 & 0x1f));
            *(undefined1 *)(*(int *)(iVar5 + 8) + *(int *)(iVar5 + 0x14)) =
                 *(undefined1 *)(iVar5 + 0x16cc);
            *(int *)(iVar5 + 0x14) = *(int *)(iVar5 + 0x14) + 1;
            *(undefined1 *)(*(int *)(iVar5 + 0x14) + *(int *)(iVar5 + 8)) =
                 *(undefined1 *)(iVar5 + 0x16cd);
            *(int *)(iVar5 + 0x14) = *(int *)(iVar5 + 0x14) + 1;
            iVar7 = *(int *)(iVar5 + 0x16d0) + -0x10 + iVar7;
            *(ushort *)(iVar5 + 0x16cc) =
                 (ushort)iVar13 >> (0x10U - (char)*(int *)(iVar5 + 0x16d0) & 0x1f);
          }
          else {
            *(ushort *)(iVar5 + 0x16cc) =
                 *(ushort *)(iVar5 + 0x16cc) | (ushort)(iVar13 << ((byte)iVar11 & 0x1f));
            iVar7 = iVar11 + iVar7;
          }
          goto LAB_6767c3c9;
        }
      }
    } while (uVar6 < *(uint *)(iVar5 + 0x16b4));
  }
  uVar3 = *(ushort *)(param_2 + 0x402);
  iVar7 = *(int *)(iVar5 + 0x16d0);
  if ((int)(0x10 - (uint)uVar3) < iVar7) {
    uVar4 = *(ushort *)(param_2 + 0x400);
    *(ushort *)(iVar5 + 0x16cc) = *(ushort *)(iVar5 + 0x16cc) | uVar4 << ((byte)iVar7 & 0x1f);
    *(undefined1 *)(*(int *)(iVar5 + 8) + *(int *)(iVar5 + 0x14)) = *(undefined1 *)(iVar5 + 0x16cc);
    *(int *)(iVar5 + 0x14) = *(int *)(iVar5 + 0x14) + 1;
    *(undefined1 *)(*(int *)(iVar5 + 0x14) + *(int *)(iVar5 + 8)) = *(undefined1 *)(iVar5 + 0x16cd);
    *(int *)(iVar5 + 0x14) = *(int *)(iVar5 + 0x14) + 1;
    iVar7 = *(int *)(iVar5 + 0x16d0) + -0x10;
    *(ushort *)(iVar5 + 0x16cc) = uVar4 >> (0x10U - (char)*(int *)(iVar5 + 0x16d0) & 0x1f);
  }
  else {
    *(ushort *)(iVar5 + 0x16cc) =
         *(ushort *)(iVar5 + 0x16cc) | *(short *)(param_2 + 0x400) << ((byte)iVar7 & 0x1f);
  }
  *(uint *)(iVar5 + 0x16d0) = iVar7 + (uint)uVar3;
  *(uint *)(iVar5 + 0x16c8) = (uint)*(ushort *)(param_2 + 0x402);
  return;
}



// Function: FUN_6767c47a at 6767c47a

void __cdecl FUN_6767c47a(int param_1)

{
  ushort *puVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  
  uVar2 = 0;
  uVar4 = 0;
  puVar1 = (ushort *)(param_1 + 0x98);
  iVar3 = 7;
  do {
    uVar4 = uVar4 + *puVar1;
    puVar1 = puVar1 + 2;
    iVar3 = iVar3 + -1;
  } while (iVar3 != 0);
  puVar1 = (ushort *)(param_1 + 0xb4);
  iVar3 = 0x79;
  do {
    uVar2 = uVar2 + *puVar1;
    puVar1 = puVar1 + 2;
    iVar3 = iVar3 + -1;
  } while (iVar3 != 0);
  puVar1 = (ushort *)(param_1 + 0x298);
  iVar3 = 0x80;
  do {
    uVar4 = uVar4 + *puVar1;
    puVar1 = puVar1 + 2;
    iVar3 = iVar3 + -1;
  } while (iVar3 != 0);
  *(char *)(param_1 + 0x1c) = '\x01' - (uVar2 >> 2 < uVar4);
  return;
}



// Function: FUN_6767c4d3 at 6767c4d3

uint __cdecl FUN_6767c4d3(uint param_1,int param_2)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  
  uVar1 = 0;
  do {
    uVar2 = uVar1;
    uVar3 = param_1 & 1;
    param_2 = param_2 + -1;
    uVar1 = (uVar2 | uVar3) << 1;
    param_1 = param_1 >> 1;
  } while (0 < param_2);
  return uVar2 & 0x7fffffff | uVar3;
}



// Function: FUN_6767c4f2 at 6767c4f2

void __cdecl FUN_6767c4f2(int param_1)

{
  if (*(int *)(param_1 + 0x16d0) == 0x10) {
    *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
         *(undefined1 *)(param_1 + 0x16cc);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
         *(undefined1 *)(param_1 + 0x16cd);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(undefined2 *)(param_1 + 0x16cc) = 0;
    *(undefined4 *)(param_1 + 0x16d0) = 0;
  }
  else if (7 < *(int *)(param_1 + 0x16d0)) {
    *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
         *(undefined1 *)(param_1 + 0x16cc);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(int *)(param_1 + 0x16d0) = *(int *)(param_1 + 0x16d0) + -8;
    *(ushort *)(param_1 + 0x16cc) = (ushort)*(byte *)(param_1 + 0x16cd);
  }
  return;
}



// Function: FUN_6767c569 at 6767c569

void __cdecl FUN_6767c569(int param_1)

{
  if (*(int *)(param_1 + 0x16d0) < 9) {
    if (0 < *(int *)(param_1 + 0x16d0)) {
      *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
           *(undefined1 *)(param_1 + 0x16cc);
      *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    }
  }
  else {
    *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
         *(undefined1 *)(param_1 + 0x16cc);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
         *(undefined1 *)(param_1 + 0x16cd);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
  }
  *(undefined2 *)(param_1 + 0x16cc) = 0;
  *(undefined4 *)(param_1 + 0x16d0) = 0;
  return;
}



// Function: FUN_6767c5cd at 6767c5cd

void __cdecl FUN_6767c5cd(int param_1,undefined1 *param_2,int param_3,int param_4)

{
  byte bVar1;
  
  FUN_6767c569(param_1);
  *(undefined4 *)(param_1 + 0x16c8) = 8;
  if (param_4 != 0) {
    *(byte *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) = (byte)param_3;
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    bVar1 = (byte)((uint)param_3 >> 8);
    *(byte *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) = bVar1;
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(byte *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) = ~(byte)param_3;
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(byte *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) = ~bVar1;
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
  }
  if (param_3 != 0) {
    do {
      *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) = *param_2;
      *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
      param_2 = param_2 + 1;
      param_3 = param_3 + -1;
    } while (param_3 != 0);
  }
  return;
}



// Function: FUN_6767c654 at 6767c654

void __cdecl FUN_6767c654(uint *param_1)

{
  void *this;
  
  FUN_6767c6af((int)param_1);
  FUN_6767c6fa(param_1);
  FUN_6767c676(this,param_1,(int)(param_1 + 3),0xc);
  return;
}



// Function: FUN_6767c676 at 6767c676

void __thiscall FUN_6767c676(void *this,uint *param_1,int param_2,uint param_3)

{
  uint uVar1;
  void *extraout_ECX;
  uint uVar2;
  
  uVar2 = 0;
  if (param_3 != 0) {
    do {
      uVar1 = FUN_6767c76a(this,(int)param_1);
      FUN_6767c72c(param_1,*(byte *)(uVar2 + param_2));
      *(byte *)(uVar2 + param_2) = *(byte *)(uVar2 + param_2) ^ (byte)uVar1;
      uVar2 = uVar2 + 1;
      this = extraout_ECX;
    } while (uVar2 < param_3);
  }
  return;
}



// Function: FUN_6767c6af at 6767c6af

void __cdecl FUN_6767c6af(int param_1)

{
  ushort uVar1;
  DWORD DVar2;
  byte bVar3;
  int iVar4;
  int iVar5;
  
  DVar2 = GetTickCount();
  iVar4 = 0;
  uVar1 = *(ushort *)(param_1 + 0x1c);
  iVar5 = 0;
  do {
    bVar3 = (byte)iVar5;
    iVar5 = iVar5 + 3;
    *(char *)(param_1 + 0xc + iVar4) =
         (char)((DVar2 ^ (uint)uVar1 << 5) >> (bVar3 & 0x1f)) + (char)iVar4 * '\x17';
    iVar4 = iVar4 + 1;
  } while (iVar5 < 0x1e);
  *(undefined1 *)(param_1 + 0x16) = *(undefined1 *)(param_1 + 0x1c);
  *(undefined1 *)(param_1 + 0x17) = *(undefined1 *)(param_1 + 0x1d);
  return;
}



// Function: FUN_6767c6fa at 6767c6fa

void __cdecl FUN_6767c6fa(uint *param_1)

{
  byte *pbVar1;
  
  pbVar1 = (byte *)param_1[6];
  *param_1 = 0x12345678;
  param_1[1] = 0x23456789;
  param_1[2] = 0x34567890;
  for (; *pbVar1 != 0; pbVar1 = pbVar1 + 1) {
    FUN_6767c72c(param_1,*pbVar1);
  }
  return;
}



// Function: FUN_6767c72c at 6767c72c

byte __cdecl FUN_6767c72c(uint *param_1,byte param_2)

{
  uint uVar1;
  
  uVar1 = FUN_67677ddc(*param_1,(uint)param_2);
  *param_1 = uVar1;
  uVar1 = ((uVar1 & 0xff) + param_1[1]) * 0x8088405 + 1;
  param_1[1] = uVar1;
  uVar1 = FUN_67677ddc(param_1[2],uVar1 >> 0x18);
  param_1[2] = uVar1;
  return param_2;
}



// Function: FUN_6767c76a at 6767c76a

uint __thiscall FUN_6767c76a(void *this,int param_1)

{
  uint uVar1;
  
  uVar1 = CONCAT31((int3)(CONCAT22((short)((uint)this >> 0x10),*(undefined2 *)(param_1 + 8)) >> 8),
                   (char)*(undefined2 *)(param_1 + 8)) | 2;
  return (uVar1 ^ 1) * uVar1 >> 8;
}



// Function: FUN_6767c781 at 6767c781

byte __cdecl FUN_6767c781(uint *param_1)

{
  void *this;
  
  FUN_6767c6fa(param_1);
  FUN_6767c7b4(this,param_1,(int)(param_1 + 3),0xc);
  return -(*(char *)((int)param_1 + 0x17) != *(char *)((int)param_1 + 0x1d)) & 2;
}



// Function: FUN_6767c7b4 at 6767c7b4

void __thiscall FUN_6767c7b4(void *this,uint *param_1,int param_2,uint param_3)

{
  byte *pbVar1;
  uint uVar2;
  void *extraout_ECX;
  uint uVar3;
  
  uVar3 = 0;
  if (param_3 != 0) {
    do {
      pbVar1 = (byte *)(uVar3 + param_2);
      uVar2 = FUN_6767c76a(this,(int)param_1);
      *pbVar1 = *pbVar1 ^ (byte)uVar2;
      FUN_6767c72c(param_1,*pbVar1);
      uVar3 = uVar3 + 1;
      this = extraout_ECX;
    } while (uVar3 < param_3);
  }
  return;
}



// Function: FUN_6767c7e8 at 6767c7e8

void __cdecl FUN_6767c7e8(undefined4 param_1,int param_2,int param_3)

{
  FUN_676b0a68(param_2,param_3);
  return;
}



// Function: FUN_6767c803 at 6767c803

undefined4 * __fastcall FUN_6767c803(undefined4 *param_1)

{
  void *pvVar1;
  
  param_1[0xc] = 0;
  param_1[0xe] = 0;
  *param_1 = &PTR_FUN_676b98c4;
  pvVar1 = operator_new(0xffff);
  param_1[0xd] = pvVar1;
  FUN_6767c87e((int)param_1);
  return param_1;
}



// Function: FUN_6767c82d at 6767c82d

undefined4 * __thiscall FUN_6767c82d(void *this,byte param_1)

{
  FUN_6767c849((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_6767c849 at 6767c849

void __fastcall FUN_6767c849(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b98c4;
  if ((undefined *)param_1[0xc] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[0xc]);
  }
  if ((undefined *)param_1[0xd] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[0xd]);
  }
  if ((undefined *)param_1[0xe] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[0xe]);
  }
  return;
}



// Function: FUN_6767c87e at 6767c87e

void __fastcall FUN_6767c87e(int param_1)

{
  *(undefined2 *)(param_1 + 4) = 0;
  *(undefined2 *)(param_1 + 6) = 0;
  *(undefined2 *)(param_1 + 8) = 0;
  *(undefined2 *)(param_1 + 10) = 0;
  *(undefined2 *)(param_1 + 0xc) = 0;
  *(undefined2 *)(param_1 + 0xe) = 0;
  *(undefined4 *)(param_1 + 0x10) = 0;
  *(undefined4 *)(param_1 + 0x14) = 0;
  *(undefined4 *)(param_1 + 0x18) = 0;
  *(undefined2 *)(param_1 + 0x1c) = 0;
  *(undefined2 *)(param_1 + 0x1e) = 0;
  *(undefined2 *)(param_1 + 0x20) = 0;
  *(undefined2 *)(param_1 + 0x22) = 0;
  *(undefined2 *)(param_1 + 0x24) = 0;
  *(undefined4 *)(param_1 + 0x26) = 0;
  *(undefined4 *)(param_1 + 0x2a) = 0;
  if (*(undefined **)(param_1 + 0x30) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)(param_1 + 0x30));
    *(undefined4 *)(param_1 + 0x30) = 0;
  }
  if (*(undefined **)(param_1 + 0x38) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)(param_1 + 0x38));
    *(undefined4 *)(param_1 + 0x38) = 0;
  }
  return;
}



// Function: FUN_6767c8e4 at 6767c8e4

uint __thiscall FUN_6767c8e4(void *this,void *param_1,int param_2)

{
  void *this_00;
  ushort uVar1;
  uint uVar2;
  void *pvVar3;
  int iVar4;
  
  if (((*(int *)((int)this + 0x30) == 0) && (*(int *)((int)this + 0x34) != 0)) &&
     (*(int *)((int)this + 0x38) == 0)) {
    this_00 = (void *)(param_2 + 0x30);
    uVar2 = FUN_6768d2cc(this_00,param_1,(LPVOID)(-(uint)(this != (void *)0x0) & (int)this + 4U),
                         0x2a);
    if ((char)uVar2 == '\0') goto LAB_6767c9df;
    uVar1 = *(ushort *)((int)this + 0x1c);
    uVar2 = CONCAT22((short)(uVar2 >> 0x10),uVar1);
    if (uVar1 == 0) {
LAB_6767c967:
      uVar1 = *(ushort *)((int)this + 0x1e);
      uVar2 = CONCAT22((short)(uVar2 >> 0x10),uVar1);
      if ((uVar1 != 0) &&
         (uVar2 = FUN_6768d2cc(this_00,param_1,*(LPVOID *)((int)this + 0x34),(uint)uVar1),
         (char)uVar2 == '\0')) goto LAB_6767c9df;
      uVar1 = *(ushort *)((int)this + 0x20);
      uVar2 = CONCAT22((short)(uVar2 >> 0x10),uVar1);
      if (uVar1 == 0) {
LAB_6767c9c9:
        return CONCAT31((int3)(uVar2 >> 8),1);
      }
      pvVar3 = operator_new(uVar1 + 1);
      *(void **)((int)this + 0x38) = pvVar3;
      if (pvVar3 != (void *)0x0) {
        *(undefined1 *)((uint)*(ushort *)((int)this + 0x20) + (int)pvVar3) = 0;
        uVar2 = FUN_6768d2cc(this_00,param_1,*(LPVOID *)((int)this + 0x38),
                             (uint)*(ushort *)((int)this + 0x20));
        if ((char)uVar2 == '\0') goto LAB_6767c9df;
        goto LAB_6767c9c9;
      }
    }
    else {
      pvVar3 = operator_new(uVar1 + 1);
      *(void **)((int)this + 0x30) = pvVar3;
      if (pvVar3 != (void *)0x0) {
        *(undefined1 *)((uint)*(ushort *)((int)this + 0x1c) + (int)pvVar3) = 0;
        uVar2 = FUN_6768d2cc(this_00,param_1,*(LPVOID *)((int)this + 0x30),
                             (uint)*(ushort *)((int)this + 0x1c));
        if ((char)uVar2 == '\0') goto LAB_6767c9df;
        goto LAB_6767c967;
      }
    }
    iVar4 = 0x1ff;
  }
  else {
    iVar4 = 999;
  }
  uVar2 = FUN_6767ca9c(param_1,iVar4,0x4000000);
LAB_6767c9df:
  return uVar2 & 0xffffff00;
}



// Function: FUN_6767c9e8 at 6767c9e8

uint __thiscall FUN_6767c9e8(void *this,void *param_1,int param_2)

{
  void *this_00;
  ushort uVar1;
  uint uVar2;
  undefined4 local_8;
  
  this_00 = (void *)(param_2 + 0x30);
  local_8 = 0x2014b50;
  uVar2 = FUN_6768d357(this_00,param_1,&local_8,4,0);
  if (((char)uVar2 != '\0') &&
     (uVar2 = FUN_6768d357(this_00,param_1,
                           (undefined4 *)(-(uint)(this != (void *)0x0) & (int)this + 4U),0x2a,0),
     (char)uVar2 != '\0')) {
    uVar1 = *(ushort *)((int)this + 0x1c);
    uVar2 = CONCAT22((short)(uVar2 >> 0x10),uVar1);
    if ((uVar1 == 0) ||
       (uVar2 = FUN_6768d357(this_00,param_1,*(undefined4 **)((int)this + 0x30),(uint)uVar1,0),
       (char)uVar2 != '\0')) {
      uVar1 = *(ushort *)((int)this + 0x1e);
      uVar2 = CONCAT22((short)(uVar2 >> 0x10),uVar1);
      if ((uVar1 == 0) ||
         (uVar2 = FUN_6768d357(this_00,param_1,*(undefined4 **)((int)this + 0x34),(uint)uVar1,0),
         (char)uVar2 != '\0')) {
        uVar1 = *(ushort *)((int)this + 0x20);
        uVar2 = CONCAT22((short)(uVar2 >> 0x10),uVar1);
        if ((uVar1 == 0) ||
           (uVar2 = FUN_6768d357(this_00,param_1,*(undefined4 **)((int)this + 0x38),(uint)uVar1,0),
           (char)uVar2 != '\0')) {
          return CONCAT31((int3)(uVar2 >> 8),1);
        }
      }
    }
  }
  return uVar2 & 0xffffff00;
}



// Function: FUN_6767ca9c at 6767ca9c

int __thiscall FUN_6767ca9c(void *this,int param_1,int param_2)

{
  int *piVar1;
  
  if (param_1 != 0) {
    *(int *)((int)this + 4) = param_1;
    *(int *)((int)this + 8) = param_2;
    if (*(int *)((int)this + 0x10) < param_2) {
      *(int *)((int)this + 0xc) = param_1;
      *(int *)((int)this + 0x10) = param_2;
    }
    piVar1 = *(int **)((int)this + 0x18);
    if (piVar1 != (int *)0x0) {
      if (param_2 == 0x1000000) {
        (**(code **)*piVar1)(*(undefined4 *)((int)this + 0x14),this);
      }
      else if (param_2 == 0x2000000) {
        (**(code **)(*piVar1 + 4))(*(undefined4 *)((int)this + 0x14),this);
      }
      else if (param_2 == 0x4000000) {
        (**(code **)(*piVar1 + 8))(*(undefined4 *)((int)this + 0x14),this);
      }
    }
  }
  return (int)this;
}



// Function: FUN_6767cafc at 6767cafc

undefined4 * __fastcall FUN_6767cafc(undefined4 *param_1)

{
  int iVar1;
  
  *param_1 = &PTR_LAB_676b9960;
  param_1[1] = &PTR_LAB_676b9954;
  FUN_676ae3ab(param_1 + 0x189,1);
  FUN_676ae3ab(param_1 + 400,1);
  *(undefined2 *)((int)param_1 + 0x67a) = 1;
  *(undefined2 *)((int)param_1 + 0x67e) = 1;
  param_1[0x19c] = &PTR_LAB_676b9950;
  *(undefined2 *)(param_1 + 0x19e) = 0x76c;
  *(undefined2 *)(param_1 + 0x1a0) = 0;
  *(undefined2 *)((int)param_1 + 0x682) = 0;
  *(undefined2 *)(param_1 + 0x1a1) = 0;
  *(undefined2 *)(param_1 + 0x19f) = 0;
  *(undefined2 *)((int)param_1 + 0x686) = 0;
  iVar1 = Ordinal_184(param_1 + 0x19e,param_1 + 0x1a2);
  if (iVar1 == 0) {
    *(undefined8 *)(param_1 + 0x1a2) = 0x4000000000000000;
  }
  param_1[0x1a4] = &PTR_LAB_676b9950;
  *(undefined2 *)((int)param_1 + 0x69a) = 0xc;
  *(undefined2 *)(param_1 + 0x1a6) = 9999;
  *(undefined2 *)((int)param_1 + 0x69e) = 0x1f;
  *(undefined2 *)(param_1 + 0x1a8) = 0;
  *(undefined2 *)((int)param_1 + 0x6a2) = 0;
  *(undefined2 *)(param_1 + 0x1a9) = 0;
  *(undefined2 *)(param_1 + 0x1a7) = 0;
  *(undefined2 *)((int)param_1 + 0x6a6) = 0;
  iVar1 = Ordinal_184(param_1 + 0x1a6,param_1 + 0x1aa);
  if (iVar1 == 0) {
    *(undefined8 *)(param_1 + 0x1aa) = 0x4000000000000000;
  }
  FUN_67685419(param_1 + 0x2ba,param_1);
  FUN_67680433(param_1 + 0x488,param_1);
  FUN_6768a1f0(param_1 + 0x49f);
  *param_1 = &PTR_FUN_676b98d4;
  param_1[1] = &PTR_LAB_676b98c8;
  FUN_676ad79e();
  param_1[0x576] = 0;
  *(undefined1 *)(param_1 + 2) = 0;
  *(undefined2 *)((int)param_1 + 10) = 0;
  *(undefined2 *)((int)param_1 + 0x212) = 0;
  *(undefined1 *)((int)param_1 + 0x41a) = 0;
  *(undefined1 *)(param_1 + 0x197) = 0;
  *(undefined1 *)((int)param_1 + 0x65d) = 0;
  *(undefined1 *)((int)param_1 + 0x65e) = 0;
  *(undefined1 *)((int)param_1 + 0x65f) = 0;
  param_1[0x198] = 0;
  param_1[0x199] = 0x18;
  param_1[0x19a] = 6;
  param_1[0x19b] = 8;
  param_1[0x1ac] = 0;
  param_1[0x1ad] = 0;
  *(undefined1 *)(param_1 + 0x1ae) = 1;
  *(undefined1 *)((int)param_1 + 0x6b9) = 0;
  *(undefined1 *)((int)param_1 + 0x6ba) = 0;
  *(undefined1 *)((int)param_1 + 0x6bb) = 1;
  param_1[0x1af] = 0;
  *(undefined2 *)(param_1 + 0x1b0) = 0;
  *(undefined2 *)(param_1 + 0x232) = 0;
  param_1[0x2b4] = 2;
  param_1[0x2b5] = 10;
  *(undefined1 *)(param_1 + 0x2b6) = 0;
  *(undefined1 *)(param_1 + 0x574) = 0;
  *(undefined1 *)((int)param_1 + 0x15d1) = 0;
  param_1[0x577] = 0;
  *(undefined1 *)((int)param_1 + 0xad9) = 0;
  param_1[0x2b7] = 0;
  param_1[0x2b8] = 0;
  (**(code **)(param_1[0x2ba] + 0xc))();
  (**(code **)(param_1[0x488] + 0xc))();
  return param_1;
}



// Function: FUN_6767cd2a at 6767cd2a

undefined4 * __thiscall FUN_6767cd2a(void *this,byte param_1)

{
  FUN_6767cd46((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_6767cd46 at 6767cd46

void __fastcall FUN_6767cd46(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b98d4;
  param_1[1] = &PTR_LAB_676b98c8;
  FUN_676ad7a7();
  FUN_6768a2d6(param_1 + 0x49f);
  FUN_6768046a(param_1 + 0x488);
  FUN_67685503(param_1 + 0x2ba);
  param_1[0x1a4] = &PTR_LAB_676b9950;
  param_1[0x19c] = &PTR_LAB_676b9950;
  FUN_676ae3e2(param_1 + 400);
  FUN_676ae3e2(param_1 + 0x189);
  return;
}



// Function: FUN_6767cda5 at 6767cda5

/* WARNING: Type propagation algorithm not settling */

void __thiscall FUN_6767cda5(void *this,undefined4 param_1,void *param_2)

{
  bool bVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  int iVar4;
  short *psVar5;
  undefined ***pppuVar6;
  short local_45c [261];
  short asStack_252 [2];
  undefined4 local_24e [130];
  undefined4 local_44 [8];
  undefined **local_24 [8];
  
  FUN_6767e4b6(this,param_2);
  asStack_252[1] = 0;
  puVar3 = local_24e;
  for (iVar4 = 0x82; iVar4 != 0; iVar4 = iVar4 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  FUN_676ae1fc(asStack_252 + 1,(short *)((int)this + 0x212));
  if (asStack_252[1] == 0) goto LAB_6767ce50;
  if (&stack0x00000000 == (undefined1 *)0x250) {
LAB_6767ce3d:
    FUN_676ae272(asStack_252 + 1,(short *)&DAT_676c057c);
  }
  else {
    iVar4 = FUN_676ae2a4(asStack_252 + 1);
    if (iVar4 == 0) goto LAB_6767ce3d;
    iVar4 = FUN_676ae2a4(asStack_252 + 1);
    if (asStack_252[iVar4] != 0x5c) {
      iVar4 = FUN_676ae2a4(asStack_252 + 1);
      if (asStack_252[iVar4] != 0x2f) goto LAB_6767ce3d;
    }
  }
LAB_6767ce50:
  iVar4 = FUN_676ae2a4(asStack_252 + 1);
  psVar5 = (short *)((int)local_24e + iVar4 * 2 + -2);
  if (*(char *)((int)this + 0x6b8) == '\0') {
    FUN_676ac8da(*(short **)((int)param_2 + 0x16c),(short *)0x0,(short *)0x0,local_45c);
    FUN_676ae229(psVar5,local_45c,0x104 - iVar4);
  }
  else {
    FUN_676ae229(psVar5,*(short **)((int)param_2 + 0x16c),0x104 - iVar4);
  }
  psVar5 = asStack_252 + 1;
  if (&stack0x00000000 == (undefined1 *)0x250) {
    psVar5 = (short *)&DAT_676c509c;
  }
  Ordinal_6(*(undefined4 *)((int)param_2 + 0x170));
  uVar2 = Ordinal_2(psVar5);
  *(undefined4 *)((int)param_2 + 0x170) = uVar2;
  if (*(int *)((int)param_2 + 0x4c) == 0) {
    if (*(char *)((int)this + 0x65e) != '\0') {
      bVar1 = FUN_6767d0e4((int)param_2);
      if (bVar1) {
        *(undefined4 *)((int)param_2 + 0x4c) = 2;
        goto LAB_6767cf86;
      }
    }
    if (*(char *)((int)this + 0x6b9) != '\0') {
      bVar1 = FUN_6767d0e4((int)param_2);
      if (!bVar1) {
        *(undefined4 *)((int)param_2 + 0x4c) = 3;
        goto LAB_6767cf86;
      }
    }
    bVar1 = FUN_6767d0e4((int)param_2);
    if ((bVar1) && (*(char *)((int)this + 0x65f) != '\0')) {
      local_24[0] = &PTR_LAB_676b9950;
      FUN_6767d089((int)local_24);
      uVar2 = FUN_676abd4e(local_24,*(LPCWSTR *)((int)param_2 + 0x170),0);
      if ((char)uVar2 != '\0') {
        pppuVar6 = local_24;
        puVar3 = FUN_6767d0b1(param_2,local_44);
        uVar2 = FUN_6767cf97(puVar3,(int)pppuVar6);
        if ((char)uVar2 == '\0') {
          *(undefined4 *)((int)param_2 + 0x4c) = 4;
        }
      }
    }
  }
LAB_6767cf86:
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767cf97 at 6767cf97

undefined4 __thiscall FUN_6767cf97(void *this,int param_1)

{
  undefined4 uVar1;
  
  uVar1 = FUN_6767cfc1(this,param_1);
  if (((char)uVar1 == '\0') && (uVar1 = FUN_6767d035(this,param_1), (char)uVar1 == '\0')) {
    return 1;
  }
  return 0;
}



// Function: FUN_6767cfc1 at 6767cfc1

undefined4 __thiscall FUN_6767cfc1(void *this,int param_1)

{
  undefined4 uVar1;
  
  if ((*(ushort *)((int)this + 8) < *(ushort *)(param_1 + 8)) ||
     ((*(ushort *)((int)this + 8) == *(ushort *)(param_1 + 8) &&
      ((*(ushort *)((int)this + 10) < *(ushort *)(param_1 + 10) ||
       ((*(ushort *)((int)this + 10) == *(ushort *)(param_1 + 10) &&
        ((*(ushort *)((int)this + 0xe) < *(ushort *)(param_1 + 0xe) ||
         ((*(ushort *)((int)this + 0xe) == *(ushort *)(param_1 + 0xe) &&
          ((*(ushort *)((int)this + 0x10) < *(ushort *)(param_1 + 0x10) ||
           ((*(ushort *)((int)this + 0x10) == *(ushort *)(param_1 + 0x10) &&
            ((*(ushort *)((int)this + 0x12) < *(ushort *)(param_1 + 0x12) ||
             ((*(ushort *)((int)this + 0x12) == *(ushort *)(param_1 + 0x12) &&
              ((*(ushort *)((int)this + 0x14) < *(ushort *)(param_1 + 0x14) ||
               ((*(ushort *)((int)this + 0x14) == *(ushort *)(param_1 + 0x14) &&
                (*(ushort *)((int)this + 0x16) < *(ushort *)(param_1 + 0x16)))))))))))))))))))))))))
  {
    uVar1 = 1;
  }
  else {
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6767d035 at 6767d035

undefined4 __thiscall FUN_6767d035(void *this,int param_1)

{
  undefined4 uVar1;
  
  if ((((*(short *)((int)this + 8) == *(short *)(param_1 + 8)) &&
       (*(short *)((int)this + 10) == *(short *)(param_1 + 10))) &&
      (*(short *)((int)this + 0xe) == *(short *)(param_1 + 0xe))) &&
     (((*(short *)((int)this + 0x10) == *(short *)(param_1 + 0x10) &&
       (*(short *)((int)this + 0x12) == *(short *)(param_1 + 0x12))) &&
      ((*(short *)((int)this + 0x14) == *(short *)(param_1 + 0x14) &&
       (*(short *)((int)this + 0x16) == *(short *)(param_1 + 0x16))))))) {
    uVar1 = 1;
  }
  else {
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6767d089 at 6767d089

void __fastcall FUN_6767d089(int param_1)

{
  int iVar1;
  
  GetLocalTime((LPSYSTEMTIME)(param_1 + 8));
  iVar1 = Ordinal_184((LPSYSTEMTIME)(param_1 + 8),(undefined8 *)(param_1 + 0x18));
  if (iVar1 == 0) {
    *(undefined8 *)(param_1 + 0x18) = 0x4000000000000000;
  }
  return;
}



// Function: FUN_6767d0b1 at 6767d0b1

undefined4 * __thiscall FUN_6767d0b1(void *this,undefined4 *param_1)

{
  *param_1 = &PTR_LAB_676b9950;
  FUN_676b06d0(param_1 + 2,(undefined4 *)((int)this + 0x1e8),0x10);
  *(undefined8 *)(param_1 + 6) = *(undefined8 *)((int)this + 0x1f8);
  return param_1;
}



// Function: FUN_6767d0e4 at 6767d0e4

bool __fastcall FUN_6767d0e4(int param_1)

{
  HANDLE hFindFile;
  _WIN32_FIND_DATAW local_250;
  
  hFindFile = FUN_676aee00(*(LPCWSTR *)(param_1 + 0x170),&local_250);
  if (hFindFile != (HANDLE)0xffffffff) {
    FindClose(hFindFile);
  }
  return hFindFile != (HANDLE)0xffffffff;
}



// Function: FUN_6767d116 at 6767d116

uint __thiscall FUN_6767d116(void *this,void *param_1,int *param_2)

{
  uint *puVar1;
  char cVar2;
  undefined4 *puVar3;
  undefined4 *this_00;
  undefined4 uVar4;
  uint uVar5;
  BOOL BVar6;
  int iVar7;
  WCHAR *pWVar8;
  int *this_01;
  undefined4 local_564 [92];
  undefined4 local_3f4;
  WCHAR local_354;
  undefined4 local_352 [130];
  undefined4 local_148 [8];
  undefined4 local_128 [8];
  undefined4 local_108 [55];
  undefined4 local_2c;
  ushort local_26;
  undefined **local_24;
  byte *local_20;
  undefined1 local_1c;
  ushort local_18;
  ushort local_16;
  ushort local_14;
  ushort local_12;
  ushort local_10;
  ushort local_e;
  void *local_c;
  undefined4 local_8;
  
  this_01 = param_2;
  FUN_67689c05(param_2,*(int *)((int)this + 0x668),*(int *)((int)this + 0x66c));
  FUN_6767d4d0(this_01,(LPCSTR)((int)this + 0x41a),'\x01');
  FUN_6767e4b6(this,this_01);
  if ((*(char *)((int)this + 0x15d0) != '\0') && (this_01[0x13] == 0)) {
    local_c = (void *)FUN_67689ce0((void *)((int)this + 0xae8),this_01);
    if (local_c == (void *)0x0) {
      if (*(char *)((int)this + 0x6b9) != '\0') {
        this_01[0x13] = 3;
      }
    }
    else {
      if (*(char *)((int)this + 0x65e) == '\0') {
        if (*(char *)((int)this + 0x65f) != '\0') {
          puVar3 = FUN_6767d0b1(local_c,local_128);
          this_00 = FUN_6767d0b1(this_01,local_148);
          uVar4 = FUN_6767cf97(this_00,(int)puVar3);
          if ((char)uVar4 == '\0') {
            this_01[0x13] = 4;
            goto LAB_6767d333;
          }
        }
        if ((*(char *)((int)this + 0x6ba) != '\0') &&
           (iVar7 = FUN_676acf3e((short *)this_01[0x5c],&local_12,&local_16,&local_18,
                                 (undefined2 *)((int)&local_8 + 2)), iVar7 != 0)) {
          FUN_67688cb7(local_564,(int)local_c);
          local_354 = L'\0';
          puVar3 = local_352;
          for (iVar7 = 0x82; iVar7 != 0; iVar7 = iVar7 + -1) {
            *puVar3 = 0;
            puVar3 = puVar3 + 1;
          }
          pWVar8 = (WCHAR *)&DAT_676c509c;
          FUN_676acb57(&local_354,(short *)&DAT_676c509c);
          if (&stack0x00000000 != (undefined1 *)0x354) {
            pWVar8 = &local_354;
          }
          Ordinal_6(local_3f4);
          local_3f4 = Ordinal_2(pWVar8);
          local_2c = *(undefined4 *)((int)param_1 + 0x14);
          *(undefined4 *)((int)param_1 + 0x14) = 0;
          *(undefined4 *)((int)param_1 + 4) = 0;
          *(undefined4 *)((int)param_1 + 8) = 0;
          uVar4 = FUN_67685eff((void *)((int)this + 0xae8),param_1,local_564,'\x01',
                               (undefined ***)0x0);
          if (((char)uVar4 == '\0') && (*(int *)((int)param_1 + 8) == 0x4000000)) {
            uVar5 = FUN_67688c3b(local_564);
            goto LAB_6767d49c;
          }
          *(undefined4 *)((int)param_1 + 4) = 0;
          *(undefined4 *)((int)param_1 + 0x14) = local_2c;
          *(undefined4 *)((int)param_1 + 8) = 0;
          iVar7 = FUN_676acf3e(&local_354,&local_26,&local_e,&local_10,&local_14);
          if ((iVar7 != 0) &&
             ((((local_26 < local_12 || ((local_26 == local_12 && (local_e < local_16)))) ||
               ((local_e == local_16 && (local_10 < local_18)))) ||
              ((local_10 == local_18 && (local_14 < local_8._2_2_)))))) {
            param_2[0x13] = 5;
          }
          FUN_676af551(&local_354);
          FUN_67688c3b(local_564);
          this_01 = param_2;
        }
      }
      else {
        this_01[0x13] = 2;
      }
LAB_6767d333:
      if (this_01[0x13] == 0) {
        if (*(char *)((int)this + 0x6bb) == '\0') {
          this_01[0x13] = 0xf;
        }
        else {
          this_01[0x18] = (int)local_c;
        }
      }
    }
  }
  if ((*(char *)((int)this + 0x15d1) == '\0') || (this_01[0x13] != 0)) {
LAB_6767d4bf:
                    /* WARNING: Load size is inaccurate */
    uVar5 = (**(code **)(*this + 0x60))(param_1);
    return uVar5;
  }
  local_8 = FUN_676aeee9((LPCWSTR)this_01[0x5c],0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0x8000000,
                         (HANDLE)0x0);
  if (local_8 == (HANDLE)0xffffffff) {
    uVar5 = FUN_6767ca9c(param_1,0x67,0x2000000);
  }
  else {
    local_20 = (byte *)0x0;
    local_1c = 0;
    local_24 = &PTR_FUN_676b99c4;
    FUN_6767e657(&local_24,0x8000);
    param_2 = (int *)0x1;
    FUN_6767e702(local_108);
    FUN_6767e81f(local_108,*(int *)((int)this + 0x66c));
    FUN_6767e856(local_108,*(int *)((int)this + 0x668));
    do {
      if ((param_2 == (int *)0x0) ||
         (BVar6 = ReadFile(local_8,local_20,0x8000,(LPDWORD)&param_2,(LPOVERLAPPED)0x0), BVar6 == 0)
         ) {
        CloseHandle(local_8);
        FUN_6767e796(local_108);
        local_24 = &PTR_FUN_676b99c4;
        FUN_6767e692((int)&local_24);
        goto LAB_6767d4bf;
      }
      local_c = (void *)0x0;
      iVar7 = FUN_6767e984(local_108,local_20,(uint)param_2,(void **)0x0,&local_c,
                           param_2 == (int *)0x0);
      if ((999 < iVar7) && (iVar7 < 0x3ef)) {
        FUN_6767ca9c(param_1,0x79,0x2000000);
        break;
      }
      puVar1 = (uint *)((int)this + 0x15d8);
      uVar5 = *puVar1;
      *puVar1 = *puVar1 + (int)local_c;
      *(int *)((int)this + 0x15dc) =
           *(int *)((int)this + 0x15dc) + (uint)CARRY4(uVar5,(uint)local_c);
                    /* WARNING: Load size is inaccurate */
      cVar2 = (**(code **)(*this + 0x60))(param_1);
    } while (cVar2 != '\0');
    CloseHandle(local_8);
    FUN_6767e796(local_108);
    local_24 = &PTR_FUN_676b99c4;
    uVar5 = FUN_6767e692((int)&local_24);
  }
LAB_6767d49c:
  return uVar5 & 0xffffff00;
}



// Function: FUN_6767d4d0 at 6767d4d0

void __thiscall FUN_6767d4d0(void *this,LPCSTR param_1,char param_2)

{
  int iVar1;
  LPSTR lpString1;
  
  if (*(undefined **)((int)this + 0x17c) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)((int)this + 0x17c));
    *(undefined4 *)((int)this + 0x17c) = 0;
  }
  if ((param_1 == (LPCSTR)0x0) || (*param_1 == '\0')) {
    if (param_2 != '\0') {
      *(ushort *)((int)this + 0x14) = *(ushort *)((int)this + 0x14) & 0xfffe;
    }
  }
  else {
    iVar1 = lstrlenA(param_1);
    lpString1 = (LPSTR)operator_new(iVar1 + 1);
    *(LPSTR *)((int)this + 0x17c) = lpString1;
    if (lpString1 != (LPSTR)0x0) {
      lstrcpynA(lpString1,param_1,0x50);
      if (param_2 != '\0') {
        *(byte *)((int)this + 0x14) = *(byte *)((int)this + 0x14) | 1;
      }
    }
  }
  return;
}



// Function: FUN_6767d53b at 6767d53b

void __thiscall FUN_6767d53b(void *this,undefined4 param_1)

{
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767d547 at 6767d547

void __thiscall FUN_6767d547(void *this,undefined4 param_1)

{
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767d553 at 6767d553

bool __thiscall FUN_6767d553(void *this,void *param_1)

{
  bool bVar1;
  
  bVar1 = *(char *)((int)this + 8) == '\0';
  if (!bVar1) {
    FUN_6767ca9c(param_1,0x206,0x4000000);
  }
  return bVar1;
}



// Function: FUN_6767d58d at 6767d58d

void __thiscall FUN_6767d58d(void *this,undefined4 param_1)

{
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767d599 at 6767d599

void __thiscall FUN_6767d599(void *this,undefined4 param_1)

{
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767d5a5 at 6767d5a5

void __thiscall FUN_6767d5a5(void *this,undefined4 param_1,undefined4 param_2,undefined1 *param_3)

{
  *param_3 = 0;
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767d5b8 at 6767d5b8

void __thiscall
FUN_6767d5b8(void *this,undefined4 param_1,undefined4 param_2,undefined4 *param_3,
            undefined4 *param_4,undefined1 *param_5)

{
  *param_3 = 0;
  *param_4 = 0;
  *param_5 = 1;
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767d5d9 at 6767d5d9

void __thiscall FUN_6767d5d9(void *this,undefined4 param_1)

{
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767d5e5 at 6767d5e5

void __thiscall FUN_6767d5e5(void *this,undefined4 param_1)

{
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767d5f1 at 6767d5f1

void __thiscall FUN_6767d5f1(void *this,undefined4 param_1,undefined4 param_2,undefined1 *param_3)

{
  *param_3 = 0;
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767d604 at 6767d604

void __thiscall FUN_6767d604(void *this,undefined4 param_1)

{
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767d610 at 6767d610

void __thiscall FUN_6767d610(void *this,undefined4 param_1)

{
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767d61c at 6767d61c

void __thiscall FUN_6767d61c(void *this,undefined4 param_1)

{
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767d628 at 6767d628

void __thiscall FUN_6767d628(void *this,undefined4 param_1)

{
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767d634 at 6767d634

void __thiscall FUN_6767d634(void *this,undefined4 param_1,undefined4 param_2,uint *param_3)

{
  *param_3 = -(uint)(*(char *)((int)this + 0xad8) != '\0') & 2;
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767d653 at 6767d653

void __thiscall FUN_6767d653(void *this,undefined4 param_1)

{
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767d65f at 6767d65f

void __thiscall
FUN_6767d65f(void *this,undefined4 param_1,int param_2,undefined1 *param_3,uint param_4,int param_5,
            int *param_6)

{
  if ((param_5 == 0) && (param_4 < *(uint *)((int)this + 0xae0))) {
    *param_3 = 1;
  }
  else if (param_2 == 0) {
    *param_6 = *(int *)((int)this + 0xadc);
  }
  else {
    *param_6 = 0;
  }
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767d6b3 at 6767d6b3

void __thiscall FUN_6767d6b3(void *this,undefined4 param_1)

{
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767d6bf at 6767d6bf

void __thiscall FUN_6767d6bf(void *this,undefined4 param_1,int *param_2)

{
  short *psVar1;
  int *this_00;
  void *this_01;
  undefined4 *puVar2;
  undefined4 *this_02;
  undefined4 uVar3;
  int iVar4;
  short local_45c [261];
  short sStack_252;
  undefined1 local_250 [2];
  undefined4 local_24e [130];
  undefined4 local_44 [8];
  undefined4 local_24 [8];
  
  this_00 = param_2;
  FUN_6767e4b6(this,param_2);
  local_250 = (undefined1  [2])0x0;
  puVar2 = local_24e;
  for (iVar4 = 0x82; iVar4 != 0; iVar4 = iVar4 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  FUN_676ae1fc((short *)local_250,(short *)((int)this + 0x212));
  if (local_250 == (undefined1  [2])0x0) goto LAB_6767d76a;
  if (&stack0x00000000 != (undefined1 *)0x250) {
    iVar4 = FUN_676ae2a4((short *)local_250);
    if (iVar4 != 0) {
      iVar4 = FUN_676ae2a4((short *)local_250);
      if ((&sStack_252)[iVar4] == 0x5c) goto LAB_6767d76a;
      iVar4 = FUN_676ae2a4((short *)local_250);
      if ((&sStack_252)[iVar4] == 0x2f) goto LAB_6767d76a;
    }
  }
  FUN_676ae272((short *)local_250,(short *)&DAT_676c057c);
LAB_6767d76a:
  iVar4 = FUN_676ae2a4((short *)local_250);
  psVar1 = (short *)((int)local_24e + iVar4 * 2 + -2);
  if (*(char *)((int)this + 0x6b8) == '\0') {
    FUN_676ac8da((short *)param_2[0x5b],(short *)0x0,(short *)0x0,local_45c);
    FUN_676ae229(psVar1,local_45c,0x104 - iVar4);
  }
  else {
    FUN_676ae229(psVar1,(short *)param_2[0x5b],0x104 - iVar4);
  }
  if (&stack0x00000000 == (undefined1 *)0x250) {
    param_2 = (int *)&DAT_676c509c;
  }
  else {
    param_2 = (int *)local_250;
  }
  Ordinal_6(this_00[0x5c]);
  iVar4 = Ordinal_2(param_2);
  this_00[0x5c] = iVar4;
  if (this_00[0x13] == 0) {
    this_01 = (void *)FUN_67689ce0((void *)((int)this + 0xae8),this_00);
    if (this_01 == (void *)0x0) {
      if (*(char *)((int)this + 0x6b9) != '\0') {
        this_00[0x13] = 3;
      }
    }
    else {
      if (*(char *)((int)this + 0x65e) == '\0') {
        if (*(char *)((int)this + 0x65f) != '\0') {
          puVar2 = FUN_6767d0b1(this_01,local_44);
          this_02 = FUN_6767d0b1(this_00,local_24);
          uVar3 = FUN_6767cf97(this_02,(int)puVar2);
          if ((char)uVar3 == '\0') {
            this_00[0x13] = 4;
          }
        }
      }
      else {
        this_00[0x13] = 2;
      }
      if ((this_00[0x13] == 0) && (*(char *)((int)this + 0x6bb) == '\0')) {
        this_00[0x13] = 0xf;
      }
    }
  }
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_6767d8a6 at 6767d8a6

void __thiscall FUN_6767d8a6(void *this,undefined1 param_1,int *param_2)

{
  uint uVar1;
  uint3 uVar2;
  char cVar3;
  uint uVar4;
  undefined3 uVar6;
  undefined4 uVar5;
  undefined **local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  uint local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  local_28 = &PTR_LAB_676b99c8;
  local_c = 0x20e;
  local_8 = 0x20f;
  local_10 = -(uint)(this != (void *)0x0) & (int)this + 4U;
                    /* WARNING: Load size is inaccurate */
  local_24 = 0;
  local_20 = 0;
  local_1c = 0;
  local_18 = 0;
  local_14 = 0;
  cVar3 = (**(code **)(*this + 0x70))(&local_28);
  if (cVar3 == '\0') {
    FUN_6767e5db((int)&local_28);
  }
  else {
    *(undefined1 *)((int)this + 0x15d1) = param_1;
    uVar1 = *(uint *)((int)this + 0x664);
    uVar2 = (uint3)(uVar1 >> 8);
    uVar4 = CONCAT31(uVar2 >> 4,~(byte)(uVar1 >> 4)) & 0xffffff01;
    uVar6 = (undefined3)(uVar4 >> 8);
    *(undefined4 *)((int)this + 0x15d8) = 0;
    *(undefined1 *)((int)this + 0x15d0) = 0;
    *(undefined4 *)((int)this + 0x15dc) = 0;
    FUN_67680481(&local_28,(LPCWSTR)((int)this + 0x8c8),(int)this + 0x624,
                 (LPCWSTR)((int)this + 0x640),CONCAT31(uVar6,*(undefined1 *)((int)this + 0x65c)),
                 CONCAT31(uVar6,*(undefined1 *)((int)this + 0x6b8)),
                 *(undefined4 *)((int)this + 0xad4),uVar4,
                 (WCHAR *)(CONCAT31(uVar2 >> 3,~(byte)(uVar1 >> 3)) & 0xffffff01));
    *param_2 = *(int *)((int)this + 0x15d8);
    param_2[1] = *(int *)((int)this + 0x15dc);
    *(undefined4 *)((int)this + 0x15d8) = 0;
    *(undefined1 *)((int)this + 0x15d1) = 0;
    *(undefined4 *)((int)this + 0x15dc) = 0;
    uVar5 = FUN_6767e600((int)&local_28);
    if ((char)uVar5 != '\0') {
      (**(code **)(*(int *)((int)this + 0x1220) + 0xc))();
    }
    FUN_6767e5db((int)&local_28);
  }
  return;
}



// Function: FUN_6767d9b7 at 6767d9b7

void __thiscall FUN_6767d9b7(void *this,char param_1,undefined1 *param_2)

{
  char cVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  char cVar5;
  char cVar6;
  undefined **local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  uint local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c [7];
  undefined4 local_20 [7];
  
  local_60 = &PTR_LAB_676b99c8;
  local_44 = 0x20e;
  local_40 = 0x20f;
  local_48 = -(uint)(this != (void *)0x0) & (int)this + 4U;
                    /* WARNING: Load size is inaccurate */
  local_5c = 0;
  local_58 = 0;
  local_54 = 0;
  local_50 = 0;
  local_4c = 0;
  cVar1 = (**(code **)(*this + 0x70))(&local_60);
  if (cVar1 == '\0') {
    FUN_6767e5db((int)&local_60);
  }
  else {
    *(undefined1 *)((int)this + 0xb10) = 1;
    uVar2 = FUN_6768cb57((void *)((int)this + 0xb18),&local_60,(LPCWSTR)((int)this + 10),'\0',
                         (short *)0x0,2,0,'\0');
    if ((char)uVar2 != '\0') {
      if (param_1 == '\0') {
        cVar6 = '\0';
        cVar5 = '\x01';
        cVar1 = '\x01';
        puVar3 = FUN_676ae3ab(local_3c,1);
        puVar4 = FUN_676ae3ab(local_20,1);
        FUN_6768556f((void *)((int)this + 0xae8),&local_60,puVar4,puVar3,cVar1,param_2,cVar5,cVar6);
        FUN_676ae3e2(local_20);
        FUN_676ae3e2(local_3c);
      }
      else {
        FUN_6768556f((void *)((int)this + 0xae8),&local_60,(void *)((int)this + 0x624),
                     (void *)((int)this + 0x640),*(char *)((int)this + 0x65c),param_2,
                     *(char *)((int)this + 0x6b8),
                     ((byte)*(undefined4 *)((int)this + 0x664) & 0x10) == 0x10);
      }
      FUN_6768cd8a((void *)((int)this + 0xb18),&local_60,'\x01');
    }
    (**(code **)(*(int *)((int)this + 0xae8) + 0xc))();
    *(undefined1 *)((int)this + 0xb10) = 0;
    FUN_6767e5db((int)&local_60);
  }
  return;
}



// Function: FUN_6767daee at 6767daee

void __fastcall FUN_6767daee(int *param_1)

{
  int *this;
  uint uVar1;
  int iVar2;
  uint3 uVar3;
  char cVar4;
  bool bVar5;
  undefined4 uVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  uint uVar9;
  undefined3 uVar10;
  int iVar11;
  undefined1 *puVar12;
  char cVar13;
  char cVar14;
  WCHAR local_284 [262];
  undefined4 local_78 [7];
  int local_5c [4];
  undefined4 local_4c [7];
  undefined **local_30;
  undefined4 local_2c;
  int local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  uint local_18;
  undefined4 local_14;
  undefined4 local_10;
  int *local_c;
  char local_5;
  
  local_30 = &PTR_LAB_676b99c8;
  local_14 = 0x20e;
  local_18 = -(uint)(param_1 != (int *)0x0) & (uint)(param_1 + 1);
  local_2c = 0;
  local_28 = 0;
  local_24 = 0;
  local_20 = 0;
  local_10 = 0x20f;
  local_1c = 0;
  cVar4 = (**(code **)(*param_1 + 0x70))(&local_30);
  if (cVar4 == '\0') goto LAB_6767de96;
  if (*(char *)((int)param_1 + 0x6bb) == '\0') {
    local_284[0] = L'\0';
  }
  else {
    FUN_676acb57(local_284,(short *)(param_1 + 0x1b0));
  }
  this = param_1 + 0x2ba;
  param_1[0x485] = param_1[0x19a];
  param_1[0x486] = param_1[0x19b];
  local_c = param_1 + 0x2c6;
  uVar6 = FUN_6768cb57(local_c,&local_30,(LPCWSTR)((int)param_1 + 10),'\x01',local_284,
                       param_1[0x2b4],param_1[0x1af],'\0');
  if ((char)uVar6 != '\0') {
    cVar14 = '\0';
    cVar13 = '\x01';
    puVar12 = (undefined1 *)0x0;
    cVar4 = '\x01';
    puVar7 = FUN_676ae3ab(local_4c,1);
    puVar8 = FUN_676ae3ab(local_78,1);
    bVar5 = FUN_6768556f(this,&local_30,puVar8,puVar7,cVar4,puVar12,cVar13,cVar14);
    FUN_676ae3e2(local_78);
    FUN_676ae3e2(local_4c);
    if (!bVar5) {
      FUN_6768cd8a(local_c,&local_30,'\0');
      if (*(char *)((int)param_1 + 0x6bb) != '\0') {
        FUN_676af551(local_284);
      }
      goto LAB_6767de96;
    }
    if (((short *)param_1[0x4ed] == (short *)0x0) || (*(short *)param_1[0x4ed] == 0)) {
      if ((char)param_1[0x3d1] != '\0') goto LAB_6767dc7e;
    }
    else {
      if ((param_1[0x454] == -1) && ((char)param_1[0x3d1] != '\0')) {
LAB_6767dc7e:
        uVar6 = FUN_6768561f(this,&local_30);
        cVar4 = (char)uVar6;
      }
      else {
        cVar4 = FUN_67685722(this,&local_30,param_1 + 0x49f);
      }
      if (cVar4 == '\0') {
        FUN_6768cd8a(local_c,&local_30,'\0');
        goto LAB_6767de96;
      }
    }
    uVar1 = param_1[0x199];
    *(undefined1 *)(param_1 + 0x574) = 1;
    uVar3 = (uint3)(uVar1 >> 8);
    uVar9 = CONCAT31(uVar3 >> 4,~(byte)(uVar1 >> 4)) & 0xffffff01;
    uVar10 = (undefined3)(uVar9 >> 8);
    uVar6 = FUN_67680481(&local_30,(LPCWSTR)(param_1 + 0x232),(int)(param_1 + 0x189),
                         (LPCWSTR)(param_1 + 400),CONCAT31(uVar10,(char)param_1[0x197]),
                         CONCAT31(uVar10,(char)param_1[0x1ae]),param_1[0x2b5],uVar9,
                         (WCHAR *)(CONCAT31(uVar3 >> 3,~(byte)(uVar1 >> 3)) & 0xffffff01));
    if ((char)uVar6 != '\0') {
      FUN_67689c9b(local_5c);
      local_5 = '\0';
      iVar11 = 0;
      do {
        puVar7 = (undefined4 *)operator_new(0x210);
        if (puVar7 == (undefined4 *)0x0) {
          puVar7 = (undefined4 *)0x0;
        }
        else {
          puVar7 = FUN_67688abc(puVar7);
        }
        if (puVar7 == (undefined4 *)0x0) {
          FUN_6767ca9c(&local_30,0x1ff,0x4000000);
          break;
        }
        puVar7[0x14] = iVar11;
        cVar4 = (**(code **)(*param_1 + 0x18))(&local_30,puVar7,&local_5);
        if ((cVar4 == '\0') || (local_5 == '\0')) {
          if (puVar7 != (undefined4 *)0x0) {
            (**(code **)*puVar7)(1);
          }
          break;
        }
        (**(code **)(local_5c[0] + 0x24))(puVar7);
        iVar11 = puVar7[0x14] + 1;
      } while (local_5 != '\0');
      uVar6 = FUN_6767e600((int)&local_30);
      if ((char)uVar6 == '\0') {
        FUN_67686118(param_1 + 0x2ba,&local_30,param_1 + 0x488,local_5c);
      }
      FUN_67689cc9(local_5c);
    }
    *(undefined1 *)(param_1 + 0x574) = 0;
    FUN_6768cd8a(param_1 + 0x2c6,&local_30,local_28 != 0x4000000);
    if (local_28 == 0x4000000) {
      FUN_6768cdfa(param_1 + 0x2c6,&local_30);
    }
  }
  (**(code **)(param_1[0x2ba] + 0xc))();
  if ((*(char *)((int)param_1 + 0xad9) != '\0') &&
     (uVar6 = FUN_6767e600((int)&local_30), (char)uVar6 == '\0')) {
    (**(code **)(*param_1 + 0x54))(1);
    iVar11 = FUN_6767e148(param_1,'\x01');
    (**(code **)(*param_1 + 0x54))(0);
    if (iVar11 == 0) {
      for (iVar11 = (**(code **)(param_1[0x488] + 0x2c))(); iVar11 != 0;
          iVar11 = (**(code **)(param_1[0x488] + 0x34))(iVar11)) {
        iVar2 = *(int *)(iVar11 + 0x4c);
        if (((iVar2 < 1) || (0xf < iVar2)) && ((iVar2 < 100 || (0x7a < iVar2)))) {
          cVar4 = (**(code **)(*param_1 + 0x4c))(&local_30,iVar11);
          if (cVar4 == '\0') break;
          iVar2 = *(int *)(iVar11 + 0x4c);
          if (((iVar2 < 1) || (0xf < iVar2)) && ((iVar2 < 100 || (0x7a < iVar2)))) {
            FUN_676af551(*(LPCWSTR *)(iVar11 + 0x170));
          }
        }
      }
    }
  }
  (**(code **)(param_1[0x488] + 0xc))();
LAB_6767de96:
  FUN_6767e5db((int)&local_30);
  return;
}



// Function: FUN_6767dea3 at 6767dea3

void __fastcall FUN_6767dea3(int *param_1)

{
  char cVar1;
  bool bVar2;
  undefined4 uVar3;
  undefined **local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  uint local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  local_28 = &PTR_LAB_676b99c8;
  local_c = 0x20e;
  local_8 = 0x20f;
  local_10 = -(uint)(param_1 != (int *)0x0) & (uint)(param_1 + 1);
  local_24 = 0;
  local_20 = 0;
  local_1c = 0;
  local_18 = 0;
  local_14 = 0;
  cVar1 = (**(code **)(*param_1 + 0x70))(&local_28);
  if (cVar1 != '\0') {
    *(undefined1 *)(param_1 + 0x2c4) = 1;
    uVar3 = FUN_6768cb57(param_1 + 0x2c6,&local_28,(LPCWSTR)((int)param_1 + 10),'\0',(short *)0x0,2,
                         0,'\0');
    if ((char)uVar3 != '\0') {
      bVar2 = FUN_6768556f(param_1 + 0x2ba,&local_28,param_1 + 0x189,param_1 + 400,
                           (char)param_1[0x197],(undefined1 *)0x0,(char)param_1[0x1ae],
                           ((byte)param_1[0x199] & 0x10) == 0x10);
      if (bVar2) {
        FUN_676859ae(param_1 + 0x2ba,&local_28,*(char *)((int)param_1 + 0x6ba),0);
      }
      FUN_6768cd8a(param_1 + 0x2c6,&local_28,'\x01');
    }
    (**(code **)(param_1[0x2ba] + 0xc))();
    *(undefined1 *)(param_1 + 0x2c4) = 0;
  }
  FUN_6767e5db((int)&local_28);
  return;
}



// Function: FUN_6767dfa0 at 6767dfa0

void __fastcall FUN_6767dfa0(int *param_1)

{
  int *this;
  char cVar1;
  bool bVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  uint uVar6;
  undefined1 *puVar7;
  char cVar8;
  char cVar9;
  WCHAR local_270 [262];
  undefined4 local_64 [7];
  undefined4 local_48 [7];
  undefined **local_2c;
  undefined4 local_28;
  int local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  uint local_14;
  undefined4 local_10;
  undefined4 local_c;
  uint local_8;
  
  local_2c = &PTR_LAB_676b99c8;
  local_14 = -(uint)(param_1 != (int *)0x0) & (uint)(param_1 + 1);
  local_28 = 0;
  local_24 = 0;
  local_20 = 0;
  local_1c = 0;
  local_10 = 0x20e;
  local_c = 0x20f;
  local_18 = 0;
  cVar1 = (**(code **)(*param_1 + 0x70))(&local_2c);
  if (cVar1 == '\0') {
    FUN_6767e5db((int)&local_2c);
  }
  else {
    *(undefined1 *)(param_1 + 0x2c4) = 1;
    if (*(char *)((int)param_1 + 0x6bb) == '\0') {
      local_270[0] = L'\0';
    }
    else {
      FUN_676acb57(local_270,(short *)(param_1 + 0x1b0));
    }
    uVar3 = FUN_6768cb57(param_1 + 0x2c6,&local_2c,(LPCWSTR)((int)param_1 + 10),'\x01',local_270,
                         param_1[0x2b4],param_1[0x1af],'\0');
    if ((char)uVar3 != '\0') {
      local_8 = local_8 & 0xffffff00;
      cVar9 = '\0';
      cVar8 = '\x01';
      puVar7 = (undefined1 *)0x0;
      cVar1 = '\x01';
      this = param_1 + 0x2ba;
      puVar4 = FUN_676ae3ab(local_48,1);
      puVar5 = FUN_676ae3ab(local_64,1);
      bVar2 = FUN_6768556f(this,&local_2c,puVar5,puVar4,cVar1,puVar7,cVar8,cVar9);
      FUN_676ae3e2(local_64);
      FUN_676ae3e2(local_48);
      if ((char)-bVar2 == -1) {
        if ((char)param_1[0x3d1] == (char)(-bVar2 + '\x01')) {
          FUN_6767ca9c(&local_2c,0x1fd,0x4000000);
        }
        else {
          uVar3 = FUN_6768561f(this,&local_2c);
          if ((char)uVar3 != '\0') {
            uVar6 = FUN_676862b1(this,&local_2c,param_1 + 0x189,param_1 + 400,
                                 CONCAT31((int3)((uint)uVar3 >> 8),(char)param_1[0x197]));
            if ((char)uVar6 != '\0') {
              local_8 = CONCAT31(local_8._1_3_,1);
            }
          }
        }
      }
      FUN_6768cd8a(param_1 + 0x2c6,&local_2c,(char)local_8);
      if (local_24 == 0x4000000) {
        FUN_6768cdfa(param_1 + 0x2c6,&local_2c);
      }
    }
    (**(code **)(param_1[0x2ba] + 0xc))();
    *(undefined1 *)(param_1 + 0x2c4) = 0;
    FUN_6767e5db((int)&local_2c);
  }
  return;
}



// Function: FUN_6767e148 at 6767e148

void __thiscall FUN_6767e148(void *this,char param_1)

{
  char cVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  undefined1 *puVar5;
  char cVar6;
  char cVar7;
  undefined **local_64;
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  uint local_4c;
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40 [7];
  undefined4 local_24 [7];
  char local_5;
  
  local_64 = &PTR_LAB_676b99c8;
  local_48 = 0x20e;
  local_44 = 0x20f;
  local_4c = -(uint)(this != (void *)0x0) & (int)this + 4U;
                    /* WARNING: Load size is inaccurate */
  local_60 = 0;
  local_5c = 0;
  local_58 = 0;
  local_54 = 0;
  local_50 = 0;
  cVar1 = (**(code **)(*this + 0x70))(&local_64);
  if (cVar1 != '\0') {
    *(undefined1 *)((int)this + 0xb10) = 1;
    uVar2 = FUN_6768cb57((void *)((int)this + 0xb18),&local_64,(LPCWSTR)((int)this + 10),'\0',
                         (short *)0x0,2,0,'\0');
    if ((char)uVar2 != '\0') {
      cVar1 = *(char *)((int)this + 0x65c);
      cVar7 = '\0';
      cVar6 = '\x01';
      puVar5 = (undefined1 *)0x0;
      puVar3 = FUN_676ae3ab(local_40,1);
      puVar4 = FUN_676ae3ab(local_24,1);
      local_5 = FUN_6768556f((void *)((int)this + 0xae8),&local_64,puVar4,puVar3,cVar1,puVar5,cVar6,
                             cVar7);
      FUN_676ae3e2(local_24);
      FUN_676ae3e2(local_40);
      if (local_5 != '\0') {
        FUN_676859ae((void *)((int)this + 0xae8),&local_64,'\0',(param_1 == '\0') + 1);
      }
      FUN_6768cd8a((void *)((int)this + 0xb18),&local_64,'\x01');
    }
    (**(code **)(*(int *)((int)this + 0xae8) + 0xc))();
    *(undefined1 *)((int)this + 0xb10) = 0;
  }
  FUN_6767e5db((int)&local_64);
  return;
}



// Function: FUN_6767e253 at 6767e253

int __thiscall FUN_6767e253(void *this,LPCWSTR param_1)

{
  int *this_00;
  char cVar1;
  bool bVar2;
  int iVar3;
  undefined4 uVar4;
  int local_98c [10];
  undefined1 local_964;
  undefined1 local_95c [1800];
  WCHAR local_254 [262];
  undefined4 local_48 [7];
  undefined **local_2c;
  undefined4 local_28;
  int local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  uint local_14;
  undefined4 local_10;
  undefined4 local_c;
  void *local_8;
  
  local_2c = &PTR_LAB_676b99c8;
  local_10 = 0x20e;
  local_c = 0x20f;
  local_14 = -(uint)(this != (void *)0x0) & (int)this + 4U;
                    /* WARNING: Load size is inaccurate */
  local_28 = 0;
  local_24 = 0;
  local_20 = 0;
  local_1c = 0;
  local_18 = 0;
  cVar1 = (**(code **)(*this + 0x70))(&local_2c);
  if (cVar1 == '\0') {
    iVar3 = FUN_6767e5db((int)&local_2c);
    return iVar3;
  }
  FUN_676ae3ab(local_48,1);
  if (*(char *)((int)this + 0x6bb) == '\0') {
    local_254[0] = L'\0';
  }
  else {
    FUN_676acb57(local_254,(short *)((int)this + 0x6c0));
  }
  this_00 = (int *)((int)this + 0xae8);
  *(undefined4 *)((int)this + 0x1214) = *(undefined4 *)((int)this + 0x668);
  *(undefined4 *)((int)this + 0x1218) = *(undefined4 *)((int)this + 0x66c);
  local_8 = (void *)((int)this + 0xb18);
  uVar4 = FUN_6768cb57(local_8,&local_2c,param_1,'\x01',local_254,*(int *)((int)this + 0xad0),
                       *(undefined4 *)((int)this + 0x6bc),'\0');
  if ((char)uVar4 == '\0') goto LAB_6767e44f;
  bVar2 = FUN_6768556f(this_00,&local_2c,local_48,local_48,'\x01',(undefined1 *)0x0,'\x01','\0');
  if (bVar2) {
    FUN_67685419(local_98c,this);
    local_964 = 1;
    uVar4 = FUN_6768cb57(local_95c,&local_2c,(LPCWSTR)((int)this + 10),'\0',(short *)0x0,2,0,'\0');
    if ((char)uVar4 != '\0') {
      bVar2 = FUN_6768556f(local_98c,&local_2c,local_48,local_48,'\x01',(undefined1 *)0x0,'\x01',
                           '\0');
      if (bVar2) {
        if ((*(short **)((int)this + 0x13b4) == (short *)0x0) ||
           (**(short **)((int)this + 0x13b4) == 0)) {
          if (*(char *)((int)this + 0xf44) != '\0') goto LAB_6767e3e4;
        }
        else {
          if ((*(int *)((int)this + 0x1150) == -1) && (*(char *)((int)this + 0xf44) != '\0')) {
LAB_6767e3e4:
            uVar4 = FUN_6768561f(this_00,&local_2c);
            cVar1 = (char)uVar4;
          }
          else {
            cVar1 = FUN_67685722(this_00,&local_2c,(void *)((int)this + 0x127c));
          }
          if (cVar1 == '\0') goto LAB_6767e40b;
        }
        FUN_676864b7(this_00,&local_2c,local_98c,*(undefined4 *)((int)this + 0xad4));
      }
LAB_6767e40b:
      FUN_6768cd8a(local_95c,&local_2c,'\0');
    }
    FUN_67685503(local_98c);
  }
  FUN_6768cd8a(local_8,&local_2c,local_24 != 0x4000000);
  if (local_24 == 0x4000000) {
    FUN_6768cdfa(local_8,&local_2c);
  }
LAB_6767e44f:
  (**(code **)(*this_00 + 0xc))();
  iVar3 = FUN_6767e5db((int)&local_2c);
  FUN_676ae3e2(local_48);
  return iVar3;
}



// Function: FUN_6767e471 at 6767e471

uint __thiscall FUN_6767e471(void *this,void *param_1)

{
  int iVar1;
  uint uVar2;
  
  iVar1 = (**(code **)(*(int *)((int)this + 0xae8) + 0x3c))();
  if (iVar1 == 0) {
    if (*(char *)((int)this + 8) == '\0') {
      return 1;
    }
    iVar1 = 0x206;
  }
  else {
    iVar1 = 999;
  }
  uVar2 = FUN_6767ca9c(param_1,iVar1,0x4000000);
  return uVar2 & 0xffffff00;
}



// Function: FUN_6767e4b6 at 6767e4b6

void __thiscall FUN_6767e4b6(void *this,void *param_1)

{
  uint uVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  undefined4 local_24 [8];
  
  if ((param_1 != (void *)0x0) && (*(int *)((int)param_1 + 0x4c) == 0)) {
    uVar1 = *(uint *)((int)this + 0x660);
    if ((uVar1 == 0) || ((*(uint *)((int)param_1 + 0x34) & uVar1) == uVar1)) {
      if ((*(uint *)((int)this + 0x664) == 0) ||
         ((*(uint *)((int)param_1 + 0x34) & *(uint *)((int)this + 0x664)) == 0)) {
        puVar2 = FUN_6767d0b1(param_1,local_24);
        uVar3 = FUN_6767cf97((void *)((int)this + 0x670),(int)puVar2);
        if ((char)uVar3 == '\0') {
          puVar2 = FUN_6767d0b1(param_1,local_24);
          uVar3 = FUN_6767cfc1((void *)((int)this + 0x690),(int)puVar2);
          if ((char)uVar3 == '\0') {
            if ((*(int *)((int)param_1 + 0x2c) == 0) &&
               (*(uint *)((int)param_1 + 0x28) < *(uint *)((int)this + 0x6b0))) {
              *(undefined4 *)((int)param_1 + 0x4c) = 10;
            }
            else if ((*(uint *)((int)this + 0x6b4) != 0) &&
                    ((*(int *)((int)param_1 + 0x2c) != 0 ||
                     (*(uint *)((int)this + 0x6b4) < *(uint *)((int)param_1 + 0x28))))) {
              *(undefined4 *)((int)param_1 + 0x4c) = 0xb;
            }
          }
          else {
            *(undefined4 *)((int)param_1 + 0x4c) = 9;
          }
        }
        else {
          *(undefined4 *)((int)param_1 + 0x4c) = 8;
        }
      }
      else {
        *(undefined4 *)((int)param_1 + 0x4c) = 7;
      }
    }
    else {
      *(undefined4 *)((int)param_1 + 0x4c) = 6;
    }
  }
  return;
}



// Function: FUN_6767e5db at 6767e5db

int __fastcall FUN_6767e5db(int param_1)

{
  int iVar1;
  
  if (((*(int *)(param_1 + 0x10) != 0x1000000) || (iVar1 = *(int *)(param_1 + 0x1c), iVar1 == 0)) &&
     ((*(int *)(param_1 + 0x10) != 0x2000000 || (iVar1 = *(int *)(param_1 + 0x20), iVar1 == 0)))) {
    iVar1 = *(int *)(param_1 + 0xc);
  }
  return iVar1;
}



// Function: FUN_6767e600 at 6767e600

undefined4 __fastcall FUN_6767e600(int param_1)

{
  if ((*(int *)(param_1 + 8) != 0x2000000) && (*(int *)(param_1 + 8) != 0x4000000)) {
    return 0;
  }
  return 1;
}



// Function: FUN_6767e635 at 6767e635

undefined4 * __thiscall FUN_6767e635(void *this,byte param_1)

{
  *(undefined ***)this = &PTR_FUN_676b99c4;
  FUN_6767e692((int)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_6767e657 at 6767e657

void __thiscall FUN_6767e657(void *this,uint param_1)

{
  void *pvVar1;
  
  FUN_6767e692((int)this);
  if (param_1 == 1) {
    pvVar1 = operator_new(1);
    *(void **)((int)this + 4) = pvVar1;
  }
  else {
    if (1 < (int)param_1) {
      pvVar1 = operator_new(param_1);
      *(void **)((int)this + 4) = pvVar1;
      *(undefined1 *)((int)this + 8) = 1;
      return;
    }
    *(undefined4 *)((int)this + 4) = 0;
  }
  *(undefined1 *)((int)this + 8) = 0;
  return;
}



// Function: FUN_6767e692 at 6767e692

void __fastcall FUN_6767e692(int param_1)

{
  if (*(undefined **)(param_1 + 4) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)(param_1 + 4));
  }
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined1 *)(param_1 + 8) = 0;
  return;
}



// Function: FUN_6767e6bb at 6767e6bb

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_6767e6bb(void)

{
  _DAT_676c50b0 = 0;
  _DAT_676c50b4 = 0;
  _DAT_676c50b8 = 0xffffffff;
  _DAT_676c50a8 = &PTR_FUN_676b99cc;
  return;
}



// Function: FUN_6767e6db at 6767e6db

void FUN_6767e6db(void)

{
  FUN_676b0c45(&LAB_6767e6e7);
  return;
}



// Function: FUN_6767e702 at 6767e702

undefined4 * __fastcall FUN_6767e702(undefined4 *param_1)

{
  FUN_6767f7aa(param_1 + 0x2b);
  FUN_6767f7aa(param_1 + 0x31);
  *param_1 = &PTR_FUN_676b99d0;
  param_1[1] = 8;
  param_1[2] = 6;
  param_1[6] = 0;
  *(undefined1 *)(param_1 + 4) = 0;
  *(undefined1 *)((int)param_1 + 0x11) = 0;
  param_1[5] = 0;
  param_1[7] = 0;
  param_1[3] = 1;
  _memset(param_1 + 8,0,0x38);
  _memset(param_1 + 0x16,0,0x20);
  _memset(param_1 + 0x1e,0,0x30);
  *(undefined1 *)(param_1 + 0x2a) = 0;
  return param_1;
}



// Function: FUN_6767e77a at 6767e77a

undefined4 * __thiscall FUN_6767e77a(void *this,byte param_1)

{
  FUN_6767e796((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_6767e796 at 6767e796

void __fastcall FUN_6767e796(undefined4 *param_1)

{
  undefined4 uVar1;
  undefined4 *local_8;
  
  *param_1 = &PTR_FUN_676b99d0;
  local_8 = param_1;
  if (param_1[6] == 1) {
    FUN_6767ecb8((int)param_1);
  }
  else if (param_1[6] == 2) {
    FUN_6767edea((int)param_1);
  }
  if ((undefined *)param_1[5] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[5]);
  }
  while( true ) {
    uVar1 = FUN_6767f8d2(param_1 + 0x2b,&local_8);
    if ((char)uVar1 == '\0') break;
    FUN_676b0bb3((undefined *)local_8);
  }
  while( true ) {
    uVar1 = FUN_6767f8d2(param_1 + 0x31,&local_8);
    if ((char)uVar1 == '\0') break;
    FUN_676b0bb3((undefined *)local_8);
  }
  FUN_6767f841(param_1 + 0x31);
  FUN_6767f841(param_1 + 0x2b);
  return;
}



// Function: FUN_6767e81f at 6767e81f

undefined4 __thiscall FUN_6767e81f(void *this,int param_1)

{
  undefined4 uVar1;
  
  if (*(int *)((int)this + 0x18) == 0) {
    if (param_1 == 0) {
      *(undefined4 *)((int)this + 8) = 0;
    }
    else if ((param_1 < 8) || ((9 < param_1 && (param_1 != 0x12)))) {
      return 0x3ea;
    }
    *(int *)((int)this + 4) = param_1;
    uVar1 = 0;
  }
  else {
    uVar1 = 1000;
  }
  return uVar1;
}



// Function: FUN_6767e856 at 6767e856

undefined4 __thiscall FUN_6767e856(void *this,int param_1)

{
  undefined4 uVar1;
  
  if (*(int *)((int)this + 0x18) == 0) {
    uVar1 = 0;
    *(int *)((int)this + 8) = param_1 % 10;
  }
  else {
    uVar1 = 1000;
  }
  return uVar1;
}



// Function: FUN_6767e877 at 6767e877

undefined4 __thiscall FUN_6767e877(void *this,undefined4 param_1)

{
  undefined4 uVar1;
  
  if (*(int *)((int)this + 0x18) == 0) {
    *(undefined4 *)((int)this + 0xc) = param_1;
    uVar1 = 0;
  }
  else {
    uVar1 = 1000;
  }
  return uVar1;
}



// Function: FUN_6767e890 at 6767e890

undefined4 __thiscall FUN_6767e890(void *this,undefined1 param_1)

{
  undefined4 uVar1;
  
  if (*(int *)((int)this + 0x18) == 0) {
    *(undefined1 *)((int)this + 0x10) = param_1;
    uVar1 = 0;
  }
  else {
    uVar1 = 1000;
  }
  return uVar1;
}



// Function: FUN_6767e8a9 at 6767e8a9

undefined4 __thiscall FUN_6767e8a9(void *this,undefined4 *param_1)

{
  byte bVar1;
  undefined4 uVar2;
  int iVar3;
  LPSTR lpString1;
  undefined3 extraout_var;
  undefined4 *puVar4;
  
  if (*(int *)((int)this + 0x18) == 0) {
    *(undefined1 *)((int)this + 0x11) = 0;
    _memset((void *)((int)this + 0x58),0,0x20);
    if (*(undefined **)((int)this + 0x14) != (undefined *)0x0) {
      FUN_676b0bb3(*(undefined **)((int)this + 0x14));
      *(undefined4 *)((int)this + 0x14) = 0;
    }
    if (((LPCSTR)*param_1 != (LPCSTR)0x0) && (iVar3 = lstrlenA((LPCSTR)*param_1), iVar3 != 0)) {
      lpString1 = (LPSTR)operator_new(iVar3 + 1);
      *(LPSTR *)((int)this + 0x14) = lpString1;
      if (lpString1 == (LPSTR)0x0) {
        return 0x1ff;
      }
      lstrcpyA(lpString1,(LPCSTR)*param_1);
      *(undefined4 *)((int)this + 0x70) = *(undefined4 *)((int)this + 0x14);
      *(undefined2 *)((int)this + 0x74) = *(undefined2 *)(param_1 + 1);
      iVar3 = 0;
      puVar4 = (undefined4 *)((int)param_1 + 6);
      while (*(char *)((int)puVar4 + iVar3) == '\0') {
        iVar3 = iVar3 + 1;
        if (0xb < iVar3) {
          FUN_6767c654((uint *)((int)this + 0x58));
          FUN_676b06d0(puVar4,(undefined4 *)((int)this + 100),0xc);
LAB_6767e950:
          *(undefined1 *)((int)this + 0x11) = 1;
          return 0;
        }
      }
      FUN_676b06d0((undefined4 *)((int)this + 100),puVar4,0xc);
      bVar1 = FUN_6767c781((uint *)((int)this + 0x58));
      if (CONCAT31(extraout_var,bVar1) != 2) goto LAB_6767e950;
    }
    uVar2 = 0x3ec;
  }
  else {
    uVar2 = 1000;
  }
  return uVar2;
}



// Function: FUN_6767e980 at 6767e980

undefined4 __fastcall FUN_6767e980(int param_1)

{
  return *(undefined4 *)(param_1 + 0x1c);
}



// Function: FUN_6767e984 at 6767e984

void __thiscall
FUN_6767e984(void *this,byte *param_1,uint param_2,void **param_3,void **param_4,char param_5)

{
  int extraout_EAX;
  int iVar1;
  HANDLE hHeap;
  void **ppvVar2;
  void *extraout_ECX;
  void *extraout_ECX_00;
  void *extraout_ECX_01;
  void *pvVar3;
  void *this_00;
  DWORD dwFlags;
  void *local_c;
  void *local_8;
  
  local_c = this;
  local_8 = this;
  this_00 = (void *)FUN_6767ebf3(this);
  if ((999 < extraout_EAX) && (extraout_EAX < 0x3ef)) {
    return;
  }
  ppvVar2 = param_3;
  if (param_3 == (void **)0x0) {
    ppvVar2 = &local_8;
  }
  if (param_4 == (void **)0x0) {
    param_4 = &local_c;
  }
  iVar1 = *(int *)((int)this_00 + 4);
  if (iVar1 == 0) {
    iVar1 = FUN_6767f230((undefined4 *)param_1,param_2,ppvVar2,(uint *)param_4);
    pvVar3 = extraout_ECX_01;
  }
  else {
    if (iVar1 < 8) {
      return;
    }
    if (iVar1 < 10) {
      iVar1 = FUN_6767ee51(this_00,(int)param_1,param_2,ppvVar2,(int *)param_4,param_5);
      pvVar3 = extraout_ECX_00;
    }
    else {
      if (iVar1 != 0x12) {
        return;
      }
      iVar1 = FUN_6767f2d6(this_00,(int)param_1,param_2,ppvVar2,(int *)param_4,param_5);
      pvVar3 = extraout_ECX;
    }
  }
  if (iVar1 != 0) goto LAB_6767ea7d;
  if ((*(char *)((int)this_00 + 0x10) == '\0') || (*(char *)((int)this_00 + 0x11) == '\0')) {
LAB_6767ea3f:
    if (param_3 == (void **)0x0) goto LAB_6767ea45;
  }
  else {
    if (param_3 != (void **)0x0) {
      if (*param_3 != (void *)0x0) {
        FUN_6767c676(pvVar3,(uint *)((int)this_00 + 0x58),(int)*param_3,(uint)*param_4);
      }
      goto LAB_6767ea3f;
    }
LAB_6767ea45:
    if (local_8 != (void *)0x0) {
      dwFlags = 0;
      pvVar3 = local_8;
      hHeap = GetProcessHeap();
      HeapFree(hHeap,dwFlags,pvVar3);
    }
  }
  if ((param_1 != (byte *)0x0) && (param_2 != 0)) {
    FUN_6767f6a8(this_00,param_1,param_2,'\0');
  }
  if (param_5 == '\0') {
    return;
  }
LAB_6767ea7d:
  FUN_6767ecb8((int)this_00);
  return;
}



// Function: FUN_6767ea8d at 6767ea8d

uint __thiscall
FUN_6767ea8d(void *this,undefined4 *param_1,uint param_2,LPVOID *param_3,uint *param_4,char param_5)

{
  int iVar1;
  uint uVar2;
  undefined4 *puVar3;
  HANDLE hHeap;
  void *this_00;
  LPVOID *ppvVar4;
  DWORD dwFlags;
  uint local_10;
  LPVOID local_c;
  undefined4 *local_8;
  
  uVar2 = FUN_6767ed1f(this);
  if ((999 < (int)uVar2) && ((int)uVar2 < 0x3ef)) {
    return uVar2;
  }
  local_8 = param_1;
  if ((((*(char *)((int)this + 0x10) != '\0') && (*(char *)((int)this + 0x11) != '\0')) &&
      (param_1 != (undefined4 *)0x0)) && (param_2 != 0)) {
    puVar3 = (undefined4 *)operator_new(param_2);
    if (puVar3 == (undefined4 *)0x0) {
      return 0x1ff;
    }
    local_8 = puVar3;
    FUN_676b06d0(puVar3,param_1,param_2);
    FUN_6767c7b4(this_00,(uint *)((int)this + 0x58),(int)puVar3,param_2);
  }
  ppvVar4 = param_3;
  if (param_3 == (LPVOID *)0x0) {
    ppvVar4 = &local_c;
  }
  if (param_4 == (uint *)0x0) {
    param_4 = &local_10;
  }
  iVar1 = *(int *)((int)this + 4);
  if (iVar1 == 0) {
    param_2 = FUN_6767f283(local_8,param_2,ppvVar4,param_4);
    goto LAB_6767eb6e;
  }
  if (7 < iVar1) {
    if (iVar1 < 10) {
      param_2 = FUN_6767efe3(this,local_8,param_2,ppvVar4,(int *)param_4,param_5);
      goto LAB_6767eb6e;
    }
    if (iVar1 == 0x12) {
      param_2 = FUN_6767f481(this,(int)local_8,param_2,ppvVar4,(int *)param_4,param_5);
      goto LAB_6767eb6e;
    }
  }
  param_2 = 0x3ea;
LAB_6767eb6e:
  if (((*(char *)((int)this + 0x10) != '\0') && (*(char *)((int)this + 0x11) != '\0')) &&
     ((param_1 != (undefined4 *)0x0 && (local_8 != param_1)))) {
    FUN_676b0bb3((undefined *)local_8);
  }
  if (param_2 == 0) {
    FUN_6767f6a8(this,(byte *)*ppvVar4,*param_4,'\0');
    if ((param_3 == (LPVOID *)0x0) && (local_c != (LPVOID)0x0)) {
      dwFlags = 0;
      hHeap = GetProcessHeap();
      HeapFree(hHeap,dwFlags,local_c);
    }
    if (param_5 == '\0') {
      return 0;
    }
  }
  FUN_6767edea((int)this);
  return param_2;
}



// Function: FUN_6767ebd6 at 6767ebd6

void FUN_6767ebd6(LPVOID param_1)

{
  HANDLE hHeap;
  DWORD dwFlags;
  
  if (param_1 != (LPVOID)0x0) {
    dwFlags = 0;
    hHeap = GetProcessHeap();
    HeapFree(hHeap,dwFlags,param_1);
  }
  return;
}



// Function: FUN_6767ebf3 at 6767ebf3

uint __fastcall FUN_6767ebf3(void *param_1)

{
  int iVar1;
  uint unaff_ESI;
  uint uVar2;
  int iVar3;
  
  if (*(int *)((int)param_1 + 0x18) == 1) {
    return unaff_ESI;
  }
  if (*(int *)((int)param_1 + 0x18) != 0) {
    return unaff_ESI;
  }
  iVar1 = *(int *)((int)param_1 + 4);
  *(code **)((int)param_1 + 0x40) = FUN_6767f720;
  *(code **)((int)param_1 + 0x44) = FUN_6767f777;
  *(void **)((int)param_1 + 0x48) = param_1;
  if (iVar1 == 0) {
    uVar2 = 0;
    goto LAB_6767ec94;
  }
  if (iVar1 == 8) {
    iVar3 = -0xf;
    iVar1 = 8;
LAB_6767ec81:
    iVar1 = FUN_67677df8((int)param_1 + 0x20,*(int *)((int)param_1 + 8),iVar1,iVar3,8,0,
                         s_1_1_3_676c0234,0x38);
  }
  else {
    if (iVar1 == 9) {
      iVar3 = -0x10;
      iVar1 = 9;
      goto LAB_6767ec81;
    }
    if (iVar1 != 0x12) {
      return unaff_ESI;
    }
    iVar1 = FUN_676726ae((int)param_1 + 0x78,*(int *)((int)param_1 + 8),0,0x1e,1);
  }
  uVar2 = -(uint)(iVar1 != 0) & 0x3e9;
LAB_6767ec94:
  if ((uVar2 < 1000) || (0x3ee < uVar2)) {
    *(undefined4 *)((int)param_1 + 0x18) = 1;
    FUN_6767f6a8(param_1,(byte *)0x0,0,'\x01');
  }
  return unaff_ESI;
}



// Function: FUN_6767ecb8 at 6767ecb8

undefined4 __fastcall FUN_6767ecb8(int param_1)

{
  int iVar1;
  
  if (*(int *)(param_1 + 0x18) != 0) {
    if (*(int *)(param_1 + 0x18) != 1) {
      return 1000;
    }
    iVar1 = *(int *)(param_1 + 4);
    *(undefined4 *)(param_1 + 0x18) = 0;
    if (iVar1 != 0) {
      if (iVar1 < 8) {
        return 0x3ea;
      }
      if (iVar1 < 10) {
        FUN_6767833e(param_1 + 0x20);
        _memset((void *)(param_1 + 0x20),0,0x38);
      }
      else {
        if (iVar1 != 0x12) {
          return 0x3ea;
        }
        FUN_67672d99(param_1 + 0x78);
        _memset((void *)(param_1 + 0x78),0,0x30);
      }
    }
  }
  return 0;
}



// Function: FUN_6767ed1f at 6767ed1f

uint __fastcall FUN_6767ed1f(void *param_1)

{
  uint uVar1;
  int iVar2;
  
  if (*(int *)((int)param_1 + 0x18) == 2) {
    uVar1 = 0;
  }
  else if (*(int *)((int)param_1 + 0x18) == 0) {
    iVar2 = *(int *)((int)param_1 + 4);
    *(code **)((int)param_1 + 0x40) = FUN_6767f720;
    *(code **)((int)param_1 + 0x44) = FUN_6767f777;
    *(void **)((int)param_1 + 0x48) = param_1;
    if (iVar2 == 0) {
      uVar1 = 0;
    }
    else {
      if (iVar2 == 8) {
        iVar2 = FUN_6767a2bc((int)param_1 + 0x20,-0xf,s_1_1_3_676c0234,0x38);
      }
      else if (iVar2 == 9) {
        iVar2 = FUN_6767a1bd((int)param_1 + 0x20,9,-0x10,s_1_1_3_676c0234,0x38);
      }
      else {
        if (iVar2 != 0x12) {
          return 0x3ea;
        }
        *(undefined1 *)((int)param_1 + 0xa8) = 0;
        iVar2 = FUN_67672df9((int)param_1 + 0x78,0,0,'\x01');
      }
      uVar1 = -(uint)(iVar2 != 0) & 0x3e9;
    }
    if ((uVar1 < 1000) || (0x3ee < uVar1)) {
      *(undefined4 *)((int)param_1 + 0x18) = 2;
      FUN_6767f6a8(param_1,(byte *)0x0,0,'\x01');
    }
  }
  else {
    uVar1 = 1000;
  }
  return uVar1;
}



// Function: FUN_6767edea at 6767edea

undefined4 __fastcall FUN_6767edea(int param_1)

{
  int iVar1;
  
  if (*(int *)(param_1 + 0x18) != 0) {
    if (*(int *)(param_1 + 0x18) != 2) {
      return 1000;
    }
    iVar1 = *(int *)(param_1 + 4);
    *(undefined4 *)(param_1 + 0x18) = 0;
    if (iVar1 != 0) {
      if (iVar1 < 8) {
        return 0x3ea;
      }
      if (iVar1 < 10) {
        FUN_6767a17f(param_1 + 0x20);
        _memset((void *)(param_1 + 0x20),0,0x38);
      }
      else {
        if (iVar1 != 0x12) {
          return 0x3ea;
        }
        FUN_67673a04(param_1 + 0x78);
        _memset((void *)(param_1 + 0x78),0,0x30);
      }
    }
  }
  return 0;
}



// Function: FUN_6767ee51 at 6767ee51

undefined4 __thiscall
FUN_6767ee51(void *this,int param_1,uint param_2,undefined4 *param_3,int *param_4,char param_5)

{
  HANDLE pvVar1;
  LPVOID lpMem;
  uint uVar2;
  SIZE_T SVar3;
  int iVar4;
  DWORD DVar5;
  SIZE_T SVar6;
  
  *param_3 = 0;
  *param_4 = 0;
  if ((param_1 == 0) || (param_2 == 0)) {
    SVar3 = 0x10000;
    *(undefined4 *)((int)this + 0x20) = 0;
    *(undefined4 *)((int)this + 0x24) = 0;
  }
  else {
    *(int *)((int)this + 0x20) = param_1;
    *(uint *)((int)this + 0x24) = param_2;
    SVar3 = param_2 / 9 + 0xc + param_2;
  }
  DVar5 = 8;
  SVar6 = SVar3;
  pvVar1 = GetProcessHeap();
  lpMem = HeapAlloc(pvVar1,DVar5,SVar6);
  if (lpMem == (LPVOID)0x0) {
    return 0x1ff;
  }
  iVar4 = *(int *)((int)this + 0x34);
  *(LPVOID *)((int)this + 0x2c) = lpMem;
  *(SIZE_T *)((int)this + 0x30) = SVar3;
  if (param_5 == '\0') {
    _param_5 = 0;
    if ((param_1 == 0) || (param_2 == 0)) {
      _param_5 = 2;
    }
    while ((uVar2 = FUN_67678078((int *)((int)this + 0x20),_param_5),
           *(int *)((int)this + 0x30) == 0 && (*(int *)((int)this + 0x24) != 0))) {
      SVar3 = SVar3 + 0x10000;
      DVar5 = 8;
      SVar6 = SVar3;
      pvVar1 = GetProcessHeap();
      lpMem = HeapReAlloc(pvVar1,DVar5,lpMem,SVar6);
      if (lpMem == (LPVOID)0x0) {
        return 0x1ff;
      }
      *(int *)((int)this + 0x2c) = (*(int *)((int)this + 0x34) - iVar4) + (int)lpMem;
      *(SIZE_T *)((int)this + 0x30) = (iVar4 - *(int *)((int)this + 0x34)) + SVar3;
    }
    if (uVar2 != 0) goto LAB_6767efc7;
    iVar4 = *(int *)((int)this + 0x34) - iVar4;
    *param_4 = iVar4;
    if (iVar4 == 0) {
      DVar5 = 0;
      pvVar1 = GetProcessHeap();
      HeapFree(pvVar1,DVar5,lpMem);
      *param_3 = 0;
    }
    else {
      *param_3 = lpMem;
    }
  }
  else {
    while (uVar2 = FUN_67678078((int *)((int)this + 0x20),4), uVar2 == 0) {
      SVar3 = SVar3 + 0x10000;
      DVar5 = 8;
      SVar6 = SVar3;
      pvVar1 = GetProcessHeap();
      lpMem = HeapReAlloc(pvVar1,DVar5,lpMem,SVar6);
      if (lpMem == (LPVOID)0x0) {
        return 0x1ff;
      }
      *(int *)((int)this + 0x2c) = (*(int *)((int)this + 0x34) - iVar4) + (int)lpMem;
      *(SIZE_T *)((int)this + 0x30) = (iVar4 - *(int *)((int)this + 0x34)) + SVar3;
    }
    if (uVar2 != 1) {
LAB_6767efc7:
      DVar5 = 0;
      pvVar1 = GetProcessHeap();
      HeapFree(pvVar1,DVar5,lpMem);
      return 0x3eb;
    }
    *param_3 = lpMem;
    *param_4 = *(int *)((int)this + 0x34) - iVar4;
  }
  return 0;
}



// Function: FUN_6767efe3 at 6767efe3

undefined4 __thiscall
FUN_6767efe3(void *this,undefined4 *param_1,uint param_2,undefined4 *param_3,int *param_4,
            char param_5)

{
  int iVar1;
  HANDLE pvVar2;
  LPVOID lpMem;
  undefined4 *puVar3;
  uint uVar4;
  undefined4 uVar5;
  int iVar6;
  code *pcVar7;
  DWORD DVar8;
  SIZE_T SVar9;
  uint local_10;
  SIZE_T local_8;
  
  *param_3 = 0;
  *param_4 = 0;
  if (((param_1 == (undefined4 *)0x0) || (param_2 == 0)) && (param_5 == '\0')) {
LAB_6767f140:
    uVar5 = 0;
  }
  else {
    if ((param_1 == (undefined4 *)0x0) || (param_2 == 0)) {
      local_8 = 0x10000;
      *(undefined4 *)((int)this + 0x20) = 0;
      *(undefined4 *)((int)this + 0x24) = 0;
    }
    else {
      local_8 = param_2 * 2;
      *(undefined4 **)((int)this + 0x20) = param_1;
      *(uint *)((int)this + 0x24) = param_2;
    }
    pcVar7 = GetProcessHeap_exref;
    DVar8 = 8;
    SVar9 = local_8;
    pvVar2 = GetProcessHeap();
    lpMem = HeapAlloc(pvVar2,DVar8,SVar9);
    if (lpMem != (LPVOID)0x0) {
      *(SIZE_T *)((int)this + 0x30) = local_8;
      iVar6 = *(int *)((int)this + 0x34);
      *(LPVOID *)((int)this + 0x2c) = lpMem;
      if (param_5 == '\0') {
        local_10 = 0;
        if ((param_1 == (undefined4 *)0x0) || (param_2 == 0)) {
          local_10 = 2;
        }
        while ((uVar4 = FUN_6767a2d7((int *)((int)this + 0x20),local_10),
               *(int *)((int)this + 0x30) == 0 && (*(int *)((int)this + 0x24) != 0))) {
          uVar4 = 0x400000;
          if (local_8 < 0x400001) {
            uVar4 = local_8;
          }
          local_8 = local_8 + uVar4;
          DVar8 = 8;
          SVar9 = local_8;
          pvVar2 = GetProcessHeap();
          lpMem = HeapReAlloc(pvVar2,DVar8,lpMem,SVar9);
          if (lpMem == (LPVOID)0x0) goto LAB_6767f1c1;
          *(int *)((int)this + 0x2c) = (*(int *)((int)this + 0x34) - iVar6) + (int)lpMem;
          *(SIZE_T *)((int)this + 0x30) = (iVar6 - *(int *)((int)this + 0x34)) + local_8;
        }
        if ((uVar4 != 0) && (uVar4 != 1)) {
LAB_6767f1da:
          DVar8 = 0;
          pvVar2 = (HANDLE)(*pcVar7)();
          HeapFree(pvVar2,DVar8,lpMem);
          return 0x3eb;
        }
        iVar6 = *(int *)((int)this + 0x34) - iVar6;
        *param_4 = iVar6;
        if (iVar6 == 0) {
          DVar8 = 0;
          pvVar2 = GetProcessHeap();
          HeapFree(pvVar2,DVar8,lpMem);
          *param_3 = 0;
        }
        else {
          *param_3 = lpMem;
        }
        if ((uVar4 == 1) && (*(int *)((int)this + 0x24) != 0)) {
          return 0x3ee;
        }
        goto LAB_6767f140;
      }
      puVar3 = (undefined4 *)operator_new(param_2 + 1);
      if (puVar3 != (undefined4 *)0x0) {
        FUN_676b06d0(puVar3,param_1,param_2);
        *(int *)((int)this + 0x20) = (int)puVar3;
        *(uint *)((int)this + 0x24) = param_2 + 1;
        _param_5 = FUN_6767a2d7((int *)((int)this + 0x20),4);
        while( true ) {
          if ((_param_5 != 0) && (_param_5 != 0xfffffffb)) {
            FUN_676b0bb3((undefined *)puVar3);
            if (_param_5 != 1) goto LAB_6767f1da;
            *param_3 = lpMem;
            *param_4 = *(int *)((int)this + 0x34) - iVar6;
            goto LAB_6767f140;
          }
          uVar4 = 0x400000;
          if (local_8 < 0x400001) {
            uVar4 = local_8;
          }
          local_8 = local_8 + uVar4;
          DVar8 = 8;
          SVar9 = local_8;
          pvVar2 = (HANDLE)(*pcVar7)();
          lpMem = HeapReAlloc(pvVar2,DVar8,lpMem,SVar9);
          if (lpMem == (LPVOID)0x0) break;
          iVar1 = *(int *)((int)this + 0x34);
          *(int *)((int)this + 0x2c) = (iVar1 - iVar6) + (int)lpMem;
          *(SIZE_T *)((int)this + 0x30) = (iVar6 - iVar1) + local_8;
          _param_5 = FUN_6767a2d7((int *)((int)this + 0x20),4);
          pcVar7 = GetProcessHeap_exref;
          if (iVar1 == *(int *)((int)this + 0x34)) {
            _param_5 = 0xfffffffd;
          }
        }
      }
    }
LAB_6767f1c1:
    uVar5 = 0x1ff;
  }
  return uVar5;
}



// Function: FUN_6767f230 at 6767f230

undefined4 FUN_6767f230(undefined4 *param_1,uint param_2,undefined4 *param_3,uint *param_4)

{
  HANDLE hHeap;
  undefined4 *puVar1;
  DWORD dwFlags;
  uint dwBytes;
  
  *param_3 = 0;
  *param_4 = 0;
  if ((param_1 != (undefined4 *)0x0) && (param_2 != 0)) {
    dwFlags = 8;
    dwBytes = param_2;
    hHeap = GetProcessHeap();
    puVar1 = (undefined4 *)HeapAlloc(hHeap,dwFlags,dwBytes);
    *param_3 = puVar1;
    if (puVar1 == (undefined4 *)0x0) {
      return 0x1ff;
    }
    FUN_676b06d0(puVar1,param_1,param_2);
    *param_4 = param_2;
  }
  return 0;
}



// Function: FUN_6767f283 at 6767f283

undefined4 FUN_6767f283(undefined4 *param_1,uint param_2,undefined4 *param_3,uint *param_4)

{
  HANDLE hHeap;
  undefined4 *puVar1;
  DWORD dwFlags;
  uint dwBytes;
  
  *param_3 = 0;
  *param_4 = 0;
  if ((param_1 != (undefined4 *)0x0) && (param_2 != 0)) {
    dwFlags = 8;
    dwBytes = param_2;
    hHeap = GetProcessHeap();
    puVar1 = (undefined4 *)HeapAlloc(hHeap,dwFlags,dwBytes);
    *param_3 = puVar1;
    if (puVar1 == (undefined4 *)0x0) {
      return 0x1ff;
    }
    FUN_676b06d0(puVar1,param_1,param_2);
    *param_4 = param_2;
  }
  return 0;
}



// Function: FUN_6767f2d6 at 6767f2d6

undefined4 __thiscall
FUN_6767f2d6(void *this,int param_1,uint param_2,undefined4 *param_3,int *param_4,char param_5)

{
  HANDLE pvVar1;
  LPVOID lpMem;
  int iVar2;
  SIZE_T SVar3;
  int iVar4;
  DWORD DVar5;
  SIZE_T SVar6;
  
  *param_3 = 0;
  *param_4 = 0;
  if ((param_1 == 0) || (param_2 == 0)) {
    SVar3 = 0x10000;
    *(undefined4 *)((int)this + 0x78) = 0;
    *(undefined4 *)((int)this + 0x7c) = 0;
  }
  else {
    *(int *)((int)this + 0x78) = param_1;
    *(uint *)((int)this + 0x7c) = param_2;
    SVar3 = param_2 / 9 + 0xc + param_2;
  }
  DVar5 = 8;
  SVar6 = SVar3;
  pvVar1 = GetProcessHeap();
  lpMem = HeapAlloc(pvVar1,DVar5,SVar6);
  if (lpMem == (LPVOID)0x0) {
    return 0x1ff;
  }
  iVar4 = *(int *)((int)this + 0x90);
  *(LPVOID *)((int)this + 0x88) = lpMem;
  *(SIZE_T *)((int)this + 0x8c) = SVar3;
  if (param_5 == '\0') {
    iVar2 = FUN_676728af((int)this + 0x78,0);
    if (iVar2 == 1) {
      do {
        if (*(int *)((int)this + 0x7c) == 0) break;
        SVar3 = SVar3 + 0x10000;
        DVar5 = 8;
        SVar6 = SVar3;
        pvVar1 = GetProcessHeap();
        lpMem = HeapReAlloc(pvVar1,DVar5,lpMem,SVar6);
        if (lpMem == (LPVOID)0x0) {
          return 0x1ff;
        }
        *(int *)((int)this + 0x88) = (*(int *)((int)this + 0x90) - iVar4) + (int)lpMem;
        *(SIZE_T *)((int)this + 0x8c) = (iVar4 - *(int *)((int)this + 0x90)) + SVar3;
        iVar2 = FUN_676728af((int)this + 0x78,0);
      } while (iVar2 == 1);
      if (iVar2 == 1) {
        iVar4 = *(int *)((int)this + 0x90) - iVar4;
        *param_4 = iVar4;
        if (iVar4 == 0) {
          DVar5 = 0;
          pvVar1 = GetProcessHeap();
          HeapFree(pvVar1,DVar5,lpMem);
          *param_3 = 0;
          return 0;
        }
        *param_3 = lpMem;
        return 0;
      }
    }
  }
  else {
    while (iVar2 = FUN_676728af((int)this + 0x78,2), iVar2 == 3) {
      SVar3 = SVar3 + 0x10000;
      DVar5 = 8;
      SVar6 = SVar3;
      pvVar1 = GetProcessHeap();
      lpMem = HeapReAlloc(pvVar1,DVar5,lpMem,SVar6);
      if (lpMem == (LPVOID)0x0) {
        return 0x1ff;
      }
      *(int *)((int)this + 0x88) = (*(int *)((int)this + 0x90) - iVar4) + (int)lpMem;
      *(SIZE_T *)((int)this + 0x8c) = (iVar4 - *(int *)((int)this + 0x90)) + SVar3;
    }
    if (iVar2 == 4) {
      *param_3 = lpMem;
      *param_4 = *(int *)((int)this + 0x90) - iVar4;
      return 0;
    }
  }
  DVar5 = 0;
  pvVar1 = GetProcessHeap();
  HeapFree(pvVar1,DVar5,lpMem);
  return 0x3eb;
}



// Function: FUN_6767f481 at 6767f481

undefined4 __thiscall
FUN_6767f481(void *this,int param_1,int param_2,undefined4 *param_3,int *param_4,char param_5)

{
  int iVar1;
  HANDLE pvVar2;
  LPVOID lpMem;
  int iVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  DWORD DVar7;
  
  *param_3 = 0;
  *param_4 = 0;
  if (((param_1 == 0) || (param_2 == 0)) && (param_5 == '\0')) {
    return 0;
  }
  if ((param_1 == 0) || (param_2 == 0)) {
    uVar6 = 0x10000;
    *(undefined4 *)((int)this + 0x78) = 0;
    *(undefined4 *)((int)this + 0x7c) = 0;
  }
  else {
    uVar6 = param_2 * 2;
    *(int *)((int)this + 0x78) = param_1;
    *(int *)((int)this + 0x7c) = param_2;
  }
  DVar7 = 8;
  uVar4 = uVar6;
  pvVar2 = GetProcessHeap();
  lpMem = HeapAlloc(pvVar2,DVar7,uVar4);
  if (lpMem == (LPVOID)0x0) {
    return 0x1ff;
  }
  iVar5 = *(int *)((int)this + 0x90);
  *(LPVOID *)((int)this + 0x88) = lpMem;
  *(uint *)((int)this + 0x8c) = uVar6;
  if (param_5 == '\0') {
    _param_5 = FUN_67672efd((int)this + 0x78);
    if (_param_5 == 0) {
      do {
        if (*(int *)((int)this + 0x7c) == 0) break;
        uVar4 = 0x400000;
        if (uVar6 < 0x400001) {
          uVar4 = uVar6;
        }
        uVar6 = uVar6 + uVar4;
        DVar7 = 8;
        uVar4 = uVar6;
        pvVar2 = GetProcessHeap();
        lpMem = HeapReAlloc(pvVar2,DVar7,lpMem,uVar4);
        if (lpMem == (LPVOID)0x0) {
          return 0x1ff;
        }
        *(int *)((int)this + 0x88) = (*(int *)((int)this + 0x90) - iVar5) + (int)lpMem;
        *(uint *)((int)this + 0x8c) = (iVar5 - *(int *)((int)this + 0x90)) + uVar6;
        _param_5 = FUN_67672efd((int)this + 0x78);
      } while (_param_5 == 0);
      if (_param_5 == 0) goto LAB_6767f658;
    }
    if (_param_5 == 4) {
LAB_6767f658:
      iVar5 = *(int *)((int)this + 0x90) - iVar5;
      *param_4 = iVar5;
      if (iVar5 == 0) {
        DVar7 = 0;
        pvVar2 = GetProcessHeap();
        HeapFree(pvVar2,DVar7,lpMem);
        *param_3 = 0;
      }
      else {
        *param_3 = lpMem;
      }
      if (_param_5 == 4) {
        if (*(int *)((int)this + 0x7c) != 0) {
          return 0x3ee;
        }
        *(undefined1 *)((int)this + 0xa8) = 1;
      }
      return 0;
    }
  }
  else {
    iVar3 = FUN_67672efd((int)this + 0x78);
    while (iVar3 == 0) {
      uVar4 = 0x400000;
      if (uVar6 < 0x400001) {
        uVar4 = uVar6;
      }
      uVar6 = uVar6 + uVar4;
      DVar7 = 8;
      uVar4 = uVar6;
      pvVar2 = GetProcessHeap();
      lpMem = HeapReAlloc(pvVar2,DVar7,lpMem,uVar4);
      if (lpMem == (LPVOID)0x0) {
        return 0x1ff;
      }
      iVar1 = *(int *)((int)this + 0x90);
      *(int *)((int)this + 0x88) = (iVar1 - iVar5) + (int)lpMem;
      *(uint *)((int)this + 0x8c) = (iVar5 - iVar1) + uVar6;
      iVar3 = FUN_67672efd((int)this + 0x78);
      if (iVar1 == *(int *)((int)this + 0x90)) {
        iVar3 = -4;
      }
    }
    if (iVar3 == -1) {
      if (*(char *)((int)this + 0xa8) == '\0') goto LAB_6767f63a;
      iVar3 = 4;
    }
    if (iVar3 == 4) {
      iVar5 = *(int *)((int)this + 0x90) - iVar5;
      *param_4 = iVar5;
      if (iVar5 == 0) {
        DVar7 = 0;
        pvVar2 = GetProcessHeap();
        HeapFree(pvVar2,DVar7,lpMem);
        *param_3 = 0;
        return 0;
      }
      *param_3 = lpMem;
      return 0;
    }
  }
LAB_6767f63a:
  DVar7 = 0;
  pvVar2 = GetProcessHeap();
  HeapFree(pvVar2,DVar7,lpMem);
  return 0x3eb;
}



// Function: FUN_6767f6a8 at 6767f6a8

void __thiscall FUN_6767f6a8(void *this,byte *param_1,uint param_2,char param_3)

{
  uint uVar1;
  
  if (*(int *)((int)this + 0xc) == 1) {
    if (param_3 != '\0') {
      uVar1 = FUN_67677cc6(0,(byte *)0x0,0);
      *(uint *)((int)this + 0x1c) = uVar1;
    }
    if (param_1 == (byte *)0x0) {
      return;
    }
    if (param_2 == 0) {
      return;
    }
    uVar1 = FUN_67677cc6(*(uint *)((int)this + 0x1c),param_1,param_2);
  }
  else {
    if (*(int *)((int)this + 0xc) != 2) {
      return;
    }
    if (param_3 != '\0') {
      uVar1 = FUN_67677bad(0,(byte *)0x0,0);
      *(uint *)((int)this + 0x1c) = uVar1;
    }
    if (param_1 == (byte *)0x0) {
      return;
    }
    if (param_2 == 0) {
      return;
    }
    uVar1 = FUN_67677bad(*(uint *)((int)this + 0x1c),param_1,param_2);
  }
  *(uint *)((int)this + 0x1c) = uVar1;
  return;
}



// Function: FUN_6767f720 at 6767f720

void * __cdecl FUN_6767f720(int param_1,void *param_2,int param_3)

{
  undefined4 uVar1;
  
  if ((int)param_2 * param_3 == 0x10000) {
    param_2 = (void *)0x0;
    uVar1 = FUN_6767f8d2((void *)(param_1 + 0xac),&param_2);
    if ((char)uVar1 == '\0') {
      param_2 = operator_new(0x10000);
    }
    FUN_6767f968((void *)(param_1 + 0xc4),param_2);
  }
  else {
    param_2 = operator_new((int)param_2 * param_3);
  }
  return param_2;
}



// Function: FUN_6767f777 at 6767f777

void __cdecl FUN_6767f777(int param_1,undefined *param_2)

{
  undefined4 uVar1;
  
  uVar1 = FUN_6767f877((void *)(param_1 + 0xc4),(int)param_2,0);
  if ((char)uVar1 != '\0') {
    FUN_6767f968((void *)(param_1 + 0xac),param_2);
    return;
  }
  FUN_676b0bb3(param_2);
  return;
}



// Function: FUN_6767f7aa at 6767f7aa

undefined4 * __fastcall FUN_6767f7aa(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  
  *param_1 = &PTR_FUN_676b99d4;
  puVar2 = (undefined4 *)operator_new(0x14);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    *puVar2 = &PTR_FUN_676b99cc;
    puVar2[2] = 0;
    puVar2[3] = 0;
    puVar2[4] = 1;
  }
  param_1[3] = puVar2;
  puVar2 = (undefined4 *)operator_new(0x14);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    *puVar2 = &PTR_FUN_676b99cc;
    puVar2[2] = 0;
    puVar2[3] = 0;
    puVar2[4] = 2;
  }
  puVar1 = (undefined4 *)param_1[3];
  param_1[4] = puVar2;
  if (puVar1 != (undefined4 *)0x0) {
    if (puVar2 != (undefined4 *)0x0) goto LAB_6767f828;
    if (puVar1 != (undefined4 *)0x0) {
      (**(code **)*puVar1)(1);
      param_1[3] = 0;
    }
  }
  if ((undefined4 *)param_1[4] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[4])(1);
    param_1[4] = 0;
  }
LAB_6767f828:
  FUN_6767fad8(param_1,0);
  FUN_6767fb0a(param_1,0);
  param_1[5] = 0;
  return param_1;
}



// Function: FUN_6767f841 at 6767f841

void __fastcall FUN_6767f841(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b99d4;
  while (param_1[1] != 0) {
    FUN_6767f9f6(param_1,(undefined4 *)0x0);
  }
  if ((undefined4 *)param_1[3] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[3])(1);
  }
  if ((undefined4 *)param_1[4] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[4])(1);
  }
  return;
}



// Function: FUN_6767f877 at 6767f877

undefined4 __thiscall FUN_6767f877(void *this,int param_1,int param_2)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  
  puVar1 = (undefined4 *)FUN_6767fa8c(this,param_1,param_2);
  if (puVar1 == (undefined4 *)0x0) {
    uVar2 = 0;
  }
  else if (puVar1 == *(undefined4 **)((int)this + 4)) {
    uVar2 = FUN_6767f9f6(this,(undefined4 *)0x0);
  }
  else if (puVar1 == *(undefined4 **)((int)this + 8)) {
    uVar2 = FUN_6767fa41(this,(undefined4 *)0x0);
  }
  else {
    *(undefined4 *)(puVar1[2] + 0xc) = puVar1[3];
    *(undefined4 *)(puVar1[3] + 8) = puVar1[2];
    *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + -1;
    uVar2 = (**(code **)*puVar1)(1);
    uVar2 = CONCAT31((int3)((uint)uVar2 >> 8),1);
  }
  return uVar2;
}



// Function: FUN_6767f8d2 at 6767f8d2

uint __thiscall FUN_6767f8d2(void *this,undefined4 *param_1)

{
  undefined4 *puVar1;
  uint in_EAX;
  uint uVar2;
  undefined4 uVar3;
  
  puVar1 = *(undefined4 **)((int)this + 4);
  if (puVar1 == (undefined4 *)0x0) {
    uVar2 = in_EAX & 0xffffff00;
  }
  else {
    FUN_6767fad8(this,puVar1[3]);
    if (*(int *)((int)this + 4) == 0) {
      FUN_6767fb0a(this,0);
    }
    uVar3 = puVar1[1];
    *param_1 = uVar3;
    *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + -1;
    if (puVar1 != (undefined4 *)0x0) {
      uVar3 = (**(code **)*puVar1)(1);
    }
    uVar2 = CONCAT31((int3)((uint)uVar3 >> 8),1);
  }
  return uVar2;
}



// Function: FUN_6767f919 at 6767f919

void __fastcall FUN_6767f919(void *param_1)

{
  while (*(int *)((int)param_1 + 4) != 0) {
    FUN_6767f9f6(param_1,(undefined4 *)0x0);
  }
  return;
}



// Function: FUN_6767f92f at 6767f92f

undefined4 * __thiscall FUN_6767f92f(void *this,byte param_1)

{
  FUN_6767f841((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_6767f94b at 6767f94b

undefined4 * __thiscall FUN_6767f94b(void *this,byte param_1)

{
  *(undefined ***)this = &PTR_FUN_676b99cc;
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_6767f968 at 6767f968

undefined4 __thiscall FUN_6767f968(void *this,undefined4 param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  
  if (*(int *)((int)this + 4) == 0) {
    puVar1 = (undefined4 *)operator_new(0x14);
    if (puVar1 == (undefined4 *)0x0) {
      puVar3 = (undefined4 *)0x0;
    }
    else {
      *puVar1 = &PTR_FUN_676b99cc;
      puVar1[1] = param_1;
      puVar1[2] = 0;
      puVar1[3] = 0;
      puVar1[4] = 0;
      puVar3 = puVar1;
    }
    if (puVar3 == (undefined4 *)0x0) {
LAB_6767f9d3:
      return (uint)puVar1 & 0xffffff00;
    }
    FUN_6767fad8(this,(int)puVar3);
    puVar1 = puVar3;
  }
  else {
    puVar1 = (undefined4 *)operator_new(0x14);
    if (puVar1 == (undefined4 *)0x0) {
      puVar1 = (undefined4 *)0x0;
    }
    else {
      *puVar1 = &PTR_FUN_676b99cc;
      puVar1[1] = param_1;
      puVar1[2] = 0;
      puVar1[3] = 0;
      puVar1[4] = 0;
    }
    if (puVar1 == (undefined4 *)0x0) goto LAB_6767f9d3;
    *(undefined4 **)(*(int *)((int)this + 8) + 0xc) = puVar1;
    puVar1[2] = *(undefined4 *)((int)this + 8);
  }
  uVar2 = FUN_6767fb0a(this,(int)puVar1);
  *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + 1;
  return CONCAT31((int3)((uint)uVar2 >> 8),1);
}



// Function: FUN_6767f9f6 at 6767f9f6

uint __thiscall FUN_6767f9f6(void *this,undefined4 *param_1)

{
  undefined4 *puVar1;
  uint in_EAX;
  uint uVar2;
  
  puVar1 = *(undefined4 **)((int)this + 4);
  if (puVar1 == (undefined4 *)0x0) {
    uVar2 = in_EAX & 0xffffff00;
  }
  else {
    FUN_6767fad8(this,puVar1[3]);
    if (*(int *)((int)this + 4) == 0) {
      FUN_6767fb0a(this,0);
    }
    if (param_1 != (undefined4 *)0x0) {
      *param_1 = puVar1[1];
    }
    *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + -1;
    if (puVar1 != (undefined4 *)0x0) {
      param_1 = (undefined4 *)(**(code **)*puVar1)(1);
    }
    uVar2 = CONCAT31((int3)((uint)param_1 >> 8),1);
  }
  return uVar2;
}



// Function: FUN_6767fa41 at 6767fa41

uint __thiscall FUN_6767fa41(void *this,undefined4 *param_1)

{
  undefined4 *puVar1;
  uint in_EAX;
  uint uVar2;
  
  puVar1 = *(undefined4 **)((int)this + 8);
  if (puVar1 == (undefined4 *)0x0) {
    uVar2 = in_EAX & 0xffffff00;
  }
  else {
    FUN_6767fb0a(this,puVar1[2]);
    if (*(int *)((int)this + 8) == 0) {
      FUN_6767fad8(this,0);
    }
    if (param_1 != (undefined4 *)0x0) {
      *param_1 = puVar1[1];
    }
    *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + -1;
    if (puVar1 != (undefined4 *)0x0) {
      param_1 = (undefined4 *)(**(code **)*puVar1)(1);
    }
    uVar2 = CONCAT31((int3)((uint)param_1 >> 8),1);
  }
  return uVar2;
}



// Function: FUN_6767fa8c at 6767fa8c

void __thiscall FUN_6767fa8c(void *this,int param_1,int param_2)

{
  int iVar1;
  
  if (param_2 == 0) {
    iVar1 = *(int *)((int)this + 4);
    while (((iVar1 != 0 && (*(int *)(iVar1 + 4) != param_1)) &&
           (iVar1 = *(int *)(iVar1 + 0xc), iVar1 != 0))) {
      if (*(int *)(iVar1 + 0x10) == 2) {
        iVar1 = 0;
      }
    }
  }
  else {
    iVar1 = *(int *)((int)this + 8);
    while (((iVar1 != 0 && (*(int *)(iVar1 + 4) != param_1)) &&
           (iVar1 = *(int *)(iVar1 + 8), iVar1 != 0))) {
      if (*(int *)(iVar1 + 0x10) == 1) {
        iVar1 = 0;
      }
    }
  }
  return;
}



// Function: FUN_6767fad8 at 6767fad8

void __thiscall FUN_6767fad8(void *this,int param_1)

{
  *(int *)((int)this + 4) = param_1;
  if ((param_1 != 0) && (*(int *)(param_1 + 0x10) != 0)) {
    *(undefined4 *)((int)this + 4) = 0;
  }
  if (*(int *)((int)this + 0xc) != 0) {
    *(undefined4 *)(*(int *)((int)this + 0xc) + 0xc) = *(undefined4 *)((int)this + 4);
    if (*(int *)((int)this + 4) != 0) {
      *(undefined4 *)(*(int *)((int)this + 4) + 8) = *(undefined4 *)((int)this + 0xc);
    }
  }
  return;
}



// Function: FUN_6767fb0a at 6767fb0a

void __thiscall FUN_6767fb0a(void *this,int param_1)

{
  *(int *)((int)this + 8) = param_1;
  if ((param_1 != 0) && (*(int *)(param_1 + 0x10) != 0)) {
    *(undefined4 *)((int)this + 8) = 0;
  }
  if (*(int *)((int)this + 0x10) != 0) {
    *(undefined4 *)(*(int *)((int)this + 0x10) + 8) = *(undefined4 *)((int)this + 8);
    if (*(int *)((int)this + 8) != 0) {
      *(undefined4 *)(*(int *)((int)this + 8) + 0xc) = *(undefined4 *)((int)this + 0x10);
    }
  }
  return;
}



// Function: FUN_6767fb3c at 6767fb3c

void __thiscall FUN_6767fb3c(void *this,undefined4 param_1)

{
  *(undefined4 *)((int)this + 0xc) = 0xffffffff;
  *(undefined4 *)((int)this + 4) = param_1;
  *(undefined ***)this = &PTR_FUN_676b99dc;
  *(undefined4 *)((int)this + 8) = 0;
  *(undefined1 *)((int)this + 0x10) = 1;
  *(undefined4 *)((int)this + 0x14) = 0;
  *(undefined4 *)((int)this + 0x18) = 0;
  *(undefined4 *)((int)this + 0x1c) = 0;
  *(undefined1 *)((int)this + 0x20) = 0;
  return;
}



// Function: FUN_6767fb67 at 6767fb67

undefined4 * __thiscall FUN_6767fb67(void *this,byte param_1)

{
  FUN_6767fb83((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_6767fb83 at 6767fb83

void __fastcall FUN_6767fb83(undefined4 *param_1)

{
  undefined **local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  *param_1 = &PTR_FUN_676b99dc;
  local_10 = 0;
  local_24 = 0;
  local_20 = 0;
  local_1c = 0;
  local_18 = 0;
  local_c = 0;
  local_8 = 0;
  local_14 = 0;
  local_28 = &PTR_LAB_676b99c8;
  FUN_6767fc47(param_1,&local_28);
  return;
}



// Function: FUN_6767fbbb at 6767fbbb

uint __thiscall FUN_6767fbbb(void *this,void *param_1,int param_2,undefined1 param_3)

{
  uint uVar1;
  int iVar2;
  
  FUN_6767fc47(this,param_1);
  if (param_2 == 0) {
LAB_6767fbd2:
    iVar2 = 0x4000000;
    uVar1 = 999;
LAB_6767fc29:
    uVar1 = FUN_6767ca9c(param_1,uVar1,iVar2);
LAB_6767fc30:
    uVar1 = uVar1 & 0xffffff00;
  }
  else {
    *(int *)((int)this + 8) = param_2;
    iVar2 = FUN_676ae2a4(*(short **)(param_2 + 0x170));
    if (iVar2 == 0) {
      uVar1 = 0;
      *(undefined1 *)((int)this + 0x10) = param_3;
    }
    else {
      uVar1 = FUN_676898b0(*(void **)((int)this + 8),param_1,(int *)((int)this + 0xc));
      if ((char)uVar1 == '\0') goto LAB_6767fc30;
      if (*(int *)((int)this + 0xc) == -1) {
        iVar2 = *(int *)((int)this + 8);
        uVar1 = *(uint *)(iVar2 + 0x34);
        if ((uVar1 & 0x18) == 0) goto LAB_6767fbd2;
        if (*(int *)(iVar2 + 0x20) != 0 || *(int *)(iVar2 + 0x24) != 0) {
          iVar2 = 0x2000000;
          uVar1 = (uint)(~(byte)uVar1 & 0x10 | 0x65);
          goto LAB_6767fc29;
        }
      }
    }
    *(undefined1 *)((int)this + 0x20) = 1;
    uVar1 = CONCAT31((int3)(uVar1 >> 8),1);
  }
  return uVar1;
}



// Function: FUN_6767fc47 at 6767fc47

undefined4 __thiscall FUN_6767fc47(void *this,undefined4 param_1)

{
  HANDLE hHeap;
  LPVOID lpMem;
  DWORD dwFlags;
  
  if (*(void **)((int)this + 8) == (void *)0x0) {
    if (*(HANDLE *)((int)this + 0xc) != (HANDLE)0xffffffff) {
      CloseHandle(*(HANDLE *)((int)this + 0xc));
    }
  }
  else {
    FUN_67689b00(*(void **)((int)this + 8),param_1,*(HANDLE *)((int)this + 0xc));
  }
  lpMem = *(LPVOID *)((int)this + 0x14);
  *(undefined4 *)((int)this + 0xc) = 0xffffffff;
  if (lpMem != (LPVOID)0x0) {
    dwFlags = 0;
    hHeap = GetProcessHeap();
    lpMem = (LPVOID)HeapFree(hHeap,dwFlags,lpMem);
    *(undefined4 *)((int)this + 0x14) = 0;
  }
  *(undefined4 *)((int)this + 0x18) = 0;
  *(undefined4 *)((int)this + 0x1c) = 0;
  *(undefined4 *)((int)this + 8) = 0;
  *(undefined1 *)((int)this + 0x10) = 1;
  *(undefined1 *)((int)this + 0x20) = 0;
  return CONCAT31((int3)((uint)lpMem >> 8),1);
}



// Function: FUN_6767fca5 at 6767fca5

uint __thiscall
FUN_6767fca5(void *this,void *param_1,undefined4 *param_2,undefined4 *param_3,undefined4 param_4)

{
  undefined4 *puVar1;
  uint uVar2;
  DWORD DVar3;
  HANDLE pvVar4;
  LPVOID pvVar5;
  SIZE_T SVar6;
  int iVar7;
  int iVar8;
  
  puVar1 = param_3;
  if (((*(char *)((int)this + 0x20) == '\0') || (param_2 == (undefined4 *)0x0)) ||
     (param_3 == (undefined4 *)0x0)) {
    iVar8 = 0x4000000;
    iVar7 = 999;
  }
  else if (*(HANDLE *)((int)this + 0xc) == (HANDLE)0xffffffff) {
    if (*(char *)((int)this + 0x10) != '\0') {
      uVar2 = 0xffffffff;
      if (*(int **)((int)this + 4) == (int *)0x0) {
LAB_6767fdf3:
        return CONCAT31((int3)(uVar2 >> 8),1);
      }
      uVar2 = (**(code **)(**(int **)((int)this + 4) + 0x20))
                        (param_1,*(undefined4 *)((int)this + 8),param_2,param_3,param_4);
LAB_6767fdef:
      if ((char)uVar2 != '\0') goto LAB_6767fdf3;
      goto LAB_6767fe09;
    }
    if (*(int *)((int)this + 0x14) != 0) goto LAB_6767fd8c;
    iVar7 = *(int *)((int)this + 8);
    if ((*(int *)(iVar7 + 0x2c) == 0) && (*(int *)(iVar7 + 0x28) != -1)) {
      if (*(int *)(iVar7 + 0x28) == 0) {
        *(undefined4 *)((int)this + 0x1c) = 0x8000;
      }
      else {
        *(undefined4 *)((int)this + 0x1c) = *(undefined4 *)(iVar7 + 0x28);
      }
      SVar6 = *(SIZE_T *)((int)this + 0x1c);
      DVar3 = 8;
      pvVar4 = GetProcessHeap();
      for (pvVar5 = HeapAlloc(pvVar4,DVar3,SVar6); *(LPVOID *)((int)this + 0x14) = pvVar5,
          pvVar5 != (LPVOID)0x0; pvVar5 = HeapReAlloc(pvVar4,DVar3,pvVar5,SVar6)) {
LAB_6767fd8c:
        if (puVar1 <= (undefined4 *)(*(int *)((int)this + 0x1c) - *(int *)((int)this + 0x18))) {
          FUN_676b06d0((undefined4 *)(*(int *)((int)this + 0x14) + *(int *)((int)this + 0x18)),
                       param_2,(uint)puVar1);
          *(int *)((int)this + 0x18) = *(int *)((int)this + 0x18) + (int)puVar1;
          uVar2 = *(uint *)((int)this + 0x18);
          if (((char)param_4 == '\0') || (*(int **)((int)this + 4) == (int *)0x0))
          goto LAB_6767fdf3;
          uVar2 = (**(code **)(**(int **)((int)this + 4) + 0x20))
                            (param_1,*(undefined4 *)((int)this + 8),
                             *(undefined4 *)((int)this + 0x14),uVar2,1);
          goto LAB_6767fdef;
        }
        SVar6 = *(int *)((int)this + 0x1c) + 0x8000;
        *(SIZE_T *)((int)this + 0x1c) = SVar6;
        pvVar5 = *(LPVOID *)((int)this + 0x14);
        DVar3 = 8;
        pvVar4 = GetProcessHeap();
      }
    }
    iVar8 = 0x4000000;
    iVar7 = 0x1ff;
  }
  else {
    uVar2 = WriteFile(*(HANDLE *)((int)this + 0xc),param_2,(DWORD)param_3,(LPDWORD)&param_2,
                      (LPOVERLAPPED)0x0);
    if (uVar2 != 0) {
      if (param_2 == puVar1) goto LAB_6767fdf3;
      DVar3 = GetLastError();
      iVar8 = 0x2000000;
      if (DVar3 == 0x70) {
        iVar7 = 0x78;
        goto LAB_6767fe01;
      }
    }
    iVar8 = 0x2000000;
    iVar7 = 0x66;
  }
LAB_6767fe01:
  uVar2 = FUN_6767ca9c(param_1,iVar7,iVar8);
LAB_6767fe09:
  return uVar2 & 0xffffff00;
}



// Function: FUN_6767fe12 at 6767fe12

void __thiscall FUN_6767fe12(void *this,undefined4 param_1)

{
  *(undefined4 *)((int)this + 0xc) = 0xffffffff;
  *(undefined4 *)((int)this + 4) = param_1;
  *(undefined ***)this = &PTR_FUN_676b99e0;
  *(undefined4 *)((int)this + 8) = 0;
  *(undefined4 *)((int)this + 0x10) = 0;
  *(undefined4 *)((int)this + 0x18) = 0;
  *(undefined4 *)((int)this + 0x14) = 0;
  *(undefined1 *)((int)this + 0x1c) = 0;
  *(undefined1 *)((int)this + 0x1d) = 0;
  return;
}



// Function: FUN_6767fe3c at 6767fe3c

undefined4 * __thiscall FUN_6767fe3c(void *this,byte param_1)

{
  FUN_6767fe58((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_6767fe58 at 6767fe58

void __fastcall FUN_6767fe58(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b99e0;
  FUN_6767ff8e((int)param_1);
  return;
}



// Function: FUN_6767fe90 at 6767fe90

uint __thiscall FUN_6767fe90(void *this,void *param_1,int param_2)

{
  bool bVar1;
  uint uVar2;
  HANDLE pvVar3;
  int iVar4;
  int iVar5;
  void *local_8;
  
  local_8 = this;
  FUN_6767ff8e((int)this);
  if (param_2 == 0) {
    iVar5 = 0x4000000;
    iVar4 = 999;
LAB_6767ff82:
    pvVar3 = (HANDLE)FUN_6767ca9c(param_1,iVar4,iVar5);
LAB_6767ff8a:
    uVar2 = (uint)pvVar3 & 0xffffff00;
  }
  else {
    *(int *)((int)this + 8) = param_2;
    pvVar3 = (HANDLE)FUN_676ae2a4(*(short **)(param_2 + 0x170));
    if (pvVar3 != (HANDLE)0x0) {
      bVar1 = true;
      do {
        pvVar3 = FUN_676aeee9(*(LPCWSTR *)(*(int *)((int)this + 8) + 0x170),0x80000000,1,
                              (LPSECURITY_ATTRIBUTES)0x0,3,0x8000080,(HANDLE)0x0);
        *(HANDLE *)((int)this + 0xc) = pvVar3;
        if (pvVar3 == (HANDLE)0xffffffff) {
          local_8 = (void *)0x0;
          if (*(int **)((int)this + 4) != (int *)0x0) {
            pvVar3 = (HANDLE)(**(code **)(**(int **)((int)this + 4) + 0x3c))
                                       (param_1,*(undefined4 *)((int)this + 8),&local_8);
            if ((char)pvVar3 == '\0') goto LAB_6767ff8a;
            if (local_8 == (void *)0x1) goto LAB_6767ff2a;
            if (local_8 == (void *)0x2) {
              pvVar3 = FUN_676aeee9(*(LPCWSTR *)(*(int *)((int)this + 8) + 0x170),0x80000000,3,
                                    (LPSECURITY_ATTRIBUTES)0x0,3,0x8000080,(HANDLE)0x0);
              *(HANDLE *)((int)this + 0xc) = pvVar3;
              if (pvVar3 != (HANDLE)0xffffffff) {
                pvVar3 = (HANDLE)FUN_6767ca9c(param_1,0x140,0x1000000);
                break;
              }
            }
          }
          iVar5 = 0x2000000;
          iVar4 = 0x67;
          goto LAB_6767ff82;
        }
        bVar1 = false;
LAB_6767ff2a:
      } while (bVar1);
    }
    *(undefined1 *)((int)this + 0x1d) = 1;
    uVar2 = CONCAT31((int3)((uint)pvVar3 >> 8),1);
  }
  return uVar2;
}



// Function: FUN_6767ff8e at 6767ff8e

undefined4 __fastcall FUN_6767ff8e(int param_1)

{
  undefined *puVar1;
  
  if (*(HANDLE *)(param_1 + 0xc) != (HANDLE)0xffffffff) {
    CloseHandle(*(HANDLE *)(param_1 + 0xc));
    *(undefined4 *)(param_1 + 0xc) = 0xffffffff;
  }
  puVar1 = *(undefined **)(param_1 + 0x10);
  if (puVar1 != (undefined *)0x0) {
    puVar1 = (undefined *)FUN_676b0bb3(puVar1);
    *(undefined4 *)(param_1 + 0x10) = 0;
  }
  *(undefined4 *)(param_1 + 0x18) = 0;
  *(undefined4 *)(param_1 + 0x14) = 0;
  *(undefined4 *)(param_1 + 8) = 0;
  *(undefined1 *)(param_1 + 0x1c) = 0;
  *(undefined1 *)(param_1 + 0x1d) = 0;
  return CONCAT31((int3)((uint)puVar1 >> 8),1);
}



// Function: FUN_6767ffce at 6767ffce

undefined4 __thiscall
FUN_6767ffce(void *this,void *param_1,undefined4 *param_2,uint param_3,LPDWORD param_4,
            undefined1 *param_5)

{
  int *piVar1;
  int *piVar2;
  BOOL BVar3;
  undefined1 *puVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  
  if ((((*(char *)((int)this + 0x1d) == '\0') || (param_2 == (undefined4 *)0x0)) || (param_3 == 0))
     || ((param_4 == (LPDWORD)0x0 || (param_5 == (undefined1 *)0x0)))) {
    iVar7 = 0x4000000;
    iVar6 = 999;
  }
  else {
    *param_5 = 0;
    *param_4 = 0;
    if (*(HANDLE *)((int)this + 0xc) == (HANDLE)0xffffffff) {
      piVar1 = (int *)((int)this + 0x10);
      if ((*(undefined **)((int)this + 0x10) != (undefined *)0x0) &&
         (*(int *)((int)this + 0x18) == 0)) {
        FUN_676b0bb3(*(undefined **)((int)this + 0x10));
        *piVar1 = 0;
      }
      if (*piVar1 == 0) {
        puVar4 = (undefined1 *)((int)this + 0x1c);
        if (*(char *)((int)this + 0x1c) == '\0') {
          if (*(int **)((int)this + 4) == (int *)0x0) {
            *puVar4 = 1;
          }
          else {
            piVar2 = (int *)((int)this + 0x14);
            uVar5 = (**(code **)(**(int **)((int)this + 4) + 0x1c))
                              (param_1,*(undefined4 *)((int)this + 8),piVar1,piVar2,puVar4);
            if ((char)uVar5 == '\0') goto LAB_67680104;
            if (((undefined *)*piVar1 == (undefined *)0x0) || (*piVar2 != 0)) {
              puVar4 = (undefined1 *)*piVar2;
              *(undefined1 **)((int)this + 0x18) = puVar4;
            }
            else {
              puVar4 = (undefined1 *)FUN_676b0bb3((undefined *)*piVar1);
              *piVar1 = 0;
            }
          }
        }
        if (*piVar1 != 0) goto LAB_676800b5;
      }
      else {
LAB_676800b5:
        uVar5 = *(uint *)((int)this + 0x18);
        if (param_3 < *(uint *)((int)this + 0x18)) {
          uVar5 = param_3;
        }
        *param_4 = uVar5;
        FUN_676b06d0(param_2,(undefined4 *)
                             ((*(int *)((int)this + 0x14) - *(int *)((int)this + 0x18)) + *piVar1),
                     uVar5);
        puVar4 = (undefined1 *)*param_4;
        *(int *)((int)this + 0x18) = *(int *)((int)this + 0x18) - (int)puVar4;
      }
      if ((*(int *)((int)this + 0x18) != 0) || (*(char *)((int)this + 0x1c) == '\0')) {
        *param_5 = 1;
        puVar4 = param_5;
      }
LAB_676800ee:
      return CONCAT31((int3)((uint)puVar4 >> 8),1);
    }
    BVar3 = ReadFile(*(HANDLE *)((int)this + 0xc),param_2,param_3,param_4,(LPOVERLAPPED)0x0);
    if (BVar3 != 0) {
      puVar4 = (undefined1 *)param_3;
      if (*param_4 == param_3) {
        *param_5 = 1;
      }
      goto LAB_676800ee;
    }
    iVar7 = 0x2000000;
    iVar6 = 0x68;
  }
  uVar5 = FUN_6767ca9c(param_1,iVar6,iVar7);
LAB_67680104:
  return uVar5 & 0xffffff00;
}



// Function: FUN_6768010d at 6768010d

void __fastcall FUN_6768010d(undefined4 *param_1)

{
  param_1[2] = 0;
  param_1[4] = 0;
  *param_1 = &PTR_FUN_676b99e4;
  param_1[1] = 0;
  param_1[3] = 0;
  param_1[5] = 0;
  return;
}



// Function: FUN_67680127 at 67680127

undefined4 * __thiscall FUN_67680127(void *this,byte param_1)

{
  FUN_67680143((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_67680143 at 67680143

void __fastcall FUN_67680143(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b99e4;
  return;
}



// Function: FUN_6768014a at 6768014a

void __thiscall FUN_6768014a(void *this,void *param_1,int param_2,char param_3)

{
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  if (param_3 == '\0') {
    local_10 = 0;
    local_c = 0;
    local_8 = 0;
    FUN_6768d2cc((void *)(param_2 + 0x30),param_1,&local_10,0xc);
    *(undefined4 *)((int)this + 4) = local_10;
    *(undefined4 *)((int)this + 0x10) = local_8;
    *(undefined4 *)((int)this + 8) = local_c;
    *(undefined4 *)((int)this + 0x14) = 0;
    *(undefined4 *)((int)this + 0xc) = 0;
  }
  else {
    FUN_6768d2cc((void *)(param_2 + 0x30),param_1,
                 (LPVOID)(-(uint)(this != (void *)0x0) & (int)this + 4U),0x14);
  }
  return;
}



// Function: FUN_676801b4 at 676801b4

uint __thiscall FUN_676801b4(void *this,void *param_1,int param_2,char param_3)

{
  uint uVar1;
  undefined4 *puVar2;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  local_8 = 0x8074b50;
  uVar1 = FUN_6768d357((void *)(param_2 + 0x30),param_1,&local_8,4,0);
  if ((char)uVar1 == '\0') {
LAB_67680249:
    uVar1 = uVar1 & 0xffffff00;
  }
  else {
    if (param_3 == '\0') {
      if ((*(int *)((int)this + 0xc) != 0) || (*(int *)((int)this + 0x14) != 0)) {
        uVar1 = FUN_6767ca9c(param_1,999,0x4000000);
        goto LAB_67680249;
      }
      local_14 = *(undefined4 *)((int)this + 4);
      local_c = *(undefined4 *)((int)this + 0x10);
      local_10 = *(undefined4 *)((int)this + 8);
      uVar1 = 0xc;
      puVar2 = &local_14;
    }
    else {
      uVar1 = 0x14;
      puVar2 = (undefined4 *)(-(uint)(this != (void *)0x0) & (int)this + 4U);
    }
    uVar1 = FUN_6768d357((void *)(param_2 + 0x30),param_1,puVar2,uVar1,0);
  }
  return uVar1;
}



// Function: FUN_67680252 at 67680252

uint FUN_67680252(LPCSTR param_1,LPSTR param_2,uint param_3)

{
  HMODULE hModule;
  FARPROC pFVar1;
  uint uVar2;
  DWORD DVar3;
  
  hModule = GetModuleHandleA(s_KERNEL32_676c0598);
  pFVar1 = GetProcAddress(hModule,s_GetLongPathNameA_676c0584);
  if ((pFVar1 == (FARPROC)0x0) ||
     ((uVar2 = (*pFVar1)(param_1,param_2,param_3), uVar2 == 0 &&
      (DVar3 = GetLastError(), DVar3 == 0x78)))) {
    PTR_FUN_676c0580 = FUN_676802ba;
    uVar2 = FUN_676802ba(param_1,param_2,param_3);
    pFVar1 = (FARPROC)PTR_FUN_676c0580;
  }
  PTR_FUN_676c0580 = pFVar1;
  return uVar2;
}



// Function: FUN_676802ba at 676802ba

uint FUN_676802ba(LPCSTR param_1,LPSTR param_2,uint param_3)

{
  DWORD DVar1;
  HRESULT HVar2;
  BOOL BVar3;
  char *lpMultiByteStr;
  int iVar4;
  WCHAR *lpWideCharStr;
  int cchWideChar;
  uint uVar5;
  WCHAR local_31c [260];
  char local_114 [260];
  IMalloc *local_10;
  LPCITEMIDLIST local_c;
  IShellFolder *local_8;
  
  DVar1 = GetFileAttributesA(param_1);
  if (DVar1 == 0xffffffff) {
    return 0;
  }
  DVar1 = GetFullPathNameA(param_1,0x104,local_114,(LPSTR *)0x0);
  if (DVar1 == 0) {
    return 0;
  }
  if (0x103 < DVar1) {
    SetLastError(0x6f);
    return 0;
  }
  HVar2 = SHGetDesktopFolder(&local_8);
  if (HVar2 < 0) {
    return DVar1;
  }
  lpWideCharStr = local_31c;
  cchWideChar = 0x104;
  lpMultiByteStr = local_114;
  iVar4 = -1;
  DVar1 = 0;
  BVar3 = AreFileApisANSI();
  iVar4 = MultiByteToWideChar((uint)(BVar3 == 0),DVar1,lpMultiByteStr,iVar4,lpWideCharStr,
                              cchWideChar);
  if (iVar4 == 0) {
    DVar1 = GetLastError();
    if (DVar1 == 0x7a) {
      uVar5 = 0x6f;
      goto LAB_67680358;
    }
  }
  else {
    uVar5 = (*local_8->lpVtbl->ParseDisplayName)
                      (local_8,(HWND)0x0,(IBindCtx *)0x0,local_31c,(ULONG *)&param_1,&local_c,
                       (ULONG *)0x0);
    if (-1 < (int)uVar5) {
      BVar3 = SHGetPathFromIDListA(local_c,local_114);
      if ((BVar3 == 0) && (local_114[0] != '\0')) {
        SetLastError(0xd);
        uVar5 = 0;
      }
      else {
        uVar5 = lstrlenA(local_114);
        if (param_3 < uVar5 + 1) {
          SetLastError(0x7a);
          uVar5 = uVar5 + 1;
        }
        else {
          lstrcpynA(param_2,local_114,param_3);
        }
      }
      HVar2 = SHGetMalloc(&local_10);
      if (-1 < HVar2) {
        (*local_10->lpVtbl->Free)(local_10,local_c);
        (*local_10->lpVtbl->Release)(local_10);
      }
      goto LAB_67680421;
    }
    if ((uVar5 & 0x1fff0000) == 0x70000) {
      uVar5 = uVar5 & 0xffff;
    }
    else {
      uVar5 = 0xd;
    }
LAB_67680358:
    SetLastError(uVar5);
  }
  uVar5 = 0;
LAB_67680421:
  (*local_8->lpVtbl->Release)(local_8);
  return uVar5;
}



// Function: FUN_67680433 at 67680433

undefined4 * __thiscall FUN_67680433(void *this,undefined4 param_1)

{
  FUN_67689ecb((undefined4 *)this);
  *(undefined ***)this = &PTR_FUN_676b99e8;
  *(undefined4 *)((int)this + 0x58) = param_1;
  return (undefined4 *)this;
}



// Function: FUN_6768044e at 6768044e

int * __thiscall FUN_6768044e(void *this,byte param_1)

{
  FUN_6768046a((int *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (int *)this;
}



// Function: FUN_6768046a at 6768046a

void __fastcall FUN_6768046a(int *param_1)

{
  *param_1 = (int)&PTR_FUN_676b99e8;
  FUN_67689fca(param_1);
  FUN_67689f01(param_1);
  return;
}



// Function: FUN_67680481 at 67680481

/* WARNING: Type propagation algorithm not settling */

uint FUN_67680481(void *param_1,LPCWSTR param_2,int param_3,LPCWSTR param_4,undefined4 param_5,
                 undefined4 param_6,undefined4 param_7,undefined4 param_8,WCHAR *param_9)

{
  char cVar1;
  int iVar2;
  uint uVar3;
  BOOL BVar4;
  undefined4 *puVar5;
  undefined4 uVar6;
  undefined *puVar7;
  LPCWSTR pWVar8;
  int iVar9;
  int *extraout_ECX;
  LPCSTR lpString;
  bool bVar10;
  undefined4 local_11a4 [130];
  short asStackY_f9a [3];
  WCHAR local_f94 [523];
  short sStackY_b7e;
  WCHAR local_b7c;
  undefined4 local_b7a [130];
  WCHAR local_970 [262];
  WCHAR local_764 [262];
  WCHAR local_558;
  undefined4 local_556 [130];
  char acStackY_34d [263];
  short sStackY_246;
  WCHAR local_244;
  undefined4 local_242 [123];
  undefined4 uStackY_54;
  WCHAR *in_stack_ffffffcc;
  WCHAR *lpMultiByteStr;
  WCHAR *pWVar11;
  int *this;
  DWORD DVar12;
  
  FUN_676b06a0();
  iVar2 = (**(code **)(*extraout_ECX + 0x3c))();
  if (iVar2 != 0) {
    if (extraout_ECX[0x16] != 0) {
      iVar2 = (**(code **)(*extraout_ECX + 0x2c))();
      while (iVar2 != 0) {
        if (iVar2 == 0) {
          iVar2 = 999;
          goto LAB_67680c7b;
        }
        *(int *)((int)param_1 + 0x14) = iVar2;
        *(undefined4 *)((int)param_1 + 4) = 0;
        *(undefined4 *)((int)param_1 + 8) = 0;
        *(undefined1 *)(iVar2 + 0x54) = 0;
        uVar3 = (**(code **)(*(int *)extraout_ECX[0x16] + 4))();
        if (((char)uVar3 == '\0') && (*(int *)((int)param_1 + 8) == 0x4000000)) goto LAB_67680c80;
        *(undefined4 *)((int)param_1 + 0x14) = 0;
        *(undefined4 *)((int)param_1 + 4) = 0;
        *(undefined4 *)((int)param_1 + 8) = 0;
        iVar2 = (**(code **)(*extraout_ECX + 0x34))();
      }
    }
LAB_67680506:
    return CONCAT31((int3)((uint)iVar2 >> 8),1);
  }
  local_b7c = L'\0';
  puVar5 = local_b7a;
  for (iVar2 = 0x82; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar5 = 0;
    puVar5 = puVar5 + 1;
  }
  DVar12 = 0;
  if ((param_2 == (LPCWSTR)0x0) || (*param_2 == L'\0')) {
LAB_676805a7:
    local_244 = L'\0';
    local_558 = L'\0';
    puVar5 = local_242;
    for (iVar2 = 0x82; iVar2 != 0; iVar2 = iVar2 + -1) {
      *puVar5 = 0;
      puVar5 = puVar5 + 1;
    }
    puVar5 = local_556;
    for (iVar2 = 0x82; iVar2 != 0; iVar2 = iVar2 + -1) {
      *puVar5 = 0;
      puVar5 = puVar5 + 1;
    }
    this = extraout_ECX;
    if (((char)param_9 == '\0') || ((int)DVar12 < 1)) {
LAB_67680792:
      puVar7 = *(undefined **)(param_3 + 4);
      if ((puVar7 == (undefined *)0x0) &&
         (puVar7 = *(undefined **)(param_3 + 0x10), puVar7 == (undefined *)0x0)) {
        puVar7 = &DAT_676c5678;
      }
      FUN_6768199d(&stack0xffffffc8,(int)puVar7);
      do {
        puVar7 = *(undefined **)(param_3 + 0x10);
        if (puVar7 == (undefined *)0x0) {
          puVar7 = &DAT_676c5678;
        }
        iVar2 = FUN_676819f5(&stack0xffffffc8,(int)puVar7);
        if ((char)iVar2 == '\0') goto LAB_67680506;
        uVar3 = FUN_676ae2a4(in_stack_ffffffcc);
        if (0x107 < uVar3) goto LAB_67680c6e;
        if (DVar12 == 0) {
          FUN_676ae1fc(asStackY_f9a + 3,in_stack_ffffffcc);
        }
        else {
          FUN_676ae1fc(asStackY_f9a + 3,&local_b7c);
          FUN_676ae1fc(asStackY_f9a + DVar12 + 3,in_stack_ffffffcc);
          uVar3 = uVar3 + DVar12;
        }
        if (((2 < uVar3) && (asStackY_f9a[uVar3 + 2] == 0x3e)) && (asStackY_f9a[uVar3] == 0x3c)) {
          asStackY_f9a[uVar3] = 0;
        }
        param_2 = (LPCWSTR)0x0;
        FUN_676ac8da(asStackY_f9a + 3,local_764,&local_244,&local_558);
        if ((char)param_6 != '\0') {
          if (DVar12 == 0) {
            FUN_676ae2a4(local_764);
            param_2 = (LPCWSTR)FUN_676af969(local_764,local_970,0x105);
          }
          else {
            param_2 = (LPCWSTR)FUN_676af969(&local_b7c,local_970,0x105);
          }
          bVar10 = param_2 == (LPCWSTR)0x0;
          if (0 < (int)param_2) {
            if ((int)param_2 < 0x106) {
              if (&stack0x00000000 != (undefined1 *)0x970) {
                iVar2 = lstrlenW(local_970);
                FUN_676b06a0();
                this = (int *)((uint)this & 0xffffff00);
                WideCharToMultiByte(0,0,local_970,-1,&stack0xfffffff0,iVar2 * 2 + 2,(LPCSTR)0x0,
                                    (LPBOOL)0x0);
              }
              param_2 = (LPCWSTR)(*(code *)PTR_FUN_676c0580)();
              bVar10 = param_2 == (LPCWSTR)0x0;
              if ((int)param_2 < 1) goto LAB_676809ae;
              if ((((int)param_2 < 0x106) && (acStackY_34d[(int)param_2] != '\\')) &&
                 (acStackY_34d[(int)param_2] != '/')) {
                param_2 = (LPCWSTR)((int)param_2 + 1);
              }
            }
            bVar10 = param_2 == (LPCWSTR)0x0;
          }
LAB_676809ae:
          if (bVar10) {
            if (&stack0x00000000 == (undefined1 *)0x764) {
              lpString = (LPCSTR)0x0;
            }
            else {
              lpString = &stack0xfffffff0;
              iVar2 = lstrlenW(local_764);
              FUN_676b06a0();
              this = (int *)((uint)this & 0xffffff00);
              WideCharToMultiByte(0,0,local_764,-1,&stack0xfffffff0,iVar2 * 2 + 2,(LPCSTR)0x0,
                                  (LPBOOL)0x0);
            }
            param_2 = (LPCWSTR)lstrlenA(lpString);
            if ((param_2 == (LPCWSTR)0x0) && (0 < (int)lpString)) goto LAB_67680c62;
          }
          else if (0x105 < (int)param_2) goto LAB_67680c6e;
        }
        pWVar11 = local_970;
        FUN_676acade(pWVar11,&local_244);
        lpMultiByteStr = &local_244;
        FUN_676aca6b((int)lpMultiByteStr,&local_244);
        FUN_676ae272(local_764,&local_244);
        FUN_676ae2a4(local_764);
        pWVar8 = (LPCWSTR)FUN_676af969(local_764,&local_244,0x105);
        bVar10 = pWVar8 == (LPCWSTR)0x0;
        if (0 < (int)pWVar8) {
          if ((int)pWVar8 < 0x106) {
            if (&stack0x00000000 != (undefined1 *)0x244) {
              iVar2 = lstrlenW(&local_244);
              FUN_676b06a0();
              this = (int *)((uint)this & 0xffffff00);
              WideCharToMultiByte(0,0,&local_244,-1,&stack0xfffffff0,iVar2 * 2 + 2,(LPCSTR)0x0,
                                  (LPBOOL)0x0);
            }
            pWVar11 = (WCHAR *)((int)acStackY_34d + 1);
            lpMultiByteStr =
                 L"\xf88b\xffff\xfff8\xf88b"
            ;
            pWVar8 = (LPCWSTR)(*(code *)PTR_FUN_676c0580)();
            bVar10 = pWVar8 == (LPCWSTR)0x0;
            if ((int)pWVar8 < 1) goto LAB_67680b06;
            if ((((int)pWVar8 < 0x106) && (acStackY_34d[(int)pWVar8] != '\\')) &&
               (acStackY_34d[(int)pWVar8] != '/')) {
              *(undefined1 *)((int)acStackY_34d + 1U + (int)pWVar8) = 0x5c;
              pWVar8 = (LPCWSTR)((int)pWVar8 + 1);
              *(undefined1 *)((int)acStackY_34d + 1U + (int)pWVar8) = 0;
            }
          }
          bVar10 = pWVar8 == (LPCWSTR)0x0;
        }
LAB_67680b06:
        if (bVar10) {
          pWVar11 = (WCHAR *)0x0;
          lpMultiByteStr = (WCHAR *)((int)acStackY_34d + 1);
          pWVar8 = (LPCWSTR)WideCharToMultiByte(0,0,local_764,-1,(LPSTR)lpMultiByteStr,0x105,
                                                (LPCSTR)0x0,(LPBOOL)0x0);
          if (pWVar8 == (LPCWSTR)0x0) goto LAB_67680c62;
        }
        else if (0x105 < (int)pWVar8) goto LAB_67680c6e;
        if ((char)param_6 == '\0') {
          param_2 = pWVar8;
        }
        iVar2 = (**(code **)(*this + 0x3c))();
        param_9 = (WCHAR *)CONCAT13(1,param_9._0_3_);
        in_stack_ffffffcc = local_970;
        uStackY_54 = 0x67680b9b;
        uVar3 = FUN_67680cd3(this,param_1,local_764,param_4,(LPCWSTR)((int)&param_9 + 3),
                             (LPCSTR)((int)acStackY_34d + 1),(int)pWVar8,(int)param_2,
                             in_stack_ffffffcc,&local_558,lpMultiByteStr,param_6,param_4,param_7,
                             (uint)lpMultiByteStr,pWVar11,(char *)((int)&param_9 + 3));
        if ((char)uVar3 == '\0') goto LAB_67680c80;
        iVar9 = (**(code **)(*this + 0x3c))();
        if (iVar9 == iVar2) {
          FUN_67688abc(local_11a4);
          if (&stack0x00000000 != (undefined1 *)0xf94) {
            iVar2 = lstrlenW(asStackY_f9a + 3);
            FUN_676b06a0();
            this = (int *)((uint)this & 0xffffff00);
            in_stack_ffffffcc = L"\xf070\xffff\xee60\xffff";
            WideCharToMultiByte(0,0,asStackY_f9a + 3,-1,&stack0xfffffff0,iVar2 * 2 + 2,(LPCSTR)0x0,
                                (LPBOOL)0x0);
          }
          FUN_67680c87((int)local_11a4);
          *(undefined4 **)((int)param_1 + 0x14) = local_11a4;
          *(undefined4 *)((int)param_1 + 4) = 0;
          *(undefined4 *)((int)param_1 + 8) = 0;
          FUN_6767ca9c(param_1,0x143,0x1000000);
          *(undefined4 *)((int)param_1 + 0x14) = 0;
          *(undefined4 *)((int)param_1 + 4) = 0;
          *(undefined4 *)((int)param_1 + 8) = 0;
          FUN_67688c3b(local_11a4);
        }
        FUN_676819c4((int)&stack0xffffffc8);
      } while( true );
    }
    FUN_676ac8da(&local_b7c,&local_244,(short *)0x0,(short *)0x0);
    if (((&stack0x00000000 == (undefined1 *)0x244) || (iVar2 = FUN_676ae2a4(&local_244), iVar2 == 0)
        ) || ((iVar2 = FUN_676ae2a4(&local_244), (&sStackY_246)[iVar2] != 0x5c &&
              (iVar2 = FUN_676ae2a4(&local_244), (&sStackY_246)[iVar2] != 0x2f)))) {
      FUN_676ae272(&local_244,(short *)&DAT_676c057c);
    }
    in_stack_ffffffcc = L"\x01";
    BVar4 = FUN_676af62f(&local_244,&local_558,0x105,(LPDWORD)0x0,(LPDWORD)0x0,(LPDWORD)0x0,
                         (LPWSTR)0x0,0);
    if (BVar4 == 0) goto LAB_67680792;
    puVar5 = (undefined4 *)operator_new(0x210);
    if (puVar5 == (undefined4 *)0x0) {
      param_9 = (WCHAR *)0x0;
    }
    else {
      param_9 = (WCHAR *)FUN_67688abc(puVar5);
    }
    if (param_9 != (WCHAR *)0x0) {
      param_9[0x1a] = L'\b';
      param_9[0x1b] = L'\0';
      if (&stack0x00000000 != (undefined1 *)0x558) {
        iVar2 = lstrlenW(&local_558);
        FUN_676b06a0();
        this = (int *)((uint)extraout_ECX & 0xffffff00);
        in_stack_ffffffcc = L"\xfffa\xe8ce";
        WideCharToMultiByte(0,0,&local_558,-1,&stack0xfffffff0,iVar2 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0
                           );
      }
      pWVar11 = param_9;
      FUN_67680c87((int)param_9);
      if (&stack0x00000000 == (undefined1 *)0x558) {
        param_9 = (WCHAR *)&DAT_676c509c;
      }
      else {
        param_9 = &local_558;
      }
      Ordinal_6();
      uVar6 = Ordinal_2();
      *(undefined4 *)(pWVar11 + 0xb8) = uVar6;
      cVar1 = (**(code **)(*this + 0x40))();
      if (cVar1 == '\0') {
        (*(code *)**(undefined4 **)pWVar11)();
        goto LAB_67680792;
      }
      *(WCHAR **)((int)param_1 + 0x14) = pWVar11;
      *(undefined4 *)((int)param_1 + 4) = 0;
      *(undefined4 *)((int)param_1 + 8) = 0;
      if ((((int *)this[0x16] == (int *)0x0) ||
          (uVar3 = (**(code **)(*(int *)this[0x16] + 4))(), (char)uVar3 != '\0')) ||
         (*(int *)((int)param_1 + 8) != 0x4000000)) {
        *(undefined4 *)((int)param_1 + 0x14) = 0;
        *(undefined4 *)((int)param_1 + 4) = 0;
        *(undefined4 *)((int)param_1 + 8) = 0;
        goto LAB_67680792;
      }
      goto LAB_67680c80;
    }
LAB_67680c6e:
    iVar2 = 0x1ff;
  }
  else {
    DVar12 = FUN_676aeff1(param_2,0x105,&local_b7c,(LPWSTR *)0x0);
    if (DVar12 != 0) {
      if ((int)DVar12 < 0x106) {
        iVar2 = DVar12 * 2;
        if (((&sStackY_b7e)[DVar12] != 0x5c) && ((&sStackY_b7e)[DVar12] != 0x2f)) {
          DVar12 = DVar12 + 1;
          *(undefined2 *)((int)local_b7a + iVar2 + -2) = 0x5c;
          *(undefined2 *)((int)local_b7a + DVar12 * 2 + -2) = 0;
        }
        goto LAB_676805a7;
      }
      goto LAB_67680c6e;
    }
LAB_67680c62:
    iVar2 = 999;
  }
LAB_67680c7b:
  uVar3 = FUN_6767ca9c(param_1,iVar2,0x4000000);
LAB_67680c80:
  return uVar3 & 0xffffff00;
}



// Function: FUN_67680c87 at 67680c87

void __fastcall FUN_67680c87(int param_1)

{
  undefined4 uVar1;
  LPCSTR unaff_retaddr;
  
  Ordinal_6(*(undefined4 *)(param_1 + 0x16c));
  uVar1 = Ordinal_2(unaff_retaddr);
  *(undefined4 *)(param_1 + 0x16c) = uVar1;
  if (unaff_retaddr == (LPCSTR)0x0) {
    unaff_retaddr = &DAT_676c5098;
  }
  lstrcpyA((LPSTR)(param_1 + 100),unaff_retaddr);
  FUN_676ad4c2((LPSTR)(param_1 + 100),'\\','/');
  return;
}



// Function: FUN_67680cd3 at 67680cd3

undefined4 __thiscall
FUN_67680cd3(void *this,void *param_1,LPCWSTR param_2,LPCWSTR param_3,LPCWSTR param_4,LPCSTR param_5
            ,int param_6,int param_7,short *param_8,short *param_9,undefined4 param_10,
            undefined4 param_11,void *param_12,undefined4 param_13,uint param_14,undefined4 param_15
            ,char *param_16)

{
  char cVar1;
  undefined4 *puVar2;
  uint uVar3;
  int *piVar4;
  undefined4 uVar5;
  LPCWSTR pWVar6;
  LPCSTR pCVar7;
  bool bVar8;
  int iVar9;
  short *psVar10;
  _WIN32_FIND_DATAW local_278;
  int *local_28;
  LPCWSTR local_24;
  LPCWSTR local_20;
  char local_19;
  int *local_18;
  char local_11;
  int *local_10;
  HANDLE local_c;
  LPCSTR local_8;
  
  local_10 = (int *)this;
  if ((((((param_2 == (LPCWSTR)0x0) || (param_5 == (LPCSTR)0x0)) || (param_8 == (short *)0x0)) ||
       (param_9 == (short *)0x0)) ||
      ((((char)param_11 == '\0' && ((param_4 != param_3 || (param_7 != param_6)))) ||
       ((int)param_3 < (int)param_4)))) || (param_6 < param_7)) {
    iVar9 = 999;
LAB_67681359:
    local_10 = (int *)FUN_6767ca9c(param_1,iVar9,0x4000000);
LAB_6768135e:
    return (uint)local_10 & 0xffffff00;
  }
  local_11 = '\0';
  if (((char)param_10 == '\0') && (*param_8 == 0)) {
    local_11 = '\x01';
    psVar10 = param_9;
  }
  else {
    psVar10 = (short *)&DAT_676c05a4;
  }
  local_20 = param_2 + (int)param_3;
  FUN_676ae1fc(local_20,psVar10);
  local_c = FUN_676aee00(param_2,&local_278);
  local_18 = (int *)0x0;
  *param_16 = '\x01';
  local_28 = (int *)FUN_676acb37(param_8);
  piVar4 = local_28;
  if (local_c != (HANDLE)0xffffffff) {
    do {
      if (((byte)local_278.dwFileAttributes & 0x10) != 0) {
        if ((local_278.cFileName[0] == L'.') && (local_278.cFileName[1] == L'\0')) {
          if ((((char)param_11 == '\0') || (*param_8 != 0)) ||
             (((int)param_3 <= (int)param_4 || ((*param_9 != 0 && (param_14 == 0))))))
          goto LAB_67681229;
          if (local_18 != (int *)0x0) {
            FindClose(local_c);
            iVar9 = 999;
            goto LAB_67681359;
          }
          puVar2 = (undefined4 *)operator_new(0x210);
          if (puVar2 == (undefined4 *)0x0) {
            local_18 = (int *)0x0;
          }
          else {
            local_18 = FUN_67688abc(puVar2);
          }
          if (local_18 == (int *)0x0) {
            FindClose(local_c);
            goto LAB_676812aa;
          }
          *local_20 = L'\0';
          uVar3 = FUN_6768136d(param_1,local_18,&local_278.dwFileAttributes,
                               (int)(param_2 + (int)param_4),(int)(param_5 + param_7),(int)param_2,
                               (byte)param_13);
          if ((char)uVar3 != '\0') goto LAB_67681229;
          (**(code **)*local_18)(1);
          local_18 = (int *)0x0;
LAB_67680e6a:
          bVar8 = *(int *)((int)param_1 + 8) == 0x4000000;
        }
        else {
          if ((((char)param_10 == '\0') && (*param_8 == 0)) ||
             ((((local_278.cFileName[0] == L'.' && (local_278.cFileName[1] == L'.')) &&
               (local_278.cFileName[2] == L'\0')) ||
              (iVar9 = FUN_676ace2b(local_278.cFileName,param_8), iVar9 == 0)))) goto LAB_67681229;
          FUN_676ae1fc(local_20,local_278.cFileName);
          iVar9 = FUN_676ae2a4(local_278.cFileName);
          param_2[iVar9 + (int)param_3] = L'\\';
          local_24 = (LPCWSTR)(iVar9 + (int)param_3 + 1);
          param_2[(int)local_24] = L'\0';
          if (local_278.cAlternateFileName[0] == L'\0') {
            if (&stack0x00000000 == (undefined1 *)0x24c) {
              local_8 = (LPCSTR)0x0;
            }
            else {
              iVar9 = lstrlenW(local_278.cFileName);
              local_8 = (LPCSTR)(iVar9 * 2 + 2);
              FUN_676b06a0();
              WideCharToMultiByte(0,0,local_278.cFileName,-1,&stack0xfffffd7c,(int)local_8,
                                  (LPCSTR)0x0,(LPBOOL)0x0);
              local_8 = &stack0xfffffd7c;
            }
            lstrcpyA(param_5 + param_6,local_8);
            iVar9 = lstrlenA(local_8);
            iVar9 = iVar9 + param_6;
          }
          else {
            if (&stack0x00000000 == (undefined1 *)0x44) {
              pCVar7 = (LPCSTR)0x0;
            }
            else {
              pCVar7 = &stack0xfffffd7c;
              iVar9 = lstrlenW(local_278.cAlternateFileName);
              local_8 = (LPCSTR)(iVar9 * 2 + 2);
              FUN_676b06a0();
              WideCharToMultiByte(0,0,local_278.cAlternateFileName,-1,&stack0xfffffd7c,(int)local_8,
                                  (LPCSTR)0x0,(LPBOOL)0x0);
            }
            lstrcpyA(param_5 + param_6,pCVar7);
            (*(code *)PTR_FUN_676c0580)(param_5,param_5,0x105);
            iVar9 = lstrlenA(param_5);
          }
          param_5[iVar9] = '\\';
          iVar9 = iVar9 + 1;
          param_5[iVar9] = '\0';
          local_19 = '\x01';
          pWVar6 = local_24;
          local_8 = (LPCSTR)iVar9;
          if ((char)param_11 != '\0') {
            pWVar6 = param_4;
            local_8 = (LPCSTR)param_7;
          }
          uVar5 = FUN_67680cd3(local_10,param_1,param_2,local_24,pWVar6,param_5,iVar9,(int)local_8,
                               (short *)local_28,param_9,param_10,param_11,param_12,param_13,
                               param_14,param_15,&local_19);
          bVar8 = (char)uVar5 == '\0';
        }
        if (!bVar8) goto LAB_67681229;
LAB_676812bb:
        local_10 = (int *)FindClose(local_c);
        goto LAB_6768135e;
      }
      if ((*param_8 == 0) &&
         ((local_11 != '\0' || (iVar9 = FUN_676acdfe(local_278.cFileName,param_9), iVar9 != 0)))) {
        iVar9 = FUN_676ae2a4(local_278.cFileName);
        if (iVar9 + (int)param_3 < 0x105) {
          FUN_676ae1fc(local_20,local_278.cFileName);
          if (local_278.cAlternateFileName[0] == L'\0') {
            if (&stack0x00000000 == (undefined1 *)0x24c) {
              pCVar7 = (LPCSTR)0x0;
            }
            else {
              pCVar7 = &stack0xfffffd7c;
              iVar9 = lstrlenW(local_278.cFileName);
              local_8 = (LPCSTR)(iVar9 * 2 + 2);
              FUN_676b06a0();
              WideCharToMultiByte(0,0,local_278.cFileName,-1,&stack0xfffffd7c,(int)local_8,
                                  (LPCSTR)0x0,(LPBOOL)0x0);
            }
            lstrcpyA(param_5 + param_6,pCVar7);
          }
          else {
            if (&stack0x00000000 == (undefined1 *)0x44) {
              pCVar7 = (LPCSTR)0x0;
            }
            else {
              pCVar7 = &stack0xfffffd7c;
              iVar9 = lstrlenW(local_278.cAlternateFileName);
              local_8 = (LPCSTR)(iVar9 * 2 + 2);
              FUN_676b06a0();
              WideCharToMultiByte(0,0,local_278.cAlternateFileName,-1,&stack0xfffffd7c,(int)local_8,
                                  (LPCSTR)0x0,(LPBOOL)0x0);
            }
            lstrcpyA(param_5 + param_6,pCVar7);
            (*(code *)PTR_FUN_676c0580)(param_5,param_5,0x105);
          }
          puVar2 = (undefined4 *)operator_new(0x210);
          if (puVar2 == (undefined4 *)0x0) {
            piVar4 = (int *)0x0;
          }
          else {
            piVar4 = FUN_67688abc(puVar2);
          }
          if (piVar4 != (int *)0x0) {
            local_24 = param_2 + (int)param_4;
            uVar3 = FUN_6768136d(param_1,piVar4,&local_278.dwFileAttributes,(int)local_24,
                                 (int)(param_5 + param_7),(int)param_2,(byte)param_13);
            if ((char)uVar3 == '\0') {
LAB_6768120b:
              (**(code **)*piVar4)(1);
              goto LAB_67680e6a;
            }
            iVar9 = *local_10;
            uVar5 = (**(code **)(*piVar4 + 4))(piVar4,0);
            cVar1 = (**(code **)(iVar9 + 0x40))(uVar5);
            if (cVar1 == '\0') goto LAB_6768120b;
            *(int **)((int)param_1 + 0x14) = piVar4;
            *(undefined4 *)((int)param_1 + 4) = 0;
            *(undefined4 *)((int)param_1 + 8) = 0;
            if (piVar4[0x13] == 0) {
              uVar5 = FUN_676ae612(param_12,local_24,'\x01','\0','\x01','\0');
              if ((char)uVar5 == '\0') {
                *param_16 = '\0';
              }
              else {
                piVar4[0x13] = 1;
              }
            }
            if ((((int *)local_10[0x16] == (int *)0x0) ||
                (cVar1 = (**(code **)(*(int *)local_10[0x16] + 4))(param_1,piVar4,local_10),
                cVar1 != '\0')) || (*(int *)((int)param_1 + 8) != 0x4000000)) {
              *(undefined4 *)((int)param_1 + 0x14) = 0;
              *(undefined4 *)((int)param_1 + 4) = 0;
              *(undefined4 *)((int)param_1 + 8) = 0;
              goto LAB_67681229;
            }
            goto LAB_676812bb;
          }
LAB_676812aa:
          iVar9 = 0x1ff;
          goto LAB_67681359;
        }
        FUN_6767ca9c(param_1,0x148,0x1000000);
      }
LAB_67681229:
      if (((int *)local_10[0x16] != (int *)0x0) &&
         (cVar1 = (**(code **)(*(int *)local_10[0x16] + 0x60))(param_1), cVar1 == '\0'))
      goto LAB_676812bb;
      piVar4 = (int *)FUN_676aee96(local_c,&local_278);
      if (piVar4 == (int *)0x0) {
        piVar4 = (int *)FindClose(local_c);
        local_c = (HANDLE)0xffffffff;
      }
    } while (local_c != (HANDLE)0xffffffff);
    if (local_18 != (int *)0x0) {
      if ((*param_16 == '\0') || ((param_14 & 2) != 0)) {
        iVar9 = *local_10;
        uVar5 = (**(code **)(*local_18 + 4))(local_18,0);
        cVar1 = (**(code **)(iVar9 + 0x40))(uVar5);
        piVar4 = local_18;
        if (cVar1 != '\0') {
          *(undefined4 *)((int)param_1 + 4) = 0;
          *(int **)((int)param_1 + 0x14) = local_18;
          *(undefined4 *)((int)param_1 + 8) = 0;
          if (local_18[0x13] == 0) {
            *local_20 = L'\0';
            uVar5 = FUN_676ae612(param_12,param_2 + (int)param_4,'\0',(char)param_11,'\x01','\0');
            if ((char)uVar5 != '\0') {
              piVar4[0x13] = 1;
            }
          }
          if ((((int *)local_10[0x16] != (int *)0x0) &&
              (local_10 = (int *)(**(code **)(*(int *)local_10[0x16] + 4))(param_1,piVar4,local_10),
              (char)local_10 == '\0')) && (*(int *)((int)param_1 + 8) == 0x4000000))
          goto LAB_6768135e;
          *(undefined4 *)((int)param_1 + 0x14) = 0;
          *(undefined4 *)((int)param_1 + 4) = 0;
          *(undefined4 *)((int)param_1 + 8) = 0;
          piVar4 = local_10;
          goto LAB_67681348;
        }
      }
      piVar4 = (int *)(**(code **)*local_18)(1);
    }
  }
LAB_67681348:
  return CONCAT31((int3)((uint)piVar4 >> 8),1);
}



// Function: FUN_6768136d at 6768136d

uint FUN_6768136d(void *param_1,void *param_2,uint *param_3,int param_4,int param_5,int param_6,
                 byte param_7)

{
  undefined4 uVar1;
  uint uVar2;
  undefined4 auStack_50 [3];
  undefined4 uStack_44;
  undefined1 local_24 [8];
  undefined4 local_1c [6];
  
  if ((((param_3 == (uint *)0x0) || (param_4 == 0)) || (param_5 == 0)) || (param_6 == 0)) {
    uVar2 = FUN_6767ca9c(param_1,999,0x4000000);
    uVar2 = uVar2 & 0xffffff00;
  }
  else {
    FUN_67680c87((int)param_2);
    Ordinal_6();
    uVar1 = Ordinal_2();
    *(undefined4 *)((int)param_2 + 0x170) = uVar1;
    *(uint *)((int)param_2 + 0x34) = *param_3 & 0xffffff7f;
    uVar2 = param_3[7];
    *(uint *)((int)param_2 + 0x28) = param_3[8];
    *(uint *)((int)param_2 + 0x2c) = uVar2;
    uStack_44 = 0x676813ec;
    FUN_676814cd(local_24,param_3[5],param_3[6]);
    FUN_67681545((int)local_24);
    FUN_676b06d0(auStack_50,local_1c,0x10);
    FUN_676815b7(param_2);
    uStack_44 = 0x67681433;
    FUN_67681512((int)local_24);
    FUN_67681545((int)local_24);
    FUN_676b06d0(auStack_50,local_1c,0x10);
    FUN_6768166a(param_2);
    uStack_44 = 0x67681475;
    FUN_67681512((int)local_24);
    FUN_67681545((int)local_24);
    FUN_676b06d0(auStack_50,local_1c,0x10);
    FUN_67681635(param_2);
    uStack_44 = 0x676814b0;
    uVar2 = FUN_67689882(param_2,param_1,param_7);
  }
  return uVar2;
}



// Function: FUN_676814cd at 676814cd

undefined4 * __thiscall FUN_676814cd(void *this,DWORD param_1,DWORD param_2)

{
  BOOL BVar1;
  int iVar2;
  
  *(undefined ***)this = &PTR_LAB_676b9950;
  BVar1 = FileTimeToSystemTime((FILETIME *)&param_1,(LPSYSTEMTIME)((int)this + 8));
  if (BVar1 == 0) {
    param_2 = 0;
    param_1 = 0;
  }
  iVar2 = Ordinal_184((LPSYSTEMTIME)((int)this + 8),(undefined8 *)((int)this + 0x18));
  if (iVar2 == 0) {
    *(undefined8 *)((int)this + 0x18) = 0x4000000000000000;
  }
  return (undefined4 *)this;
}



// Function: FUN_67681512 at 67681512

int __fastcall FUN_67681512(int param_1)

{
  int iVar1;
  
  FileTimeToSystemTime((FILETIME *)&stack0x00000004,(LPSYSTEMTIME)(param_1 + 8));
  iVar1 = Ordinal_184((LPSYSTEMTIME)(param_1 + 8),(undefined8 *)(param_1 + 0x18));
  if (iVar1 == 0) {
    *(undefined8 *)(param_1 + 0x18) = 0x4000000000000000;
  }
  return param_1;
}



// Function: FUN_67681545 at 67681545

void __fastcall FUN_67681545(int param_1)

{
  BOOL BVar1;
  _FILETIME local_14;
  _FILETIME local_c;
  
  if (&stack0x00000000 != (undefined1 *)0xc) {
    BVar1 = SystemTimeToFileTime((SYSTEMTIME *)(param_1 + 8),&local_c);
    if (BVar1 == 0) {
      local_c.dwHighDateTime = 0;
      local_c.dwLowDateTime = 0;
    }
  }
  if ((local_c.dwHighDateTime == 0) || (local_c.dwLowDateTime == 0)) {
    *(undefined8 *)(param_1 + 0x18) = 0x4000000000000000;
    Ordinal_185(0x4000000000000000,param_1 + 8);
  }
  else {
    FileTimeToLocalFileTime(&local_c,&local_14);
    FUN_67681512(param_1);
  }
  return;
}



// Function: FUN_676815b7 at 676815b7

void __thiscall FUN_676815b7(void *this)

{
  undefined8 in_stack_0000001c;
  
  FUN_676b06d0((undefined4 *)((int)this + 0x1e8),(undefined4 *)&stack0x0000000c,0x10);
  *(undefined8 *)((int)this + 0x1f8) = in_stack_0000001c;
  *(undefined1 *)((int)this + 0x201) = 1;
  if (*(char *)((int)this + 0x204) != '\0') {
    FUN_676b06d0((undefined4 *)((int)this + 0x1c8),(undefined4 *)&stack0x0000000c,0x10);
    *(undefined8 *)((int)this + 0x1d8) = in_stack_0000001c;
  }
  if (*(char *)((int)this + 0x203) != '\0') {
    FUN_676b06d0((undefined4 *)((int)this + 0x1a8),(undefined4 *)&stack0x0000000c,0x10);
    *(undefined8 *)((int)this + 0x1b8) = in_stack_0000001c;
  }
  return;
}



// Function: FUN_67681635 at 67681635

void __thiscall FUN_67681635(void *this)

{
  undefined8 in_stack_0000001c;
  
  FUN_676b06d0((undefined4 *)((int)this + 0x1c8),(undefined4 *)&stack0x0000000c,0x10);
  *(undefined8 *)((int)this + 0x1d8) = in_stack_0000001c;
  *(undefined1 *)((int)this + 0x204) = 0;
  *(undefined1 *)((int)this + 0x202) = 1;
  return;
}



// Function: FUN_6768166a at 6768166a

void __thiscall FUN_6768166a(void *this)

{
  undefined8 in_stack_0000001c;
  
  FUN_676b06d0((undefined4 *)((int)this + 0x1a8),(undefined4 *)&stack0x0000000c,0x10);
  *(undefined8 *)((int)this + 0x1b8) = in_stack_0000001c;
  *(undefined1 *)((int)this + 0x203) = 0;
  *(undefined1 *)((int)this + 0x200) = 1;
  return;
}



// Function: FUN_6768169f at 6768169f

uint __thiscall FUN_6768169f(void *this,int *param_1,char param_2)

{
  uint uVar1;
  undefined4 uVar2;
  int iVar3;
  
  if (*(char *)((int)this + 0x28) == '\0') {
                    /* WARNING: Load size is inaccurate */
    iVar3 = *this;
    uVar2 = (**(code **)(*param_1 + 4))();
    iVar3 = (**(code **)(iVar3 + 0x44))(uVar2);
    uVar1 = (uint)(iVar3 != 0);
  }
  else {
    uVar1 = FUN_676aecaf(this,(int)param_1,param_2);
  }
  return uVar1;
}



// Function: FUN_676816d4 at 676816d4

void __thiscall FUN_676816d4(void *this,int *param_1)

{
  int iVar1;
  undefined4 uVar2;
  
  if (*(char *)((int)this + 0x28) == '\0') {
                    /* WARNING: Load size is inaccurate */
    iVar1 = *this;
    uVar2 = (**(code **)(*param_1 + 4))(param_1,0);
    (**(code **)(iVar1 + 0x40))(uVar2);
  }
  else {
    FUN_676aed3d(this,param_1);
  }
  return;
}



// Function: FUN_67681702 at 67681702

void __thiscall FUN_67681702(void *this,int *param_1)

{
  int iVar1;
  undefined4 uVar2;
  
  if (*(char *)((int)this + 0x28) == '\0') {
                    /* WARNING: Load size is inaccurate */
    iVar1 = *this;
    uVar2 = (**(code **)(*param_1 + 4))(param_1,0);
    (**(code **)(iVar1 + 0x40))(uVar2);
  }
  else {
    FUN_676aed55(this,param_1);
  }
  return;
}



// Function: FUN_6768176e at 6768176e

int * __thiscall FUN_6768176e(void *this,int *param_1)

{
  int iVar1;
  undefined4 uVar2;
  
  if (*(char *)((int)this + 0x28) == '\0') {
                    /* WARNING: Load size is inaccurate */
    iVar1 = *this;
    uVar2 = (**(code **)(*param_1 + 4))(param_1,0);
    (**(code **)(iVar1 + 0x40))(uVar2);
  }
  else {
    this = FUN_676aedac(this,param_1);
  }
  return (int *)this;
}



// Function: FUN_67681865 at 67681865

int * __thiscall FUN_67681865(void *this,undefined4 param_1)

{
  char cVar1;
  undefined *puVar2;
  int iVar3;
  uint uVar4;
  int *piVar5;
  bool bVar6;
  undefined **local_2c;
  int *local_28;
  int local_1c;
  undefined **local_18;
  int *local_14;
  int local_c;
  int local_8;
  
  if (*(char *)((int)this + 0x28) == '\0') {
    puVar2 = *(undefined **)((int)this + 0x14);
    if ((puVar2 == (undefined *)0x0) &&
       (puVar2 = *(undefined **)((int)this + 0x20), puVar2 == (undefined *)0x0)) {
      puVar2 = &DAT_676c5658;
    }
    local_2c = &PTR_FUN_676b9a34;
    FUN_67681a57(&local_2c,(int)puVar2);
    puVar2 = *(undefined **)((int)this + 0x20);
    if (puVar2 == (undefined *)0x0) {
      puVar2 = &DAT_676c5658;
    }
    if (local_1c == *(int *)(puVar2 + 0x10)) {
      if (local_1c != 0) {
        return (int *)0x0;
      }
      bVar6 = local_28 == *(int **)(puVar2 + 4);
    }
    else {
      bVar6 = false;
    }
    if (!bVar6) {
      iVar3 = (**(code **)(*local_28 + 8))(param_1);
      if (iVar3 < 1) {
        local_18 = &PTR_FUN_676b9a34;
        FUN_67681a57(&local_18,(int)&local_2c);
        while( true ) {
          puVar2 = *(undefined **)((int)this + 0x20);
          if (puVar2 == (undefined *)0x0) {
            puVar2 = &DAT_676c5658;
          }
          if ((local_8 != 2) && (local_c != 0)) {
            FUN_67681a57(&local_18,local_c);
          }
          uVar4 = FUN_67681a78(&local_18,(int)puVar2);
          if (((char)uVar4 != '\0') || (iVar3 = (**(code **)(*local_14 + 8))(param_1), 0 < iVar3))
          break;
          local_28 = local_14;
        }
        piVar5 = (int *)local_28[2];
        while ((piVar5 != (int *)0x0 && (cVar1 = (**(code **)(*piVar5 + 0xc))(), cVar1 == '\0'))) {
          iVar3 = (**(code **)(*piVar5 + 8))(param_1);
          if (iVar3 == 0) {
            return piVar5;
          }
          piVar5 = (int *)piVar5[2];
        }
      }
      else {
        piVar5 = (int *)local_28[1];
        while ((piVar5 != (int *)0x0 && (cVar1 = (**(code **)(*piVar5 + 0xc))(), cVar1 == '\0'))) {
          iVar3 = (**(code **)(*piVar5 + 8))(param_1);
          if (iVar3 == 0) {
            return piVar5;
          }
          piVar5 = (int *)piVar5[1];
        }
      }
    }
  }
  return (int *)0x0;
}



// Function: FUN_6768199d at 6768199d

void __thiscall FUN_6768199d(void *this,int param_1)

{
  *(undefined ***)this = &PTR_FUN_676b9a38;
  *(undefined4 *)((int)this + 4) = *(undefined4 *)(param_1 + 4);
  *(undefined4 *)((int)this + 8) = *(undefined4 *)(param_1 + 8);
  *(undefined4 *)((int)this + 0xc) = *(undefined4 *)(param_1 + 0xc);
  *(undefined4 *)((int)this + 0x10) = *(undefined4 *)(param_1 + 0x10);
  return;
}



// Function: FUN_676819c4 at 676819c4

int __fastcall FUN_676819c4(int param_1)

{
  int iVar1;
  
  if ((*(int *)(param_1 + 0x10) != 2) && (iVar1 = *(int *)(param_1 + 0xc), iVar1 != 0)) {
    *(undefined4 *)(param_1 + 4) = *(undefined4 *)(iVar1 + 4);
    *(undefined4 *)(param_1 + 8) = *(undefined4 *)(iVar1 + 8);
    *(undefined4 *)(param_1 + 0xc) = *(undefined4 *)(iVar1 + 0xc);
    *(undefined4 *)(param_1 + 0x10) = *(undefined4 *)(iVar1 + 0x10);
    if (*(int *)(param_1 + 8) != 0) {
      return *(int *)(param_1 + 8);
    }
  }
  return param_1;
}



// Function: FUN_676819f5 at 676819f5

undefined4 __thiscall FUN_676819f5(void *this,int param_1)

{
  int iVar1;
  bool bVar2;
  
  iVar1 = *(int *)(param_1 + 8);
  bVar2 = iVar1 == 0;
  if (!bVar2) {
    do {
      if (*(int *)((int)this + 0x10) == *(int *)(iVar1 + 0x10)) {
        if (*(int *)((int)this + 0x10) != 0) break;
        bVar2 = *(int *)((int)this + 4) == *(int *)(iVar1 + 4);
      }
      else {
        bVar2 = false;
      }
      if (bVar2) break;
      iVar1 = *(int *)(iVar1 + 8);
      bVar2 = iVar1 == 0;
      if (bVar2) goto LAB_67681a33;
      if (*(int *)(iVar1 + 0x10) == 1) {
        iVar1 = 0;
      }
    } while (iVar1 != 0);
    bVar2 = iVar1 == 0;
  }
LAB_67681a33:
  return CONCAT31((int3)((uint)iVar1 >> 8),!bVar2);
}



// Function: FUN_67681a3a at 67681a3a

undefined4 * __thiscall FUN_67681a3a(void *this,byte param_1)

{
  *(undefined ***)this = &PTR_FUN_676b9a38;
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_67681a57 at 67681a57

void __thiscall FUN_67681a57(void *this,int param_1)

{
  *(undefined4 *)((int)this + 4) = *(undefined4 *)(param_1 + 4);
  *(undefined4 *)((int)this + 8) = *(undefined4 *)(param_1 + 8);
  *(undefined4 *)((int)this + 0xc) = *(undefined4 *)(param_1 + 0xc);
  *(undefined4 *)((int)this + 0x10) = *(undefined4 *)(param_1 + 0x10);
  return;
}



// Function: FUN_67681a78 at 67681a78

uint __thiscall FUN_67681a78(void *this,int param_1)

{
  int iVar1;
  uint3 uVar3;
  uint uVar2;
  
  iVar1 = *(int *)((int)this + 0x10);
  uVar3 = (uint3)((uint)iVar1 >> 8);
  if (iVar1 == *(int *)(param_1 + 0x10)) {
    if (iVar1 == 0) {
      uVar2 = (uint)(*(int *)((int)this + 4) == *(int *)(param_1 + 4));
    }
    else {
      uVar2 = CONCAT31(uVar3,1);
    }
  }
  else {
    uVar2 = (uint)uVar3 << 8;
  }
  return uVar2;
}



// Function: FUN_67681a9e at 67681a9e

undefined4 * __thiscall FUN_67681a9e(void *this,byte param_1)

{
  *(undefined ***)this = &PTR_FUN_676b9a34;
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_67681abb at 67681abb

undefined4 * __fastcall FUN_67681abb(undefined4 *param_1)

{
  param_1[0x17] = 0;
  *param_1 = &PTR_FUN_676b9a3c;
  FUN_67681b12((int)param_1);
  *(undefined1 *)(param_1 + 0x19) = 0;
  *(undefined1 *)((int)param_1 + 0x65) = 0;
  *(undefined1 *)((int)param_1 + 0x66) = 0;
  param_1[0x18] = 0xffffffff;
  return param_1;
}



// Function: FUN_67681ae1 at 67681ae1

undefined4 * __thiscall FUN_67681ae1(void *this,byte param_1)

{
  FUN_67681afd((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_67681afd at 67681afd

void __fastcall FUN_67681afd(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b9a3c;
  if ((undefined *)param_1[0x17] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[0x17]);
  }
  return;
}



// Function: FUN_67681b12 at 67681b12

void __fastcall FUN_67681b12(int param_1)

{
  _memset((void *)(param_1 + 4),0,0x12);
  _memset((void *)(param_1 + 0x16),0,0x34);
  _memset((void *)(param_1 + 0x4a),0,0x10);
  if (*(undefined **)(param_1 + 0x5c) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)(param_1 + 0x5c));
    *(undefined4 *)(param_1 + 0x5c) = 0;
  }
  *(undefined1 *)(param_1 + 100) = 0;
  *(undefined1 *)(param_1 + 0x65) = 0;
  *(undefined1 *)(param_1 + 0x66) = 0;
  return;
}



// Function: FUN_67681b5c at 67681b5c

void __thiscall FUN_67681b5c(void *this,uint param_1,undefined4 param_2,int param_3)

{
  uint uVar1;
  undefined4 uVar2;
  
  _memset((void *)((int)this + 4),0,0x12);
  _memset((void *)((int)this + 0x16),0,0x34);
  _memset((void *)((int)this + 0x4a),0,0x10);
  uVar1 = 0xffff;
  if (param_1 < 0x10000) {
    uVar1 = param_1;
  }
  *(short *)((int)this + 6) = (short)uVar1;
  uVar2 = param_2;
  if (param_3 != 0) {
    uVar2 = 0xffffffff;
  }
  *(undefined4 *)((int)this + 0x42) = param_2;
  *(undefined4 *)((int)this + 0x10) = uVar2;
  *(uint *)((int)this + 0x26) = param_1;
  *(int *)((int)this + 0x46) = param_3;
  *(undefined2 *)((int)this + 0x1e) = 0xa15;
  *(undefined2 *)((int)this + 0x20) = 0x15;
  *(uint *)((int)this + 0x60) = param_1;
  return;
}



// Function: FUN_67681bdd at 67681bdd

void __thiscall FUN_67681bdd(void *this,uint param_1,undefined4 param_2,int param_3,uint param_4)

{
  uint *puVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  undefined4 uVar5;
  
  uVar3 = *(uint *)((int)this + 0x32);
  if (uVar3 == 0 && *(int *)((int)this + 0x36) == 0) {
    *(undefined4 *)((int)this + 0x42) = param_2;
    *(int *)((int)this + 0x46) = param_3;
    *(uint *)((int)this + 0x26) = param_1;
    if (param_3 != 0) {
      param_2 = 0xffffffff;
    }
    *(undefined4 *)((int)this + 0x10) = param_2;
    if (0xffff < param_1) {
      param_1 = 0xffff;
    }
    *(short *)((int)this + 6) = (short)param_1;
  }
  puVar1 = (uint *)((int)this + 0x3a);
  uVar2 = *puVar1;
  *puVar1 = *puVar1 + param_4;
  *(int *)((int)this + 0x3e) = *(int *)((int)this + 0x3e) + (uint)CARRY4(uVar2,param_4);
  puVar1 = (uint *)((int)this + 0x2a);
  uVar2 = *puVar1;
  *puVar1 = *puVar1 + 1;
  *(int *)((int)this + 0x2e) = *(int *)((int)this + 0x2e) + (uint)(0xfffffffe < uVar2);
  iVar4 = *(int *)((int)this + 0x36) + (uint)(0xfffffffe < uVar3);
  *(uint *)((int)this + 0x32) = uVar3 + 1;
  *(int *)((int)this + 0x36) = iVar4;
  if ((iVar4 == 0) && (*(uint *)((int)this + 0x32) < 0x10000)) {
    uVar5 = *(undefined4 *)((int)this + 0x3a);
    if (*(int *)((int)this + 0x3e) != 0) {
      uVar5 = 0xffffffff;
    }
    *(short *)((int)this + 8) = *(short *)((int)this + 8) + 1;
    *(short *)((int)this + 10) = *(short *)((int)this + 10) + 1;
    *(undefined4 *)((int)this + 0xc) = uVar5;
  }
  return;
}



// Function: FUN_67681c82 at 67681c82

void __thiscall FUN_67681c82(void *this,undefined4 param_1)

{
  *(undefined4 *)((int)this + 0x2a) = 0;
  *(undefined2 *)((int)this + 8) = 0;
  *(undefined4 *)((int)this + 0x2e) = 0;
  *(undefined4 *)((int)this + 0x60) = param_1;
  return;
}



// Function: FUN_67681c98 at 67681c98

void __thiscall FUN_67681c98(void *this,LPCSTR param_1)

{
  uint uVar1;
  LPSTR lpString1;
  
  if (*(undefined **)((int)this + 0x5c) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)((int)this + 0x5c));
    *(undefined4 *)((int)this + 0x5c) = 0;
    *(undefined2 *)((int)this + 0x14) = 0;
  }
  if ((param_1 != (LPCSTR)0x0) && (*param_1 != '\0')) {
    uVar1 = lstrlenA(param_1);
    *(short *)((int)this + 0x14) = (short)uVar1;
    lpString1 = (LPSTR)operator_new((uVar1 & 0xffff) + 1);
    *(LPSTR *)((int)this + 0x5c) = lpString1;
    if (lpString1 == (LPSTR)0x0) {
      *(undefined2 *)((int)this + 0x14) = 0;
    }
    else {
      lstrcpyA(lpString1,param_1);
    }
  }
  return;
}



// Function: FUN_67681cf0 at 67681cf0

uint __thiscall FUN_67681cf0(void *this,void *param_1,int param_2)

{
  ushort uVar1;
  uint uVar2;
  undefined *puVar3;
  void *pvVar4;
  int iVar5;
  
  if ((*(char *)((int)this + 0x65) == '\0') && (*(char *)((int)this + 0x66) == '\0')) {
    uVar2 = FUN_6768d2cc((void *)(param_2 + 0x30),param_1,(LPVOID)((int)this + 4),0x12);
    if ((char)uVar2 == '\0') goto LAB_67681d8e;
    puVar3 = *(undefined **)((int)this + 0x5c);
    if (puVar3 != (undefined *)0x0) {
      puVar3 = (undefined *)FUN_676b0bb3(puVar3);
      *(undefined4 *)((int)this + 0x5c) = 0;
    }
    uVar1 = *(ushort *)((int)this + 0x14);
    uVar2 = CONCAT22((short)((uint)puVar3 >> 0x10),uVar1);
    if (uVar1 == 0) {
LAB_67681d74:
      *(undefined1 *)((int)this + 100) = 1;
      return CONCAT31((int3)(uVar2 >> 8),1);
    }
    pvVar4 = operator_new(uVar1 + 1);
    *(void **)((int)this + 0x5c) = pvVar4;
    if (pvVar4 != (void *)0x0) {
      *(undefined1 *)((uint)*(ushort *)((int)this + 0x14) + (int)pvVar4) = 0;
      uVar2 = FUN_6768d2cc((void *)(param_2 + 0x30),param_1,*(LPVOID *)((int)this + 0x5c),
                           (uint)*(ushort *)((int)this + 0x14));
      if ((char)uVar2 == '\0') goto LAB_67681d8e;
      goto LAB_67681d74;
    }
    iVar5 = 0x1ff;
  }
  else {
    iVar5 = 999;
  }
  uVar2 = FUN_6767ca9c(param_1,iVar5,0x4000000);
LAB_67681d8e:
  return uVar2 & 0xffffff00;
}



// Function: FUN_67681d96 at 67681d96

uint __thiscall FUN_67681d96(void *this,void *param_1,int param_2)

{
  void *this_00;
  ushort uVar1;
  uint uVar2;
  undefined4 local_8;
  
  this_00 = (void *)(param_2 + 0x30);
  local_8 = 0x6054b50;
  uVar2 = FUN_6768d357(this_00,param_1,&local_8,4,0);
  if ((char)uVar2 != '\0') {
    uVar2 = *(uint *)((int)this + 0x60);
    if (0xffff < uVar2) {
      uVar2 = 0xffff;
    }
    *(short *)((int)this + 4) = (short)uVar2;
    uVar2 = FUN_6768d5d9(this_00,param_1,(undefined4 *)((int)this + 4),0x12,this,3);
    if ((char)uVar2 != '\0') {
      uVar1 = *(ushort *)((int)this + 0x14);
      uVar2 = CONCAT22((short)(uVar2 >> 0x10),uVar1);
      if ((uVar1 == 0) ||
         (uVar2 = FUN_6768d357(this_00,param_1,*(undefined4 **)((int)this + 0x5c),(uint)uVar1,0),
         (char)uVar2 != '\0')) {
        return CONCAT31((int3)(uVar2 >> 8),1);
      }
    }
  }
  return uVar2 & 0xffffff00;
}



// Function: FUN_67681e15 at 67681e15

uint __thiscall FUN_67681e15(void *this,void *param_1,int param_2)

{
  uint uVar1;
  
  if (*(char *)((int)this + 100) == '\0') {
    uVar1 = FUN_6767ca9c(param_1,999,0x4000000);
  }
  else {
    uVar1 = FUN_6768d2cc((void *)(param_2 + 0x30),param_1,(LPVOID)((int)this + 0x4a),0x10);
    if ((char)uVar1 != '\0') {
      if (*(int *)((int)this + 0x56) == 0) {
        uVar1 = FUN_6767ca9c(param_1,0x144,0x1000000);
        *(undefined4 *)((int)this + 0x56) = 1;
      }
      *(undefined1 *)((int)this + 0x65) = 1;
      return CONCAT31((int3)(uVar1 >> 8),1);
    }
  }
  return uVar1 & 0xffffff00;
}



// Function: FUN_67681e7b at 67681e7b

uint __thiscall FUN_67681e7b(void *this,void *param_1,int param_2)

{
  uint uVar1;
  undefined4 local_8;
  
  local_8 = 0x7064b50;
  uVar1 = FUN_6768d357((void *)(param_2 + 0x30),param_1,&local_8,4,0);
  if ((char)uVar1 != '\0') {
    *(int *)((int)this + 0x56) = *(int *)((int)this + 0x60) + 1;
    uVar1 = FUN_6768d5d9((void *)(param_2 + 0x30),param_1,(undefined4 *)((int)this + 0x4a),0x10,this
                         ,2);
    uVar1 = CONCAT31((int3)(uVar1 >> 8),(char)uVar1 != '\0');
  }
  return uVar1;
}



// Function: FUN_67681ecb at 67681ecb

uint __thiscall FUN_67681ecb(void *this,void *param_1,int param_2)

{
  uint uVar1;
  
  if ((*(char *)((int)this + 100) == '\0') || (*(char *)((int)this + 0x65) == '\0')) {
    uVar1 = FUN_6767ca9c(param_1,999,0x4000000);
  }
  else {
    uVar1 = FUN_6768d2cc((void *)(param_2 + 0x30),param_1,(LPVOID)((int)this + 0x16),0x34);
    if ((char)uVar1 != '\0') {
      *(undefined1 *)((int)this + 0x66) = 1;
      return CONCAT31((int3)(uVar1 >> 8),1);
    }
  }
  return uVar1 & 0xffffff00;
}



// Function: FUN_67681f15 at 67681f15

uint __thiscall FUN_67681f15(void *this,void *param_1,int param_2)

{
  uint uVar1;
  undefined4 local_8;
  
  local_8 = 0x6064b50;
  uVar1 = FUN_6768d357((void *)(param_2 + 0x30),param_1,&local_8,4,0);
  if ((char)uVar1 != '\0') {
    *(undefined4 *)((int)this + 0x22) = *(undefined4 *)((int)this + 0x60);
    *(undefined4 *)((int)this + 0x16) = 0x2c;
    *(undefined4 *)((int)this + 0x1a) = 0;
    uVar1 = FUN_6768d5d9((void *)(param_2 + 0x30),param_1,(undefined4 *)((int)this + 0x16),0x34,this
                         ,1);
    uVar1 = CONCAT31((int3)(uVar1 >> 8),(char)uVar1 != '\0');
  }
  return uVar1;
}



// Function: FUN_67681f6e at 67681f6e

uint __thiscall
FUN_67681f6e(void *this,void *param_1,uint param_2,undefined4 param_3,undefined4 param_4,
            undefined4 *param_5,int param_6,int param_7)

{
  uint uVar1;
  undefined4 *puVar2;
  uint uVar3;
  
  if (param_7 == 1) {
    if (param_6 == 0x34) {
      uVar1 = 0x34;
      *(uint *)((int)this + 0x22) = param_2;
      *(uint *)((int)this + 0x4a) = param_2;
      *(undefined4 *)((int)this + 0x4e) = param_3;
      *(undefined4 *)((int)this + 0x52) = param_4;
      puVar2 = (undefined4 *)((int)this + 0x16);
      goto LAB_67681fe6;
    }
  }
  else if (param_7 == 2) {
    if (param_6 == 0x10) {
      uVar1 = 0x10;
      *(uint *)((int)this + 0x56) = param_2 + 1;
      puVar2 = (undefined4 *)((int)this + 0x4a);
      goto LAB_67681fe6;
    }
  }
  else if ((param_7 == 3) && (param_6 == 0x12)) {
    uVar3 = 0xffff;
    if (param_2 < 0x10000) {
      uVar3 = param_2;
    }
    puVar2 = (undefined4 *)((int)this + 4);
    uVar1 = 0x12;
    *(short *)puVar2 = (short)uVar3;
LAB_67681fe6:
    puVar2 = FUN_676b06d0(param_5,puVar2,uVar1);
    return CONCAT31((int3)((uint)puVar2 >> 8),1);
  }
  uVar1 = FUN_6767ca9c(param_1,999,0x4000000);
  return uVar1 & 0xffffff00;
}



// Function: FUN_67681ff7 at 67681ff7

undefined4 * __fastcall FUN_67681ff7(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b9a44;
  *(undefined2 *)(param_1 + 1) = 0;
  _memset(param_1 + 4,0,4);
  _memset(param_1 + 5,0,4);
  *(undefined1 *)((int)param_1 + 6) = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  *(undefined2 *)(param_1 + 6) = 0;
  *(undefined2 *)((int)param_1 + 0x1a) = 0;
  return param_1;
}



// Function: FUN_67682038 at 67682038

undefined4 * __thiscall FUN_67682038(void *this,byte param_1)

{
  FUN_67682054((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_67682054 at 67682054

void __fastcall FUN_67682054(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b9a44;
  if ((undefined *)param_1[2] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[2]);
  }
  if ((undefined *)param_1[3] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[3]);
  }
  return;
}



// Function: FUN_6768207b at 6768207b

undefined4 * __thiscall FUN_6768207b(void *this,int param_1)

{
  ushort uVar1;
  undefined4 *puVar2;
  bool bVar3;
  
  *(undefined ***)this = &PTR_FUN_676b9a44;
  *(undefined2 *)((int)this + 4) = *(undefined2 *)(param_1 + 4);
  FUN_676b06d0((undefined4 *)((int)this + 0x10),(undefined4 *)(param_1 + 0x10),4);
  FUN_676b06d0((undefined4 *)((int)this + 0x14),(undefined4 *)(param_1 + 0x14),4);
  *(undefined4 *)((int)this + 8) = 0;
  *(undefined4 *)((int)this + 0xc) = 0;
  *(undefined1 *)((int)this + 6) = *(undefined1 *)(param_1 + 6);
  if (*(int *)(param_1 + 8) == 0) {
    *(undefined2 *)((int)this + 0x18) = 0;
  }
  else {
    uVar1 = *(ushort *)(param_1 + 0x18);
    bVar3 = uVar1 == 0;
    if (bVar3) {
      uVar1 = *(ushort *)(param_1 + 0x12);
      bVar3 = uVar1 == 0;
    }
    if (!bVar3) {
      puVar2 = (undefined4 *)operator_new((uint)uVar1);
      *(undefined4 **)((int)this + 8) = puVar2;
      if (puVar2 == (undefined4 *)0x0) {
        return (undefined4 *)this;
      }
      FUN_676b06d0(puVar2,*(undefined4 **)(param_1 + 8),(uint)uVar1);
    }
    *(undefined2 *)((int)this + 0x18) = *(undefined2 *)(param_1 + 0x18);
  }
  if (*(int *)(param_1 + 0xc) == 0) {
    *(undefined2 *)((int)this + 0x1a) = 0;
  }
  else {
    uVar1 = *(ushort *)(param_1 + 0x1a);
    bVar3 = uVar1 == 0;
    if (bVar3) {
      uVar1 = *(ushort *)(param_1 + 0x16);
      bVar3 = uVar1 == 0;
    }
    if (!bVar3) {
      puVar2 = (undefined4 *)operator_new((uint)uVar1);
      *(undefined4 **)((int)this + 0xc) = puVar2;
      if (puVar2 == (undefined4 *)0x0) {
        return (undefined4 *)this;
      }
      FUN_676b06d0(puVar2,*(undefined4 **)(param_1 + 0xc),(uint)uVar1);
    }
    *(undefined2 *)((int)this + 0x1a) = *(undefined2 *)(param_1 + 0x1a);
  }
  return (undefined4 *)this;
}



// Function: FUN_67682151 at 67682151

undefined4 * __fastcall FUN_67682151(int param_1)

{
  void *this;
  undefined4 *puVar1;
  
  this = operator_new(0x1c);
  if (this != (void *)0x0) {
    puVar1 = FUN_6768207b(this,param_1);
    return puVar1;
  }
  return (undefined4 *)0x0;
}



// Function: FUN_6768216e at 6768216e

bool __thiscall
FUN_6768216e(void *this,void *param_1,int *param_2,ushort *param_3,undefined4 param_4,
            undefined4 param_5)

{
  short *psVar1;
  int iVar2;
  bool bVar3;
  char cVar4;
  undefined4 *puVar5;
  uint uVar6;
  
  psVar1 = (short *)*param_2;
  if (((psVar1 == (short *)0x0) || (*(int *)((int)this + 8) != 0)) ||
     (*psVar1 != *(short *)((int)this + 4))) {
    FUN_6767ca9c(param_1,999,0x4000000);
LAB_67682237:
    bVar3 = false;
  }
  else {
    if (3 < *param_3) {
      puVar5 = FUN_676b06d0((undefined4 *)((int)this + 0x10),(undefined4 *)psVar1,4);
      if ((uint)*(ushort *)((int)this + 0x12) <= *param_3 - 4) {
        iVar2 = *param_2;
        uVar6 = CONCAT22((short)((uint)puVar5 >> 0x10),*(ushort *)((int)this + 0x12)) + 4;
        if (*param_3 < (ushort)uVar6) {
          *param_2 = 0;
          FUN_6767ca9c(param_1,0x13b,0x1000000);
          return true;
        }
        *param_2 = (uVar6 & 0xffff) + iVar2;
        *param_3 = *param_3 - (ushort)uVar6;
        if (*param_3 == 0) {
          *param_2 = 0;
        }
                    /* WARNING: Load size is inaccurate */
        if ((*(short *)((int)this + 0x12) == 0) ||
           (cVar4 = (**(code **)(*this + 0x14))
                              (param_1,iVar2 + 4,
                               CONCAT22((short)(uVar6 >> 0x10),*(short *)((int)this + 0x12)),param_4
                               ,param_5), cVar4 != '\0')) {
          *(undefined1 *)((int)this + 6) = 1;
          return true;
        }
        goto LAB_67682237;
      }
    }
    bVar3 = FUN_6768260b(this,param_1,param_2,param_3);
  }
  return bVar3;
}



// Function: FUN_67682248 at 67682248

bool __thiscall
FUN_67682248(void *this,void *param_1,int *param_2,ushort *param_3,undefined4 param_4,
            undefined4 param_5)

{
  short *psVar1;
  int iVar2;
  bool bVar3;
  char cVar4;
  undefined4 *puVar5;
  uint uVar6;
  
  psVar1 = (short *)*param_2;
  if (((psVar1 == (short *)0x0) || (*(int *)((int)this + 0xc) != 0)) ||
     (*psVar1 != *(short *)((int)this + 4))) {
    FUN_6767ca9c(param_1,999,0x4000000);
LAB_6768230b:
    bVar3 = false;
  }
  else {
    if (3 < *param_3) {
      puVar5 = FUN_676b06d0((undefined4 *)((int)this + 0x14),(undefined4 *)psVar1,4);
      if ((uint)*(ushort *)((int)this + 0x16) <= *param_3 - 4) {
        iVar2 = *param_2;
        uVar6 = CONCAT22((short)((uint)puVar5 >> 0x10),*(ushort *)((int)this + 0x16)) + 4;
        if (*param_3 < (ushort)uVar6) {
          *param_2 = 0;
          FUN_6767ca9c(param_1,0x13b,0x1000000);
          return true;
        }
        *param_2 = (uVar6 & 0xffff) + iVar2;
        *param_3 = *param_3 - (ushort)uVar6;
                    /* WARNING: Load size is inaccurate */
        if ((*(short *)((int)this + 0x16) == 0) ||
           (cVar4 = (**(code **)(*this + 0x18))
                              (param_1,iVar2 + 4,
                               CONCAT22((short)(uVar6 >> 0x10),*(short *)((int)this + 0x16)),param_4
                               ,param_5), cVar4 != '\0')) {
          *(undefined1 *)((int)this + 6) = 1;
          if (*param_3 != 0) {
            return true;
          }
          *param_2 = 0;
          return true;
        }
        goto LAB_6768230b;
      }
    }
    bVar3 = FUN_67682678(this,param_1,param_2,param_3);
  }
  return bVar3;
}



// Function: FUN_67682325 at 67682325

uint __thiscall
FUN_67682325(void *this,void *param_1,int *param_2,short *param_3,undefined4 param_4)

{
  int *piVar1;
  short *psVar2;
  short sVar3;
  uint uVar4;
  int iVar5;
  
  psVar2 = param_3;
  piVar1 = param_2;
  if ((*param_2 == 0) || (*param_3 == 0)) {
    uVar4 = FUN_6767ca9c(param_1,999,0x4000000);
  }
  else {
    *(undefined2 *)((int)this + 0x10) = *(undefined2 *)((int)this + 4);
    param_2 = (int *)0x0;
                    /* WARNING: Load size is inaccurate */
    uVar4 = (**(code **)(*this + 0x1c))
                      (param_1,*piVar1 + 4,CONCAT22((short)((uint)&param_2 >> 0x10),*param_3 + -4),
                       &param_2,param_4);
    if ((char)uVar4 != '\0') {
      if ((short)param_2 != 0) {
        *(short *)((int)this + 0x12) = (short)param_2;
        FUN_676b06d0((undefined4 *)*piVar1,(undefined4 *)((int)this + 0x10),4);
        iVar5 = *(ushort *)((int)this + 0x12) + 4;
        *piVar1 = *piVar1 + iVar5;
        sVar3 = -4 - *(short *)((int)this + 0x12);
        param_2 = (int *)CONCAT22((short)((uint)iVar5 >> 0x10),sVar3);
        *psVar2 = *psVar2 + sVar3;
      }
      return CONCAT31((int3)((uint)param_2 >> 8),1);
    }
  }
  return uVar4 & 0xffffff00;
}



// Function: FUN_676823bb at 676823bb

uint __thiscall
FUN_676823bb(void *this,void *param_1,int *param_2,short *param_3,undefined4 param_4)

{
  int *piVar1;
  short *psVar2;
  short sVar3;
  uint uVar4;
  int iVar5;
  
  psVar2 = param_3;
  piVar1 = param_2;
  if ((*param_2 == 0) || (*param_3 == 0)) {
    uVar4 = FUN_6767ca9c(param_1,999,0x4000000);
  }
  else {
    *(undefined2 *)((int)this + 0x14) = *(undefined2 *)((int)this + 4);
    param_2 = (int *)0x0;
                    /* WARNING: Load size is inaccurate */
    uVar4 = (**(code **)(*this + 0x20))
                      (param_1,*piVar1 + 4,CONCAT22((short)((uint)&param_2 >> 0x10),*param_3 + -4),
                       &param_2,param_4);
    if ((char)uVar4 != '\0') {
      if ((short)param_2 != 0) {
        *(short *)((int)this + 0x16) = (short)param_2;
        FUN_676b06d0((undefined4 *)*piVar1,(undefined4 *)((int)this + 0x14),4);
        iVar5 = *(ushort *)((int)this + 0x16) + 4;
        *piVar1 = *piVar1 + iVar5;
        sVar3 = -4 - *(short *)((int)this + 0x16);
        param_2 = (int *)CONCAT22((short)((uint)iVar5 >> 0x10),sVar3);
        *psVar2 = *psVar2 + sVar3;
      }
      return CONCAT31((int3)((uint)param_2 >> 8),1);
    }
  }
  return uVar4 & 0xffffff00;
}



// Function: FUN_6768247d at 6768247d

uint __thiscall FUN_6768247d(void *this,void *param_1,undefined4 *param_2,ushort param_3)

{
  undefined4 *puVar1;
  uint uVar2;
  int iVar3;
  
  if ((*(int *)((int)this + 8) == 0) && (param_2 != (undefined4 *)0x0)) {
    puVar1 = (undefined4 *)operator_new((uint)param_3);
    *(undefined4 **)((int)this + 8) = puVar1;
    if (puVar1 != (undefined4 *)0x0) {
      puVar1 = FUN_676b06d0(puVar1,param_2,(uint)param_3);
      return CONCAT31((int3)((uint)puVar1 >> 8),1);
    }
    iVar3 = 0x1ff;
  }
  else {
    iVar3 = 999;
  }
  uVar2 = FUN_6767ca9c(param_1,iVar3,0x4000000);
  return uVar2 & 0xffffff00;
}



// Function: FUN_676824d9 at 676824d9

uint __thiscall FUN_676824d9(void *this,void *param_1,undefined4 *param_2,ushort param_3)

{
  undefined4 *puVar1;
  uint uVar2;
  int iVar3;
  
  if ((*(int *)((int)this + 0xc) == 0) && (param_2 != (undefined4 *)0x0)) {
    puVar1 = (undefined4 *)operator_new((uint)param_3);
    *(undefined4 **)((int)this + 0xc) = puVar1;
    if (puVar1 != (undefined4 *)0x0) {
      puVar1 = FUN_676b06d0(puVar1,param_2,(uint)param_3);
      return CONCAT31((int3)((uint)puVar1 >> 8),1);
    }
    iVar3 = 0x1ff;
  }
  else {
    iVar3 = 999;
  }
  uVar2 = FUN_6767ca9c(param_1,iVar3,0x4000000);
  return uVar2 & 0xffffff00;
}



// Function: FUN_67682535 at 67682535

uint __thiscall
FUN_67682535(void *this,void *param_1,undefined4 *param_2,ushort param_3,ushort *param_4)

{
  uint uVar1;
  ushort *puVar2;
  ushort uVar3;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = FUN_6767ca9c(param_1,999,0x4000000);
    uVar1 = uVar1 & 0xffffff00;
  }
  else {
    puVar2 = *(ushort **)((int)this + 8);
    if (puVar2 != (ushort *)0x0) {
      uVar3 = *(ushort *)((int)this + 0x18);
      if (uVar3 == 0) {
        uVar3 = *(ushort *)((int)this + 0x12);
      }
      if (param_3 < uVar3) {
        puVar2 = (ushort *)FUN_6767ca9c(param_1,0x13b,0x1000000);
      }
      else {
        FUN_676b06d0(param_2,(undefined4 *)puVar2,(uint)uVar3);
        *param_4 = uVar3;
        puVar2 = param_4;
      }
    }
    uVar1 = CONCAT31((int3)((uint)puVar2 >> 8),1);
  }
  return uVar1;
}



// Function: FUN_676825a0 at 676825a0

uint __thiscall
FUN_676825a0(void *this,void *param_1,undefined4 *param_2,ushort param_3,ushort *param_4)

{
  uint uVar1;
  ushort *puVar2;
  ushort uVar3;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = FUN_6767ca9c(param_1,999,0x4000000);
    uVar1 = uVar1 & 0xffffff00;
  }
  else {
    puVar2 = *(ushort **)((int)this + 0xc);
    if (puVar2 != (ushort *)0x0) {
      uVar3 = *(ushort *)((int)this + 0x1a);
      if (uVar3 == 0) {
        uVar3 = *(ushort *)((int)this + 0x16);
      }
      if (param_3 < uVar3) {
        puVar2 = (ushort *)FUN_6767ca9c(param_1,0x13b,0x1000000);
      }
      else {
        FUN_676b06d0(param_2,(undefined4 *)puVar2,(uint)uVar3);
        *param_4 = uVar3;
        puVar2 = param_4;
      }
    }
    uVar1 = CONCAT31((int3)((uint)puVar2 >> 8),1);
  }
  return uVar1;
}



// Function: FUN_6768260b at 6768260b

bool __thiscall FUN_6768260b(void *this,void *param_1,undefined4 *param_2,ushort *param_3)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)operator_new((uint)*param_3);
  *(undefined4 **)((int)this + 8) = puVar1;
  if (puVar1 != (undefined4 *)0x0) {
    FUN_676b06d0(puVar1,(undefined4 *)*param_2,(uint)*param_3);
    *(ushort *)((int)this + 0x18) = *param_3;
    *param_2 = 0;
    *param_3 = 0;
    FUN_6767ca9c(param_1,0x13b,0x1000000);
  }
  else {
    FUN_6767ca9c(param_1,0x1ff,0x4000000);
  }
  return puVar1 != (undefined4 *)0x0;
}



// Function: FUN_67682678 at 67682678

bool __thiscall FUN_67682678(void *this,void *param_1,undefined4 *param_2,ushort *param_3)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)operator_new((uint)*param_3);
  *(undefined4 **)((int)this + 0xc) = puVar1;
  if (puVar1 != (undefined4 *)0x0) {
    FUN_676b06d0(puVar1,(undefined4 *)*param_2,(uint)*param_3);
    *(ushort *)((int)this + 0x1a) = *param_3;
    *param_2 = 0;
    *param_3 = 0;
    FUN_6767ca9c(param_1,0x13b,0x1000000);
  }
  else {
    FUN_6767ca9c(param_1,0x1ff,0x4000000);
  }
  return puVar1 != (undefined4 *)0x0;
}



// Function: FUN_676826ea at 676826ea

undefined4 * __fastcall FUN_676826ea(undefined4 *param_1)

{
  FUN_67681ff7(param_1);
  *param_1 = &PTR_FUN_676b9a68;
  *(undefined2 *)(param_1 + 1) = 0x5455;
  return param_1;
}



// Function: FUN_67682702 at 67682702

undefined4 * __thiscall FUN_67682702(void *this,byte param_1)

{
  FUN_6768271e((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_6768271e at 6768271e

void __fastcall FUN_6768271e(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b9a68;
  FUN_67682054(param_1);
  return;
}



// Function: FUN_67682729 at 67682729

undefined4 * __thiscall FUN_67682729(void *this,int param_1)

{
  FUN_6768207b(this,param_1);
  *(undefined ***)this = &PTR_FUN_676b9a68;
  *(undefined2 *)((int)this + 4) = 0x5455;
  return (undefined4 *)this;
}



// Function: FUN_67682747 at 67682747

undefined4 * __fastcall FUN_67682747(int param_1)

{
  void *this;
  undefined4 *puVar1;
  
  this = operator_new(0x1c);
  if (this != (void *)0x0) {
    puVar1 = FUN_67682729(this,param_1);
    return puVar1;
  }
  return (undefined4 *)0x0;
}



// Function: FUN_67682764 at 67682764

undefined4 __thiscall
FUN_67682764(void *this,void *param_1,byte *param_2,ushort param_3,void *param_4)

{
  int iVar1;
  ushort uVar2;
  int iVar3;
  int iVar4;
  undefined **local_30 [2];
  undefined4 uStack_28;
  
  uStack_28 = 0x6768277f;
  iVar1 = FUN_6768247d(this,param_1,(undefined4 *)param_2,param_3);
  if ((char)iVar1 == '\0') {
    return iVar1;
  }
  iVar3 = 1;
  if (param_3 != 0) {
    if ((*param_2 & 1) != 0) {
      iVar3 = 5;
      if (param_3 < 5) goto LAB_67682818;
      local_30[0] = &PTR_LAB_676b9950;
      FUN_67682833(local_30,*(uint *)(param_2 + 1));
      iVar1 = FUN_6768289f(param_4);
    }
    iVar4 = iVar3;
    if ((*param_2 & 2) != 0) {
      iVar4 = iVar3 + 4;
      if (param_3 < (ushort)iVar4) goto LAB_67682818;
      local_30[0] = &PTR_LAB_676b9950;
      FUN_67682833(local_30,*(uint *)(param_2 + iVar3));
      iVar1 = FUN_6768291f(param_4);
    }
    uVar2 = (ushort)iVar4;
    if ((*param_2 & 4) != 0) {
      uVar2 = uVar2 + 4;
      if (param_3 < uVar2) goto LAB_67682818;
      local_30[0] = &PTR_LAB_676b9950;
      FUN_67682833(local_30,*(uint *)(param_2 + iVar4));
      iVar1 = FUN_67682956(param_4);
    }
    if (param_3 == uVar2) goto LAB_6768282a;
  }
LAB_67682818:
  iVar1 = FUN_6767ca9c(param_1,0x13c,0x1000000);
LAB_6768282a:
  return CONCAT31((int3)((uint)iVar1 >> 8),1);
}



// Function: FUN_67682833 at 67682833

int __thiscall FUN_67682833(void *this,uint param_1)

{
  int iVar1;
  _FILETIME local_14;
  FILETIME local_c;
  
  local_c = (FILETIME)
            __allmul(param_1 + 0xb6109100,((int)param_1 >> 0x1f) + 2 + (uint)(0x49ef6eff < param_1),
                     10000000,0);
  FileTimeToLocalFileTime(&local_c,&local_14);
  FileTimeToSystemTime(&local_14,(LPSYSTEMTIME)((int)this + 8));
  iVar1 = Ordinal_184((LPSYSTEMTIME)((int)this + 8),(undefined8 *)((int)this + 0x18));
  if (iVar1 == 0) {
    *(undefined8 *)((int)this + 0x18) = 0x4000000000000000;
  }
  return (int)this;
}



// Function: FUN_6768289f at 6768289f

void __thiscall FUN_6768289f(void *this)

{
  undefined8 in_stack_0000001c;
  
  if (*(char *)((int)this + 0x201) == '\0') {
    FUN_676b06d0((undefined4 *)((int)this + 0x1e8),(undefined4 *)&stack0x0000000c,0x10);
    *(undefined8 *)((int)this + 0x1f8) = in_stack_0000001c;
    if (*(char *)((int)this + 0x204) != '\0') {
      FUN_676b06d0((undefined4 *)((int)this + 0x1c8),(undefined4 *)&stack0x0000000c,0x10);
      *(undefined8 *)((int)this + 0x1d8) = in_stack_0000001c;
    }
    if (*(char *)((int)this + 0x203) != '\0') {
      FUN_676b06d0((undefined4 *)((int)this + 0x1a8),(undefined4 *)&stack0x0000000c,0x10);
      *(undefined8 *)((int)this + 0x1b8) = in_stack_0000001c;
    }
  }
  return;
}



// Function: FUN_6768291f at 6768291f

void __thiscall FUN_6768291f(void *this)

{
  undefined8 in_stack_0000001c;
  
  if (*(char *)((int)this + 0x202) == '\0') {
    FUN_676b06d0((undefined4 *)((int)this + 0x1c8),(undefined4 *)&stack0x0000000c,0x10);
    *(undefined8 *)((int)this + 0x1d8) = in_stack_0000001c;
    *(undefined1 *)((int)this + 0x204) = 0;
  }
  return;
}



// Function: FUN_67682956 at 67682956

void __thiscall FUN_67682956(void *this)

{
  undefined8 in_stack_0000001c;
  
  if (*(char *)((int)this + 0x200) == '\0') {
    FUN_676b06d0((undefined4 *)((int)this + 0x1a8),(undefined4 *)&stack0x0000000c,0x10);
    *(undefined8 *)((int)this + 0x1b8) = in_stack_0000001c;
    *(undefined1 *)((int)this + 0x203) = 0;
  }
  return;
}



// Function: FUN_6768298d at 6768298d

undefined4 __thiscall
FUN_6768298d(void *this,void *param_1,byte *param_2,ushort param_3,void *param_4)

{
  int iVar1;
  ushort uVar2;
  undefined **local_30 [2];
  undefined4 uStack_28;
  
  uStack_28 = 0x676829a9;
  iVar1 = FUN_676824d9(this,param_1,(undefined4 *)param_2,param_3);
  if ((char)iVar1 == '\0') {
    return iVar1;
  }
  uVar2 = 1;
  if (param_3 != 0) {
    if ((*param_2 & 1) != 0) {
      uVar2 = 5;
      if (param_3 != 5) goto LAB_676829e2;
      local_30[0] = &PTR_LAB_676b9950;
      FUN_67682833(local_30,*(uint *)(param_2 + 1));
      iVar1 = FUN_6768289f(param_4);
    }
    if (param_3 == uVar2) goto LAB_676829f4;
  }
LAB_676829e2:
  iVar1 = FUN_6767ca9c(param_1,0x13c,0x1000000);
LAB_676829f4:
  return CONCAT31((int3)((uint)iVar1 >> 8),1);
}



// Function: FUN_676829fd at 676829fd

void FUN_676829fd(void *param_1,byte *param_2,ushort param_3,short *param_4,void *param_5)

{
  FUN_67682a37(param_1,param_2,param_3,param_4,param_5,'\0');
  return;
}



// Function: FUN_67682a1a at 67682a1a

void FUN_67682a1a(void *param_1,byte *param_2,ushort param_3,short *param_4,void *param_5)

{
  FUN_67682a37(param_1,param_2,param_3,param_4,param_5,'\x01');
  return;
}



// Function: FUN_67682a37 at 67682a37

undefined4
FUN_67682a37(void *param_1,byte *param_2,ushort param_3,short *param_4,void *param_5,char param_6)

{
  byte bVar1;
  byte bVar2;
  int iVar3;
  undefined3 uVar5;
  undefined4 *puVar4;
  byte *pbVar6;
  undefined8 uVar7;
  undefined4 local_24 [8];
  
  if (param_3 < 0xd) {
    iVar3 = FUN_6767ca9c(param_1,0x13c,0x1000000);
    uVar5 = (undefined3)((uint)iVar3 >> 8);
  }
  else {
    _memset(param_2,0,0xd);
    *param_2 = *param_2 | 1;
    bVar1 = *param_2;
    param_3 = 5;
    bVar2 = (*(char *)((int)param_5 + 0x204) == '\0') << 1;
    *param_2 = bVar2 | bVar1 & 0xfd;
    *param_2 = (*(char *)((int)param_5 + 0x203) == '\0') << 2 | bVar2 | bVar1 & 0xf9;
    puVar4 = FUN_6767d0b1(param_5,local_24);
    uVar7 = FUN_67682b33((int)puVar4);
    *(int *)(param_2 + 1) = (int)uVar7;
    pbVar6 = param_2 + 5;
    if (((*param_2 & 2) == 2) && (param_6 == '\0')) {
      puVar4 = FUN_67682b88(param_5,local_24);
      uVar7 = FUN_67682b33((int)puVar4);
      *(int *)pbVar6 = (int)uVar7;
      pbVar6 = param_2 + 9;
      param_3 = 9;
    }
    if (((*param_2 & 4) == 4) && (param_6 == '\0')) {
      puVar4 = FUN_67682bbb(param_5,local_24);
      uVar7 = FUN_67682b33((int)puVar4);
      param_3 = param_3 + 4;
      *(int *)pbVar6 = (int)uVar7;
    }
    *param_4 = param_3;
    uVar5 = (undefined3)((uint)param_4 >> 8);
  }
  return CONCAT31(uVar5,1);
}



// Function: FUN_67682b33 at 67682b33

undefined8 __fastcall FUN_67682b33(int param_1)

{
  uint uVar1;
  longlong lVar2;
  undefined8 uVar3;
  _FILETIME local_14;
  _FILETIME local_c;
  
  SystemTimeToFileTime((SYSTEMTIME *)(param_1 + 8),&local_14);
  LocalFileTimeToFileTime(&local_14,&local_c);
  lVar2 = __allmul(local_c.dwHighDateTime,0,0,1);
  uVar1 = (uint)(lVar2 + (ulonglong)local_c.dwLowDateTime);
  uVar3 = __alldiv(uVar1 + 0x2ac18000,
                   ((int)(lVar2 + (ulonglong)local_c.dwLowDateTime >> 0x20) + -0x19db1de) -
                   (uint)(uVar1 < 0xd53e8000),10000000,0);
  return uVar3;
}



// Function: FUN_67682b88 at 67682b88

undefined4 * __thiscall FUN_67682b88(void *this,undefined4 *param_1)

{
  *param_1 = &PTR_LAB_676b9950;
  FUN_676b06d0(param_1 + 2,(undefined4 *)((int)this + 0x1c8),0x10);
  *(undefined8 *)(param_1 + 6) = *(undefined8 *)((int)this + 0x1d8);
  return param_1;
}



// Function: FUN_67682bbb at 67682bbb

undefined4 * __thiscall FUN_67682bbb(void *this,undefined4 *param_1)

{
  *param_1 = &PTR_LAB_676b9950;
  FUN_676b06d0(param_1 + 2,(undefined4 *)((int)this + 0x1a8),0x10);
  *(undefined8 *)(param_1 + 6) = *(undefined8 *)((int)this + 0x1b8);
  return param_1;
}



// Function: FUN_67682c02 at 67682c02

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_67682c02(void)

{
  DAT_676c50d0 = 0;
  DAT_676c50d4 = 0;
  DAT_676c50d8 = 0xffffffff;
  _DAT_676c50c8 = &PTR_FUN_676b9a8c;
  return;
}



// Function: FUN_67682c22 at 67682c22

void FUN_67682c22(void)

{
  FUN_676b0c45(&LAB_67682c2e);
  return;
}



// Function: FUN_67682c49 at 67682c49

undefined4 * __fastcall FUN_67682c49(undefined4 *param_1)

{
  FUN_67681ff7(param_1);
  FUN_67683226(param_1 + 7);
  *param_1 = &PTR_FUN_676b9a90;
  *(undefined2 *)(param_1 + 1) = 10;
  return param_1;
}



// Function: FUN_67682c69 at 67682c69

undefined4 * __thiscall FUN_67682c69(void *this,byte param_1)

{
  FUN_67682c85((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_67682c85 at 67682c85

void __fastcall FUN_67682c85(undefined4 *param_1)

{
  undefined4 uVar1;
  undefined4 *local_8;
  
  *param_1 = &PTR_FUN_676b9a90;
  local_8 = param_1;
  while( true ) {
    uVar1 = FUN_676832f3(param_1 + 7,&local_8);
    if ((char)uVar1 == '\0') break;
    FUN_676b0bb3((undefined *)local_8);
  }
  FUN_676832bd(param_1 + 7);
  FUN_67682054(param_1);
  return;
}



// Function: FUN_67682cc2 at 67682cc2

undefined4 * __thiscall FUN_67682cc2(void *this,int param_1)

{
  FUN_6768207b(this,param_1);
  FUN_67683226((undefined4 *)((int)this + 0x1c));
  *(undefined ***)this = &PTR_FUN_676b9a90;
  *(undefined2 *)((int)this + 4) = 10;
  return (undefined4 *)this;
}



// Function: FUN_67682ce8 at 67682ce8

undefined4 * __fastcall FUN_67682ce8(int param_1)

{
  void *this;
  undefined4 *puVar1;
  
  this = operator_new(0x34);
  if (this != (void *)0x0) {
    puVar1 = FUN_67682cc2(this,param_1);
    return puVar1;
  }
  return (undefined4 *)0x0;
}



// Function: FUN_67682d05 at 67682d05

undefined4 FUN_67682d05(void *param_1,short *param_2,ushort param_3,void *param_4)

{
  ushort uVar1;
  uint in_EAX;
  uint uVar2;
  short sVar3;
  ushort uVar4;
  int iVar5;
  undefined4 local_88 [3];
  undefined4 uStack_7c;
  undefined **local_64 [2];
  undefined4 local_5c [6];
  undefined **local_44 [2];
  undefined4 local_3c [6];
  undefined **local_24 [2];
  undefined4 local_1c [6];
  
  uVar4 = param_3;
  _param_3 = (uint)param_3;
  if (uVar4 < 4) {
LAB_67682e73:
    uStack_7c = 0x67682e85;
    in_EAX = FUN_6767ca9c(param_1,0x13e,0x1000000);
  }
  else {
    param_2 = param_2 + 2;
    iVar5 = _param_3 + 0xfffc;
    sVar3 = (short)iVar5;
    while (sVar3 != 0) {
      if ((ushort)iVar5 < 4) goto LAB_67682e73;
      uVar4 = (ushort)(iVar5 + 0xfffc);
      if (((*param_2 == 0) && (param_2[1] == 0)) && (uVar4 == 0x18)) {
        *param_2 = 1;
        param_2[1] = 0x18;
      }
      if (*param_2 == 1) {
        if (uVar4 < 0x18) goto LAB_67682e73;
        uVar1 = param_2[1];
        if (uVar1 < 0x18) goto LAB_67682e73;
        uStack_7c = 0x67682db6;
        FUN_676814cd(local_64,*(DWORD *)(param_2 + 2),*(DWORD *)(param_2 + 4));
        uStack_7c = 0x67682dc4;
        FUN_676814cd(local_44,*(DWORD *)(param_2 + 6),*(DWORD *)(param_2 + 8));
        uStack_7c = 0x67682dd2;
        FUN_676814cd(local_24,*(DWORD *)(param_2 + 10),*(DWORD *)(param_2 + 0xc));
        FUN_67681545((int)local_64);
        FUN_67681545((int)local_44);
        FUN_67681545((int)local_24);
        FUN_676b06d0(local_88,local_5c,0x10);
        FUN_6768289f(param_4);
        FUN_676b06d0(local_88,local_3c,0x10);
        FUN_6768291f(param_4);
        FUN_676b06d0(local_88,local_1c,0x10);
        in_EAX = FUN_67682956(param_4);
        local_24[0] = &PTR_LAB_676b9950;
        local_44[0] = &PTR_LAB_676b9950;
        local_64[0] = &PTR_LAB_676b9950;
        uVar2 = (uint)uVar1;
      }
      else {
        uVar1 = param_2[1];
        in_EAX = CONCAT22((short)((uint)param_2 >> 0x10),uVar1);
        uVar2 = in_EAX;
        if (uVar4 <= uVar1) break;
      }
      param_2 = (short *)((int)(param_2 + 2) + (uint)uVar1);
      iVar5 = (iVar5 + 0xfffc) - uVar2;
      sVar3 = (short)iVar5;
    }
  }
  return CONCAT31((int3)(in_EAX >> 8),1);
}



// Function: FUN_67682e8e at 67682e8e

void __thiscall FUN_67682e8e(void *this,void *param_1,short *param_2,ushort param_3,void *param_4)

{
  undefined4 uVar1;
  
  uVar1 = FUN_6768247d(this,param_1,(undefined4 *)param_2,param_3);
  if ((char)uVar1 != '\0') {
    FUN_67682d05(param_1,param_2,param_3,param_4);
  }
  return;
}



// Function: FUN_67682ec4 at 67682ec4

void __thiscall FUN_67682ec4(void *this,void *param_1,short *param_2,ushort param_3,void *param_4)

{
  undefined4 uVar1;
  
  uVar1 = FUN_676824d9(this,param_1,(undefined4 *)param_2,param_3);
  if ((char)uVar1 != '\0') {
    FUN_67682d05(param_1,param_2,param_3,param_4);
  }
  return;
}



// Function: FUN_67682efa at 67682efa

void __thiscall
FUN_67682efa(void *this,void *param_1,undefined4 *param_2,ushort param_3,undefined2 *param_4,
            int param_5)

{
  FUN_67682f34(this,param_1,param_2,param_3,param_4,param_5,'\0');
  return;
}



// Function: FUN_67682f17 at 67682f17

void __thiscall
FUN_67682f17(void *this,void *param_1,undefined4 *param_2,ushort param_3,undefined2 *param_4,
            int param_5)

{
  FUN_67682f34(this,param_1,param_2,param_3,param_4,param_5,'\x01');
  return;
}



// Function: FUN_67682f34 at 67682f34

undefined4 __thiscall
FUN_67682f34(void *this,void *param_1,undefined4 *param_2,ushort param_3,undefined2 *param_4,
            int param_5,char param_6)

{
  undefined2 *puVar1;
  undefined *puVar2;
  uint uVar3;
  undefined4 uVar4;
  int iVar5;
  int iVar6;
  undefined4 *puVar7;
  undefined **local_64 [2];
  undefined4 local_5c [4];
  undefined8 local_4c;
  undefined **local_44 [2];
  SYSTEMTIME local_3c;
  undefined8 local_2c;
  undefined **local_24;
  undefined2 *local_20;
  undefined4 local_1c;
  undefined *local_18;
  int local_14;
  _FILETIME local_10;
  void *local_8;
  
  iVar5 = 4;
  iVar6 = iVar5;
  if (param_6 != '\0') {
    iVar6 = 0x20;
  }
  puVar2 = *(undefined **)((int)this + 0x20);
  if ((puVar2 == (undefined *)0x0) &&
     (puVar2 = *(undefined **)((int)this + 0x2c), puVar2 == (undefined *)0x0)) {
    puVar2 = &DAT_676c50c8;
  }
  local_24 = &PTR_FUN_676b9a8c;
  local_8 = this;
  do {
    FUN_67683385(&local_24,(int)puVar2);
    do {
      puVar2 = *(undefined **)((int)this + 0x2c);
      if (puVar2 == (undefined *)0x0) {
        puVar2 = &DAT_676c50c8;
      }
      uVar3 = FUN_67683470(&local_24,(int)puVar2);
      if ((char)uVar3 != '\0') {
        if (param_3 < (ushort)iVar6) {
          param_4 = (undefined2 *)FUN_6767ca9c(param_1,0x13e,0x1000000);
        }
        else {
          *param_2 = 0;
          puVar7 = param_2 + 1;
          if (param_6 != '\0') {
            *(undefined2 *)puVar7 = 1;
            *(undefined2 *)((int)param_2 + 6) = 0x18;
            local_44[0] = &PTR_LAB_676b9950;
            FUN_67683181(local_44,param_5 + 0x1e0);
            FUN_676831a8((int)local_44);
            local_10.dwLowDateTime = 0;
            local_10.dwHighDateTime = 0;
            SystemTimeToFileTime(&local_3c,&local_10);
            param_2[2] = local_10.dwLowDateTime;
            param_2[3] = local_10.dwHighDateTime;
            local_64[0] = &PTR_LAB_676b9950;
            FUN_67683181(local_64,param_5 + 0x1c0);
            FUN_676b06d0((undefined4 *)&local_3c,local_5c,0x10);
            local_2c = local_4c;
            FUN_676831a8((int)local_44);
            local_10.dwLowDateTime = 0;
            local_10.dwHighDateTime = 0;
            SystemTimeToFileTime(&local_3c,&local_10);
            param_2[4] = local_10.dwLowDateTime;
            param_2[5] = local_10.dwHighDateTime;
            local_64[0] = &PTR_LAB_676b9950;
            FUN_67683181(local_64,param_5 + 0x1a0);
            FUN_676b06d0((undefined4 *)&local_3c,local_5c,0x10);
            local_2c = local_4c;
            FUN_676831a8((int)local_44);
            local_10.dwLowDateTime = 0;
            local_10.dwHighDateTime = 0;
            SystemTimeToFileTime(&local_3c,&local_10);
            param_2[6] = local_10.dwLowDateTime;
            param_2[7] = local_10.dwHighDateTime;
            puVar7 = param_2 + 8;
            iVar5 = 0x20;
            this = local_8;
          }
          puVar2 = *(undefined **)((int)this + 0x20);
          if ((puVar2 == (undefined *)0x0) &&
             (puVar2 = *(undefined **)((int)this + 0x2c), puVar2 == (undefined *)0x0)) {
            puVar2 = &DAT_676c50c8;
          }
          local_20 = *(undefined2 **)(puVar2 + 4);
          local_1c = *(undefined4 *)(puVar2 + 8);
          local_18 = *(undefined **)(puVar2 + 0xc);
          local_14 = *(int *)(puVar2 + 0x10);
          while( true ) {
            puVar2 = *(undefined **)((int)this + 0x2c);
            if (puVar2 == (undefined *)0x0) {
              puVar2 = &DAT_676c50c8;
            }
            uVar4 = FUN_676833a6(&local_24,(int)puVar2);
            puVar1 = local_20;
            if ((char)uVar4 == '\0') break;
            iVar5 = iVar5 + 4;
            *(undefined2 *)puVar7 = *local_20;
            *(undefined2 *)((int)puVar7 + 2) = local_20[1];
            puVar7 = puVar7 + 1;
            if (local_20[1] != 0) {
              FUN_676b06d0(puVar7,(undefined4 *)(local_20 + 2),(uint)(ushort)local_20[1]);
              puVar7 = (undefined4 *)((int)puVar7 + (uint)(ushort)puVar1[1]);
              iVar5 = iVar5 + (uint)(ushort)puVar1[1];
            }
            FUN_67683354((int)&local_24);
            this = local_8;
          }
          *param_4 = (short)iVar5;
        }
        return CONCAT31((int3)((uint)param_4 >> 8),1);
      }
      iVar6 = iVar6 + (uint)(ushort)(*(short *)((int)local_20 + 2) + 4);
    } while ((local_14 == 2) || (puVar2 = local_18, local_18 == (undefined *)0x0));
  } while( true );
}



// Function: FUN_67683181 at 67683181

int __thiscall FUN_67683181(void *this,int param_1)

{
  FUN_676b06d0((undefined4 *)((int)this + 8),(undefined4 *)(param_1 + 8),0x10);
  *(undefined8 *)((int)this + 0x18) = *(undefined8 *)(param_1 + 0x18);
  return (int)this;
}



// Function: FUN_676831a8 at 676831a8

void __fastcall FUN_676831a8(int param_1)

{
  BOOL BVar1;
  _FILETIME local_14;
  _FILETIME local_c;
  
  if (&stack0x00000000 != (undefined1 *)0xc) {
    BVar1 = SystemTimeToFileTime((SYSTEMTIME *)(param_1 + 8),&local_c);
    if (BVar1 == 0) {
      local_c.dwHighDateTime = 0;
      local_c.dwLowDateTime = 0;
    }
  }
  if ((local_c.dwHighDateTime == 0) || (local_c.dwLowDateTime == 0)) {
    *(undefined8 *)(param_1 + 0x18) = 0x4000000000000000;
    Ordinal_185(0x4000000000000000,param_1 + 8);
  }
  else {
    LocalFileTimeToFileTime(&local_c,&local_14);
    FUN_67681512(param_1);
  }
  return;
}



// Function: FUN_67683226 at 67683226

undefined4 * __fastcall FUN_67683226(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  
  *param_1 = &PTR_FUN_676b9ab4;
  puVar2 = (undefined4 *)operator_new(0x14);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    *puVar2 = &PTR_FUN_676b9a8c;
    puVar2[2] = 0;
    puVar2[3] = 0;
    puVar2[4] = 1;
  }
  param_1[3] = puVar2;
  puVar2 = (undefined4 *)operator_new(0x14);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    *puVar2 = &PTR_FUN_676b9a8c;
    puVar2[2] = 0;
    puVar2[3] = 0;
    puVar2[4] = 2;
  }
  puVar1 = (undefined4 *)param_1[3];
  param_1[4] = puVar2;
  if (puVar1 != (undefined4 *)0x0) {
    if (puVar2 != (undefined4 *)0x0) goto LAB_676832a4;
    if (puVar1 != (undefined4 *)0x0) {
      (**(code **)*puVar1)(1);
      param_1[3] = 0;
    }
  }
  if ((undefined4 *)param_1[4] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[4])(1);
    param_1[4] = 0;
  }
LAB_676832a4:
  FUN_6768340c(param_1,0);
  FUN_6768343e(param_1,0);
  param_1[5] = 0;
  return param_1;
}



// Function: FUN_676832bd at 676832bd

void __fastcall FUN_676832bd(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b9ab4;
  while (param_1[1] != 0) {
    FUN_676832f3(param_1,(undefined4 *)0x0);
  }
  if ((undefined4 *)param_1[3] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[3])(1);
  }
  if ((undefined4 *)param_1[4] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[4])(1);
  }
  return;
}



// Function: FUN_676832f3 at 676832f3

uint __thiscall FUN_676832f3(void *this,undefined4 *param_1)

{
  undefined4 *puVar1;
  uint in_EAX;
  uint uVar2;
  
  puVar1 = *(undefined4 **)((int)this + 4);
  if (puVar1 == (undefined4 *)0x0) {
    uVar2 = in_EAX & 0xffffff00;
  }
  else {
    FUN_6768340c(this,puVar1[3]);
    if (*(int *)((int)this + 4) == 0) {
      FUN_6768343e(this,0);
    }
    if (param_1 != (undefined4 *)0x0) {
      *param_1 = puVar1[1];
    }
    *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + -1;
    if (puVar1 != (undefined4 *)0x0) {
      param_1 = (undefined4 *)(**(code **)*puVar1)(1);
    }
    uVar2 = CONCAT31((int3)((uint)param_1 >> 8),1);
  }
  return uVar2;
}



// Function: FUN_6768333e at 6768333e

void __fastcall FUN_6768333e(void *param_1)

{
  while (*(int *)((int)param_1 + 4) != 0) {
    FUN_676832f3(param_1,(undefined4 *)0x0);
  }
  return;
}



// Function: FUN_67683354 at 67683354

int __fastcall FUN_67683354(int param_1)

{
  int iVar1;
  
  if ((*(int *)(param_1 + 0x10) != 2) && (iVar1 = *(int *)(param_1 + 0xc), iVar1 != 0)) {
    *(undefined4 *)(param_1 + 4) = *(undefined4 *)(iVar1 + 4);
    *(undefined4 *)(param_1 + 8) = *(undefined4 *)(iVar1 + 8);
    *(undefined4 *)(param_1 + 0xc) = *(undefined4 *)(iVar1 + 0xc);
    *(undefined4 *)(param_1 + 0x10) = *(undefined4 *)(iVar1 + 0x10);
    if (*(int *)(param_1 + 8) != 0) {
      return *(int *)(param_1 + 8);
    }
  }
  return param_1;
}



// Function: FUN_67683385 at 67683385

void __thiscall FUN_67683385(void *this,int param_1)

{
  *(undefined4 *)((int)this + 4) = *(undefined4 *)(param_1 + 4);
  *(undefined4 *)((int)this + 8) = *(undefined4 *)(param_1 + 8);
  *(undefined4 *)((int)this + 0xc) = *(undefined4 *)(param_1 + 0xc);
  *(undefined4 *)((int)this + 0x10) = *(undefined4 *)(param_1 + 0x10);
  return;
}



// Function: FUN_676833a6 at 676833a6

undefined4 __thiscall FUN_676833a6(void *this,int param_1)

{
  int iVar1;
  undefined3 uVar2;
  bool bVar3;
  
  iVar1 = *(int *)((int)this + 0x10);
  uVar2 = (undefined3)((uint)iVar1 >> 8);
  if (iVar1 == *(int *)(param_1 + 0x10)) {
    if (iVar1 == 0) {
      bVar3 = *(int *)((int)this + 4) == *(int *)(param_1 + 4);
      uVar2 = (undefined3)((uint)*(int *)((int)this + 4) >> 8);
    }
    else {
      bVar3 = true;
    }
  }
  else {
    bVar3 = false;
  }
  return CONCAT31(uVar2,!bVar3);
}



// Function: FUN_676833d3 at 676833d3

undefined4 * __thiscall FUN_676833d3(void *this,byte param_1)

{
  FUN_676832bd((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_676833ef at 676833ef

undefined4 * __thiscall FUN_676833ef(void *this,byte param_1)

{
  *(undefined ***)this = &PTR_FUN_676b9a8c;
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_6768340c at 6768340c

void __thiscall FUN_6768340c(void *this,int param_1)

{
  *(int *)((int)this + 4) = param_1;
  if ((param_1 != 0) && (*(int *)(param_1 + 0x10) != 0)) {
    *(undefined4 *)((int)this + 4) = 0;
  }
  if (*(int *)((int)this + 0xc) != 0) {
    *(undefined4 *)(*(int *)((int)this + 0xc) + 0xc) = *(undefined4 *)((int)this + 4);
    if (*(int *)((int)this + 4) != 0) {
      *(undefined4 *)(*(int *)((int)this + 4) + 8) = *(undefined4 *)((int)this + 0xc);
    }
  }
  return;
}



// Function: FUN_6768343e at 6768343e

void __thiscall FUN_6768343e(void *this,int param_1)

{
  *(int *)((int)this + 8) = param_1;
  if ((param_1 != 0) && (*(int *)(param_1 + 0x10) != 0)) {
    *(undefined4 *)((int)this + 8) = 0;
  }
  if (*(int *)((int)this + 0x10) != 0) {
    *(undefined4 *)(*(int *)((int)this + 0x10) + 8) = *(undefined4 *)((int)this + 8);
    if (*(int *)((int)this + 8) != 0) {
      *(undefined4 *)(*(int *)((int)this + 8) + 0xc) = *(undefined4 *)((int)this + 0x10);
    }
  }
  return;
}



// Function: FUN_67683470 at 67683470

uint __thiscall FUN_67683470(void *this,int param_1)

{
  int iVar1;
  uint3 uVar3;
  uint uVar2;
  
  iVar1 = *(int *)((int)this + 0x10);
  uVar3 = (uint3)((uint)iVar1 >> 8);
  if (iVar1 == *(int *)(param_1 + 0x10)) {
    if (iVar1 == 0) {
      uVar2 = (uint)(*(int *)((int)this + 4) == *(int *)(param_1 + 4));
    }
    else {
      uVar2 = CONCAT31(uVar3,1);
    }
  }
  else {
    uVar2 = (uint)uVar3 << 8;
  }
  return uVar2;
}



// Function: FUN_676834a0 at 676834a0

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_676834a0(void)

{
  _DAT_676c50f0 = 0;
  _DAT_676c50f4 = 0;
  _DAT_676c50f8 = 0xffffffff;
  _DAT_676c50e8 = &PTR_FUN_676b9abc;
  return;
}



// Function: FUN_676834c0 at 676834c0

void FUN_676834c0(void)

{
  FUN_676b0c45(&LAB_676834cc);
  return;
}



// Function: FUN_676834e7 at 676834e7

undefined4 * __fastcall FUN_676834e7(undefined4 *param_1)

{
  FUN_67683c8f(param_1);
  *param_1 = &PTR_FUN_676b9ac0;
  return param_1;
}



// Function: FUN_676834f9 at 676834f9

undefined4 * __thiscall FUN_676834f9(void *this,byte param_1)

{
  FUN_67683515((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_67683515 at 67683515

void __fastcall FUN_67683515(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b9ac0;
  FUN_67683a8d(param_1);
  FUN_67683d26(param_1);
  return;
}



// Function: FUN_6768352c at 6768352c

undefined4 __thiscall
FUN_6768352c(void *this,void *param_1,short *param_2,ushort param_3,undefined4 param_4,
            undefined4 param_5)

{
  bool bVar1;
  uint in_EAX;
  undefined4 *this_00;
  undefined3 extraout_var;
  
  if (param_2 != (short *)0x0) {
    do {
      if (param_3 < 2) {
        in_EAX = FUN_6767ca9c(param_1,0x13b,0x1000000);
        break;
      }
      this_00 = FUN_67683ab5(this,*param_2);
      if (this_00 == (undefined4 *)0x0) {
        in_EAX = FUN_6767ca9c(param_1,999,0x4000000);
LAB_676835a9:
        return in_EAX & 0xffffff00;
      }
      bVar1 = FUN_6768216e(this_00,param_1,(int *)&param_2,&param_3,param_4,param_5);
      in_EAX = CONCAT31(extraout_var,bVar1);
      if ((!bVar1) && (*(int *)((int)param_1 + 8) == 0x4000000)) goto LAB_676835a9;
    } while (param_2 != (short *)0x0);
  }
  return CONCAT31((int3)(in_EAX >> 8),1);
}



// Function: FUN_676835ad at 676835ad

uint __thiscall
FUN_676835ad(void *this,void *param_1,short *param_2,ushort param_3,undefined4 param_4,
            undefined4 param_5)

{
  bool bVar1;
  uint in_EAX;
  undefined4 *this_00;
  undefined3 extraout_var;
  
  do {
    if (param_2 == (short *)0x0) {
LAB_67683602:
      return CONCAT31((int3)(in_EAX >> 8),1);
    }
    if (param_3 < 2) {
      in_EAX = FUN_6767ca9c(param_1,0x13b,0x1000000);
      goto LAB_67683602;
    }
    this_00 = FUN_67683ab5(this,*param_2);
    if (this_00 == (undefined4 *)0x0) {
      in_EAX = FUN_6767ca9c(param_1,999,0x4000000);
      goto LAB_6768361b;
    }
    bVar1 = FUN_67682248(this_00,param_1,(int *)&param_2,&param_3,param_4,param_5);
    in_EAX = CONCAT31(extraout_var,bVar1);
    if (!bVar1) {
LAB_6768361b:
      return in_EAX & 0xffffff00;
    }
  } while( true );
}



// Function: FUN_6768361f at 6768361f

uint __thiscall FUN_6768361f(void *this,void *param_1,undefined4 param_2,byte param_3)

{
  char cVar1;
  uint uVar2;
  undefined4 *puVar3;
  int *piVar4;
  
                    /* WARNING: Load size is inaccurate */
  uVar2 = (**(code **)(*this + 4))();
  if ((param_3 & 1) == 0) {
LAB_6768369a:
    if ((param_3 & 2) != 0) {
      puVar3 = (undefined4 *)operator_new(0x34);
      if (puVar3 == (undefined4 *)0x0) {
        piVar4 = (int *)0x0;
      }
      else {
        piVar4 = FUN_67682c49(puVar3);
      }
      if (piVar4 == (int *)0x0) goto LAB_67683666;
      cVar1 = (**(code **)(*piVar4 + 8))(param_1,param_2);
      if (cVar1 == '\0') {
        uVar2 = (**(code **)*piVar4)(1);
        if (*(int *)((int)param_1 + 8) == 0x4000000) goto LAB_67683781;
      }
      else {
        uVar2 = FUN_67683f1c(this,piVar4);
      }
    }
    if ((param_3 & 4) != 0) {
      puVar3 = (undefined4 *)operator_new(0x2c);
      if (puVar3 == (undefined4 *)0x0) {
        piVar4 = (int *)0x0;
      }
      else {
        piVar4 = FUN_67684596(puVar3);
      }
      if (piVar4 == (int *)0x0) goto LAB_67683666;
      cVar1 = (**(code **)(*piVar4 + 8))(param_1,param_2);
      if (cVar1 == '\0') {
        uVar2 = (**(code **)*piVar4)(1);
        if (*(int *)((int)param_1 + 8) == 0x4000000) goto LAB_67683781;
      }
      else {
        uVar2 = FUN_67683f1c(this,piVar4);
      }
    }
    if ((param_3 & 8) == 0) goto LAB_6768378e;
    puVar3 = (undefined4 *)operator_new(0x1c);
    if (puVar3 == (undefined4 *)0x0) {
      piVar4 = (int *)0x0;
    }
    else {
      piVar4 = FUN_67684b33(puVar3);
    }
    if (piVar4 != (int *)0x0) {
      cVar1 = (**(code **)(*piVar4 + 8))(param_1,param_2);
      if (cVar1 != '\0') {
        uVar2 = FUN_67683f1c(this,piVar4);
LAB_6768378e:
        return CONCAT31((int3)(uVar2 >> 8),1);
      }
      uVar2 = (**(code **)*piVar4)(1);
      if (*(int *)((int)param_1 + 8) != 0x4000000) goto LAB_6768378e;
      goto LAB_67683781;
    }
  }
  else {
    puVar3 = (undefined4 *)operator_new(0x1c);
    if (puVar3 == (undefined4 *)0x0) {
      piVar4 = (int *)0x0;
    }
    else {
      piVar4 = FUN_676826ea(puVar3);
    }
    if (piVar4 != (int *)0x0) {
      cVar1 = (**(code **)(*piVar4 + 8))(param_1,param_2);
      if (cVar1 == '\0') {
        uVar2 = (**(code **)*piVar4)(1);
        if (*(int *)((int)param_1 + 8) == 0x4000000) goto LAB_67683781;
      }
      else {
        uVar2 = FUN_67683f1c(this,piVar4);
      }
      goto LAB_6768369a;
    }
  }
LAB_67683666:
  uVar2 = FUN_6767ca9c(param_1,0x1ff,0x4000000);
LAB_67683781:
  return uVar2 & 0xffffff00;
}



// Function: FUN_67683797 at 67683797

uint __thiscall FUN_67683797(void *this,void *param_1,undefined4 param_2,undefined4 param_3)

{
  undefined *puVar1;
  undefined4 uVar2;
  uint uVar3;
  undefined1 local_18 [4];
  int *local_14;
  
  puVar1 = *(undefined **)((int)this + 4);
  if ((puVar1 == (undefined *)0x0) &&
     (puVar1 = *(undefined **)((int)this + 0x10), puVar1 == (undefined *)0x0)) {
    puVar1 = &DAT_676c50e8;
  }
  FUN_67683e1f(local_18,(int)puVar1);
  while( true ) {
    puVar1 = *(undefined **)((int)this + 0x10);
    if (puVar1 == (undefined *)0x0) {
      puVar1 = &DAT_676c50e8;
    }
    uVar2 = FUN_67683e77(local_18,(int)puVar1);
    if ((char)uVar2 == '\0') {
      return CONCAT31((int3)((uint)uVar2 >> 8),1);
    }
    if (local_14 == (int *)0x0) break;
    uVar3 = (**(code **)(*local_14 + 0xc))(param_1,param_2,param_3);
    if (((char)uVar3 == '\0') && (*(int *)((int)param_1 + 8) == 0x4000000)) goto LAB_67683814;
    FUN_67683e46((int)local_18);
  }
  uVar3 = FUN_6767ca9c(param_1,999,0x4000000);
LAB_67683814:
  return uVar3 & 0xffffff00;
}



// Function: FUN_67683821 at 67683821

uint __thiscall
FUN_67683821(void *this,void *param_1,int *param_2,short *param_3,int param_4,undefined4 param_5)

{
  int *this_00;
  char cVar1;
  uint uVar2;
  undefined *puVar3;
  undefined4 uVar4;
  undefined1 local_18 [4];
  int *local_14;
  
  uVar2 = FUN_676838c8(param_1,param_2,param_3,param_4);
  if (((char)uVar2 != '\0') || (*(int *)((int)param_1 + 8) != 0x4000000)) {
    puVar3 = *(undefined **)((int)this + 4);
    if ((puVar3 == (undefined *)0x0) &&
       (puVar3 = *(undefined **)((int)this + 0x10), puVar3 == (undefined *)0x0)) {
      puVar3 = &DAT_676c50e8;
    }
    FUN_67683e1f(local_18,(int)puVar3);
    while( true ) {
      puVar3 = *(undefined **)((int)this + 0x10);
      if (puVar3 == (undefined *)0x0) {
        puVar3 = &DAT_676c50e8;
      }
      uVar4 = FUN_67683e77(local_18,(int)puVar3);
      this_00 = local_14;
      if ((char)uVar4 == '\0') {
        return CONCAT31((int3)((uint)uVar4 >> 8),1);
      }
      cVar1 = (**(code **)(*local_14 + 0x10))(param_5);
      if (((cVar1 != '\0') &&
          (uVar2 = FUN_676823bb(this_00,param_1,param_2,param_3,param_4), (char)uVar2 == '\0')) &&
         (*(int *)((int)param_1 + 8) == 0x4000000)) break;
      FUN_67683e46((int)local_18);
    }
  }
  return uVar2 & 0xffffff00;
}



// Function: FUN_676838c8 at 676838c8

undefined4 FUN_676838c8(void *param_1,int *param_2,short *param_3,int param_4)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  undefined4 local_20 [7];
  
  iVar1 = FUN_67683c22();
  uVar2 = FUN_67683dbd();
  if (((iVar1 <= (int)uVar2) || (uVar2 = FUN_67683dee(), iVar1 <= (int)uVar2)) &&
     (((uVar2 = 0, *(int *)(param_4 + 0x2c) != 0 ||
       ((((*(int *)(param_4 + 0x28) == -1 || (*(int *)(param_4 + 0x24) != 0)) ||
         (*(int *)(param_4 + 0x20) == -1)) ||
        ((*(int *)(param_4 + 0x44) != 0 || (*(int *)(param_4 + 0x40) == -1)))))) ||
      (0xfffe < *(uint *)(param_4 + 0x38))))) {
    FUN_67685110(local_20);
    uVar3 = FUN_676823bb(local_20,param_1,param_2,param_3,param_4);
    if (((char)uVar3 == '\0') && (*(int *)((int)param_1 + 8) == 0x4000000)) {
      uVar2 = FUN_67685144(local_20);
      return uVar2 & 0xffffff00;
    }
    uVar2 = FUN_67685144(local_20);
  }
  return CONCAT31((int3)(uVar2 >> 8),1);
}



// Function: FUN_67683960 at 67683960

uint __thiscall
FUN_67683960(void *this,void *param_1,int *param_2,short *param_3,int param_4,char param_5,
            undefined4 param_6)

{
  int *this_00;
  char cVar1;
  uint uVar2;
  undefined *puVar3;
  undefined1 local_18 [4];
  int *local_14;
  
  uVar2 = FUN_67683a0d(param_1,param_2,param_3,param_4);
  if (((char)uVar2 == '\0') && (*(int *)((int)param_1 + 8) == 0x4000000)) {
LAB_67683a00:
    uVar2 = uVar2 & 0xffffff00;
  }
  else {
    if (param_5 == '\0') {
      puVar3 = *(undefined **)((int)this + 4);
      if ((puVar3 == (undefined *)0x0) &&
         (puVar3 = *(undefined **)((int)this + 0x10), puVar3 == (undefined *)0x0)) {
        puVar3 = &DAT_676c50e8;
      }
      FUN_67683e1f(local_18,(int)puVar3);
      do {
        puVar3 = *(undefined **)((int)this + 0x10);
        if (puVar3 == (undefined *)0x0) {
          puVar3 = &DAT_676c50e8;
        }
        uVar2 = FUN_67683e77(local_18,(int)puVar3);
        this_00 = local_14;
        if ((char)uVar2 == '\0') break;
        cVar1 = (**(code **)(*local_14 + 0x10))(param_6);
        if (cVar1 != '\0') {
          uVar2 = FUN_67682325(this_00,param_1,param_2,param_3,param_4);
          if (((char)uVar2 == '\0') && (*(int *)((int)param_1 + 8) == 0x4000000)) goto LAB_67683a00;
        }
        FUN_67683e46((int)local_18);
      } while( true );
    }
    uVar2 = CONCAT31((int3)(uVar2 >> 8),1);
  }
  return uVar2;
}



// Function: FUN_67683a0d at 67683a0d

undefined4 FUN_67683a0d(void *param_1,int *param_2,short *param_3,int param_4)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  undefined4 local_20 [7];
  
  iVar1 = FUN_67683c22();
  uVar2 = FUN_67683dbd();
  if (((iVar1 <= (int)uVar2) || (uVar2 = FUN_67683dee(), iVar1 <= (int)uVar2)) &&
     ((*(int *)(param_4 + 0x2c) != 0 ||
      (((*(int *)(param_4 + 0x28) == -1 || (*(int *)(param_4 + 0x24) != 0)) ||
       (*(int *)(param_4 + 0x20) == -1)))))) {
    FUN_67685110(local_20);
    uVar3 = FUN_67682325(local_20,param_1,param_2,param_3,param_4);
    if (((char)uVar3 == '\0') && (*(int *)((int)param_1 + 8) == 0x4000000)) {
      uVar2 = FUN_67685144(local_20);
      return uVar2 & 0xffffff00;
    }
    uVar2 = FUN_67685144(local_20);
  }
  return CONCAT31((int3)(uVar2 >> 8),1);
}



// Function: FUN_67683a8d at 67683a8d

void __fastcall FUN_67683a8d(undefined4 *param_1)

{
  undefined4 uVar1;
  undefined4 *local_8;
  
  local_8 = param_1;
  while( true ) {
    uVar1 = FUN_67683d5c(param_1,&local_8);
    if ((char)uVar1 == '\0') break;
    if (local_8 != (undefined4 *)0x0) {
      (**(code **)*local_8)(1);
    }
  }
  return;
}



// Function: FUN_67683ab5 at 67683ab5

undefined4 * __thiscall FUN_67683ab5(void *this,short param_1)

{
  undefined *puVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  int iVar4;
  uint uVar5;
  undefined1 local_1c [4];
  undefined4 *local_18;
  void *local_8;
  
  local_8 = this;
  if (param_1 == 1) {
    iVar4 = FUN_67683c22();
    uVar5 = FUN_67683dbd();
    if ((iVar4 <= (int)uVar5) || (uVar5 = FUN_67683dee(), iVar4 <= (int)uVar5)) {
      puVar3 = (undefined4 *)operator_new(0x1c);
      if (puVar3 == (undefined4 *)0x0) {
        return (undefined4 *)0x0;
      }
      puVar3 = FUN_67685110(puVar3);
      return puVar3;
    }
  }
  else if ((((param_1 == 10) || (param_1 == 0x4453)) || (param_1 == 0x5455)) || (param_1 == 0x554e))
  {
    puVar1 = *(undefined **)((int)this + 4);
    if ((puVar1 == (undefined *)0x0) &&
       (puVar1 = *(undefined **)((int)this + 0x10), puVar1 == (undefined *)0x0)) {
      puVar1 = &DAT_676c50e8;
    }
    FUN_67683e1f(local_1c,(int)puVar1);
    while( true ) {
      puVar1 = *(undefined **)((int)local_8 + 0x10);
      if (puVar1 == (undefined *)0x0) {
        puVar1 = &DAT_676c50e8;
      }
      uVar2 = FUN_67683e77(local_1c,(int)puVar1);
      if ((char)uVar2 == '\0') break;
      if (*(short *)(local_18 + 1) == param_1) {
        return local_18;
      }
      FUN_67683e46((int)local_1c);
    }
    if (param_1 == 10) {
      puVar3 = (undefined4 *)operator_new(0x34);
      if (puVar3 != (undefined4 *)0x0) {
        puVar3 = FUN_67682c49(puVar3);
        goto LAB_67683c08;
      }
    }
    else if (param_1 == 0x4453) {
      puVar3 = (undefined4 *)operator_new(0x2c);
      if (puVar3 != (undefined4 *)0x0) {
        puVar3 = FUN_67684596(puVar3);
        goto LAB_67683c08;
      }
    }
    else if (param_1 == 0x5455) {
      puVar3 = (undefined4 *)operator_new(0x1c);
      if (puVar3 != (undefined4 *)0x0) {
        puVar3 = FUN_676826ea(puVar3);
        goto LAB_67683c08;
      }
    }
    else {
      if (param_1 != 0x554e) {
        return (undefined4 *)0x0;
      }
      puVar3 = (undefined4 *)operator_new(0x1c);
      if (puVar3 != (undefined4 *)0x0) {
        puVar3 = FUN_67684b33(puVar3);
        goto LAB_67683c08;
      }
    }
    puVar3 = (undefined4 *)0x0;
    goto LAB_67683c08;
  }
  puVar3 = (undefined4 *)operator_new(0x1c);
  if (puVar3 == (undefined4 *)0x0) {
    puVar3 = (undefined4 *)0x0;
  }
  else {
    puVar3 = FUN_67681ff7(puVar3);
  }
  *(short *)(puVar3 + 1) = param_1;
LAB_67683c08:
  if (puVar3 == (undefined4 *)0x0) {
    return (undefined4 *)0x0;
  }
  FUN_67683f1c(local_8,puVar3);
  return puVar3;
}



// Function: FUN_67683c22 at 67683c22

int FUN_67683c22(void)

{
  int iVar1;
  
  iVar1 = FUN_67683c37();
  if (iVar1 != 0) {
    iVar1 = FUN_67683c37();
    return iVar1 << 1;
  }
  return 1;
}



// Function: FUN_67683c37 at 67683c37

int FUN_67683c37(void)

{
  int iVar1;
  
  iVar1 = FUN_67683c4c();
  if (iVar1 != 0) {
    iVar1 = FUN_67683c4c();
    return iVar1 << 1;
  }
  return 1;
}



// Function: FUN_67683c4c at 67683c4c

int FUN_67683c4c(void)

{
  int iVar1;
  
  iVar1 = FUN_67683c61();
  if (iVar1 != 0) {
    iVar1 = FUN_67683c61();
    return iVar1 << 1;
  }
  return 1;
}



// Function: FUN_67683c61 at 67683c61

int FUN_67683c61(void)

{
  int iVar1;
  
  iVar1 = FUN_67683c76();
  if (iVar1 != 0) {
    iVar1 = FUN_67683c76();
    return iVar1 << 1;
  }
  return 1;
}



// Function: FUN_67683c76 at 67683c76

int FUN_67683c76(void)

{
  int iVar1;
  
  iVar1 = FUN_67683c8b();
  if (iVar1 != 0) {
    iVar1 = FUN_67683c8b();
    return iVar1 << 1;
  }
  return 1;
}



// Function: FUN_67683c8b at 67683c8b

undefined4 FUN_67683c8b(void)

{
  return 2;
}



// Function: FUN_67683c8f at 67683c8f

undefined4 * __fastcall FUN_67683c8f(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  
  *param_1 = &PTR_FUN_676b9ac8;
  puVar2 = (undefined4 *)operator_new(0x14);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    *puVar2 = &PTR_FUN_676b9abc;
    puVar2[2] = 0;
    puVar2[3] = 0;
    puVar2[4] = 1;
  }
  param_1[3] = puVar2;
  puVar2 = (undefined4 *)operator_new(0x14);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    *puVar2 = &PTR_FUN_676b9abc;
    puVar2[2] = 0;
    puVar2[3] = 0;
    puVar2[4] = 2;
  }
  puVar1 = (undefined4 *)param_1[3];
  param_1[4] = puVar2;
  if (puVar1 != (undefined4 *)0x0) {
    if (puVar2 != (undefined4 *)0x0) goto LAB_67683d0d;
    if (puVar1 != (undefined4 *)0x0) {
      (**(code **)*puVar1)(1);
      param_1[3] = 0;
    }
  }
  if ((undefined4 *)param_1[4] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[4])(1);
    param_1[4] = 0;
  }
LAB_67683d0d:
  FUN_67683faa(param_1,0);
  FUN_67683fdc(param_1,0);
  param_1[5] = 0;
  return param_1;
}



// Function: FUN_67683d26 at 67683d26

void __fastcall FUN_67683d26(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b9ac8;
  while (param_1[1] != 0) {
    FUN_67683d5c(param_1,(undefined4 *)0x0);
  }
  if ((undefined4 *)param_1[3] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[3])(1);
  }
  if ((undefined4 *)param_1[4] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[4])(1);
  }
  return;
}



// Function: FUN_67683d5c at 67683d5c

uint __thiscall FUN_67683d5c(void *this,undefined4 *param_1)

{
  undefined4 *puVar1;
  uint in_EAX;
  uint uVar2;
  
  puVar1 = *(undefined4 **)((int)this + 4);
  if (puVar1 == (undefined4 *)0x0) {
    uVar2 = in_EAX & 0xffffff00;
  }
  else {
    FUN_67683faa(this,puVar1[3]);
    if (*(int *)((int)this + 4) == 0) {
      FUN_67683fdc(this,0);
    }
    if (param_1 != (undefined4 *)0x0) {
      *param_1 = puVar1[1];
    }
    *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + -1;
    if (puVar1 != (undefined4 *)0x0) {
      param_1 = (undefined4 *)(**(code **)*puVar1)(1);
    }
    uVar2 = CONCAT31((int3)((uint)param_1 >> 8),1);
  }
  return uVar2;
}



// Function: FUN_67683da7 at 67683da7

void __fastcall FUN_67683da7(void *param_1)

{
  while (*(int *)((int)param_1 + 4) != 0) {
    FUN_67683d5c(param_1,(undefined4 *)0x0);
  }
  return;
}



// Function: FUN_67683dbd at 67683dbd

uint FUN_67683dbd(void)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  uVar2 = FUN_67684056();
  bVar1 = FUN_6768400e();
  if (bVar1) {
    iVar3 = FUN_67683edd();
    uVar2 = uVar2 + iVar3;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return uVar2;
}



// Function: FUN_67683dee at 67683dee

uint FUN_67683dee(void)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  uVar2 = FUN_67684087();
  bVar1 = FUN_67684032();
  if (bVar1) {
    iVar3 = FUN_67683edd();
    uVar2 = uVar2 + iVar3;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return uVar2;
}



// Function: FUN_67683e1f at 67683e1f

void __thiscall FUN_67683e1f(void *this,int param_1)

{
  *(undefined ***)this = &PTR_FUN_676b9abc;
  *(undefined4 *)((int)this + 4) = *(undefined4 *)(param_1 + 4);
  *(undefined4 *)((int)this + 8) = *(undefined4 *)(param_1 + 8);
  *(undefined4 *)((int)this + 0xc) = *(undefined4 *)(param_1 + 0xc);
  *(undefined4 *)((int)this + 0x10) = *(undefined4 *)(param_1 + 0x10);
  return;
}



// Function: FUN_67683e46 at 67683e46

int __fastcall FUN_67683e46(int param_1)

{
  int iVar1;
  
  if ((*(int *)(param_1 + 0x10) != 2) && (iVar1 = *(int *)(param_1 + 0xc), iVar1 != 0)) {
    *(undefined4 *)(param_1 + 4) = *(undefined4 *)(iVar1 + 4);
    *(undefined4 *)(param_1 + 8) = *(undefined4 *)(iVar1 + 8);
    *(undefined4 *)(param_1 + 0xc) = *(undefined4 *)(iVar1 + 0xc);
    *(undefined4 *)(param_1 + 0x10) = *(undefined4 *)(iVar1 + 0x10);
    if (*(int *)(param_1 + 8) != 0) {
      return *(int *)(param_1 + 8);
    }
  }
  return param_1;
}



// Function: FUN_67683e77 at 67683e77

undefined4 __thiscall FUN_67683e77(void *this,int param_1)

{
  int iVar1;
  undefined3 uVar2;
  bool bVar3;
  
  iVar1 = *(int *)((int)this + 0x10);
  uVar2 = (undefined3)((uint)iVar1 >> 8);
  if (iVar1 == *(int *)(param_1 + 0x10)) {
    if (iVar1 == 0) {
      bVar3 = *(int *)((int)this + 4) == *(int *)(param_1 + 4);
      uVar2 = (undefined3)((uint)*(int *)((int)this + 4) >> 8);
    }
    else {
      bVar3 = true;
    }
  }
  else {
    bVar3 = false;
  }
  return CONCAT31(uVar2,!bVar3);
}



// Function: FUN_67683ea4 at 67683ea4

undefined4 * __thiscall FUN_67683ea4(void *this,byte param_1)

{
  FUN_67683d26((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_67683ec0 at 67683ec0

undefined4 * __thiscall FUN_67683ec0(void *this,byte param_1)

{
  *(undefined ***)this = &PTR_FUN_676b9abc;
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_67683edd at 67683edd

int FUN_67683edd(void)

{
  int iVar1;
  
  iVar1 = FUN_67683ef2();
  if (iVar1 != 0) {
    iVar1 = FUN_67683ef2();
    return iVar1 << 1;
  }
  return 1;
}



// Function: FUN_67683ef2 at 67683ef2

int FUN_67683ef2(void)

{
  int iVar1;
  
  iVar1 = FUN_67683f07();
  if (iVar1 != 0) {
    iVar1 = FUN_67683f07();
    return iVar1 << 1;
  }
  return 1;
}



// Function: FUN_67683f07 at 67683f07

int FUN_67683f07(void)

{
  int iVar1;
  
  iVar1 = FUN_67683c22();
  if (iVar1 != 0) {
    iVar1 = FUN_67683c22();
    return iVar1 << 1;
  }
  return 1;
}



// Function: FUN_67683f1c at 67683f1c

undefined4 __thiscall FUN_67683f1c(void *this,undefined4 param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  
  if (*(int *)((int)this + 4) == 0) {
    puVar1 = (undefined4 *)operator_new(0x14);
    if (puVar1 == (undefined4 *)0x0) {
      puVar3 = (undefined4 *)0x0;
    }
    else {
      *puVar1 = &PTR_FUN_676b9abc;
      puVar1[1] = param_1;
      puVar1[2] = 0;
      puVar1[3] = 0;
      puVar1[4] = 0;
      puVar3 = puVar1;
    }
    if (puVar3 == (undefined4 *)0x0) {
LAB_67683f87:
      return (uint)puVar1 & 0xffffff00;
    }
    FUN_67683faa(this,(int)puVar3);
    puVar1 = puVar3;
  }
  else {
    puVar1 = (undefined4 *)operator_new(0x14);
    if (puVar1 == (undefined4 *)0x0) {
      puVar1 = (undefined4 *)0x0;
    }
    else {
      *puVar1 = &PTR_FUN_676b9abc;
      puVar1[1] = param_1;
      puVar1[2] = 0;
      puVar1[3] = 0;
      puVar1[4] = 0;
    }
    if (puVar1 == (undefined4 *)0x0) goto LAB_67683f87;
    *(undefined4 **)(*(int *)((int)this + 8) + 0xc) = puVar1;
    puVar1[2] = *(undefined4 *)((int)this + 8);
  }
  uVar2 = FUN_67683fdc(this,(int)puVar1);
  *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + 1;
  return CONCAT31((int3)((uint)uVar2 >> 8),1);
}



// Function: FUN_67683faa at 67683faa

void __thiscall FUN_67683faa(void *this,int param_1)

{
  *(int *)((int)this + 4) = param_1;
  if ((param_1 != 0) && (*(int *)(param_1 + 0x10) != 0)) {
    *(undefined4 *)((int)this + 4) = 0;
  }
  if (*(int *)((int)this + 0xc) != 0) {
    *(undefined4 *)(*(int *)((int)this + 0xc) + 0xc) = *(undefined4 *)((int)this + 4);
    if (*(int *)((int)this + 4) != 0) {
      *(undefined4 *)(*(int *)((int)this + 4) + 8) = *(undefined4 *)((int)this + 0xc);
    }
  }
  return;
}



// Function: FUN_67683fdc at 67683fdc

void __thiscall FUN_67683fdc(void *this,int param_1)

{
  *(int *)((int)this + 8) = param_1;
  if ((param_1 != 0) && (*(int *)(param_1 + 0x10) != 0)) {
    *(undefined4 *)((int)this + 8) = 0;
  }
  if (*(int *)((int)this + 0x10) != 0) {
    *(undefined4 *)(*(int *)((int)this + 0x10) + 8) = *(undefined4 *)((int)this + 8);
    if (*(int *)((int)this + 8) != 0) {
      *(undefined4 *)(*(int *)((int)this + 8) + 0xc) = *(undefined4 *)((int)this + 0x10);
    }
  }
  return;
}



// Function: FUN_6768400e at 6768400e

bool FUN_6768400e(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c5118 == 2;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_67684032 at 67684032

bool FUN_67684032(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c5118 == 1;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_67684056 at 67684056

uint FUN_67684056(void)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  uVar2 = FUN_67684100();
  bVar1 = FUN_676840b8();
  if (bVar1) {
    iVar3 = FUN_67683ef2();
    uVar2 = uVar2 + iVar3;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return uVar2;
}



// Function: FUN_67684087 at 67684087

uint FUN_67684087(void)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  uVar2 = FUN_67684131();
  bVar1 = FUN_676840dc();
  if (bVar1) {
    iVar3 = FUN_67683ef2();
    uVar2 = uVar2 + iVar3;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return uVar2;
}



// Function: FUN_676840b8 at 676840b8

bool FUN_676840b8(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c511c == 2;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_676840dc at 676840dc

bool FUN_676840dc(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c511c == 1;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_67684100 at 67684100

uint FUN_67684100(void)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  uVar2 = FUN_676841aa();
  bVar1 = FUN_67684162();
  if (bVar1) {
    iVar3 = FUN_67683f07();
    uVar2 = uVar2 + iVar3;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return uVar2;
}



// Function: FUN_67684131 at 67684131

uint FUN_67684131(void)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  uVar2 = FUN_676841db();
  bVar1 = FUN_67684186();
  if (bVar1) {
    iVar3 = FUN_67683f07();
    uVar2 = uVar2 + iVar3;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return uVar2;
}



// Function: FUN_67684162 at 67684162

bool FUN_67684162(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c5120 == 2;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_67684186 at 67684186

bool FUN_67684186(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c5120 == 1;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_676841aa at 676841aa

uint FUN_676841aa(void)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  uVar2 = FUN_67684254();
  bVar1 = FUN_6768420c();
  if (bVar1) {
    iVar3 = FUN_67683c22();
    uVar2 = uVar2 + iVar3;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return uVar2;
}



// Function: FUN_676841db at 676841db

uint FUN_676841db(void)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  uVar2 = FUN_67684285();
  bVar1 = FUN_67684230();
  if (bVar1) {
    iVar3 = FUN_67683c22();
    uVar2 = uVar2 + iVar3;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return uVar2;
}



// Function: FUN_6768420c at 6768420c

bool FUN_6768420c(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c5124 == 2;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_67684230 at 67684230

bool FUN_67684230(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c5124 == 1;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_67684254 at 67684254

uint FUN_67684254(void)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  uVar2 = FUN_676842fe();
  bVar1 = FUN_676842b6();
  if (bVar1) {
    iVar3 = FUN_67683c37();
    uVar2 = uVar2 + iVar3;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return uVar2;
}



// Function: FUN_67684285 at 67684285

uint FUN_67684285(void)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  uVar2 = FUN_6768432f();
  bVar1 = FUN_676842da();
  if (bVar1) {
    iVar3 = FUN_67683c37();
    uVar2 = uVar2 + iVar3;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return uVar2;
}



// Function: FUN_676842b6 at 676842b6

bool FUN_676842b6(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c5128 == 2;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_676842da at 676842da

bool FUN_676842da(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c5128 == 1;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_676842fe at 676842fe

uint FUN_676842fe(void)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  uVar2 = FUN_676843a8();
  bVar1 = FUN_67684360();
  if (bVar1) {
    iVar3 = FUN_67683c4c();
    uVar2 = uVar2 + iVar3;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return uVar2;
}



// Function: FUN_6768432f at 6768432f

uint FUN_6768432f(void)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  uVar2 = FUN_676843c4();
  bVar1 = FUN_67684384();
  if (bVar1) {
    iVar3 = FUN_67683c4c();
    uVar2 = uVar2 + iVar3;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return uVar2;
}



// Function: FUN_67684360 at 67684360

bool FUN_67684360(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c512c == 2;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_67684384 at 67684384

bool FUN_67684384(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c512c == 1;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_676843a8 at 676843a8

uint FUN_676843a8(void)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  
  uVar2 = FUN_67684428();
  bVar1 = FUN_676843e0();
  if (bVar1) {
    iVar3 = FUN_67683c61();
    uVar2 = uVar2 + iVar3;
  }
  return uVar2;
}



// Function: FUN_676843c4 at 676843c4

uint FUN_676843c4(void)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  
  uVar2 = FUN_67684444();
  bVar1 = FUN_67684404();
  if (bVar1) {
    iVar3 = FUN_67683c61();
    uVar2 = uVar2 + iVar3;
  }
  return uVar2;
}



// Function: FUN_676843e0 at 676843e0

bool FUN_676843e0(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c5130 == 2;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_67684404 at 67684404

bool FUN_67684404(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c5130 == 1;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_67684428 at 67684428

uint FUN_67684428(void)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  
  uVar2 = FUN_676844a8();
  bVar1 = FUN_67684460();
  if (bVar1) {
    iVar3 = FUN_67683c76();
    uVar2 = uVar2 + iVar3;
  }
  return uVar2;
}



// Function: FUN_67684444 at 67684444

uint FUN_67684444(void)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  
  uVar2 = FUN_676844c4();
  bVar1 = FUN_67684484();
  if (bVar1) {
    iVar3 = FUN_67683c76();
    uVar2 = uVar2 + iVar3;
  }
  return uVar2;
}



// Function: FUN_67684460 at 67684460

bool FUN_67684460(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c5134 == 2;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_67684484 at 67684484

bool FUN_67684484(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c5134 == 1;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_676844a8 at 676844a8

uint FUN_676844a8(void)

{
  bool bVar1;
  undefined3 extraout_var;
  int iVar2;
  uint uVar3;
  
  bVar1 = FUN_67684528();
  uVar3 = CONCAT31(extraout_var,bVar1);
  bVar1 = FUN_676844e0();
  if (bVar1) {
    iVar2 = FUN_67683c8b();
    uVar3 = uVar3 + iVar2;
  }
  return uVar3;
}



// Function: FUN_676844c4 at 676844c4

uint FUN_676844c4(void)

{
  bool bVar1;
  undefined3 extraout_var;
  int iVar2;
  uint uVar3;
  
  bVar1 = FUN_6768453b();
  uVar3 = CONCAT31(extraout_var,bVar1);
  bVar1 = FUN_67684504();
  if (bVar1) {
    iVar2 = FUN_67683c8b();
    uVar3 = uVar3 + iVar2;
  }
  return uVar3;
}



// Function: FUN_676844e0 at 676844e0

bool FUN_676844e0(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c5138 == 2;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_67684504 at 67684504

bool FUN_67684504(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c5138 == 1;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_67684528 at 67684528

bool FUN_67684528(void)

{
  bool bVar1;
  
  bVar1 = FUN_6768454e();
  return bVar1;
}



// Function: FUN_6768453b at 6768453b

bool FUN_6768453b(void)

{
  bool bVar1;
  
  bVar1 = FUN_67684572();
  return bVar1;
}



// Function: FUN_6768454e at 6768454e

bool FUN_6768454e(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c513c == 2;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_67684572 at 67684572

bool FUN_67684572(void)

{
  bool bVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  bVar1 = DAT_676c513c == 1;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return bVar1;
}



// Function: FUN_67684596 at 67684596

undefined4 * __fastcall FUN_67684596(undefined4 *param_1)

{
  FUN_67681ff7(param_1);
  FUN_676ad6f8(param_1 + 8);
  param_1[7] = 0;
  *(undefined1 *)(param_1 + 10) = 0;
  *param_1 = &PTR_FUN_676b9ad0;
  *(undefined2 *)(param_1 + 1) = 0x4453;
  return param_1;
}



// Function: FUN_676845be at 676845be

undefined4 * __thiscall FUN_676845be(void *this,byte param_1)

{
  FUN_676845da((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_676845da at 676845da

void __fastcall FUN_676845da(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b9ad0;
  FUN_676ad72d(param_1 + 8);
  FUN_67682054(param_1);
  return;
}



// Function: FUN_676845f4 at 676845f4

undefined4 * __thiscall FUN_676845f4(void *this,int param_1)

{
  FUN_6768207b(this,param_1);
  FUN_676ad741((void *)((int)this + 0x20),param_1 + 0x20);
  *(undefined ***)this = &PTR_FUN_676b9ad0;
  *(undefined2 *)((int)this + 4) = 0x4453;
  *(undefined4 *)((int)this + 0x1c) = *(undefined4 *)(param_1 + 0x1c);
  *(undefined1 *)((int)this + 0x28) = *(undefined1 *)(param_1 + 0x28);
  return (undefined4 *)this;
}



// Function: FUN_6768462d at 6768462d

undefined4 * __fastcall FUN_6768462d(int param_1)

{
  void *this;
  undefined4 *puVar1;
  
  this = operator_new(0x2c);
  if (this != (void *)0x0) {
    puVar1 = FUN_676845f4(this,param_1);
    return puVar1;
  }
  return (undefined4 *)0x0;
}



// Function: FUN_676846bf at 676846bf

undefined1 __thiscall
FUN_676846bf(void *this,void *param_1,uint *param_2,ushort param_3,uint param_4,undefined4 *param_5)

{
  void *this_00;
  undefined4 uVar1;
  DWORD DVar2;
  uint uVar3;
  undefined1 uVar4;
  int iVar5;
  undefined4 local_e0 [55];
  
  uVar1 = FUN_6768247d(this,param_1,param_2,param_3);
  if ((char)uVar1 == '\0') {
    return 0;
  }
  if (param_2 == (uint *)0x0) {
    FUN_6767ca9c(param_1,999,0x4000000);
    return 0;
  }
  if (param_3 < 0xb) {
LAB_67684726:
    iVar5 = 0x135;
LAB_67684730:
    FUN_6767ca9c(param_1,iVar5,0x1000000);
    return 1;
  }
  if ((char)param_2[1] != '\0') {
    iVar5 = 0x136;
    goto LAB_67684730;
  }
  if (*(char *)((int)this + 6) == '\0') {
    *(uint *)((int)this + 0x1c) = *param_2;
  }
  else if (*(uint *)((int)this + 0x1c) != *param_2) goto LAB_67684726;
  this_00 = (void *)((int)this + 0x20);
  DVar2 = FUN_676adaa8((int)this_00);
  if (DVar2 != 0) {
    FUN_676ada88((int)this_00);
  }
  if (param_3 - 0xb == 0) {
    return 1;
  }
  if (param_2 == (uint *)0xfffffff5) {
    return 1;
  }
  FUN_6767e702(local_e0);
  iVar5 = FUN_6767e81f(local_e0,(uint)*(ushort *)((int)param_2 + 5));
  if (iVar5 == 0) {
    uVar3 = FUN_6767ea8d(local_e0,(undefined4 *)((int)param_2 + 0xb),param_3 - 0xb,&param_5,&param_4
                         ,'\x01');
    if (uVar3 != 0) {
LAB_67684838:
      iVar5 = 0x138;
      goto LAB_67684842;
    }
    if ((param_4 != *param_2) ||
       (iVar5 = FUN_6767e980((int)local_e0), iVar5 != *(int *)((int)param_2 + 7))) {
      if (param_5 != (undefined4 *)0x0) {
        FUN_6767ebd6(param_5);
      }
      goto LAB_67684838;
    }
    if (param_5 == (undefined4 *)0x0) goto LAB_676847a6;
    FUN_676adbab(this_00,param_5);
    FUN_6767ebd6(param_5);
  }
  else {
    if (iVar5 != 0x3ea) {
LAB_676847a6:
      FUN_6767ca9c(param_1,999,0x4000000);
      uVar4 = 0;
      goto LAB_67684812;
    }
    *(undefined1 *)((int)this + 0x28) = 1;
    iVar5 = 0x137;
LAB_67684842:
    FUN_6767ca9c(param_1,iVar5,0x1000000);
  }
  uVar4 = 1;
LAB_67684812:
  FUN_6767e796(local_e0);
  return uVar4;
}



// Function: FUN_6768484c at 6768484c

uint __thiscall FUN_6768484c(void *this,void *param_1,int *param_2,ushort param_3)

{
  uint uVar1;
  int iVar2;
  
  uVar1 = FUN_676824d9(this,param_1,param_2,param_3);
  if ((char)uVar1 == '\0') {
LAB_67684883:
    return uVar1 & 0xffffff00;
  }
  if (param_2 == (int *)0x0) {
    uVar1 = FUN_6767ca9c(param_1,999,0x4000000);
    goto LAB_67684883;
  }
  if (param_3 == 4) {
    if (*(char *)((int)this + 6) == '\0') {
      iVar2 = *param_2;
      *(int *)((int)this + 0x1c) = iVar2;
      goto LAB_676848b3;
    }
    iVar2 = *(int *)((int)this + 0x1c);
    if (iVar2 == *param_2) goto LAB_676848b3;
  }
  iVar2 = FUN_6767ca9c(param_1,0x135,0x1000000);
LAB_676848b3:
  return CONCAT31((int3)((uint)iVar2 >> 8),1);
}



// Function: FUN_676848bc at 676848bc

undefined4 __thiscall
FUN_676848bc(void *this,void *param_1,DWORD *param_2,undefined4 param_3,ushort *param_4,int param_5)

{
  DWORD *_Dst;
  bool bVar1;
  undefined4 uVar2;
  DWORD DVar3;
  undefined3 extraout_var;
  ushort *puVar4;
  byte *pbVar5;
  ushort uVar6;
  void *this_00;
  DWORD **ppDVar7;
  int iVar8;
  void **ppvVar9;
  char cVar10;
  undefined4 local_e4 [55];
  void *local_8;
  
  _Dst = param_2;
  uVar2 = FUN_67682535(this,param_1,param_2,(ushort)param_3,param_4);
  if ((char)uVar2 == '\0') {
    return uVar2;
  }
  puVar4 = param_4;
  if ((*param_4 != 0) || (*(char *)((int)this + 0x28) != '\0')) goto LAB_67684a60;
  this_00 = (void *)((int)this + 0x20);
  *param_4 = 0;
  DVar3 = FUN_676adaa8((int)this_00);
  if (DVar3 == 0) {
    bVar1 = FUN_676ad7b0(this_00,*(LPCWSTR *)(param_5 + 0x170));
    if (CONCAT31(extraout_var,bVar1) == 0) goto LAB_6768493a;
    if (CONCAT31(extraout_var,bVar1) == 2) {
      iVar8 = 0x132;
    }
    else {
      iVar8 = 0x133;
    }
LAB_6768495a:
    puVar4 = (ushort *)FUN_6767ca9c(param_1,iVar8,0x1000000);
    goto LAB_67684a60;
  }
LAB_6768493a:
  puVar4 = (ushort *)FUN_676adaa8((int)this_00);
  if (puVar4 == (ushort *)0x0) goto LAB_67684a60;
  if ((ushort)param_3 < 0xb) {
    iVar8 = 0x135;
    goto LAB_6768495a;
  }
  _memset(_Dst,0,0xb);
  DVar3 = FUN_676adaa8((int)this_00);
  *_Dst = DVar3;
  *(undefined1 *)(_Dst + 1) = 0;
  *(undefined2 *)((int)_Dst + 5) = 8;
  FUN_6767e702(local_e4);
  param_2 = (DWORD *)0x0;
  local_8 = (void *)0x0;
  FUN_6767e81f(local_e4,8);
  FUN_6767e856(local_e4,6);
  ppvVar9 = &local_8;
  cVar10 = '\x01';
  ppDVar7 = &param_2;
  DVar3 = FUN_676adaa8((int)this_00);
  pbVar5 = (byte *)FUN_676adba7((int)this_00);
  iVar8 = FUN_6767e984(local_e4,pbVar5,DVar3,ppDVar7,ppvVar9,cVar10);
  if (iVar8 == 0) {
    uVar6 = (short)local_8 + 0xb;
    if ((ushort)param_3 < uVar6) {
      FUN_6767ebd6(param_2);
      iVar8 = 0x135;
      goto LAB_67684a17;
    }
    uVar2 = FUN_6767e980((int)local_e4);
    *(undefined4 *)((int)_Dst + 7) = uVar2;
    FUN_676b06d0((undefined4 *)((int)_Dst + 0xb),param_2,(uint)local_8);
    FUN_6767ebd6(param_2);
    *param_4 = uVar6;
  }
  else {
    FUN_6767ebd6(param_2);
    iVar8 = 0x138;
LAB_67684a17:
    FUN_6767ca9c(param_1,iVar8,0x1000000);
  }
  puVar4 = (ushort *)FUN_6767e796(local_e4);
LAB_67684a60:
  return CONCAT31((int3)((uint)puVar4 >> 8),1);
}



// Function: FUN_67684a69 at 67684a69

undefined4 __thiscall
FUN_67684a69(void *this,void *param_1,DWORD *param_2,ushort param_3,ushort *param_4,int param_5)

{
  bool bVar1;
  DWORD DVar2;
  undefined3 extraout_var;
  void *this_00;
  int iVar3;
  
  DVar2 = FUN_676825a0(this,param_1,param_2,param_3,param_4);
  if ((char)DVar2 == '\0') {
    return DVar2;
  }
  if ((*param_4 != 0) || (*(char *)((int)this + 0x28) != '\0')) goto LAB_67684b1d;
  this_00 = (void *)((int)this + 0x20);
  *param_4 = 0;
  DVar2 = FUN_676adaa8((int)this_00);
  if (DVar2 == 0) {
    bVar1 = FUN_676ad7b0(this_00,*(LPCWSTR *)(param_5 + 0x170));
    if (CONCAT31(extraout_var,bVar1) == 0) goto LAB_67684ada;
    if (CONCAT31(extraout_var,bVar1) == 2) {
      iVar3 = 0x132;
    }
    else {
      iVar3 = 0x133;
    }
  }
  else {
LAB_67684ada:
    DVar2 = FUN_676adaa8((int)this_00);
    if (DVar2 == 0) goto LAB_67684b1d;
    if (3 < param_3) {
      _memset(param_2,0,4);
      DVar2 = FUN_676adaa8((int)this_00);
      *param_2 = DVar2;
      *param_4 = 4;
      goto LAB_67684b1d;
    }
    iVar3 = 0x135;
  }
  DVar2 = FUN_6767ca9c(param_1,iVar3,0x1000000);
LAB_67684b1d:
  return CONCAT31((int3)(DVar2 >> 8),1);
}



// Function: FUN_67684b33 at 67684b33

undefined4 * __fastcall FUN_67684b33(undefined4 *param_1)

{
  FUN_67681ff7(param_1);
  *param_1 = &PTR_FUN_676b9af8;
  *(undefined2 *)(param_1 + 1) = 0x554e;
  return param_1;
}



// Function: FUN_67684b4b at 67684b4b

undefined4 * __thiscall FUN_67684b4b(void *this,byte param_1)

{
  FUN_67684b67((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_67684b67 at 67684b67

void __fastcall FUN_67684b67(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b9af8;
  FUN_67682054(param_1);
  return;
}



// Function: FUN_67684b72 at 67684b72

undefined4 * __thiscall FUN_67684b72(void *this,int param_1)

{
  FUN_6768207b(this,param_1);
  *(undefined ***)this = &PTR_FUN_676b9af8;
  *(undefined2 *)((int)this + 4) = 0x554e;
  return (undefined4 *)this;
}



// Function: FUN_67684b90 at 67684b90

undefined4 * __fastcall FUN_67684b90(int param_1)

{
  void *this;
  undefined4 *puVar1;
  
  this = operator_new(0x1c);
  if (this != (void *)0x0) {
    puVar1 = FUN_67684b72(this,param_1);
    return puVar1;
  }
  return (undefined4 *)0x0;
}



// Function: FUN_67684bad at 67684bad

undefined4 __thiscall FUN_67684bad(void *this,void *param_1,undefined4 *param_2,ushort param_3)

{
  undefined4 uVar1;
  int iVar2;
  undefined1 uVar3;
  undefined **local_10;
  undefined4 *local_c;
  undefined1 local_8;
  
  uVar1 = FUN_6768247d(this,param_1,param_2,param_3);
  if ((char)uVar1 == '\0') {
    return uVar1;
  }
  if ((param_3 < 6) || ((uint)param_3 != (uint)*(ushort *)(param_2 + 1) * 2 + 6)) {
    iVar2 = FUN_6767ca9c(param_1,0x139,0x1000000);
    return CONCAT31((int3)((uint)iVar2 >> 8),1);
  }
  uVar3 = 0;
  local_c = (undefined4 *)0x0;
  local_8 = 0;
  local_10 = &PTR_FUN_676b9b1c;
  FUN_676850f1((int)&local_10);
  local_c = (undefined4 *)0x0;
  local_8 = 1;
  if (*(ushort *)(param_2 + 1) != 0) {
    FUN_67685091(&local_10,*(ushort *)(param_2 + 1) + 1);
    if (local_c == (undefined4 *)0x0) {
      FUN_6767ca9c(param_1,0x1ff,0x4000000);
      goto LAB_67684c7b;
    }
    _memset(local_c,0,(uint)*(ushort *)(param_2 + 1) * 2 + 2);
    FUN_676b06d0(local_c,(undefined4 *)((int)param_2 + 6),(uint)*(ushort *)(param_2 + 1) << 1);
  }
  uVar3 = 1;
LAB_67684c7b:
  local_10 = &PTR_FUN_676b9b1c;
  uVar1 = FUN_676850f1((int)&local_10);
  return CONCAT31((int3)((uint)uVar1 >> 8),uVar3);
}



// Function: FUN_67684c8f at 67684c8f

undefined4 __thiscall
FUN_67684c8f(void *this,void *param_1,undefined4 *param_2,ushort param_3,void *param_4)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  int iVar3;
  undefined1 uVar4;
  undefined **local_1c;
  undefined4 *local_18;
  undefined1 local_14;
  undefined **local_10;
  LPCWSTR local_c;
  undefined1 local_8;
  
  uVar2 = FUN_676824d9(this,param_1,param_2,param_3);
  if ((char)uVar2 == '\0') {
    return uVar2;
  }
  if ((param_3 < 8) ||
     ((uint)param_3 !=
      ((uint)*(ushort *)((int)param_2 + 6) + (uint)*(ushort *)(param_2 + 1)) * 2 + 8)) {
    iVar3 = FUN_6767ca9c(param_1,0x139,0x1000000);
    return CONCAT31((int3)((uint)iVar3 >> 8),1);
  }
  uVar4 = 0;
  local_18 = (undefined4 *)0x0;
  local_14 = 0;
  local_1c = &PTR_FUN_676b9b1c;
  FUN_676850f1((int)&local_1c);
  local_18 = (undefined4 *)0x0;
  local_14 = 1;
  if (*(ushort *)(param_2 + 1) != 0) {
    FUN_67685091(&local_1c,*(ushort *)(param_2 + 1) + 1);
    if (local_18 == (undefined4 *)0x0) {
      FUN_6767ca9c(param_1,0x1ff,0x4000000);
      goto LAB_67684e11;
    }
    _memset(local_18,0,(uint)*(ushort *)(param_2 + 1) * 2 + 2);
    FUN_676b06d0(local_18,param_2 + 2,(uint)*(ushort *)(param_2 + 1) << 1);
  }
  local_c = (LPCWSTR)0x0;
  local_8 = 0;
  local_10 = &PTR_FUN_676b9b1c;
  FUN_676850f1((int)&local_10);
  local_c = (LPCWSTR)0x0;
  local_8 = 1;
  if (*(ushort *)((int)param_2 + 6) == 0) {
LAB_67684dd8:
    puVar1 = local_18;
    Ordinal_6(*(undefined4 *)((int)param_4 + 0x16c));
    uVar2 = Ordinal_2(puVar1);
    *(undefined4 *)((int)param_4 + 0x16c) = uVar2;
    FUN_67684e25(param_4,local_c);
    uVar4 = 1;
  }
  else {
    FUN_67685091(&local_10,*(ushort *)((int)param_2 + 6) + 1);
    if (local_c != (LPCWSTR)0x0) {
      _memset(local_c,0,(uint)*(ushort *)((int)param_2 + 6) * 2 + 2);
      FUN_676b06d0((undefined4 *)local_c,
                   (undefined4 *)((int)param_2 + (uint)*(ushort *)(param_2 + 1) * 2 + 8),
                   (uint)*(ushort *)((int)param_2 + 6) << 1);
      goto LAB_67684dd8;
    }
    FUN_6767ca9c(param_1,0x1ff,0x4000000);
    uVar4 = 0;
  }
  local_10 = &PTR_FUN_676b9b1c;
  FUN_676850f1((int)&local_10);
LAB_67684e11:
  local_1c = &PTR_FUN_676b9b1c;
  uVar2 = FUN_676850f1((int)&local_1c);
  return CONCAT31((int3)((uint)uVar2 >> 8),uVar4);
}



// Function: FUN_67684e25 at 67684e25

void __thiscall FUN_67684e25(void *this,LPCWSTR param_1)

{
  int iVar1;
  LPSTR lpString1;
  LPWSTR pWVar2;
  
  if (*(undefined **)((int)this + 0x174) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)((int)this + 0x174));
    *(undefined4 *)((int)this + 0x174) = 0;
  }
  Ordinal_6();
  *(undefined4 *)((int)this + 0x178) = 0;
  if (param_1 != (LPCWSTR)0x0) {
    iVar1 = lstrlenW(param_1);
    FUN_676b06a0();
    WideCharToMultiByte(0,0,param_1,-1,&stack0xffffffe8,iVar1 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    iVar1 = lstrlenA(&stack0xffffffe8);
    lpString1 = (LPSTR)operator_new(iVar1 + 1);
    *(LPSTR *)((int)this + 0x174) = lpString1;
    if (lpString1 != (LPSTR)0x0) {
      lstrcpyA(lpString1,&stack0xffffffe8);
      Ordinal_6(*(undefined4 *)((int)this + 0x178));
      pWVar2 = FUN_67684ed6(&stack0xffffffe8,-1);
      *(LPWSTR *)((int)this + 0x178) = pWVar2;
    }
  }
  return;
}



// Function: FUN_67684ed6 at 67684ed6

LPWSTR __cdecl FUN_67684ed6(LPCSTR param_1,int param_2)

{
  int iVar1;
  LPWSTR lpWideCharStr;
  
  iVar1 = MultiByteToWideChar(0,0,param_1,param_2,(LPWSTR)0x0,0);
  lpWideCharStr = (LPWSTR)Ordinal_4(0,iVar1 + -1);
  if (lpWideCharStr != (LPWSTR)0x0) {
    MultiByteToWideChar(0,0,param_1,-1,lpWideCharStr,iVar1 + -1);
  }
  return lpWideCharStr;
}



// Function: FUN_67684f15 at 67684f15

uint FUN_67684f15(void *param_1,undefined4 *param_2,ushort param_3,ushort *param_4,int param_5)

{
  uint uVar1;
  int iVar2;
  ushort uVar3;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = FUN_6767ca9c(param_1,999,0x4000000);
    uVar1 = uVar1 & 0xffffff00;
  }
  else {
    iVar2 = FUN_676ae2a4(*(short **)(param_5 + 0x16c));
    uVar1 = iVar2 * 2 + 6;
    uVar3 = (ushort)uVar1;
    if (param_3 < uVar3) {
      param_4 = (ushort *)FUN_6767ca9c(param_1,0x139,0x1000000);
    }
    else {
      _memset(param_2,0,uVar1 & 0xffff);
      *param_2 = 0x5843554e;
      *(short *)(param_2 + 1) = (short)iVar2;
      FUN_676b06d0((undefined4 *)((int)param_2 + 6),*(undefined4 **)(param_5 + 0x16c),iVar2 * 2);
      *param_4 = uVar3;
    }
    uVar1 = CONCAT31((int3)((uint)param_4 >> 8),1);
  }
  return uVar1;
}



// Function: FUN_67684fa9 at 67684fa9

uint FUN_67684fa9(void *param_1,undefined4 *param_2,ushort param_3,ushort *param_4,int param_5)

{
  uint uVar1;
  undefined4 *_Dst;
  int iVar2;
  ushort uVar3;
  uint uVar4;
  int iVar5;
  
  iVar2 = param_5;
  _Dst = param_2;
  if (param_2 == (undefined4 *)0x0) {
    uVar4 = FUN_6767ca9c(param_1,999,0x4000000);
    uVar4 = uVar4 & 0xffffff00;
  }
  else {
    iVar5 = FUN_676ae2a4(*(short **)(param_5 + 0x16c));
    uVar4 = iVar5 * 2;
    if (*(short **)(param_5 + 0x178) == (short *)0x0) {
      param_2 = (undefined4 *)0x0;
    }
    else {
      param_2 = (undefined4 *)FUN_676ae2a4(*(short **)(param_5 + 0x178));
    }
    uVar1 = (int)param_2 * 2 + 8U + uVar4;
    uVar3 = (ushort)uVar1;
    if (param_3 < uVar3) {
      param_4 = (ushort *)FUN_6767ca9c(param_1,0x139,0x1000000);
    }
    else {
      _memset(_Dst,0,uVar1 & 0xffff);
      param_5._0_2_ = (undefined2)iVar5;
      *(undefined2 *)(_Dst + 1) = (undefined2)param_5;
      *_Dst = 0x5843554e;
      *(undefined2 *)((int)_Dst + 6) = param_2._0_2_;
      FUN_676b06d0(_Dst + 2,*(undefined4 **)(iVar2 + 0x16c),uVar4);
      FUN_676b06d0((undefined4 *)(uVar4 + 8 + (int)_Dst),*(undefined4 **)(iVar2 + 0x178),
                   (int)param_2 * 2);
      *param_4 = uVar3;
    }
    uVar4 = CONCAT31((int3)((uint)param_4 >> 8),1);
  }
  return uVar4;
}



// Function: FUN_67685091 at 67685091

void __thiscall FUN_67685091(void *this,int param_1)

{
  void *pvVar1;
  
  FUN_676850f1((int)this);
  if (param_1 == 1) {
    pvVar1 = operator_new(2);
    *(void **)((int)this + 4) = pvVar1;
  }
  else {
    if (1 < param_1) {
      pvVar1 = operator_new(param_1 * 2);
      *(void **)((int)this + 4) = pvVar1;
      *(undefined1 *)((int)this + 8) = 1;
      return;
    }
    *(undefined4 *)((int)this + 4) = 0;
  }
  *(undefined1 *)((int)this + 8) = 0;
  return;
}



// Function: FUN_676850cf at 676850cf

undefined4 * __thiscall FUN_676850cf(void *this,byte param_1)

{
  *(undefined ***)this = &PTR_FUN_676b9b1c;
  FUN_676850f1((int)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_676850f1 at 676850f1

void __fastcall FUN_676850f1(int param_1)

{
  if (*(undefined **)(param_1 + 4) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)(param_1 + 4));
  }
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined1 *)(param_1 + 8) = 0;
  return;
}



// Function: FUN_67685110 at 67685110

undefined4 * __fastcall FUN_67685110(undefined4 *param_1)

{
  FUN_67681ff7(param_1);
  *param_1 = &PTR_FUN_676b9b20;
  *(undefined2 *)(param_1 + 1) = 1;
  return param_1;
}



// Function: FUN_67685128 at 67685128

undefined4 * __thiscall FUN_67685128(void *this,byte param_1)

{
  FUN_67685144((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_67685144 at 67685144

void __fastcall FUN_67685144(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b9b20;
  FUN_67682054(param_1);
  return;
}



// Function: FUN_6768514f at 6768514f

undefined4 * __thiscall FUN_6768514f(void *this,int param_1)

{
  FUN_6768207b(this,param_1);
  *(undefined ***)this = &PTR_FUN_676b9b20;
  *(undefined2 *)((int)this + 4) = 1;
  return (undefined4 *)this;
}



// Function: FUN_6768516d at 6768516d

undefined4 * __fastcall FUN_6768516d(int param_1)

{
  void *this;
  undefined4 *puVar1;
  
  this = operator_new(0x1c);
  if (this != (void *)0x0) {
    puVar1 = FUN_6768514f(this,param_1);
    return puVar1;
  }
  return (undefined4 *)0x0;
}



// Function: FUN_6768518a at 6768518a

undefined4 __thiscall
FUN_6768518a(void *this,void *param_1,undefined4 *param_2,ushort param_3,int param_4,int param_5)

{
  byte bVar1;
  undefined4 uVar2;
  uint3 uVar4;
  int iVar3;
  bool bVar5;
  bool bVar6;
  bool bVar7;
  
  uVar2 = FUN_6768247d(this,param_1,param_2,param_3);
  if ((char)uVar2 == '\0') {
    return uVar2;
  }
  bVar5 = *(int *)(param_5 + 0x12) == -1;
  bVar6 = *(int *)(param_5 + 0x16) == -1;
  uVar4 = (uint3)((uint)uVar2 >> 8);
  bVar7 = bVar5 == bVar6;
  iVar3 = (uint)uVar4 << 8;
  if (bVar7 && !bVar6) {
LAB_676851ec:
    if (!bVar7 || bVar5) {
      if (param_3 < 8) goto LAB_67685216;
      bVar1 = *(byte *)(param_4 + 0x14) >> 3;
      iVar3 = CONCAT31((int3)((uint)iVar3 >> 8),bVar1);
      if ((bVar1 & 1) == 0) {
        *(undefined4 *)(param_4 + 0x20) = *param_2;
        iVar3 = param_2[1];
        *(int *)(param_4 + 0x24) = iVar3;
      }
      param_3 = param_3 - 8;
    }
    if (param_3 == 0) goto LAB_67685228;
  }
  else if (7 < param_3) {
    bVar1 = *(byte *)(param_4 + 0x14) >> 3;
    iVar3 = CONCAT31(uVar4,bVar1);
    if ((bVar1 & 1) == 0) {
      *(undefined4 *)(param_4 + 0x28) = *param_2;
      iVar3 = param_2[1];
      *(int *)(param_4 + 0x2c) = iVar3;
    }
    param_3 = param_3 - 8;
    param_2 = param_2 + 2;
    goto LAB_676851ec;
  }
LAB_67685216:
  iVar3 = FUN_6767ca9c(param_1,0x145,0x1000000);
LAB_67685228:
  return CONCAT31((int3)((uint)iVar3 >> 8),1);
}



// Function: FUN_67685231 at 67685231

undefined4 __thiscall
FUN_67685231(void *this,void *param_1,undefined4 *param_2,ushort param_3,int param_4,int param_5)

{
  int iVar1;
  undefined4 uVar2;
  
  uVar2 = FUN_676824d9(this,param_1,param_2,param_3);
  if ((char)uVar2 == '\0') {
    return uVar2;
  }
  iVar1 = *(int *)(param_5 + 0x14);
  if (*(int *)(param_5 + 0x18) == -1) {
    if (7 < param_3) {
      param_3 = param_3 - 8;
      *(undefined4 *)(param_4 + 0x28) = *param_2;
      *(undefined4 *)(param_4 + 0x2c) = param_2[1];
      param_2 = param_2 + 2;
      goto LAB_67685283;
    }
  }
  else {
LAB_67685283:
    if (iVar1 == -1) {
      if (param_3 < 8) goto LAB_676852db;
      param_3 = param_3 - 8;
      *(undefined4 *)(param_4 + 0x20) = *param_2;
      *(undefined4 *)(param_4 + 0x24) = param_2[1];
      param_2 = param_2 + 2;
    }
    if (*(int *)(param_5 + 0x2a) == -1) {
      if (param_3 < 8) goto LAB_676852db;
      param_3 = param_3 - 8;
      *(undefined4 *)(param_4 + 0x40) = *param_2;
      *(undefined4 *)(param_4 + 0x44) = param_2[1];
      param_2 = param_2 + 2;
    }
    if (*(short *)(param_5 + 0x22) == -1) {
      if (param_3 < 4) goto LAB_676852db;
      param_5 = *param_2;
      param_3 = param_3 - 4;
      *(int *)(param_4 + 0x38) = param_5;
    }
    if (param_3 == 0) goto LAB_676852ed;
  }
LAB_676852db:
  param_5 = FUN_6767ca9c(param_1,0x145,0x1000000);
LAB_676852ed:
  return CONCAT31((int3)((uint)param_5 >> 8),1);
}



// Function: FUN_676852f6 at 676852f6

void FUN_676852f6(void *param_1,uint *param_2,ushort param_3,short *param_4,int param_5)

{
  FUN_67685330(param_1,param_2,param_3,param_4,param_5,'\x01');
  return;
}



// Function: FUN_67685313 at 67685313

void FUN_67685313(void *param_1,uint *param_2,ushort param_3,short *param_4,int param_5)

{
  FUN_67685330(param_1,param_2,param_3,param_4,param_5,'\0');
  return;
}



// Function: FUN_67685330 at 67685330

undefined4
FUN_67685330(void *param_1,uint *param_2,ushort param_3,short *param_4,int param_5,char param_6)

{
  uint uVar1;
  
  uVar1 = *(uint *)(param_5 + 0x2c);
  if (((uVar1 == 0) && (*(uint *)(param_5 + 0x28) != 0xffffffff)) &&
     ((param_6 == '\0' || ((*(int *)(param_5 + 0x24) == 0 && (*(int *)(param_5 + 0x20) != -1)))))) {
LAB_67685386:
    uVar1 = *(uint *)(param_5 + 0x24);
    if (((uVar1 != 0) || (*(uint *)(param_5 + 0x20) == 0xffffffff)) ||
       ((param_6 != '\0' && ((*(int *)(param_5 + 0x2c) != 0 || (*(int *)(param_5 + 0x28) == -1))))))
    {
      if (param_3 < 8) goto LAB_676853f6;
      *param_2 = *(uint *)(param_5 + 0x20);
      param_2[1] = uVar1;
      *param_4 = *param_4 + 8;
      param_2 = param_2 + 2;
      param_3 = param_3 - 8;
    }
    uVar1 = *(uint *)(param_5 + 0x44);
    if ((uVar1 != 0) || (*(uint *)(param_5 + 0x40) == 0xffffffff)) {
      if (param_3 < 8) goto LAB_676853f6;
      *param_2 = *(uint *)(param_5 + 0x40);
      param_2[1] = uVar1;
      *param_4 = *param_4 + 8;
      param_2 = param_2 + 2;
      param_3 = param_3 - 8;
    }
    if (*(uint *)(param_5 + 0x38) < 0xffff) goto LAB_67685410;
    if (3 < param_3) {
      *param_2 = *(uint *)(param_5 + 0x38);
      *param_4 = *param_4 + 4;
      goto LAB_67685410;
    }
  }
  else if (7 < param_3) {
    *param_2 = *(uint *)(param_5 + 0x28);
    param_2[1] = uVar1;
    *param_4 = *param_4 + 8;
    param_2 = param_2 + 2;
    param_3 = param_3 - 8;
    goto LAB_67685386;
  }
LAB_676853f6:
  param_2 = (uint *)FUN_6767ca9c(param_1,0x145,0x1000000);
LAB_67685410:
  return CONCAT31((int3)((uint)param_2 >> 8),1);
}



// Function: FUN_67685419 at 67685419

undefined4 * __thiscall FUN_67685419(void *this,undefined4 param_1)

{
  undefined4 *puVar1;
  void *pvVar2;
  
  FUN_67689c9b((undefined4 *)this);
  FUN_6768c9f0((undefined4 *)((int)this + 0x30));
  *(undefined ***)this = &PTR_FUN_676b9b60;
  *(undefined4 *)((int)this + 0x30) = &PTR_LAB_676b9b44;
  puVar1 = (undefined4 *)operator_new(0x68);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    puVar1 = FUN_67681abb(puVar1);
  }
  *(undefined4 **)((int)this + 0x700) = puVar1;
  puVar1 = (undefined4 *)operator_new(0x28);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    puVar1 = FUN_67689ff0(puVar1);
  }
  *(undefined4 **)((int)this + 0x6f8) = puVar1;
  puVar1 = (undefined4 *)operator_new(0x3c);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    puVar1 = FUN_6767c803(puVar1);
  }
  *(undefined4 **)((int)this + 0x6fc) = puVar1;
  *(undefined1 *)((int)this + 0x718) = 0;
  *(undefined4 *)((int)this + 0x704) = param_1;
  pvVar2 = operator_new(0x8000);
  *(void **)((int)this + 0x728) = pvVar2;
  *(undefined4 *)((int)this + 0x720) = 0;
  *(undefined4 *)((int)this + 0x710) = 0;
  *(undefined4 *)((int)this + 0x72c) = 6;
  *(undefined4 *)((int)this + 0x730) = 8;
  *(undefined4 *)((int)this + 0x724) = 0;
  *(undefined4 *)((int)this + 0x714) = 0;
  return (undefined4 *)this;
}



// Function: FUN_676854e7 at 676854e7

int * __thiscall FUN_676854e7(void *this,byte param_1)

{
  FUN_67685503((int *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (int *)this;
}



// Function: FUN_67685503 at 67685503

void __fastcall FUN_67685503(int *param_1)

{
  *param_1 = (int)&PTR_FUN_676b9b60;
  param_1[0xc] = (int)&PTR_LAB_676b9b44;
  if ((int *)param_1[0x1c0] != (int *)0x0) {
    (**(code **)(*(int *)param_1[0x1c0] + 4))(1);
  }
  if ((undefined4 *)param_1[0x1bf] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[0x1bf])(1);
  }
  if ((undefined4 *)param_1[0x1be] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[0x1be])(1);
  }
  if ((undefined *)param_1[0x1ca] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[0x1ca]);
  }
  FUN_6768cad6((undefined4 *)(-(uint)(param_1 != (int *)0x0) & (uint)(param_1 + 0xc)));
  FUN_67689cc9(param_1);
  return;
}



// Function: FUN_6768556f at 6768556f

bool __thiscall
FUN_6768556f(void *this,void *param_1,void *param_2,void *param_3,char param_4,undefined1 *param_5,
            char param_6,char param_7)

{
  undefined1 uVar1;
  int iVar2;
  undefined4 uVar3;
  
                    /* WARNING: Load size is inaccurate */
  iVar2 = (**(code **)(*this + 0x3c))();
  if (iVar2 == 0) {
    *(undefined4 *)((int)this + 0x710) = 0;
    *(undefined1 *)((int)this + 0x708) = 0;
    *(undefined4 *)((int)this + 0x714) = 0;
    uVar3 = FUN_676865f5(this,param_1);
    if ((char)uVar3 == '\0') {
      return false;
    }
    if ((*(int *)((int)this + 0x454) == -1) || (*(int *)((int)this + 0x454) == 0)) {
      uVar1 = 0;
    }
    else {
      uVar1 = 1;
    }
    *(undefined1 *)((int)this + 0x708) = uVar1;
    if (param_5 != (undefined1 *)0x0) {
      *param_5 = uVar1;
    }
    if ((*(char *)((int)this + 0x45d) == '\0') || (*(char *)((int)this + 0x708) == '\0')) {
      uVar3 = FUN_67686979(this,param_1,param_2,param_3,param_4,param_6,param_7);
      return (char)uVar3 != '\0';
    }
    iVar2 = 0x203;
  }
  else {
    iVar2 = 999;
  }
  FUN_6767ca9c(param_1,iVar2,0x4000000);
  return false;
}



// Function: FUN_6768561f at 6768561f

uint __thiscall FUN_6768561f(void *this,void *param_1)

{
  undefined4 in_EAX;
  uint uVar1;
  undefined4 uVar2;
  int iVar3;
  undefined **local_18;
  undefined4 *local_14;
  undefined1 local_10;
  void *local_c;
  uint local_8;
  
  if (*(char *)((int)this + 0x45c) == '\0') {
    uVar1 = FUN_6767ca9c(param_1,999,0x4000000);
LAB_67685706:
    uVar1 = uVar1 & 0xffffff00;
  }
  else {
    if ((*(int *)((int)this + 0x668) != -1) &&
       ((*(int *)((int)this + 0x714) != 0 || (*(int *)((int)this + 0x710) != 0)))) {
      local_c = (void *)((int)this + 0x30);
      uVar1 = FUN_6768d185(local_c,param_1,0,0,(void *)0x0,0);
      if ((char)uVar1 == '\0') goto LAB_67685706;
      local_14 = (undefined4 *)0x0;
      local_10 = 0;
      local_18 = &PTR_FUN_676b99c4;
      FUN_6767e657(&local_18,0x8000);
      local_8 = 0x8000;
      iVar3 = *(int *)((int)this + 0x714);
      for (uVar1 = *(uint *)((int)this + 0x710); uVar1 != 0 || iVar3 != 0; uVar1 = uVar1 - local_8)
      {
        if ((iVar3 == 0) && (uVar1 < local_8)) {
          local_8 = uVar1;
        }
        uVar2 = FUN_6768d2cc(local_c,param_1,local_14,local_8);
        if (((char)uVar2 == '\0') ||
           (uVar2 = FUN_6768d357(local_c,param_1,local_14,local_8,1), (char)uVar2 == '\0')) {
          local_18 = &PTR_FUN_676b99c4;
          uVar1 = FUN_6767e692((int)&local_18);
          goto LAB_67685706;
        }
        iVar3 = iVar3 - (uint)(uVar1 < local_8);
      }
      local_18 = &PTR_FUN_676b99c4;
      in_EAX = FUN_6767e692((int)&local_18);
    }
    uVar1 = CONCAT31((int3)((uint)in_EAX >> 8),1);
  }
  return uVar1;
}



// Function: FUN_67685722 at 67685722

undefined1 __thiscall FUN_67685722(void *this,void *param_1,void *param_2)

{
  bool bVar1;
  char cVar2;
  HANDLE hFile;
  uint uVar3;
  BOOL BVar4;
  int iVar5;
  undefined4 uVar6;
  undefined1 uVar7;
  undefined **local_38;
  uint *local_34;
  undefined1 local_30;
  undefined **local_2c;
  undefined4 *local_28;
  undefined1 local_24;
  uint local_20;
  DWORD local_1c;
  void *local_18;
  HANDLE local_14;
  DWORD local_10;
  uint local_c;
  char local_5;
  
  uVar7 = 0;
  hFile = FUN_676aeee9(*(LPCWSTR *)((int)param_2 + 0x138),0x80000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,
                       0x8000000,(HANDLE)0x0);
  local_14 = hFile;
  if (hFile == (HANDLE)0xffffffff) {
    FUN_6767ca9c(param_1,0x201,0x4000000);
  }
  else {
    local_18 = (void *)((int)this + 0x30);
    bVar1 = FUN_6768e612(local_18,param_1,'\x01');
    if (bVar1) {
      uVar3 = FUN_6768ba94(param_2,hFile);
      *(char *)((int)this + 0x718) = (char)uVar3;
      SetFilePointer(hFile,0,(PLONG)0x0,0);
      local_28 = (undefined4 *)0x0;
      local_24 = 0;
      local_2c = &PTR_FUN_676b99c4;
      FUN_6767e657(&local_2c,0x8000);
      local_20 = GetFileSize(hFile,&local_1c);
      uVar3 = 0;
      local_c = 0x8000;
      local_10 = 0;
      if (((*(char *)((int)this + 0x718) == '\0') ||
          ((short *)((int)param_2 + 0x13c) == (short *)0x0)) ||
         (local_5 = '\x01', *(short *)((int)param_2 + 0x13c) == 0)) {
        local_5 = '\0';
      }
      while (local_20 != 0 || local_1c != 0) {
        if ((local_1c == 0) && (local_20 < local_c)) {
          local_c = local_20;
        }
        BVar4 = ReadFile(local_14,(LPVOID)((int)local_28 + uVar3),local_c,&local_10,
                         (LPOVERLAPPED)0x0);
        if ((BVar4 == 0) || (local_10 != local_c)) {
          FUN_6767ca9c(param_1,0x202,0x4000000);
LAB_676858ea:
          CloseHandle(local_14);
          goto LAB_6768599a;
        }
        local_10 = uVar3 + local_c;
        if ((local_5 != '\0') && (iVar5 = FUN_6768bb3c(param_1,(int)local_28,local_10), iVar5 != -1)
           ) {
          FUN_6768bbbd(param_2,param_1,(int)local_28 + iVar5);
        }
        bVar1 = local_20 < local_c;
        local_20 = local_20 - local_c;
        local_1c = local_1c - bVar1;
        if (((local_1c == 0) && (local_20 == 0)) || (local_5 == '\0')) {
          uVar3 = 0;
          local_c = 0x8000;
        }
        else {
          uVar3 = 0x1000;
          local_c = 0x7000;
          local_10 = local_10 - 0x1000;
        }
        uVar6 = FUN_6768d357(local_18,param_1,local_28,local_10,0);
        if ((char)uVar6 == '\0') goto LAB_676858ea;
        if (uVar3 != 0) {
          FUN_676b06d0(local_28,(undefined4 *)(local_10 + (int)local_28),uVar3);
        }
      }
      CloseHandle(local_14);
      if (*(char *)((int)this + 0x718) == '\0') {
LAB_67685988:
        bVar1 = FUN_6768e612(local_18,param_1,'\0');
        if (bVar1) {
          uVar7 = 1;
        }
LAB_6768599a:
        local_2c = &PTR_FUN_676b99c4;
        FUN_6767e692((int)&local_2c);
        return uVar7;
      }
      local_34 = (uint *)0x0;
      local_30 = 0;
      local_38 = &PTR_FUN_676b99c4;
      FUN_6767e657(&local_38,0xffff);
      local_14 = (HANDLE)0x0;
      cVar2 = FUN_6768a393(param_2,param_1,local_34,(ushort *)&local_14);
      if (cVar2 != '\0') {
        uVar6 = FUN_6768d357(local_18,param_1,local_34,(uint)local_14 & 0xffff,0);
        local_38 = &PTR_FUN_676b99c4;
        if ((char)uVar6 != '\0') {
          FUN_6767e692((int)&local_38);
          goto LAB_67685988;
        }
      }
      local_38 = &PTR_FUN_676b99c4;
      FUN_6767e692((int)&local_38);
      local_2c = &PTR_FUN_676b99c4;
      FUN_6767e692((int)&local_2c);
    }
    else {
      CloseHandle(hFile);
    }
  }
  return 0;
}



// Function: FUN_676859ae at 676859ae

char __thiscall FUN_676859ae(void *this,void *param_1,char param_2,int param_3)

{
  bool bVar1;
  char cVar2;
  undefined4 *this_00;
  undefined4 uVar3;
  uint uVar4;
  BOOL BVar5;
  int iVar6;
  undefined4 *puVar7;
  undefined4 auStack_8e8 [2];
  undefined4 uStack_8e0;
  _WIN32_FIND_DATAW local_8bc;
  WCHAR local_66c;
  undefined4 local_66a [130];
  WCHAR local_460;
  undefined4 local_45e [130];
  undefined4 local_254 [10];
  DWORD local_22c;
  DWORD local_228;
  DWORD local_220;
  undefined4 local_e4;
  undefined **local_44 [2];
  undefined4 local_3c [6];
  ushort local_22;
  ushort local_20;
  ushort local_1e;
  ushort local_1c;
  ushort local_1a;
  WCHAR *local_18;
  ushort local_12;
  ushort local_10;
  ushort local_e;
  int *local_c;
  char local_6;
  char local_5;
  
                    /* WARNING: Load size is inaccurate */
  local_5 = '\0';
  local_c = (int *)this;
  this_00 = (undefined4 *)(**(code **)(*this + 0x2c))();
  do {
    if (this_00 == (undefined4 *)0x0) {
      *(undefined4 *)((int)param_1 + 0x14) = 0;
      *(undefined4 *)((int)param_1 + 4) = 0;
      *(undefined4 *)((int)param_1 + 8) = 0;
      if (local_5 == '\0') {
        FUN_6767ca9c(param_1,0x1fd,0x4000000);
      }
      return local_5;
    }
    if (this_00 == (undefined4 *)0x0) {
      FUN_6767ca9c(param_1,999,0x4000000);
      return '\0';
    }
    *(undefined4 **)((int)param_1 + 0x14) = this_00;
    *(undefined4 *)((int)param_1 + 4) = 0;
    *(undefined4 *)((int)param_1 + 8) = 0;
    iVar6 = this_00[0x13];
    if ((((iVar6 < 1) || (0xf < iVar6)) && ((iVar6 < 100 || (0x7a < iVar6)))) &&
       ((((param_3 == 0 && (local_c[0x1c1] != 0)) && (bVar1 = FUN_6767d0e4((int)this_00), bVar1)) &&
        (local_18 = (WCHAR *)FUN_676aee00((LPCWSTR)this_00[0x5c],&local_8bc),
        local_18 != (WCHAR *)0xffffffff)))) {
      FUN_67688abc(local_254);
      Ordinal_6();
      local_e4 = Ordinal_2();
      local_220 = local_8bc.dwFileAttributes;
      local_228 = local_8bc.nFileSizeHigh;
      local_22c = local_8bc.nFileSizeLow;
      FUN_676814cd(local_44,local_8bc.ftLastWriteTime.dwLowDateTime,
                   local_8bc.ftLastWriteTime.dwHighDateTime);
      FUN_67681545((int)local_44);
      FUN_676b06d0(auStack_8e8,local_3c,0x10);
      FUN_676815b7(local_254);
      FUN_67681512((int)local_44);
      FUN_67681545((int)local_44);
      FUN_676b06d0(auStack_8e8,local_3c,0x10);
      FUN_67681635(local_254);
      FUN_67681512((int)local_44);
      FUN_67681545((int)local_44);
      FUN_676b06d0(auStack_8e8,local_3c,0x10);
      FUN_6768166a(local_254);
      FindClose(local_18);
      uStack_8e0 = 0x67685b9d;
      cVar2 = (**(code **)(*(int *)local_c[0x1c1] + 0x38))();
      local_44[0] = &PTR_LAB_676b9950;
      if (cVar2 == '\0') {
        FUN_67688c3b(local_254);
        return '\0';
      }
      FUN_67688c3b(local_254);
    }
    iVar6 = this_00[0x13];
    if ((iVar6 < 1) || (0xf < iVar6)) {
      local_5 = '\x01';
      if (((iVar6 < 1) || (0xf < iVar6)) && ((iVar6 < 100 || (0x7a < iVar6)))) {
        if (param_3 != 0) {
          this_00[0x16] = 100;
        }
        local_460 = L'\0';
        local_6 = '\0';
        local_66c = L'\0';
        puVar7 = local_45e;
        for (iVar6 = 0x82; iVar6 != 0; iVar6 = iVar6 + -1) {
          *puVar7 = 0;
          puVar7 = puVar7 + 1;
        }
        puVar7 = local_66a;
        for (iVar6 = 0x82; iVar6 != 0; iVar6 = iVar6 + -1) {
          *puVar7 = 0;
          puVar7 = puVar7 + 1;
        }
        if ((param_2 == '\0') || (bVar1 = FUN_6767d0e4((int)this_00), !bVar1)) {
          if (this_00[0x16] != 0) goto LAB_67685ca8;
        }
        else if (this_00[0x16] == 0) {
          FUN_676ae1fc(&local_66c,(short *)this_00[0x5c]);
          FUN_676acb57(&local_460,(short *)&DAT_676c509c);
          Ordinal_6();
          uVar3 = Ordinal_2();
          this_00[0x5c] = uVar3;
          local_6 = '\x01';
        }
        else {
LAB_67685ca8:
          Ordinal_6();
          uVar3 = Ordinal_2();
          this_00[0x5c] = uVar3;
        }
        uVar4 = FUN_67686cb9(local_c,param_1,this_00);
        if ((char)uVar4 == '\0') {
LAB_67685d29:
          bVar1 = *(int *)((int)param_1 + 8) == 0x4000000;
          goto LAB_67685ea1;
        }
        if (param_3 != 0) {
          Ordinal_6();
          uVar3 = Ordinal_2();
          this_00[0x5c] = uVar3;
        }
        if (param_3 != 2) {
          cVar2 = FUN_67687795(local_c,param_1,this_00,this_00[0x16]);
          if ((cVar2 == '\0') || (bVar1 = FUN_67687bce(local_c,param_1,this_00), !bVar1))
          goto LAB_67685d29;
          if (local_6 != '\0') {
            if (&stack0x00000000 == (undefined1 *)0x66c) {
              local_18 = (WCHAR *)&DAT_676c509c;
            }
            else {
              local_18 = &local_66c;
            }
            Ordinal_6();
            uVar3 = Ordinal_2();
            this_00[0x5c] = uVar3;
            uStack_8e0 = 0x67685d94;
            iVar6 = FUN_676acf3e(&local_66c,&local_10,&local_1e,&local_22,&local_1c);
            if (iVar6 != 0) {
              uStack_8e0 = 0x67685dbb;
              iVar6 = FUN_676acf3e(&local_460,&local_20,&local_e,&local_12,&local_1a);
              if ((iVar6 != 0) &&
                 ((((local_20 < local_10 || ((local_20 == local_10 && (local_e < local_1e)))) ||
                   ((local_e == local_1e && (local_12 < local_22)))) ||
                  ((local_12 == local_22 && (local_1a < local_1c)))))) {
                FUN_676af46d(&local_460,0x80);
                FUN_676af551(&local_460);
                this_00[0x13] = 5;
                if ((int *)local_c[0x1c1] != (int *)0x0) {
                  iVar6 = *(int *)local_c[0x1c1];
                  goto LAB_67685e32;
                }
                goto LAB_67685ea3;
              }
            }
            FUN_676af46d(&local_66c,0x80);
            FUN_676af551(&local_66c);
            uStack_8e0 = 0x67685e69;
            BVar5 = FUN_676af333(&local_460,&local_66c);
            if (BVar5 == 0) {
              FUN_6767ca9c(param_1,0x69,0x2000000);
              goto LAB_67685ea3;
            }
          }
          if ((param_3 == 0) && (cVar2 = FUN_67689899(this_00,param_1,0xffffffff), cVar2 == '\0')) {
            bVar1 = *(int *)((int)param_1 + 8) == 0x4000000;
            goto LAB_67685ea1;
          }
        }
      }
    }
    else if ((int *)local_c[0x1c1] != (int *)0x0) {
      iVar6 = *(int *)local_c[0x1c1];
LAB_67685e32:
      cVar2 = (**(code **)(iVar6 + 0x14))();
      bVar1 = cVar2 == '\0';
LAB_67685ea1:
      if (bVar1) {
        return '\0';
      }
    }
LAB_67685ea3:
    this_00 = (undefined4 *)(**(code **)(*local_c + 0x34))();
  } while( true );
}



// Function: FUN_67685eff at 67685eff

uint __thiscall
FUN_67685eff(void *this,void *param_1,undefined4 *param_2,char param_3,undefined ***param_4)

{
  undefined4 uVar1;
  char cVar2;
  bool bVar3;
  uint uVar4;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  undefined **local_8;
  
  uVar1 = *(undefined4 *)((int)this + 0x704);
  local_8 = &PTR_LAB_676b9bac;
  if (param_4 == (undefined ***)0x0) {
    param_4 = &local_8;
  }
  *(undefined ****)((int)this + 0x704) = param_4;
  if (param_3 == '\0') {
    *(undefined4 *)((int)this + 0x454) = param_2[0xe];
  }
  uVar4 = FUN_67686cb9(this,param_1,param_2);
  if ((char)uVar4 != '\0') {
    cVar2 = FUN_67687795(this,param_1,param_2,0);
    uVar4 = CONCAT31(extraout_var,cVar2);
    if (cVar2 != '\0') {
      bVar3 = FUN_67687bce(this,param_1,param_2);
      uVar4 = CONCAT31(extraout_var_00,bVar3);
      if (bVar3) {
        uVar4 = CONCAT31(extraout_var_00,1);
        goto LAB_67685f6c;
      }
    }
  }
  uVar4 = uVar4 & 0xffffff00;
LAB_67685f6c:
  *(undefined4 *)((int)this + 0x704) = uVar1;
  return uVar4;
}



// Function: FUN_67686092 at 67686092

undefined4 FUN_67686092(void *param_1)

{
  BOOL BVar1;
  uint uVar2;
  int iVar3;
  tagMSG local_24;
  char local_5;
  
  iVar3 = 0x14;
  local_5 = '\0';
  BVar1 = PeekMessageA(&local_24,(HWND)0x0,0,0,1);
  if (BVar1 != 0) {
    do {
      if (local_24.message == 0x12) {
        local_5 = '\x01';
      }
      else {
        TranslateMessage(&local_24);
        BVar1 = DispatchMessageA(&local_24);
        if (local_24.message == 0xf) {
          iVar3 = iVar3 + -2;
        }
      }
      iVar3 = iVar3 + -1;
    } while ((0 < iVar3) && (BVar1 = PeekMessageA(&local_24,(HWND)0x0,0,0,1), BVar1 != 0));
    if (local_5 != '\0') {
      uVar2 = FUN_6767ca9c(param_1,0x206,0x4000000);
      return uVar2 & 0xffffff00;
    }
  }
  return CONCAT31((int3)((uint)BVar1 >> 8),1);
}



// Function: FUN_67686118 at 67686118

uint __thiscall FUN_67686118(void *this,void *param_1,int *param_2,int *param_3)

{
  void *pvVar1;
  int *piVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  undefined4 uVar7;
  undefined8 uVar8;
  
  piVar2 = param_2;
  pvVar1 = param_1;
  uVar3 = FUN_67688249(this,param_1,(int *)this,param_2,'\x01',*(int *)((int)this + 0x668) == -1);
  if (((((char)uVar3 != '\0') &&
       (uVar3 = FUN_67688249(this,pvVar1,(int *)this,param_3,'\x01',
                             *(int *)((int)this + 0x668) == -1), (char)uVar3 != '\0')) &&
      (uVar3 = FUN_67688249(this,pvVar1,piVar2,param_3,'\0','\0'), (char)uVar3 != '\0')) &&
     (uVar3 = FUN_67686ef1(this,pvVar1), (char)uVar3 != '\0')) {
    if ((*(char *)((int)this + 0x45c) == '\0') &&
       ((*(char *)((int)this + 0x448) != '\0' || (*(int *)((int)this + 0x44c) != 0)))) {
      param_1 = (void *)0x8074b50;
      uVar3 = FUN_6768d357((void *)((int)this + 0x30),pvVar1,&param_1,4,0);
      if ((char)uVar3 == '\0') goto LAB_676862a8;
    }
    uVar3 = FUN_67687264(this,pvVar1,piVar2);
    if ((char)uVar3 != '\0') {
      FUN_67687264(this,pvVar1,param_3);
    }
    if ((*(int *)((int)pvVar1 + 8) != 0x4000000) ||
       ((*(int *)((int)this + 0x668) == -1 && (*(char *)((int)this + 0x45c) != '\0')))) {
      uVar8 = FUN_6768d27f((void *)((int)this + 0x30),'\x01');
      FUN_67681b5c(*(void **)((int)this + 0x700),*(uint *)((int)this + 0x454),(int)uVar8,
                   (int)((ulonglong)uVar8 >> 0x20));
      iVar4 = (**(code **)(*piVar2 + 0x3c))();
      iVar5 = (**(code **)(*param_3 + 0x3c))();
                    /* WARNING: Load size is inaccurate */
      iVar6 = (**(code **)(*this + 0x3c))();
      param_1 = (void *)0x0;
      iVar6 = iVar4 + iVar5 + iVar6;
      if ((*(int **)((int)this + 0x704) != (int *)0x0) &&
         (uVar3 = (**(code **)(**(int **)((int)this + 0x704) + 0x58))(pvVar1,0,iVar6),
         (char)uVar3 == '\0')) goto LAB_676862a8;
      uVar3 = FUN_67687e6b(this,pvVar1,(int *)this,iVar6,(int *)&param_1,0xf);
      if (((char)uVar3 != '\0') &&
         (uVar3 = FUN_67687e6b(this,pvVar1,param_2,iVar6,(int *)&param_1,0xf), (char)uVar3 != '\0'))
      {
        FUN_67687e6b(this,pvVar1,param_3,iVar6,(int *)&param_1,0xf);
      }
      FUN_67687f0c(this,pvVar1);
    }
    uVar7 = FUN_6767e600((int)pvVar1);
    return (uint)((char)uVar7 == '\0');
  }
LAB_676862a8:
  return uVar3 & 0xffffff00;
}



// Function: FUN_676862b1 at 676862b1

uint __thiscall
FUN_676862b1(void *this,void *param_1,void *param_2,void *param_3,undefined4 param_4)

{
  char cVar1;
  void *pvVar2;
  undefined4 uVar3;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  uint uVar4;
  void *pvVar5;
  bool bVar6;
  undefined8 uVar7;
  int iVar8;
  
  pvVar5 = param_1;
  if (*(char *)((int)this + 0x45c) == '\0') {
    iVar8 = 0x1fd;
  }
  else if (*(char *)((int)this + 0x708) == '\0') {
    if (*(int *)((int)this + 0x668) != -1) {
                    /* WARNING: Load size is inaccurate */
      pvVar2 = (void *)(**(code **)(*this + 0x2c))();
      pvVar5 = param_1;
      for (; pvVar2 != (void *)0x0; pvVar2 = (void *)(**(code **)(*this + 0x34))(pvVar2)) {
        if (pvVar2 == (void *)0x0) {
          iVar8 = 999;
          goto LAB_67686485;
        }
        *(void **)((int)pvVar5 + 0x14) = pvVar2;
        *(undefined4 *)((int)pvVar5 + 4) = 0;
        *(undefined4 *)((int)pvVar5 + 8) = 0;
        if ((((*(int *)((int)param_2 + 0x14) == 0) ||
             (uVar3 = FUN_676ae612(param_2,*(short **)((int)pvVar2 + 0x16c),(char)param_4,'\x01',
                                   '\x01','\0'), (char)uVar3 != '\0')) &&
            ((iVar8 = *(int *)((int)pvVar2 + 0x4c), iVar8 < 1 || (0xf < iVar8)))) &&
           (((iVar8 < 100 || (0x7a < iVar8)) &&
            (uVar3 = FUN_676ae612(param_3,*(short **)((int)pvVar2 + 0x16c),(char)param_4,'\x01',
                                  '\x01','\0'), (char)uVar3 == '\0')))) {
          if ((*(int **)((int)this + 0x704) != (int *)0x0) &&
             (uVar4 = (**(code **)(**(int **)((int)this + 0x704) + 0x34))(pvVar5,pvVar2),
             (char)uVar4 == '\0')) goto LAB_67686475;
LAB_67686403:
          if (*(int **)((int)this + 0x704) != (int *)0x0) {
            uVar4 = (**(code **)(**(int **)((int)this + 0x704) + 0x60))(pvVar5);
            bVar6 = (char)uVar4 == '\0';
            goto LAB_67686415;
          }
        }
        else {
          uVar4 = FUN_67686cb9(this,pvVar5,pvVar2);
          if ((char)uVar4 != '\0') {
            if ((*(byte *)((int)pvVar2 + 0x14) & 1) == 0) {
              *(ushort *)((int)pvVar2 + 0x14) = *(ushort *)((int)pvVar2 + 0x14) & 0xfff7;
            }
            uVar4 = FUN_67687c45(this,pvVar5,pvVar2,1,0xf);
            if ((char)uVar4 != '\0') {
              cVar1 = FUN_6768e125((void *)((int)this + 0x30),pvVar5,*(uint *)((int)pvVar2 + 0x20),
                                   *(int *)((int)pvVar2 + 0x24));
              uVar4 = CONCAT31(extraout_var,cVar1);
              if (cVar1 != '\0') {
                if ((*(byte *)((int)pvVar2 + 0x14) >> 3 & 1) != 0) {
                  cVar1 = FUN_67687db6(this,pvVar5,pvVar2);
                  uVar4 = CONCAT31(extraout_var_00,cVar1);
                  if (cVar1 == '\0') goto LAB_67686475;
                }
                *(undefined4 *)((int)pvVar2 + 0x4c) = 0;
                *(undefined1 *)((int)pvVar2 + 0x54) = 1;
                goto LAB_67686403;
              }
            }
            goto LAB_67686475;
          }
          bVar6 = *(int *)((int)pvVar5 + 8) == 0x4000000;
LAB_67686415:
          if (bVar6) goto LAB_67686475;
        }
                    /* WARNING: Load size is inaccurate */
      }
      *(undefined4 *)((int)pvVar5 + 0x14) = 0;
      *(undefined4 *)((int)pvVar5 + 4) = 0;
      *(undefined4 *)((int)pvVar5 + 8) = 0;
      uVar7 = FUN_6768d27f((void *)((int)this + 0x30),'\x01');
      FUN_67681b5c(*(void **)((int)this + 0x700),*(uint *)((int)this + 0x454),(int)uVar7,
                   (int)((ulonglong)uVar7 >> 0x20));
                    /* WARNING: Load size is inaccurate */
      uVar3 = (**(code **)(*this + 0x3c))();
      param_1 = (void *)0x0;
      if ((*(int **)((int)this + 0x704) == (int *)0x0) ||
         (uVar4 = (**(code **)(**(int **)((int)this + 0x704) + 0x58))(pvVar5,0,uVar3),
         (char)uVar4 != '\0')) {
        FUN_67687e6b(this,pvVar5,(int *)this,uVar3,(int *)&param_1,0xf);
        FUN_67687f0c(this,pvVar5);
        uVar3 = FUN_6767e600((int)pvVar5);
        return (uint)((char)uVar3 == '\0');
      }
      goto LAB_67686475;
    }
    iVar8 = 0x211;
  }
  else {
    iVar8 = 0x203;
  }
LAB_67686485:
  uVar4 = FUN_6767ca9c(pvVar5,iVar8,0x4000000);
LAB_67686475:
  return uVar4 & 0xffffff00;
}



// Function: FUN_676864b7 at 676864b7

uint __thiscall FUN_676864b7(void *this,void *param_1,int *param_2,undefined4 param_3)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  undefined8 uVar6;
  
  piVar1 = param_2;
  uVar2 = FUN_67688249(this,param_1,param_2,(int *)this,'\x01',*(int *)((int)this + 0x668) == -1);
  if (((char)uVar2 != '\0') && (uVar2 = FUN_67686ef1(this,param_1), (char)uVar2 != '\0')) {
    if ((*(char *)((int)this + 0x45c) == '\0') &&
       ((*(char *)((int)this + 0x448) != '\0' || (*(int *)((int)this + 0x44c) != 0)))) {
      param_2 = (int *)0x8074b50;
      uVar2 = FUN_6768d357((void *)((int)this + 0x30),param_1,&param_2,4,0);
      if ((char)uVar2 == '\0') goto LAB_676865a8;
    }
    uVar2 = FUN_676870f6(this,param_1,piVar1,param_3);
    if ((char)uVar2 != '\0') {
      if ((*(int *)((int)param_1 + 8) != 0x4000000) ||
         ((*(int *)((int)this + 0x668) == -1 && (*(char *)((int)this + 0x45c) != '\0')))) {
        uVar6 = FUN_6768d27f((void *)((int)this + 0x30),'\x01');
        FUN_67681b5c(*(void **)((int)this + 0x700),*(uint *)((int)this + 0x454),(int)uVar6,
                     (int)((ulonglong)uVar6 >> 0x20));
        iVar3 = (**(code **)(*piVar1 + 0x3c))();
                    /* WARNING: Load size is inaccurate */
        iVar4 = (**(code **)(*this + 0x3c))();
        param_2 = (int *)0x0;
        iVar3 = iVar3 + iVar4;
        if ((*(int **)((int)this + 0x704) != (int *)0x0) &&
           (uVar2 = (**(code **)(**(int **)((int)this + 0x704) + 0x58))(param_1,0,iVar3),
           (char)uVar2 == '\0')) goto LAB_676865a8;
        uVar2 = FUN_67687e6b(this,param_1,(int *)this,iVar3,(int *)&param_2,0xf);
        if ((char)uVar2 != '\0') {
          FUN_67687e6b(this,param_1,piVar1,iVar3,(int *)&param_2,param_3);
        }
        FUN_67687f0c(this,param_1);
      }
      uVar5 = FUN_6767e600((int)param_1);
      return (uint)((char)uVar5 == '\0');
    }
  }
LAB_676865a8:
  return uVar2 & 0xffffff00;
}



// Function: FUN_676865f5 at 676865f5

uint __thiscall FUN_676865f5(void *this,void *param_1)

{
  int iVar1;
  void *this_00;
  uint uVar2;
  undefined4 uVar3;
  undefined8 uVar4;
  undefined1 *local_14;
  LPCSTR local_10;
  int local_c;
  undefined1 *local_8;
  
  uVar2 = FUN_67681b12(*(int *)((int)this + 0x700));
  this_00 = param_1;
  *(undefined4 *)((int)this + 0x454) = 0;
  if (*(char *)((int)this + 0x45c) == '\0') goto LAB_6768685e;
  uVar2 = FUN_6768d20a((void *)((int)this + 0x30),param_1,0,0,2,'\0');
  if ((char)uVar2 != '\0') {
    param_1 = (void *)0x6054b50;
    uVar2 = FUN_6768cfca((void *)((int)this + 0x30),this_00,(int)&param_1,4,-1,0xffff,'\0');
    if ((char)uVar2 != '\0') {
      uVar4 = FUN_6768d27f((void *)((int)this + 0x30),'\0');
      *(undefined8 *)((int)this + 0x720) = uVar4;
      uVar2 = FUN_67681cf0(*(void **)((int)this + 0x700),this_00,(int)this);
      if ((char)uVar2 != '\0') {
        iVar1 = *(int *)((int)this + 0x700);
        if (*(char *)(iVar1 + 0x65) == '\0') {
          uVar2 = (uint)*(ushort *)(iVar1 + 4);
        }
        else {
          uVar2 = *(int *)(iVar1 + 0x56) - 1;
        }
        *(uint *)((int)this + 0x454) = uVar2;
        if ((*(int *)((int)this + 0x704) != 0) && (*(int *)(iVar1 + 0x5c) != 0)) {
          local_10 = *(LPCSTR *)(iVar1 + 0x5c);
          if (local_10 == (LPCSTR)0x0) {
            local_8 = (undefined1 *)0x0;
          }
          else {
            local_c = lstrlenA(local_10);
            local_c = local_c + 1;
            FUN_676b06a0();
            local_14 = &stack0xffffffe0;
            MultiByteToWideChar(0,0,local_10,-1,(LPWSTR)&stack0xffffffe0,local_c);
            local_8 = local_14;
          }
          uVar2 = (**(code **)(**(int **)((int)this + 0x704) + 0xc))(this_00,&local_8,0);
          if ((char)uVar2 == '\0') goto LAB_67686849;
        }
        uVar2 = FUN_6768686a(*(int *)((int)this + 0x700));
        if ((char)uVar2 != '\0') {
          local_8 = (undefined1 *)FUN_67683c22();
          uVar2 = FUN_67683dbd();
          if (((int)local_8 <= (int)uVar2) || (uVar2 = FUN_67683dee(), (int)local_8 <= (int)uVar2))
          {
            param_1 = (void *)0x7064b50;
            uVar3 = FUN_6768cfca((void *)((int)this + 0x30),this_00,(int)&param_1,4,-1,0xffff,'\x01'
                                );
            if ((char)uVar3 == '\0') {
              uVar2 = 900;
              if (*(int *)((int)this_00 + 4) == 900) {
                if (*(int *)((int)this_00 + 0x10) == 0x4000000) {
                  if (*(int *)((int)this_00 + 0xc) == 900) {
                    *(undefined4 *)((int)this_00 + 4) = 0;
                  }
                  *(undefined4 *)((int)this_00 + 0xc) = 0;
                }
                goto LAB_6768685e;
              }
            }
            else {
              uVar2 = FUN_67681e15(*(void **)((int)this + 0x700),this_00,(int)this);
              if ((char)uVar2 != '\0') {
                iVar1 = *(int *)((int)this + 0x700);
                uVar2 = FUN_6768d185((void *)((int)this + 0x30),this_00,*(int *)(iVar1 + 0x4a),
                                     *(LONG *)(iVar1 + 0x4e),*(void **)(iVar1 + 0x52),0);
                if ((char)uVar2 != '\0') {
                  local_14 = (undefined1 *)0x0;
                  uVar2 = FUN_6768dc46((void *)((int)this + 0x30),this_00,&param_1,4,
                                       (LPDWORD)&local_14,'\x01');
                  if ((char)uVar2 != '\0') {
                    if (param_1 != (void *)0x6064b50) {
                      FUN_6767ca9c(this_00,0x146,0x1000000);
                      uVar2 = FUN_6768d20a((void *)((int)this + 0x30),this_00,0,0,2,'\0');
                      if ((char)uVar2 == '\0') goto LAB_67686849;
                      param_1 = (void *)0x6064b50;
                      uVar2 = FUN_6768cfca((void *)((int)this + 0x30),this_00,0x6064b50,4,
                                           *(int *)(*(int *)((int)this + 0x700) + 0x4a),0x100000,
                                           '\0');
                      if ((char)uVar2 == '\0') goto LAB_67686849;
                    }
                    uVar2 = FUN_67681ecb(*(void **)((int)this + 0x700),this_00,(int)this);
                    if ((char)uVar2 != '\0') goto LAB_6768685e;
                  }
                }
              }
            }
            goto LAB_67686849;
          }
          uVar2 = FUN_6767ca9c(this_00,0x147,0x1000000);
        }
LAB_6768685e:
        return CONCAT31((int3)(uVar2 >> 8),1);
      }
    }
  }
LAB_67686849:
  return uVar2 & 0xffffff00;
}



// Function: FUN_6768686a at 6768686a

undefined4 __fastcall FUN_6768686a(int param_1)

{
  if ((((*(short *)(param_1 + 4) != -1) && (*(short *)(param_1 + 10) != -1)) &&
      (*(int *)(param_1 + 0xc) != -1)) && (*(int *)(param_1 + 0x10) != -1)) {
    return 0;
  }
  return 1;
}



// Function: FUN_6768688d at 6768688d

bool __thiscall FUN_6768688d(void *this,void *param_1)

{
  uint uVar1;
  undefined4 uVar2;
  undefined8 uVar3;
  int iVar4;
  char cVar5;
  int iVar6;
  void *local_c;
  undefined4 uStack_8;
  
  if (*(char *)((int)this + 0x45c) == '\0') {
    iVar6 = 0x4000000;
    iVar4 = 999;
    local_c = this;
    uStack_8 = this;
LAB_676868ae:
    FUN_6767ca9c(param_1,iVar4,iVar6);
  }
  else {
    cVar5 = '\x01';
    local_c = (void *)0x0;
    uStack_8 = (void *)((uint)this & 0xffffff);
    while (uVar1 = FUN_67686de2(this,param_1,(short *)&local_c,(char *)((int)&uStack_8 + 3),cVar5),
          (char)uVar1 != '\0') {
      if ((short)local_c == 0x605) {
        iVar4 = *(int *)((int)this + 0x700);
        if (*(char *)(iVar4 + 0x65) == '\0') {
          uVar1 = (uint)*(ushort *)(iVar4 + 4);
        }
        else {
          uVar1 = *(int *)(iVar4 + 0x56) - 1;
        }
        if (*(uint *)((int)this + 0x454) == uVar1) {
          uVar3 = FUN_6768d27f((void *)((int)this + 0x30),'\0');
          if (((int)uVar3 != *(int *)((int)this + 0x720)) ||
             ((int)((ulonglong)uVar3 >> 0x20) != *(int *)((int)this + 0x724))) goto LAB_6768691a;
          iVar6 = 0x2000000;
          iVar4 = 0x77;
          goto LAB_676868ae;
        }
      }
      else {
LAB_6768691a:
        if ((short)local_c == 0x201) {
          if (uStack_8._3_1_ == '\0') {
            FUN_6767ca9c(param_1,0x12e,0x1000000);
          }
          FUN_6767c87e(*(int *)((int)this + 0x6fc));
          uVar2 = FUN_6767c8e4(*(void **)((int)this + 0x6fc),param_1,(int)this);
          return (char)uVar2 != '\0';
        }
      }
      cVar5 = '\0';
    }
  }
  return false;
}



// Function: FUN_67686979 at 67686979

undefined4 __thiscall
FUN_67686979(void *this,void *param_1,void *param_2,void *param_3,char param_4,char param_5,
            char param_6)

{
  int iVar1;
  bool bVar2;
  char cVar3;
  uint in_EAX;
  uint uVar4;
  uint uVar5;
  undefined3 extraout_var;
  undefined4 *puVar6;
  int *this_00;
  undefined4 uVar7;
  LONG LVar8;
  void *pvVar9;
  uint local_14;
  uint local_10;
  uint local_8;
  
  if (*(char *)((int)this + 0x45c) == '\0') {
    *(undefined4 *)((int)this + 0x710) = 0;
    *(undefined4 *)((int)this + 0x714) = 0;
    local_10 = in_EAX;
    goto LAB_67686be7;
  }
  iVar1 = *(int *)((int)this + 0x700);
  if (*(char *)(iVar1 + 0x66) == '\0') {
    LVar8 = *(LONG *)(iVar1 + 0x10);
    pvVar9 = (void *)0x0;
  }
  else {
    LVar8 = *(LONG *)(iVar1 + 0x42);
    pvVar9 = *(void **)(iVar1 + 0x46);
  }
  if (*(char *)(iVar1 + 0x66) == '\0') {
    uVar4 = (uint)*(ushort *)(iVar1 + 6);
  }
  else {
    uVar4 = *(uint *)(iVar1 + 0x26);
  }
  uVar4 = FUN_6768d185((void *)((int)this + 0x30),param_1,uVar4,LVar8,pvVar9,0);
  if ((char)uVar4 == '\0') {
LAB_67686bb9:
    return uVar4 & 0xffffff00;
  }
  uVar5 = FUN_67686bf0(*(int *)((int)this + 0x700));
  local_14 = 0xffffffff;
  local_10 = 0xffffffff;
  local_8 = 0;
  if (uVar5 == 0) {
LAB_67686b70:
    iVar1 = *(int *)((int)this + 0x700);
    if (*(char *)(iVar1 + 0x66) == '\0') {
      local_14 = *(uint *)(iVar1 + 0x10);
      local_10 = 0;
    }
    else {
      local_14 = *(uint *)(iVar1 + 0x42);
      local_10 = *(uint *)(iVar1 + 0x46);
    }
  }
  else {
    do {
      this_00 = (int *)0x0;
      *(undefined4 *)((int)param_1 + 0x14) = 0;
      *(undefined4 *)((int)param_1 + 4) = 0;
      *(undefined4 *)((int)param_1 + 8) = 0;
      bVar2 = FUN_6768688d(this,param_1);
      uVar4 = CONCAT31(extraout_var,bVar2);
      if (!bVar2) {
        if (*(int *)((int)param_1 + 8) == 0x4000000) goto LAB_67686bb9;
        FUN_676883d2(param_1,0);
        FUN_6767ca9c(param_1,0x13f,0x1000000);
        break;
      }
      if ((*(short *)(*(int *)((int)this + 0x6fc) + 0x22) == 0) &&
         ((uVar4 = *(uint *)(*(int *)((int)this + 0x6fc) + 0x2a), local_10 != 0 ||
          (uVar4 < local_14)))) {
        local_10 = 0;
        local_14 = uVar4;
      }
      puVar6 = (undefined4 *)operator_new(0x210);
      if (puVar6 != (undefined4 *)0x0) {
        this_00 = FUN_67688abc(puVar6);
      }
      if (this_00 == (int *)0x0) {
        uVar4 = FUN_6767ca9c(param_1,0x1ff,0x4000000);
        goto LAB_67686bb9;
      }
      *(undefined4 *)((int)param_1 + 4) = 0;
      *(undefined4 *)((int)param_1 + 8) = 0;
      *(int **)((int)param_1 + 0x14) = this_00;
      FUN_67688fe5(this_00,param_1,*(int *)((int)this + 0x6fc));
      uVar4 = *(uint *)((int)param_1 + 8);
      if (uVar4 == 0x4000000) goto LAB_67686bb9;
      local_8 = local_8 + 1;
      if (uVar4 == 0x2000000) {
        (**(code **)*this_00)(1);
      }
      else {
        if ((*(int *)((int)param_2 + 0x14) == 0) ||
           (uVar7 = FUN_676ae612(param_2,(short *)this_00[0x5b],param_4,param_5,param_6,'\0'),
           (char)uVar7 != '\0')) {
                    /* WARNING: Load size is inaccurate */
          iVar1 = *this;
          uVar7 = (**(code **)(*this_00 + 4))(this_00,0);
          cVar3 = (**(code **)(iVar1 + 0x40))(uVar7);
          if (cVar3 == '\0') {
                    /* WARNING: Load size is inaccurate */
            iVar1 = *this;
            uVar7 = (**(code **)(*this_00 + 4))(this_00,1);
            (**(code **)(iVar1 + 0x40))(uVar7);
          }
          if ((this_00[0x13] == 0) &&
             (uVar7 = FUN_676ae612(param_3,(short *)this_00[0x5b],param_4,'\x01','\x01','\0'),
             (char)uVar7 != '\0')) {
            this_00[0x13] = 1;
          }
          if ((*(undefined4 **)((int)this + 0x704) != (undefined4 *)0x0) &&
             (uVar4 = (**(code **)**(undefined4 **)((int)this + 0x704))(param_1,this_00),
             (char)uVar4 == '\0')) goto LAB_67686bb9;
        }
        else {
          (**(code **)*this_00)(1);
        }
        if (*(int **)((int)this + 0x704) != (int *)0x0) {
          uVar4 = uVar5;
          if (uVar5 < local_8) {
            uVar4 = local_8;
          }
          uVar4 = (**(code **)(**(int **)((int)this + 0x704) + 0x2c))(param_1,local_8,uVar4);
          if ((char)uVar4 == '\0') goto LAB_67686bb9;
        }
      }
    } while (local_8 < uVar5);
    if ((local_14 & local_10) == 0xffffffff) goto LAB_67686b70;
  }
  *(uint *)((int)this + 0x710) = local_14;
  *(uint *)((int)this + 0x714) = local_10;
  *(undefined4 *)((int)param_1 + 0x14) = 0;
  *(undefined4 *)((int)param_1 + 4) = 0;
  *(undefined4 *)((int)param_1 + 8) = 0;
LAB_67686be7:
  return CONCAT31((int3)(local_10 >> 8),1);
}



// Function: FUN_67686bf0 at 67686bf0

uint __fastcall FUN_67686bf0(int param_1)

{
  uint uVar1;
  
  if (*(char *)(param_1 + 0x66) == '\0') {
    uVar1 = (uint)*(ushort *)(param_1 + 10);
  }
  else {
    uVar1 = *(uint *)(param_1 + 0x32);
    if (*(int *)(param_1 + 0x36) != 0) {
      return 0xffffffff;
    }
  }
  return uVar1;
}



// Function: FUN_67686c0e at 67686c0e

bool __thiscall FUN_67686c0e(void *this,void *param_1)

{
  void *this_00;
  undefined4 uVar1;
  longlong lVar2;
  longlong lVar3;
  void *local_8;
  
  if (*(char *)((int)this + 0x45c) == '\0') {
    local_8 = this;
    FUN_6767ca9c(param_1,999,0x4000000);
  }
  else {
    this_00 = (void *)((int)this + 0x30);
    local_8 = (void *)0x4034b50;
    lVar2 = FUN_6768d27f(this_00,'\0');
    uVar1 = FUN_6768ceb9(this_00,param_1,(int)&local_8,4,'\0');
    if ((char)uVar1 != '\0') {
      lVar3 = FUN_6768d27f(this_00,'\0');
      if (lVar3 != lVar2 + 4) {
        FUN_6767ca9c(param_1,0x12f,0x1000000);
      }
      FUN_6768a059(*(int *)((int)this + 0x6f8));
      uVar1 = FUN_6768a098(*(void **)((int)this + 0x6f8),param_1,(int)this);
      return (char)uVar1 != '\0';
    }
  }
  return false;
}



// Function: FUN_67686cb9 at 67686cb9

uint __thiscall FUN_67686cb9(void *this,void *param_1,void *param_2)

{
  bool bVar1;
  uint uVar2;
  undefined3 extraout_var;
  undefined4 uVar3;
  
  if (param_2 == (void *)0x0) {
    uVar2 = FUN_6767ca9c(param_1,999,0x4000000);
  }
  else {
    uVar2 = FUN_6768d185((void *)((int)this + 0x30),param_1,*(int *)((int)param_2 + 0x38),
                         *(LONG *)((int)param_2 + 0x40),*(void **)((int)param_2 + 0x44),0);
    if ((char)uVar2 != '\0') {
      bVar1 = FUN_67686c0e(this,param_1);
      uVar2 = CONCAT31(extraout_var,bVar1);
      if (bVar1) {
        FUN_676892e7(param_2,param_1,*(int *)((int)this + 0x6f8));
        uVar3 = FUN_6767e600((int)param_1);
        return (uint)((char)uVar3 == '\0');
      }
    }
  }
  return uVar2 & 0xffffff00;
}



// Function: FUN_67686d27 at 67686d27

uint __thiscall FUN_67686d27(void *this,void *param_1,int *param_2,char param_3)

{
  int *piVar1;
  undefined4 *puVar2;
  void *this_00;
  int iVar3;
  void *local_8;
  
  if (*(char *)((int)this + 0x45c) == '\0') {
    iVar3 = 999;
    local_8 = this;
  }
  else {
    local_8 = (void *)0x0;
    piVar1 = (int *)FUN_6768d2cc((void *)((int)this + 0x30),param_1,&local_8,4);
    if ((char)piVar1 == '\0') goto LAB_67686dde;
    if (local_8 != (void *)0x8074b50) {
      FUN_6767ca9c(param_1,0x131,0x1000000);
      *param_2 = 0;
      piVar1 = param_2;
LAB_67686d89:
      return CONCAT31((int3)((uint)piVar1 >> 8),1);
    }
    puVar2 = (undefined4 *)operator_new(0x18);
    if (puVar2 == (undefined4 *)0x0) {
      this_00 = (void *)0x0;
    }
    else {
      this_00 = (void *)FUN_6768010d(puVar2);
    }
    *param_2 = (int)this_00;
    if (this_00 != (void *)0x0) {
      piVar1 = (int *)FUN_6768014a(this_00,param_1,(int)this,param_3);
      if ((char)piVar1 == '\0') {
        if ((undefined4 *)*param_2 != (undefined4 *)0x0) {
          piVar1 = (int *)(*(code *)**(undefined4 **)*param_2)(1);
        }
        *param_2 = 0;
        goto LAB_67686dde;
      }
      goto LAB_67686d89;
    }
    iVar3 = 0x1ff;
  }
  piVar1 = (int *)FUN_6767ca9c(param_1,iVar3,0x4000000);
LAB_67686dde:
  return (uint)piVar1 & 0xffffff00;
}



// Function: FUN_67686de2 at 67686de2

uint __thiscall FUN_67686de2(void *this,void *param_1,short *param_2,char *param_3,char param_4)

{
  void *this_00;
  short sVar1;
  char *pcVar2;
  uint uVar3;
  
  pcVar2 = param_3;
  *param_3 = '\0';
  *param_2 = 0;
  this_00 = (void *)((int)this + 0x30);
  uVar3 = FUN_6768d2cc(this_00,param_1,(LPVOID)((int)&param_3 + 3),1);
  if ((char)uVar3 != '\0') {
    if (param_3._3_1_ == 'P') {
      uVar3 = FUN_6768d2cc(this_00,param_1,(LPVOID)((int)&param_3 + 3),1);
      if ((char)uVar3 == '\0') goto LAB_67686ee4;
      if (param_3._3_1_ == 'K') {
        *pcVar2 = '\x01';
      }
    }
    if (*pcVar2 != '\0') goto LAB_67686e7c;
    if ((param_4 == '\0') ||
       (uVar3 = FUN_6768d20a(this_00,param_1,-0x10,-1,1,'\0'), (char)uVar3 != '\0')) {
      do {
        if ((*pcVar2 == '\0') &&
           (uVar3 = FUN_6768ceb9(this_00,param_1,0x676c05a8,2,'\x01'), (char)uVar3 == '\0'))
        goto LAB_67686ee4;
LAB_67686e7c:
        uVar3 = FUN_6768d2cc(this_00,param_1,param_2,2);
        if ((char)uVar3 == '\0') goto LAB_67686ee4;
        sVar1 = *param_2;
        if ((((sVar1 == 0x201) || (sVar1 == 0x403)) || (sVar1 == 0x605)) || (sVar1 == 0x807)) {
          return CONCAT31((uint3)(byte)((ushort)sVar1 >> 8),1);
        }
        *pcVar2 = '\0';
        *param_2 = 0;
        if ((*(int **)((int)this + 0x704) != (int *)0x0) &&
           (uVar3 = (**(code **)(**(int **)((int)this + 0x704) + 0x60))(param_1),
           (char)uVar3 == '\0')) goto LAB_67686ee4;
      } while (*param_2 == 0);
      uVar3 = FUN_6767ca9c(param_1,999,0x4000000);
    }
  }
LAB_67686ee4:
  return uVar3 & 0xffffff00;
}



// Function: FUN_67686ef1 at 67686ef1

undefined4 __thiscall FUN_67686ef1(void *this,void *param_1)

{
  uint *puVar1;
  bool bVar2;
  int in_EAX;
  void *pvVar3;
  undefined3 extraout_var;
  int iVar4;
  uint uVar5;
  LONG LVar6;
  undefined8 uVar7;
  void *local_8;
  
  if (*(char *)((int)this + 0x45c) != '\0') {
    if (*(char *)((int)this + 0x708) != '\0') {
LAB_67686fef:
      uVar5 = FUN_6767ca9c(param_1,999,0x4000000);
LAB_67687020:
      return uVar5 & 0xffffff00;
    }
                    /* WARNING: Load size is inaccurate */
    if (*(int *)((int)this + 0x668) == -1) {
      for (iVar4 = (**(code **)(*this + 0x2c))(); iVar4 != 0;
          iVar4 = (**(code **)(*this + 0x34))(iVar4)) {
        if (iVar4 == 0) goto LAB_67686fef;
        *(int *)((int)param_1 + 0x14) = iVar4;
        *(undefined4 *)((int)param_1 + 4) = 0;
        *(undefined4 *)((int)param_1 + 8) = 0;
        if ((*(char *)(iVar4 + 0x54) != '\0') || (*(int *)(iVar4 + 0x4c) != 0)) goto LAB_67686fef;
                    /* WARNING: Load size is inaccurate */
      }
      *(undefined4 *)((int)param_1 + 0x14) = 0;
      *(undefined4 *)((int)param_1 + 4) = 0;
      *(undefined4 *)((int)param_1 + 8) = 0;
      iVar4 = *(int *)((int)this + 0x700);
      if (*(char *)(iVar4 + 0x66) == '\0') {
        LVar6 = *(LONG *)(iVar4 + 0x10);
        local_8 = (void *)0x0;
      }
      else {
        local_8 = *(void **)(iVar4 + 0x46);
        LVar6 = *(LONG *)(iVar4 + 0x42);
      }
      if (*(char *)(iVar4 + 0x66) == '\0') {
        uVar5 = (uint)*(ushort *)(iVar4 + 6);
      }
      else {
        uVar5 = *(uint *)(iVar4 + 0x26);
      }
      uVar5 = FUN_6768d185((void *)((int)this + 0x30),param_1,uVar5,LVar6,local_8,0);
      if ((char)uVar5 == '\0') goto LAB_67687020;
      uVar7 = FUN_6768d27f((void *)((int)this + 0x30),'\0');
      puVar1 = (uint *)((int)this + 0x6f0);
      uVar5 = *puVar1;
      *puVar1 = *puVar1 - (uint)uVar7;
      *(int *)((int)this + 0x6f4) =
           (*(int *)((int)this + 0x6f4) - (int)((ulonglong)uVar7 >> 0x20)) -
           (uint)(uVar5 < (uint)uVar7);
                    /* WARNING: Load size is inaccurate */
      for (in_EAX = (**(code **)(*this + 0x2c))(); in_EAX != 0;
          in_EAX = (**(code **)(*this + 0x34))(in_EAX)) {
        *(undefined1 *)(in_EAX + 0x54) = 1;
                    /* WARNING: Load size is inaccurate */
      }
    }
    else {
      for (pvVar3 = (void *)(**(code **)(*this + 0x2c))(); pvVar3 != (void *)0x0;
          pvVar3 = (void *)(**(code **)(*this + 0x34))(pvVar3)) {
        if (pvVar3 == (void *)0x0) goto LAB_67686fef;
        *(void **)((int)param_1 + 0x14) = pvVar3;
        *(undefined4 *)((int)param_1 + 4) = 0;
        *(undefined4 *)((int)param_1 + 8) = 0;
        if (*(int *)((int)pvVar3 + 0x4c) == 0) {
          bVar2 = FUN_6768705e(this,param_1,pvVar3);
          uVar5 = CONCAT31(extraout_var,bVar2);
          if (!bVar2) goto LAB_67687020;
        }
                    /* WARNING: Load size is inaccurate */
      }
      in_EAX = 0;
      *(undefined4 *)((int)param_1 + 0x14) = 0;
      *(undefined4 *)((int)param_1 + 4) = 0;
      *(undefined4 *)((int)param_1 + 8) = 0;
    }
  }
  return CONCAT31((int3)((uint)in_EAX >> 8),1);
}



// Function: FUN_6768705e at 6768705e

bool __thiscall FUN_6768705e(void *this,void *param_1,void *param_2)

{
  char cVar1;
  uint uVar2;
  undefined4 uVar3;
  
  if ((param_2 == (void *)0x0) || (*(char *)((int)param_2 + 0x54) != '\0')) {
    FUN_6767ca9c(param_1,999,0x4000000);
  }
  else {
    uVar2 = FUN_67686cb9(this,param_1,param_2);
    if ((char)uVar2 == '\0') {
      return *(int *)((int)param_1 + 8) != 0x4000000;
    }
    if ((*(byte *)((int)param_2 + 0x14) & 1) == 0) {
      *(ushort *)((int)param_2 + 0x14) = *(ushort *)((int)param_2 + 0x14) & 0xfff7;
    }
    uVar3 = FUN_67687c45(this,param_1,param_2,1,0xf);
    if ((((char)uVar3 != '\0') &&
        (cVar1 = FUN_6768e125((void *)((int)this + 0x30),param_1,*(uint *)((int)param_2 + 0x20),
                              *(int *)((int)param_2 + 0x24)), cVar1 != '\0')) &&
       (((*(byte *)((int)param_2 + 0x14) >> 3 & 1) == 0 ||
        (cVar1 = FUN_67687db6(this,param_1,param_2), cVar1 != '\0')))) {
      *(undefined1 *)((int)param_2 + 0x54) = 1;
      return true;
    }
  }
  return false;
}



// Function: FUN_676870f6 at 676870f6

uint __thiscall FUN_676870f6(void *this,void *param_1,int *param_2,undefined4 param_3)

{
  int iVar1;
  char cVar2;
  void *pvVar3;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  uint uVar4;
  bool bVar5;
  
  if ((char)param_2[0x117] == '\0') {
LAB_6768725b:
    uVar4 = FUN_6767ca9c(param_1,999,0x4000000);
LAB_67687260:
    uVar4 = uVar4 & 0xffffff00;
  }
  else {
    pvVar3 = (void *)(**(code **)(*param_2 + 0x2c))();
    if (pvVar3 != (void *)0x0) {
      if (pvVar3 == (void *)0x0) goto LAB_6768725b;
      do {
        *(undefined4 *)((int)param_1 + 4) = 0;
        *(undefined4 *)((int)param_1 + 8) = 0;
        *(void **)((int)param_1 + 0x14) = pvVar3;
        iVar1 = *(int *)((int)pvVar3 + 0x4c);
        if (((iVar1 < 1) || (0xf < iVar1)) && ((iVar1 < 100 || (0x7a < iVar1)))) {
          uVar4 = FUN_67686cb9(param_2,param_1,pvVar3);
          if ((char)uVar4 == '\0') {
            bVar5 = *(int *)((int)param_1 + 8) == 0x4000000;
LAB_6768719e:
            if (bVar5) goto LAB_67687260;
          }
          else {
            if ((*(byte *)((int)pvVar3 + 0x14) & 1) == 0) {
              *(ushort *)((int)pvVar3 + 0x14) = *(ushort *)((int)pvVar3 + 0x14) & 0xfff7;
            }
            uVar4 = FUN_67687c45(this,param_1,pvVar3,1,param_3);
            if ((char)uVar4 == '\0') goto LAB_67687260;
            cVar2 = FUN_67688125(param_1,(int)pvVar3,
                                 (void *)(-(uint)(param_2 != (int *)0x0) & (uint)(param_2 + 0xc)));
            uVar4 = CONCAT31(extraout_var,cVar2);
            if (cVar2 == '\0') goto LAB_67687260;
            if ((*(byte *)((int)pvVar3 + 0x14) >> 3 & 1) != 0) {
              cVar2 = FUN_67687db6(this,param_1,pvVar3);
              uVar4 = CONCAT31(extraout_var_00,cVar2);
              if (cVar2 == '\0') goto LAB_67687260;
            }
            if ((*(int **)((int)this + 0x704) != (int *)0x0) &&
               (uVar4 = (**(code **)(**(int **)((int)this + 0x704) + 0x10))
                                  (param_1,pvVar3,*(undefined4 *)((int)pvVar3 + 0x20),
                                   *(undefined4 *)((int)pvVar3 + 0x24),
                                   *(undefined4 *)((int)pvVar3 + 0x20),
                                   *(undefined4 *)((int)pvVar3 + 0x24),1), (char)uVar4 == '\0'))
            goto LAB_67687260;
            *(undefined1 *)((int)pvVar3 + 0x54) = 1;
          }
        }
        else if (((0 < iVar1) && (iVar1 < 0x10)) && (*(int **)((int)this + 0x704) != (int *)0x0)) {
          uVar4 = (**(code **)(**(int **)((int)this + 0x704) + 0x14))(param_1,pvVar3);
          bVar5 = (char)uVar4 == '\0';
          goto LAB_6768719e;
        }
        pvVar3 = (void *)(**(code **)(*param_2 + 0x34))(pvVar3);
      } while (pvVar3 != (void *)0x0);
    }
    *(undefined4 *)((int)param_1 + 0x14) = 0;
    *(undefined4 *)((int)param_1 + 4) = 0;
    *(undefined4 *)((int)param_1 + 8) = 0;
    uVar4 = 1;
  }
  return uVar4;
}



// Function: FUN_67687264 at 67687264

uint __thiscall FUN_67687264(void *this,void *param_1,int *param_2)

{
  int iVar1;
  char cVar2;
  void *pvVar3;
  uint uVar4;
  undefined4 uVar5;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  bool bVar6;
  
  pvVar3 = (void *)(**(code **)(*param_2 + 0x2c))();
  if (pvVar3 != (void *)0x0) {
    if (pvVar3 == (void *)0x0) {
      uVar4 = FUN_6767ca9c(param_1,999,0x4000000);
LAB_676873c3:
      return uVar4 & 0xffffff00;
    }
    do {
      *(undefined4 *)((int)param_1 + 4) = 0;
      *(undefined4 *)((int)param_1 + 8) = 0;
      *(void **)((int)param_1 + 0x14) = pvVar3;
      iVar1 = *(int *)((int)pvVar3 + 0x4c);
      if (((iVar1 < 1) || (0xf < iVar1)) && ((iVar1 < 100 || (0x7a < iVar1)))) {
        uVar4 = FUN_676873db(this,param_1,pvVar3);
        if ((char)uVar4 == '\0') {
LAB_676873a7:
          bVar6 = *(int *)((int)param_1 + 8) == 0x4000000;
          goto LAB_676873ae;
        }
        cVar2 = FUN_67687423(this,param_1,pvVar3);
        if (cVar2 != '\0') {
          cVar2 = FUN_67687b71(this,param_1,pvVar3);
          uVar4 = CONCAT31(extraout_var_00,cVar2);
          if (cVar2 != '\0') {
            *(undefined1 *)((int)pvVar3 + 0x54) = 1;
            if ((*(int **)((int)this + 0x704) == (int *)0x0) ||
               (uVar4 = (**(code **)(**(int **)((int)this + 0x704) + 0x10))
                                  (param_1,pvVar3,*(undefined4 *)((int)pvVar3 + 0x28),
                                   *(undefined4 *)((int)pvVar3 + 0x2c),
                                   *(undefined4 *)((int)pvVar3 + 0x20),
                                   *(undefined4 *)((int)pvVar3 + 0x24),1), (char)uVar4 != '\0'))
            goto LAB_6768735e;
          }
          goto LAB_676873a7;
        }
        uVar5 = FUN_6768e55d((void *)((int)this + 0x30),'\0',0);
        if ((char)uVar5 == '\0') {
          FUN_6767ca9c(param_1,0x131,0x1000000);
        }
        uVar4 = FUN_6768cddb((int)this + 0x30);
        if (*(int *)((int)param_1 + 8) == 0x4000000) goto LAB_676873c3;
        if (*(int *)((int)pvVar3 + 0x60) != 0) {
          *(int *)((int)param_1 + 0x14) = *(int *)((int)pvVar3 + 0x60);
          *(undefined4 *)((int)param_1 + 4) = 0;
          *(undefined4 *)((int)param_1 + 8) = 0;
          *(undefined4 *)(*(int *)((int)pvVar3 + 0x60) + 0x4c) = 0;
          bVar6 = FUN_6768705e(this,param_1,*(void **)((int)pvVar3 + 0x60));
          uVar4 = CONCAT31(extraout_var,bVar6);
          if (!bVar6) goto LAB_676873c3;
        }
      }
      else {
        if (((iVar1 < 1) || (0xf < iVar1)) || (*(int **)((int)this + 0x704) == (int *)0x0))
        goto LAB_6768735e;
        uVar4 = (**(code **)(**(int **)((int)this + 0x704) + 0x14))(param_1,pvVar3);
        bVar6 = (char)uVar4 == '\0';
LAB_676873ae:
        if (bVar6) goto LAB_676873c3;
      }
LAB_6768735e:
      pvVar3 = (void *)(**(code **)(*param_2 + 0x34))(pvVar3);
    } while (pvVar3 != (void *)0x0);
  }
  *(undefined4 *)((int)param_1 + 0x14) = 0;
  *(undefined4 *)((int)param_1 + 4) = 0;
  *(undefined4 *)((int)param_1 + 8) = 0;
  return 1;
}



// Function: FUN_676873db at 676873db

uint __thiscall FUN_676873db(void *this,void *param_1,void *param_2)

{
  uint uVar1;
  
  if ((*(byte *)((int)param_2 + 0x14) >> 3 & 1) == 0) {
    uVar1 = FUN_6767ca9c(param_1,999,0x4000000);
    uVar1 = uVar1 & 0xffffff00;
  }
  else {
    FUN_6768e50a((void *)((int)this + 0x30),0);
    uVar1 = FUN_67687c45(this,param_1,param_2,1,0xf);
  }
  return uVar1;
}



// Function: FUN_67687423 at 67687423

undefined1 __thiscall FUN_67687423(void *this,void *param_1,void *param_2)

{
  void *this_00;
  char cVar1;
  undefined4 uVar2;
  int iVar3;
  undefined4 *puVar4;
  uint uVar5;
  undefined1 uVar6;
  bool bVar7;
  byte *pbVar8;
  undefined4 local_154 [8];
  undefined4 local_134 [55];
  undefined4 local_58 [8];
  undefined4 local_38;
  undefined1 local_34 [4];
  undefined4 uStack_30;
  undefined4 uStack_2c;
  undefined4 uStack_28;
  void *local_24;
  DWORD local_20;
  uint local_1c;
  int local_18;
  void *local_14;
  uint local_10;
  int local_c;
  undefined4 *local_8;
  
  this_00 = param_2;
  uVar6 = 0;
  local_24 = this;
  if (*(int *)((int)this + 0x728) == 0) {
    FUN_6767ca9c(param_1,999,0x4000000);
    return 0;
  }
  if ((*(byte *)((int)param_2 + 0x34) & 0x18) != 0) {
    FUN_6767d4d0(param_2,(LPCSTR)0x0,'\x01');
    FUN_67689c05(this_00,0,0);
    return 1;
  }
  if ((*(int **)((int)this + 0x704) != (int *)0x0) &&
     (cVar1 = (**(code **)(**(int **)((int)this + 0x704) + 0x10))(param_1,param_2,0,0,0,0,0),
     cVar1 == '\0')) {
    return 0;
  }
  FUN_6767fe12(local_58,*(undefined4 *)((int)this + 0x704));
  uVar2 = FUN_6767fe90(local_58,param_1,(int)this_00);
  if ((char)uVar2 != '\0') {
    iVar3 = FUN_676ae2a4(*(short **)((int)this_00 + 0x170));
    if ((iVar3 != 0) && (*(int *)((int)this_00 + 0x28) == 0 && *(int *)((int)this_00 + 0x2c) == 0))
    {
      FUN_67689c05(this_00,0,0);
      FUN_6767d4d0(this_00,(LPCSTR)0x0,'\x01');
    }
    FUN_6767e702(local_134);
    local_10 = 0;
    local_c = 0;
    local_1c = 0;
    local_18 = 0;
    FUN_6767e81f(local_134,(uint)*(ushort *)((int)this_00 + 0x16));
    FUN_6767e856(local_134,*(int *)((int)this + 0x72c));
    if ((*(byte *)((int)this_00 + 0x14) & 1) != 0) {
      puVar4 = FUN_6767d0b1(this_00,local_154);
      uVar5 = FUN_6768774f((int)puVar4);
      *(undefined1 *)((int)this_00 + 0x55) = 1;
      uStack_30 = 0;
      uStack_2c = 0;
      uStack_28 = 0;
      local_38 = *(undefined4 *)((int)this_00 + 0x17c);
      local_34 = (undefined1  [4])(uVar5 & 0xffff);
      iVar3 = FUN_6767e8a9(local_134,&local_38);
      if ((999 < iVar3) && (iVar3 = FUN_6767e8a9(local_134,&local_38), iVar3 < 0x3ef)) {
        FUN_6767ca9c(param_1,0x6a,0x2000000);
LAB_67687599:
        FUN_6767e796(local_134);
        FUN_6767fe58(local_58);
        return 0;
      }
      FUN_6767e890(local_134,1);
      uVar2 = FUN_6768d357((void *)((int)local_24 + 0x30),param_1,(undefined4 *)(local_34 + 2),0xc,1
                          );
      if ((char)uVar2 == '\0') goto LAB_67687599;
      local_10 = 0xc;
      local_c = 0;
      this = local_24;
    }
    param_2 = (void *)CONCAT13(1,param_2._0_3_);
    local_20 = 0;
    local_8 = (undefined4 *)0x0;
    local_14 = (void *)0x0;
LAB_676875f2:
    do {
      uVar2 = FUN_6767ffce(local_58,param_1,*(undefined4 **)((int)this + 0x728),0x8000,&local_20,
                           (undefined1 *)((int)&param_2 + 3));
      uVar6 = 0;
      if ((char)uVar2 == '\0') {
LAB_67687720:
        FUN_6767ebd6(local_8);
        goto LAB_67687704;
      }
      bVar7 = CARRY4(local_1c,local_20);
      local_1c = local_1c + local_20;
      local_18 = local_18 + (uint)bVar7;
      if (local_20 == 0) {
        if (param_2._3_1_ != '\0') goto LAB_676875f2;
        bVar7 = true;
        pbVar8 = (byte *)0x0;
        uVar5 = 0;
      }
      else {
        bVar7 = param_2._3_1_ == '\0';
        pbVar8 = *(byte **)((int)this + 0x728);
        uVar5 = local_20;
      }
      iVar3 = FUN_6767e984(local_134,pbVar8,uVar5,&local_8,&local_14,bVar7);
      if (iVar3 != 0) {
        FUN_6767ebd6(local_8);
        FUN_6767ca9c(param_1,0x79,0x2000000);
        goto LAB_67687704;
      }
      bVar7 = CARRY4(local_10,(uint)local_14);
      local_10 = local_10 + (int)local_14;
      local_c = local_c + (uint)bVar7;
      if ((((param_2._3_1_ != '\0') && (*(int **)((int)this + 0x704) != (int *)0x0)) &&
          (cVar1 = (**(code **)(**(int **)((int)this + 0x704) + 0x10))
                             (param_1,this_00,local_1c,local_18,local_10,local_c,0), cVar1 == '\0'))
         || ((local_14 != (void *)0x0 &&
             (uVar2 = FUN_6768d357((void *)((int)this + 0x30),param_1,local_8,(uint)local_14,1),
             (char)uVar2 == '\0')))) goto LAB_67687720;
      FUN_6767ebd6(local_8);
      local_8 = (undefined4 *)0x0;
    } while (param_2._3_1_ != '\0');
    FUN_6767ebd6((LPVOID)0x0);
    *(uint *)((int)this_00 + 0x28) = local_1c;
    *(int *)((int)this_00 + 0x2c) = local_18;
    *(uint *)((int)this_00 + 0x20) = local_10;
    local_8 = (undefined4 *)0x0;
    *(int *)((int)this_00 + 0x24) = local_c;
    uVar2 = FUN_6767e980((int)local_134);
    *(undefined4 *)((int)this_00 + 0x18) = uVar2;
    uVar6 = 1;
LAB_67687704:
    FUN_6767e796(local_134);
  }
  FUN_6767fe58(local_58);
  return uVar6;
}



// Function: FUN_6768774f at 6768774f

undefined4 __fastcall FUN_6768774f(int param_1)

{
  _FILETIME local_14;
  WORD local_c [4];
  
  local_14.dwLowDateTime = 0;
  local_c[2] = 0;
  local_c[3] = 0;
  local_c[0] = 0;
  local_c[1] = 0;
  local_14.dwHighDateTime = 0;
  SystemTimeToFileTime((SYSTEMTIME *)(param_1 + 8),&local_14);
  FileTimeToDosDateTime(&local_14,local_c + 2,local_c);
  return CONCAT22(local_c[2],local_c[0]);
}



// Function: FUN_67687795 at 67687795

undefined1 __thiscall FUN_67687795(void *this,void *param_1,undefined4 *param_2,int param_3)

{
  undefined4 *puVar1;
  char cVar2;
  ushort uVar3;
  undefined4 uVar4;
  int iVar5;
  uint uVar6;
  uint3 uVar7;
  undefined1 uVar8;
  bool bVar9;
  undefined4 local_134 [55];
  undefined4 local_58 [9];
  undefined4 local_34;
  undefined4 local_30;
  undefined4 uStack_2c;
  undefined4 uStack_28;
  undefined4 uStack_24;
  uint local_20;
  uint local_1c;
  undefined4 *local_18;
  uint local_14;
  int local_10;
  uint local_c;
  uint local_8;
  
  puVar1 = param_2;
  if (*(int *)((int)this + 0x728) == 0) {
    FUN_6767ca9c(param_1,999,0x4000000);
    return 0;
  }
  if ((*(int **)((int)this + 0x704) != (int *)0x0) &&
     (cVar2 = (**(code **)(**(int **)((int)this + 0x704) + 0x40))(param_1,param_2), cVar2 == '\0'))
  {
    return 0;
  }
  if ((0 < (int)puVar1[0x13]) && ((int)puVar1[0x13] < 0x10)) {
    if ((*(int **)((int)this + 0x704) != (int *)0x0) &&
       (cVar2 = (**(code **)(**(int **)((int)this + 0x704) + 0x14))(param_1,puVar1), cVar2 == '\0'))
    {
      return 0;
    }
    return 1;
  }
  FUN_6767e702(local_134);
  local_c = puVar1[8];
  local_8 = puVar1[9];
  if ((local_c != 0 || local_8 != 0) && ((*(byte *)(puVar1 + 5) & 1) != 0)) {
    local_34 = 0;
    uStack_2c = 0;
    uStack_28 = 0;
    uStack_24 = 0;
    if ((*(byte *)(puVar1 + 5) >> 3 & 1) == 0) {
      uVar3 = (ushort)((uint)puVar1[6] >> 0x10);
    }
    else {
      uVar3 = *(ushort *)(puVar1 + 0x17);
    }
    local_30 = (uint)uVar3;
    uVar4 = FUN_6768d2cc((void *)((int)this + 0x30),param_1,(LPVOID)((int)&local_30 + 2),0xc);
    if ((char)uVar4 == '\0') goto LAB_67687b08;
    param_2 = (undefined4 *)CONCAT13(1,param_2._0_3_);
    do {
      local_34 = puVar1[0x5f];
      iVar5 = FUN_6767e8a9(local_134,&local_34);
      if ((999 < iVar5) && (iVar5 < 0x3ef)) {
        if (iVar5 == 0x3ec) {
          if ((*(int **)((int)this + 0x704) != (int *)0x0) &&
             (cVar2 = (**(code **)(**(int **)((int)this + 0x704) + 0x28))
                                (param_1,puVar1,(int)&param_2 + 3), cVar2 == '\0'))
          goto LAB_67687b08;
          if (param_2._3_1_ != '\0') goto LAB_676878ec;
        }
        FUN_6767ca9c(param_1,0x6a,0x2000000);
        goto LAB_67687b08;
      }
      FUN_6767e890(local_134,1);
      bVar9 = 0xb < local_c;
      local_c = local_c - 0xc;
      local_8 = (local_8 - 1) + (uint)bVar9;
      param_2 = (undefined4 *)((uint)param_2 & 0xffffff);
LAB_676878ec:
    } while (param_2._3_1_ != '\0');
  }
  uVar6 = local_c;
  if ((*(int **)((int)this + 0x704) != (int *)0x0) &&
     (cVar2 = (**(code **)(**(int **)((int)this + 0x704) + 0x10))(param_1,puVar1,0,0,0,0,0),
     cVar2 == '\0')) {
    uVar8 = 0;
    goto LAB_67687b5d;
  }
  FUN_6767fb3c(local_58,*(undefined4 *)((int)this + 0x704));
  if ((param_3 == 1) || (param_3 == 100)) {
    uVar8 = 0;
  }
  else {
    uVar8 = 1;
  }
  uVar4 = FUN_6767fbbb(local_58,param_1,(int)puVar1,uVar8);
  if ((char)uVar4 == '\0') {
LAB_6768795f:
    uVar8 = 0;
  }
  else {
    local_14 = 0;
    local_10 = 0;
    local_1c = local_8;
    local_20 = uVar6;
    if (uVar6 != 0 || local_8 != 0) {
      FUN_6767e81f(local_134,(uint)*(ushort *)((int)puVar1 + 0x16));
      param_2 = (undefined4 *)0x0;
      local_18 = (undefined4 *)0x0;
      do {
        uVar6 = 0x8000;
        if ((local_8 == 0) && (local_c < 0x8000)) {
          uVar6 = local_c;
        }
        bVar9 = local_c < uVar6;
        local_c = local_c - uVar6;
        local_8 = local_8 - bVar9;
        uVar4 = FUN_6768d2cc((void *)((int)this + 0x30),param_1,*(LPVOID *)((int)this + 0x728),uVar6
                            );
        if ((char)uVar4 == '\0') {
LAB_67687aba:
          FUN_6767ebd6(param_2);
          goto LAB_67687b00;
        }
        uVar6 = FUN_6767ea8d(local_134,*(undefined4 **)((int)this + 0x728),uVar6,&param_2,
                             (uint *)&local_18,local_c == 0 && local_8 == 0);
        if (uVar6 != 0) {
          FUN_6767ebd6(param_2);
          iVar5 = 0x7a;
          goto LAB_67687af8;
        }
        bVar9 = CARRY4(local_14,(uint)local_18);
        local_14 = local_14 + (int)local_18;
        local_10 = local_10 + (uint)bVar9;
        if ((((local_8 != 0) || (local_c != 0)) && (*(int **)((int)this + 0x704) != (int *)0x0)) &&
           (cVar2 = (**(code **)(**(int **)((int)this + 0x704) + 0x10))
                              (param_1,puVar1,local_20 - local_c,
                               (local_1c - local_8) - (uint)(local_20 < local_c),local_14,local_10,0
                              ), cVar2 == '\0')) goto LAB_67687aba;
        if (param_2 != (undefined4 *)0x0) {
          if ((param_3 != 100) && (local_18 != (undefined4 *)0x0)) {
            uVar7 = (uint3)((local_c | local_8) >> 8);
            if ((local_c | local_8) == 0) {
              iVar5 = CONCAT31(uVar7,1);
            }
            else {
              iVar5 = (uint)uVar7 << 8;
            }
            uVar4 = FUN_6767fca5(local_58,param_1,param_2,local_18,iVar5);
            if ((char)uVar4 == '\0') goto LAB_67687aba;
          }
          FUN_6767ebd6(param_2);
          param_2 = (undefined4 *)0x0;
        }
      } while (local_c != 0 || local_8 != 0);
      FUN_6767ebd6(param_2);
      iVar5 = FUN_6767e980((int)local_134);
      if (iVar5 == puVar1[6]) {
        if ((local_14 == puVar1[10]) && (local_10 == puVar1[0xb])) goto LAB_67687b17;
        iVar5 = 0x6c;
      }
      else {
        iVar5 = 0x6b;
      }
LAB_67687af8:
      FUN_6767ca9c(param_1,iVar5,0x2000000);
LAB_67687b00:
      FUN_6767fb83(local_58);
LAB_67687b08:
      FUN_6767e796(local_134);
      return 0;
    }
LAB_67687b17:
    uVar4 = FUN_6767fc47(local_58,param_1);
    if (((char)uVar4 == '\0') ||
       ((*(int **)((int)this + 0x704) != (int *)0x0 &&
        (cVar2 = (**(code **)(**(int **)((int)this + 0x704) + 0x10))
                           (param_1,puVar1,puVar1[8],puVar1[9],local_14,local_10,1), cVar2 == '\0'))
       )) goto LAB_6768795f;
    uVar8 = 1;
  }
  FUN_6767fb83(local_58);
LAB_67687b5d:
  FUN_6767e796(local_134);
  return uVar8;
}



// Function: FUN_67687b71 at 67687b71

undefined1 __thiscall FUN_67687b71(void *this,void *param_1,void *param_2)

{
  undefined1 uVar1;
  undefined4 uVar2;
  
  if (*(char *)((int)param_2 + 0x55) == '\0') {
    uVar2 = FUN_6768e55d((void *)((int)this + 0x30),'\x01',1);
    if ((char)uVar2 != '\0') {
      *(ushort *)((int)param_2 + 0x14) = *(ushort *)((int)param_2 + 0x14) & 0xfff7;
      uVar2 = FUN_67687c45(this,param_1,param_2,0,0xf);
      FUN_6768e55d((void *)((int)this + 0x30),'\0',0);
      return (char)uVar2;
    }
  }
  uVar1 = FUN_67687db6(this,param_1,param_2);
  return uVar1;
}



// Function: FUN_67687bce at 67687bce

bool __thiscall FUN_67687bce(void *this,void *param_1,undefined4 *param_2)

{
  undefined4 *this_00;
  char cVar1;
  undefined4 uVar2;
  
  this_00 = param_2;
  if ((*(byte *)(param_2 + 5) >> 3 & 1) != 0) {
    if ((((param_2[0xb] == 0) && (param_2[10] != -1)) && (param_2[9] == 0)) && (param_2[8] != -1)) {
      cVar1 = '\0';
    }
    else {
      cVar1 = '\x01';
    }
    uVar2 = FUN_67686d27(this,param_1,(int *)&param_2,cVar1);
    if ((((char)uVar2 != '\0') && (param_2 != (undefined4 *)0x0)) &&
       (FUN_676894b0(this_00,param_1,(int)param_2), param_2 != (undefined4 *)0x0)) {
      (**(code **)*param_2)(1);
    }
  }
  uVar2 = FUN_6767e600((int)param_1);
  return (bool)('\x01' - ((char)uVar2 != '\0'));
}



// Function: FUN_67687c45 at 67687c45

uint __thiscall
FUN_67687c45(void *this,void *param_1,void *param_2,undefined4 param_3,undefined4 param_4)

{
  void *this_00;
  void *this_01;
  bool bVar1;
  uint uVar2;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  void *local_c;
  void *local_8;
  
  this_01 = param_2;
  local_c = this;
  local_8 = this;
  if (param_2 == (void *)0x0) {
    uVar2 = FUN_6767ca9c(param_1,999,0x4000000);
  }
  else {
    FUN_6768a059(*(int *)((int)this + 0x6f8));
    uVar2 = FUN_676896f7(this_01,param_1,*(int *)((int)this + 0x6f8),(char)param_3,param_4);
    if ((char)uVar2 != '\0') {
      this_00 = (void *)((int)this + 0x30);
      bVar1 = FUN_6768e612(this_00,param_1,'\x01');
      uVar2 = CONCAT31(extraout_var,bVar1);
      if ((bVar1) &&
         (uVar2 = FUN_6768a156(*(void **)((int)this + 0x6f8),param_1,(int)this,'\x01'),
         (char)uVar2 != '\0')) {
        bVar1 = FUN_6768e612(this_00,param_1,'\0');
        uVar2 = CONCAT31(extraout_var_00,bVar1);
        if (bVar1) {
          FUN_6768e5d6(this_00,&param_1,&local_c,(undefined4 *)0x0);
          *(void **)((int)this_01 + 0x38) = param_1;
          *(void **)((int)this_01 + 0x40) = local_c;
          *(void **)((int)this_01 + 0x44) = local_8;
          return CONCAT31((int3)((uint)local_8 >> 8),1);
        }
      }
    }
  }
  return uVar2 & 0xffffff00;
}



// Function: FUN_67687cf8 at 67687cf8

uint __thiscall FUN_67687cf8(void *this,void *param_1,void *param_2,undefined4 param_3)

{
  void *this_00;
  void *pvVar1;
  bool bVar2;
  uint uVar3;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  undefined3 extraout_var_01;
  undefined3 uVar4;
  void *local_c;
  void *local_8;
  
  local_c = this;
  local_8 = this;
  if (param_2 == (void *)0x0) {
    uVar3 = FUN_6767ca9c(param_1,999,0x4000000);
  }
  else {
    FUN_6767c87e(*(int *)((int)this + 0x6fc));
    pvVar1 = param_1;
    uVar3 = FUN_67689550(param_2,param_1,*(int *)((int)this + 0x6fc),param_3);
    if ((char)uVar3 != '\0') {
      this_00 = (void *)((int)this + 0x30);
      bVar2 = FUN_6768e612(this_00,pvVar1,'\x01');
      uVar3 = CONCAT31(extraout_var,bVar2);
      if ((bVar2) &&
         (uVar3 = FUN_6767c9e8(*(void **)((int)this + 0x6fc),pvVar1,(int)this), (char)uVar3 != '\0')
         ) {
        bVar2 = FUN_6768e612(this_00,pvVar1,'\0');
        uVar4 = extraout_var_00;
        if (bVar2) {
          param_2 = (void *)0x0;
          local_c = (void *)0x0;
          local_8 = (void *)0x0;
          param_1 = (void *)0x0;
          FUN_6768e5d6(this_00,&param_2,&local_c,&param_1);
          FUN_67681bdd(*(void **)((int)this + 0x700),(uint)param_2,local_c,(int)local_8,
                       (uint)param_1);
          uVar4 = extraout_var_01;
        }
        return CONCAT31(uVar4,1);
      }
    }
  }
  return uVar3 & 0xffffff00;
}



// Function: FUN_67687db6 at 67687db6

undefined1 __thiscall FUN_67687db6(void *this,void *param_1,void *param_2)

{
  bool bVar1;
  char cVar2;
  uint uVar3;
  undefined1 uVar4;
  undefined4 local_1c [6];
  
  if (param_2 == (void *)0x0) {
    FUN_6767ca9c(param_1,999,0x4000000);
    return 0;
  }
  FUN_6768010d(local_1c);
  bVar1 = FUN_67689840(param_2,param_1,(int)local_1c);
  if (bVar1) {
    bVar1 = FUN_6768e612((void *)((int)this + 0x30),param_1,'\x01');
    if (bVar1) {
      if ((((*(int *)((int)param_2 + 0x2c) == 0) && (*(int *)((int)param_2 + 0x28) != -1)) &&
          (*(int *)((int)param_2 + 0x24) == 0)) && (*(int *)((int)param_2 + 0x20) != -1)) {
        cVar2 = '\0';
      }
      else {
        cVar2 = '\x01';
      }
      uVar3 = FUN_676801b4(local_1c,param_1,(int)this,cVar2);
      if (((char)uVar3 != '\0') &&
         (bVar1 = FUN_6768e612((void *)((int)this + 0x30),param_1,'\0'), bVar1)) {
        uVar4 = 1;
        goto LAB_67687e5a;
      }
    }
  }
  uVar4 = 0;
LAB_67687e5a:
  FUN_67680143(local_1c);
  return uVar4;
}



// Function: FUN_67687e6b at 67687e6b

uint __thiscall
FUN_67687e6b(void *this,void *param_1,int *param_2,undefined4 param_3,int *param_4,
            undefined4 param_5)

{
  void *pvVar1;
  uint uVar2;
  
  pvVar1 = (void *)(**(code **)(*param_2 + 0x2c))();
  while( true ) {
    if (pvVar1 == (void *)0x0) {
      *(undefined4 *)((int)param_1 + 0x14) = 0;
      *(undefined4 *)((int)param_1 + 4) = 0;
      *(undefined4 *)((int)param_1 + 8) = 0;
      return 1;
    }
    if (pvVar1 == (void *)0x0) break;
    *(void **)((int)param_1 + 0x14) = pvVar1;
    *(undefined4 *)((int)param_1 + 4) = 0;
    *(undefined4 *)((int)param_1 + 8) = 0;
    if (((*(int *)((int)pvVar1 + 0x4c) == 0) && (*(char *)((int)pvVar1 + 0x54) != '\0')) &&
       (uVar2 = FUN_67687cf8(this,param_1,pvVar1,param_5), (char)uVar2 == '\0')) goto LAB_67687f08;
    if (*(int *)((int)this + 0x704) != 0) {
      *param_4 = *param_4 + 1;
      uVar2 = (**(code **)(**(int **)((int)this + 0x704) + 0x58))(param_1,*param_4,param_3);
      if ((char)uVar2 == '\0') goto LAB_67687f08;
    }
    pvVar1 = (void *)(**(code **)(*param_2 + 0x34))(pvVar1);
  }
  uVar2 = FUN_6767ca9c(param_1,999,0x4000000);
LAB_67687f08:
  return uVar2 & 0xffffff00;
}



// Function: FUN_67687f0c at 67687f0c

bool __thiscall FUN_67687f0c(void *this,void *param_1)

{
  LPCWSTR lpWideCharStr;
  char cVar1;
  bool bVar2;
  int iVar3;
  undefined4 uVar4;
  uint uVar5;
  short *psVar6;
  LPCSTR pCVar7;
  LPCWSTR local_8;
  
  if (*(int *)((int)this + 0x704) != 0) {
    local_8 = (LPCWSTR)0x0;
    pCVar7 = *(LPCSTR *)(*(int *)((int)this + 0x700) + 0x5c);
    if (pCVar7 != (LPCSTR)0x0) {
      if (pCVar7 != (LPCSTR)0x0) {
        psVar6 = (short *)&stack0xffffffe4;
        iVar3 = lstrlenA(pCVar7);
        FUN_676b06a0();
        MultiByteToWideChar(0,0,pCVar7,-1,(LPWSTR)&stack0xffffffe4,iVar3 + 1);
      }
      else {
        psVar6 = (short *)0x0;
      }
      iVar3 = FUN_676ae2a4(psVar6);
      local_8 = (LPCWSTR)operator_new(iVar3 * 2 + 2);
      if (local_8 == (LPCWSTR)0x0) {
        FUN_6767ca9c(param_1,0x1ff,0x4000000);
        return false;
      }
      FUN_676ae1fc(local_8,psVar6);
    }
    cVar1 = (**(code **)(**(int **)((int)this + 0x704) + 0xc))(param_1,&local_8,1);
    if ((cVar1 == '\0') && (iVar3 = FUN_6767e5db((int)param_1), iVar3 != 0x206)) {
      if (local_8 == (LPCWSTR)0x0) {
        return false;
      }
      FUN_676b0bb3((undefined *)local_8);
      return false;
    }
    lpWideCharStr = local_8;
    if (local_8 == (LPCWSTR)0x0) {
      pCVar7 = (LPCSTR)0x0;
    }
    else {
      pCVar7 = &stack0xffffffe4;
      iVar3 = lstrlenW(local_8);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,lpWideCharStr,-1,&stack0xffffffe4,iVar3 * 2 + 2,(LPCSTR)0x0,
                          (LPBOOL)0x0);
      FUN_676b0bb3((undefined *)local_8);
    }
    FUN_67681c98(*(void **)((int)this + 0x700),pCVar7);
  }
  uVar4 = FUN_6768686a(*(int *)((int)this + 0x700));
  if ((char)uVar4 != '\0') {
    iVar3 = FUN_67683c22();
    uVar5 = FUN_67683dbd();
    if ((iVar3 <= (int)uVar5) || (uVar5 = FUN_67683dee(), iVar3 <= (int)uVar5)) {
      bVar2 = FUN_6768e612((void *)((int)this + 0x30),param_1,'\x01');
      if (!bVar2) {
        return false;
      }
      uVar5 = FUN_67681f15(*(void **)((int)this + 0x700),param_1,(int)this);
      if ((char)uVar5 == '\0') {
        return false;
      }
      bVar2 = FUN_6768e612((void *)((int)this + 0x30),param_1,'\0');
      if (!bVar2) {
        return false;
      }
    }
  }
  bVar2 = FUN_6768e612((void *)((int)this + 0x30),param_1,'\x01');
  if (bVar2) {
    uVar4 = FUN_6768686a(*(int *)((int)this + 0x700));
    if ((char)uVar4 != '\0') {
      local_8 = (LPCWSTR)FUN_67683c22();
      uVar5 = FUN_67683dbd();
      if ((((int)local_8 <= (int)uVar5) || (uVar5 = FUN_67683dee(), (int)local_8 <= (int)uVar5)) &&
         (uVar5 = FUN_67681e7b(*(void **)((int)this + 0x700),param_1,(int)this), (char)uVar5 == '\0'
         )) {
        return false;
      }
    }
    uVar4 = FUN_67681d96(*(void **)((int)this + 0x700),param_1,(int)this);
    if ((char)uVar4 != '\0') {
      bVar2 = FUN_6768e612((void *)((int)this + 0x30),param_1,'\0');
      return bVar2;
    }
  }
  return false;
}



// Function: FUN_67688125 at 67688125

undefined1 FUN_67688125(void *param_1,int param_2,void *param_3)

{
  int iVar1;
  char cVar2;
  undefined4 uVar3;
  undefined1 uVar4;
  int iVar5;
  uint uVar6;
  bool bVar7;
  undefined **local_20;
  undefined4 *local_1c;
  undefined1 local_18;
  uint local_14;
  int local_10;
  int local_c;
  uint local_8;
  
  local_1c = (undefined4 *)0x0;
  local_18 = 0;
  local_20 = &PTR_FUN_676b99c4;
  FUN_6767e657(&local_20,0x8000);
  local_8 = 0x8000;
  if (local_1c == (undefined4 *)0x0) {
    FUN_6767ca9c(param_1,0x1ff,0x4000000);
  }
  else {
    local_14 = 0;
    local_10 = 0;
    iVar5 = *(int *)(param_2 + 0x24);
    uVar6 = *(uint *)(param_2 + 0x20);
    iVar1 = local_c;
    do {
      if ((iVar5 == 0) && (uVar6 == 0)) {
        uVar4 = 1;
        goto LAB_67688231;
      }
      if ((iVar5 == 0) && (uVar6 < local_8)) {
        local_8 = uVar6;
      }
      local_c = iVar1;
      if (((*(int **)(iVar1 + 0x704) != (int *)0x0) &&
          (cVar2 = (**(code **)(**(int **)(iVar1 + 0x704) + 0x10))
                             (param_1,param_2,local_14,local_10,local_14,local_10,0), cVar2 == '\0')
          ) || (uVar3 = FUN_6768d2cc(param_3,param_1,local_1c,local_8), (char)uVar3 == '\0')) break;
      uVar3 = FUN_6768d357((int *)(iVar1 + 0x30),param_1,local_1c,local_8,1);
      if ((char)uVar3 == '\0') break;
      bVar7 = uVar6 < local_8;
      uVar6 = uVar6 - local_8;
      iVar5 = iVar5 - (uint)bVar7;
      bVar7 = CARRY4(local_14,local_8);
      local_14 = local_14 + local_8;
      local_10 = local_10 + (uint)bVar7;
      cVar2 = (**(code **)(*(int *)(iVar1 + 0x30) + 0x18))(param_1);
      iVar1 = local_c;
    } while (cVar2 != '\0');
  }
  uVar4 = 0;
LAB_67688231:
  local_20 = &PTR_FUN_676b99c4;
  FUN_6767e692((int)&local_20);
  return uVar4;
}



// Function: FUN_67688249 at 67688249

undefined4 __thiscall
FUN_67688249(void *this,undefined4 param_1,int *param_2,int *param_3,char param_4,char param_5)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  
  piVar1 = (int *)(**(code **)(*param_3 + 0x3c))();
  if ((piVar1 != (int *)0x0) &&
     (piVar1 = (int *)(**(code **)(*param_2 + 0x3c))(), piVar1 != (int *)0x0)) {
    for (piVar1 = (int *)(**(code **)(*param_2 + 0x2c))(); piVar1 != (int *)0x0;
        piVar1 = (int *)(**(code **)(*param_2 + 0x34))(piVar1)) {
      if ((piVar1[0x13] == 0) && (iVar2 = FUN_67689ce0(param_3,piVar1), iVar2 != 0)) {
        if (param_5 == '\0') {
          if ((param_4 == '\0') || (*(int **)((int)this + 0x704) == (int *)0x0)) {
            piVar1[0x13] = 0xd;
          }
          else {
            uVar3 = (**(code **)(**(int **)((int)this + 0x704) + 0x38))(param_1,iVar2,piVar1);
            if ((char)uVar3 == '\0') {
              return uVar3 & 0xffffff00;
            }
          }
        }
        else {
          *(undefined4 *)(iVar2 + 0x4c) = 0xf;
        }
      }
    }
  }
  return CONCAT31((int3)((uint)piVar1 >> 8),1);
}



// Function: FUN_6768831f at 6768831f

undefined4 __thiscall
FUN_6768831f(void *this,undefined4 param_1,undefined4 param_2,undefined1 *param_3)

{
  undefined4 in_EAX;
  undefined4 uVar1;
  longlong lVar2;
  
  if (*(char *)((int)this + 0x42d) != '\0') {
    in_EAX = FUN_67681c82(*(void **)((int)this + 0x6d0),param_2);
  }
  *param_3 = 0;
  if (*(int *)((int)this + 0x6d4) == 0) {
    uVar1 = CONCAT31((int3)((uint)in_EAX >> 8),1);
  }
  else {
    lVar2 = FUN_6768e217((LPCWSTR)((int)this + 0x210));
    uVar1 = (**(code **)(**(int **)((int)this + 0x6d4) + 0x44))
                      (param_1,param_2,param_3,lVar2,(int)this + 0x420);
  }
  return uVar1;
}



// Function: FUN_676883d2 at 676883d2

void __thiscall FUN_676883d2(void *this,int param_1)

{
  if (*(int *)((int)this + 8) == 0x2000000) {
    if ((*(int *)((int)this + 4) == *(int *)((int)this + 0xc)) &&
       (*(int *)((int)this + 0xc) = param_1, param_1 == 0)) {
      *(undefined4 *)((int)this + 0x10) = 0;
    }
    *(int *)((int)this + 4) = param_1;
    if (param_1 == 0) {
      *(undefined4 *)((int)this + 8) = 0;
    }
  }
  return;
}



// Function: FUN_67688400 at 67688400

void __fastcall FUN_67688400(int *param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  undefined4 *local_8;
  
  local_8 = (undefined4 *)0x0;
  while (uVar2 = FUN_6768881a(param_1 + 4,&local_8), (char)uVar2 != '\0') {
    if (local_8 != (undefined4 *)0x0) {
      (**(code **)*local_8)(1);
    }
  }
  puVar3 = (undefined4 *)(**(code **)(*param_1 + 0x2c))();
  while (puVar1 = puVar3, puVar1 != (undefined4 *)0x0) {
    puVar3 = (undefined4 *)(**(code **)(*param_1 + 0x34))(puVar1);
    if (puVar1 != (undefined4 *)0x0) {
      (**(code **)*puVar1)(1);
    }
  }
  return;
}



// Function: FUN_6768845c at 6768845c

undefined4 __thiscall FUN_6768845c(void *this,short *param_1,int *param_2,char param_3)

{
  char cVar1;
  uint in_EAX;
  undefined4 uVar2;
  undefined *puVar3;
  void *pvVar4;
  int iVar5;
  int *piVar6;
  undefined4 *puVar7;
  int *piVar8;
  int iVar9;
  bool bVar10;
  undefined1 local_38 [4];
  int *local_34;
  undefined4 local_30;
  undefined4 local_2c;
  int local_28;
  undefined **local_24;
  int *local_20;
  undefined4 local_1c;
  undefined4 local_18;
  int local_14;
  void *local_10;
  int *local_c;
  char local_5;
  
  local_10 = this;
  if (*(char *)((int)this + 0x28) != '\0') {
    if (param_3 == '\0') {
LAB_6768860e:
      return in_EAX & 0xffffff00;
    }
    uVar2 = FUN_676aed55(this,param_2);
    goto LAB_67688704;
  }
  puVar7 = (undefined4 *)0x0;
  if ((param_2[3] != 0) || (in_EAX = (**(code **)(*param_2 + 0xc))(), (char)in_EAX != '\0'))
  goto LAB_6768860e;
  puVar3 = *(undefined **)((int)this + 0x14);
  if ((puVar3 == (undefined *)0x0) &&
     (puVar3 = *(undefined **)((int)this + 0x20), puVar3 == (undefined *)0x0)) {
    puVar3 = &DAT_676c5658;
  }
  local_24 = &PTR_FUN_676b9a34;
  FUN_67681a57(&local_24,(int)puVar3);
  puVar3 = *(undefined **)((int)this + 0x20);
  local_5 = '\0';
  if (puVar3 == (undefined *)0x0) {
    puVar3 = &DAT_676c5658;
  }
  if (local_14 == *(int *)(puVar3 + 0x10)) {
    if (local_14 == 0) {
      bVar10 = local_20 == *(int **)(puVar3 + 4);
      goto LAB_676884f1;
    }
LAB_676884f5:
    pvVar4 = operator_new(0x14);
    if (pvVar4 != (void *)0x0) {
      puVar7 = FUN_676ae0e5(pvVar4,param_1);
    }
    FUN_67688976((void *)((int)this + 0x10),puVar7);
    puVar7[3] = this;
    FUN_676aebd5(puVar7,*(int *)((int)this + 4));
    puVar3 = *(undefined **)((int)this + 0x14);
    if ((puVar3 == (undefined *)0x0) &&
       (puVar3 = *(undefined **)((int)this + 0x20), puVar3 == (undefined *)0x0)) {
      puVar3 = &DAT_676c5658;
    }
    local_20 = *(int **)(puVar3 + 4);
    local_1c = *(undefined4 *)(puVar3 + 8);
    local_18 = *(undefined4 *)(puVar3 + 0xc);
    local_14 = *(int *)(puVar3 + 0x10);
  }
  else {
    bVar10 = false;
LAB_676884f1:
    if (bVar10) goto LAB_676884f5;
    iVar9 = (**(code **)(*local_20 + 8))(param_1);
    if (iVar9 < 1) {
      FUN_67688865(local_38,(int)&local_24);
      while( true ) {
        puVar3 = *(undefined **)((int)this + 0x20);
        if (puVar3 == (undefined *)0x0) {
          puVar3 = &DAT_676c5658;
        }
        pvVar4 = (void *)FUN_6768888c((int)local_38);
        uVar2 = FUN_676888b4(pvVar4,(int)puVar3);
        if (((char)uVar2 == '\0') || (iVar9 = (**(code **)(*local_34 + 8))(param_1), 0 < iVar9))
        break;
        local_20 = local_34;
        local_1c = local_30;
        local_18 = local_2c;
        local_14 = local_28;
      }
    }
    else {
      local_5 = '\x01';
    }
  }
  bVar10 = false;
  iVar9 = 0;
  if (local_5 == '\0') {
    piVar6 = (int *)local_20[2];
    local_c = local_20;
    if ((int *)local_20[2] != (int *)0x0) {
      do {
        piVar8 = piVar6;
        cVar1 = (**(code **)(*piVar8 + 0xc))();
        if (cVar1 != '\0') break;
        iVar5 = (**(code **)(*piVar8 + 8))(param_1);
        if (iVar5 == 0) {
          in_EAX = 0;
          if (param_3 == '\0') goto LAB_6768860e;
          bVar10 = true;
        }
        else if (0 < iVar5) break;
        iVar9 = iVar9 + 1;
        piVar6 = (int *)piVar8[2];
        local_c = piVar8;
      } while ((int *)piVar8[2] != (int *)0x0);
      if ((!bVar10) && (0xff < iVar9)) {
        pvVar4 = operator_new(0x14);
        if (pvVar4 == (void *)0x0) {
          piVar6 = (int *)0x0;
        }
        else {
          piVar6 = FUN_676ae0e5(pvVar4,param_1);
        }
        pvVar4 = local_10;
        FUN_676887a7((void *)((int)local_10 + 0x10),piVar6,(int)local_20,0);
        piVar6[3] = (int)pvVar4;
        FUN_676aebd5(piVar6,(int)local_c);
        local_c = piVar6;
      }
    }
    param_2[3] = (int)local_10;
    uVar2 = FUN_676aebd5(param_2,(int)local_c);
  }
  else {
    iVar9 = 1;
    piVar6 = (int *)local_20[1];
    local_c = local_20;
    if ((int *)local_20[1] != (int *)0x0) {
      do {
        piVar8 = piVar6;
        cVar1 = (**(code **)(*piVar8 + 0xc))();
        if (cVar1 != '\0') break;
        iVar5 = (**(code **)(*piVar8 + 8))(param_1);
        if (iVar5 == 0) {
          in_EAX = 0;
          if (param_3 == '\0') goto LAB_6768860e;
          goto LAB_6768865a;
        }
        if (iVar5 < 0) break;
        iVar9 = iVar9 + 1;
        piVar6 = (int *)piVar8[1];
        local_c = piVar8;
      } while ((int *)piVar8[1] != (int *)0x0);
      if (0xff < iVar9) {
        pvVar4 = operator_new(0x14);
        if (pvVar4 == (void *)0x0) {
          puVar7 = (undefined4 *)0x0;
        }
        else {
          puVar7 = FUN_676ae0e5(pvVar4,param_1);
        }
        FUN_67688734((void *)((int)local_10 + 0x10),puVar7,(int)local_20,0);
        puVar7[3] = local_10;
        FUN_676aeb7f(puVar7,(int)local_c);
      }
    }
LAB_6768865a:
    param_2[3] = (int)local_10;
    uVar2 = FUN_676aeb7f(param_2,(int)local_c);
  }
LAB_67688704:
  return CONCAT31((int3)((uint)uVar2 >> 8),1);
}



// Function: FUN_6768870d at 6768870d

int __thiscall FUN_6768870d(void *this,undefined4 param_1)

{
  int iVar1;
  
  if (*(char *)((int)this + 0x28) == '\0') {
                    /* WARNING: Load size is inaccurate */
    iVar1 = (**(code **)(*this + 0x44))(param_1);
    if (iVar1 != 0) {
      FUN_676aec28(iVar1);
    }
  }
  else {
    iVar1 = 0;
  }
  return iVar1;
}



// Function: FUN_67688734 at 67688734

uint __thiscall FUN_67688734(void *this,undefined4 param_1,int param_2,int param_3)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  
  puVar2 = (undefined4 *)FUN_67688a04(this,param_2,param_3);
  puVar4 = puVar2;
  if (puVar2 != (undefined4 *)0x0) {
    if (puVar2 == *(undefined4 **)((int)this + 4)) {
      uVar3 = FUN_676888e1(this,param_1);
      return uVar3;
    }
    puVar4 = (undefined4 *)operator_new(0x14);
    if (puVar4 == (undefined4 *)0x0) {
      puVar4 = (undefined4 *)0x0;
    }
    else {
      puVar4[2] = 0;
      puVar4[3] = 0;
      puVar4[4] = 0;
      *puVar4 = &PTR_FUN_676b9a34;
      puVar4[1] = param_1;
    }
    if (puVar4 != (undefined4 *)0x0) {
      iVar1 = puVar2[2];
      puVar4[3] = puVar2;
      puVar4[2] = iVar1;
      *(undefined4 **)(iVar1 + 0xc) = puVar4;
      puVar2[2] = puVar4;
      *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + 1;
      return CONCAT31((int3)((uint)puVar4 >> 8),1);
    }
  }
  return (uint)puVar4 & 0xffffff00;
}



// Function: FUN_676887a7 at 676887a7

uint __thiscall FUN_676887a7(void *this,undefined4 param_1,int param_2,int param_3)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  
  puVar2 = (undefined4 *)FUN_67688a04(this,param_2,param_3);
  puVar4 = puVar2;
  if (puVar2 != (undefined4 *)0x0) {
    if (puVar2 == *(undefined4 **)((int)this + 8)) {
      uVar3 = FUN_67688976(this,param_1);
      return uVar3;
    }
    puVar4 = (undefined4 *)operator_new(0x14);
    if (puVar4 == (undefined4 *)0x0) {
      puVar4 = (undefined4 *)0x0;
    }
    else {
      puVar4[2] = 0;
      puVar4[3] = 0;
      puVar4[4] = 0;
      *puVar4 = &PTR_FUN_676b9a34;
      puVar4[1] = param_1;
    }
    if (puVar4 != (undefined4 *)0x0) {
      puVar4[2] = puVar2;
      iVar1 = puVar2[3];
      puVar4[3] = iVar1;
      *(undefined4 **)(iVar1 + 8) = puVar4;
      puVar2[3] = puVar4;
      *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + 1;
      return CONCAT31((int3)((uint)puVar4 >> 8),1);
    }
  }
  return (uint)puVar4 & 0xffffff00;
}



// Function: FUN_6768881a at 6768881a

uint __thiscall FUN_6768881a(void *this,undefined4 *param_1)

{
  undefined4 *puVar1;
  uint in_EAX;
  uint uVar2;
  
  puVar1 = *(undefined4 **)((int)this + 8);
  if (puVar1 == (undefined4 *)0x0) {
    uVar2 = in_EAX & 0xffffff00;
  }
  else {
    FUN_67688a82(this,puVar1[2]);
    if (*(int *)((int)this + 8) == 0) {
      FUN_67688a50(this,0);
    }
    if (param_1 != (undefined4 *)0x0) {
      *param_1 = puVar1[1];
    }
    *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + -1;
    if (puVar1 != (undefined4 *)0x0) {
      param_1 = (undefined4 *)(**(code **)*puVar1)(1);
    }
    uVar2 = CONCAT31((int3)((uint)param_1 >> 8),1);
  }
  return uVar2;
}



// Function: FUN_67688865 at 67688865

void __thiscall FUN_67688865(void *this,int param_1)

{
  *(undefined ***)this = &PTR_FUN_676b9a34;
  *(undefined4 *)((int)this + 4) = *(undefined4 *)(param_1 + 4);
  *(undefined4 *)((int)this + 8) = *(undefined4 *)(param_1 + 8);
  *(undefined4 *)((int)this + 0xc) = *(undefined4 *)(param_1 + 0xc);
  *(undefined4 *)((int)this + 0x10) = *(undefined4 *)(param_1 + 0x10);
  return;
}



// Function: FUN_6768888c at 6768888c

void __fastcall FUN_6768888c(int param_1)

{
  int iVar1;
  
  if ((*(int *)(param_1 + 0x10) != 2) && (iVar1 = *(int *)(param_1 + 0xc), iVar1 != 0)) {
    *(undefined4 *)(param_1 + 4) = *(undefined4 *)(iVar1 + 4);
    *(undefined4 *)(param_1 + 8) = *(undefined4 *)(iVar1 + 8);
    *(undefined4 *)(param_1 + 0xc) = *(undefined4 *)(iVar1 + 0xc);
    *(undefined4 *)(param_1 + 0x10) = *(undefined4 *)(iVar1 + 0x10);
  }
  return;
}



// Function: FUN_676888b4 at 676888b4

undefined4 __thiscall FUN_676888b4(void *this,int param_1)

{
  int iVar1;
  undefined3 uVar2;
  bool bVar3;
  
  iVar1 = *(int *)((int)this + 0x10);
  uVar2 = (undefined3)((uint)iVar1 >> 8);
  if (iVar1 == *(int *)(param_1 + 0x10)) {
    if (iVar1 == 0) {
      bVar3 = *(int *)((int)this + 4) == *(int *)(param_1 + 4);
      uVar2 = (undefined3)((uint)*(int *)((int)this + 4) >> 8);
    }
    else {
      bVar3 = true;
    }
  }
  else {
    bVar3 = false;
  }
  return CONCAT31(uVar2,!bVar3);
}



// Function: FUN_676888e1 at 676888e1

undefined4 __thiscall FUN_676888e1(void *this,undefined4 param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  
  if (*(int *)((int)this + 4) == 0) {
    puVar1 = (undefined4 *)operator_new(0x14);
    if (puVar1 == (undefined4 *)0x0) {
      puVar3 = (undefined4 *)0x0;
    }
    else {
      *puVar1 = &PTR_FUN_676b9a34;
      puVar1[1] = param_1;
      puVar1[2] = 0;
      puVar1[3] = 0;
      puVar1[4] = 0;
      puVar3 = puVar1;
    }
    if (puVar3 == (undefined4 *)0x0) {
LAB_67688953:
      return (uint)puVar1 & 0xffffff00;
    }
    FUN_67688a50(this,(int)puVar3);
    uVar2 = FUN_67688a82(this,(int)puVar3);
  }
  else {
    puVar1 = (undefined4 *)operator_new(0x14);
    if (puVar1 == (undefined4 *)0x0) {
      puVar1 = (undefined4 *)0x0;
    }
    else {
      *puVar1 = &PTR_FUN_676b9a34;
      puVar1[1] = param_1;
      puVar1[2] = 0;
      puVar1[3] = 0;
      puVar1[4] = 0;
    }
    if (puVar1 == (undefined4 *)0x0) goto LAB_67688953;
    *(undefined4 **)(*(int *)((int)this + 4) + 8) = puVar1;
    puVar1[3] = *(undefined4 *)((int)this + 4);
    uVar2 = FUN_67688a50(this,(int)puVar1);
  }
  *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + 1;
  return CONCAT31((int3)((uint)uVar2 >> 8),1);
}



// Function: FUN_67688976 at 67688976

undefined4 __thiscall FUN_67688976(void *this,undefined4 param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  
  if (*(int *)((int)this + 4) == 0) {
    puVar1 = (undefined4 *)operator_new(0x14);
    if (puVar1 == (undefined4 *)0x0) {
      puVar3 = (undefined4 *)0x0;
    }
    else {
      *puVar1 = &PTR_FUN_676b9a34;
      puVar1[1] = param_1;
      puVar1[2] = 0;
      puVar1[3] = 0;
      puVar1[4] = 0;
      puVar3 = puVar1;
    }
    if (puVar3 == (undefined4 *)0x0) {
LAB_676889e1:
      return (uint)puVar1 & 0xffffff00;
    }
    FUN_67688a50(this,(int)puVar3);
    puVar1 = puVar3;
  }
  else {
    puVar1 = (undefined4 *)operator_new(0x14);
    if (puVar1 == (undefined4 *)0x0) {
      puVar1 = (undefined4 *)0x0;
    }
    else {
      *puVar1 = &PTR_FUN_676b9a34;
      puVar1[1] = param_1;
      puVar1[2] = 0;
      puVar1[3] = 0;
      puVar1[4] = 0;
    }
    if (puVar1 == (undefined4 *)0x0) goto LAB_676889e1;
    *(undefined4 **)(*(int *)((int)this + 8) + 0xc) = puVar1;
    puVar1[2] = *(undefined4 *)((int)this + 8);
  }
  uVar2 = FUN_67688a82(this,(int)puVar1);
  *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + 1;
  return CONCAT31((int3)((uint)uVar2 >> 8),1);
}



// Function: FUN_67688a04 at 67688a04

void __thiscall FUN_67688a04(void *this,int param_1,int param_2)

{
  int iVar1;
  
  if (param_2 == 0) {
    iVar1 = *(int *)((int)this + 4);
    while (((iVar1 != 0 && (*(int *)(iVar1 + 4) != param_1)) &&
           (iVar1 = *(int *)(iVar1 + 0xc), iVar1 != 0))) {
      if (*(int *)(iVar1 + 0x10) == 2) {
        iVar1 = 0;
      }
    }
  }
  else {
    iVar1 = *(int *)((int)this + 8);
    while (((iVar1 != 0 && (*(int *)(iVar1 + 4) != param_1)) &&
           (iVar1 = *(int *)(iVar1 + 8), iVar1 != 0))) {
      if (*(int *)(iVar1 + 0x10) == 1) {
        iVar1 = 0;
      }
    }
  }
  return;
}



// Function: FUN_67688a50 at 67688a50

void __thiscall FUN_67688a50(void *this,int param_1)

{
  *(int *)((int)this + 4) = param_1;
  if ((param_1 != 0) && (*(int *)(param_1 + 0x10) != 0)) {
    *(undefined4 *)((int)this + 4) = 0;
  }
  if (*(int *)((int)this + 0xc) != 0) {
    *(undefined4 *)(*(int *)((int)this + 0xc) + 0xc) = *(undefined4 *)((int)this + 4);
    if (*(int *)((int)this + 4) != 0) {
      *(undefined4 *)(*(int *)((int)this + 4) + 8) = *(undefined4 *)((int)this + 0xc);
    }
  }
  return;
}



// Function: FUN_67688a82 at 67688a82

void __thiscall FUN_67688a82(void *this,int param_1)

{
  *(int *)((int)this + 8) = param_1;
  if ((param_1 != 0) && (*(int *)(param_1 + 0x10) != 0)) {
    *(undefined4 *)((int)this + 8) = 0;
  }
  if (*(int *)((int)this + 0x10) != 0) {
    *(undefined4 *)(*(int *)((int)this + 0x10) + 8) = *(undefined4 *)((int)this + 8);
    if (*(int *)((int)this + 8) != 0) {
      *(undefined4 *)(*(int *)((int)this + 8) + 0xc) = *(undefined4 *)((int)this + 0x10);
    }
  }
  return;
}



// Function: FUN_67688abc at 67688abc

undefined4 * __fastcall FUN_67688abc(undefined4 *param_1)

{
  FUN_676aeb44(param_1);
  *param_1 = &PTR_FUN_676b9c20;
  param_1[0x5b] = 0;
  param_1[0x5c] = 0;
  param_1[0x5e] = 0;
  FUN_676834e7(param_1 + 0x61);
  param_1[0x68] = &PTR_LAB_676b9950;
  FUN_6767d089((int)(param_1 + 0x68));
  param_1[0x70] = &PTR_LAB_676b9950;
  FUN_676b06d0(param_1 + 0x72,param_1 + 0x6a,0x10);
  *(undefined8 *)(param_1 + 0x76) = *(undefined8 *)(param_1 + 0x6e);
  param_1[0x78] = &PTR_LAB_676b9950;
  FUN_676b06d0(param_1 + 0x7a,param_1 + 0x6a,0x10);
  *(undefined8 *)(param_1 + 0x7e) = *(undefined8 *)(param_1 + 0x6e);
  *param_1 = &PTR_FUN_676b9c10;
  *(undefined2 *)(param_1 + 5) = 8;
  *(undefined2 *)((int)param_1 + 0x16) = 0;
  param_1[8] = 0;
  param_1[10] = 0;
  param_1[0x10] = 0;
  param_1[6] = 0;
  param_1[9] = 0;
  param_1[0xb] = 0;
  *(undefined2 *)(param_1 + 0xc) = 0;
  param_1[0xd] = 0;
  *(undefined1 *)(param_1 + 0x19) = 0;
  param_1[0x5d] = 0;
  param_1[0x5f] = 0;
  param_1[0x13] = 0;
  param_1[0x14] = 0;
  *(undefined2 *)(param_1 + 4) = 0xa15;
  *(undefined2 *)((int)param_1 + 0x12) = 0x14;
  *(undefined2 *)(param_1 + 0x12) = 0;
  *(undefined2 *)((int)param_1 + 0x4a) = 0;
  param_1[0xe] = 0;
  param_1[0x11] = 0;
  *(undefined1 *)(param_1 + 0x60) = 0;
  *(undefined1 *)((int)param_1 + 0x181) = 0;
  *(undefined1 *)((int)param_1 + 0x55) = 0;
  *(undefined1 *)((int)param_1 + 0x201) = 0;
  *(undefined1 *)((int)param_1 + 0x202) = 0;
  *(undefined1 *)(param_1 + 0x80) = 0;
  *(undefined1 *)(param_1 + 0x81) = 1;
  *(undefined1 *)((int)param_1 + 0x203) = 1;
  *(undefined2 *)(param_1 + 0x82) = 0;
  *(undefined2 *)((int)param_1 + 0x206) = 0;
  *(undefined2 *)((int)param_1 + 0x20a) = 0;
  *(undefined2 *)(param_1 + 0x83) = 0;
  *(undefined2 *)(param_1 + 0x17) = 0;
  *(undefined1 *)(param_1 + 0x15) = 0;
  param_1[0x16] = 0;
  param_1[0x18] = 0;
  return param_1;
}



// Function: FUN_67688bfd at 67688bfd

undefined4 * __thiscall FUN_67688bfd(void *this,byte param_1)

{
  *(undefined ***)this = &PTR_FUN_676b9c30;
  FUN_676aeb74((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_67688c1f at 67688c1f

undefined4 * __thiscall FUN_67688c1f(void *this,byte param_1)

{
  FUN_67688c3b((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_67688c3b at 67688c3b

void __fastcall FUN_67688c3b(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b9c10;
  if ((undefined *)param_1[0x5d] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[0x5d]);
  }
  if ((undefined *)param_1[0x5f] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[0x5f]);
  }
  param_1[0x78] = &PTR_LAB_676b9950;
  param_1[0x70] = &PTR_LAB_676b9950;
  param_1[0x68] = &PTR_LAB_676b9950;
  FUN_67683515(param_1 + 0x61);
  Ordinal_6(param_1[0x5e]);
  Ordinal_6(param_1[0x5c]);
  Ordinal_6(param_1[0x5b]);
  *param_1 = &PTR_FUN_676b9c30;
  FUN_676aeb74(param_1);
  return;
}



// Function: FUN_67688cb7 at 67688cb7

undefined4 * __thiscall FUN_67688cb7(void *this,int param_1)

{
  int iVar1;
  LPSTR pCVar2;
  undefined *puVar3;
  undefined4 uVar4;
  undefined1 local_14 [4];
  int *local_10;
  
  FUN_676aeb44((undefined4 *)this);
  *(undefined ***)this = &PTR_FUN_676b9c20;
  *(undefined4 *)((int)this + 0x16c) = 0;
  *(undefined4 *)((int)this + 0x170) = 0;
  *(undefined4 *)((int)this + 0x178) = 0;
  FUN_676834e7((undefined4 *)((int)this + 0x184));
  *(undefined ***)((int)this + 0x1a0) = &PTR_LAB_676b9950;
  FUN_676b06d0((undefined4 *)((int)this + 0x1a8),(undefined4 *)(param_1 + 0x1a8),0x10);
  *(undefined8 *)((int)this + 0x1b8) = *(undefined8 *)(param_1 + 0x1b8);
  *(undefined ***)((int)this + 0x1c0) = &PTR_LAB_676b9950;
  FUN_676b06d0((undefined4 *)((int)this + 0x1c8),(undefined4 *)(param_1 + 0x1c8),0x10);
  *(undefined8 *)((int)this + 0x1d8) = *(undefined8 *)(param_1 + 0x1d8);
  *(undefined ***)((int)this + 0x1e0) = &PTR_LAB_676b9950;
  FUN_676b06d0((undefined4 *)((int)this + 0x1e8),(undefined4 *)(param_1 + 0x1e8),0x10);
  *(undefined8 *)((int)this + 0x1f8) = *(undefined8 *)(param_1 + 0x1f8);
  *(undefined ***)this = &PTR_FUN_676b9c10;
  *(undefined2 *)((int)this + 0x14) = *(undefined2 *)(param_1 + 0x14);
  *(undefined2 *)((int)this + 0x16) = *(undefined2 *)(param_1 + 0x16);
  *(undefined4 *)((int)this + 0x18) = *(undefined4 *)(param_1 + 0x18);
  *(undefined4 *)((int)this + 0x20) = *(undefined4 *)(param_1 + 0x20);
  *(undefined4 *)((int)this + 0x24) = *(undefined4 *)(param_1 + 0x24);
  *(undefined4 *)((int)this + 0x28) = *(undefined4 *)(param_1 + 0x28);
  *(undefined4 *)((int)this + 0x2c) = *(undefined4 *)(param_1 + 0x2c);
  *(undefined2 *)((int)this + 0x30) = *(undefined2 *)(param_1 + 0x30);
  *(undefined4 *)((int)this + 0x34) = *(undefined4 *)(param_1 + 0x34);
  lstrcpyA((LPSTR)((int)this + 100),(LPCSTR)(param_1 + 100));
  FUN_67688fb2((void *)((int)this + 0x16c),(int *)(param_1 + 0x16c));
  FUN_67688fb2((void *)((int)this + 0x170),(int *)(param_1 + 0x170));
  *(undefined4 *)((int)this + 0x50) = *(undefined4 *)(param_1 + 0x50);
  if (*(LPCSTR *)(param_1 + 0x174) == (LPCSTR)0x0) {
    *(undefined4 *)((int)this + 0x174) = 0;
  }
  else {
    iVar1 = lstrlenA(*(LPCSTR *)(param_1 + 0x174));
    pCVar2 = (LPSTR)operator_new(iVar1 + 1);
    *(LPSTR *)((int)this + 0x174) = pCVar2;
    if (pCVar2 == (LPSTR)0x0) {
      return (undefined4 *)this;
    }
    lstrcpyA(pCVar2,*(LPCSTR *)(param_1 + 0x174));
  }
  FUN_67688fb2((void *)((int)this + 0x178),(int *)(param_1 + 0x178));
  if (*(LPCSTR *)(param_1 + 0x17c) == (LPCSTR)0x0) {
    *(undefined4 *)((int)this + 0x17c) = 0;
  }
  else {
    iVar1 = lstrlenA(*(LPCSTR *)(param_1 + 0x17c));
    pCVar2 = (LPSTR)operator_new(iVar1 + 1);
    *(LPSTR *)((int)this + 0x17c) = pCVar2;
    if (pCVar2 == (LPSTR)0x0) {
      return (undefined4 *)this;
    }
    lstrcpyA(pCVar2,*(LPCSTR *)(param_1 + 0x17c));
  }
  *(undefined4 *)((int)this + 0x4c) = *(undefined4 *)(param_1 + 0x4c);
  *(undefined2 *)((int)this + 0x10) = *(undefined2 *)(param_1 + 0x10);
  *(undefined2 *)((int)this + 0x12) = *(undefined2 *)(param_1 + 0x12);
  *(undefined2 *)((int)this + 0x48) = *(undefined2 *)(param_1 + 0x48);
  *(undefined2 *)((int)this + 0x4a) = *(undefined2 *)(param_1 + 0x4a);
  *(undefined4 *)((int)this + 0x38) = *(undefined4 *)(param_1 + 0x38);
  *(undefined4 *)((int)this + 0x40) = *(undefined4 *)(param_1 + 0x40);
  *(undefined4 *)((int)this + 0x44) = *(undefined4 *)(param_1 + 0x44);
  *(undefined1 *)((int)this + 0x180) = *(undefined1 *)(param_1 + 0x180);
  *(undefined1 *)((int)this + 0x181) = *(undefined1 *)(param_1 + 0x181);
  *(undefined1 *)((int)this + 0x55) = *(undefined1 *)(param_1 + 0x55);
  *(undefined1 *)((int)this + 0x201) = *(undefined1 *)(param_1 + 0x201);
  *(undefined1 *)((int)this + 0x202) = *(undefined1 *)(param_1 + 0x202);
  *(undefined1 *)((int)this + 0x200) = *(undefined1 *)(param_1 + 0x200);
  *(undefined1 *)((int)this + 0x204) = *(undefined1 *)(param_1 + 0x204);
  *(undefined1 *)((int)this + 0x203) = *(undefined1 *)(param_1 + 0x203);
  *(undefined2 *)((int)this + 0x208) = *(undefined2 *)(param_1 + 0x208);
  *(undefined2 *)((int)this + 0x206) = *(undefined2 *)(param_1 + 0x206);
  *(undefined2 *)((int)this + 0x20a) = *(undefined2 *)(param_1 + 0x20a);
  *(undefined2 *)((int)this + 0x20c) = *(undefined2 *)(param_1 + 0x20c);
  *(undefined1 *)((int)this + 0x54) = *(undefined1 *)(param_1 + 0x54);
  *(undefined4 *)((int)this + 0x58) = *(undefined4 *)(param_1 + 0x58);
  *(undefined2 *)((int)this + 0x5c) = *(undefined2 *)(param_1 + 0x5c);
  puVar3 = *(undefined **)(param_1 + 0x188);
  if ((puVar3 == (undefined *)0x0) &&
     (puVar3 = *(undefined **)(param_1 + 0x194), puVar3 == (undefined *)0x0)) {
    puVar3 = &DAT_676c50e8;
  }
  FUN_67683e1f(local_14,(int)puVar3);
  while( true ) {
    puVar3 = *(undefined **)(param_1 + 0x194);
    if (puVar3 == (undefined *)0x0) {
      puVar3 = &DAT_676c50e8;
    }
    uVar4 = FUN_67683e77(local_14,(int)puVar3);
    if ((char)uVar4 == '\0') break;
    uVar4 = (**(code **)(*local_10 + 4))();
    FUN_67683f1c((void *)((int)this + 0x184),uVar4);
    FUN_67683e46((int)local_14);
  }
  *(undefined4 *)((int)this + 0x60) = *(undefined4 *)(param_1 + 0x60);
  return (undefined4 *)this;
}



// Function: FUN_67688fb2 at 67688fb2

int * __thiscall FUN_67688fb2(void *this,int *param_1)

{
  int iVar1;
  undefined4 uVar2;
  
                    /* WARNING: Load size is inaccurate */
  iVar1 = *this;
  if (iVar1 != *param_1) {
    if (iVar1 != 0) {
      Ordinal_6(iVar1);
    }
    uVar2 = Ordinal_7(*param_1);
    uVar2 = Ordinal_4(*param_1,uVar2);
    *(undefined4 *)this = uVar2;
  }
  return (int *)this;
}



// Function: FUN_67688fe5 at 67688fe5

uint __thiscall FUN_67688fe5(void *this,void *param_1,int param_2)

{
  ushort uVar1;
  undefined4 uVar2;
  uint uVar3;
  char *pcVar4;
  int iVar5;
  undefined **appuStack_30 [2];
  undefined4 uStack_28;
  
  if ((param_2 != 0) && (*(char *)((int)this + 0x180) == '\0')) {
    if (((char)((ushort)*(short *)(param_2 + 4) >> 8) == '\0') || (*(short *)(param_2 + 4) == 0xb14)
       ) {
      OemToCharA(*(LPCSTR *)(param_2 + 0x30),*(LPCSTR *)(param_2 + 0x30));
      for (pcVar4 = *(char **)(param_2 + 0x30); *pcVar4 != '\0'; pcVar4 = pcVar4 + 1) {
        if (*pcVar4 == '?') {
          *pcVar4 = '_';
        }
      }
    }
    if ((*(char *)((int)this + 0x181) != '\0') &&
       ((((((((*(ushort *)(param_2 + 8) ^ *(ushort *)((int)this + 0x14)) & 0x1fff) != 0 ||
            (*(short *)((int)this + 0x12) != *(short *)(param_2 + 6))) ||
           (*(short *)((int)this + 0x16) != *(short *)(param_2 + 10))) ||
          ((*(short *)((int)this + 0x208) != *(short *)(param_2 + 0xe) ||
           (*(short *)((int)this + 0x206) != *(short *)(param_2 + 0xc))))) ||
         ((*(short *)((int)this + 0x20a) != *(short *)(param_2 + 0x1c) ||
          ((*(int *)((int)this + 0x18) != *(int *)(param_2 + 0x10) ||
           (*(short *)((int)this + 0x5c) != *(short *)(param_2 + 0xc))))))) ||
        (iVar5 = lstrcmpA((LPCSTR)((int)this + 100),*(LPCSTR *)(param_2 + 0x30)), iVar5 != 0)))) {
      FUN_6767ca9c(param_1,0x144,0x1000000);
    }
    *(ushort *)((int)this + 0x14) = *(ushort *)((int)this + 0x14) & 0xe000;
    *(ushort *)((int)this + 0x14) =
         *(ushort *)(param_2 + 8) & 0x1fff | *(ushort *)((int)this + 0x14);
    *(undefined2 *)((int)this + 0x12) = *(undefined2 *)(param_2 + 6);
    *(undefined2 *)((int)this + 0x16) = *(undefined2 *)(param_2 + 10);
    *(undefined2 *)((int)this + 0x208) = *(undefined2 *)(param_2 + 0xe);
    *(undefined2 *)((int)this + 0x206) = *(undefined2 *)(param_2 + 0xc);
    *(undefined2 *)((int)this + 0x20a) = *(undefined2 *)(param_2 + 0x1c);
    appuStack_30[0] = &PTR_LAB_676b9950;
    FUN_676891d2(appuStack_30,*(undefined4 *)(param_2 + 0xc));
    FUN_6768289f(this);
    *(undefined4 *)((int)this + 0x18) = *(undefined4 *)(param_2 + 0x10);
    *(undefined4 *)((int)this + 0x20) = *(undefined4 *)(param_2 + 0x14);
    *(undefined4 *)((int)this + 0x24) = 0;
    *(undefined4 *)((int)this + 0x28) = *(undefined4 *)(param_2 + 0x18);
    *(undefined4 *)((int)this + 0x2c) = 0;
    *(undefined2 *)((int)this + 0x5c) = *(undefined2 *)(param_2 + 0xc);
    FUN_6768921c(this,*(LPCSTR *)(param_2 + 0x30));
    *(undefined2 *)((int)this + 0x10) = *(undefined2 *)(param_2 + 4);
    FUN_6768926e((int)this);
    *(uint *)((int)this + 0x38) = (uint)*(ushort *)(param_2 + 0x22);
    *(undefined2 *)((int)this + 0x30) = *(undefined2 *)(param_2 + 0x24);
    *(undefined4 *)((int)this + 0x34) = *(undefined4 *)(param_2 + 0x26);
    uVar2 = *(undefined4 *)(param_2 + 0x2a);
    *(undefined4 *)((int)this + 0x40) = uVar2;
    *(undefined4 *)((int)this + 0x44) = 0;
    uVar1 = *(ushort *)(param_2 + 0x1e);
    uVar3 = CONCAT22((short)((uint)uVar2 >> 0x10),uVar1);
    if (uVar1 == 0) {
LAB_676891c2:
      *(undefined1 *)((int)this + 0x180) = 1;
      return CONCAT31((int3)(uVar3 >> 8),1);
    }
    if (*(short **)(param_2 + 0x34) != (short *)0x0) {
      uStack_28 = 0x676891ba;
      uVar3 = FUN_676835ad((void *)((int)this + 0x184),param_1,*(short **)(param_2 + 0x34),uVar1,
                           this,param_2);
      if ((char)uVar3 != '\0') goto LAB_676891c2;
      goto LAB_676891be;
    }
  }
  uVar3 = FUN_6767ca9c(param_1,999,0x4000000);
LAB_676891be:
  return uVar3 & 0xffffff00;
}



// Function: FUN_676891d2 at 676891d2

DWORD __thiscall FUN_676891d2(void *this,undefined4 param_1)

{
  int iVar1;
  _FILETIME local_c;
  
  local_c.dwLowDateTime = (DWORD)this;
  local_c.dwHighDateTime = (DWORD)this;
  DosDateTimeToFileTime((WORD)((uint)param_1 >> 0x10),(WORD)param_1,&local_c);
  FileTimeToSystemTime(&local_c,(LPSYSTEMTIME)((int)this + 8));
  iVar1 = Ordinal_184((LPSYSTEMTIME)((int)this + 8),(undefined8 *)((int)this + 0x18));
  if (iVar1 == 0) {
    *(undefined8 *)((int)this + 0x18) = 0x4000000000000000;
  }
  return (DWORD)this;
}



// Function: FUN_6768921c at 6768921c

void __thiscall FUN_6768921c(void *this,LPCSTR param_1)

{
  LPSTR lpString1;
  LPWSTR pWVar1;
  
  if (param_1 == (LPCSTR)0x0) {
    param_1 = &DAT_676c5098;
  }
  lpString1 = (LPSTR)((int)this + 100);
  lstrcpyA(lpString1,param_1);
  FUN_676ad4c2(lpString1,'/','\\');
  Ordinal_6(*(undefined4 *)((int)this + 0x16c));
  pWVar1 = FUN_67684ed6(lpString1,-1);
  *(undefined4 *)((int)this + 0x16c) = pWVar1;
  lstrcpyA(lpString1,param_1);
  return;
}



// Function: FUN_6768926e at 6768926e

void __fastcall FUN_6768926e(int param_1)

{
  int iVar1;
  LPSTR lpString1;
  LPWSTR pWVar2;
  LPCSTR unaff_retaddr;
  
  if (*(undefined **)(param_1 + 0x174) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)(param_1 + 0x174));
    *(undefined4 *)(param_1 + 0x174) = 0;
  }
  Ordinal_6(*(undefined4 *)(param_1 + 0x178));
  *(undefined4 *)(param_1 + 0x178) = 0;
  if (unaff_retaddr != (LPCSTR)0x0) {
    iVar1 = lstrlenA(unaff_retaddr);
    lpString1 = (LPSTR)operator_new(iVar1 + 1);
    *(LPSTR *)(param_1 + 0x174) = lpString1;
    if (lpString1 != (LPSTR)0x0) {
      lstrcpyA(lpString1,unaff_retaddr);
      Ordinal_6(*(undefined4 *)(param_1 + 0x178));
      pWVar2 = FUN_67684ed6(unaff_retaddr,-1);
      *(LPWSTR *)(param_1 + 0x178) = pWVar2;
    }
  }
  return;
}



// Function: FUN_676892e7 at 676892e7

uint __thiscall FUN_676892e7(void *this,void *param_1,int param_2)

{
  ushort uVar1;
  uint uVar2;
  char *pcVar3;
  undefined2 extraout_var;
  undefined **appuStack_30 [2];
  undefined4 uStack_28;
  
  if (((param_2 != 0) && (*(char *)((int)this + 0x181) == '\0')) &&
     (*(char *)((int)this + 0x180) != '\0')) {
    if (*(char *)((int)this + 0x11) == '\0') {
      OemToCharA(*(LPCSTR *)(param_2 + 0x20),*(LPCSTR *)(param_2 + 0x20));
      for (pcVar3 = *(char **)(param_2 + 0x20); *pcVar3 != '\0'; pcVar3 = pcVar3 + 1) {
        if (*pcVar3 == '?') {
          *pcVar3 = '_';
        }
      }
    }
    if (((((((*(ushort *)(param_2 + 6) ^ *(ushort *)((int)this + 0x14)) & 0x1fff) != 0) ||
          (*(short *)((int)this + 0x12) != *(short *)(param_2 + 4))) ||
         ((*(short *)((int)this + 0x16) != *(short *)(param_2 + 8) ||
          ((*(short *)((int)this + 0x208) != *(short *)(param_2 + 0xc) ||
           (*(short *)((int)this + 0x206) != *(short *)(param_2 + 10))))))) ||
        (*(short *)((int)this + 0x20a) != *(short *)(param_2 + 0x1a))) ||
       (*(short *)((int)this + 0x5c) != *(short *)(param_2 + 10))) {
      FUN_6767ca9c(param_1,0x144,0x1000000);
      if (((*(byte *)(param_2 + 6) ^ (byte)*(ushort *)((int)this + 0x14)) & 8) != 0) {
        *(ushort *)((int)this + 0x14) = *(ushort *)((int)this + 0x14) ^ 8;
      }
    }
    if ((*(byte *)((int)this + 0x14) >> 3 & 1) == 0) {
      if (*(int *)((int)this + 0x18) != *(int *)(param_2 + 0xe)) {
        FUN_6767ca9c(param_1,0x144,0x1000000);
      }
      *(undefined4 *)((int)this + 0x18) = *(undefined4 *)(param_2 + 0xe);
      *(undefined4 *)((int)this + 0x20) = *(undefined4 *)(param_2 + 0x12);
      *(undefined4 *)((int)this + 0x24) = 0;
      *(undefined4 *)((int)this + 0x28) = *(undefined4 *)(param_2 + 0x16);
      *(undefined4 *)((int)this + 0x2c) = 0;
    }
    *(ushort *)((int)this + 0x14) = *(ushort *)((int)this + 0x14) & 0xe000;
    *(ushort *)((int)this + 0x14) =
         *(ushort *)(param_2 + 6) & 0x1fff | *(ushort *)((int)this + 0x14);
    *(undefined2 *)((int)this + 0x12) = *(undefined2 *)(param_2 + 4);
    *(undefined2 *)((int)this + 0x16) = *(undefined2 *)(param_2 + 8);
    *(undefined2 *)((int)this + 0x208) = *(undefined2 *)(param_2 + 0xc);
    *(undefined2 *)((int)this + 0x206) = *(undefined2 *)(param_2 + 10);
    *(undefined2 *)((int)this + 0x20a) = *(undefined2 *)(param_2 + 0x1a);
    appuStack_30[0] = &PTR_LAB_676b9950;
    FUN_676891d2(appuStack_30,*(undefined4 *)(param_2 + 10));
    FUN_6768289f(this);
    *(undefined2 *)((int)this + 0x5c) = *(undefined2 *)(param_2 + 10);
    uVar1 = *(ushort *)(param_2 + 0x1c);
    uVar2 = CONCAT22(extraout_var,uVar1);
    if (uVar1 == 0) {
LAB_676894a0:
      *(undefined1 *)((int)this + 0x181) = 1;
      return CONCAT31((int3)(uVar2 >> 8),1);
    }
    if (*(short **)(param_2 + 0x24) != (short *)0x0) {
      uStack_28 = 0x67689498;
      uVar2 = FUN_6768352c((void *)((int)this + 0x184),param_1,*(short **)(param_2 + 0x24),uVar1,
                           this,param_2);
      if ((char)uVar2 != '\0') goto LAB_676894a0;
      goto LAB_6768949c;
    }
  }
  uVar2 = FUN_6767ca9c(param_1,999,0x4000000);
LAB_6768949c:
  return uVar2 & 0xffffff00;
}



// Function: FUN_676894b0 at 676894b0

uint __thiscall FUN_676894b0(void *this,void *param_1,int param_2)

{
  undefined4 uVar1;
  uint uVar2;
  
  if (((param_2 == 0) || (*(char *)((int)this + 0x181) == '\0')) ||
     ((*(byte *)((int)this + 0x14) >> 3 & 1) == 0)) {
    uVar2 = FUN_6767ca9c(param_1,999,0x4000000);
    uVar2 = uVar2 & 0xffffff00;
  }
  else {
    if ((*(char *)((int)this + 0x180) != '\0') &&
       (((*(int *)((int)this + 0x18) != *(int *)(param_2 + 4) ||
         (*(int *)((int)this + 0x20) != *(int *)(param_2 + 8))) ||
        ((*(int *)((int)this + 0x24) != *(int *)(param_2 + 0xc) ||
         ((*(int *)((int)this + 0x28) != *(int *)(param_2 + 0x10) ||
          (*(int *)((int)this + 0x2c) != *(int *)(param_2 + 0x14))))))))) {
      FUN_6767ca9c(param_1,0x144,0x1000000);
    }
    *(undefined4 *)((int)this + 0x18) = *(undefined4 *)(param_2 + 4);
    *(undefined4 *)((int)this + 0x20) = *(undefined4 *)(param_2 + 8);
    *(undefined4 *)((int)this + 0x24) = *(undefined4 *)(param_2 + 0xc);
    *(undefined4 *)((int)this + 0x28) = *(undefined4 *)(param_2 + 0x10);
    uVar1 = *(undefined4 *)(param_2 + 0x14);
    *(undefined4 *)((int)this + 0x2c) = uVar1;
    uVar2 = CONCAT31((int3)((uint)uVar1 >> 8),1);
  }
  return uVar2;
}



// Function: FUN_67689550 at 67689550

uint __thiscall FUN_67689550(void *this,void *param_1,int param_2,undefined4 param_3)

{
  undefined2 uVar1;
  uint uVar2;
  BOOL BVar3;
  int iVar4;
  LPSTR pCVar5;
  int iVar6;
  _FILETIME local_10;
  int local_8;
  
  iVar6 = param_2;
  if (param_2 == 0) {
    iVar6 = 999;
  }
  else {
    if ((*(int *)((int)this + 0x24) == 0) && (*(int *)((int)this + 0x20) != -1)) {
      *(undefined4 *)(param_2 + 0x14) = *(undefined4 *)((int)this + 0x20);
    }
    else {
      *(undefined4 *)(param_2 + 0x14) = 0xffffffff;
    }
    if ((*(int *)((int)this + 0x2c) == 0) && (*(int *)((int)this + 0x28) != -1)) {
      *(undefined4 *)(param_2 + 0x18) = *(undefined4 *)((int)this + 0x28);
    }
    else {
      *(undefined4 *)(param_2 + 0x18) = 0xffffffff;
    }
    if (*(uint *)((int)this + 0x38) < 0xffff) {
      *(undefined2 *)(param_2 + 0x22) = *(undefined2 *)((int)this + 0x38);
    }
    else {
      *(undefined2 *)(param_2 + 0x22) = 0xffff;
    }
    if ((*(int *)((int)this + 0x44) == 0) && (*(int *)((int)this + 0x40) != -1)) {
      *(undefined4 *)(param_2 + 0x2a) = *(undefined4 *)((int)this + 0x40);
    }
    else {
      *(undefined4 *)(param_2 + 0x2a) = 0xffffffff;
    }
    *(undefined2 *)(param_2 + 4) = *(undefined2 *)((int)this + 0x10);
    *(undefined2 *)(param_2 + 6) = *(undefined2 *)((int)this + 0x12);
    *(undefined2 *)(param_2 + 8) = *(undefined2 *)((int)this + 0x14);
    *(undefined2 *)(param_2 + 10) = *(undefined2 *)((int)this + 0x16);
    BVar3 = SystemTimeToFileTime((SYSTEMTIME *)((int)this + 0x1e8),&local_10);
    if (BVar3 != 0) {
      FileTimeToDosDateTime(&local_10,(LPWORD)(iVar6 + 0xe),(LPWORD)(iVar6 + 0xc));
    }
    *(undefined4 *)(iVar6 + 0x10) = *(undefined4 *)((int)this + 0x18);
    iVar4 = lstrlenA((LPCSTR)((int)this + 100));
    *(short *)(iVar6 + 0x1c) = (short)iVar4;
    if (*(LPCSTR *)((int)this + 0x174) == (LPCSTR)0x0) {
      uVar1 = 0;
    }
    else {
      iVar4 = lstrlenA(*(LPCSTR *)((int)this + 0x174));
      uVar1 = (short)iVar4;
    }
    *(undefined2 *)(iVar6 + 0x20) = uVar1;
    *(undefined2 *)(iVar6 + 0x24) = *(undefined2 *)((int)this + 0x30);
    *(undefined4 *)(iVar6 + 0x26) = *(undefined4 *)((int)this + 0x34);
    pCVar5 = (LPSTR)operator_new(*(ushort *)(iVar6 + 0x1c) + 1);
    *(LPSTR *)(iVar6 + 0x30) = pCVar5;
    if (pCVar5 != (LPSTR)0x0) {
      lstrcpyA(pCVar5,(LPCSTR)((int)this + 100));
      pCVar5 = (LPSTR)operator_new(*(ushort *)(iVar6 + 0x20) + 1);
      *(LPSTR *)(iVar6 + 0x38) = pCVar5;
      if (pCVar5 != (LPSTR)0x0) {
        if (*(LPCSTR *)((int)this + 0x174) == (LPCSTR)0x0) {
          *pCVar5 = '\0';
        }
        else {
          lstrcpyA(pCVar5,*(LPCSTR *)((int)this + 0x174));
        }
        local_8 = *(int *)(iVar6 + 0x34);
        *(undefined2 *)(iVar6 + 0x1e) = 0;
        param_2 = 0xffff;
        uVar2 = FUN_67683821((void *)((int)this + 0x184),param_1,&local_8,(short *)&param_2,
                             (int)this,param_3);
        if ((char)uVar2 != '\0') {
          *(short *)(iVar6 + 0x1e) = (short)(0xffff - param_2);
          return CONCAT31((int3)((uint)(0xffff - param_2) >> 8),1);
        }
        goto LAB_676896de;
      }
    }
    iVar6 = 0x1ff;
  }
  uVar2 = FUN_6767ca9c(param_1,iVar6,0x4000000);
LAB_676896de:
  return uVar2 & 0xffffff00;
}



// Function: FUN_676896f7 at 676896f7

uint __thiscall FUN_676896f7(void *this,void *param_1,int param_2,char param_3,undefined4 param_4)

{
  uint uVar1;
  BOOL BVar2;
  LPSTR lpString1;
  int iVar3;
  undefined4 uVar4;
  int iVar5;
  _FILETIME local_14;
  int local_8;
  
  iVar5 = param_2;
  if (param_2 == 0) {
    iVar5 = 999;
  }
  else {
    uVar4 = *(undefined4 *)((int)this + 0x20);
    if (*(int *)((int)this + 0x24) != 0) {
      uVar4 = 0xffffffff;
    }
    *(undefined4 *)(param_2 + 0x12) = uVar4;
    uVar4 = *(undefined4 *)((int)this + 0x28);
    if (*(int *)((int)this + 0x2c) != 0) {
      uVar4 = 0xffffffff;
    }
    local_8 = 0;
    *(undefined4 *)(param_2 + 0x16) = uVar4;
    *(undefined2 *)(param_2 + 4) = *(undefined2 *)((int)this + 0x12);
    *(undefined2 *)(param_2 + 6) = *(undefined2 *)((int)this + 0x14);
    *(undefined2 *)(param_2 + 8) = *(undefined2 *)((int)this + 0x16);
    BVar2 = SystemTimeToFileTime((SYSTEMTIME *)((int)this + 0x1e8),&local_14);
    if (BVar2 != 0) {
      FileTimeToDosDateTime(&local_14,(LPWORD)(iVar5 + 0xc),(LPWORD)(iVar5 + 10));
    }
    *(undefined4 *)(iVar5 + 0xe) = *(undefined4 *)((int)this + 0x18);
    uVar1 = lstrlenA((LPCSTR)((int)this + 100));
    *(short *)(iVar5 + 0x1a) = (short)uVar1;
    lpString1 = (LPSTR)operator_new((uVar1 & 0xffff) + 1);
    *(LPSTR *)(iVar5 + 0x20) = lpString1;
    if (lpString1 != (LPSTR)0x0) {
      lstrcpyA(lpString1,(LPCSTR)((int)this + 100));
      *(undefined2 *)(iVar5 + 0x1c) = 0;
      local_8 = *(int *)(iVar5 + 0x24);
      param_2 = 0xffff;
      uVar1 = FUN_67683960((void *)((int)this + 0x184),param_1,&local_8,(short *)&param_2,(int)this,
                           param_3 == '\0',param_4);
      if ((char)uVar1 != '\0') {
        if (param_3 == '\0') {
          iVar3 = CONCAT22((short)(uVar1 >> 0x10),*(undefined2 *)((int)this + 0x20c));
          *(undefined2 *)(iVar5 + 0x1c) = *(undefined2 *)((int)this + 0x20c);
        }
        else {
          iVar3 = 0xffff - param_2;
          *(short *)(iVar5 + 0x1c) = (short)iVar3;
          *(short *)((int)this + 0x20c) = (short)iVar3;
        }
        return CONCAT31((int3)((uint)iVar3 >> 8),1);
      }
      goto LAB_67689810;
    }
    iVar5 = 0x1ff;
  }
  uVar1 = FUN_6767ca9c(param_1,iVar5,0x4000000);
LAB_67689810:
  return uVar1 & 0xffffff00;
}



// Function: FUN_67689840 at 67689840

bool __thiscall FUN_67689840(void *this,void *param_1,int param_2)

{
  if (param_2 != 0) {
    *(undefined4 *)(param_2 + 4) = *(undefined4 *)((int)this + 0x18);
    *(undefined4 *)(param_2 + 8) = *(undefined4 *)((int)this + 0x20);
    *(undefined4 *)(param_2 + 0xc) = *(undefined4 *)((int)this + 0x24);
    *(undefined4 *)(param_2 + 0x10) = *(undefined4 *)((int)this + 0x28);
    *(undefined4 *)(param_2 + 0x14) = *(undefined4 *)((int)this + 0x2c);
  }
  else {
    FUN_6767ca9c(param_1,999,0x4000000);
  }
  return param_2 != 0;
}



// Function: FUN_67689882 at 67689882

void __thiscall FUN_67689882(void *this,void *param_1,byte param_2)

{
  FUN_6768361f((void *)((int)this + 0x184),param_1,this,param_2);
  return;
}



// Function: FUN_67689899 at 67689899

void __thiscall FUN_67689899(void *this,void *param_1,undefined4 param_2)

{
  FUN_67683797((void *)((int)this + 0x184),param_1,this,param_2);
  return;
}



// Function: FUN_676898b0 at 676898b0

/* WARNING: Type propagation algorithm not settling */

undefined4 __thiscall FUN_676898b0(void *this,void *param_1,undefined4 *param_2)

{
  int iVar1;
  undefined4 *puVar2;
  DWORD DVar3;
  HANDLE hDevice;
  uint uVar4;
  short local_62c;
  undefined4 local_62a [130];
  WCHAR local_420;
  undefined4 local_41e [130];
  short sStack_216;
  undefined1 local_214 [520];
  DWORD local_c;
  uint local_8;
  
  if (param_2 != (undefined4 *)0x0) {
    *param_2 = 0xffffffff;
  }
  if ((*(uint *)((int)this + 0x34) & 8) != 0) {
    FUN_676ac8da(*(short **)((int)this + 0x170),(short *)local_214,(short *)0x0,(short *)0x0);
    if (((&stack0x00000000 == (undefined1 *)0x214) ||
        (iVar1 = FUN_676ae2a4((short *)local_214), iVar1 == 0)) ||
       ((iVar1 = FUN_676ae2a4((short *)local_214), (&sStack_216)[iVar1] != 0x5c &&
        (iVar1 = FUN_676ae2a4((short *)local_214), (&sStack_216)[iVar1] != 0x2f)))) {
      FUN_676ae272((short *)local_214,(short *)&DAT_676c057c);
    }
    puVar2 = (undefined4 *)FUN_676af746((LPCWSTR)local_214,*(LPCWSTR *)((int)this + 0x16c));
    if (puVar2 == (undefined4 *)0x0) {
      iVar1 = 0x76;
      goto LAB_67689ab7;
    }
    goto LAB_67689af7;
  }
  local_8 = *(uint *)((int)this + 0x34) & 0x837;
  local_420 = L'\0';
  local_62c = 0;
  puVar2 = local_41e;
  for (iVar1 = 0x82; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  puVar2 = local_62a;
  for (iVar1 = 0x82; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  uVar4 = local_8 & 0x10;
  if (uVar4 == 0) {
    FUN_676aca1a(*(LPCWSTR *)((int)this + 0x170),&local_420,&local_62c,(short *)0x0);
    puVar2 = (undefined4 *)FUN_676ae272(&local_420,&local_62c);
    if (local_62c != 0) goto LAB_676899fe;
  }
  else {
    FUN_676ae1fc(&local_420,*(short **)((int)this + 0x170));
LAB_676899fe:
    puVar2 = (undefined4 *)FUN_676ace8e(&local_420);
    if (puVar2 == (undefined4 *)0x0) {
      iVar1 = 0x70;
      goto LAB_67689ab7;
    }
  }
  if (uVar4 == 0) {
    FUN_676af551(*(LPCWSTR *)((int)this + 0x170));
    DVar3 = GetLastError();
    if (DVar3 == 5) {
      local_c = FUN_676af4e2(*(LPCWSTR *)((int)this + 0x170));
      FUN_676af46d(*(LPCWSTR *)((int)this + 0x170),0x80);
      FUN_676af551(*(LPCWSTR *)((int)this + 0x170));
      DVar3 = GetLastError();
      if (DVar3 == 5) {
        FUN_676af46d(*(LPCWSTR *)((int)this + 0x170),local_c);
        iVar1 = 0x71;
        goto LAB_67689ab7;
      }
    }
    hDevice = FUN_676aeee9(*(LPCWSTR *)((int)this + 0x170),0x40000000,1,(LPSECURITY_ATTRIBUTES)0x0,2
                           ,0x8000000,(HANDLE)0x0);
    if (hDevice == (HANDLE)0xffffffff) {
      iVar1 = 0x72;
LAB_67689ab7:
      uVar4 = FUN_6767ca9c(param_1,iVar1,0x2000000);
      return uVar4 & 0xffffff00;
    }
    if ((local_8 & 0x800) != 0) {
      param_1 = (void *)0x1;
      DeviceIoControl(hDevice,0x9c040,&param_1,2,(LPVOID)0x0,0,&local_c,(LPOVERLAPPED)0x0);
    }
    if (param_2 == (undefined4 *)0x0) {
      puVar2 = (undefined4 *)CloseHandle(hDevice);
    }
    else {
      *param_2 = hDevice;
      puVar2 = param_2;
    }
  }
LAB_67689af7:
  return CONCAT31((int3)((uint)puVar2 >> 8),1);
}



// Function: FUN_67689b00 at 67689b00

undefined4 __thiscall FUN_67689b00(void *this,undefined4 param_1,HANDLE param_2)

{
  HANDLE hDevice;
  int iVar1;
  WCHAR local_210 [260];
  DWORD local_8;
  
  if (param_2 != (HANDLE)0xffffffff) {
    CloseHandle(param_2);
  }
  hDevice = (HANDLE)FUN_676ae2a4(*(short **)((int)this + 0x170));
  if (hDevice != (HANDLE)0x0) {
    FUN_676abdc6((void *)((int)this + 0x1a0),*(LPCWSTR *)((int)this + 0x170),2);
    FUN_676abdc6((void *)((int)this + 0x1c0),*(LPCWSTR *)((int)this + 0x170),1);
    FUN_676abdc6((void *)((int)this + 0x1e0),*(LPCWSTR *)((int)this + 0x170),0);
    FUN_676af46d(*(LPCWSTR *)((int)this + 0x170),*(uint *)((int)this + 0x34) & 0x27);
    hDevice = *(HANDLE *)((int)this + 0x34);
    if ((((uint)hDevice & 0x800) != 0) && (((uint)hDevice & 0x10) != 0)) {
      param_2 = (HANDLE)0x1;
      FUN_676ae1fc(local_210,*(short **)((int)this + 0x170));
      iVar1 = FUN_676ae2a4(local_210);
      local_210[iVar1 + -1] = L'\0';
      hDevice = FUN_676aeee9(local_210,0xc0000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,0x2000000,
                             (HANDLE)0x0);
      if (hDevice != (HANDLE)0xffffffff) {
        DeviceIoControl(hDevice,0x9c040,&param_2,2,(LPVOID)0x0,0,&local_8,(LPOVERLAPPED)0x0);
        hDevice = (HANDLE)CloseHandle(hDevice);
      }
    }
  }
  return CONCAT31((int3)((uint)hDevice >> 8),1);
}



// Function: FUN_67689c05 at 67689c05

void __thiscall FUN_67689c05(void *this,int param_1,int param_2)

{
  ushort uVar1;
  
  *(ushort *)((int)this + 0x14) = *(ushort *)((int)this + 0x14) & 0xfff9;
  uVar1 = *(ushort *)((int)this + 0x14);
  if ((param_1 == 0) || (param_2 == 0)) {
    *(undefined2 *)((int)this + 0x16) = 0;
    *(undefined2 *)((int)this + 0x12) = 10;
  }
  else if ((-1 < param_1) && (param_1 < 10)) {
    if (param_1 < 3) {
      uVar1 = uVar1 | 4;
    }
    else if (7 < param_1) {
      uVar1 = uVar1 | 2;
    }
    *(ushort *)((int)this + 0x14) = uVar1;
    *(short *)((int)this + 0x16) = (short)param_2;
    if (((param_2 == 8) || (param_2 == 0x12)) || (param_2 != 9)) {
      *(undefined2 *)((int)this + 0x12) = 0x14;
    }
    else {
      *(undefined2 *)((int)this + 0x12) = 0x15;
    }
  }
  return;
}



// Function: FUN_67689c79 at 67689c79

undefined4 * __thiscall FUN_67689c79(void *this,byte param_1)

{
  *(undefined ***)this = &PTR_FUN_676b9c30;
  FUN_676aeb74((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_67689c9b at 67689c9b

undefined4 * __fastcall FUN_67689c9b(undefined4 *param_1)

{
  FUN_67689d02(param_1);
  *param_1 = &PTR_FUN_676b9c40;
  return param_1;
}



// Function: FUN_67689cad at 67689cad

int * __thiscall FUN_67689cad(void *this,byte param_1)

{
  FUN_67689cc9((int *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (int *)this;
}



// Function: FUN_67689cc9 at 67689cc9

void __fastcall FUN_67689cc9(int *param_1)

{
  *param_1 = (int)&PTR_FUN_676b9c40;
  FUN_67688400(param_1);
  FUN_67689d20(param_1);
  return;
}



// Function: FUN_67689ce0 at 67689ce0

undefined4 __thiscall FUN_67689ce0(void *this,int *param_1)

{
  int iVar1;
  undefined4 uVar2;
  
  if (param_1 == (int *)0x0) {
    uVar2 = 0;
  }
  else {
                    /* WARNING: Load size is inaccurate */
    iVar1 = *this;
    uVar2 = (**(code **)(*param_1 + 4))();
    uVar2 = (**(code **)(iVar1 + 0x44))(uVar2);
  }
  return uVar2;
}



// Function: FUN_67689d02 at 67689d02

undefined4 * __fastcall FUN_67689d02(undefined4 *param_1)

{
  FUN_676aec78(param_1);
  FUN_67689de9(param_1 + 4);
  *(undefined1 *)(param_1 + 10) = 0;
  *param_1 = &PTR_FUN_676b9c8c;
  return param_1;
}



// Function: FUN_67689d20 at 67689d20

void __fastcall FUN_67689d20(undefined4 *param_1)

{
  undefined4 uVar1;
  undefined4 *local_8;
  
  local_8 = (undefined4 *)0x0;
  *param_1 = &PTR_FUN_676b9c8c;
  while( true ) {
    uVar1 = FUN_6768881a(param_1 + 4,&local_8);
    if ((char)uVar1 == '\0') break;
    if (local_8 != (undefined4 *)0x0) {
      (**(code **)*local_8)(1);
    }
  }
  FUN_67689d65(param_1 + 4);
  FUN_676aeca8(param_1);
  return;
}



// Function: FUN_67689d65 at 67689d65

void __fastcall FUN_67689d65(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b9cd8;
  while (param_1[1] != 0) {
    FUN_67689e80(param_1,(undefined4 *)0x0);
  }
  if ((undefined4 *)param_1[3] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[3])(1);
  }
  if ((undefined4 *)param_1[4] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[4])(1);
  }
  return;
}



// Function: FUN_67689d9b at 67689d9b

void __fastcall FUN_67689d9b(void *param_1)

{
  while (*(int *)((int)param_1 + 4) != 0) {
    FUN_67689e80(param_1,(undefined4 *)0x0);
  }
  return;
}



// Function: FUN_67689db1 at 67689db1

undefined4 * __thiscall FUN_67689db1(void *this,byte param_1)

{
  FUN_67689d65((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_67689dcd at 67689dcd

undefined * __thiscall FUN_67689dcd(void *this,byte param_1)

{
  FUN_67689d20((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined *)this;
}



// Function: FUN_67689de9 at 67689de9

undefined4 * __fastcall FUN_67689de9(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  
  *param_1 = &PTR_FUN_676b9cd8;
  puVar2 = (undefined4 *)operator_new(0x14);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    *puVar2 = &PTR_FUN_676b9a34;
    puVar2[2] = 0;
    puVar2[3] = 0;
    puVar2[4] = 1;
  }
  param_1[3] = puVar2;
  puVar2 = (undefined4 *)operator_new(0x14);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    *puVar2 = &PTR_FUN_676b9a34;
    puVar2[2] = 0;
    puVar2[3] = 0;
    puVar2[4] = 2;
  }
  puVar1 = (undefined4 *)param_1[3];
  param_1[4] = puVar2;
  if (puVar1 != (undefined4 *)0x0) {
    if (puVar2 != (undefined4 *)0x0) goto LAB_67689e67;
    if (puVar1 != (undefined4 *)0x0) {
      (**(code **)*puVar1)(1);
      param_1[3] = 0;
    }
  }
  if ((undefined4 *)param_1[4] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[4])(1);
    param_1[4] = 0;
  }
LAB_67689e67:
  FUN_67688a50(param_1,0);
  FUN_67688a82(param_1,0);
  param_1[5] = 0;
  return param_1;
}



// Function: FUN_67689e80 at 67689e80

uint __thiscall FUN_67689e80(void *this,undefined4 *param_1)

{
  undefined4 *puVar1;
  uint in_EAX;
  uint uVar2;
  
  puVar1 = *(undefined4 **)((int)this + 4);
  if (puVar1 == (undefined4 *)0x0) {
    uVar2 = in_EAX & 0xffffff00;
  }
  else {
    FUN_67688a50(this,puVar1[3]);
    if (*(int *)((int)this + 4) == 0) {
      FUN_67688a82(this,0);
    }
    if (param_1 != (undefined4 *)0x0) {
      *param_1 = puVar1[1];
    }
    *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + -1;
    if (puVar1 != (undefined4 *)0x0) {
      param_1 = (undefined4 *)(**(code **)*puVar1)(1);
    }
    uVar2 = CONCAT31((int3)((uint)param_1 >> 8),1);
  }
  return uVar2;
}



// Function: FUN_67689ecb at 67689ecb

undefined4 * __fastcall FUN_67689ecb(undefined4 *param_1)

{
  FUN_67689c9b(param_1);
  FUN_67689d02(param_1 + 0xb);
  *param_1 = &PTR_FUN_676b9ce0;
  return param_1;
}



// Function: FUN_67689ee5 at 67689ee5

int * __thiscall FUN_67689ee5(void *this,byte param_1)

{
  FUN_67689f01((int *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (int *)this;
}



// Function: FUN_67689f01 at 67689f01

void __fastcall FUN_67689f01(int *param_1)

{
  *param_1 = (int)&PTR_FUN_676b9ce0;
  FUN_67689fca(param_1);
  FUN_67689d20(param_1 + 0xb);
  FUN_67689cc9(param_1);
  return;
}



// Function: FUN_67689fca at 67689fca

void __fastcall FUN_67689fca(int *param_1)

{
  undefined4 *puVar1;
  
  while( true ) {
    puVar1 = (undefined4 *)(**(code **)(param_1[0xb] + 0x18))();
    if (puVar1 == (undefined4 *)0x0) break;
    (**(code **)*puVar1)(1);
  }
  FUN_67688400(param_1);
  return;
}



// Function: FUN_67689ff0 at 67689ff0

undefined4 * __fastcall FUN_67689ff0(undefined4 *param_1)

{
  void *pvVar1;
  
  param_1[8] = 0;
  *param_1 = &PTR_FUN_676b9d2c;
  pvVar1 = operator_new(0xffff);
  param_1[9] = pvVar1;
  FUN_6768a059((int)param_1);
  return param_1;
}



// Function: FUN_6768a016 at 6768a016

undefined4 * __thiscall FUN_6768a016(void *this,byte param_1)

{
  FUN_6768a032((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_6768a032 at 6768a032

void __fastcall FUN_6768a032(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b9d2c;
  if ((undefined *)param_1[8] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[8]);
  }
  if ((undefined *)param_1[9] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[9]);
  }
  return;
}



// Function: FUN_6768a059 at 6768a059

void __fastcall FUN_6768a059(int param_1)

{
  *(undefined2 *)(param_1 + 4) = 0;
  *(undefined2 *)(param_1 + 6) = 0;
  *(undefined2 *)(param_1 + 8) = 0;
  *(undefined2 *)(param_1 + 10) = 0;
  *(undefined2 *)(param_1 + 0xc) = 0;
  *(undefined4 *)(param_1 + 0xe) = 0;
  *(undefined4 *)(param_1 + 0x12) = 0;
  *(undefined4 *)(param_1 + 0x16) = 0;
  *(undefined2 *)(param_1 + 0x1a) = 0;
  *(undefined2 *)(param_1 + 0x1c) = 0;
  if (*(undefined **)(param_1 + 0x20) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)(param_1 + 0x20));
    *(undefined4 *)(param_1 + 0x20) = 0;
  }
  return;
}



// Function: FUN_6768a098 at 6768a098

uint __thiscall FUN_6768a098(void *this,void *param_1,int param_2)

{
  void *this_00;
  ushort uVar1;
  uint uVar2;
  void *pvVar3;
  int iVar4;
  
  if ((*(int *)((int)this + 0x20) == 0) && (*(int *)((int)this + 0x24) != 0)) {
    this_00 = (void *)(param_2 + 0x30);
    uVar2 = FUN_6768d2cc(this_00,param_1,(LPVOID)(-(uint)(this != (void *)0x0) & (int)this + 4U),
                         0x1a);
    if ((char)uVar2 == '\0') goto LAB_6768a14e;
    uVar1 = *(ushort *)((int)this + 0x1a);
    uVar2 = CONCAT22((short)(uVar2 >> 0x10),uVar1);
    if (uVar1 != 0) {
      pvVar3 = operator_new(uVar1 + 1);
      *(void **)((int)this + 0x20) = pvVar3;
      if (pvVar3 == (void *)0x0) {
        iVar4 = 0x1ff;
        goto LAB_6768a146;
      }
      *(undefined1 *)((uint)*(ushort *)((int)this + 0x1a) + (int)pvVar3) = 0;
      uVar2 = FUN_6768d2cc(this_00,param_1,*(LPVOID *)((int)this + 0x20),
                           (uint)*(ushort *)((int)this + 0x1a));
      if ((char)uVar2 == '\0') goto LAB_6768a14e;
    }
    uVar1 = *(ushort *)((int)this + 0x1c);
    uVar2 = CONCAT22((short)(uVar2 >> 0x10),uVar1);
    if ((uVar1 == 0) ||
       (uVar2 = FUN_6768d2cc(this_00,param_1,*(LPVOID *)((int)this + 0x24),(uint)uVar1),
       (char)uVar2 != '\0')) {
      return CONCAT31((int3)(uVar2 >> 8),1);
    }
  }
  else {
    iVar4 = 999;
LAB_6768a146:
    uVar2 = FUN_6767ca9c(param_1,iVar4,0x4000000);
  }
LAB_6768a14e:
  return uVar2 & 0xffffff00;
}



// Function: FUN_6768a156 at 6768a156

uint __thiscall FUN_6768a156(void *this,void *param_1,int param_2,char param_3)

{
  void *this_00;
  ushort uVar1;
  uint uVar2;
  undefined4 local_8;
  
  this_00 = (void *)(param_2 + 0x30);
  local_8 = 0x4034b50;
  uVar2 = FUN_6768d357(this_00,param_1,&local_8,4,0);
  if (((char)uVar2 != '\0') &&
     (uVar2 = FUN_6768d357(this_00,param_1,
                           (undefined4 *)(-(uint)(this != (void *)0x0) & (int)this + 4U),0x1a,0),
     (char)uVar2 != '\0')) {
    uVar1 = *(ushort *)((int)this + 0x1a);
    uVar2 = CONCAT22((short)(uVar2 >> 0x10),uVar1);
    if ((uVar1 == 0) ||
       (uVar2 = FUN_6768d357(this_00,param_1,*(undefined4 **)((int)this + 0x20),(uint)uVar1,0),
       (char)uVar2 != '\0')) {
      if (param_3 != '\0') {
        uVar1 = *(ushort *)((int)this + 0x1c);
        uVar2 = CONCAT22((short)(uVar2 >> 0x10),uVar1);
        if ((uVar1 != 0) &&
           (uVar2 = FUN_6768d357(this_00,param_1,*(undefined4 **)((int)this + 0x24),(uint)uVar1,0),
           (char)uVar2 == '\0')) goto LAB_6768a1e3;
      }
      return CONCAT31((int3)(uVar2 >> 8),1);
    }
  }
LAB_6768a1e3:
  return uVar2 & 0xffffff00;
}



// Function: FUN_6768a1f0 at 6768a1f0

undefined4 * __fastcall FUN_6768a1f0(undefined4 *param_1)

{
  int iVar1;
  undefined4 *puVar2;
  
  FUN_676ae3ab(param_1 + 1,0);
  FUN_676ae3ab(param_1 + 8,0);
  FUN_676ae3ab(param_1 + 0xf,0);
  FUN_676ae3ab(param_1 + 0x38,0);
  FUN_676ae3ab(param_1 + 0x3f,0);
  FUN_676ae3ab(param_1 + 0x47,0);
  *param_1 = &PTR_FUN_676b9d48;
  puVar2 = param_1 + 0x16;
  for (iVar1 = 0xd; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  puVar2 = param_1 + 0x23;
  for (iVar1 = 0xd; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  param_1[0x30] = 0;
  param_1[0x31] = 0;
  param_1[0x32] = 0;
  param_1[0x33] = 0;
  param_1[0x34] = 0;
  FUN_6768bd75(param_1);
  FUN_6768be84(param_1);
  FUN_6768bf99(param_1);
  param_1[0x35] = 0;
  param_1[0x36] = 0;
  param_1[0x37] = 0;
  param_1[0x46] = 0;
  param_1[0x4e] = 0;
  *(undefined2 *)(param_1 + 0x4f) = 0;
  *(undefined1 *)((int)param_1 + 0x346) = 0;
  param_1[0xd2] = 0;
  param_1[0xd3] = 0;
  *(undefined1 *)(param_1 + 0xd4) = 0;
  *(undefined1 *)((int)param_1 + 0x351) = 0;
  return param_1;
}



// Function: FUN_6768a2ba at 6768a2ba

undefined4 * __thiscall FUN_6768a2ba(void *this,byte param_1)

{
  FUN_6768a2d6((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_6768a2d6 at 6768a2d6

void __fastcall FUN_6768a2d6(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b9d48;
  FUN_6768c03e((int)param_1);
  FUN_6768c05f((int)param_1);
  FUN_6768c083((int)param_1);
  if ((undefined *)param_1[0x35] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[0x35]);
  }
  if ((undefined *)param_1[0x36] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[0x36]);
  }
  if ((undefined *)param_1[0x37] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[0x37]);
  }
  if ((undefined *)param_1[0x46] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[0x46]);
  }
  if ((undefined *)param_1[0x4e] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[0x4e]);
  }
  if ((undefined *)param_1[0xd3] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[0xd3]);
  }
  FUN_676ae3e2(param_1 + 0x47);
  FUN_676ae3e2(param_1 + 0x3f);
  FUN_676ae3e2(param_1 + 0x38);
  FUN_676ae3e2(param_1 + 0xf);
  FUN_676ae3e2(param_1 + 8);
  FUN_676ae3e2(param_1 + 1);
  return;
}



// Function: FUN_6768a393 at 6768a393

undefined1 __thiscall FUN_6768a393(void *this,void *param_1,uint *param_2,ushort *param_3)

{
  undefined2 uVar1;
  void *pvVar2;
  ushort uVar3;
  int iVar4;
  undefined4 uVar5;
  undefined *puVar6;
  ushort *puVar7;
  LPCWSTR pWVar8;
  uint uVar9;
  undefined1 uVar10;
  char *pcVar11;
  undefined1 local_60 [4];
  LPCWSTR local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined **local_4c;
  LPCWSTR local_48;
  undefined1 local_44;
  undefined **local_40;
  LPCWSTR local_3c;
  undefined1 local_38;
  undefined **local_34;
  LPCWSTR local_30;
  undefined1 local_2c;
  uint local_28;
  undefined2 uStack_24;
  undefined1 uStack_22;
  LPCWSTR local_20;
  ushort *local_1c;
  LPCWSTR local_18;
  ushort local_14 [2];
  LPCWSTR local_10;
  void *local_c;
  char local_5;
  
  uVar1 = DAT_676c0700;
  local_28 = DAT_676c06fc;
  uStack_24 = DAT_676c0700;
  uStack_22 = DAT_676c0702;
  *param_2 = DAT_676c06fc;
  *(undefined2 *)(param_2 + 1) = uVar1;
  *param_3 = 6;
  uVar10 = 0;
  local_14[0] = 0x3c96;
  local_14[1] = 0;
  if ((*(short **)((int)this + 0xa0) == (short *)0x0) || (**(short **)((int)this + 0xa0) == 0)) {
    uVar3 = 0;
  }
  else {
    uVar3 = 1;
  }
  local_c = this;
  FUN_6768c14f(uVar3,local_14,(int)param_2,param_3);
  if ((*(short **)((int)this + 0xbc) == (short *)0x0) || (**(short **)((int)this + 0xbc) == 0)) {
    uVar3 = 0;
  }
  else {
    uVar3 = 1;
  }
  FUN_6768c14f(uVar3,local_14,(int)param_2,param_3);
  if ((*(short **)((int)this + 0xa4) == (short *)0x0) || (**(short **)((int)this + 0xa4) == 0)) {
    uVar3 = 0;
  }
  else {
    uVar3 = 1;
  }
  FUN_6768c14f(uVar3,local_14,(int)param_2,param_3);
  if ((*(short **)((int)this + 0xb4) == (short *)0x0) || (**(short **)((int)this + 0xb4) == 0)) {
    uVar3 = 0;
  }
  else {
    uVar3 = 1;
  }
  FUN_6768c14f(uVar3,local_14,(int)param_2,param_3);
  if ((*(short **)((int)this + 0x8c) == (short *)0x0) || (**(short **)((int)this + 0x8c) == 0)) {
    uVar3 = 0;
  }
  else {
    uVar3 = 1;
  }
  FUN_6768c14f(uVar3,local_14,(int)param_2,param_3);
  if ((*(short **)((int)this + 0x90) == (short *)0x0) || (**(short **)((int)this + 0x90) == 0)) {
    uVar3 = 0;
  }
  else {
    uVar3 = 1;
  }
  FUN_6768c14f(uVar3,local_14,(int)param_2,param_3);
  if ((*(short **)((int)this + 0x94) == (short *)0x0) || (**(short **)((int)this + 0x94) == 0)) {
    uVar3 = 0;
  }
  else {
    uVar3 = 1;
  }
  FUN_6768c14f(uVar3,local_14,(int)param_2,param_3);
  pvVar2 = local_c;
  if ((*(short **)((int)this + 0x98) == (short *)0x0) || (**(short **)((int)this + 0x98) == 0)) {
    uVar3 = 0;
  }
  else {
    uVar3 = 1;
  }
  FUN_6768c14f(uVar3,local_14,(int)param_2,param_3);
  local_18 = *(LPCWSTR *)((int)pvVar2 + 0x58);
  if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)&DAT_676c5098;
  }
  else if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)(ushort *)0x0;
  }
  else {
    iVar4 = lstrlenW(local_18);
    local_10 = (LPCWSTR)(iVar4 * 2 + 2);
    FUN_676b06a0();
    local_20 = (LPCWSTR)&stack0xffffff94;
    WideCharToMultiByte(0,0,local_18,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
    pWVar8 = local_20;
  }
  FUN_6768c0a7((ushort *)pWVar8,local_14,(int)param_2,param_3);
  local_18 = *(LPCWSTR *)((int)local_c + 0x5c);
  if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)&DAT_676c5098;
  }
  else if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)(ushort *)0x0;
  }
  else {
    iVar4 = lstrlenW(local_18);
    local_10 = (LPCWSTR)(iVar4 * 2 + 2);
    FUN_676b06a0();
    local_20 = (LPCWSTR)&stack0xffffff94;
    WideCharToMultiByte(0,0,local_18,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
    pWVar8 = local_20;
  }
  FUN_6768c0a7((ushort *)pWVar8,local_14,(int)param_2,param_3);
  local_18 = *(LPCWSTR *)((int)local_c + 0x60);
  if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)&DAT_676c5098;
  }
  else if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)(ushort *)0x0;
  }
  else {
    iVar4 = lstrlenW(local_18);
    local_10 = (LPCWSTR)(iVar4 * 2 + 2);
    FUN_676b06a0();
    local_20 = (LPCWSTR)&stack0xffffff94;
    WideCharToMultiByte(0,0,local_18,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
    pWVar8 = local_20;
  }
  FUN_6768c0a7((ushort *)pWVar8,local_14,(int)param_2,param_3);
  local_18 = *(LPCWSTR *)((int)local_c + 100);
  if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)&DAT_676c5098;
  }
  else if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)(ushort *)0x0;
  }
  else {
    iVar4 = lstrlenW(local_18);
    local_10 = (LPCWSTR)(iVar4 * 2 + 2);
    FUN_676b06a0();
    local_20 = (LPCWSTR)&stack0xffffff94;
    WideCharToMultiByte(0,0,local_18,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
    pWVar8 = local_20;
  }
  FUN_6768c0a7((ushort *)pWVar8,local_14,(int)param_2,param_3);
  local_18 = *(LPCWSTR *)((int)local_c + 0x68);
  if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)&DAT_676c5098;
  }
  else if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)(ushort *)0x0;
  }
  else {
    iVar4 = lstrlenW(local_18);
    local_10 = (LPCWSTR)(iVar4 * 2 + 2);
    FUN_676b06a0();
    local_20 = (LPCWSTR)&stack0xffffff94;
    WideCharToMultiByte(0,0,local_18,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
    pWVar8 = local_20;
  }
  FUN_6768c0a7((ushort *)pWVar8,local_14,(int)param_2,param_3);
  local_18 = *(LPCWSTR *)((int)local_c + 0x6c);
  if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)&DAT_676c5098;
  }
  else if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)(ushort *)0x0;
  }
  else {
    iVar4 = lstrlenW(local_18);
    local_10 = (LPCWSTR)(iVar4 * 2 + 2);
    FUN_676b06a0();
    local_20 = (LPCWSTR)&stack0xffffff94;
    WideCharToMultiByte(0,0,local_18,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
    pWVar8 = local_20;
  }
  FUN_6768c0a7((ushort *)pWVar8,local_14,(int)param_2,param_3);
  local_18 = *(LPCWSTR *)((int)local_c + 0x70);
  if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)&DAT_676c5098;
  }
  else if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)(ushort *)0x0;
  }
  else {
    iVar4 = lstrlenW(local_18);
    local_10 = (LPCWSTR)(iVar4 * 2 + 2);
    FUN_676b06a0();
    local_20 = (LPCWSTR)&stack0xffffff94;
    WideCharToMultiByte(0,0,local_18,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
    pWVar8 = local_20;
  }
  FUN_6768c0a7((ushort *)pWVar8,local_14,(int)param_2,param_3);
  local_18 = *(LPCWSTR *)((int)local_c + 0x74);
  if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)&DAT_676c5098;
  }
  else if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)(ushort *)0x0;
  }
  else {
    iVar4 = lstrlenW(local_18);
    local_10 = (LPCWSTR)(iVar4 * 2 + 2);
    FUN_676b06a0();
    local_20 = (LPCWSTR)&stack0xffffff94;
    WideCharToMultiByte(0,0,local_18,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
    pWVar8 = local_20;
  }
  FUN_6768c0a7((ushort *)pWVar8,local_14,(int)param_2,param_3);
  local_18 = *(LPCWSTR *)((int)local_c + 0x78);
  if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)&DAT_676c5098;
  }
  else if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)(ushort *)0x0;
  }
  else {
    iVar4 = lstrlenW(local_18);
    local_10 = (LPCWSTR)(iVar4 * 2 + 2);
    FUN_676b06a0();
    local_20 = (LPCWSTR)&stack0xffffff94;
    WideCharToMultiByte(0,0,local_18,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
    pWVar8 = local_20;
  }
  FUN_6768c0a7((ushort *)pWVar8,local_14,(int)param_2,param_3);
  local_18 = *(LPCWSTR *)((int)local_c + 0x7c);
  if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)&DAT_676c5098;
  }
  else if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)(ushort *)0x0;
  }
  else {
    iVar4 = lstrlenW(local_18);
    local_10 = (LPCWSTR)(iVar4 * 2 + 2);
    FUN_676b06a0();
    local_20 = (LPCWSTR)&stack0xffffff94;
    WideCharToMultiByte(0,0,local_18,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
    pWVar8 = local_20;
  }
  FUN_6768c0a7((ushort *)pWVar8,local_14,(int)param_2,param_3);
  local_18 = *(LPCWSTR *)((int)local_c + 0x80);
  if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)&DAT_676c5098;
  }
  else if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)(ushort *)0x0;
  }
  else {
    iVar4 = lstrlenW(local_18);
    local_10 = (LPCWSTR)(iVar4 * 2 + 2);
    FUN_676b06a0();
    local_20 = (LPCWSTR)&stack0xffffff94;
    WideCharToMultiByte(0,0,local_18,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
    pWVar8 = local_20;
  }
  FUN_6768c0a7((ushort *)pWVar8,local_14,(int)param_2,param_3);
  local_18 = *(LPCWSTR *)((int)local_c + 0xd4);
  if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)&DAT_676c5098;
  }
  else if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)(ushort *)0x0;
  }
  else {
    iVar4 = lstrlenW(local_18);
    local_10 = (LPCWSTR)(iVar4 * 2 + 2);
    FUN_676b06a0();
    local_20 = (LPCWSTR)&stack0xffffff94;
    WideCharToMultiByte(0,0,local_18,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
    pWVar8 = local_20;
  }
  FUN_6768c0a7((ushort *)pWVar8,local_14,(int)param_2,param_3);
  FUN_6768c14f(*(ushort *)((int)local_c + 0x348),local_14,(int)param_2,param_3);
  local_18 = *(LPCWSTR *)((int)local_c + 0xd8);
  if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)&DAT_676c5098;
  }
  else if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)(ushort *)0x0;
  }
  else {
    iVar4 = lstrlenW(local_18);
    local_10 = (LPCWSTR)(iVar4 * 2 + 2);
    FUN_676b06a0();
    local_20 = (LPCWSTR)&stack0xffffff94;
    WideCharToMultiByte(0,0,local_18,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
    pWVar8 = local_20;
  }
  FUN_6768c0a7((ushort *)pWVar8,local_14,(int)param_2,param_3);
  local_18 = *(LPCWSTR *)((int)local_c + 0x118);
  if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)&DAT_676c5098;
  }
  else if (local_18 == (LPCWSTR)0x0) {
    pWVar8 = (LPCWSTR)(ushort *)0x0;
  }
  else {
    iVar4 = lstrlenW(local_18);
    local_10 = (LPCWSTR)(iVar4 * 2 + 2);
    FUN_676b06a0();
    local_20 = (LPCWSTR)&stack0xffffff94;
    WideCharToMultiByte(0,0,local_18,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
    pWVar8 = local_20;
  }
  FUN_6768c0a7((ushort *)pWVar8,local_14,(int)param_2,param_3);
  iVar4 = FUN_67683c61();
  uVar5 = FUN_676abcf2(iVar4);
  if ((((char)uVar5 == '\0') || (*(char *)((int)local_c + 0x350) != '\x01')) ||
     (*(byte *)((int)local_c + 0x351) < 3)) {
    local_20 = FUN_676ae4ce((int)local_c + 0x11c);
    local_30 = (LPCWSTR)0x0;
    local_2c = 0;
    local_34 = &PTR_FUN_676b9b1c;
    FUN_676850f1((int)&local_34);
    local_2c = 0;
    local_30 = local_20;
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
LAB_6768b013:
    local_34 = &PTR_FUN_676b9b1c;
    FUN_676850f1((int)&local_34);
    local_20 = *(LPCWSTR *)((int)local_c + 0xa0);
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)0x0;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
    local_20 = *(LPCWSTR *)((int)local_c + 0xa4);
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)0x0;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
    local_20 = *(LPCWSTR *)((int)local_c + 0xa8);
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)0x0;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
    local_20 = *(LPCWSTR *)((int)local_c + 0xac);
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)0x0;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
    local_20 = *(LPCWSTR *)((int)local_c + 0xb0);
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)0x0;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
    local_20 = *(LPCWSTR *)((int)local_c + 0xb4);
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)0x0;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
    local_20 = *(LPCWSTR *)((int)local_c + 0xb8);
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)0x0;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
    local_20 = *(LPCWSTR *)((int)local_c + 0xbc);
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)0x0;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
    local_20 = *(LPCWSTR *)((int)local_c + 0xc0);
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)0x0;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
    local_20 = *(LPCWSTR *)((int)local_c + 0xc4);
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)0x0;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
    local_20 = *(LPCWSTR *)((int)local_c + 200);
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)0x0;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
    local_20 = *(LPCWSTR *)((int)local_c + 0xcc);
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)0x0;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
    local_20 = *(LPCWSTR *)((int)local_c + 0xd0);
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)0x0;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
    uVar5 = FUN_676abcb6(0);
    local_5 = (char)uVar5;
    if (local_5 == '\0') {
      pcVar11 = s_Xceed_Zip_Self_Extractor___Trial_676c06b0;
    }
    else {
      pcVar11 = &DAT_676c5098;
    }
    FUN_6768c0a7((ushort *)pcVar11,local_14,(int)param_2,param_3);
    local_20 = *(LPCWSTR *)((int)local_c + 0x8c);
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)0x0;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
    local_20 = *(LPCWSTR *)((int)local_c + 0x90);
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)0x0;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
    local_20 = *(LPCWSTR *)((int)local_c + 0x94);
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)0x0;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
    local_20 = *(LPCWSTR *)((int)local_c + 0x98);
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)0x0;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
    if (local_5 == '\0') {
      pcVar11 = s_This_self_extracting_zip_file_wa_676c05ac;
    }
    else {
      pcVar11 = &DAT_676c5098;
    }
    FUN_6768c0a7((ushort *)pcVar11,local_14,(int)param_2,param_3);
    local_20 = *(LPCWSTR *)((int)local_c + 0xdc);
    if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)&DAT_676c5098;
    }
    else if (local_20 == (LPCWSTR)0x0) {
      puVar7 = (ushort *)0x0;
    }
    else {
      iVar4 = lstrlenW(local_20);
      local_10 = (LPCWSTR)(iVar4 * 2 + 2);
      FUN_676b06a0();
      local_1c = (ushort *)&stack0xffffff94;
      WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
      puVar7 = local_1c;
    }
    FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
    local_20 = FUN_676ae4ce((int)local_c + 0xe0);
    local_48 = (LPCWSTR)0x0;
    local_44 = 0;
    local_4c = &PTR_FUN_676b9b1c;
    FUN_676850f1((int)&local_4c);
    local_48 = local_20;
    local_44 = 0;
    uVar5 = FUN_6768c8fd(local_20,2);
    if ((char)uVar5 == '\0') {
      FUN_6767ca9c(param_1,0x213,0x4000000);
    }
    else {
      if (local_48 == (LPCWSTR)0x0) {
        pWVar8 = (LPCWSTR)&DAT_676c5098;
      }
      else {
        local_18 = local_48;
        if (local_48 == (LPCWSTR)0x0) {
          pWVar8 = (LPCWSTR)0x0;
        }
        else {
          iVar4 = lstrlenW(local_48);
          local_10 = (LPCWSTR)(iVar4 * 2 + 2);
          FUN_676b06a0();
          local_20 = (LPCWSTR)&stack0xffffff94;
          WideCharToMultiByte(0,0,local_18,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0
                             );
          pWVar8 = local_20;
        }
      }
      FUN_6768c0a7((ushort *)pWVar8,local_14,(int)param_2,param_3);
      local_20 = FUN_676ae4ce((int)local_c + 0xfc);
      local_3c = (LPCWSTR)0x0;
      local_38 = 0;
      local_40 = &PTR_FUN_676b9b1c;
      FUN_676850f1((int)&local_40);
      local_3c = local_20;
      local_38 = 0;
      uVar5 = FUN_6768c8fd(local_20,3);
      if ((char)uVar5 == '\0') {
        FUN_6767ca9c(param_1,0x213,0x4000000);
        uVar10 = 0;
      }
      else {
        if (local_3c == (LPCWSTR)0x0) {
          puVar7 = (ushort *)&DAT_676c5098;
        }
        else {
          local_18 = local_3c;
          if (local_3c == (LPCWSTR)0x0) {
            puVar7 = (ushort *)0x0;
          }
          else {
            puVar7 = (ushort *)&stack0xffffff94;
            iVar4 = lstrlenW(local_3c);
            local_10 = (LPCWSTR)(iVar4 * 2 + 2);
            FUN_676b06a0();
            WideCharToMultiByte(0,0,local_18,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,
                                (LPBOOL)0x0);
          }
        }
        FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
        FUN_6768c14f((ushort)(*(char *)((int)local_c + 0x346) != '\0'),local_14,(int)param_2,param_3
                    );
        pWVar8 = *(LPCWSTR *)((int)local_c + 0x9c);
        if (pWVar8 == (LPCWSTR)0x0) {
          pWVar8 = (LPCWSTR)&DAT_676c5098;
        }
        else if (pWVar8 == (LPCWSTR)0x0) {
          pWVar8 = (LPCWSTR)0x0;
        }
        else {
          iVar4 = lstrlenW(pWVar8);
          local_10 = (LPCWSTR)(iVar4 * 2 + 2);
          FUN_676b06a0();
          local_20 = (LPCWSTR)&stack0xffffff94;
          WideCharToMultiByte(0,0,pWVar8,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
          pWVar8 = local_20;
        }
        FUN_6768c0a7((ushort *)pWVar8,local_14,(int)param_2,param_3);
        if ((*(short **)((int)local_c + 0x9c) == (short *)0x0) ||
           (**(short **)((int)local_c + 0x9c) == 0)) {
          uVar3 = 0;
        }
        else {
          uVar3 = 1;
        }
        FUN_6768c14f(uVar3,local_14,(int)param_2,param_3);
        pWVar8 = *(LPCWSTR *)((int)local_c + 0x84);
        if (pWVar8 == (LPCWSTR)0x0) {
          pWVar8 = (LPCWSTR)&DAT_676c5098;
        }
        else if (pWVar8 == (LPCWSTR)0x0) {
          pWVar8 = (LPCWSTR)0x0;
        }
        else {
          iVar4 = lstrlenW(pWVar8);
          local_10 = (LPCWSTR)(iVar4 * 2 + 2);
          FUN_676b06a0();
          local_20 = (LPCWSTR)&stack0xffffff94;
          WideCharToMultiByte(0,0,pWVar8,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
          pWVar8 = local_20;
        }
        FUN_6768c0a7((ushort *)pWVar8,local_14,(int)param_2,param_3);
        pWVar8 = *(LPCWSTR *)((int)local_c + 0x88);
        if (pWVar8 == (LPCWSTR)0x0) {
          puVar7 = (ushort *)&DAT_676c5098;
        }
        else if (pWVar8 == (LPCWSTR)0x0) {
          puVar7 = (ushort *)0x0;
        }
        else {
          puVar7 = (ushort *)&stack0xffffff94;
          iVar4 = lstrlenW(pWVar8);
          local_10 = (LPCWSTR)(iVar4 * 2 + 2);
          FUN_676b06a0();
          WideCharToMultiByte(0,0,pWVar8,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0);
        }
        FUN_6768c0a7(puVar7,local_14,(int)param_2,param_3);
        local_28 = 0;
        uVar9 = FUN_676ac68f(&local_28);
        FUN_6768c14f((ushort)uVar9,local_14,(int)param_2,param_3);
        FUN_6768c14f((ushort)(uVar9 >> 0x10),local_14,(int)param_2,param_3);
        FUN_6768c14f((ushort)local_28,local_14,(int)param_2,param_3);
        FUN_6768c14f((ushort)(local_28 >> 0x10),local_14,(int)param_2,param_3);
        FUN_6768c14f(0,local_14,(int)param_2,param_3);
        uVar10 = 1;
      }
      local_40 = &PTR_FUN_676b9b1c;
      FUN_676850f1((int)&local_40);
    }
    local_4c = &PTR_FUN_676b9b1c;
    FUN_676850f1((int)&local_4c);
    return uVar10;
  }
  puVar6 = *(undefined **)((int)local_c + 8);
  local_20 = (LPCWSTR)0x0;
  if ((puVar6 == (undefined *)0x0) &&
     (puVar6 = *(undefined **)((int)local_c + 0x14), puVar6 == (undefined *)0x0)) {
    puVar6 = &DAT_676c5678;
  }
  FUN_6768199d(local_60,(int)puVar6);
  while( true ) {
    puVar6 = *(undefined **)((int)local_c + 0x14);
    if (puVar6 == (undefined *)0x0) {
      puVar6 = &DAT_676c5678;
    }
    uVar5 = FUN_6768c972(local_60,(int)puVar6);
    if ((char)uVar5 == '\0') break;
    iVar4 = FUN_676ae2a4(local_5c);
    local_20 = (LPCWSTR)((int)local_20 + iVar4 + 4);
    FUN_676819c4((int)local_60);
  }
  local_1c = (ushort *)0x0;
  puVar6 = *(undefined **)((int)local_c + 0x24);
  if ((puVar6 == (undefined *)0x0) &&
     (puVar6 = *(undefined **)((int)local_c + 0x30), puVar6 == (undefined *)0x0)) {
    puVar6 = &DAT_676c5678;
  }
  local_5c = *(LPCWSTR *)(puVar6 + 4);
  local_58 = *(undefined4 *)(puVar6 + 8);
  local_54 = *(undefined4 *)(puVar6 + 0xc);
  local_50 = *(undefined4 *)(puVar6 + 0x10);
  while( true ) {
    puVar6 = *(undefined **)((int)local_c + 0x30);
    if (puVar6 == (undefined *)0x0) {
      puVar6 = &DAT_676c5678;
    }
    uVar5 = FUN_6768c972(local_60,(int)puVar6);
    if ((char)uVar5 == '\0') break;
    iVar4 = FUN_676ae2a4(local_5c);
    local_1c = (ushort *)((int)local_1c + iVar4 + 4);
    FUN_676819c4((int)local_60);
  }
  local_18 = (LPCWSTR)0x0;
  puVar6 = *(undefined **)((int)local_c + 0x40);
  if ((puVar6 == (undefined *)0x0) &&
     (puVar6 = *(undefined **)((int)local_c + 0x4c), puVar6 == (undefined *)0x0)) {
    puVar6 = &DAT_676c5678;
  }
  local_5c = *(LPCWSTR *)(puVar6 + 4);
  local_58 = *(undefined4 *)(puVar6 + 8);
  local_54 = *(undefined4 *)(puVar6 + 0xc);
  local_50 = *(undefined4 *)(puVar6 + 0x10);
  while( true ) {
    puVar6 = *(undefined **)((int)local_c + 0x4c);
    if (puVar6 == (undefined *)0x0) {
      puVar6 = &DAT_676c5678;
    }
    uVar5 = FUN_6768c972(local_60,(int)puVar6);
    if ((char)uVar5 == '\0') break;
    iVar4 = FUN_676ae2a4(local_5c);
    local_18 = (LPCWSTR)((int)local_18 + iVar4 + 4);
    FUN_676819c4((int)local_60);
  }
  local_10 = (LPCWSTR)0x0;
  puVar6 = *(undefined **)((int)local_c + 0x120);
  if ((puVar6 == (undefined *)0x0) &&
     (puVar6 = *(undefined **)((int)local_c + 300), puVar6 == (undefined *)0x0)) {
    puVar6 = &DAT_676c5678;
  }
  local_5c = *(LPCWSTR *)(puVar6 + 4);
  local_58 = *(undefined4 *)(puVar6 + 8);
  local_54 = *(undefined4 *)(puVar6 + 0xc);
  local_50 = *(undefined4 *)(puVar6 + 0x10);
  while( true ) {
    puVar6 = *(undefined **)((int)local_c + 300);
    if (puVar6 == (undefined *)0x0) {
      puVar6 = &DAT_676c5678;
    }
    uVar5 = FUN_6768c972(local_60,(int)puVar6);
    if ((char)uVar5 == '\0') break;
    iVar4 = FUN_676ae2a4(local_5c);
    local_10 = (LPCWSTR)((int)local_10 + 2 + iVar4);
    FUN_676819c4((int)local_60);
  }
  if (0 < (int)local_10) {
    local_10 = (LPCWSTR)((int)local_10 + -2);
  }
  local_30 = (LPCWSTR)0x0;
  local_2c = 0;
  local_34 = &PTR_FUN_676b9b1c;
  FUN_67685091(&local_34,(int)local_1c + (int)local_18 + (int)local_10 + 1 + (int)local_20);
  local_10 = local_30;
  puVar6 = *(undefined **)((int)local_c + 8);
  if ((puVar6 == (undefined *)0x0) &&
     (puVar6 = *(undefined **)((int)local_c + 0x14), puVar6 == (undefined *)0x0)) {
    puVar6 = &DAT_676c5678;
  }
  local_5c = *(LPCWSTR *)(puVar6 + 4);
  local_58 = *(undefined4 *)(puVar6 + 8);
  local_54 = *(undefined4 *)(puVar6 + 0xc);
  local_50 = *(undefined4 *)(puVar6 + 0x10);
  while( true ) {
    puVar6 = *(undefined **)((int)local_c + 0x14);
    if (puVar6 == (undefined *)0x0) {
      puVar6 = &DAT_676c5678;
    }
    uVar5 = FUN_6768c972(local_60,(int)puVar6);
    if ((char)uVar5 == '\0') break;
    local_20 = local_5c;
    uVar5 = FUN_6768c8fd(local_5c,2);
    if ((char)uVar5 == '\0') goto LAB_6768ae59;
    FUN_676ae1fc(local_10,(short *)&DAT_676c06f4);
    local_10 = local_10 + 2;
    FUN_676ae1fc(local_10,local_20);
    iVar4 = FUN_676ae2a4(local_20);
    local_10 = local_10 + iVar4;
    FUN_676ae1fc(local_10,(short *)&DAT_676c06ec);
    local_10 = local_10 + 2;
    FUN_676819c4((int)local_60);
  }
  puVar6 = *(undefined **)((int)local_c + 0x24);
  if ((puVar6 == (undefined *)0x0) &&
     (puVar6 = *(undefined **)((int)local_c + 0x30), puVar6 == (undefined *)0x0)) {
    puVar6 = &DAT_676c5678;
  }
  local_5c = *(LPCWSTR *)(puVar6 + 4);
  local_58 = *(undefined4 *)(puVar6 + 8);
  local_54 = *(undefined4 *)(puVar6 + 0xc);
  local_50 = *(undefined4 *)(puVar6 + 0x10);
  while( true ) {
    puVar6 = *(undefined **)((int)local_c + 0x30);
    if (puVar6 == (undefined *)0x0) {
      puVar6 = &DAT_676c5678;
    }
    uVar5 = FUN_6768c972(local_60,(int)puVar6);
    if ((char)uVar5 == '\0') break;
    local_20 = local_5c;
    FUN_676ae1fc(local_10,(short *)&DAT_676c06e4);
    local_10 = local_10 + 2;
    FUN_676ae1fc(local_10,local_20);
    iVar4 = FUN_676ae2a4(local_20);
    local_10 = local_10 + iVar4;
    FUN_676ae1fc(local_10,(short *)&DAT_676c06ec);
    local_10 = local_10 + 2;
    FUN_676819c4((int)local_60);
  }
  puVar6 = *(undefined **)((int)local_c + 0x40);
  if ((puVar6 == (undefined *)0x0) &&
     (puVar6 = *(undefined **)((int)local_c + 0x4c), puVar6 == (undefined *)0x0)) {
    puVar6 = &DAT_676c5678;
  }
  local_5c = *(LPCWSTR *)(puVar6 + 4);
  local_58 = *(undefined4 *)(puVar6 + 8);
  local_54 = *(undefined4 *)(puVar6 + 0xc);
  local_50 = *(undefined4 *)(puVar6 + 0x10);
  while( true ) {
    puVar6 = *(undefined **)((int)local_c + 0x4c);
    if (puVar6 == (undefined *)0x0) {
      puVar6 = &DAT_676c5678;
    }
    uVar5 = FUN_6768c972(local_60,(int)puVar6);
    if ((char)uVar5 == '\0') {
      local_5 = '\x01';
      puVar6 = *(undefined **)((int)local_c + 0x120);
      if ((puVar6 == (undefined *)0x0) &&
         (puVar6 = *(undefined **)((int)local_c + 300), puVar6 == (undefined *)0x0)) {
        puVar6 = &DAT_676c5678;
      }
      local_5c = *(LPCWSTR *)(puVar6 + 4);
      local_58 = *(undefined4 *)(puVar6 + 8);
      local_54 = *(undefined4 *)(puVar6 + 0xc);
      local_50 = *(undefined4 *)(puVar6 + 0x10);
      while( true ) {
        puVar6 = *(undefined **)((int)local_c + 300);
        if (puVar6 == (undefined *)0x0) {
          puVar6 = &DAT_676c5678;
        }
        uVar5 = FUN_6768c972(local_60,(int)puVar6);
        if ((char)uVar5 == '\0') break;
        local_20 = local_5c;
        if (local_5 == '\0') {
          FUN_676ae1fc(local_10,(short *)&DAT_676c06ec);
          local_10 = local_10 + 2;
        }
        FUN_676ae1fc(local_10,local_20);
        iVar4 = FUN_676ae2a4(local_20);
        local_5 = '\0';
        local_10 = local_10 + iVar4;
        FUN_676819c4((int)local_60);
      }
      *local_10 = L'\0';
      if (local_30 == (LPCWSTR)0x0) {
        pWVar8 = (LPCWSTR)&DAT_676c5098;
      }
      else {
        local_18 = local_30;
        if (local_30 == (LPCWSTR)0x0) {
          pWVar8 = (LPCWSTR)0x0;
        }
        else {
          iVar4 = lstrlenW(local_30);
          local_10 = (LPCWSTR)(iVar4 * 2 + 2);
          FUN_676b06a0();
          local_20 = (LPCWSTR)&stack0xffffff94;
          WideCharToMultiByte(0,0,local_18,-1,&stack0xffffff94,(int)local_10,(LPCSTR)0x0,(LPBOOL)0x0
                             );
          pWVar8 = local_20;
        }
      }
      FUN_6768c0a7((ushort *)pWVar8,local_14,(int)param_2,param_3);
      goto LAB_6768b013;
    }
    local_20 = local_5c;
    uVar5 = FUN_6768c8fd(local_5c,3);
    if ((char)uVar5 == '\0') break;
    FUN_676ae1fc(local_10,(short *)&DAT_676c06dc);
    local_10 = local_10 + 2;
    FUN_676ae1fc(local_10,local_20);
    iVar4 = FUN_676ae2a4(local_20);
    local_10 = local_10 + iVar4;
    FUN_676ae1fc(local_10,(short *)&DAT_676c06ec);
    local_10 = local_10 + 2;
    FUN_676819c4((int)local_60);
  }
LAB_6768ae59:
  FUN_6767ca9c(param_1,0x213,0x4000000);
  local_34 = &PTR_FUN_676b9b1c;
  FUN_676850f1((int)&local_34);
  return 0;
}



// Function: FUN_6768ba94 at 6768ba94

uint __thiscall FUN_6768ba94(void *this,HANDLE param_1)

{
  uint in_EAX;
  undefined3 uVar1;
  char local_24 [12];
  undefined4 local_18;
  LONG local_14;
  undefined4 local_10;
  undefined2 uStack_c;
  undefined1 uStack_a;
  DWORD local_8;
  
  if (param_1 != (HANDLE)0xffffffff) {
    local_14 = -1;
    local_18 = 0xfffffff6;
    SetFilePointer(param_1,-10,&local_14,2);
    local_10 = DAT_676c0704;
    uStack_c = DAT_676c0708;
    local_24[0] = '\0';
    uStack_a = DAT_676c070a;
    local_8 = 0;
    local_24[1] = '\0';
    local_24[2] = '\0';
    local_24[3] = '\0';
    local_24[4] = '\0';
    local_24[5] = '\0';
    local_24[6] = '\0';
    local_24[7] = '\0';
    local_24[8] = '\0';
    local_24[9] = 0;
    in_EAX = ReadFile(param_1,local_24,10,&local_8,(LPOVERLAPPED)0x0);
    if ((in_EAX != 0) && (local_8 == 10)) {
      in_EAX = 0;
      do {
        if (local_24[in_EAX] != *(char *)((int)&local_10 + in_EAX)) goto LAB_6768bb35;
        in_EAX = in_EAX + 1;
      } while ((int)in_EAX < 6);
      uVar1 = (undefined3)(in_EAX >> 8);
      in_EAX = CONCAT31(uVar1,local_24[7]);
      *(char *)((int)this + 0x350) = local_24[7];
      *(char *)((int)this + 0x351) = local_24[8];
      if (((local_24[7] != 0) && ((byte)local_24[7] < 2)) &&
         ((local_24[7] != 1 || ((byte)local_24[8] < 4)))) {
        return CONCAT31(uVar1,1);
      }
    }
  }
LAB_6768bb35:
  return in_EAX & 0xffffff00;
}



// Function: FUN_6768bb3c at 6768bb3c

int FUN_6768bb3c(void *param_1,int param_2,uint param_3)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 local_2c;
  undefined4 local_28 [2];
  undefined2 local_20;
  undefined2 local_1e;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  if ((param_2 == 0) || (param_3 == 0)) {
    FUN_6767ca9c(param_1,999,0x4000000);
    iVar1 = 0;
  }
  else {
    puVar2 = local_28;
    for (iVar1 = 9; iVar1 != 0; iVar1 = iVar1 + -1) {
      *puVar2 = 0;
      puVar2 = puVar2 + 1;
    }
    local_28[0] = 0x20;
    local_2c = 0x28;
    local_28[1] = 0x40;
    local_20 = 1;
    local_1e = 4;
    local_1c = 0;
    local_18 = 0x280;
    local_14 = 0;
    local_10 = 0;
    local_c = 0;
    local_8 = 0;
    iVar1 = FUN_676ad688(param_2,param_3,(int)&local_2c,0x28);
  }
  return iVar1;
}



// Function: FUN_6768bbbd at 6768bbbd

uint __thiscall FUN_6768bbbd(void *this,void *param_1,int param_2)

{
  LPBITMAPINFO lpbmi;
  HICON hIcon;
  BOOL BVar1;
  HDC hdc;
  undefined4 uVar2;
  ICONINFO local_34;
  undefined **local_20;
  LPBITMAPINFO local_1c;
  undefined1 local_18;
  undefined **local_14;
  undefined4 *local_10;
  undefined1 local_c;
  HICON local_8;
  
  if (*(LPCWSTR)((int)this + 0x13c) == L'\0') {
    hIcon = (HICON)FUN_6767ca9c(param_1,999,0x4000000);
  }
  else {
    hIcon = (HICON)FUN_676af804((HINSTANCE)0x0,(LPCWSTR)((int)this + 0x13c),1,0x20,0x20,0x10);
    if (hIcon != (HICON)0x0) {
      local_34.fIcon = 0;
      local_34.xHotspot = 0;
      local_34.yHotspot = 0;
      local_34.hbmMask = (HBITMAP)0x0;
      local_34.hbmColor = (HBITMAP)0x0;
      local_8 = hIcon;
      BVar1 = GetIconInfo(hIcon,&local_34);
      if (BVar1 != 0) {
        local_1c = (LPBITMAPINFO)0x0;
        local_18 = 0;
        local_20 = &PTR_FUN_676b99c4;
        FUN_6767e657(&local_20,0x68);
        lpbmi = local_1c;
        (local_1c->bmiHeader).biSize = 0x28;
        (local_1c->bmiHeader).biWidth = 0x20;
        (local_1c->bmiHeader).biHeight = 0x20;
        (local_1c->bmiHeader).biPlanes = 1;
        (local_1c->bmiHeader).biBitCount = 4;
        (local_1c->bmiHeader).biCompression = 0;
        (local_1c->bmiHeader).biSizeImage = 0;
        (local_1c->bmiHeader).biXPelsPerMeter = 0;
        (local_1c->bmiHeader).biYPelsPerMeter = 0;
        (local_1c->bmiHeader).biClrUsed = 0;
        (local_1c->bmiHeader).biClrImportant = 0;
        hdc = GetDC((HWND)0x0);
        local_10 = (undefined4 *)0x0;
        local_c = 0;
        local_14 = &PTR_FUN_676b99c4;
        FUN_6767e657(&local_14,0x280);
        GetDIBits(hdc,local_34.hbmColor,0,0x20,(LPVOID)0x0,lpbmi,0);
        if ((lpbmi->bmiHeader).biSizeImage == 0x200) {
          GetDIBits(hdc,local_34.hbmColor,0,0x20,local_10,lpbmi,0);
          FUN_676b06d0((undefined4 *)(param_2 + 0x28),lpbmi->bmiColors,0x40);
          (lpbmi->bmiHeader).biBitCount = 1;
          (lpbmi->bmiHeader).biSizeImage = 0;
          (lpbmi->bmiHeader).biXPelsPerMeter = 0;
          (lpbmi->bmiHeader).biYPelsPerMeter = 0;
          (lpbmi->bmiHeader).biClrUsed = 0;
          (lpbmi->bmiHeader).biClrImportant = 0;
          GetDIBits(hdc,local_34.hbmMask,0,0x20,(LPVOID)0x0,lpbmi,0);
          if ((lpbmi->bmiHeader).biSizeImage == 0x80) {
            GetDIBits(hdc,local_34.hbmMask,0,0x20,local_10 + 0x80,lpbmi,0);
            FUN_676b06d0((undefined4 *)(param_2 + 0x68),local_10,0x280);
          }
        }
        ReleaseDC((HWND)0x0,hdc);
        DeleteObject(local_34.hbmColor);
        DeleteObject(local_34.hbmMask);
        DestroyIcon(local_8);
        local_14 = &PTR_FUN_676b99c4;
        FUN_6767e692((int)&local_14);
        local_20 = &PTR_FUN_676b99c4;
        uVar2 = FUN_6767e692((int)&local_20);
        return CONCAT31((int3)((uint)uVar2 >> 8),1);
      }
      hIcon = (HICON)DestroyIcon(hIcon);
    }
  }
  return (uint)hIcon & 0xffffff00;
}



// Function: FUN_6768bd75 at 6768bd75

void __fastcall FUN_6768bd75(void *param_1)

{
  FUN_6768be2e(param_1,0,(short *)&DAT_676c07c0);
  FUN_6768be2e(param_1,1,u__Cancel_676c07b0);
  FUN_6768be2e(param_1,2,u__Abort_676c07a0);
  FUN_6768be2e(param_1,3,u__Skip_676c0794);
  FUN_6768be2e(param_1,4,u_Al_ways_skip_676c0778);
  FUN_6768be2e(param_1,5,u__Yes_676c076c);
  FUN_6768be2e(param_1,6,(short *)&DAT_676c0764);
  FUN_6768be2e(param_1,7,u_A_ll_676c0758);
  FUN_6768be2e(param_1,8,u_N_one_676c074c);
  FUN_6768be2e(param_1,9,u__Continue_676c0738);
  FUN_6768be2e(param_1,10,u__Exit_676c072c);
  FUN_6768be2e(param_1,0xb,u__Agree_676c071c);
  FUN_6768be2e(param_1,0xc,u__Refuse_676c070c);
  return;
}



// Function: FUN_6768be2e at 6768be2e

void __thiscall FUN_6768be2e(void *this,int param_1,short *param_2)

{
  undefined4 *puVar1;
  undefined *puVar2;
  int iVar3;
  short *psVar4;
  
  if ((-1 < param_1) && (param_1 < 0xd)) {
    puVar1 = (undefined4 *)((int)this + param_1 * 4 + 0x58);
    puVar2 = *(undefined **)((int)this + param_1 * 4 + 0x58);
    if (puVar2 != (undefined *)0x0) {
      FUN_676b0bb3(puVar2);
      *puVar1 = 0;
    }
    if (param_2 != (short *)0x0) {
      iVar3 = FUN_676ae2a4(param_2);
      psVar4 = (short *)operator_new(iVar3 * 2 + 2);
      *puVar1 = psVar4;
      if (psVar4 != (short *)0x0) {
        FUN_676ae1fc(psVar4,param_2);
      }
    }
  }
  return;
}



// Function: FUN_6768be84 at 6768be84

void __fastcall FUN_6768be84(void *param_1)

{
  FUN_6768bf3d(param_1,0,u_All_files_were_succesfully_unzip_676c0cb8);
  FUN_6768bf3d(param_1,1,u_An_error_occured_while_unzipping_676c0be4);
  FUN_6768bf3d(param_1,2,u_Unable_to_create_folder___d___676c0ba8);
  FUN_6768bf3d(param_1,3,u_Welcome_to_the_Xceed_Zip_Self_Ex_676c0aec);
  FUN_6768bf3d(param_1,4,(short *)&DAT_676c509c);
  FUN_6768bf3d(param_1,5,u_Select_the_folder_where_you_want_676c0a7c);
  FUN_6768bf3d(param_1,6,u_A_password_is_required_for_file__676c0a38);
  FUN_6768bf3d(param_1,7,u_This_self_extracting_zip_file_is_676c0968);
  FUN_6768bf3d(param_1,8,u_Please_insert_disk___n__676c0938);
  FUN_6768bf3d(param_1,9,u_Are_you_sure_you_want_to_abort_t_676c08cc);
  FUN_6768bf3d(param_1,10,u_Folder___d__does_not_exist__Do_y_676c0860);
  FUN_6768bf3d(param_1,0xb,u_The_file___f__already_exists__Do_676c07e8);
  FUN_6768bf3d(param_1,0xc,u_Unzipping_file__676c07c8);
  return;
}



// Function: FUN_6768bf3d at 6768bf3d

void __thiscall FUN_6768bf3d(void *this,int param_1,short *param_2)

{
  undefined4 *puVar1;
  undefined *puVar2;
  int iVar3;
  short *psVar4;
  
  if ((-1 < param_1) && (param_1 < 0xd)) {
    puVar1 = (undefined4 *)((int)this + param_1 * 4 + 0x8c);
    puVar2 = *(undefined **)((int)this + param_1 * 4 + 0x8c);
    if (puVar2 != (undefined *)0x0) {
      FUN_676b0bb3(puVar2);
      *puVar1 = 0;
    }
    if (param_2 != (short *)0x0) {
      iVar3 = FUN_676ae2a4(param_2);
      psVar4 = (short *)operator_new(iVar3 * 2 + 2);
      *puVar1 = psVar4;
      if (psVar4 != (short *)0x0) {
        FUN_676ae1fc(psVar4,param_2);
      }
    }
  }
  return;
}



// Function: FUN_6768bf99 at 6768bf99

void __fastcall FUN_6768bf99(void *param_1)

{
  FUN_6768bfe2(param_1,0,u_Overall_progress__676c0db0);
  FUN_6768bfe2(param_1,1,u_The_Xceed_Zip_Self_Extractor_676c0d74);
  FUN_6768bfe2(param_1,2,u_Current_destination_folder__676c0d3c);
  FUN_6768bfe2(param_1,3,u__s_on___c__676c0d24);
  FUN_6768bfe2(param_1,4,u_Entire_Network_676c0d04);
  return;
}



// Function: FUN_6768bfe2 at 6768bfe2

void __thiscall FUN_6768bfe2(void *this,int param_1,short *param_2)

{
  undefined4 *puVar1;
  undefined *puVar2;
  int iVar3;
  short *psVar4;
  
  if ((-1 < param_1) && (param_1 < 5)) {
    puVar1 = (undefined4 *)((int)this + param_1 * 4 + 0xc0);
    puVar2 = *(undefined **)((int)this + param_1 * 4 + 0xc0);
    if (puVar2 != (undefined *)0x0) {
      FUN_676b0bb3(puVar2);
      *puVar1 = 0;
    }
    if (param_2 != (short *)0x0) {
      iVar3 = FUN_676ae2a4(param_2);
      psVar4 = (short *)operator_new(iVar3 * 2 + 2);
      *puVar1 = psVar4;
      if (psVar4 != (short *)0x0) {
        FUN_676ae1fc(psVar4,param_2);
      }
    }
  }
  return;
}



// Function: FUN_6768c03e at 6768c03e

void __fastcall FUN_6768c03e(int param_1)

{
  undefined4 *puVar1;
  int iVar2;
  
  puVar1 = (undefined4 *)(param_1 + 0x58);
  iVar2 = 0xd;
  do {
    if ((undefined *)*puVar1 != (undefined *)0x0) {
      FUN_676b0bb3((undefined *)*puVar1);
      *puVar1 = 0;
    }
    puVar1 = puVar1 + 1;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  return;
}



// Function: FUN_6768c05f at 6768c05f

void __fastcall FUN_6768c05f(int param_1)

{
  undefined4 *puVar1;
  int iVar2;
  
  puVar1 = (undefined4 *)(param_1 + 0x8c);
  iVar2 = 0xd;
  do {
    if ((undefined *)*puVar1 != (undefined *)0x0) {
      FUN_676b0bb3((undefined *)*puVar1);
      *puVar1 = 0;
    }
    puVar1 = puVar1 + 1;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  return;
}



// Function: FUN_6768c083 at 6768c083

void __fastcall FUN_6768c083(int param_1)

{
  undefined4 *puVar1;
  int iVar2;
  
  puVar1 = (undefined4 *)(param_1 + 0xc0);
  iVar2 = 5;
  do {
    if ((undefined *)*puVar1 != (undefined *)0x0) {
      FUN_676b0bb3((undefined *)*puVar1);
      *puVar1 = 0;
    }
    puVar1 = puVar1 + 1;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  return;
}



// Function: FUN_6768c0a7 at 6768c0a7

void FUN_6768c0a7(ushort *param_1,ushort *param_2,int param_3,ushort *param_4)

{
  uint uVar1;
  ushort uVar2;
  
  if ((param_1 != (ushort *)0x0) && (param_3 != 0)) {
    uVar1 = lstrlenA((LPCSTR)param_1);
    uVar2 = *param_2 ^ (ushort)uVar1;
    *(ushort *)((uint)*param_4 + param_3) = uVar2 >> 0xb | uVar2 << 5;
    *param_4 = *param_4 + 2;
    *param_2 = *param_2 >> 0xf | *param_2 * 2;
    for (uVar1 = ((uVar1 & 0xffff) + 1) / 2; uVar1 != 0; uVar1 = uVar1 - 1) {
      *(ushort *)((uint)*param_4 + param_3) =
           (*param_2 ^ *param_1) >> 9 | (*param_2 ^ *param_1) << 7;
      *param_4 = *param_4 + 2;
      param_1 = param_1 + 1;
      *param_2 = *param_2 >> 0xe | *param_2 << 2;
    }
  }
  return;
}



// Function: FUN_6768c14f at 6768c14f

void FUN_6768c14f(ushort param_1,ushort *param_2,int param_3,ushort *param_4)

{
  *(ushort *)((uint)*param_4 + param_3) = (*param_2 ^ param_1) >> 0xb | (*param_2 ^ param_1) << 5;
  *param_4 = *param_4 + 2;
  *param_2 = *param_2 >> 0xd | *param_2 << 3;
  return;
}



// Function: FUN_6768c193 at 6768c193

undefined1 __thiscall FUN_6768c193(void *this,void *param_1,LPCWSTR param_2)

{
  HANDLE hFile;
  BOOL BVar1;
  undefined4 uVar2;
  undefined1 uVar3;
  undefined4 *puVar4;
  int iVar5;
  int local_14;
  DWORD local_10;
  HANDLE local_c;
  short *local_8;
  
  iVar5 = 0;
  if (param_2 == (LPCWSTR)0x0) {
    FUN_6767ca9c(param_1,999,0x4000000);
    return 0;
  }
  local_c = FUN_676aeee9(param_2,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0);
  if (local_c == (HANDLE)0xffffffff) {
    return 0;
  }
  BVar1 = ReadFile(local_c,&local_14,4,&local_10,(LPOVERLAPPED)0x0);
  if (((((BVar1 != 0) && (local_10 == 4)) && (local_14 == 0x1555b180)) &&
      ((BVar1 = ReadFile(local_c,(LPVOID)((int)&param_1 + 2),2,&local_10,(LPOVERLAPPED)0x0),
       BVar1 != 0 && (local_10 == 2)))) && (param_1._3_1_ == '\x01')) {
    puVar4 = (undefined4 *)((int)this + 0x58);
    do {
      uVar2 = FUN_6768c509(local_c,puVar4);
      if ((char)uVar2 == '\0') goto LAB_6768c4f5;
      iVar5 = iVar5 + 1;
      puVar4 = puVar4 + 1;
    } while (iVar5 < 0xd);
    iVar5 = 0;
    puVar4 = (undefined4 *)((int)this + 0x8c);
    do {
      uVar2 = FUN_6768c509(local_c,puVar4);
      if ((char)uVar2 == '\0') goto LAB_6768c4f5;
      iVar5 = iVar5 + 1;
      puVar4 = puVar4 + 1;
    } while (iVar5 < 0xd);
    iVar5 = 0;
    puVar4 = (undefined4 *)((int)this + 0xc0);
    do {
      uVar2 = FUN_6768c509(local_c,puVar4);
      hFile = local_c;
      if ((char)uVar2 == '\0') goto LAB_6768c4f5;
      iVar5 = iVar5 + 1;
      puVar4 = puVar4 + 1;
    } while (iVar5 < 5);
    uVar2 = FUN_6768c509(local_c,(undefined4 *)((int)this + 0xd4));
    if ((((char)uVar2 != '\0') &&
        (uVar2 = FUN_6768c509(hFile,(undefined4 *)((int)this + 0xd8)), (char)uVar2 != '\0')) &&
       (uVar2 = FUN_6768c509(hFile,(undefined4 *)((int)this + 0xdc)), (char)uVar2 != '\0')) {
      local_8 = (short *)0x0;
      uVar2 = FUN_6768c509(hFile,&local_8);
      if ((char)uVar2 != '\0') {
        FUN_676ae4bc((void *)((int)this + 0xe0),(int)local_8);
        if (local_8 != (short *)0x0) {
          FUN_676b0bb3((undefined *)local_8);
          local_8 = (short *)0x0;
        }
        uVar2 = FUN_6768c509(hFile,&local_8);
        if ((char)uVar2 != '\0') {
          FUN_676ae4bc((void *)((int)this + 0xfc),(int)local_8);
          if (local_8 != (short *)0x0) {
            FUN_676b0bb3((undefined *)local_8);
            local_8 = (short *)0x0;
          }
          uVar2 = FUN_6768c509(hFile,(undefined4 *)((int)this + 0x118));
          if (((char)uVar2 != '\0') && (uVar2 = FUN_6768c509(hFile,&local_8), (char)uVar2 != '\0'))
          {
            FUN_676ae4bc((void *)((int)this + 0x11c),(int)local_8);
            if (local_8 != (short *)0x0) {
              FUN_676b0bb3((undefined *)local_8);
              local_8 = (short *)0x0;
            }
            uVar2 = FUN_6768c509(hFile,(undefined4 *)((int)this + 0x138));
            if ((char)uVar2 != '\0') {
              local_8 = (short *)0x0;
              uVar2 = FUN_6768c509(hFile,&local_8);
              if ((char)uVar2 != '\0') {
                if (local_8 == (short *)0x0) {
                  *(undefined2 *)((int)this + 0x13c) = 0;
                }
                else {
                  FUN_676ae1fc((short *)((int)this + 0x13c),local_8);
                  FUN_676b0bb3((undefined *)local_8);
                }
                BVar1 = ReadFile(hFile,(LPVOID)((int)&param_2 + 3),1,&local_10,(LPOVERLAPPED)0x0);
                if ((BVar1 != 0) && (local_10 == 1)) {
                  *(bool *)((int)this + 0x346) = param_2._3_1_ != '\0';
                  BVar1 = ReadFile(local_c,&local_14,4,&local_10,(LPOVERLAPPED)0x0);
                  if ((BVar1 != 0) && (local_10 == 4)) {
                    *(int *)((int)this + 0x348) = local_14;
                    if (param_1._2_1_ == '\0') {
LAB_6768c4f1:
                      uVar3 = 1;
                      goto LAB_6768c4f7;
                    }
                    uVar2 = FUN_6768c509(local_c,&local_8);
                    if ((char)uVar2 != '\0') {
                      FUN_676ae4bc((void *)((int)this + 4),(int)local_8);
                      if (local_8 != (short *)0x0) {
                        FUN_676b0bb3((undefined *)local_8);
                        local_8 = (short *)0x0;
                      }
                      uVar2 = FUN_6768c509(local_c,&local_8);
                      if ((char)uVar2 != '\0') {
                        FUN_676ae4bc((void *)((int)this + 0x20),(int)local_8);
                        if (local_8 != (short *)0x0) {
                          FUN_676b0bb3((undefined *)local_8);
                          local_8 = (short *)0x0;
                        }
                        uVar2 = FUN_6768c509(local_c,&local_8);
                        if ((char)uVar2 != '\0') {
                          FUN_676ae4bc((void *)((int)this + 0x3c),(int)local_8);
                          if (local_8 != (short *)0x0) {
                            FUN_676b0bb3((undefined *)local_8);
                            local_8 = (short *)0x0;
                          }
                          goto LAB_6768c4f1;
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
LAB_6768c4f5:
  uVar3 = 0;
LAB_6768c4f7:
  CloseHandle(local_c);
  return uVar3;
}



// Function: FUN_6768c509 at 6768c509

uint FUN_6768c509(HANDLE param_1,undefined4 *param_2)

{
  undefined *in_EAX;
  void *pvVar1;
  undefined *local_c;
  ushort local_6;
  
  if (((param_1 != (HANDLE)0xffffffff) &&
      (in_EAX = (undefined *)ReadFile(param_1,&local_6,2,(LPDWORD)&local_c,(LPOVERLAPPED)0x0),
      in_EAX != (undefined *)0x0)) && (local_c == (undefined *)0x2)) {
    in_EAX = (undefined *)*param_2;
    if (in_EAX != (undefined *)0x0) {
      in_EAX = (undefined *)FUN_676b0bb3(in_EAX);
      *param_2 = 0;
    }
    if (local_6 != 0) {
      pvVar1 = operator_new((uint)local_6 * 2 + 2);
      *param_2 = pvVar1;
      *(undefined2 *)((int)pvVar1 + (uint)local_6 * 2) = 0;
      in_EAX = (undefined *)
               ReadFile(param_1,(LPVOID)*param_2,(uint)local_6 << 1,(LPDWORD)&local_c,
                        (LPOVERLAPPED)0x0);
      if ((in_EAX == (undefined *)0x0) ||
         (in_EAX = (undefined *)((uint)local_6 * 2), local_c != in_EAX)) goto LAB_6768c590;
    }
    return CONCAT31((int3)((uint)in_EAX >> 8),1);
  }
LAB_6768c590:
  return (uint)in_EAX & 0xffffff00;
}



// Function: FUN_6768c599 at 6768c599

undefined1 __thiscall FUN_6768c599(void *this,void *param_1,LPCWSTR param_2)

{
  HANDLE hFile;
  BOOL BVar1;
  undefined4 uVar2;
  short *psVar3;
  undefined1 uVar4;
  undefined4 *puVar5;
  int iVar6;
  undefined4 local_14;
  undefined4 local_10;
  int local_c;
  HANDLE local_8;
  
  iVar6 = 0;
  if (param_2 == (LPCWSTR)0x0) {
    FUN_6767ca9c(param_1,999,0x4000000);
    return 0;
  }
  local_8 = FUN_676aeee9(param_2,0x40000000,1,(LPSECURITY_ATTRIBUTES)0x0,2,0x80,(HANDLE)0x0);
  if (local_8 == (HANDLE)0xffffffff) {
    return 0;
  }
  local_10 = 0x1555b180;
  local_14 = 0x101;
  BVar1 = WriteFile(local_8,&local_10,4,(LPDWORD)&param_1,(LPOVERLAPPED)0x0);
  if ((((BVar1 != 0) && (param_1 == (void *)0x4)) &&
      (BVar1 = WriteFile(local_8,&local_14,2,(LPDWORD)&param_1,(LPOVERLAPPED)0x0), BVar1 != 0)) &&
     (param_1 == (void *)0x2)) {
    puVar5 = (undefined4 *)((int)this + 0x58);
    do {
      uVar2 = FUN_6768c883(local_8,(short *)*puVar5);
      if ((char)uVar2 == '\0') goto LAB_6768c86f;
      iVar6 = iVar6 + 1;
      puVar5 = puVar5 + 1;
    } while (iVar6 < 0xd);
    iVar6 = 0;
    puVar5 = (undefined4 *)((int)this + 0x8c);
    do {
      uVar2 = FUN_6768c883(local_8,(short *)*puVar5);
      if ((char)uVar2 == '\0') goto LAB_6768c86f;
      iVar6 = iVar6 + 1;
      puVar5 = puVar5 + 1;
    } while (iVar6 < 0xd);
    local_c = 0;
    puVar5 = (undefined4 *)((int)this + 0xc0);
    do {
      hFile = local_8;
      uVar2 = FUN_6768c883(local_8,(short *)*puVar5);
      if ((char)uVar2 == '\0') goto LAB_6768c86f;
      local_c = local_c + 1;
      puVar5 = puVar5 + 1;
    } while (local_c < 5);
    uVar2 = FUN_6768c883(hFile,*(short **)((int)this + 0xd4));
    if ((((char)uVar2 != '\0') &&
        (uVar2 = FUN_6768c883(hFile,*(short **)((int)this + 0xd8)), (char)uVar2 != '\0')) &&
       (uVar2 = FUN_6768c883(hFile,*(short **)((int)this + 0xdc)), (char)uVar2 != '\0')) {
      psVar3 = FUN_676ae4ce((int)this + 0xe0);
      uVar2 = FUN_6768c883(hFile,psVar3);
      if ((char)uVar2 != '\0') {
        if (psVar3 != (short *)0x0) {
          FUN_676b0bb3((undefined *)psVar3);
        }
        psVar3 = FUN_676ae4ce((int)this + 0xfc);
        uVar2 = FUN_6768c883(hFile,psVar3);
        if ((char)uVar2 != '\0') {
          if (psVar3 != (short *)0x0) {
            FUN_676b0bb3((undefined *)psVar3);
          }
          uVar2 = FUN_6768c883(hFile,*(short **)((int)this + 0x118));
          if ((char)uVar2 != '\0') {
            psVar3 = FUN_676ae4ce((int)this + 0x11c);
            uVar2 = FUN_6768c883(hFile,psVar3);
            if ((char)uVar2 != '\0') {
              if (psVar3 != (short *)0x0) {
                FUN_676b0bb3((undefined *)psVar3);
              }
              uVar2 = FUN_6768c883(hFile,*(short **)((int)this + 0x138));
              if (((char)uVar2 != '\0') &&
                 (uVar2 = FUN_6768c883(hFile,(short *)((int)this + 0x13c)), (char)uVar2 != '\0')) {
                param_2 = (LPCWSTR)CONCAT13(*(char *)((int)this + 0x346) != '\0',param_2._0_3_);
                BVar1 = WriteFile(hFile,(LPCVOID)((int)&param_2 + 3),1,(LPDWORD)&param_1,
                                  (LPOVERLAPPED)0x0);
                if ((BVar1 != 0) && (param_1 == (void *)0x1)) {
                  local_10 = *(undefined4 *)((int)this + 0x348);
                  BVar1 = WriteFile(hFile,&local_10,4,(LPDWORD)&param_1,(LPOVERLAPPED)0x0);
                  if ((BVar1 != 0) && (param_1 == (void *)0x4)) {
                    psVar3 = FUN_676ae4ce((int)this + 4);
                    uVar2 = FUN_6768c883(hFile,psVar3);
                    if ((char)uVar2 != '\0') {
                      if (psVar3 != (short *)0x0) {
                        FUN_676b0bb3((undefined *)psVar3);
                      }
                      psVar3 = FUN_676ae4ce((int)this + 0x20);
                      uVar2 = FUN_6768c883(hFile,psVar3);
                      if ((char)uVar2 != '\0') {
                        if (psVar3 != (short *)0x0) {
                          FUN_676b0bb3((undefined *)psVar3);
                        }
                        psVar3 = FUN_676ae4ce((int)this + 0x3c);
                        uVar2 = FUN_6768c883(hFile,psVar3);
                        if ((char)uVar2 != '\0') {
                          if (psVar3 != (short *)0x0) {
                            FUN_676b0bb3((undefined *)psVar3);
                          }
                          uVar4 = 1;
                          goto LAB_6768c871;
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
LAB_6768c86f:
  uVar4 = 0;
LAB_6768c871:
  CloseHandle(local_8);
  return uVar4;
}



// Function: FUN_6768c883 at 6768c883

uint FUN_6768c883(HANDLE param_1,short *param_2)

{
  uint in_EAX;
  uint local_c;
  uint local_8;
  
  if (param_1 != (HANDLE)0xffffffff) {
    if (param_2 == (short *)0x0) {
      local_8 = 0;
    }
    else {
      local_8 = FUN_676ae2a4(param_2);
    }
    in_EAX = WriteFile(param_1,&local_8,2,&local_c,(LPOVERLAPPED)0x0);
    if (((in_EAX != 0) && (local_c == 2)) &&
       (((short)local_8 == 0 ||
        ((in_EAX = WriteFile(param_1,param_2,(local_8 & 0xffff) << 1,&local_c,(LPOVERLAPPED)0x0),
         in_EAX != 0 && (in_EAX = (local_8 & 0xffff) * 2, local_c == in_EAX)))))) {
      return CONCAT31((int3)(in_EAX >> 8),1);
    }
  }
  return in_EAX & 0xffffff00;
}



// Function: FUN_6768c8fd at 6768c8fd

uint FUN_6768c8fd(short *param_1,int param_2)

{
  short sVar1;
  bool bVar2;
  int iVar3;
  
  iVar3 = 0;
  bVar2 = true;
  if (param_1 == (short *)0x0) {
LAB_6768c968:
    return (uint)param_1 & 0xffffff00;
  }
  do {
    sVar1 = *param_1;
    if (sVar1 == 0x7c) {
      iVar3 = iVar3 + 1;
      if (iVar3 == param_2) {
        *param_1 = 10;
        iVar3 = 0;
      }
LAB_6768c921:
      bVar2 = false;
    }
    else if (((sVar1 == 10) || (sVar1 == 0xd)) || (sVar1 == 0)) {
      if ((!bVar2) && (iVar3 + 1 != param_2)) goto LAB_6768c968;
      iVar3 = 0;
      bVar2 = true;
      for (; (*param_1 == 10 || (*param_1 == 0xd)); param_1 = param_1 + 1) {
      }
    }
    else if (sVar1 != 0x20) goto LAB_6768c921;
    if (*param_1 == 0) {
      return CONCAT31((int3)((uint)param_1 >> 8),1);
    }
    param_1 = param_1 + 1;
  } while( true );
}



// Function: FUN_6768c972 at 6768c972

undefined4 __thiscall FUN_6768c972(void *this,int param_1)

{
  int iVar1;
  undefined3 uVar2;
  bool bVar3;
  
  iVar1 = *(int *)((int)this + 0x10);
  uVar2 = (undefined3)((uint)iVar1 >> 8);
  if (iVar1 == *(int *)(param_1 + 0x10)) {
    if (iVar1 == 0) {
      bVar3 = *(int *)((int)this + 4) == *(int *)(param_1 + 4);
      uVar2 = (undefined3)((uint)*(int *)((int)this + 4) >> 8);
    }
    else {
      bVar3 = true;
    }
  }
  else {
    bVar3 = false;
  }
  return CONCAT31(uVar2,!bVar3);
}



// Function: FUN_6768c9a9 at 6768c9a9

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_6768c9a9(void)

{
  _DAT_676c5150 = 0;
  _DAT_676c5154 = 0;
  _DAT_676c5158 = 0xffffffff;
  _DAT_676c5148 = &PTR_FUN_676b9d4c;
  return;
}



// Function: FUN_6768c9c9 at 6768c9c9

void FUN_6768c9c9(void)

{
  FUN_676b0c45(&LAB_6768c9d5);
  return;
}



// Function: FUN_6768c9f0 at 6768c9f0

undefined4 * __fastcall FUN_6768c9f0(undefined4 *param_1)

{
  void *pvVar1;
  
  FUN_6768e83b(param_1 + 0x1a1);
  param_1[0x1a8] = 0xffffffff;
  param_1[0x1ac] = 0;
  param_1[0x1b0] = 0xffffffff;
  *param_1 = &PTR_FUN_676b9d50;
  *(undefined1 *)(param_1 + 0x106) = 0;
  param_1[0x109] = 0xffffffff;
  *(undefined2 *)(param_1 + 2) = 0;
  *(undefined2 *)(param_1 + 0x84) = 0;
  param_1[0x10a] = 0xffffffff;
  *(undefined1 *)(param_1 + 0x10b) = 0;
  *(undefined1 *)((int)param_1 + 0x42d) = 0;
  *(undefined2 *)((int)param_1 + 0x42e) = 0;
  param_1[0x18e] = 0xffffffff;
  param_1[0x107] = 0;
  param_1[399] = 0xffffffff;
  *(undefined1 *)(param_1 + 0x19c) = 0;
  param_1[0x19e] = 0;
  param_1[0x19f] = 0;
  param_1[0x1a0] = 0;
  param_1[0x1a9] = 0xffffffff;
  *(undefined1 *)(param_1 + 0x1aa) = 0;
  param_1[0x1ab] = 0xffffffff;
  param_1[0x1ad] = 0;
  param_1[0x1ae] = 0;
  param_1[0x1af] = 0;
  param_1[0x1b1] = 0xffffffff;
  param_1[0x108] = 0;
  pvVar1 = operator_new(0x8000);
  param_1[0x19d] = pvVar1;
  return param_1;
}



// Function: FUN_6768caba at 6768caba

undefined4 * __thiscall FUN_6768caba(void *this,byte param_1)

{
  FUN_6768cad6((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_6768cad6 at 6768cad6

void __fastcall FUN_6768cad6(undefined4 *param_1)

{
  undefined4 uVar1;
  undefined **local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined *local_8;
  
  *param_1 = &PTR_FUN_676b9d50;
  if (param_1[0x10a] != -1) {
    local_2c = &PTR_LAB_676b99c8;
    local_14 = 0;
    local_28 = 0;
    local_24 = 0;
    local_20 = 0;
    local_1c = 0;
    local_10 = 0;
    local_c = 0;
    local_18 = 0;
    FUN_6768cd8a(param_1,&local_2c,'\x01');
  }
  if ((undefined *)param_1[0x19d] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[0x19d]);
  }
  while( true ) {
    uVar1 = FUN_6768e908(param_1 + 0x1a1,&local_8);
    if ((char)uVar1 == '\0') break;
    FUN_676b0bb3(local_8);
  }
  FUN_6768e8d2(param_1 + 0x1a1);
  return;
}



// Function: FUN_6768cb57 at 6768cb57

uint __thiscall
FUN_6768cb57(void *this,void *param_1,LPCWSTR param_2,char param_3,short *param_4,int param_5,
            undefined4 param_6,char param_7)

{
  char cVar1;
  uint uVar2;
  UINT UVar3;
  uint3 uVar6;
  DWORD DVar4;
  undefined4 uVar5;
  char in_stack_0000000f;
  int iVar7;
  WCHAR local_214 [262];
  DWORD local_8;
  
  if (((*(int *)((int)this + 0x428) == -1) && ((param_4 == (short *)0x0 || (param_3 != '\0')))) &&
     ((param_7 == '\0' || (param_3 != '\0')))) {
    *(char *)((int)this + 0x42d) = param_3;
    FUN_676ae1fc((short *)((int)this + 8),param_2);
    FUN_676ae1fc((short *)((int)this + 0x210),param_2);
    in_stack_0000000f = '\0';
    FUN_676aca1a(param_2,local_214,(short *)0x0,(short *)0x0);
    UVar3 = FUN_676af2c4(local_214);
    if (((UVar3 == 0) || (UVar3 == 2)) || (UVar3 == 5)) {
      in_stack_0000000f = '\x01';
    }
    *(undefined1 *)((int)this + 0x418) = 0;
    if ((*(char *)((int)this + 0x42d) != '\0') &&
       ((param_5 == 1 || ((param_5 == 2 && (in_stack_0000000f != '\0')))))) {
      *(undefined1 *)((int)this + 0x418) = 1;
    }
    *(undefined4 *)((int)this + 0x6a0) = 0xffffffff;
    *(undefined4 *)((int)this + 0x6b0) = 0;
    *(undefined4 *)((int)this + 0x41c) = param_6;
    *(undefined1 *)((int)this + 0x670) = 0;
    *(undefined4 *)((int)this + 0x6a4) = 0xffffffff;
    *(undefined1 *)((int)this + 0x6a8) = 0;
    *(undefined4 *)((int)this + 0x6ac) = 0;
    *(undefined4 *)((int)this + 0x6b4) = 0;
    *(undefined4 *)((int)this + 0x6b8) = 0;
    *(undefined4 *)((int)this + 0x63c) = 0xffffffff;
    *(undefined4 *)((int)this + 0x6bc) = 0;
    uVar6 = (uint3)((uint)param_6 >> 8);
    if ((param_7 == '\0') || (*(char *)((int)this + 0x418) == '\0')) {
      iVar7 = (uint)uVar6 << 8;
    }
    else {
      iVar7 = CONCAT31(uVar6,1);
    }
    uVar2 = FUN_6768d653(this,param_1,(param_7 != '\0') - 1,iVar7);
    if ((char)uVar2 == '\0') {
      uVar2 = FUN_6767e600((int)param_1);
      if ((char)uVar2 != '\0') goto LAB_6768cd7d;
      if (in_stack_0000000f == '\0') {
        iVar7 = 0x1f7;
        goto LAB_6768cb7d;
      }
    }
    DVar4 = GetFileSize(*(HANDLE *)((int)this + 0x428),&local_8);
    if ((DVar4 == 0) && (local_8 == 0)) {
      cVar1 = '\0';
    }
    else {
      cVar1 = '\x01';
    }
    *(char *)((int)this + 0x42c) = cVar1;
    if (cVar1 != '\0') {
      if (*(char *)((int)this + 0x42d) != '\0') goto LAB_6768cd07;
LAB_6768cd3f:
      if (param_4 == (short *)0x0) {
        *(undefined2 *)((int)this + 0x42e) = 0;
      }
      else {
        FUN_676ae1fc((short *)((int)this + 0x42e),param_4);
      }
      uVar5 = FUN_6768dab2(this,param_1);
      if ((char)uVar5 != '\0') {
        return CONCAT31((int3)((uint)uVar5 >> 8),1);
      }
      uVar2 = CloseHandle(*(HANDLE *)((int)this + 0x428));
      *(undefined4 *)((int)this + 0x428) = 0xffffffff;
      goto LAB_6768cd7d;
    }
    if (*(char *)((int)this + 0x42d) == '\0') {
      CloseHandle(*(HANDLE *)((int)this + 0x428));
      *(undefined4 *)((int)this + 0x428) = 0xffffffff;
      iVar7 = 500;
    }
    else {
LAB_6768cd07:
      if ((cVar1 == '\0') ||
         ((*(char *)((int)this + 0x418) == '\0' && (*(int *)((int)this + 0x41c) == 0))))
      goto LAB_6768cd3f;
      CloseHandle(*(HANDLE *)((int)this + 0x428));
      *(undefined4 *)((int)this + 0x428) = 0xffffffff;
      iVar7 = 0x1fe;
    }
  }
  else {
    iVar7 = 999;
  }
LAB_6768cb7d:
  uVar2 = FUN_6767ca9c(param_1,iVar7,0x4000000);
LAB_6768cd7d:
  return uVar2 & 0xffffff00;
}



// Function: FUN_6768cd8a at 6768cd8a

bool __thiscall FUN_6768cd8a(void *this,void *param_1,char param_2)

{
  if (*(int *)((int)this + 0x67c) != 0) {
    FUN_6767ca9c(param_1,300,0x1000000);
    FUN_6768e612(this,param_1,'\0');
  }
  FUN_6768db21((int)this);
  FUN_6768dc0a(this,param_1,param_2);
  return *(int *)((int)param_1 + 8) != 0x4000000;
}



// Function: FUN_6768cddb at 6768cddb

undefined4 __fastcall FUN_6768cddb(int param_1)

{
  BOOL BVar1;
  HANDLE hFile;
  
  hFile = *(HANDLE *)(param_1 + 0x638);
  if (hFile == (HANDLE)0xffffffff) {
    hFile = *(HANDLE *)(param_1 + 0x428);
  }
  BVar1 = SetEndOfFile(hFile);
  return CONCAT31((int3)((uint)BVar1 >> 8),1);
}



// Function: FUN_6768cdfa at 6768cdfa

uint __thiscall FUN_6768cdfa(void *this,void *param_1)

{
  LPCWSTR pWVar1;
  uint uVar2;
  WCHAR local_20c [260];
  
  if ((*(int *)((int)this + 0x428) == -1) && (*(int *)((int)this + 0x638) == -1)) {
    pWVar1 = (LPCWSTR)((int)this + 0x42e);
    if (*pWVar1 != L'\0') {
      pWVar1 = (LPCWSTR)FUN_676af551(pWVar1);
    }
    if (*(char *)((int)this + 0x42c) == '\0') {
      if (*(short *)((int)this + 0x210) != 0) {
        FUN_676af551((LPCWSTR)((int)this + 0x210));
      }
      pWVar1 = *(LPCWSTR *)((int)this + 0x424);
      if ((((pWVar1 != (LPCWSTR)0xffffffff) && (pWVar1 != (LPCWSTR)0x0)) &&
          (*(int *)((int)this + 0x41c) != 0)) && (uVar2 = 0, pWVar1 != (LPCWSTR)0x0)) {
        do {
          FUN_676ad058(local_20c,(short *)((int)this + 8),uVar2);
          pWVar1 = (LPCWSTR)FUN_676af551(local_20c);
          uVar2 = uVar2 + 1;
        } while (uVar2 < *(uint *)((int)this + 0x424));
      }
    }
    uVar2 = CONCAT31((int3)((uint)pWVar1 >> 8),1);
  }
  else {
    uVar2 = FUN_6767ca9c(param_1,999,0x4000000);
    uVar2 = uVar2 & 0xffffff00;
  }
  return uVar2;
}



// Function: FUN_6768ceb9 at 6768ceb9

uint __thiscall FUN_6768ceb9(void *this,void *param_1,int param_2,uint param_3,char param_4)

{
  char *pcVar1;
  char *pcVar2;
  LPVOID pvVar3;
  undefined4 *puVar4;
  uint uVar5;
  uint uVar6;
  DWORD DVar7;
  int iVar8;
  int local_c;
  uint local_8;
  
  if ((*(int *)((int)this + 0x428) == -1) ||
     (pvVar3 = *(LPVOID *)((int)this + 0x674), pvVar3 == (LPVOID)0x0)) {
    iVar8 = 999;
LAB_6768cfb5:
    puVar4 = (undefined4 *)FUN_6767ca9c(param_1,iVar8,0x4000000);
  }
  else {
    DVar7 = 0x8000;
    uVar5 = 0;
    while (puVar4 = (undefined4 *)FUN_6768dc46(this,param_1,pvVar3,DVar7,&local_8,param_4),
          (char)puVar4 != '\0') {
      local_8 = local_8 + uVar5;
      uVar6 = uVar5;
      if (uVar5 < local_8) {
        do {
          pcVar1 = (char *)(uVar5 + *(int *)((int)this + 0x674));
          pcVar2 = (char *)(uVar6 + param_2);
          uVar5 = uVar5 + 1;
          uVar6 = uVar6 + 1;
          if (*pcVar2 == *pcVar1) {
            if (uVar6 == param_3) {
              local_c = (int)(uVar5 - local_8) >> 0x1f;
              DVar7 = SetFilePointer(*(HANDLE *)((int)this + 0x428),uVar5 - local_8,&local_c,1);
              if (DVar7 != 0xffffffff) {
                return CONCAT31((int3)(DVar7 >> 8),1);
              }
              iVar8 = 0x1f5;
              goto LAB_6768cfb5;
            }
          }
          else {
            uVar5 = uVar5 + (1 - uVar6);
            uVar6 = 0;
          }
                    /* WARNING: Load size is inaccurate */
          puVar4 = (undefined4 *)(**(code **)(*this + 0x18))(param_1);
          if ((char)puVar4 == '\0') goto LAB_6768cfbd;
        } while (uVar5 < local_8);
      }
      if (uVar6 != 0) {
        puVar4 = FUN_676b06d0(*(undefined4 **)((int)this + 0x674),
                              (undefined4 *)
                              ((int)*(undefined4 **)((int)this + 0x674) + (local_8 - uVar6)),uVar6);
      }
      if (local_8 == 0) break;
      DVar7 = 0x8000 - uVar6;
      pvVar3 = (LPVOID)(uVar6 + *(int *)((int)this + 0x674));
      uVar5 = uVar6;
    }
  }
LAB_6768cfbd:
  return (uint)puVar4 & 0xffffff00;
}



// Function: FUN_6768cfca at 6768cfca

uint __thiscall
FUN_6768cfca(void *this,void *param_1,int param_2,int param_3,int param_4,uint param_5,char param_6)

{
  DWORD DVar1;
  uint uVar2;
  undefined4 uVar3;
  int iVar4;
  DWORD DVar5;
  int iVar6;
  int local_20;
  DWORD local_1c;
  LONG local_18;
  DWORD local_14;
  int local_10;
  undefined *local_c;
  uint local_8;
  
  if (*(int *)((int)this + 0x428) == -1) {
    FUN_6767ca9c(param_1,999,0x4000000);
  }
  if (0x7fffffff < param_5) {
    FUN_6767ca9c(param_1,999,0x4000000);
  }
  local_8 = param_5;
  local_1c = 0;
  local_18 = 0;
  local_1c = SetFilePointer(*(HANDLE *)((int)this + 0x428),0,&local_18,1);
  if ((local_1c == 0xffffffff) && (DVar1 = GetLastError(), DVar1 != 0)) {
LAB_6768d03c:
    iVar6 = 0x1f5;
  }
  else {
    if ((local_18 == 0) && (local_1c < param_5)) {
      local_8 = local_1c;
    }
    if (local_8 != 0) {
      local_20 = (int)-local_8 >> 0x1f;
      DVar1 = SetFilePointer(*(HANDLE *)((int)this + 0x428),-local_8,&local_20,1);
      if (DVar1 != 0xffffffff) {
        local_c = (undefined *)operator_new(local_8);
        if (local_c == (undefined *)0x0) {
          iVar6 = 0x1ff;
          goto LAB_6768d046;
        }
        local_14 = 0;
        uVar3 = FUN_6768dc46(this,param_1,local_c,local_8,&local_14,'\0');
        iVar6 = param_3;
        DVar1 = local_14;
        if ((char)uVar3 == '\0') {
          uVar2 = FUN_676b0bb3(local_c);
          goto LAB_6768d163;
        }
        do {
          while( true ) {
            if (DVar1 == 0) {
              FUN_676b0bb3(local_c);
              goto LAB_6768d139;
            }
            DVar5 = DVar1 - 1;
            iVar6 = iVar6 + -1;
            if (local_c[DVar5] == *(char *)(iVar6 + param_2)) break;
            iVar4 = param_3 - iVar6;
            iVar6 = param_3;
            DVar1 = (DVar1 - 2) + iVar4;
          }
          DVar1 = DVar5;
        } while (iVar6 != 0);
        FUN_676b0bb3(local_c);
        local_10 = (DVar5 - local_14) + param_3;
        local_c = (undefined *)(local_10 >> 0x1f);
        DVar1 = SetFilePointer(*(HANDLE *)((int)this + 0x428),local_10,(PLONG)&local_c,1);
        if (DVar1 != 0xffffffff) {
          return CONCAT31((int3)(DVar1 >> 8),1);
        }
      }
      goto LAB_6768d03c;
    }
LAB_6768d139:
    if (param_6 == '\0') {
      uVar2 = FUN_6768d185(this,param_1,param_4,0,(void *)0x0,2);
      if ((char)uVar2 != '\0') {
        uVar3 = FUN_6768cfca(this,param_1,param_2,param_3,param_4,param_5,'\0');
        return uVar3;
      }
      goto LAB_6768d163;
    }
    iVar6 = 900;
  }
LAB_6768d046:
  uVar2 = FUN_6767ca9c(param_1,iVar6,0x4000000);
LAB_6768d163:
  return uVar2 & 0xffffff00;
}



// Function: FUN_6768d185 at 6768d185

uint __thiscall
FUN_6768d185(void *this,void *param_1,int param_2,LONG param_3,void *param_4,int param_5)

{
  uint uVar1;
  DWORD DVar2;
  void *local_8;
  
  local_8 = this;
  if (*(int *)((int)this + 0x428) == -1) {
    uVar1 = FUN_6767ca9c(param_1,999,0x4000000);
LAB_6768d1cf:
    uVar1 = uVar1 & 0xffffff00;
  }
  else {
    if ((param_5 != 1) && ((param_2 != *(int *)((int)this + 0x424) || (param_2 == -1)))) {
      uVar1 = FUN_6768ddeb(this,param_1,param_2);
      if ((char)uVar1 == '\0') goto LAB_6768d1cf;
    }
    local_8 = param_4;
    DVar2 = SetFilePointer(*(HANDLE *)((int)this + 0x428),param_3,(PLONG)&local_8,
                           -(uint)(param_5 != 0) & (param_5 != 1) + 1);
    uVar1 = CONCAT31((int3)(DVar2 >> 8),1);
  }
  return uVar1;
}



// Function: FUN_6768d20a at 6768d20a

uint __thiscall
FUN_6768d20a(void *this,void *param_1,LONG param_2,LONG param_3,int param_4,char param_5)

{
  uint uVar1;
  DWORD DVar2;
  HANDLE hFile;
  void *local_8;
  
  hFile = *(HANDLE *)((int)this + 0x428);
  if (hFile == (HANDLE)0xffffffff) {
    local_8 = this;
    uVar1 = FUN_6767ca9c(param_1,999,0x4000000);
    uVar1 = uVar1 & 0xffffff00;
  }
  else {
    local_8 = (void *)param_3;
    if ((param_5 != '\0') && (*(HANDLE *)((int)this + 0x638) != (HANDLE)0xffffffff)) {
      hFile = *(HANDLE *)((int)this + 0x638);
    }
    DVar2 = SetFilePointer(hFile,param_2,(PLONG)&local_8,-(uint)(param_4 != 0) & (param_4 != 1) + 1)
    ;
    uVar1 = CONCAT31((int3)(DVar2 >> 8),1);
  }
  return uVar1;
}



// Function: FUN_6768d27f at 6768d27f

void __thiscall FUN_6768d27f(void *this,char param_1)

{
  HANDLE hFile;
  LONG local_8;
  
  hFile = *(HANDLE *)((int)this + 0x428);
  if (hFile != (HANDLE)0xffffffff) {
    local_8 = 0;
    if ((param_1 != '\0') && (*(HANDLE *)((int)this + 0x638) != (HANDLE)0xffffffff)) {
      hFile = *(HANDLE *)((int)this + 0x638);
    }
    SetFilePointer(hFile,0,&local_8,1);
  }
  return;
}



// Function: FUN_6768d2cc at 6768d2cc

uint __thiscall FUN_6768d2cc(void *this,void *param_1,LPVOID param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  LPVOID pvVar3;
  void *local_8;
  
  if (*(int *)((int)this + 0x428) == -1) {
    local_8 = this;
    uVar1 = FUN_6767ca9c(param_1,999,0x4000000);
  }
  else {
    uVar2 = 0;
    pvVar3 = param_2;
    uVar1 = param_3;
    while( true ) {
      local_8 = (void *)0x0;
      uVar1 = FUN_6768dc46(this,param_1,pvVar3,uVar1,(LPDWORD)&local_8,'\0');
      if ((char)uVar1 == '\0') break;
      if (local_8 == (void *)0x0) {
        uVar1 = FUN_6767ca9c(param_1,0x1f6,0x4000000);
      }
      uVar2 = uVar2 + (int)local_8;
      if (param_3 <= uVar2) {
        return CONCAT31((int3)(uVar1 >> 8),1);
      }
      uVar1 = param_3 - uVar2;
      pvVar3 = (LPVOID)(uVar2 + (int)param_2);
    }
  }
  return uVar1 & 0xffffff00;
}



// Function: FUN_6768d357 at 6768d357

uint __thiscall
FUN_6768d357(void *this,void *param_1,undefined4 *param_2,uint param_3,undefined4 param_4)

{
  bool bVar1;
  uint uVar2;
  HANDLE pvVar3;
  LPVOID pvVar4;
  undefined4 uVar5;
  undefined4 *puVar6;
  uint uVar7;
  undefined8 uVar8;
  DWORD DVar9;
  int iVar10;
  uint local_18;
  DWORD local_c;
  DWORD local_8;
  
  if ((*(int *)((int)this + 0x428) == -1) || (*(char *)((int)this + 0x42d) == '\0')) {
LAB_6768d5be:
    iVar10 = 999;
  }
  else {
    if (((char)param_4 != '\0') ||
       ((*(uint *)((int)this + 0x41c) == 0 || (param_3 <= *(uint *)((int)this + 0x41c))))) {
      uVar7 = *(uint *)((int)this + 0x67c);
      if (uVar7 == 0) {
        if (*(char *)((int)this + 0x6a8) == '\0') {
          local_18 = *(uint *)((int)this + 0x6c0);
          iVar10 = *(int *)((int)this + 0x6c4);
        }
        else {
          local_18 = 0xffffffff;
          iVar10 = -1;
        }
        bVar1 = false;
        if ((*(int *)((int)this + 0x41c) != 0) && (*(char *)((int)this + 0x6a8) == '\0')) {
          pvVar3 = *(HANDLE *)((int)this + 0x638);
          if (pvVar3 == (HANDLE)0xffffffff) {
            pvVar3 = *(HANDLE *)((int)this + 0x428);
          }
          DVar9 = GetFileSize(pvVar3,&local_c);
          if ((local_c != 0) || (*(uint *)((int)this + 0x41c) < DVar9)) goto LAB_6768d5be;
          uVar7 = *(uint *)((int)this + 0x41c) - DVar9;
          if ((iVar10 != 0) || (uVar7 < local_18)) {
            iVar10 = 0;
            bVar1 = true;
            local_18 = uVar7;
          }
        }
        *(undefined4 *)((int)this + 0x6ac) = *(undefined4 *)((int)this + 0x424);
        uVar8 = FUN_6768d27f(this,'\x01');
        puVar6 = (undefined4 *)0x0;
        *(undefined8 *)((int)this + 0x6b0) = uVar8;
        *(uint *)((int)this + 0x6b8) = param_3;
        local_8 = 0;
        if (((iVar10 != 0) || (param_3 <= local_18)) || ((char)param_4 != '\0')) {
          uVar7 = param_3;
          if ((iVar10 == 0) && (local_18 < param_3)) {
            uVar7 = local_18;
          }
          puVar6 = (undefined4 *)FUN_6768dcd7(this,param_1,param_2,uVar7,&local_8);
          if ((char)puVar6 == '\0') goto LAB_6768d5d0;
        }
        if (param_3 <= local_8) {
LAB_6768d437:
          return CONCAT31((int3)((uint)puVar6 >> 8),1);
        }
        if (*(char *)((int)this + 0x6a8) == '\0') {
          if ((*(char *)((int)this + 0x418) != '\0') || (bVar1)) {
            puVar6 = (undefined4 *)FUN_6768ddeb(this,param_1,*(int *)((int)this + 0x424) + 1);
            if ((char)puVar6 != '\0') {
              if (local_8 == 0) {
                *(undefined4 *)((int)this + 0x6ac) = *(undefined4 *)((int)this + 0x424);
                uVar8 = FUN_6768d27f(this,'\x01');
                *(undefined8 *)((int)this + 0x6b0) = uVar8;
              }
              goto LAB_6768d5a3;
            }
            goto LAB_6768d5d0;
          }
          if (local_8 != 0) {
LAB_6768d5a3:
            uVar5 = FUN_6768d357(this,param_1,(undefined4 *)(local_8 + (int)param_2),
                                 param_3 - local_8,param_4);
            return uVar5;
          }
          iVar10 = 0x1fb;
          goto LAB_6768d5c8;
        }
      }
      else if ((char)param_4 == '\0') {
        uVar2 = *(int *)((int)this + 0x680) + param_3;
        if (uVar7 < uVar2) {
          uVar7 = uVar7 + 0x8000;
          if (uVar7 < uVar2) {
            uVar7 = uVar7 + ((uVar2 - uVar7) + 0x7fff & 0xffff8000);
          }
          pvVar4 = *(LPVOID *)((int)this + 0x678);
          DVar9 = 0;
          uVar2 = uVar7;
          pvVar3 = GetProcessHeap();
          pvVar4 = HeapReAlloc(pvVar3,DVar9,pvVar4,uVar2);
          if (pvVar4 == (LPVOID)0x0) {
            iVar10 = 0x1ff;
            goto LAB_6768d5c8;
          }
          *(LPVOID *)((int)this + 0x678) = pvVar4;
          *(uint *)((int)this + 0x67c) = uVar7;
        }
        puVar6 = FUN_676b06d0((undefined4 *)
                              (*(int *)((int)this + 0x678) + *(int *)((int)this + 0x680)),param_2,
                              param_3);
        *(int *)((int)this + 0x680) = *(int *)((int)this + 0x680) + param_3;
        goto LAB_6768d437;
      }
      goto LAB_6768d5be;
    }
    iVar10 = 0x200;
  }
LAB_6768d5c8:
  puVar6 = (undefined4 *)FUN_6767ca9c(param_1,iVar10,0x4000000);
LAB_6768d5d0:
  return (uint)puVar6 & 0xffffff00;
}



// Function: FUN_6768d5d9 at 6768d5d9

uint __thiscall
FUN_6768d5d9(void *this,void *param_1,undefined4 *param_2,uint param_3,undefined4 param_4,
            undefined4 param_5)

{
  undefined4 *puVar1;
  uint uVar2;
  int iVar3;
  
  if (*(int *)((int)this + 0x67c) == 0) {
    iVar3 = 999;
  }
  else {
    puVar1 = (undefined4 *)operator_new(0x10);
    if (puVar1 != (undefined4 *)0x0) {
      *puVar1 = param_4;
      puVar1[1] = *(undefined4 *)((int)this + 0x680);
      puVar1[3] = param_5;
      puVar1[2] = param_3;
      FUN_6768e99e((void *)((int)this + 0x684),puVar1);
      uVar2 = FUN_6768d357(this,param_1,param_2,param_3,0);
      return uVar2;
    }
    iVar3 = 0x1ff;
  }
  uVar2 = FUN_6767ca9c(param_1,iVar3,0x4000000);
  return uVar2 & 0xffffff00;
}



// Function: FUN_6768d653 at 6768d653

uint __thiscall FUN_6768d653(void *this,void *param_1,int param_2,uint param_3)

{
  undefined1 uVar1;
  char cVar2;
  HANDLE pvVar3;
  undefined4 uVar4;
  DWORD DVar5;
  int iVar6;
  BOOL BVar7;
  uint uVar8;
  uint uVar9;
  undefined4 *puVar10;
  longlong lVar11;
  int iVar12;
  int iVar13;
  WCHAR local_65c [259];
  WCHAR aWStack_456 [2];
  undefined4 local_452 [129];
  ushort auStack_24e [2];
  undefined4 local_24a [129];
  _BY_HANDLE_FILE_INFORMATION local_44;
  _FILETIME local_10;
  ushort *local_8;
  
  uVar8 = param_3;
  uVar9 = 0;
  if (((this == (void *)0xfffffdf0) || (this == (void *)0xfffffff8)) ||
     (*(int *)((int)this + 0x428) != -1)) {
    iVar12 = 999;
LAB_6768da4f:
    uVar8 = FUN_6767ca9c(param_1,iVar12,0x4000000);
LAB_6768da57:
    return uVar8 & 0xffffff00;
  }
  uVar1 = (undefined1)param_3;
  param_3 = CONCAT13(uVar1,(undefined3)param_3);
  if (((*(char *)((int)this + 0x670) != '\0') && (param_2 != -1)) &&
     (*(char *)((int)this + 0x42d) == '\0')) {
    param_3 = uVar8 & 0xffffff;
  }
LAB_6768d6ab:
  do {
    while (param_3._3_1_ != '\0') {
LAB_6768d6b4:
      do {
        if ((*(char *)((int)this + 0x42d) == '\0') || (param_2 == -1)) {
LAB_6768d6d8:
          if ((*(char *)((int)this + 0x418) != '\0') || (*(char *)((int)this + 0x42d) == '\0'))
          goto LAB_6768d6f2;
          if (*(int *)((int)this + 0x41c) == 0) goto LAB_6768da45;
        }
        else {
          if (*(char *)((int)this + 0x418) == '\0') {
            if (*(int *)((int)this + 0x41c) != 0) goto LAB_6768d6d8;
            iVar12 = 0x1f6;
            goto LAB_6768da4f;
          }
LAB_6768d6f2:
                    /* WARNING: Load size is inaccurate */
          uVar8 = (**(code **)(*this + 4))(param_1,param_2);
          if ((char)uVar8 == '\0') goto LAB_6768da57;
        }
        param_3 = param_3 & 0xffffff;
        pvVar3 = FUN_676aeee9((LPCWSTR)((int)this + 0x210),0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3
                              ,0x8000080,(HANDLE)0x0);
        if (pvVar3 == (HANDLE)0xffffffff) {
          DVar5 = GetLastError();
          if (DVar5 == 0x15) {
            param_3 = CONCAT13(1,(undefined3)param_3);
          }
        }
        else if (((*(char *)((int)this + 0x42d) == '\0') || (param_2 == -1)) ||
                (*(int *)((int)this + 0x41c) != 0)) {
          CloseHandle(pvVar3);
        }
        else {
          GetFileInformationByHandle(pvVar3,&local_44);
          CloseHandle(pvVar3);
          uVar4 = FUN_6768e4ca((int *)&local_44,(int *)((int)this + 0x63c));
          if ((char)uVar4 != '\0') goto LAB_6768d76e;
        }
      } while (param_3._3_1_ != '\0');
                    /* WARNING: Load size is inaccurate */
      uVar8 = (**(code **)(*this + 8))(param_1);
      if ((char)uVar8 == '\0') goto LAB_6768da57;
    }
    if (*(char *)((int)this + 0x418) != '\0') {
      uVar8 = FUN_6768e6f6(this,param_1,(undefined1 *)((int)&param_3 + 3));
      if ((char)uVar8 == '\0') goto LAB_6768da57;
      if (param_3._3_1_ != '\0') goto LAB_6768d6b4;
    }
                    /* WARNING: Load size is inaccurate */
    uVar8 = (**(code **)(*this + 0x10))(param_1,param_2,(int)&param_3 + 3);
    if ((char)uVar8 == '\0') goto LAB_6768da57;
    if (param_3._3_1_ != '\0') goto LAB_6768d6b4;
    if (((*(char *)((int)this + 0x42d) == '\0') && (param_2 != -1)) &&
       (*(char *)((int)this + 0x670) == '\0')) {
      aWStack_456[1] = 0;
      auStack_24e[1] = 0;
      puVar10 = local_452;
      for (iVar12 = 0x81; iVar12 != 0; iVar12 = iVar12 + -1) {
        *puVar10 = 0;
        puVar10 = puVar10 + 1;
      }
      *(undefined2 *)puVar10 = 0;
      puVar10 = local_24a;
      for (iVar12 = 0x81; iVar12 != 0; iVar12 = iVar12 + -1) {
        *puVar10 = 0;
        puVar10 = puVar10 + 1;
      }
      *(undefined2 *)puVar10 = 0;
      iVar12 = FUN_676ae2a4(u_PKBACK__676c0dd4);
      FUN_676ac8da((short *)((int)this + 8),local_65c,(short *)0x0,(short *)0x0);
      FUN_676af62f(local_65c,aWStack_456 + 1,0x104,(LPDWORD)0x0,(LPDWORD)0x0,(LPDWORD)0x0,
                   (LPWSTR)0x0,0);
      local_8 = (ushort *)((int)local_452 + iVar12 * 2 + -2);
      aWStack_456[iVar12] = L'\0';
      FUN_676ae1fc((short *)(auStack_24e + 1),u_PKBACK__676c0dd4);
      iVar13 = 3;
      iVar6 = FUN_676ae2a4((short *)(auStack_24e + 1));
      FUN_676ad2a6(param_2 + 1,(short *)((int)local_24a + iVar6 * 2 + -2),iVar13);
      auStack_24e[iVar12] = 0;
      iVar6 = FUN_676ae307((ushort *)(aWStack_456 + 1),auStack_24e + 1);
      if (((iVar6 == 0) && (uVar8 = FUN_676ae2a4((short *)local_8), 2 < uVar8)) &&
         (iVar12 = FUN_676ae2c8(local_8,(ushort *)((int)local_24a + iVar12 * 2 + -2)), iVar12 != 0))
      {
        param_3 = CONCAT13(1,(undefined3)param_3);
      }
      if (param_3._3_1_ != '\0') goto LAB_6768d6b4;
    }
    if ((((*(char *)((int)this + 0x42d) == '\0') && (param_2 == -1)) ||
        ((*(char *)((int)this + 0x670) != '\0' ||
         ((*(char *)((int)this + 0x42d) != '\0' && (*(int *)((int)this + 0x41c) != 0)))))) &&
       (cVar2 = FUN_676ad058((LPCWSTR)((int)this + 0x210),(short *)((int)this + 8),param_2),
       cVar2 != '\0')) {
      *(undefined1 *)((int)this + 0x670) = 1;
    }
    cVar2 = *(char *)((int)this + 0x42d);
    pvVar3 = FUN_676aeee9((LPCWSTR)((int)this + 0x210),
                          -(uint)(cVar2 != '\0') & 0x40000000 | 0x80000000,(uint)(cVar2 == '\0'),
                          (LPSECURITY_ATTRIBUTES)0x0,(cVar2 != '\0') + 3,0x8000080,(HANDLE)0x0);
    *(HANDLE *)((int)this + 0x428) = pvVar3;
    if (pvVar3 == (HANDLE)0xffffffff) {
      DVar5 = GetLastError();
      if ((DVar5 == 0x13) || (DVar5 == 0x15)) {
        if (*(char *)((int)this + 0x418) == '\0') goto LAB_6768da45;
      }
      else if ((*(char *)((int)this + 0x670) == '\0') || (*(char *)((int)this + 0x42d) != '\0')) {
LAB_6768da45:
        iVar12 = 0x1f7;
        goto LAB_6768da4f;
      }
LAB_6768d76e:
      param_3 = CONCAT13(1,(undefined3)param_3);
      goto LAB_6768d6ab;
    }
    DVar5 = GetLastError();
    if ((DVar5 == 0xb7) && (*(char *)((int)this + 0x42d) != '\0')) {
      GetFileTime(*(HANDLE *)((int)this + 0x428),&local_10,(LPFILETIME)0x0,(LPFILETIME)0x0);
      BVar7 = SetFileTime(*(HANDLE *)((int)this + 0x428),&local_10,(FILETIME *)0x0,(FILETIME *)0x0);
      if (BVar7 == 0) {
        CloseHandle(*(HANDLE *)((int)this + 0x428));
        *(undefined4 *)((int)this + 0x428) = 0xffffffff;
        param_3 = CONCAT13(1,(undefined3)param_3);
      }
    }
    if (param_3._3_1_ == '\0') {
      *(int *)((int)this + 0x424) = param_2;
      if (((*(char *)((int)this + 0x42d) != '\0') && (param_2 != 0)) && (param_2 != -1)) {
        SetEndOfFile(*(HANDLE *)((int)this + 0x428));
      }
      if (*(char *)((int)this + 0x418) != '\0') {
        uVar9 = *(uint *)((int)this + 0x420);
      }
      lVar11 = FUN_6768e217((LPCWSTR)((int)this + 0x210));
      iVar12 = (uint)lVar11 - uVar9;
      *(int *)((int)this + 0x6c0) = iVar12;
      *(uint *)((int)this + 0x6c4) = (int)((ulonglong)lVar11 >> 0x20) - (uint)((uint)lVar11 < uVar9)
      ;
      return CONCAT31((int3)((uint)iVar12 >> 8),1);
    }
  } while( true );
}



// Function: FUN_6768dab2 at 6768dab2

uint __thiscall FUN_6768dab2(void *this,void *param_1)

{
  LPCWSTR pWVar1;
  uint uVar2;
  int iVar3;
  
  pWVar1 = (LPCWSTR)((int)this + 0x42e);
  if (*(short *)((int)this + 0x42e) == 0) {
    *(undefined4 *)((int)this + 0x638) = 0xffffffff;
LAB_6768db1b:
    uVar2 = CONCAT31((int3)((uint)pWVar1 >> 8),1);
  }
  else {
    if (*(char *)((int)this + 0x42d) == '\0') {
      iVar3 = 999;
    }
    else {
      pWVar1 = (LPCWSTR)FUN_676aeee9(pWVar1,0x40000000,0,(LPSECURITY_ATTRIBUTES)0x0,2,0x80,
                                     (HANDLE)0x0);
      *(LPCWSTR *)((int)this + 0x638) = pWVar1;
      if (pWVar1 != (LPCWSTR)0xffffffff) goto LAB_6768db1b;
      iVar3 = 0x1f8;
    }
    uVar2 = FUN_6767ca9c(param_1,iVar3,0x4000000);
    uVar2 = uVar2 & 0xffffff00;
  }
  return uVar2;
}



// Function: FUN_6768db21 at 6768db21

undefined4 __fastcall FUN_6768db21(int param_1)

{
  HANDLE hObject;
  int iVar1;
  UINT UVar2;
  int iVar3;
  undefined4 *puVar4;
  WCHAR local_414 [260];
  WCHAR local_20c;
  undefined4 local_20a [129];
  
  hObject = *(HANDLE *)(param_1 + 0x428);
  if (hObject != (HANDLE)0xffffffff) {
    hObject = (HANDLE)CloseHandle(hObject);
    *(undefined4 *)(param_1 + 0x428) = 0xffffffff;
    if ((*(char *)(param_1 + 0x418) != '\0') && (iVar1 = *(int *)(param_1 + 0x424), iVar1 != -1)) {
      local_20c = L'\0';
      puVar4 = local_20a;
      for (iVar3 = 0x81; iVar3 != 0; iVar3 = iVar3 + -1) {
        *puVar4 = 0;
        puVar4 = puVar4 + 1;
      }
      *(undefined2 *)puVar4 = 0;
      *(int *)(param_1 + 0x6bc) = iVar1 + 1;
      FUN_676ae1fc(&local_20c,u_PKBACK__676c0dd4);
      iVar3 = 3;
      iVar1 = FUN_676ae2a4(&local_20c);
      FUN_676ad2a6(*(uint *)(param_1 + 0x6bc),(short *)((int)local_20a + iVar1 * 2 + -2),iVar3);
      FUN_676ac8da((short *)(param_1 + 0x210),local_414,(short *)0x0,(short *)0x0);
      UVar2 = FUN_676af2c4(local_414);
      if ((UVar2 == 2) || (hObject = (HANDLE)(UVar2 - 5), hObject == (HANDLE)0x0)) {
        hObject = (HANDLE)FUN_676af746(local_414,&local_20c);
      }
    }
  }
  return CONCAT31((int3)((uint)hObject >> 8),1);
}



// Function: FUN_6768dc0a at 6768dc0a

bool __thiscall FUN_6768dc0a(void *this,void *param_1,char param_2)

{
  bool bVar1;
  
  if (*(HANDLE *)((int)this + 0x638) != (HANDLE)0xffffffff) {
    CloseHandle(*(HANDLE *)((int)this + 0x638));
    *(undefined4 *)((int)this + 0x638) = 0xffffffff;
    if ((param_2 != '\0') && (bVar1 = FUN_6768de5d(this,param_1), !bVar1)) {
      return bVar1;
    }
  }
  return true;
}



// Function: FUN_6768dc46 at 6768dc46

uint __thiscall
FUN_6768dc46(void *this,void *param_1,LPVOID param_2,DWORD param_3,LPDWORD param_4,char param_5)

{
  HANDLE hFile;
  BOOL BVar1;
  uint uVar2;
  int iVar3;
  
  hFile = *(HANDLE *)((int)this + 0x428);
  do {
    if (hFile == (HANDLE)0xffffffff) {
      iVar3 = 999;
LAB_6768dcc3:
      uVar2 = FUN_6767ca9c(param_1,iVar3,0x4000000);
LAB_6768dcca:
      return uVar2 & 0xffffff00;
    }
    BVar1 = ReadFile(hFile,param_2,param_3,param_4,(LPOVERLAPPED)0x0);
    if (BVar1 == 0) {
      iVar3 = 0x1f9;
      goto LAB_6768dcc3;
    }
    if (*param_4 != 0) {
      return CONCAT31((int3)((uint)BVar1 >> 8),1);
    }
    if (param_5 != '\0') {
      iVar3 = 0x1f6;
      goto LAB_6768dcc3;
    }
    uVar2 = FUN_6768ddeb(this,param_1,*(int *)((int)this + 0x424) + 1);
    if ((char)uVar2 == '\0') goto LAB_6768dcca;
    hFile = *(HANDLE *)((int)this + 0x428);
    param_5 = '\0';
  } while( true );
}



// Function: FUN_6768dcd7 at 6768dcd7

uint __thiscall FUN_6768dcd7(void *this,void *param_1,LPCVOID param_2,DWORD param_3,LPDWORD param_4)

{
  uint uVar1;
  char cVar2;
  undefined4 uVar3;
  uint *puVar4;
  uint uVar5;
  undefined8 uVar6;
  int iVar7;
  undefined4 *local_c;
  undefined4 uStack_8;
  
  local_c = (undefined4 *)this;
  uStack_8 = this;
  if (*(int *)((int)this + 0x428) == -1) {
    iVar7 = 999;
  }
  else {
    if (*(int *)((int)this + 0x680) != 0) {
      uStack_8 = (void *)CONCAT13(1,(int3)this);
      uVar6 = 0;
      while (uVar3 = FUN_6768e908((void *)((int)this + 0x684),&local_c), (char)uVar3 != '\0') {
        if (uStack_8._3_1_ != '\0') {
          uStack_8 = (void *)((uint)uStack_8 & 0xffffff);
          uVar6 = FUN_6768d27f(this,'\x01');
        }
        cVar2 = (*(code *)**(undefined4 **)*local_c)
                          (param_1,*(undefined4 *)((int)this + 0x424),uVar6,
                           local_c[1] + (int)param_2,local_c[2],local_c[3]);
        if (cVar2 == '\0') {
          uVar5 = FUN_676b0bb3((undefined *)local_c);
          goto LAB_6768ddc4;
        }
        FUN_676b0bb3((undefined *)local_c);
      }
    }
    if (*(HANDLE *)((int)this + 0x638) == (HANDLE)0xffffffff) {
      puVar4 = (uint *)WriteFile(*(HANDLE *)((int)this + 0x428),param_2,param_3,param_4,
                                 (LPOVERLAPPED)0x0);
      if (puVar4 != (uint *)0x0) goto LAB_6768ddc8;
      iVar7 = 0x1fb;
    }
    else {
      puVar4 = (uint *)WriteFile(*(HANDLE *)((int)this + 0x638),param_2,param_3,param_4,
                                 (LPOVERLAPPED)0x0);
      if (puVar4 != (uint *)0x0) {
LAB_6768ddc8:
        if (*(char *)((int)this + 0x6a8) == '\0') {
          puVar4 = (uint *)((int)this + 0x6c0);
          uVar1 = *param_4;
          uVar5 = *puVar4;
          *puVar4 = *puVar4 - uVar1;
          *(int *)((int)this + 0x6c4) = *(int *)((int)this + 0x6c4) - (uint)(uVar5 < uVar1);
        }
        return CONCAT31((int3)((uint)puVar4 >> 8),1);
      }
      iVar7 = 0x1fa;
    }
  }
  uVar5 = FUN_6767ca9c(param_1,iVar7,0x4000000);
LAB_6768ddc4:
  return uVar5 & 0xffffff00;
}



// Function: FUN_6768ddeb at 6768ddeb

uint __thiscall FUN_6768ddeb(void *this,void *param_1,int param_2)

{
  bool bVar1;
  undefined4 uVar2;
  undefined3 extraout_var;
  uint uVar3;
  
  uVar2 = FUN_6768db21((int)this);
  bVar1 = FUN_6768dc0a(this,param_1,'\x01');
  uVar3 = CONCAT31(extraout_var,bVar1);
  if ((bVar1) && ((char)uVar2 != '\0')) {
    *(undefined4 *)((int)this + 0x6a0) = 0xffffffff;
    *(undefined4 *)((int)this + 0x6a4) = 0xffffffff;
    *(undefined1 *)((int)this + 0x6a8) = 0;
    FUN_6768e490(param_1,(LPCWSTR)((int)this + 0x210),
                 (LPBY_HANDLE_FILE_INFORMATION)((int)this + 0x63c));
    uVar3 = FUN_6768d653(this,param_1,param_2,1);
    if ((char)uVar3 != '\0') {
      uVar3 = FUN_6768dab2(this,param_1);
      return uVar3;
    }
  }
  return uVar3 & 0xffffff00;
}



// Function: FUN_6768de5d at 6768de5d

bool __thiscall FUN_6768de5d(void *this,void *param_1)

{
  LPCWSTR pWVar1;
  char cVar2;
  FARPROC pFVar3;
  int iVar4;
  BOOL BVar5;
  HANDLE hFile;
  undefined4 extraout_ECX;
  undefined4 extraout_EDX;
  bool bVar6;
  undefined8 uVar7;
  ushort local_450 [262];
  ushort local_244 [262];
  LPCWSTR local_38;
  undefined **local_34;
  LPVOID local_30;
  undefined1 local_2c;
  DWORD local_28;
  void *local_24;
  void *local_20;
  uint local_1c;
  int local_18;
  HANDLE local_14;
  HMODULE local_10;
  DWORD local_c;
  char local_5;
  
  if ((((*(int *)((int)this + 0x428) != -1) || (*(int *)((int)this + 0x638) != -1)) ||
      (*(LPCWSTR)((int)this + 0x210) == L'\0')) ||
     ((pWVar1 = (LPCWSTR)((int)this + 0x42e), local_38 = pWVar1, *(short *)((int)this + 0x42e) == 0
      || (*(int *)((int)this + 0x424) == -1)))) {
    iVar4 = 999;
    goto LAB_6768e114;
  }
  FUN_676af551((LPCWSTR)((int)this + 0x210));
                    /* WARNING: Load size is inaccurate */
  cVar2 = (**(code **)(*this + 0x14))(param_1,0);
  if (cVar2 == '\0') {
    return false;
  }
  local_5 = '\0';
  local_10 = LoadLibraryA(s_Kernel32_dll_676c0e00);
  if (local_10 == (HMODULE)0x0) {
LAB_6768df48:
    FUN_676ac8da((short *)((int)this + 0x210),(short *)local_450,(short *)0x0,(short *)0x0);
    FUN_676ac8da(pWVar1,(short *)local_244,(short *)0x0,(short *)0x0);
    iVar4 = FUN_676ae307(local_450,local_244);
    if (iVar4 == 0) {
      BVar5 = FUN_676af333(pWVar1,(LPCWSTR)((int)this + 0x210));
      if (BVar5 != 0) {
                    /* WARNING: Load size is inaccurate */
        cVar2 = (**(code **)(*this + 0x14))(param_1,100);
        if (cVar2 == '\0') {
          return false;
        }
        return true;
      }
    }
    else {
      hFile = FUN_676aeee9(pWVar1,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0x8000000,(HANDLE)0x0);
      local_14 = hFile;
      if (hFile != (HANDLE)0xffffffff) {
        local_10 = (HMODULE)FUN_676aeee9((LPCWSTR)((int)this + 0x210),0x40000000,0,
                                         (LPSECURITY_ATTRIBUTES)0x0,2,0x8000080,(HANDLE)0x0);
        if (local_10 != (HMODULE)0xffffffff) {
          local_c = 0;
          local_28 = 0;
          local_1c = 0;
          local_18 = 0;
          local_24 = (void *)GetFileSize(hFile,(LPDWORD)&local_20);
          local_30 = (LPVOID)0x0;
          local_2c = 0;
          local_34 = &PTR_FUN_676b99c4;
          FUN_6767e657(&local_34,0x8000);
          while (BVar5 = ReadFile(local_14,local_30,0x8000,&local_c,(LPOVERLAPPED)0x0), BVar5 != 0)
          {
            if (local_c == 0) goto LAB_6768e0cd;
            BVar5 = WriteFile(local_10,local_30,local_c,&local_28,(LPOVERLAPPED)0x0);
            if ((BVar5 == 0) || (local_c != local_28)) break;
            bVar6 = CARRY4(local_1c,local_c);
            local_1c = local_1c + local_c;
                    /* WARNING: Load size is inaccurate */
            iVar4 = *this;
            local_18 = local_18 + (uint)bVar6;
            uVar7 = FUN_676ad38e(extraout_ECX,extraout_EDX,CONCAT44(local_18,local_1c),
                                 (uint)local_24,(uint)local_20);
            cVar2 = (**(code **)(iVar4 + 0x14))(param_1,(int)uVar7);
            if ((cVar2 == '\0') || (local_c == 0)) goto LAB_6768e0cd;
          }
          FUN_6767ca9c(param_1,0x1fc,0x4000000);
LAB_6768e0cd:
          CloseHandle(local_14);
          FUN_676af551(local_38);
          CloseHandle(local_10);
          local_34 = &PTR_FUN_676b99c4;
          iVar4 = *(int *)((int)param_1 + 8);
          FUN_6767e692((int)&local_34);
          return iVar4 != 0x4000000;
        }
        CloseHandle(hFile);
      }
    }
  }
  else {
    pFVar3 = GetProcAddress(local_10,s_MoveFileWithProgressW_676c0de8);
    if (pFVar3 == (FARPROC)0x0) {
LAB_6768df36:
      FreeLibrary(local_10);
      if (local_5 != '\0') {
        return true;
      }
      goto LAB_6768df48;
    }
    local_20 = param_1;
    local_5 = '\x01';
    local_24 = this;
    iVar4 = (*pFVar3)(pWVar1,(int)this + 0x210,FUN_6768e807,&local_24,10);
    if (iVar4 != 0) {
                    /* WARNING: Load size is inaccurate */
      cVar2 = (**(code **)(*this + 0x14))(param_1,100);
      if (cVar2 == '\0') {
        return false;
      }
      goto LAB_6768df36;
    }
  }
  iVar4 = 0x1fc;
LAB_6768e114:
  FUN_6767ca9c(param_1,iVar4,0x4000000);
  return false;
}



// Function: FUN_6768e125 at 6768e125

undefined1 __thiscall FUN_6768e125(void *this,void *param_1,uint param_2,int param_3)

{
  undefined1 uVar1;
  char cVar2;
  undefined4 uVar3;
  uint uVar4;
  bool bVar5;
  undefined **local_10;
  undefined4 *local_c;
  undefined1 local_8;
  
  if ((((*(int *)((int)this + 0x428) == -1) || (*(int *)((int)this + 0x638) == -1)) ||
      (uVar1 = 0, *(char *)((int)this + 0x42c) == '\0')) || (*(char *)((int)this + 0x42d) == '\0'))
  {
    FUN_6767ca9c(param_1,999,0x4000000);
    uVar1 = 0;
  }
  else {
    uVar4 = 0x8000;
    local_c = (undefined4 *)0x0;
    local_8 = 0;
    local_10 = &PTR_FUN_676b99c4;
    FUN_6767e657(&local_10,0x8000);
    if (local_c == (undefined4 *)0x0) {
      FUN_6767ca9c(param_1,0x1ff,0x4000000);
    }
    else {
      if (param_3 != 0) goto LAB_6768e1ab;
      while (param_2 != 0) {
LAB_6768e1ab:
        do {
          if ((param_3 == 0) && (param_2 < uVar4)) {
            uVar4 = param_2;
          }
          uVar3 = FUN_6768d2cc(this,param_1,local_c,uVar4);
          if (((char)uVar3 == '\0') ||
             (uVar3 = FUN_6768d357(this,param_1,local_c,uVar4,1), (char)uVar3 == '\0'))
          goto LAB_6768e1ff;
          bVar5 = param_2 < uVar4;
          param_2 = param_2 - uVar4;
                    /* WARNING: Load size is inaccurate */
          param_3 = param_3 - (uint)bVar5;
          cVar2 = (**(code **)(*this + 0x18))(param_1);
          if (cVar2 == '\0') goto LAB_6768e1ff;
        } while (param_3 != 0);
      }
      uVar1 = 1;
    }
LAB_6768e1ff:
    local_10 = &PTR_FUN_676b99c4;
    FUN_6767e692((int)&local_10);
  }
  return uVar1;
}



// Function: FUN_6768e217 at 6768e217

/* WARNING: Removing unreachable block (ram,0x6768e46e) */
/* WARNING: Type propagation algorithm not settling */

longlong FUN_6768e217(LPCWSTR param_1)

{
  int iVar1;
  BOOL BVar2;
  DWORD DVar3;
  UINT UVar4;
  uint uVar5;
  uint uVar6;
  undefined1 *puVar7;
  undefined8 uVar8;
  longlong lVar9;
  ulonglong uVar10;
  WCHAR local_464 [261];
  short asStack_25a [261];
  FARPROC local_50;
  int local_4c;
  int local_48;
  HMODULE local_44;
  uint local_3c;
  uint local_38;
  uint local_34;
  uint local_30;
  int local_2c;
  undefined4 local_28;
  DWORD local_24;
  DWORD local_20;
  DWORD local_1c;
  DWORD local_18 [2];
  int local_10;
  DWORD local_c;
  char local_5;
  
  FUN_676ac8da(param_1,asStack_25a + 1,(short *)0x0,(short *)0x0);
  if (((&stack0x00000000 == (undefined1 *)0x258) ||
      (iVar1 = FUN_676ae2a4(asStack_25a + 1), iVar1 == 0)) ||
     ((iVar1 = FUN_676ae2a4(asStack_25a + 1), asStack_25a[iVar1] != 0x5c &&
      (iVar1 = FUN_676ae2a4(asStack_25a + 1), asStack_25a[iVar1] != 0x2f)))) {
    FUN_676ae272(asStack_25a + 1,(short *)&DAT_676c057c);
  }
  local_5 = '\0';
  uVar6 = 0xffffffff;
  local_10 = -1;
  uVar5 = 0;
  local_3c = 0;
  local_44 = LoadLibraryA(s_Kernel32_dll_676c0e00);
  if (local_44 != (HMODULE)0x0) {
    local_50 = GetProcAddress(local_44,s_GetDiskFreeSpaceExA_676c0e10);
    if (local_50 != (FARPROC)0x0) {
      local_30 = 0;
      local_38 = 0;
      local_28 = 0;
      local_2c = 0;
      local_34 = 0;
      local_24 = 0;
      if (&stack0x00000000 == (undefined1 *)0x258) {
        puVar7 = (undefined1 *)0x0;
      }
      else {
        iVar1 = lstrlenW(asStack_25a + 1);
        puVar7 = &stack0xfffffb90;
        local_48 = iVar1 * 2 + 2;
        FUN_676b06a0();
        WideCharToMultiByte(0,0,asStack_25a + 1,-1,&stack0xfffffb90,local_48,(LPCSTR)0x0,(LPBOOL)0x0
                           );
      }
      iVar1 = (*local_50)(puVar7,&local_30,&local_38,&local_28);
      if (iVar1 != 0) {
        local_10 = local_2c;
        local_5 = '\x01';
        local_3c = local_34;
        uVar5 = local_38;
        uVar6 = local_30;
      }
    }
    FreeLibrary(local_44);
  }
  local_18[0] = 0;
  local_c = 0;
  local_20 = 0;
  local_1c = 0;
  if ((local_5 == '\0') &&
     (BVar2 = FUN_676af3e6(asStack_25a + 1,local_18,&local_c,&local_20,&local_1c), BVar2 != 0)) {
    uVar6 = local_20 * local_c * local_18[0];
    uVar5 = local_1c * local_c * local_18[0];
    local_10 = 0;
    local_3c = 0;
  }
  lVar9 = CONCAT44(local_10,uVar6);
  if (*(HANDLE *)(local_4c + 0x428) != (HANDLE)0xffffffff) {
    DVar3 = GetFileSize(*(HANDLE *)(local_4c + 0x428),&local_24);
    lVar9 = CONCAT44(local_10,uVar6);
    if ((local_24 != 0) || (DVar3 != 0)) {
      if (local_c == 0) {
        lVar9 = CONCAT44(local_10 + local_24 + (uint)CARRY4(uVar6,DVar3),uVar6 + DVar3);
      }
      else {
        uVar8 = __aulldiv((local_c + DVar3) - 1,
                          (local_24 + CARRY4(local_c,DVar3)) - (uint)(local_c + DVar3 == 0),local_c,
                          0);
        lVar9 = __allmul((uint)uVar8,(int)((ulonglong)uVar8 >> 0x20),local_c,0);
        lVar9 = lVar9 + CONCAT44(local_10,uVar6);
      }
    }
  }
  local_10 = (int)((ulonglong)lVar9 >> 0x20);
  uVar6 = (uint)lVar9;
  if ((local_3c != 0) || (0xc800000 < uVar5)) {
    FUN_676aca1a(param_1,local_464,(short *)0x0,(short *)0x0);
    UVar4 = FUN_676af2c4(local_464);
    lVar9 = CONCAT44(local_10,uVar6);
    if ((UVar4 == 2) || (UVar4 == 5)) {
      uVar8 = __aulldiv(uVar5,local_3c,100,0);
      uVar10 = __allmul((uint)uVar8,(int)((ulonglong)uVar8 >> 0x20),3,0);
      if (uVar10 < CONCAT44(local_10,uVar6)) {
        lVar9 = CONCAT44((local_10 - (int)(uVar10 >> 0x20)) - (uint)(uVar6 < (uint)uVar10),
                         uVar6 - (uint)uVar10);
      }
      else {
        lVar9 = 0;
      }
    }
  }
  return lVar9;
}



// Function: FUN_6768e490 at 6768e490

undefined4 FUN_6768e490(undefined4 param_1,LPCWSTR param_2,LPBY_HANDLE_FILE_INFORMATION param_3)

{
  HANDLE hFile;
  
  hFile = FUN_676aeee9(param_2,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0,(HANDLE)0x0);
  if (hFile != (HANDLE)0xffffffff) {
    GetFileInformationByHandle(hFile,param_3);
    hFile = (HANDLE)CloseHandle(hFile);
  }
  return CONCAT31((int3)((uint)hFile >> 8),1);
}



// Function: FUN_6768e4ca at 6768e4ca

undefined4 FUN_6768e4ca(int *param_1,int *param_2)

{
  undefined4 uVar1;
  
  if ((((*param_1 == *param_2) && (param_1[7] == param_2[7])) && (param_1[2] == param_2[2])) &&
     (((param_1[1] == param_2[1] && (param_1[8] == param_2[8])) && (param_1[9] == param_2[9])))) {
    uVar1 = 1;
  }
  else {
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6768e50a at 6768e50a

void __thiscall FUN_6768e50a(void *this,undefined1 param_1)

{
  DWORD DVar1;
  HANDLE hFile;
  LONG local_8;
  
  hFile = *(HANDLE *)((int)this + 0x638);
  local_8 = 0;
  if (hFile == (HANDLE)0xffffffff) {
    hFile = *(HANDLE *)((int)this + 0x428);
  }
  DVar1 = SetFilePointer(hFile,0,&local_8,1);
  *(DWORD *)((int)this + 0x6a0) = DVar1;
  *(LONG *)((int)this + 0x6a4) = local_8;
  *(undefined1 *)((int)this + 0x6a8) = param_1;
  return;
}



// Function: FUN_6768e55d at 6768e55d

uint __thiscall FUN_6768e55d(void *this,char param_1,undefined1 param_2)

{
  uint lDistanceToMove;
  void *pvVar1;
  uint in_EAX;
  DWORD DVar2;
  HANDLE hFile;
  void *local_8;
  
  if (*(int *)((int)this + 0x428) != -1) {
    lDistanceToMove = *(uint *)((int)this + 0x6a0);
    pvVar1 = *(void **)((int)this + 0x6a4);
    in_EAX = lDistanceToMove & (uint)pvVar1;
    if (in_EAX != 0xffffffff) {
      if (param_1 != '\0') {
        local_8 = this;
        FUN_6768e50a(this,0);
      }
      hFile = *(HANDLE *)((int)this + 0x638);
      if (hFile == (HANDLE)0xffffffff) {
        hFile = *(HANDLE *)((int)this + 0x428);
      }
      local_8 = pvVar1;
      DVar2 = SetFilePointer(hFile,lDistanceToMove,(PLONG)&local_8,0);
      *(undefined1 *)((int)this + 0x6a8) = param_2;
      return CONCAT31((int3)(DVar2 >> 8),1);
    }
  }
  return in_EAX & 0xffffff00;
}



// Function: FUN_6768e5d6 at 6768e5d6

void __thiscall FUN_6768e5d6(void *this,undefined4 *param_1,undefined4 *param_2,undefined4 *param_3)

{
  if (param_1 != (undefined4 *)0x0) {
    *param_1 = *(undefined4 *)((int)this + 0x6ac);
  }
  if (param_2 != (undefined4 *)0x0) {
    *param_2 = *(undefined4 *)((int)this + 0x6b0);
    param_2[1] = *(undefined4 *)((int)this + 0x6b4);
  }
  if (param_3 != (undefined4 *)0x0) {
    *param_3 = *(undefined4 *)((int)this + 0x6b8);
  }
  return;
}



// Function: FUN_6768e612 at 6768e612

bool __thiscall FUN_6768e612(void *this,void *param_1,char param_2)

{
  undefined4 uVar1;
  HANDLE pvVar2;
  LPVOID pvVar3;
  bool bVar4;
  DWORD DVar5;
  int iVar6;
  SIZE_T dwBytes;
  
  bVar4 = true;
  iVar6 = *(int *)((int)this + 0x67c);
  if (iVar6 == 0) {
    if (param_2 != '\0') {
      dwBytes = 0x8000;
      DVar5 = 0;
      *(undefined4 *)((int)this + 0x67c) = 0x8000;
      pvVar2 = GetProcessHeap();
      pvVar3 = HeapAlloc(pvVar2,DVar5,dwBytes);
      *(LPVOID *)((int)this + 0x678) = pvVar3;
      if (pvVar3 == (LPVOID)0x0) {
        iVar6 = 0x1ff;
        goto LAB_6768e6e5;
      }
      goto LAB_6768e6c8;
    }
  }
  else if (*(undefined4 **)((int)this + 0x678) != (undefined4 *)0x0) {
    if (*(uint *)((int)this + 0x680) != 0) {
      *(undefined4 *)((int)this + 0x67c) = 0;
      uVar1 = FUN_6768d357(this,param_1,*(undefined4 **)((int)this + 0x678),
                           *(uint *)((int)this + 0x680),0);
      bVar4 = (char)uVar1 == '\0';
      if (bVar4) {
        param_2 = '\0';
      }
      bVar4 = !bVar4;
      *(int *)((int)this + 0x67c) = iVar6;
    }
    if (param_2 == '\0') {
      pvVar3 = *(LPVOID *)((int)this + 0x678);
      DVar5 = 0;
      pvVar2 = GetProcessHeap();
      HeapFree(pvVar2,DVar5,pvVar3);
      *(undefined4 *)((int)this + 0x678) = 0;
      *(undefined4 *)((int)this + 0x67c) = 0;
      *(undefined4 *)((int)this + 0x680) = 0;
      return bVar4;
    }
LAB_6768e6c8:
    *(undefined4 *)((int)this + 0x680) = 0;
    if (*(int *)((int)this + 0x698) == 0) {
      return bVar4;
    }
  }
  iVar6 = 999;
LAB_6768e6e5:
  FUN_6767ca9c(param_1,iVar6,0x4000000);
  return false;
}



// Function: FUN_6768e6f6 at 6768e6f6

uint __thiscall FUN_6768e6f6(void *this,void *param_1,undefined1 *param_2)

{
  HANDLE hFindFile;
  DWORD DVar1;
  UINT UVar2;
  uint uVar3;
  int iVar4;
  _WIN32_FIND_DATAW local_460;
  WCHAR local_210 [260];
  int local_8;
  
  if ((*(char *)((int)this + 0x42d) == '\0') || (*(char *)((int)this + 0x418) == '\0')) {
    iVar4 = 999;
LAB_6768e7f6:
    uVar3 = FUN_6767ca9c(param_1,iVar4,0x4000000);
LAB_6768e7fe:
    uVar3 = uVar3 & 0xffffff00;
  }
  else {
    FUN_676ac8da((short *)((int)this + 0x210),local_210,(short *)0x0,(short *)0x0);
    FUN_676ae272(local_210,(short *)&DAT_676c05a4);
    *param_2 = 0;
    hFindFile = FUN_676aee00(local_210,&local_460);
    if (hFindFile == (HANDLE)0xffffffff) {
      DVar1 = GetLastError();
      UVar2 = DVar1 - 2;
      if ((UVar2 != 0) && (UVar2 = DVar1 - 0x12, UVar2 != 0)) {
LAB_6768e773:
        *param_2 = 1;
      }
    }
    else {
      FindClose(hFindFile);
                    /* WARNING: Load size is inaccurate */
      local_8 = 1;
      uVar3 = (**(code **)(*this + 0xc))(param_1,&local_8);
      if ((char)uVar3 == '\0') goto LAB_6768e7fe;
      if (local_8 == 0) {
        iVar4 = FUN_676ae2a4(local_210);
        local_460.cAlternateFileName[iVar4 + 0xc] = L'\0';
        UVar2 = FUN_676af2c4(local_210);
        if (UVar2 == 2) {
          UVar2 = FUN_676ad569(local_210);
        }
      }
      else {
        UVar2 = local_8 - 2;
        if (UVar2 == 0) goto LAB_6768e773;
        UVar2 = local_8 - 3;
        if (UVar2 == 0) {
          iVar4 = 0x210;
          goto LAB_6768e7f6;
        }
      }
    }
    uVar3 = CONCAT31((int3)(UVar2 >> 8),1);
  }
  return uVar3;
}



// Function: FUN_6768e807 at 6768e807

bool __fastcall
FUN_6768e807(undefined4 param_1,undefined4 param_2,uint param_3,uint param_4,undefined4 param_5,
            undefined4 param_6)

{
  int iVar1;
  char cVar2;
  undefined8 uVar3;
  undefined4 *in_stack_00000034;
  
  iVar1 = *(int *)*in_stack_00000034;
  uVar3 = FUN_676ad38e(param_1,param_2,CONCAT44(param_6,param_5),param_3,param_4);
  cVar2 = (**(code **)(iVar1 + 0x14))(in_stack_00000034[1],(int)uVar3);
  return (bool)('\x01' - (cVar2 != '\0'));
}



// Function: FUN_6768e83b at 6768e83b

undefined4 * __fastcall FUN_6768e83b(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  
  *param_1 = &PTR_FUN_676b9d6c;
  puVar2 = (undefined4 *)operator_new(0x14);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    *puVar2 = &PTR_FUN_676b9d4c;
    puVar2[2] = 0;
    puVar2[3] = 0;
    puVar2[4] = 1;
  }
  param_1[3] = puVar2;
  puVar2 = (undefined4 *)operator_new(0x14);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    *puVar2 = &PTR_FUN_676b9d4c;
    puVar2[2] = 0;
    puVar2[3] = 0;
    puVar2[4] = 2;
  }
  puVar1 = (undefined4 *)param_1[3];
  param_1[4] = puVar2;
  if (puVar1 != (undefined4 *)0x0) {
    if (puVar2 != (undefined4 *)0x0) goto LAB_6768e8b9;
    if (puVar1 != (undefined4 *)0x0) {
      (**(code **)*puVar1)(1);
      param_1[3] = 0;
    }
  }
  if ((undefined4 *)param_1[4] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[4])(1);
    param_1[4] = 0;
  }
LAB_6768e8b9:
  FUN_6768ea77(param_1,0);
  FUN_6768eaa9(param_1,0);
  param_1[5] = 0;
  return param_1;
}



// Function: FUN_6768e8d2 at 6768e8d2

void __fastcall FUN_6768e8d2(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676b9d6c;
  while (param_1[1] != 0) {
    FUN_6768ea2c(param_1,(undefined4 *)0x0);
  }
  if ((undefined4 *)param_1[3] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[3])(1);
  }
  if ((undefined4 *)param_1[4] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[4])(1);
  }
  return;
}



// Function: FUN_6768e908 at 6768e908

uint __thiscall FUN_6768e908(void *this,undefined4 *param_1)

{
  undefined4 *puVar1;
  uint in_EAX;
  uint uVar2;
  undefined4 uVar3;
  
  puVar1 = *(undefined4 **)((int)this + 4);
  if (puVar1 == (undefined4 *)0x0) {
    uVar2 = in_EAX & 0xffffff00;
  }
  else {
    FUN_6768ea77(this,puVar1[3]);
    if (*(int *)((int)this + 4) == 0) {
      FUN_6768eaa9(this,0);
    }
    uVar3 = puVar1[1];
    *param_1 = uVar3;
    *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + -1;
    if (puVar1 != (undefined4 *)0x0) {
      uVar3 = (**(code **)*puVar1)(1);
    }
    uVar2 = CONCAT31((int3)((uint)uVar3 >> 8),1);
  }
  return uVar2;
}



// Function: FUN_6768e94f at 6768e94f

void __fastcall FUN_6768e94f(void *param_1)

{
  while (*(int *)((int)param_1 + 4) != 0) {
    FUN_6768ea2c(param_1,(undefined4 *)0x0);
  }
  return;
}



// Function: FUN_6768e965 at 6768e965

undefined4 * __thiscall FUN_6768e965(void *this,byte param_1)

{
  FUN_6768e8d2((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_6768e981 at 6768e981

undefined4 * __thiscall FUN_6768e981(void *this,byte param_1)

{
  *(undefined ***)this = &PTR_FUN_676b9d4c;
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_6768e99e at 6768e99e

undefined4 __thiscall FUN_6768e99e(void *this,undefined4 param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  
  if (*(int *)((int)this + 4) == 0) {
    puVar1 = (undefined4 *)operator_new(0x14);
    if (puVar1 == (undefined4 *)0x0) {
      puVar3 = (undefined4 *)0x0;
    }
    else {
      *puVar1 = &PTR_FUN_676b9d4c;
      puVar1[1] = param_1;
      puVar1[2] = 0;
      puVar1[3] = 0;
      puVar1[4] = 0;
      puVar3 = puVar1;
    }
    if (puVar3 == (undefined4 *)0x0) {
LAB_6768ea09:
      return (uint)puVar1 & 0xffffff00;
    }
    FUN_6768ea77(this,(int)puVar3);
    puVar1 = puVar3;
  }
  else {
    puVar1 = (undefined4 *)operator_new(0x14);
    if (puVar1 == (undefined4 *)0x0) {
      puVar1 = (undefined4 *)0x0;
    }
    else {
      *puVar1 = &PTR_FUN_676b9d4c;
      puVar1[1] = param_1;
      puVar1[2] = 0;
      puVar1[3] = 0;
      puVar1[4] = 0;
    }
    if (puVar1 == (undefined4 *)0x0) goto LAB_6768ea09;
    *(undefined4 **)(*(int *)((int)this + 8) + 0xc) = puVar1;
    puVar1[2] = *(undefined4 *)((int)this + 8);
  }
  uVar2 = FUN_6768eaa9(this,(int)puVar1);
  *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + 1;
  return CONCAT31((int3)((uint)uVar2 >> 8),1);
}



// Function: FUN_6768ea2c at 6768ea2c

uint __thiscall FUN_6768ea2c(void *this,undefined4 *param_1)

{
  undefined4 *puVar1;
  uint in_EAX;
  uint uVar2;
  
  puVar1 = *(undefined4 **)((int)this + 4);
  if (puVar1 == (undefined4 *)0x0) {
    uVar2 = in_EAX & 0xffffff00;
  }
  else {
    FUN_6768ea77(this,puVar1[3]);
    if (*(int *)((int)this + 4) == 0) {
      FUN_6768eaa9(this,0);
    }
    if (param_1 != (undefined4 *)0x0) {
      *param_1 = puVar1[1];
    }
    *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + -1;
    if (puVar1 != (undefined4 *)0x0) {
      param_1 = (undefined4 *)(**(code **)*puVar1)(1);
    }
    uVar2 = CONCAT31((int3)((uint)param_1 >> 8),1);
  }
  return uVar2;
}



// Function: FUN_6768ea77 at 6768ea77

void __thiscall FUN_6768ea77(void *this,int param_1)

{
  *(int *)((int)this + 4) = param_1;
  if ((param_1 != 0) && (*(int *)(param_1 + 0x10) != 0)) {
    *(undefined4 *)((int)this + 4) = 0;
  }
  if (*(int *)((int)this + 0xc) != 0) {
    *(undefined4 *)(*(int *)((int)this + 0xc) + 0xc) = *(undefined4 *)((int)this + 4);
    if (*(int *)((int)this + 4) != 0) {
      *(undefined4 *)(*(int *)((int)this + 4) + 8) = *(undefined4 *)((int)this + 0xc);
    }
  }
  return;
}



// Function: FUN_6768eaa9 at 6768eaa9

void __thiscall FUN_6768eaa9(void *this,int param_1)

{
  *(int *)((int)this + 8) = param_1;
  if ((param_1 != 0) && (*(int *)(param_1 + 0x10) != 0)) {
    *(undefined4 *)((int)this + 8) = 0;
  }
  if (*(int *)((int)this + 0x10) != 0) {
    *(undefined4 *)(*(int *)((int)this + 0x10) + 8) = *(undefined4 *)((int)this + 8);
    if (*(int *)((int)this + 8) != 0) {
      *(undefined4 *)(*(int *)((int)this + 8) + 0xc) = *(undefined4 *)((int)this + 0x10);
    }
  }
  return;
}



// Function: XceedZipInitDLL at 6768eadb

bool XceedZipInitDLL(void)

{
  HRESULT HVar1;
  
                    /* 0x1eadb  5  XceedZipInitDLL */
  HVar1 = CoInitialize((LPVOID)0x0);
  return -1 < HVar1;
}



// Function: XceedZipShutdownDLL at 6768eaed

undefined4 XceedZipShutdownDLL(void)

{
                    /* 0x1eaed  6  XceedZipShutdownDLL */
  CoUninitialize();
  return 1;
}



// Function: XzCreateXceedZipA at 6768eaf7

int * XzCreateXceedZipA(LPCSTR param_1)

{
  int iVar1;
  LPWSTR pWVar2;
  void *this;
  undefined4 local_c;
  int *local_8;
  
                    /* 0x1eaf7  8  XzCreateXceedZipA */
  local_8 = (int *)0x0;
  iVar1 = FUN_6768f069(&local_8);
  if ((-1 < iVar1) && (local_8 != (int *)0x0)) {
    (**(code **)(*local_8 + 4))(local_8);
    local_8[0x600] = (int)local_8;
    local_8[0x601] = 1;
    local_c = 0xffffffff;
    pWVar2 = FUN_67684ed6(param_1,-1);
    iVar1 = Ordinal_7(pWVar2);
    if (iVar1 == 0) {
      FUN_6768eda2(this,(HKEY__)0x0,(char *)((int)&param_1 + 3));
    }
    else {
      (**(code **)(*local_8 + 0x1b4))(local_8,pWVar2,&local_c);
    }
    Ordinal_6(pWVar2);
  }
  return local_8;
}



// Function: XzCreateXceedZipW at 6768eb7a

int * XzCreateXceedZipW(undefined4 param_1)

{
  int iVar1;
  undefined4 uVar2;
  void *this;
  undefined4 local_c;
  int *local_8;
  
                    /* 0x1eb7a  7  XzCreateXceedZipW */
  local_8 = (int *)0x0;
  iVar1 = FUN_6768f069(&local_8);
  if ((-1 < iVar1) && (local_8 != (int *)0x0)) {
    (**(code **)(*local_8 + 4))(local_8);
    local_8[0x601] = 0;
    local_8[0x600] = (int)local_8;
    local_c = 0xffffffff;
    uVar2 = Ordinal_2(param_1);
    iVar1 = Ordinal_7(uVar2);
    if (iVar1 == 0) {
      FUN_6768eda2(this,(HKEY__)0x0,(char *)((int)&param_1 + 3));
    }
    else {
      (**(code **)(*local_8 + 0x1b4))(local_8,uVar2,&local_c);
    }
    Ordinal_6(uVar2);
  }
  return local_8;
}



// Function: XzDestroyXceedZip at 6768ebf7

void XzDestroyXceedZip(int *param_1)

{
                    /* 0x1ebf7  9  XzDestroyXceedZip */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 8))(param_1);
  }
  return;
}



// Function: XcCreateXceedCompressionA at 6768ec08

int * XcCreateXceedCompressionA(LPCSTR param_1)

{
  int iVar1;
  LPWSTR pWVar2;
  void *this;
  undefined4 local_c;
  int *local_8;
  
                    /* 0x1ec08  11  XcCreateXceedCompressionA */
  local_8 = (int *)0x0;
  iVar1 = FUN_6768f0b7(&local_8);
  if ((-1 < iVar1) && (local_8 != (int *)0x0)) {
    (**(code **)(*local_8 + 4))(local_8);
    local_c = 0xffffffff;
    pWVar2 = FUN_67684ed6(param_1,-1);
    iVar1 = Ordinal_7(pWVar2);
    if (iVar1 == 0) {
      FUN_6768eda2(this,(HKEY__)0x0,(char *)((int)&param_1 + 3));
    }
    else {
      (**(code **)(*local_8 + 0x38))(local_8,pWVar2,&local_c);
    }
    Ordinal_6(pWVar2);
  }
  return local_8;
}



// Function: XcCreateXceedCompressionW at 6768ec75

int * XcCreateXceedCompressionW(undefined4 param_1)

{
  int iVar1;
  undefined4 uVar2;
  void *this;
  undefined4 local_c;
  int *local_8;
  
                    /* 0x1ec75  10  XcCreateXceedCompressionW */
  local_8 = (int *)0x0;
  iVar1 = FUN_6768f0b7(&local_8);
  if ((-1 < iVar1) && (local_8 != (int *)0x0)) {
    (**(code **)(*local_8 + 4))(local_8);
    local_c = 0xffffffff;
    uVar2 = Ordinal_2(param_1);
    iVar1 = Ordinal_7(uVar2);
    if (iVar1 == 0) {
      FUN_6768eda2(this,(HKEY__)0x0,(char *)((int)&param_1 + 3));
    }
    else {
      (**(code **)(*local_8 + 0x38))(local_8,uVar2,&local_c);
    }
    Ordinal_6(uVar2);
  }
  return local_8;
}



// Function: XcDestroyXceedCompression at 6768ecdf

void XcDestroyXceedCompression(int *param_1)

{
                    /* 0x1ecdf  12  XcDestroyXceedCompression */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 8))(param_1);
  }
  return;
}



// Function: XziDestroyXceedZipItems at 6768ecf0

void XziDestroyXceedZipItems(int *param_1)

{
                    /* 0x1ecf0  207  XziDestroyXceedZipItems */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 8))(param_1);
  }
  return;
}



// Function: XzSetXceedZipCallback at 6768ed01

void XzSetXceedZipCallback(int param_1,undefined4 param_2)

{
                    /* 0x1ed01  13  XzSetXceedZipCallback */
  if (param_1 != 0) {
    *(undefined4 *)(param_1 + 0x180c) = param_2;
  }
  return;
}



// Function: XzSetXceedZipWindow at 6768ed16

void XzSetXceedZipWindow(int param_1,undefined4 param_2)

{
                    /* 0x1ed16  14  XzSetXceedZipWindow */
  if (param_1 != 0) {
    *(undefined4 *)(param_1 + 0x1808) = param_2;
  }
  return;
}



// Function: XzAlloc at 6768ed2b

void XzAlloc(SIZE_T param_1)

{
                    /* 0x1ed2b  15  XzAlloc */
  CoTaskMemAlloc(param_1);
  return;
}



// Function: XzFree at 6768ed38

void XzFree(LPVOID param_1)

{
                    /* 0x1ed38  16  XzFree */
  CoTaskMemFree(param_1);
  return;
}



// Function: FUN_6768ed45 at 6768ed45

undefined4 * __thiscall FUN_6768ed45(void *this,byte param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int iVar3;
  void *pvVar4;
  
  if ((param_1 & 2) == 0) {
                    /* WARNING: Load size is inaccurate */
    Ordinal_6(*this);
    puVar2 = (undefined4 *)this;
    if ((param_1 & 1) != 0) {
      FUN_676b0bb3((undefined *)this);
    }
  }
  else {
    iVar3 = *(int *)((int)this + -4);
    puVar2 = (undefined4 *)((int)this + -4);
    pvVar4 = (void *)((int)this + iVar3 * 0xc);
    if (-1 < iVar3 + -1) {
      do {
        puVar1 = (undefined4 *)((int)pvVar4 + -0xc);
        pvVar4 = (void *)((int)pvVar4 + -0xc);
        Ordinal_6(*puVar1);
        iVar3 = iVar3 + -1;
      } while (iVar3 != 0);
    }
    if ((param_1 & 1) != 0) {
      FUN_676b0bb3((undefined *)puVar2);
    }
  }
  return puVar2;
}



// Function: FUN_6768eda2 at 6768eda2

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined1 __thiscall FUN_6768eda2(void *this,HKEY__ param_1,char *param_2)

{
  undefined1 uVar1;
  bool bVar2;
  LPCWSTR lpString;
  char *pcVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined4 uVar6;
  void *this_00;
  undefined1 local_7c [48];
  undefined1 local_4c [32];
  undefined **local_2c [8];
  HKEY__ local_c;
  char local_5;
  
  local_5 = '\0';
  uVar1 = FUN_676934cd(this,param_1,&local_5);
  if (param_1.unused == 0) {
    if (DAT_676c5118 != 0) {
      *param_2 = DAT_676c5118 == 1;
      return 1;
    }
    local_c.unused = 0;
    bVar2 = FUN_6768eff2(0,&local_c);
    if (((bVar2) && ((LPCWSTR)local_c.unused != (LPCWSTR)0x0)) && (iVar4 = Ordinal_7(), iVar4 != 0))
    {
      uVar1 = FUN_6768eda2(this_00,(HKEY__)&local_c,param_2);
    }
    else {
      *param_2 = local_5;
    }
  }
  else {
    lpString = (LPCWSTR)Ordinal_2();
    *param_2 = '\0';
    local_c.unused = (int)lpString;
    FUN_676abe64(local_7c);
    if (lpString == (LPCWSTR)0x0) {
      pcVar3 = (char *)0x0;
    }
    else {
      iVar4 = lstrlenW(lpString);
      FUN_676b06a0();
      pcVar3 = FUN_6768efcb(&stack0xffffff78,lpString,iVar4 * 2 + 2,0);
    }
    iVar4 = FUN_676abe87(local_7c,pcVar3,&DAT_676c5160,&DAT_676c5164,&DAT_676c5168,&DAT_676c0e6c,
                         &DAT_676c516c,&DAT_676c5170,(undefined8 *)&DAT_676c0e70,
                         (undefined2 *)&DAT_676c5174);
    if (((-1 < iVar4) && (DAT_676c5160 == 2)) &&
       ((DAT_676c5164 == '\x05' && (DAT_676c5168 == '\x01')))) {
      if ((DAT_676c0e6c < 0) || (9 < DAT_676c0e6c)) {
        EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
        DAT_676c5118 = 2;
        LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
        *param_2 = '\0';
      }
      else {
        local_2c[0] = &PTR_LAB_676b9950;
        FUN_6767d089((int)local_2c);
        puVar5 = FUN_6768ef7c(local_4c,_DAT_676c0e70);
        uVar6 = FUN_6767cfc1(local_2c,(int)puVar5);
        if ((char)uVar6 != '\0') {
          EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
          DAT_676c5118 = 1;
          LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
          *param_2 = '\x01';
        }
      }
    }
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
    if (DAT_676c5118 == 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      *param_2 = local_5;
    }
    else {
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      uVar1 = 1;
    }
    FUN_676abe86();
  }
  Ordinal_6();
  return uVar1;
}



// Function: FUN_6768ef7c at 6768ef7c

undefined4 * __thiscall FUN_6768ef7c(void *this,undefined8 param_1)

{
  LPSYSTEMTIME lpSystemTime;
  int iVar1;
  
  *(undefined8 *)((int)this + 0x18) = param_1;
  lpSystemTime = (LPSYSTEMTIME)((int)this + 8);
  *(undefined ***)this = &PTR_LAB_676b9950;
  iVar1 = Ordinal_185(param_1,lpSystemTime);
  if (iVar1 == 0) {
    GetLocalTime(lpSystemTime);
    iVar1 = Ordinal_184(lpSystemTime,(undefined8 *)((int)this + 0x18));
    if (iVar1 == 0) {
      *(undefined8 *)((int)this + 0x18) = 0x4000000000000000;
    }
  }
  return (undefined4 *)this;
}



// Function: FUN_6768efcb at 6768efcb

LPSTR FUN_6768efcb(LPSTR param_1,LPCWSTR param_2,int param_3,UINT param_4)

{
  *param_1 = '\0';
  WideCharToMultiByte(param_4,0,param_2,-1,param_1,param_3,(LPCSTR)0x0,(LPBOOL)0x0);
  return param_1;
}



// Function: FUN_6768eff2 at 6768eff2

bool __cdecl FUN_6768eff2(undefined4 param_1,HKEY param_2)

{
  bool bVar1;
  int iVar2;
  LPWSTR pWVar3;
  CHAR local_13c [264];
  undefined1 local_34 [48];
  
  if (param_2 == (HKEY)0x0) {
    bVar1 = false;
  }
  else {
    param_2->unused = 0;
    FUN_676abe64(local_34);
    iVar2 = FUN_676abf6f((HKEY)0x2,5,1,local_13c,0x104,'\0','\x01');
    if (iVar2 < 0) {
      bVar1 = FUN_676936ce(param_1,param_2);
    }
    else {
      pWVar3 = FUN_67684ed6(local_13c,-1);
      param_2->unused = (int)pWVar3;
      bVar1 = pWVar3 != (LPWSTR)0x0;
    }
    FUN_676abe86();
  }
  return bVar1;
}



// Function: FUN_6768f069 at 6768f069

undefined4 FUN_6768f069(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  
  uVar2 = 0x8007000e;
  puVar1 = (undefined4 *)operator_new(0x1818);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    puVar1 = FUN_6768f105(puVar1);
  }
  if (puVar1 != (undefined4 *)0x0) {
    InterlockedIncrement(puVar1 + 0x5b0);
    uVar2 = 0;
    InterlockedDecrement(puVar1 + 0x5b0);
  }
  *param_1 = puVar1;
  return uVar2;
}



// Function: FUN_6768f0b7 at 6768f0b7

undefined4 FUN_6768f0b7(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  
  uVar2 = 0x8007000e;
  puVar1 = (undefined4 *)operator_new(0x1e8);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    puVar1 = FUN_67692429(puVar1);
  }
  if (puVar1 != (undefined4 *)0x0) {
    InterlockedIncrement(puVar1 + 0x26);
    uVar2 = 0;
    InterlockedDecrement(puVar1 + 0x26);
  }
  *param_1 = puVar1;
  return uVar2;
}



// Function: FUN_6768f105 at 6768f105

undefined4 * __fastcall FUN_6768f105(undefined4 *param_1)

{
  FUN_6768f1d7((int)param_1);
  *param_1 = &PTR_LAB_676ba074;
  param_1[1] = &PTR_FUN_676ba064;
  param_1[0x13] = &PTR_FUN_676ba058;
  param_1[0x1b] = &PTR_LAB_676ba034;
  param_1[0x1c] = &PTR_LAB_676ba018;
  param_1[0x1d] = &PTR_LAB_676b9fb8;
  param_1[0x1e] = &PTR_LAB_676b9f90;
  param_1[0x1f] = &PTR_LAB_676b9f54;
  param_1[0x20] = &PTR_LAB_676b9f28;
  param_1[0x21] = &PTR_LAB_676b9f14;
  param_1[0x22] = &PTR_LAB_676b9eec;
  param_1[0x23] = &PTR_LAB_676b9edc;
  param_1[0x24] = &PTR_LAB_676b9ec4;
  param_1[0x25] = &PTR_LAB_676b9e94;
  param_1[0x26] = &PTR_LAB_676b9e80;
  param_1[0x27] = &PTR_LAB_676b9e60;
  param_1[0x2a] = &PTR_LAB_676b9e40;
  param_1[0x36] = &PTR_LAB_676b9e24;
  param_1[0x37] = &PTR_LAB_676b9e10;
  param_1[0x38] = &PTR_FUN_676b9d9c;
  param_1[0x39] = &PTR_LAB_676b9d90;
  InterlockedIncrement(&DAT_676c559c);
  return param_1;
}



// Function: FUN_6768f1d7 at 6768f1d7

int __fastcall FUN_6768f1d7(int param_1)

{
  int local_14;
  undefined4 local_10;
  int local_c [2];
  
  *(undefined4 *)(param_1 + 0x16c0) = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x16c4));
  FUN_676921bb((void *)(param_1 + 4),param_1 + 0x50);
  FUN_67690a14(param_1 + 0x4c);
  *(undefined4 *)(param_1 + 0xa4) = 0;
  *(undefined4 *)(param_1 + 0xa0) = 0;
  FUN_67690585((undefined4 *)(param_1 + 0xac));
  *(undefined ***)(param_1 + 0xa8) = &PTR_LAB_676ba2a0;
  FUN_6767cafc((undefined4 *)(param_1 + 0xe0));
  *(undefined4 *)(param_1 + 0x1718) = &PTR_LAB_676b9950;
  FUN_6767d089(param_1 + 0x1718);
  *(undefined4 *)(param_1 + 0x1738) = &PTR_LAB_676b9950;
  FUN_6767d089(param_1 + 0x1738);
  *(undefined4 *)(param_1 + 0x1758) = &PTR_LAB_676b9950;
  FUN_6767d089(param_1 + 0x1758);
  *(undefined4 *)(param_1 + 0x1778) = &PTR_LAB_676b9950;
  FUN_6767d089(param_1 + 0x1778);
  *(undefined4 *)(param_1 + 0x1798) = &PTR_LAB_676b9950;
  FUN_6767d089(param_1 + 0x1798);
  *(undefined4 *)(param_1 + 0x17b8) = &PTR_LAB_676b9950;
  FUN_6767d089(param_1 + 0x17b8);
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  *(undefined4 *)(param_1 + 0x17f8) = 0;
  *(undefined4 *)(param_1 + 0x17f4) = 0;
  local_c[0] = 0x20;
  local_c[1] = 0x20;
  FUN_67691fdf(local_c,&local_14);
  *(byte *)(param_1 + 0x49) = *(byte *)(param_1 + 0x49) | 2;
  *(int *)(param_1 + 0x20) = local_14;
  *(int *)(param_1 + 0x28) = local_14;
  *(undefined4 *)(param_1 + 0x24) = local_10;
  *(undefined4 *)(param_1 + 0x2c) = local_10;
  *(undefined4 *)(param_1 + 0x16dc) = 0;
  *(undefined1 *)(param_1 + 0x16e0) = 0;
  *(undefined4 *)(param_1 + 0x17f0) = 0;
  *(undefined4 *)(param_1 + 0x1800) = 0;
  *(undefined4 *)(param_1 + 0x1804) = 0;
  *(undefined4 *)(param_1 + 0x1808) = 0;
  *(undefined4 *)(param_1 + 0x180c) = 0;
  *(undefined4 *)(param_1 + 0x17fc) = 0;
  *(undefined4 *)(param_1 + 0x1810) = 0x7fffffff;
  *(undefined1 *)(param_1 + 0x1814) = 0;
  *(undefined1 *)(param_1 + 0x1815) = 0;
  return param_1;
}



// Function: FUN_6768f31a at 6768f31a

undefined4 __thiscall
FUN_6768f31a(void *this,HWND param_1,uint param_2,HDC param_3,LPARAM param_4,LRESULT *param_5,
            int param_6)

{
  int iVar1;
  undefined4 uVar2;
  LRESULT LVar3;
  
  if (param_6 != 0) goto LAB_6768f36c;
  iVar1 = FUN_6768f5ea(this,param_1,param_2,param_3,param_4,param_5,0);
  if (iVar1 == 0) {
    if (param_2 < 0x2112) {
      if ((param_2 == 0x2111) ||
         ((0x202a < param_2 && (((param_2 < 0x2030 || (param_2 == 0x2039)) || (param_2 == 0x204e))))
         )) {
LAB_6768f39c:
        LVar3 = DefWindowProcA(param_1,param_2 - 0x2000,(WPARAM)param_3,param_4);
        *param_5 = LVar3;
        goto LAB_6768f3b4;
      }
    }
    else if ((0x2113 < param_2) &&
            ((param_2 < 0x2116 ||
             ((0x2131 < param_2 && ((param_2 < 0x2139 || (param_2 == 0x2210))))))))
    goto LAB_6768f39c;
LAB_6768f36c:
    uVar2 = 0;
  }
  else {
LAB_6768f3b4:
    uVar2 = 1;
  }
  return uVar2;
}



// Function: FUN_6768f455 at 6768f455

void FUN_6768f455(undefined4 param_1,undefined4 param_2,undefined4 *param_3,int param_4,int *param_5
                 ,int param_6)

{
  FUN_67690c6e(&PTR_DAT_676c0e78,param_2,param_3,param_4,param_5,param_6);
  return;
}



// Function: FUN_6768f475 at 6768f475

void FUN_6768f475(undefined4 param_1,undefined4 param_2,undefined4 param_3,int *param_4,
                 undefined4 param_5,undefined4 param_6,undefined4 param_7,undefined4 param_8,
                 undefined4 param_9)

{
  if ((DAT_676c0e84 == (int *)0x0) &&
     (FUN_67691000(&PTR_DAT_676c0e78,param_4), DAT_676c0e84 == (int *)0x0)) {
    return;
  }
  (**(code **)(*DAT_676c0e84 + 0x2c))
            (DAT_676c0e84,param_1,param_2,param_5,param_6,param_7,param_8,param_9);
  return;
}



// Function: FUN_6768f4db at 6768f4db

int FUN_6768f4db(int param_1,int *param_2,int *param_3,undefined4 *param_4)

{
  code *pcVar1;
  int iVar2;
  int *piVar3;
  
  if (param_4 == (undefined4 *)0x0) {
    iVar2 = -0x7fffbffd;
  }
  else {
    *param_4 = 0;
    if ((((*param_3 == 0) && (param_3[1] == 0)) && (param_3[2] == 0xc0)) &&
       (param_3[3] == 0x46000000)) {
      iVar2 = param_2[1];
LAB_6768f58a:
      piVar3 = (int *)(iVar2 + param_1);
      (**(code **)(*piVar3 + 4))(piVar3);
      *param_4 = piVar3;
      iVar2 = 0;
    }
    else {
      pcVar1 = (code *)param_2[2];
      while (pcVar1 != (code *)0x0) {
        piVar3 = (int *)*param_2;
        if ((piVar3 == (int *)0x0) ||
           (((*piVar3 == *param_3 && (piVar3[1] == param_3[1])) &&
            ((piVar3[2] == param_3[2] && (piVar3[3] == param_3[3])))))) {
          if (pcVar1 == (code *)0x1) {
            iVar2 = param_2[1];
            goto LAB_6768f58a;
          }
          iVar2 = (*pcVar1)(param_1,param_3,param_4,param_2[1]);
          if (iVar2 == 0) {
            return 0;
          }
          if ((piVar3 != (int *)0x0) && (iVar2 < 0)) {
            return iVar2;
          }
        }
        piVar3 = param_2 + 5;
        param_2 = param_2 + 3;
        pcVar1 = (code *)*piVar3;
      }
      iVar2 = -0x7fffbffe;
    }
  }
  return iVar2;
}



// Function: FUN_6768f599 at 6768f599

void __thiscall FUN_6768f599(void *this,HWND param_1,int *param_2)

{
  ushort uVar1;
  uint uVar2;
  
  uVar2 = -(uint)(this != (void *)0x0) & (int)this - 4U;
  if (DAT_676c1028 == 0) {
    DAT_676c1028 = 0;
  }
  uVar1 = FUN_67691de0(0x676c5588,(WNDCLASSEXA *)&DAT_676c0ff8,(UINT *)(uVar2 + 0x68));
  FUN_676916b1((void *)(uVar2 + 0x4c),param_1,param_2,(LPCSTR)0x0,0x56000000,0,(HMENU)0x0,uVar1,
               (LPVOID)0x0);
  return;
}



// Function: FUN_6768f5ea at 6768f5ea

undefined4 __thiscall
FUN_6768f5ea(void *this,undefined4 param_1,int param_2,HDC param_3,undefined4 param_4,
            undefined4 *param_5,int param_6)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_6 == 0) {
    if (param_2 == 0xf) {
      uVar1 = FUN_676948ac((void *)((int)this + -0x48),0xf,param_3);
    }
    else if (param_2 == 7) {
      uVar1 = FUN_67692264((void *)((int)this + -0x48));
    }
    else if (param_2 == 8) {
      uVar1 = FUN_67692324((void *)((int)this + -0x48));
    }
    else {
      if (param_2 != 0x21) goto LAB_6768f68d;
      uVar1 = FUN_676923ba((void *)((int)this + -0x48));
    }
    uVar2 = 1;
    *param_5 = uVar1;
  }
  else {
LAB_6768f68d:
    uVar2 = 0;
  }
  return uVar2;
}



// Function: FUN_6768f80b at 6768f80b

undefined4 FUN_6768f80b(undefined4 param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    *param_2 = 0xdb797690;
    param_2[1] = 0x11d240e0;
    param_2[2] = 0x6000d59b;
    param_2[3] = 0x72e32a08;
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6768f842 at 6768f842

void FUN_6768f842(int param_1,int param_2,undefined4 *param_3)

{
  FUN_67693d77((void *)((-(uint)(param_1 != 0) & param_1 - 0x74U) + 4),param_2,param_3);
  return;
}



// Function: FUN_6768f96b at 6768f96b

bool FUN_6768f96b(int param_1,undefined4 param_2)

{
  SHORT SVar1;
  int iVar2;
  char cVar3;
  int *local_8;
  
  local_8 = (int *)0x0;
  iVar2 = FUN_676936a7((void *)((-(uint)(param_1 != 0) & param_1 - 0x78U) + 4),&DAT_676bb570,
                       &local_8);
  if (-1 < iVar2) {
    if (local_8 == (int *)0x0) {
      iVar2 = 1;
    }
    else {
      SVar1 = GetKeyState(0x10);
      cVar3 = SVar1 < 0;
      SVar1 = GetKeyState(0x11);
      if (SVar1 < 0) {
        cVar3 = cVar3 + '\x02';
      }
      SVar1 = GetKeyState(0x12);
      if (SVar1 < 0) {
        cVar3 = cVar3 + '\x04';
      }
      iVar2 = (**(code **)(*local_8 + 0x1c))(local_8,param_2,cVar3);
    }
  }
  if (local_8 != (int *)0x0) {
    (**(code **)(*local_8 + 8))(local_8);
  }
  return iVar2 != 0;
}



// Function: FUN_6768fa27 at 6768fa27

void FUN_6768fa27(int param_1,int param_2,undefined4 param_3,uint *param_4,int param_5,
                 undefined4 param_6,undefined4 param_7,int *param_8,undefined4 param_9)

{
  FUN_67693f7a((void *)((-(uint)(param_1 != 0) & param_1 - 0x7cU) + 4),param_2,param_3,param_4,
               param_5,param_6,param_7,param_8,param_9);
  return;
}



// Function: FUN_6768fa93 at 6768fa93

int * FUN_6768fa93(int *param_1,int *param_2)

{
  int *piVar1;
  
  if (param_2 != (int *)0x0) {
    (**(code **)(*param_2 + 4))(param_2);
  }
  piVar1 = (int *)*param_1;
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  *param_1 = (int)param_2;
  return param_2;
}



// Function: FUN_6768fb22 at 6768fb22

undefined4
FUN_6768fb22(undefined4 param_1,int param_2,RECT *param_3,LONG param_4,LONG param_5,
            undefined4 param_6,uint *param_7)

{
  POINT pt;
  BOOL BVar1;
  undefined4 uVar2;
  
  if (param_2 == 1) {
    pt.y = param_5;
    pt.x = param_4;
    BVar1 = PtInRect(param_3,pt);
    *param_7 = -(uint)(BVar1 != 0) & 3;
    uVar2 = 0;
  }
  else {
    uVar2 = 0x80004005;
  }
  return uVar2;
}



// Function: FUN_6768fb53 at 6768fb53

undefined4
FUN_6768fb53(undefined4 param_1,int param_2,RECT *param_3,RECT *param_4,undefined4 param_5,
            uint *param_6)

{
  BOOL BVar1;
  undefined4 uVar2;
  tagRECT local_14;
  
  if (param_2 == 1) {
    BVar1 = UnionRect(&local_14,param_3,param_4);
    *param_6 = -(uint)(BVar1 != 0) & 3;
    uVar2 = 0;
  }
  else {
    uVar2 = 0x80004005;
  }
  return uVar2;
}



// Function: FUN_6768fc6b at 6768fc6b

bool FUN_6768fc6b(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                 undefined4 param_5)

{
  uint uVar1;
  int iVar2;
  
  uVar1 = -(uint)(param_1 != 0) & param_1 - 0x80U;
  iVar2 = (*(code *)**(undefined4 **)(uVar1 + 0x4c))
                    (*(undefined4 *)(uVar1 + 0x50),param_2,param_3,param_4,param_5,0);
  return (bool)('\x01' - (iVar2 != 0));
}



// Function: FUN_6768fca4 at 6768fca4

int FUN_6768fca4(int *param_1,undefined4 *param_2)

{
  int iVar1;
  undefined4 *this;
  int *piVar2;
  int *piVar3;
  int local_8;
  
  if (param_2 == (undefined4 *)0x0) {
    iVar1 = -0x7fffbffd;
  }
  else {
    *param_2 = 0;
    this = (undefined4 *)operator_new(0x34);
    if (this == (undefined4 *)0x0) {
      this = (undefined4 *)0x0;
    }
    else {
      FUN_676914a8((int)this);
      *this = &PTR_FUN_676ba41c;
      InterlockedIncrement(&DAT_676c559c);
    }
    piVar3 = (int *)&stack0xffffffec;
    if (this == (undefined4 *)0x0) {
      iVar1 = -0x7ff8fff2;
    }
    else {
      piVar2 = (int *)FUN_6768fd71(&local_8);
      FUN_676b06a0();
      iVar1 = *piVar2;
      while (iVar1 != -1) {
        piVar2 = piVar2 + 1;
        *piVar3 = iVar1 + (int)param_1;
        piVar3 = piVar3 + 1;
        iVar1 = *piVar2;
      }
      iVar1 = FUN_67692133(this,(int *)&stack0xffffffec,(int *)(&stack0xffffffec + local_8 * 4),
                           param_1,3);
      if ((iVar1 < 0) || (iVar1 = (**(code **)*this)(this,&DAT_676bb5a0,param_2), iVar1 < 0)) {
        FUN_67690a28(this,1);
      }
    }
  }
  return iVar1;
}



// Function: FUN_6768fd71 at 6768fd71

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined * __cdecl FUN_6768fd71(undefined4 *param_1)

{
  if ((DAT_676c5a11 & 1) == 0) {
    DAT_676c5a11 = DAT_676c5a11 | 1;
    _DAT_676c5180 = 0xffffffff;
    _DAT_676c5178 = 0x18;
    _DAT_676c517c = 0x24;
  }
  if (param_1 != (undefined4 *)0x0) {
    *param_1 = 2;
  }
  return &DAT_676c5178;
}



// Function: FUN_6768fdb0 at 6768fdb0

int * FUN_6768fdb0(int param_1,int *param_2,int *param_3)

{
  int *piVar1;
  int *piVar2;
  int *piVar3;
  int iVar4;
  int local_14;
  int local_10;
  int local_c;
  int local_8;
  
  piVar2 = param_3;
  if (param_3 == (int *)0x0) {
    param_3 = (int *)0x80004003;
  }
  else {
    *param_3 = 0;
    param_3 = (int *)0x80040200;
    for (piVar3 = (int *)FUN_6768fd71((undefined4 *)0x0); *piVar3 != -1; piVar3 = piVar3 + 1) {
      piVar1 = (int *)(*piVar3 + param_1);
      iVar4 = (**(code **)(*piVar1 + 0xc))(piVar1,&local_14);
      if ((((-1 < iVar4) && (*param_2 == local_14)) && (param_2[1] == local_10)) &&
         ((param_2[2] == local_c && (param_2[3] == local_8)))) {
        *piVar2 = (int)piVar1;
        (**(code **)(*piVar1 + 4))(piVar1);
        return (int *)0x0;
      }
    }
  }
  return param_3;
}



// Function: FUN_6768feab at 6768feab

int FUN_6768feab(int *param_1,int *param_2)

{
  int *piVar1;
  int iVar2;
  
  piVar1 = (int *)FUN_67691759((int)param_1);
  iVar2 = -0x7fffbffb;
  if (piVar1 != (int *)0x0) {
    param_1 = (int *)0x0;
    iVar2 = (**(code **)(*param_2 + 0x10))(param_2,u_Contents_676c1978,0,0x10,0,&param_1);
    if (-1 < iVar2) {
      iVar2 = (**(code **)(*piVar1 + 0x14))(piVar1,param_1);
    }
    if (param_1 != (int *)0x0) {
      (**(code **)(*param_1 + 8))(param_1);
    }
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  return iVar2;
}



// Function: FUN_6768ff0b at 6768ff0b

int FUN_6768ff0b(int *param_1,int *param_2,undefined4 param_3)

{
  int *piVar1;
  int iVar2;
  
  piVar1 = (int *)FUN_67691759((int)param_1);
  iVar2 = -0x7fffbffb;
  if (piVar1 != (int *)0x0) {
    param_1 = (int *)0x0;
    iVar2 = (**(code **)(*param_2 + 0xc))(param_2,PTR_u_Contents_676c198c,0x1012,0,0,&param_1);
    if (-1 < iVar2) {
      iVar2 = (**(code **)(*piVar1 + 0x18))(piVar1,param_1,param_3);
    }
    if (param_1 != (int *)0x0) {
      (**(code **)(*param_1 + 8))(param_1);
    }
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  return iVar2;
}



// Function: FUN_6768ff72 at 6768ff72

HRESULT FUN_6768ff72(LPSTREAM param_1,undefined4 param_2,int *param_3,int param_4,
                    undefined4 *param_5)

{
  int *piVar1;
  LPSTREAM This;
  LPSTREAM This_00;
  HRESULT HVar2;
  int *piVar3;
  int iVar4;
  int *piVar5;
  undefined2 local_1c [8];
  undefined4 local_c;
  int local_8;
  
  This = param_1;
  local_c = 0x300;
  HVar2 = (*param_1->lpVtbl->Write)(param_1,&local_c,4,(ULONG *)0x0);
  if (-1 < HVar2) {
    param_1 = (LPSTREAM)0x0;
    local_8 = 0;
    if (param_3[2] != 0) {
      piVar3 = param_3;
      piVar5 = param_3 + 3;
      do {
        This_00 = param_1;
        if (*piVar3 != 0) {
          if (piVar5[2] == 0) {
            local_1c[0] = 0;
            if (*piVar5 == local_8) {
LAB_67690011:
              iVar4 = FUN_67690205((int *)param_1,piVar5[-2],local_1c);
              if (iVar4 < 0) goto LAB_67690052;
              HVar2 = FUN_67690077(local_1c,This);
              if (-1 < HVar2) {
                Ordinal_9(local_1c);
                goto LAB_67690040;
              }
            }
            else {
              if (param_1 != (LPSTREAM)0x0) {
                param_1 = (LPSTREAM)0x0;
                (*This_00->lpVtbl->Release)(This_00);
              }
              iVar4 = (**(code **)*param_5)(param_5,*piVar5,&param_1);
              if (-1 < iVar4) {
                local_8 = *piVar5;
                goto LAB_67690011;
              }
LAB_67690052:
              HVar2 = -0x7fffbffb;
            }
            Ordinal_9(local_1c);
            break;
          }
          HVar2 = (*This->lpVtbl->Write)(This,(void *)(piVar5[1] + param_4),piVar5[2],(ULONG *)0x0);
          if (HVar2 < 0) break;
        }
LAB_67690040:
        piVar1 = piVar5 + 6;
        piVar3 = piVar5 + 4;
        piVar5 = piVar5 + 7;
      } while (*piVar1 != 0);
      if (param_1 != (LPSTREAM)0x0) {
        (*param_1->lpVtbl->Release)(param_1);
      }
    }
  }
  return HVar2;
}



// Function: FUN_67690077 at 67690077

int __thiscall FUN_67690077(void *this,LPSTREAM param_1)

{
  undefined4 *puVar1;
  LPSTREAM pStm;
  HRESULT HVar2;
  int iVar3;
  ULONG cb;
  undefined2 local_18 [4];
  undefined4 local_10;
  undefined4 local_8;
  
  pStm = param_1;
  HVar2 = (*param_1->lpVtbl->Write)(param_1,this,2,(ULONG *)0x0);
  if (HVar2 < 0) {
    return HVar2;
  }
                    /* WARNING: Load size is inaccurate */
  switch(*this) {
  case 2:
  case 0xb:
  case 0x12:
    cb = 2;
    break;
  case 3:
  case 4:
  case 10:
  case 0x13:
  case 0x16:
  case 0x17:
    cb = 4;
    break;
  case 5:
  case 6:
  case 7:
    cb = 8;
    break;
  default:
    local_8 = 0;
    local_18[0] = 0;
    if (*this == 8) {
      local_10 = *(undefined4 *)((int)this + 8);
    }
    else {
      iVar3 = Ordinal_12(local_18,this,1,8);
      if (iVar3 < 0) goto LAB_67690166;
    }
    Ordinal_6(local_8);
    local_8 = Ordinal_2(local_10);
    iVar3 = FUN_676901ae(&local_8,(int *)pStm);
LAB_67690166:
    Ordinal_9(local_18);
    Ordinal_6(local_8);
    return iVar3;
  case 9:
  case 0xd:
    puVar1 = *(undefined4 **)((int)this + 8);
    param_1 = (LPSTREAM)0x0;
    if (puVar1 != (undefined4 *)0x0) {
      iVar3 = (**(code **)*puVar1)(puVar1,&DAT_676bb5f0,&param_1);
      if (iVar3 < 0) goto LAB_676900f2;
      if (param_1 != (LPSTREAM)0x0) {
        iVar3 = OleSaveToStream((LPPERSISTSTREAM)param_1,pStm);
        goto LAB_676900f2;
      }
    }
    iVar3 = WriteClassStm(pStm,(IID *)&DAT_676bb4f0);
LAB_676900f2:
    if (param_1 == (LPSTREAM)0x0) {
      return iVar3;
    }
    (*param_1->lpVtbl->Release)(param_1);
    return iVar3;
  case 0x10:
  case 0x11:
    cb = 1;
  }
  HVar2 = (*pStm->lpVtbl->Write)(pStm,(void *)((int)this + 8),cb,(ULONG *)0x0);
  return HVar2;
}



// Function: FUN_676901ae at 676901ae

int __thiscall FUN_676901ae(void *this,int *param_1)

{
  int iVar1;
  void *local_c;
  void *local_8;
  
                    /* WARNING: Load size is inaccurate */
  local_c = this;
  if (*this == 0) {
    local_8 = (void *)0x0;
  }
  else {
    local_8 = this;
    iVar1 = Ordinal_149(*this);
    local_8 = (void *)(iVar1 + 2);
  }
  iVar1 = (**(code **)(*param_1 + 0x10))(param_1,&local_8,4,&local_c);
  if (-1 < iVar1) {
    if (local_8 == (void *)0x0) {
      iVar1 = 0;
    }
    else {
                    /* WARNING: Load size is inaccurate */
      iVar1 = (**(code **)(*param_1 + 0x10))(param_1,*this,local_8,&local_c);
    }
  }
  return iVar1;
}



// Function: FUN_67690205 at 67690205

void __cdecl FUN_67690205(int *param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  local_14 = 0;
  local_10 = 0;
  local_c = 0;
  local_8 = 0;
  (**(code **)(*param_1 + 0x18))(param_1,param_2,&DAT_676bb4f0,0x400,2,&local_14,param_3,0,0);
  return;
}



// Function: FUN_67690329 at 67690329

void FUN_67690329(IDataObject *param_1,FORMATETC *param_2,DWORD param_3,IAdviseSink *param_4,
                 DWORD *param_5)

{
  LPDATAADVISEHOLDER *ppDAHolder;
  IDataAdviseHolder *This;
  uint uVar1;
  HRESULT HVar2;
  
  uVar1 = -(uint)(param_1 != (IDataObject *)0x0) & (uint)(param_1 + -0x25);
  ppDAHolder = (LPDATAADVISEHOLDER *)(uVar1 + 0xc);
  if ((*(int *)(uVar1 + 0xc) == 0) && (HVar2 = CreateDataAdviseHolder(ppDAHolder), HVar2 != 0)) {
    return;
  }
  This = *ppDAHolder;
  (*This->lpVtbl->Advise)(This,param_1,param_2,param_3,param_4,param_5);
  return;
}



// Function: FUN_67690490 at 67690490

undefined4 FUN_67690490(undefined4 param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    *param_2 = 0x9bfbbc02;
    param_2[1] = 0x101aeff1;
    param_2[2] = 0xaa00ed84;
    param_2[3] = 0x71d3400;
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_67690543 at 67690543

undefined4 FUN_67690543(undefined4 param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    *param_2 = 0xdb797691;
    param_2[1] = 0x11d240e0;
    param_2[2] = 0x6000d59b;
    param_2[3] = 0x72e32a08;
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_67690585 at 67690585

undefined4 * __fastcall FUN_67690585(undefined4 *param_1)

{
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 1));
  *param_1 = &PTR_FUN_676ba438;
  param_1[7] = 0;
  param_1[8] = 0;
  param_1[9] = 0;
  param_1[10] = 0;
  return param_1;
}



// Function: FUN_676905c0 at 676905c0

void FUN_676905c0(int param_1,int *param_2,undefined4 param_3)

{
  int iVar1;
  uint uVar2;
  
  uVar2 = -(uint)(param_1 != 0) & param_1 - 0xd8U;
  uVar2 = -(uint)(uVar2 != 0xffffff28) & uVar2;
  iVar1 = FUN_6769060a(param_2,param_3,(ushort *)&PTR_u_BasePath_676c1550,uVar2,(undefined4 *)uVar2)
  ;
  if (-1 < iVar1) {
    *(byte *)(uVar2 + 0x48) = *(byte *)(uVar2 + 0x48) & 0x7f;
  }
  return;
}



// Function: FUN_6769060a at 6769060a

undefined4
FUN_6769060a(int *param_1,undefined4 param_2,ushort *param_3,int param_4,undefined4 *param_5)

{
  ushort *puVar1;
  ushort uVar2;
  int *piVar3;
  int iVar4;
  ushort *puVar5;
  undefined4 *puVar6;
  ushort local_1c [4];
  undefined4 local_14;
  int local_c;
  int *local_8;
  
  local_8 = (int *)0x0;
  local_c = 0;
  if (*(int *)(param_3 + 4) != 0) {
    puVar5 = param_3 + 0xc;
    do {
      piVar3 = local_8;
      if (*(int *)param_3 != 0) {
        local_1c[0] = *puVar5;
        if (*(int *)(puVar5 + -2) == 0) {
          if (*(int *)(puVar5 + -6) != local_c) {
            if (local_8 != (int *)0x0) {
              local_8 = (int *)0x0;
              (**(code **)(*piVar3 + 8))(piVar3);
            }
            iVar4 = (**(code **)*param_5)(param_5,*(undefined4 *)(puVar5 + -6),&local_8);
            if (iVar4 < 0) goto LAB_67690748;
            local_c = *(int *)(puVar5 + -6);
          }
          iVar4 = FUN_67690205(local_8,*(undefined4 *)(puVar5 + -10),local_1c);
          if ((iVar4 < 0) ||
             ((iVar4 = (**(code **)(*param_1 + 0xc))
                                 (param_1,*(undefined4 *)(puVar5 + -0xc),local_1c,param_2),
              -1 < iVar4 &&
              (iVar4 = FUN_67690762(local_8,*(undefined4 *)(puVar5 + -10),local_1c), iVar4 < 0)))) {
LAB_67690748:
            Ordinal_9(local_1c);
            if (local_8 != (int *)0x0) {
              (**(code **)(*local_8 + 8))(local_8);
            }
            return 0x80004005;
          }
          Ordinal_9(local_1c);
        }
        else {
          puVar6 = (undefined4 *)(param_4 + *(int *)(puVar5 + -4));
          iVar4 = (**(code **)(*param_1 + 0xc))
                            (param_1,*(undefined4 *)(puVar5 + -0xc),local_1c,param_2);
          if (-1 < iVar4) {
            uVar2 = *puVar5;
            if (uVar2 == 0xb) {
LAB_67690695:
              *(undefined2 *)puVar6 = (undefined2)local_14;
            }
            else if (0xf < uVar2) {
              if (uVar2 < 0x12) {
                *(undefined1 *)puVar6 = (undefined1)local_14;
              }
              else {
                if (uVar2 == 0x12) goto LAB_67690695;
                if ((uVar2 == 0x13) || ((0x15 < uVar2 && (uVar2 < 0x18)))) {
                  *puVar6 = local_14;
                }
              }
            }
          }
          Ordinal_9(local_1c);
        }
      }
      puVar1 = puVar5 + 6;
      param_3 = puVar5 + 2;
      puVar5 = puVar5 + 0xe;
    } while (*(int *)puVar1 != 0);
    if (local_8 != (int *)0x0) {
      (**(code **)(*local_8 + 8))(local_8);
    }
  }
  return 0;
}



// Function: FUN_67690762 at 67690762

void __cdecl FUN_67690762(int *param_1,undefined4 param_2,ushort *param_3)

{
  ushort uVar1;
  ushort *puVar2;
  int iVar3;
  ushort *local_14;
  ushort **local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  puVar2 = param_3;
  local_c = 1;
  local_8 = 1;
  local_10 = &param_3;
  local_14 = param_3;
  param_3 = (ushort *)0xfffffffd;
  uVar1 = *puVar2;
  if ((((uVar1 == 0xd) || (uVar1 == 9)) || ((uVar1 & 0x6000) != 0)) &&
     (iVar3 = (**(code **)(*param_1 + 0x18))(param_1,param_2,&DAT_676bb4f0,0x400,8,&local_14,0,0,0),
     -1 < iVar3)) {
    return;
  }
  (**(code **)(*param_1 + 0x18))(param_1,param_2,&DAT_676bb4f0,0x400,4,&local_14,0,0,0);
  return;
}



// Function: FUN_67690821 at 67690821

int FUN_67690821(int *param_1,undefined4 param_2,undefined4 param_3,ushort *param_4,int param_5,
                undefined4 *param_6)

{
  ushort *puVar1;
  ushort uVar2;
  int iVar3;
  int *piVar4;
  ushort *puVar5;
  ushort local_1c [4];
  int local_14;
  int local_c;
  int *local_8;
  
  if (param_1 == (int *)0x0) {
    iVar3 = -0x7fffbffd;
  }
  else {
    local_8 = (int *)0x0;
    local_c = 0;
    if (*(int *)(param_4 + 4) != 0) {
      puVar5 = param_4 + 0xc;
      do {
        piVar4 = local_8;
        if (*(int *)param_4 != 0) {
          local_1c[0] = 0;
          if (*(int *)(puVar5 + -2) == 0) {
            if (*(int *)(puVar5 + -6) != local_c) {
              if (local_8 != (int *)0x0) {
                local_8 = (int *)0x0;
                (**(code **)(*piVar4 + 8))(piVar4);
              }
              iVar3 = (**(code **)*param_6)(param_6,*(undefined4 *)(puVar5 + -6),&local_8);
              if (iVar3 < 0) goto LAB_67690999;
              local_c = *(int *)(puVar5 + -6);
            }
            iVar3 = FUN_67690205(local_8,*(undefined4 *)(puVar5 + -10),local_1c);
            if (iVar3 < 0) {
LAB_67690999:
              Ordinal_9(local_1c);
              if (local_8 != (int *)0x0) {
                (**(code **)(*local_8 + 8))(local_8);
              }
              return -0x7fffbffb;
            }
            if (((local_1c[0] == 0xd) || (local_1c[0] == 9)) && (local_14 == 0)) goto LAB_67690937;
            iVar3 = (**(code **)(*param_1 + 0x10))(param_1,*(undefined4 *)(puVar5 + -0xc),local_1c);
            if (iVar3 < 0) goto LAB_67690986;
            Ordinal_9(local_1c);
          }
          else {
            uVar2 = *puVar5;
            piVar4 = (int *)(*(int *)(puVar5 + -4) + param_5);
            if (uVar2 == 0xb) {
LAB_676908b0:
              local_14 = CONCAT22(local_14._2_2_,(short)*piVar4);
LAB_676908b7:
              local_1c[0] = uVar2;
              iVar3 = (**(code **)(*param_1 + 0x10))
                                (param_1,*(undefined4 *)(puVar5 + -0xc),local_1c);
              if (iVar3 < 0) {
LAB_67690986:
                Ordinal_9(local_1c);
                if (local_8 == (int *)0x0) {
                  return iVar3;
                }
                (**(code **)(*local_8 + 8))(local_8);
                return iVar3;
              }
            }
            else if (0xf < uVar2) {
              if (uVar2 < 0x12) {
                local_14 = CONCAT31(local_14._1_3_,(char)*piVar4);
              }
              else {
                if (uVar2 == 0x12) goto LAB_676908b0;
                if ((uVar2 != 0x13) && ((uVar2 < 0x16 || (0x17 < uVar2)))) goto LAB_67690937;
                local_14 = *piVar4;
              }
              goto LAB_676908b7;
            }
LAB_67690937:
            Ordinal_9(local_1c);
          }
        }
        puVar1 = puVar5 + 6;
        param_4 = puVar5 + 2;
        puVar5 = puVar5 + 0xe;
      } while (*(int *)puVar1 != 0);
      if (local_8 != (int *)0x0) {
        (**(code **)(*local_8 + 8))(local_8);
      }
    }
    iVar3 = 0;
  }
  return iVar3;
}



// Function: FUN_67690a14 at 67690a14

void __fastcall FUN_67690a14(int param_1)

{
  code *pcVar1;
  
  pcVar1 = DefWindowProcA_exref;
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined4 *)(param_1 + 0x18) = 0;
  *(code **)(param_1 + 0x1c) = pcVar1;
  return;
}



// Function: FUN_67690a28 at 67690a28

undefined * __thiscall FUN_67690a28(void *this,byte param_1)

{
  DeleteCriticalSection
            ((LPCRITICAL_SECTION)((-(uint)(this != (void *)0x0) & (int)this + 0x18U) + 4));
  FUN_67691f15((int)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined *)this;
}



// Function: FUN_67690a5b at 67690a5b

undefined4 * __thiscall FUN_67690a5b(void *this,byte param_1)

{
  FUN_67690a77((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_67690a77 at 67690a77

void __fastcall FUN_67690a77(undefined4 *param_1)

{
  int *piVar1;
  
  *param_1 = &PTR_FUN_676ba438;
  FUN_676913ba((int)param_1);
  piVar1 = (int *)param_1[10];
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  DeleteCriticalSection
            ((LPCRITICAL_SECTION)(-(uint)(param_1 != (undefined4 *)0x0) & (uint)(param_1 + 1)));
  return;
}



// Function: FUN_67690aa6 at 67690aa6

undefined4 * __thiscall FUN_67690aa6(void *this,byte param_1)

{
  FUN_67690acc((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)((int)this + -0xe0));
  }
  return (undefined4 *)((int)this + -0xe0);
}



// Function: FUN_67690acc at 67690acc

void __fastcall FUN_67690acc(undefined4 *param_1)

{
  param_1[-0x38] = &PTR_LAB_676ba074;
  param_1[-0x37] = &PTR_FUN_676ba064;
  param_1[-0x25] = &PTR_FUN_676ba058;
  param_1[-0x1d] = &PTR_LAB_676ba034;
  param_1[-0x1c] = &PTR_LAB_676ba018;
  param_1[-0x1b] = &PTR_LAB_676b9fb8;
  param_1[-0x1a] = &PTR_LAB_676b9f90;
  param_1[-0x19] = &PTR_LAB_676b9f54;
  param_1[-0x18] = &PTR_LAB_676b9f28;
  param_1[-0x17] = &PTR_LAB_676b9f14;
  param_1[-0x16] = &PTR_LAB_676b9eec;
  param_1[-0x15] = &PTR_LAB_676b9edc;
  param_1[-0x14] = &PTR_LAB_676b9ec4;
  param_1[-0x13] = &PTR_LAB_676b9e94;
  param_1[-0x12] = &PTR_LAB_676b9e80;
  param_1[-0x11] = &PTR_LAB_676b9e60;
  param_1[-0xe] = &PTR_LAB_676b9e40;
  param_1[-2] = &PTR_LAB_676b9e24;
  param_1[-1] = &PTR_LAB_676b9e10;
  *param_1 = &PTR_FUN_676b9d9c;
  param_1[1] = &PTR_LAB_676b9d90;
  param_1[0x578] = 1;
  FUN_676a1d4e((int)(param_1 + -0x38));
  InterlockedDecrement(&DAT_676c559c);
  FUN_67690b8f((uint)param_1);
  return;
}



// Function: FUN_67690b8f at 67690b8f

void __fastcall FUN_67690b8f(uint param_1)

{
  if (1 < *(int *)(param_1 + 0x1718)) {
    FUN_676b0201(*(undefined **)(param_1 + 0x1714));
  }
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x16f8));
  *(undefined ***)(param_1 + 0x16d8) = &PTR_LAB_676b9950;
  *(undefined ***)(param_1 + 0x16b8) = &PTR_LAB_676b9950;
  *(undefined ***)(param_1 + 0x1698) = &PTR_LAB_676b9950;
  *(undefined ***)(param_1 + 0x1678) = &PTR_LAB_676b9950;
  *(undefined ***)(param_1 + 0x1658) = &PTR_LAB_676b9950;
  *(undefined ***)(param_1 + 0x1638) = &PTR_LAB_676b9950;
  FUN_6767cd46((undefined4 *)(-(uint)(param_1 != 0xe0) & param_1));
  FUN_67691b55(-(uint)(param_1 != 0xe0) & param_1 - 0x38);
  FUN_6769179f(-(uint)(param_1 != 0xe0) & param_1 - 0x44);
  FUN_67692201(-(uint)(param_1 != 0xe0) & param_1 - 0xdc);
  DeleteCriticalSection((LPCRITICAL_SECTION)((-(uint)(param_1 != 0xe0) & param_1 + 0x15e0) + 4));
  return;
}



// Function: FUN_67690c3f at 67690c3f

int __thiscall FUN_67690c3f(void *this,int *param_1,undefined4 *param_2)

{
  int *piVar1;
  int iVar2;
  
  iVar2 = 0;
  if (*(int *)((int)this + 0xc) == 0) {
    iVar2 = FUN_67691000(this,param_1);
  }
  *param_2 = *(undefined4 *)((int)this + 0xc);
  piVar1 = *(int **)((int)this + 0xc);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 4))(piVar1);
    iVar2 = 0;
  }
  return iVar2;
}



// Function: FUN_67690c6e at 67690c6e

int __thiscall
FUN_67690c6e(void *this,undefined4 param_1,undefined4 *param_2,int param_3,int *param_4,int param_5)

{
  int iVar1;
  undefined4 *puVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int local_c;
  int local_8;
  
  local_c = 0;
  if (*(int *)((int)this + 0xc) == 0) {
    local_c = FUN_67691000(this,param_4);
  }
  if ((*(int *)((int)this + 0xc) != 0) && (local_8 = 0, 0 < param_3)) {
    param_4 = param_2;
    do {
      iVar1 = lstrlenW((LPCWSTR)*param_4);
      iVar5 = *(int *)((int)this + 0x18) + -1;
      if (iVar5 < 0) {
LAB_67690d0f:
        local_c = (**(code **)(**(int **)((int)this + 0xc) + 0x28))
                            (*(int **)((int)this + 0xc),param_2,param_3,param_5);
        if (local_c < 0) {
          return local_c;
        }
      }
      else {
        iVar4 = iVar5 * 0xc;
        do {
          puVar2 = (undefined4 *)(*(int *)((int)this + 0x14) + iVar4);
          iVar3 = puVar2[1];
          if ((iVar1 == iVar3) &&
             (iVar3 = _memcmp((void *)*puVar2,(void *)*param_4,iVar3 * 2), iVar3 == 0)) {
            *(undefined4 *)((param_5 - (int)param_2) + (int)param_4) =
                 *(undefined4 *)(*(int *)((int)this + 0x14) + 8 + iVar5 * 0xc);
            break;
          }
          iVar5 = iVar5 + -1;
          iVar4 = iVar4 + -0xc;
        } while (-1 < iVar5);
        if (iVar5 < 0) goto LAB_67690d0f;
      }
      local_8 = local_8 + 1;
      param_4 = param_4 + 1;
    } while (local_8 < param_3);
  }
  return local_c;
}



// Function: FUN_67690d45 at 67690d45

void __thiscall FUN_67690d45(void *this,LPSTREAM param_1,int *param_2)

{
  HRESULT HVar1;
  uint uVar2;
  
  uVar2 = -(uint)(this != (void *)0x0) & (int)this - 0x6cU;
  HVar1 = FUN_67690d73(param_1,param_2,uVar2,(undefined4 *)uVar2);
  if (-1 < HVar1) {
    *(byte *)(uVar2 + 0x48) = *(byte *)(uVar2 + 0x48) & 0x7f;
  }
  return;
}



// Function: FUN_67690d73 at 67690d73

HRESULT FUN_67690d73(LPSTREAM param_1,int *param_2,int param_3,undefined4 *param_4)

{
  int *piVar1;
  LPSTREAM This;
  LPSTREAM This_00;
  int *piVar2;
  int iVar3;
  int *piVar4;
  ushort local_20 [8];
  uint local_10;
  int local_c;
  HRESULT local_8;
  
  This = param_1;
  local_8 = (*param_1->lpVtbl->Read)(param_1,&local_10,4,(ULONG *)0x0);
  if (-1 < local_8) {
    if (local_10 < 0x301) {
      param_1 = (LPSTREAM)0x0;
      local_c = 0;
      if (param_2[2] != 0) {
        piVar2 = param_2;
        piVar4 = param_2 + 3;
        do {
          if (*piVar2 != 0) {
            if (piVar4[2] == 0) {
              local_20[0] = 0;
              local_8 = FUN_67690e8a(local_20,This);
              This_00 = param_1;
              if (-1 < local_8) {
                if (*piVar4 == local_c) {
LAB_67690e38:
                  iVar3 = FUN_67690762((int *)param_1,piVar4[-2],local_20);
                  if (-1 < iVar3) {
                    Ordinal_9(local_20);
                    goto LAB_67690e54;
                  }
                }
                else {
                  if (param_1 != (LPSTREAM)0x0) {
                    param_1 = (LPSTREAM)0x0;
                    (*This_00->lpVtbl->Release)(This_00);
                  }
                  iVar3 = (**(code **)*param_4)(param_4,*piVar4,&param_1);
                  if (-1 < iVar3) {
                    local_c = *piVar4;
                    goto LAB_67690e38;
                  }
                }
                local_8 = -0x7fffbffb;
              }
              Ordinal_9(local_20);
              break;
            }
            local_8 = (*This->lpVtbl->Read)
                                (This,(void *)(piVar4[1] + param_3),piVar4[2],(ULONG *)0x0);
            if (local_8 < 0) break;
          }
LAB_67690e54:
          piVar1 = piVar4 + 6;
          piVar2 = piVar4 + 4;
          piVar4 = piVar4 + 7;
        } while (*piVar1 != 0);
        if (param_1 != (LPSTREAM)0x0) {
          (*param_1->lpVtbl->Release)(param_1);
        }
      }
    }
    else {
      local_8 = -0x7fffbffb;
    }
  }
  return local_8;
}



// Function: FUN_67690e8a at 67690e8a

HRESULT __thiscall FUN_67690e8a(void *this,LPSTREAM param_1)

{
  void *pvVar1;
  int iVar2;
  HRESULT HVar3;
  IID *iidInterface;
  ULONG cb;
  void *local_c;
  void *local_8;
  
  local_c = this;
  local_8 = this;
  iVar2 = Ordinal_9(this);
  if (iVar2 < 0) {
    return iVar2;
  }
  iVar2 = (*param_1->lpVtbl->Read)(param_1,&local_c,2,(ULONG *)0x0);
  if (iVar2 == 1) {
    iVar2 = -0x7fffbffb;
  }
  if (-1 < iVar2) {
    *(short *)this = (short)local_c;
    switch((uint)local_c & 0xffff) {
    case 2:
    case 0xb:
    case 0x12:
      cb = 2;
      break;
    case 3:
    case 4:
    case 10:
    case 0x13:
    case 0x16:
    case 0x17:
      cb = 4;
      break;
    case 5:
    case 6:
    case 7:
      cb = 8;
      break;
    default:
      local_8 = (void *)0x0;
      iVar2 = FUN_67690fa4(&local_8,(int *)param_1);
      pvVar1 = local_8;
      if (-1 < iVar2) {
        *(undefined2 *)this = 8;
        local_8 = (void *)0x0;
        *(void **)((int)this + 8) = pvVar1;
        if ((short)local_c != 8) {
          iVar2 = Ordinal_12(this,this,0,local_c);
        }
      }
      Ordinal_6(local_8);
      return iVar2;
    case 9:
    case 0xd:
      iidInterface = (IID *)&DAT_676bb600;
      *(LPVOID *)((int)this + 8) = (LPVOID)0x0;
      if ((short)local_c != 0xd) {
        iidInterface = (IID *)&DAT_676bb4d0;
      }
      OleLoadFromStream(param_1,iidInterface,(LPVOID *)((int)this + 8));
      return 0;
    case 0x10:
    case 0x11:
      cb = 1;
    }
    HVar3 = (*param_1->lpVtbl->Read)(param_1,(void *)((int)this + 8),cb,(ULONG *)0x0);
    if (HVar3 == 1) {
      HVar3 = -0x7fffbffb;
    }
    return HVar3;
  }
  return iVar2;
}



// Function: FUN_67690fa4 at 67690fa4

int __thiscall FUN_67690fa4(void *this,int *param_1)

{
  int iVar1;
  int local_8;
  
  local_8 = 0;
  iVar1 = (**(code **)(*param_1 + 0xc))(param_1,&local_8,4,0);
  if (iVar1 == 0) {
    if (local_8 == 0) {
      return 0;
    }
    iVar1 = Ordinal_150(0,local_8 + -2);
    *(int *)this = iVar1;
    if (iVar1 == 0) {
      return -0x7ff8fff2;
    }
    iVar1 = (**(code **)(*param_1 + 0xc))(param_1,iVar1,local_8,0);
  }
  if (iVar1 == 1) {
    iVar1 = -0x7fffbffb;
  }
  return iVar1;
}



// Function: FUN_67691000 at 67691000

int __thiscall FUN_67691000(void *this,int *param_1)

{
  int *piVar1;
  int iVar2;
  undefined2 uVar4;
  int iVar3;
  int *local_10;
  int *local_c;
  int *local_8;
  
  if (*(int *)((int)this + 0xc) == 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c55a4);
    if (*(int *)((int)this + 0xc) == 0) {
      uVar4 = (undefined2)((uint)&local_10 >> 0x10);
      iVar2 = Ordinal_162(*(undefined4 *)((int)this + 4),
                          CONCAT22(uVar4,*(undefined2 *)((int)this + 8)),
                          CONCAT22(uVar4,*(undefined2 *)((int)this + 10)),param_1,&local_10);
      if (-1 < iVar2) {
        local_8 = (int *)0x0;
                    /* WARNING: Load size is inaccurate */
        iVar2 = (**(code **)(*local_10 + 0x18))(local_10,*this,&local_8);
        if (-1 < iVar2) {
          param_1 = local_8;
          if (local_8 != (int *)0x0) {
            (**(code **)(*local_8 + 4))(local_8);
          }
          local_c = (int *)0x0;
          iVar3 = (**(code **)*local_8)(local_8,&DAT_676c19b0,&local_c);
          if (-1 < iVar3) {
            FUN_6768fa93((int *)&param_1,local_c);
          }
          FUN_67691190(this,param_1);
          piVar1 = param_1;
          param_1 = (int *)0x0;
          *(int **)((int)this + 0xc) = piVar1;
          if (local_c != (int *)0x0) {
            (**(code **)(*local_c + 8))(local_c);
            if (param_1 != (int *)0x0) {
              (**(code **)(*param_1 + 8))(param_1);
            }
          }
        }
        (**(code **)(*local_10 + 8))(local_10);
        if (local_8 != (int *)0x0) {
          (**(code **)(*local_8 + 8))(local_8);
        }
      }
    }
    else {
      iVar2 = 0;
    }
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c55a4);
    FUN_67691108(0x676c5588,FUN_67691164,this);
  }
  else {
    iVar2 = 0;
  }
  return iVar2;
}



// Function: FUN_67691108 at 67691108

undefined4 FUN_67691108(int param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 *puVar1;
  undefined4 local_8;
  
  local_8 = 0;
  puVar1 = (undefined4 *)operator_new(0xc);
  if (puVar1 == (undefined4 *)0x0) {
    local_8 = 0x8007000e;
  }
  else {
    *puVar1 = param_2;
    puVar1[1] = param_3;
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x1c));
    puVar1[2] = *(undefined4 *)(param_1 + 0x80);
    *(undefined4 **)(param_1 + 0x80) = puVar1;
    LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x1c));
  }
  return local_8;
}



// Function: FUN_67691164 at 67691164

void FUN_67691164(int param_1)

{
  int *piVar1;
  
  piVar1 = *(int **)(param_1 + 0xc);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  *(undefined4 *)(param_1 + 0xc) = 0;
  if (*(void **)(param_1 + 0x14) != (void *)0x0) {
    FUN_6768ed45(*(void **)(param_1 + 0x14),3);
  }
  *(undefined4 *)(param_1 + 0x14) = 0;
  return;
}



// Function: FUN_67691190 at 67691190

undefined4 __thiscall FUN_67691190(void *this,int *param_1)

{
  int iVar1;
  uint *puVar2;
  int iVar3;
  undefined4 uVar4;
  uint *puVar5;
  uint uVar6;
  int iVar7;
  int local_10;
  undefined4 *local_c;
  undefined4 local_8;
  
  iVar1 = (**(code **)(*param_1 + 0xc))(param_1,&local_10);
  if (-1 < iVar1) {
    iVar1 = 0;
    uVar6 = (uint)*(ushort *)(local_10 + 0x2c);
    *(uint *)((int)this + 0x18) = uVar6;
    if ((uVar6 == 0) || (puVar2 = (uint *)operator_new(uVar6 * 0xc + 4), puVar2 == (uint *)0x0)) {
      puVar2 = (uint *)0x0;
    }
    else {
      *puVar2 = uVar6;
      puVar2 = puVar2 + 1;
      puVar5 = puVar2;
      if (-1 < (int)(uVar6 - 1)) {
        do {
          *puVar5 = 0;
          uVar6 = uVar6 - 1;
          puVar5 = puVar5 + 3;
        } while (uVar6 != 0);
      }
    }
    iVar7 = 0;
    *(uint **)((int)this + 0x14) = puVar2;
    if (0 < *(int *)((int)this + 0x18)) {
      do {
        iVar3 = (**(code **)(*param_1 + 0x14))(param_1,iVar1,&local_c);
        if (-1 < iVar3) {
          local_8 = 0;
          iVar3 = (**(code **)(*param_1 + 0x30))(param_1,*local_c,&local_8,0,0,0);
          uVar4 = local_8;
          if (-1 < iVar3) {
            local_8 = 0;
            *(undefined4 *)(iVar7 + *(int *)((int)this + 0x14)) = uVar4;
            uVar4 = Ordinal_7(*(undefined4 *)(iVar7 + *(int *)((int)this + 0x14)));
            *(undefined4 *)(iVar7 + 4 + *(int *)((int)this + 0x14)) = uVar4;
            *(undefined4 *)(iVar7 + 8 + *(int *)((int)this + 0x14)) = *local_c;
          }
          (**(code **)(*param_1 + 0x50))(param_1,local_c);
          Ordinal_6(local_8);
        }
        iVar1 = iVar1 + 1;
        iVar7 = iVar7 + 0xc;
      } while (iVar1 < *(int *)((int)this + 0x18));
    }
    (**(code **)(*param_1 + 0x4c))(param_1,local_10);
  }
  return 0;
}



// Function: FUN_67691289 at 67691289

undefined4 FUN_67691289(int *param_1,int *param_2)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  undefined4 uVar4;
  LPVOID pvVar5;
  int *piVar6;
  int iVar7;
  int *piVar8;
  int *piVar9;
  int local_8;
  
  piVar6 = param_2;
  piVar3 = param_1;
  if (param_2 == (int *)0x0) {
    uVar4 = 0x80004003;
  }
  else {
    piVar8 = param_2 + 2;
    iVar7 = 0;
    iVar1 = *piVar8;
    piVar9 = piVar8;
    while (iVar1 != 0) {
      if (((short)param_2[6] == 0) &&
         ((((piVar2 = (int *)*piVar9, *piVar2 != 0 || (piVar2[1] != 0)) || (piVar2[2] != 0)) ||
          (piVar2[3] != 0)))) {
        iVar7 = iVar7 + 1;
      }
      param_2 = piVar9 + 5;
      iVar1 = piVar9[7];
      piVar9 = piVar9 + 7;
    }
    pvVar5 = CoTaskMemAlloc(iVar7 << 4);
    param_1[1] = (int)pvVar5;
    if (pvVar5 == (LPVOID)0x0) {
      uVar4 = 0x8007000e;
    }
    else {
      param_1 = (int *)0x0;
      if (*piVar8 != 0) {
        param_2 = (int *)0x0;
        do {
          if (((short)piVar6[6] == 0) &&
             (((piVar6 = (int *)*piVar8, *piVar6 != 0 || (piVar6[1] != 0)) ||
              ((piVar6[2] != 0 || (piVar6[3] != 0)))))) {
            local_8 = 0;
            if (0 < (int)param_2) {
              piVar9 = (int *)piVar3[1];
              do {
                if (((*piVar6 == *piVar9) && (piVar6[1] == piVar9[1])) &&
                   ((piVar6[2] == piVar9[2] && (piVar6[3] == piVar9[3])))) goto LAB_6769139d;
                local_8 = local_8 + 1;
                piVar9 = piVar9 + 4;
              } while (local_8 < (int)param_1);
            }
            piVar9 = (int *)(piVar3[1] + (int)param_2);
            param_1 = (int *)((int)param_1 + 1);
            param_2 = param_2 + 4;
            *piVar9 = *piVar6;
            piVar9[1] = piVar6[1];
            piVar9[2] = piVar6[2];
            piVar9[3] = piVar6[3];
          }
LAB_6769139d:
          piVar9 = piVar8 + 7;
          piVar6 = piVar8 + 5;
          piVar8 = piVar9;
        } while (*piVar9 != 0);
      }
      *piVar3 = (int)param_1;
      uVar4 = 0;
    }
  }
  return uVar4;
}



// Function: FUN_676913ba at 676913ba

void __fastcall FUN_676913ba(int param_1)

{
  int iVar1;
  int *piVar2;
  HANDLE pvVar3;
  int iVar4;
  DWORD DVar5;
  LPVOID pvVar6;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 4));
  iVar1 = *(int *)(param_1 + 0x24);
  if (iVar1 != 0) {
    if (iVar1 == 1) {
      piVar2 = *(int **)(param_1 + 0x28);
      if (piVar2 != (int *)0x0) {
        (**(code **)(*piVar2 + 0x10))(piVar2,*(undefined4 *)(param_1 + 0x20));
      }
    }
    else {
      if ((*(int *)(param_1 + 0x28) != 0) && (iVar4 = 0, 0 < iVar1)) {
        do {
          (**(code **)(**(int **)(param_1 + 0x28) + 0x10))
                    (*(int **)(param_1 + 0x28),*(undefined4 *)(*(int *)(param_1 + 0x20) + iVar4 * 4)
                    );
          iVar4 = iVar4 + 1;
        } while (iVar4 < *(int *)(param_1 + 0x24));
      }
      pvVar6 = *(LPVOID *)(param_1 + 0x1c);
      DVar5 = 0;
      pvVar3 = GetProcessHeap();
      HeapFree(pvVar3,DVar5,pvVar6);
      pvVar6 = *(LPVOID *)(param_1 + 0x20);
      DVar5 = 0;
      pvVar3 = GetProcessHeap();
      HeapFree(pvVar3,DVar5,pvVar6);
    }
    *(undefined4 *)(param_1 + 0x1c) = 0;
    *(undefined4 *)(param_1 + 0x20) = 0;
    *(undefined4 *)(param_1 + 0x24) = 0;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 4));
  return;
}



// Function: FUN_67691451 at 67691451

LONG FUN_67691451(undefined4 *param_1)

{
  LONG LVar1;
  
  LVar1 = InterlockedDecrement(param_1 + 6);
  if ((LVar1 == 0) && (param_1 != (undefined4 *)0x0)) {
    FUN_676914c2(param_1);
    FUN_676b0bb3((undefined *)param_1);
  }
  return LVar1;
}



// Function: FUN_67691480 at 67691480

void FUN_67691480(int param_1,int *param_2,undefined4 *param_3)

{
  FUN_6768f4db(param_1,(int *)&PTR_DAT_676ba440,param_2,param_3);
  return;
}



// Function: FUN_676914a8 at 676914a8

int __fastcall FUN_676914a8(int param_1)

{
  FUN_676914fc(param_1);
  *(undefined4 *)(param_1 + 0x18) = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x1c));
  return param_1;
}



// Function: FUN_676914c2 at 676914c2

void __fastcall FUN_676914c2(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676ba41c;
  param_1[6] = 1;
  InterlockedDecrement(&DAT_676c559c);
  DeleteCriticalSection
            ((LPCRITICAL_SECTION)((-(uint)(param_1 != (undefined4 *)0x0) & (uint)(param_1 + 6)) + 4)
            );
  FUN_67691f15((int)param_1);
  return;
}



// Function: FUN_676914fc at 676914fc

void __fastcall FUN_676914fc(int param_1)

{
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined4 *)(param_1 + 0x10) = 0;
  *(undefined4 *)(param_1 + 0xc) = 0;
  *(undefined4 *)(param_1 + 8) = 0;
  *(undefined4 *)(param_1 + 0x14) = 0;
  return;
}



// Function: FUN_67691554 at 67691554

undefined4 FUN_67691554(int param_1)

{
  int *piVar1;
  DWORD DVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  
  uVar4 = 0;
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x34));
  puVar5 = *(undefined4 **)(param_1 + 0x68);
  if (puVar5 != (undefined4 *)0x0) {
    DVar2 = GetCurrentThreadId();
    puVar3 = (undefined4 *)0x0;
    do {
      if (puVar5[1] == DVar2) {
        if (puVar3 == (undefined4 *)0x0) {
          *(undefined4 *)(param_1 + 0x68) = puVar5[2];
        }
        else {
          puVar3[2] = puVar5[2];
        }
        uVar4 = *puVar5;
        break;
      }
      piVar1 = puVar5 + 2;
      puVar3 = puVar5;
      puVar5 = (undefined4 *)*piVar1;
    } while ((undefined4 *)*piVar1 != (undefined4 *)0x0);
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x34));
  return uVar4;
}



// Function: FUN_676915a8 at 676915a8

int * FUN_676915a8(int *param_1,UINT param_2,WPARAM param_3,LPARAM param_4)

{
  int iVar1;
  int *piVar2;
  WPARAM wParam;
  int iVar3;
  UINT UVar4;
  int local_20;
  UINT local_1c;
  WPARAM local_18;
  LPARAM local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  wParam = param_3;
  piVar2 = param_1;
  local_1c = param_2;
  local_14 = param_4;
  local_10 = 0;
  local_c = 0;
  local_8 = 0;
  iVar1 = param_1[6];
  local_20 = param_1[1];
  param_1[6] = (int)&local_20;
  local_18 = param_3;
  iVar3 = (**(code **)*param_1)(local_20,param_2,param_3,param_4,&param_1,0);
  piVar2[6] = iVar1;
  if (iVar3 == 0) {
    if (param_2 == 0x82) {
      param_2 = GetWindowLongA((HWND)piVar2[1],-4);
      param_1 = (int *)CallWindowProcA((WNDPROC)piVar2[7],(HWND)piVar2[1],0x82,wParam,param_4);
      if ((code *)piVar2[7] != DefWindowProcA_exref) {
        UVar4 = GetWindowLongA((HWND)piVar2[1],-4);
        if (UVar4 == param_2) {
          SetWindowLongA((HWND)piVar2[1],-4,piVar2[7]);
        }
      }
      iVar1 = piVar2[1];
      piVar2[1] = 0;
      (**(code **)(*piVar2 + 8))(iVar1);
    }
    else {
      param_1 = (int *)CallWindowProcA((WNDPROC)piVar2[7],(HWND)piVar2[1],param_2,wParam,param_4);
    }
  }
  return param_1;
}



// Function: FUN_67691681 at 67691681

void __thiscall FUN_67691681(void *this,int param_1,undefined4 param_2)

{
  HANDLE hProcess;
  SIZE_T dwSize;
  
  dwSize = 0xd;
  *(undefined4 *)((int)this + 4) = param_2;
  *(undefined4 *)this = 0x42444c7;
  *(undefined1 *)((int)this + 8) = 0xe9;
  *(int *)((int)this + 9) = (param_1 - (int)this) + -0xd;
  hProcess = GetCurrentProcess();
  FlushInstructionCache(hProcess,this,dwSize);
  return;
}



// Function: FUN_676916b1 at 676916b1

HWND __thiscall
FUN_676916b1(void *this,HWND param_1,int *param_2,LPCSTR param_3,uint param_4,DWORD param_5,
            HMENU param_6,ushort param_7,LPVOID param_8)

{
  HWND pHVar1;
  
  if (param_7 == 0) {
    pHVar1 = (HWND)0x0;
  }
  else {
    FUN_6769171f(0x676c5588,(undefined4 *)((int)this + 8),this);
    if ((param_6 == (HMENU)0x0) && ((param_4 & 0x40000000) != 0)) {
      param_6 = (HMENU)this;
    }
    pHVar1 = CreateWindowExA(param_5,(LPCSTR)(uint)param_7,param_3,param_4,*param_2,param_2[1],
                             param_2[2] - *param_2,param_2[3] - param_2[1],param_1,param_6,
                             DAT_676c558c,param_8);
  }
  return pHVar1;
}



// Function: FUN_6769171f at 6769171f

void FUN_6769171f(int param_1,undefined4 *param_2,undefined4 param_3)

{
  DWORD DVar1;
  
  *param_2 = param_3;
  DVar1 = GetCurrentThreadId();
  param_2[1] = DVar1;
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x34));
  param_2[2] = *(undefined4 *)(param_1 + 0x68);
  *(undefined4 **)(param_1 + 0x68) = param_2;
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x34));
  return;
}



// Function: FUN_67691759 at 67691759

int __fastcall FUN_67691759(int param_1)

{
  int iVar1;
  undefined4 *puVar2;
  int local_8;
  
  puVar2 = (undefined4 *)(-(uint)(param_1 != 0) & param_1 - 0x88U);
  local_8 = param_1;
  iVar1 = (**(code **)*puVar2)(puVar2,&DAT_676bb540,&local_8);
  if (iVar1 < 0) {
    FUN_6768f4db((int)puVar2,(int *)&PTR_DAT_676ba2c0,(int *)&DAT_676bb540,&local_8);
  }
  return local_8;
}



// Function: FUN_6769179f at 6769179f

void __fastcall FUN_6769179f(int param_1)

{
  int *piVar1;
  int *piVar2;
  int *piVar3;
  
  piVar1 = (int *)(param_1 + 4);
  piVar3 = piVar1;
  if (1 < *(int *)(param_1 + 8)) {
    piVar3 = (int *)*piVar1;
  }
  while( true ) {
    piVar2 = FUN_676917db(piVar1);
    if (piVar2 <= piVar3) break;
    piVar2 = (int *)*piVar3;
    if (piVar2 != (int *)0x0) {
      (**(code **)(*piVar2 + 8))(piVar2);
    }
    piVar3 = piVar3 + 1;
  }
  if (1 < *(int *)(param_1 + 8)) {
    FUN_676b0201((undefined *)*piVar1);
  }
  return;
}



// Function: FUN_676917db at 676917db

undefined4 * __fastcall FUN_676917db(undefined4 *param_1)

{
  int *piVar1;
  
  piVar1 = param_1 + 1;
  if (1 < *piVar1) {
    param_1 = (undefined4 *)*param_1;
  }
  return param_1 + *piVar1;
}



// Function: FUN_676917e9 at 676917e9

int FUN_676917e9(int *param_1,undefined4 *param_2,int *param_3)

{
  int *piVar1;
  int *piVar2;
  undefined4 *puVar3;
  int iVar4;
  LPCRITICAL_SECTION lpCriticalSection;
  bool bVar5;
  undefined1 local_14 [16];
  
  puVar3 = param_2;
  piVar2 = param_1;
  bVar5 = param_1 != (int *)0x0;
  piVar1 = param_1 + -0x27;
  if ((param_2 == (undefined4 *)0x0) || (param_3 == (int *)0x0)) {
    iVar4 = -0x7fffbffd;
  }
  else {
    (**(code **)(*param_1 + 0xc))(param_1,local_14);
    iVar4 = (**(code **)*puVar3)(puVar3,local_14,&param_1);
    if (iVar4 < 0) {
      if (iVar4 == -0x7fffbffe) {
        iVar4 = -0x7ffbfdfe;
      }
    }
    else {
      lpCriticalSection = (LPCRITICAL_SECTION)((-(uint)bVar5 & (uint)piVar1) + 0x16c4);
      EnterCriticalSection(lpCriticalSection);
      iVar4 = FUN_6769189b(piVar2 + 1,(int)param_1);
      *param_3 = iVar4;
      iVar4 = (-(uint)(iVar4 != 0) & 0x7ffbfdff) + 0x80040201;
      LeaveCriticalSection(lpCriticalSection);
      if (iVar4 == 0) {
        return 0;
      }
      (**(code **)(*param_1 + 8))(param_1);
    }
    if (iVar4 < 0) {
      *param_3 = 0;
    }
  }
  return iVar4;
}



// Function: FUN_6769189b at 6769189b

int __thiscall FUN_6769189b(void *this,int param_1)

{
  int iVar1;
  undefined4 *_Dst;
  int *piVar2;
  byte *pbVar3;
  size_t _Size;
  int *piVar4;
  
  if (*(int *)((int)this + 4) == 0) {
    *(undefined4 *)((int)this + 4) = 1;
    *(int *)this = param_1;
    return param_1;
  }
  if (*(int *)((int)this + 4) == 1) {
    _Dst = (undefined4 *)_malloc(0x10);
    if (_Dst == (undefined4 *)0x0) {
      return 0;
    }
    _memset(_Dst,0,0x10);
                    /* WARNING: Load size is inaccurate */
    *_Dst = *this;
    *(undefined4 **)this = _Dst;
    *(undefined4 *)((int)this + 4) = 4;
  }
  piVar4 = (int *)this;
  if (1 < *(int *)((int)this + 4)) {
                    /* WARNING: Load size is inaccurate */
    piVar4 = *this;
  }
  for (; piVar2 = FUN_676917db((undefined4 *)this), piVar4 < piVar2; piVar4 = piVar4 + 1) {
    if (*piVar4 == 0) {
      *piVar4 = param_1;
      return param_1;
    }
  }
  iVar1 = *(int *)((int)this + 4);
                    /* WARNING: Load size is inaccurate */
  pbVar3 = FUN_676b0e9c(*this,(uint *)(iVar1 << 3));
  if (pbVar3 == (byte *)0x0) {
    return 0;
  }
  *(byte **)this = pbVar3;
  _Size = *(int *)((int)this + 4) * 4;
  _memset(pbVar3 + _Size,0,_Size);
                    /* WARNING: Load size is inaccurate */
  *(int *)(*this + *(int *)((int)this + 4) * 4) = param_1;
  *(int *)((int)this + 4) = iVar1 << 1;
  return param_1;
}



// Function: FUN_676919b0 at 676919b0

undefined4 __thiscall FUN_676919b0(void *this,int param_1)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  
  if ((param_1 != 0) && (iVar1 = *(int *)((int)this + 4), iVar1 != 0)) {
    if (iVar1 == 1) {
                    /* WARNING: Load size is inaccurate */
      if (*this == param_1) {
        *(undefined4 *)((int)this + 4) = 0;
        return 1;
      }
    }
    else {
      piVar3 = (int *)this;
      if (1 < iVar1) {
                    /* WARNING: Load size is inaccurate */
        piVar3 = *this;
      }
      for (; piVar2 = FUN_676917db((undefined4 *)this), piVar3 < piVar2; piVar3 = piVar3 + 1) {
        if (*piVar3 == param_1) {
          *piVar3 = 0;
          return 1;
        }
      }
    }
  }
  return 0;
}



// Function: FUN_67691a00 at 67691a00

int FUN_67691a00(int param_1,undefined4 *param_2)

{
  LPCRITICAL_SECTION lpCriticalSection;
  int iVar1;
  undefined4 *puVar2;
  int *piVar3;
  int *piVar4;
  int *piVar5;
  int *piVar6;
  int *piVar7;
  undefined4 *local_8;
  
  if (param_2 == (undefined4 *)0x0) {
    iVar1 = -0x7fffbffd;
  }
  else {
    *param_2 = 0;
    local_8 = (undefined4 *)operator_new(0x34);
    if (local_8 == (undefined4 *)0x0) {
      local_8 = (undefined4 *)0x0;
    }
    else {
      FUN_67693473((int)local_8);
      FUN_67691b41(local_8 + 6);
      *local_8 = &PTR_LAB_676ba470;
      InterlockedIncrement(&DAT_676c559c);
    }
    if (local_8 != (undefined4 *)0x0) {
      lpCriticalSection = (LPCRITICAL_SECTION)((-(uint)(param_1 != 0) & param_1 - 0x9cU) + 0x16c4);
      EnterCriticalSection(lpCriticalSection);
      piVar6 = (int *)(param_1 + 4);
      piVar3 = piVar6;
      if (1 < *(int *)(param_1 + 8)) {
        piVar3 = (int *)*piVar6;
      }
      puVar2 = FUN_676917db(piVar6);
      piVar3 = (int *)operator_new(((int)puVar2 - (int)piVar3 >> 2) << 3);
      if (piVar3 != (int *)0x0) {
        piVar5 = piVar3;
        piVar7 = piVar6;
        if (1 < *(int *)(param_1 + 8)) {
          piVar7 = (int *)*piVar6;
        }
        for (; piVar4 = FUN_676917db(piVar6), piVar7 < piVar4; piVar7 = piVar7 + 1) {
          piVar4 = (int *)*piVar7;
          if (piVar4 != (int *)0x0) {
            (**(code **)(*piVar4 + 4))(piVar4);
            *piVar5 = *piVar7;
            piVar5[1] = *piVar7;
            piVar5 = piVar5 + 2;
          }
        }
        FUN_67694028(local_8,piVar3,piVar5,(int *)0x0,2);
        LeaveCriticalSection(lpCriticalSection);
        iVar1 = FUN_6768f4db((int)local_8,(int *)&PTR_DAT_676ba458,(int *)&DAT_676bb5c0,param_2);
        if (-1 < iVar1) {
          return iVar1;
        }
        FUN_676933d1(local_8);
        FUN_676b0bb3((undefined *)local_8);
        return iVar1;
      }
      FUN_676933d1(local_8);
      FUN_676b0bb3((undefined *)local_8);
      LeaveCriticalSection(lpCriticalSection);
    }
    iVar1 = -0x7ff8fff2;
  }
  return iVar1;
}



// Function: FUN_67691b41 at 67691b41

undefined4 * __fastcall FUN_67691b41(undefined4 *param_1)

{
  *param_1 = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 1));
  return param_1;
}



// Function: FUN_67691b55 at 67691b55

void __fastcall FUN_67691b55(int param_1)

{
  undefined4 *puVar1;
  int *piVar2;
  int *piVar3;
  
  puVar1 = (undefined4 *)(param_1 + 4);
  piVar2 = (int *)FUN_676922fc((int)puVar1);
  while( true ) {
    piVar3 = (int *)FUN_6769238c((int)puVar1);
    if (piVar3 <= piVar2) break;
    piVar3 = (int *)*piVar2;
    if (piVar3 != (int *)0x0) {
      (**(code **)(*piVar3 + 8))(piVar3);
    }
    piVar2 = piVar2 + 1;
  }
  FUN_67690a77(puVar1);
  return;
}



// Function: FUN_67691b89 at 67691b89

int FUN_67691b89(int *param_1,undefined4 *param_2,int *param_3)

{
  int *piVar1;
  int *piVar2;
  undefined4 *puVar3;
  int iVar4;
  LPCRITICAL_SECTION lpCriticalSection;
  bool bVar5;
  undefined1 local_14 [16];
  
  puVar3 = param_2;
  piVar2 = param_1;
  bVar5 = param_1 != (int *)0x0;
  piVar1 = param_1 + -0x2a;
  if ((param_2 == (undefined4 *)0x0) || (param_3 == (int *)0x0)) {
    iVar4 = -0x7fffbffd;
  }
  else {
    (**(code **)(*param_1 + 0xc))(param_1,local_14);
    iVar4 = (**(code **)*puVar3)(puVar3,local_14,&param_1);
    if (iVar4 < 0) {
      if (iVar4 == -0x7fffbffe) {
        iVar4 = -0x7ffbfdfe;
      }
    }
    else {
      lpCriticalSection = (LPCRITICAL_SECTION)((-(uint)bVar5 & (uint)piVar1) + 0x16c4);
      EnterCriticalSection(lpCriticalSection);
      iVar4 = FUN_67694296(piVar2 + 1,(int)param_1);
      *param_3 = iVar4;
      iVar4 = (-(uint)(iVar4 != 0) & 0x7ffbfdff) + 0x80040201;
      LeaveCriticalSection(lpCriticalSection);
      if (iVar4 == 0) {
        return 0;
      }
      (**(code **)(*param_1 + 8))(param_1);
    }
    if (iVar4 < 0) {
      *param_3 = 0;
    }
  }
  return iVar4;
}



// Function: FUN_67691c99 at 67691c99

int FUN_67691c99(int param_1,undefined4 *param_2)

{
  LPCRITICAL_SECTION lpCriticalSection;
  int iVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  int *piVar6;
  int *piVar7;
  undefined4 *local_8;
  
  if (param_2 == (undefined4 *)0x0) {
    iVar1 = -0x7fffbffd;
  }
  else {
    *param_2 = 0;
    local_8 = (undefined4 *)operator_new(0x34);
    if (local_8 == (undefined4 *)0x0) {
      local_8 = (undefined4 *)0x0;
    }
    else {
      FUN_67693473((int)local_8);
      FUN_67691b41(local_8 + 6);
      *local_8 = &PTR_LAB_676ba470;
      InterlockedIncrement(&DAT_676c559c);
    }
    if (local_8 != (undefined4 *)0x0) {
      lpCriticalSection = (LPCRITICAL_SECTION)((-(uint)(param_1 != 0) & param_1 - 0xa8U) + 0x16c4);
      EnterCriticalSection(lpCriticalSection);
      iVar1 = param_1 + 4;
      iVar2 = FUN_676922fc(iVar1);
      iVar3 = FUN_6769238c(iVar1);
      piVar4 = (int *)operator_new((iVar3 - iVar2 >> 2) << 3);
      if (piVar4 != (int *)0x0) {
        piVar5 = (int *)FUN_676922fc(iVar1);
        piVar7 = piVar4;
        for (; piVar6 = (int *)FUN_6769238c(iVar1), piVar5 < piVar6; piVar5 = piVar5 + 1) {
          piVar6 = (int *)*piVar5;
          if (piVar6 != (int *)0x0) {
            (**(code **)(*piVar6 + 4))(piVar6);
            *piVar7 = *piVar5;
            if (piVar5 == (int *)0x0) {
              iVar2 = 0;
            }
            else {
              iVar2 = *piVar5;
            }
            piVar7[1] = iVar2;
            piVar7 = piVar7 + 2;
          }
        }
        FUN_67694028(local_8,piVar4,piVar7,(int *)0x0,2);
        LeaveCriticalSection(lpCriticalSection);
        iVar1 = FUN_6768f4db((int)local_8,(int *)&PTR_DAT_676ba458,(int *)&DAT_676bb5c0,param_2);
        if (-1 < iVar1) {
          return iVar1;
        }
        FUN_676933d1(local_8);
        FUN_676b0bb3((undefined *)local_8);
        return iVar1;
      }
      FUN_676933d1(local_8);
      FUN_676b0bb3((undefined *)local_8);
      LeaveCriticalSection(lpCriticalSection);
    }
    iVar1 = -0x7ff8fff2;
  }
  return iVar1;
}



// Function: FUN_67691de0 at 67691de0

undefined2 FUN_67691de0(int param_1,WNDCLASSEXA *param_2,UINT *param_3)

{
  LPCRITICAL_SECTION lpCriticalSection;
  byte *pbVar1;
  LPSTR pCVar2;
  WNDPROC pWVar3;
  LPCSTR pCVar4;
  ATOM AVar5;
  BOOL BVar6;
  HCURSOR pHVar7;
  HINSTANCE pHVar8;
  tagWNDCLASSEXA local_68;
  tagWNDCLASSEXA local_38;
  HINSTANCE local_8;
  
  if ((short)param_2[1].cbWndExtra == 0) {
    lpCriticalSection = (LPCRITICAL_SECTION)(param_1 + 0x34);
    EnterCriticalSection(lpCriticalSection);
    if ((short)param_2[1].cbWndExtra == 0) {
      pHVar8 = *(HINSTANCE *)(param_1 + 4);
      local_8 = pHVar8;
      if ((LPCSTR)param_2[1].cbSize == (LPCSTR)0x0) {
        pHVar7 = LoadCursorA((HINSTANCE)(~-(uint)(param_2[1].cbClsExtra != 0) & (uint)pHVar8),
                             (LPCSTR)param_2[1].lpfnWndProc);
        param_2->hCursor = pHVar7;
      }
      else {
        pWVar3 = param_2->lpfnWndProc;
        pCVar4 = param_2->lpszClassName;
        local_38.cbSize = 0x30;
        BVar6 = GetClassInfoExA((HINSTANCE)0x0,(LPCSTR)param_2[1].cbSize,&local_38);
        if ((BVar6 == 0) &&
           (BVar6 = GetClassInfoExA(DAT_676c558c,(LPCSTR)param_2[1].cbSize,&local_38), BVar6 == 0))
        {
          LeaveCriticalSection(lpCriticalSection);
          return 0;
        }
        FUN_676b06d0(&param_2->cbSize,&local_38.cbSize,0x30);
        param_2->lpszClassName = pCVar4;
        param_2[1].style = (UINT)param_2->lpfnWndProc;
        param_2->lpfnWndProc = pWVar3;
        pHVar8 = local_8;
      }
      pbVar1 = (byte *)((int)&param_2->style + 1);
      *pbVar1 = *pbVar1 & 0xbf;
      param_2->hInstance = pHVar8;
      if (param_2->lpszClassName == (LPCSTR)0x0) {
        pCVar2 = (LPSTR)((int)&param_2[1].cbWndExtra + 2);
        wsprintfA(pCVar2,s_ATL__8_8X_676c19c0,param_2);
        param_2->lpszClassName = pCVar2;
      }
      FUN_676b06d0(&local_68.cbSize,&param_2->cbSize,0x30);
      BVar6 = GetClassInfoExA(param_2->hInstance,param_2->lpszClassName,&local_68);
      *(short *)&param_2[1].cbWndExtra = (short)BVar6;
      if ((short)BVar6 == 0) {
        AVar5 = RegisterClassExA(param_2);
        *(ATOM *)&param_2[1].cbWndExtra = AVar5;
      }
    }
    LeaveCriticalSection(lpCriticalSection);
  }
  if (param_2[1].cbSize != 0) {
    *param_3 = param_2[1].style;
  }
  return (short)param_2[1].cbWndExtra;
}



// Function: FUN_67691f15 at 67691f15

void __fastcall FUN_67691f15(int param_1)

{
  int *piVar1;
  int *piVar2;
  
  if ((*(byte *)(param_1 + 0x14) & 2) != 0) {
    for (piVar2 = *(int **)(param_1 + 8); piVar2 != *(int **)(param_1 + 0xc); piVar2 = piVar2 + 1) {
      piVar1 = (int *)*piVar2;
      if (piVar1 != (int *)0x0) {
        (**(code **)(*piVar1 + 8))(piVar1);
      }
    }
    FUN_676b0bb3(*(undefined **)(param_1 + 8));
  }
  piVar2 = *(int **)(param_1 + 4);
  if (piVar2 != (int *)0x0) {
    (**(code **)(*piVar2 + 8))(piVar2);
  }
  return;
}



// Function: FUN_67691f51 at 67691f51

uint FUN_67691f51(int param_1,uint param_2,int *param_3,uint *param_4)

{
  int *piVar1;
  uint uVar2;
  uint uVar3;
  bool bVar4;
  
  uVar2 = param_2;
  if ((param_3 == (int *)0x0) || ((param_2 != 1 && (param_4 == (uint *)0x0)))) {
    param_2 = 0x80004003;
  }
  else if (((*(int *)(param_1 + 8) == 0) || (*(int *)(param_1 + 0xc) == 0)) ||
          (*(int *)(param_1 + 0x10) == 0)) {
    param_2 = 0x80004005;
  }
  else {
    uVar3 = *(int *)(param_1 + 0xc) - *(int *)(param_1 + 0x10) >> 2;
    bVar4 = param_2 < uVar3;
    param_2 = (uint)(uVar3 < param_2);
    if (bVar4) {
      uVar3 = uVar2;
    }
    if (param_4 != (uint *)0x0) {
      *param_4 = uVar3;
    }
    for (; uVar3 != 0; uVar3 = uVar3 - 1) {
      piVar1 = (int *)**(int **)(param_1 + 0x10);
      *param_3 = (int)piVar1;
      if (piVar1 != (int *)0x0) {
        (**(code **)(*piVar1 + 4))(piVar1);
      }
      *(int *)(param_1 + 0x10) = *(int *)(param_1 + 0x10) + 4;
      param_3 = param_3 + 1;
    }
  }
  return param_2;
}



// Function: FUN_67691fdf at 67691fdf

void FUN_67691fdf(int *param_1,int *param_2)

{
  HDC hdc;
  int iVar1;
  int iVar2;
  
  hdc = GetDC((HWND)0x0);
  iVar1 = GetDeviceCaps(hdc,0x58);
  iVar2 = GetDeviceCaps(hdc,0x5a);
  ReleaseDC((HWND)0x0,hdc);
  *param_2 = (*param_1 * 0x9ec + (iVar1 >> 1)) / iVar1;
  param_2[1] = (param_1[1] * 0x9ec + (iVar2 >> 1)) / iVar2;
  return;
}



// Function: FUN_67692071 at 67692071

int FUN_67692071(int *param_1,undefined4 *param_2)

{
  bool bVar1;
  int *piVar2;
  undefined4 *puVar3;
  int **ppiVar4;
  int iVar5;
  
  puVar3 = param_2;
  bVar1 = false;
  iVar5 = -0x7fffbffd;
  if (param_2 != (undefined4 *)0x0) {
    *param_2 = 0;
    iVar5 = FUN_6769493d(&param_2);
    piVar2 = param_1;
    if (-1 < iVar5) {
      if ((*(byte *)(param_1 + 5) & 1) == 0) {
        ppiVar4 = (int **)(param_1 + 1);
      }
      else {
        if (param_1 != (int *)0x0) {
          (**(code **)(*piVar2 + 4))(piVar2);
        }
        bVar1 = true;
        ppiVar4 = &param_1;
      }
      iVar5 = FUN_67692133(param_2,(int *)piVar2[2],(int *)piVar2[3],*ppiVar4,0);
      if ((bVar1) && (param_1 != (int *)0x0)) {
        (**(code **)(*param_1 + 8))(param_1);
      }
      if (-1 < iVar5) {
        param_2[4] = piVar2[4];
        iVar5 = FUN_6768f4db((int)param_2,(int *)&PTR_DAT_676ba440,(int *)&DAT_676bb5a0,puVar3);
        if (-1 < iVar5) {
          return iVar5;
        }
      }
      puVar3 = param_2;
      if (param_2 != (undefined4 *)0x0) {
        FUN_676914c2(param_2);
        FUN_676b0bb3((undefined *)puVar3);
      }
    }
  }
  return iVar5;
}



// Function: FUN_67692133 at 67692133

undefined4 __thiscall FUN_67692133(void *this,int *param_1,int *param_2,int *param_3,int param_4)

{
  int *piVar1;
  void *pvVar2;
  uint uVar3;
  
  if (param_4 == 3) {
    uVar3 = ((int)param_2 - (int)param_1 >> 2) * 4;
    pvVar2 = operator_new(uVar3);
    *(void **)((int)this + 8) = pvVar2;
    *(void **)((int)this + 0x10) = pvVar2;
    if (pvVar2 == (void *)0x0) {
      return 0x8007000e;
    }
    for (; param_1 != param_2; param_1 = param_1 + 1) {
      piVar1 = (int *)*param_1;
      **(int **)((int)this + 0x10) = (int)piVar1;
      if (piVar1 != (int *)0x0) {
        (**(code **)(*piVar1 + 4))(piVar1);
      }
      *(int *)((int)this + 0x10) = *(int *)((int)this + 0x10) + 4;
    }
    *(uint *)((int)this + 0xc) = uVar3 + *(int *)((int)this + 8);
  }
  else {
    *(int **)((int)this + 8) = param_1;
    *(int **)((int)this + 0xc) = param_2;
  }
  FUN_6768fa93((int *)((int)this + 4),param_3);
  *(undefined4 *)((int)this + 0x10) = *(undefined4 *)((int)this + 8);
  *(int *)((int)this + 0x14) = param_4;
  return 0;
}



// Function: FUN_676921bb at 676921bb

void * __thiscall FUN_676921bb(void *this,undefined4 param_1)

{
  *(undefined4 *)((int)this + 4) = 0;
  *(undefined4 *)((int)this + 8) = 0;
  *(undefined4 *)((int)this + 0xc) = 0;
  *(undefined4 *)((int)this + 0x10) = 0;
  *(undefined4 *)((int)this + 0x14) = 0;
  *(undefined4 *)((int)this + 0x18) = 0;
  *(undefined4 *)((int)this + 0x3c) = param_1;
  _memset(this,0,0x48);
  *(undefined4 *)((int)this + 0x1c) = 0x13d8;
  *(undefined4 *)((int)this + 0x3c) = param_1;
  *(undefined4 *)((int)this + 0x24) = 0x13d8;
  *(undefined4 *)((int)this + 0x28) = 0x13d8;
  *(undefined4 *)((int)this + 0x20) = 0x13d8;
  return this;
}



// Function: FUN_67692201 at 67692201

void __fastcall FUN_67692201(int param_1)

{
  int *piVar1;
  
  if ((HWND)**(undefined4 **)(param_1 + 0x3c) != (HWND)0x0) {
    DestroyWindow((HWND)**(undefined4 **)(param_1 + 0x3c));
  }
  piVar1 = *(int **)(param_1 + 0x18);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  piVar1 = *(int **)(param_1 + 0x14);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  piVar1 = *(int **)(param_1 + 0x10);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  piVar1 = *(int **)(param_1 + 0xc);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  piVar1 = *(int **)(param_1 + 8);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  piVar1 = *(int **)(param_1 + 4);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  return;
}



// Function: FUN_67692264 at 67692264

undefined4 __thiscall FUN_67692264(void *this)

{
  undefined4 *puVar1;
  undefined4 *in_stack_00000010;
  int *local_c;
  int *local_8;
  
  if ((*(byte *)((int)this + 0x44) & 4) == 0) goto LAB_676922ee;
                    /* WARNING: Load size is inaccurate */
  local_c = (int *)0x0;
  local_8 = (int *)this;
  (**(code **)(*this + 4))(&DAT_676bb640,&local_c);
  if (local_c != (int *)0x0) {
    (**(code **)(*local_c + 0x2c))
              (local_c,0xfffffffc,0,*(undefined4 *)((int)this + 0x10),0,
               **(undefined4 **)((int)this + 0x3c),(int)this + 0x2c);
  }
  puVar1 = *(undefined4 **)((int)this + 0x10);
  local_8 = (int *)0x0;
  if (puVar1 != (undefined4 *)0x0) {
    (**(code **)*puVar1)(puVar1,&DAT_676bb570,&local_8);
  }
  if ((*(byte *)((int)this + 0x44) & 4) == 0) {
LAB_676922d7:
    if (local_8 != (int *)0x0) {
      (**(code **)(*local_8 + 8))(local_8);
    }
  }
  else if (local_8 != (int *)0x0) {
    (**(code **)(*local_8 + 0x20))(local_8,1);
    goto LAB_676922d7;
  }
  if (local_c != (int *)0x0) {
    (**(code **)(*local_c + 8))(local_c);
  }
LAB_676922ee:
  *in_stack_00000010 = 0;
  return 1;
}



// Function: FUN_676922fc at 676922fc

int __fastcall FUN_676922fc(int param_1)

{
  int iVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 4));
  if (*(int *)(param_1 + 0x24) < 2) {
    iVar1 = param_1 + 0x1c;
  }
  else {
    iVar1 = *(int *)(param_1 + 0x1c);
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 4));
  return iVar1;
}



// Function: FUN_67692324 at 67692324

undefined4 __thiscall FUN_67692324(void *this)

{
  undefined4 *puVar1;
  HWND hWnd;
  BOOL BVar2;
  undefined4 *in_stack_00000010;
  int *local_8;
  
  local_8 = (int *)0x0;
  puVar1 = *(undefined4 **)((int)this + 0x10);
  if (puVar1 != (undefined4 *)0x0) {
    (**(code **)*puVar1)(puVar1,&DAT_676bb570,&local_8);
  }
  if (((*(byte *)((int)this + 0x44) & 4) != 0) && (local_8 != (int *)0x0)) {
    hWnd = GetFocus();
    BVar2 = IsChild((HWND)**(undefined4 **)((int)this + 0x3c),hWnd);
    if (BVar2 == 0) {
      (**(code **)(*local_8 + 0x20))(local_8,0);
    }
  }
  *in_stack_00000010 = 0;
  if (local_8 != (int *)0x0) {
    (**(code **)(*local_8 + 8))(local_8);
  }
  return 1;
}



// Function: FUN_6769238c at 6769238c

int __fastcall FUN_6769238c(int param_1)

{
  int iVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 4));
  iVar1 = *(int *)(param_1 + 0x24);
  if (iVar1 < 2) {
    iVar1 = param_1 + 0x1c + iVar1 * 4;
  }
  else {
    iVar1 = *(int *)(param_1 + 0x1c) + iVar1 * 4;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 4));
  return iVar1;
}



// Function: FUN_676923ba at 676923ba

undefined4 __thiscall FUN_676923ba(void *this)

{
  int iVar1;
  undefined4 *in_stack_00000010;
  int local_c;
  int *local_8;
  
  local_c = 1;
  local_8 = (int *)this;
  iVar1 = FUN_67693487(this,&local_c);
  if ((iVar1 < 0) || (local_c != 0)) {
                    /* WARNING: Load size is inaccurate */
    local_8 = (int *)0x0;
    (**(code **)(*this + 4))(&DAT_676bb640,&local_8);
    if (local_8 != (int *)0x0) {
      (**(code **)(*local_8 + 0x2c))
                (local_8,0xfffffffc,0,*(undefined4 *)((int)this + 0x10),0,
                 **(undefined4 **)((int)this + 0x3c),(int)this + 0x2c);
      if (local_8 != (int *)0x0) {
        (**(code **)(*local_8 + 8))(local_8);
      }
    }
  }
  *in_stack_00000010 = 0;
  return 1;
}



// Function: FUN_67692429 at 67692429

undefined4 * __fastcall FUN_67692429(undefined4 *param_1)

{
  FUN_676924b5((int)param_1);
  *param_1 = &PTR_LAB_676ba678;
  param_1[1] = &PTR_FUN_676ba668;
  param_1[0x13] = &PTR_FUN_676ba65c;
  param_1[0x1b] = &PTR_LAB_676ba638;
  param_1[0x1c] = &PTR_LAB_676ba61c;
  param_1[0x1d] = &PTR_LAB_676ba5bc;
  param_1[0x1e] = &PTR_LAB_676ba594;
  param_1[0x1f] = &PTR_LAB_676ba558;
  param_1[0x20] = &PTR_LAB_676ba52c;
  param_1[0x21] = &PTR_LAB_676ba504;
  param_1[0x22] = &PTR_LAB_676ba4ec;
  param_1[0x23] = &PTR_LAB_676ba4bc;
  param_1[0x24] = &PTR_LAB_676ba4a8;
  param_1[0x25] = &PTR_LAB_676ba48c;
  InterlockedIncrement(&DAT_676c559c);
  return param_1;
}



// Function: FUN_676924b5 at 676924b5

int __fastcall FUN_676924b5(int param_1)

{
  undefined4 *this;
  int local_14;
  undefined4 local_10;
  int local_c [2];
  
  *(undefined4 *)(param_1 + 0x98) = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x9c));
  FUN_67692769((void *)(param_1 + 4));
  this = (undefined4 *)(param_1 + 0xb8);
  FUN_6767e702(this);
  *(undefined4 *)(param_1 + 0x19c) = 0;
  FUN_6769259c((void *)(param_1 + 0x1b4));
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x1d0));
  local_c[0] = 0x20;
  local_c[1] = 0x20;
  FUN_67691fdf(local_c,&local_14);
  *(int *)(param_1 + 0x20) = local_14;
  *(int *)(param_1 + 0x28) = local_14;
  *(byte *)(param_1 + 0x49) = *(byte *)(param_1 + 0x49) | 2;
  *(undefined4 *)(param_1 + 0x24) = local_10;
  *(undefined4 *)(param_1 + 0x2c) = local_10;
  *(undefined4 *)(param_1 + 0x194) = 6;
  *(undefined4 *)(param_1 + 0x198) = 8;
  FUN_6767e856(this,6);
  FUN_6767e81f(this,8);
  FUN_6767e877(this,2);
  *(undefined1 *)(param_1 + 0x1a0) = 0;
  *(undefined1 *)(param_1 + 0x1a1) = 0;
  _memset((void *)(param_1 + 0x1a2),0,0xc);
  *(undefined4 *)(param_1 + 0x1b0) = 0;
  *(undefined4 *)(param_1 + 0xb4) = 0;
  *(undefined1 *)(param_1 + 0x1cc) = 1;
  return param_1;
}



// Function: FUN_6769259c at 6769259c

void __fastcall FUN_6769259c(void *param_1)

{
  _memset(param_1,0,4);
  _memset((void *)((int)param_1 + 4),0,4);
  *(undefined4 *)((int)param_1 + 8) = 0;
  *(undefined4 *)((int)param_1 + 0xc) = 0;
  *(undefined4 *)((int)param_1 + 0x10) = 0;
  *(undefined4 *)((int)param_1 + 0x14) = 0;
  return;
}



// Function: FUN_676925c9 at 676925c9

undefined4 __thiscall
FUN_676925c9(void *this,HWND param_1,uint param_2,HDC param_3,LPARAM param_4,LRESULT *param_5,
            int param_6)

{
  int iVar1;
  undefined4 uVar2;
  LRESULT LVar3;
  
  if (param_6 != 0) goto LAB_6769261b;
  iVar1 = FUN_676927fb(this,param_1,param_2,param_3,param_4,param_5,0);
  if (iVar1 == 0) {
    if (param_2 < 0x2112) {
      if ((param_2 == 0x2111) ||
         ((0x202a < param_2 && (((param_2 < 0x2030 || (param_2 == 0x2039)) || (param_2 == 0x204e))))
         )) {
LAB_6769264b:
        LVar3 = DefWindowProcA(param_1,param_2 - 0x2000,(WPARAM)param_3,param_4);
        *param_5 = LVar3;
        goto LAB_67692663;
      }
    }
    else if ((0x2113 < param_2) &&
            ((param_2 < 0x2116 ||
             ((0x2131 < param_2 && ((param_2 < 0x2139 || (param_2 == 0x2210))))))))
    goto LAB_6769264b;
LAB_6769261b:
    uVar2 = 0;
  }
  else {
LAB_67692663:
    uVar2 = 1;
  }
  return uVar2;
}



// Function: FUN_67692704 at 67692704

void FUN_67692704(undefined4 param_1,undefined4 param_2,undefined4 *param_3,int param_4,int *param_5
                 ,int param_6)

{
  FUN_67690c6e(&PTR_DAT_676c19d0,param_2,param_3,param_4,param_5,param_6);
  return;
}



// Function: FUN_67692724 at 67692724

void FUN_67692724(undefined4 param_1,undefined4 param_2,undefined4 param_3,int *param_4,
                 undefined4 param_5,undefined4 param_6,undefined4 param_7,undefined4 param_8,
                 undefined4 param_9)

{
  if ((DAT_676c19dc == (int *)0x0) &&
     (FUN_67691000(&PTR_DAT_676c19d0,param_4), DAT_676c19dc == (int *)0x0)) {
    return;
  }
  (**(code **)(*DAT_676c19dc + 0x2c))
            (DAT_676c19dc,param_1,param_2,param_5,param_6,param_7,param_8,param_9);
  return;
}



// Function: FUN_67692769 at 67692769

void * __fastcall FUN_67692769(void *param_1)

{
  code *pcVar1;
  
  FUN_676921bb(param_1,(int)param_1 + 0x4c);
  pcVar1 = DefWindowProcA_exref;
  *(undefined4 *)((int)param_1 + 0x4c) = 0;
  *(undefined4 *)((int)param_1 + 0x60) = 0;
  *(code **)((int)param_1 + 100) = pcVar1;
  return param_1;
}



// Function: FUN_676927aa at 676927aa

void __thiscall FUN_676927aa(void *this,HWND param_1,int *param_2)

{
  ushort uVar1;
  uint uVar2;
  
  uVar2 = -(uint)(this != (void *)0x0) & (int)this - 4U;
  if (DAT_676c1a30 == 0) {
    DAT_676c1a30 = 0;
  }
  uVar1 = FUN_67691de0(0x676c5588,(WNDCLASSEXA *)&DAT_676c1a00,(UINT *)(uVar2 + 0x68));
  FUN_676916b1((void *)(uVar2 + 0x4c),param_1,param_2,(LPCSTR)0x0,0x56000000,0,(HMENU)0x0,uVar1,
               (LPVOID)0x0);
  return;
}



// Function: FUN_676927fb at 676927fb

undefined4 __thiscall
FUN_676927fb(void *this,undefined4 param_1,int param_2,HDC param_3,undefined4 param_4,
            undefined4 *param_5,int param_6)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_6 == 0) {
    if (param_2 == 0xf) {
      uVar1 = FUN_676948ac((void *)((int)this + -0x48),0xf,param_3);
    }
    else if (param_2 == 7) {
      uVar1 = FUN_67692264((void *)((int)this + -0x48));
    }
    else if (param_2 == 8) {
      uVar1 = FUN_67692324((void *)((int)this + -0x48));
    }
    else {
      if (param_2 != 0x21) goto LAB_6769289e;
      uVar1 = FUN_676923ba((void *)((int)this + -0x48));
    }
    uVar2 = 1;
    *param_5 = uVar1;
  }
  else {
LAB_6769289e:
    uVar2 = 0;
  }
  return uVar2;
}



// Function: FUN_67692a13 at 67692a13

undefined4 FUN_67692a13(undefined4 param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    *param_2 = 0x4c836512;
    param_2[1] = 0x11d2bb70;
    param_2[2] = 0x1000a7a5;
    param_2[3] = 0xc6919c5a;
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_67692a4a at 67692a4a

void FUN_67692a4a(int param_1,int param_2,undefined4 *param_3)

{
  FUN_67693d77((void *)((-(uint)(param_1 != 0) & param_1 - 0x74U) + 4),param_2,param_3);
  return;
}



// Function: FUN_67692b73 at 67692b73

bool FUN_67692b73(int param_1,undefined4 param_2)

{
  SHORT SVar1;
  int iVar2;
  char cVar3;
  int *local_8;
  
  local_8 = (int *)0x0;
  iVar2 = FUN_676936a7((void *)((-(uint)(param_1 != 0) & param_1 - 0x78U) + 4),&DAT_676bb570,
                       &local_8);
  if (-1 < iVar2) {
    if (local_8 == (int *)0x0) {
      iVar2 = 1;
    }
    else {
      SVar1 = GetKeyState(0x10);
      cVar3 = SVar1 < 0;
      SVar1 = GetKeyState(0x11);
      if (SVar1 < 0) {
        cVar3 = cVar3 + '\x02';
      }
      SVar1 = GetKeyState(0x12);
      if (SVar1 < 0) {
        cVar3 = cVar3 + '\x04';
      }
      iVar2 = (**(code **)(*local_8 + 0x1c))(local_8,param_2,cVar3);
    }
  }
  if (local_8 != (int *)0x0) {
    (**(code **)(*local_8 + 8))(local_8);
  }
  return iVar2 != 0;
}



// Function: FUN_67692c2f at 67692c2f

void FUN_67692c2f(int param_1,int param_2,undefined4 param_3,uint *param_4,int param_5,
                 undefined4 param_6,undefined4 param_7,int *param_8,undefined4 param_9)

{
  FUN_67693f7a((void *)((-(uint)(param_1 != 0) & param_1 - 0x7cU) + 4),param_2,param_3,param_4,
               param_5,param_6,param_7,param_8,param_9);
  return;
}



// Function: FUN_67692d01 at 67692d01

undefined4
FUN_67692d01(undefined4 param_1,int param_2,RECT *param_3,LONG param_4,LONG param_5,
            undefined4 param_6,uint *param_7)

{
  POINT pt;
  BOOL BVar1;
  undefined4 uVar2;
  
  if (param_2 == 1) {
    pt.y = param_5;
    pt.x = param_4;
    BVar1 = PtInRect(param_3,pt);
    *param_7 = -(uint)(BVar1 != 0) & 3;
    uVar2 = 0;
  }
  else {
    uVar2 = 0x80004005;
  }
  return uVar2;
}



// Function: FUN_67692d32 at 67692d32

undefined4
FUN_67692d32(undefined4 param_1,int param_2,RECT *param_3,RECT *param_4,undefined4 param_5,
            uint *param_6)

{
  BOOL BVar1;
  undefined4 uVar2;
  tagRECT local_14;
  
  if (param_2 == 1) {
    BVar1 = UnionRect(&local_14,param_3,param_4);
    *param_6 = -(uint)(BVar1 != 0) & 3;
    uVar2 = 0;
  }
  else {
    uVar2 = 0x80004005;
  }
  return uVar2;
}



// Function: FUN_67692e4a at 67692e4a

bool FUN_67692e4a(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                 undefined4 param_5)

{
  uint uVar1;
  int iVar2;
  
  uVar1 = -(uint)(param_1 != 0) & param_1 - 0x80U;
  iVar2 = (*(code *)**(undefined4 **)(uVar1 + 0x4c))
                    (*(undefined4 *)(uVar1 + 0x50),param_2,param_3,param_4,param_5,0);
  return (bool)('\x01' - (iVar2 != 0));
}



// Function: FUN_67692efb at 67692efb

int FUN_67692efb(int *param_1,int *param_2)

{
  int *piVar1;
  int iVar2;
  
  piVar1 = (int *)FUN_6769338b((int)param_1);
  iVar2 = -0x7fffbffb;
  if (piVar1 != (int *)0x0) {
    param_1 = (int *)0x0;
    iVar2 = (**(code **)(*param_2 + 0x10))(param_2,u_Contents_676c1978,0,0x10,0,&param_1);
    if (-1 < iVar2) {
      iVar2 = (**(code **)(*piVar1 + 0x14))(piVar1,param_1);
    }
    if (param_1 != (int *)0x0) {
      (**(code **)(*param_1 + 8))(param_1);
    }
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  return iVar2;
}



// Function: FUN_67692f5b at 67692f5b

int FUN_67692f5b(int *param_1,int *param_2,undefined4 param_3)

{
  int *piVar1;
  int iVar2;
  
  piVar1 = (int *)FUN_6769338b((int)param_1);
  iVar2 = -0x7fffbffb;
  if (piVar1 != (int *)0x0) {
    param_1 = (int *)0x0;
    iVar2 = (**(code **)(*param_2 + 0xc))(param_2,PTR_u_Contents_676c1aa4,0x1012,0,0,&param_1);
    if (-1 < iVar2) {
      iVar2 = (**(code **)(*piVar1 + 0x18))(piVar1,param_1,param_3);
    }
    if (param_1 != (int *)0x0) {
      (**(code **)(*param_1 + 8))(param_1);
    }
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  return iVar2;
}



// Function: FUN_6769309a at 6769309a

void FUN_6769309a(IDataObject *param_1,FORMATETC *param_2,DWORD param_3,IAdviseSink *param_4,
                 DWORD *param_5)

{
  LPDATAADVISEHOLDER *ppDAHolder;
  IDataAdviseHolder *This;
  uint uVar1;
  HRESULT HVar2;
  
  uVar1 = -(uint)(param_1 != (IDataObject *)0x0) & (uint)(param_1 + -0x23);
  ppDAHolder = (LPDATAADVISEHOLDER *)(uVar1 + 0xc);
  if ((*(int *)(uVar1 + 0xc) == 0) && (HVar2 = CreateDataAdviseHolder(ppDAHolder), HVar2 != 0)) {
    return;
  }
  This = *ppDAHolder;
  (*This->lpVtbl->Advise)(This,param_1,param_2,param_3,param_4,param_5);
  return;
}



// Function: FUN_67693152 at 67693152

undefined4 FUN_67693152(undefined4 param_1,undefined4 param_2,undefined4 *param_3)

{
  undefined4 uVar1;
  
  if (param_3 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    *param_3 = 0;
    param_3[1] = 0;
    param_3[2] = 0;
    param_3[3] = 0;
    uVar1 = 0x80004005;
  }
  return uVar1;
}



// Function: FUN_6769318c at 6769318c

void FUN_6769318c(int param_1,int *param_2,undefined4 param_3)

{
  int iVar1;
  uint uVar2;
  
  uVar2 = -(uint)(param_1 != 0) & param_1 - 0x94U;
  uVar2 = -(uint)(uVar2 != 0xffffff6c) & uVar2;
  iVar1 = FUN_6769060a(param_2,param_3,(ushort *)&PTR_u_CompressionLevel_676c1a50,uVar2,
                       (undefined4 *)uVar2);
  if (-1 < iVar1) {
    *(byte *)(uVar2 + 0x48) = *(byte *)(uVar2 + 0x48) & 0x7f;
  }
  return;
}



// Function: FUN_67693278 at 67693278

void __thiscall FUN_67693278(void *this,LPSTREAM param_1,int *param_2)

{
  HRESULT HVar1;
  uint uVar2;
  
  uVar2 = -(uint)(this != (void *)0x0) & (int)this - 0x6cU;
  HVar1 = FUN_67690d73(param_1,param_2,uVar2,(undefined4 *)uVar2);
  if (-1 < HVar1) {
    *(byte *)(uVar2 + 0x48) = *(byte *)(uVar2 + 0x48) & 0x7f;
  }
  return;
}



// Function: FUN_676932a6 at 676932a6

void __fastcall FUN_676932a6(undefined4 *param_1)

{
  *param_1 = &PTR_LAB_676ba678;
  param_1[1] = &PTR_FUN_676ba668;
  param_1[0x13] = &PTR_FUN_676ba65c;
  param_1[0x1b] = &PTR_LAB_676ba638;
  param_1[0x1c] = &PTR_LAB_676ba61c;
  param_1[0x1d] = &PTR_LAB_676ba5bc;
  param_1[0x1e] = &PTR_LAB_676ba594;
  param_1[0x1f] = &PTR_LAB_676ba558;
  param_1[0x20] = &PTR_LAB_676ba52c;
  param_1[0x21] = &PTR_LAB_676ba504;
  param_1[0x22] = &PTR_LAB_676ba4ec;
  param_1[0x23] = &PTR_LAB_676ba4bc;
  param_1[0x24] = &PTR_LAB_676ba4a8;
  param_1[0x25] = &PTR_LAB_676ba48c;
  param_1[0x26] = 1;
  InterlockedDecrement(&DAT_676c559c);
  FUN_6769333a((int)param_1);
  return;
}



// Function: FUN_6769333a at 6769333a

void __fastcall FUN_6769333a(int param_1)

{
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x1d0));
  Ordinal_6(*(undefined4 *)(param_1 + 0x19c));
  FUN_6767e796((undefined4 *)(param_1 + 0xb8));
  FUN_67692201(-(uint)(param_1 != 0) & param_1 + 4U);
  DeleteCriticalSection((LPCRITICAL_SECTION)((-(uint)(param_1 != 0) & param_1 + 0x98U) + 4));
  return;
}



// Function: FUN_6769338b at 6769338b

int __fastcall FUN_6769338b(int param_1)

{
  int iVar1;
  undefined4 *puVar2;
  int local_8;
  
  puVar2 = (undefined4 *)(-(uint)(param_1 != 0) & param_1 - 0x84U);
  local_8 = param_1;
  iVar1 = (**(code **)*puVar2)(puVar2,&DAT_676bb540,&local_8);
  if (iVar1 < 0) {
    FUN_6768f4db((int)puVar2,(int *)&PTR_DAT_676ba6c8,(int *)&DAT_676bb540,&local_8);
  }
  return local_8;
}



// Function: FUN_676933d1 at 676933d1

void __fastcall FUN_676933d1(undefined4 *param_1)

{
  *param_1 = &PTR_LAB_676ba470;
  param_1[6] = 1;
  InterlockedDecrement(&DAT_676c559c);
  DeleteCriticalSection
            ((LPCRITICAL_SECTION)((-(uint)(param_1 != (undefined4 *)0x0) & (uint)(param_1 + 6)) + 4)
            );
  FUN_67693beb((int)param_1);
  return;
}



// Function: FUN_6769341c at 6769341c

LONG FUN_6769341c(undefined4 *param_1)

{
  LONG LVar1;
  
  LVar1 = InterlockedDecrement(param_1 + 6);
  if ((LVar1 == 0) && (param_1 != (undefined4 *)0x0)) {
    FUN_676933d1(param_1);
    FUN_676b0bb3((undefined *)param_1);
  }
  return LVar1;
}



// Function: FUN_67693473 at 67693473

void __fastcall FUN_67693473(int param_1)

{
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined4 *)(param_1 + 0x10) = 0;
  *(undefined4 *)(param_1 + 0xc) = 0;
  *(undefined4 *)(param_1 + 8) = 0;
  *(undefined4 *)(param_1 + 0x14) = 0;
  return;
}



// Function: FUN_67693487 at 67693487

undefined4 __thiscall FUN_67693487(void *this,int *param_1)

{
  undefined4 uVar1;
  undefined2 local_14 [4];
  short local_c;
  
  local_14[0] = 0;
  uVar1 = 0x80004005;
  if (*(int **)((int)this + 0x18) != (int *)0x0) {
    uVar1 = FUN_67690205(*(int **)((int)this + 0x18),0xfffffd3b,local_14);
  }
  *param_1 = (int)local_c;
  Ordinal_9(local_14);
  return uVar1;
}



// Function: FUN_676934cd at 676934cd

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined1 __thiscall FUN_676934cd(void *this,HKEY__ param_1,char *param_2)

{
  undefined1 uVar1;
  bool bVar2;
  LPCWSTR lpString;
  char *pcVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined4 uVar6;
  void *this_00;
  undefined1 local_7c [48];
  undefined1 local_4c [32];
  undefined **local_2c [8];
  HKEY__ local_c;
  char local_5;
  
  local_5 = '\0';
  uVar1 = FUN_67694989(this,param_1,&local_5);
  if (param_1.unused == 0) {
    if (DAT_676c511c != 0) {
      *param_2 = DAT_676c511c == 1;
      return 1;
    }
    local_c.unused = 0;
    bVar2 = FUN_676936ce(0,&local_c);
    if (((bVar2) && ((LPCWSTR)local_c.unused != (LPCWSTR)0x0)) && (iVar4 = Ordinal_7(), iVar4 != 0))
    {
      uVar1 = FUN_676934cd(this_00,(HKEY__)&local_c,param_2);
    }
    else {
      *param_2 = local_5;
    }
  }
  else {
    lpString = (LPCWSTR)Ordinal_2();
    *param_2 = '\0';
    local_c.unused = (int)lpString;
    FUN_676abe64(local_7c);
    if (lpString == (LPCWSTR)0x0) {
      pcVar3 = (char *)0x0;
    }
    else {
      iVar4 = lstrlenW(lpString);
      FUN_676b06a0();
      pcVar3 = FUN_6768efcb(&stack0xffffff78,lpString,iVar4 * 2 + 2,0);
    }
    iVar4 = FUN_676abe87(local_7c,pcVar3,&DAT_676c5184,&DAT_676c5188,&DAT_676c518c,&DAT_676c1ac4,
                         &DAT_676c5190,&DAT_676c5194,(undefined8 *)&DAT_676c1ac8,
                         (undefined2 *)&DAT_676c5198);
    if (((-1 < iVar4) && (DAT_676c5184 == 1)) &&
       ((DAT_676c5188 == '\x05' && (DAT_676c518c == '\x01')))) {
      if ((DAT_676c1ac4 < 0) || (9 < DAT_676c1ac4)) {
        EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
        DAT_676c511c = 2;
        LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
        *param_2 = '\0';
      }
      else {
        local_2c[0] = &PTR_LAB_676b9950;
        FUN_6767d089((int)local_2c);
        puVar5 = FUN_6768ef7c(local_4c,_DAT_676c1ac8);
        uVar6 = FUN_6767cfc1(local_2c,(int)puVar5);
        if ((char)uVar6 != '\0') {
          EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
          DAT_676c511c = 1;
          LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
          *param_2 = '\x01';
        }
      }
    }
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
    if (DAT_676c511c == 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      *param_2 = local_5;
    }
    else {
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      uVar1 = 1;
    }
    FUN_676abe86();
  }
  Ordinal_6();
  return uVar1;
}



// Function: FUN_676936a7 at 676936a7

undefined4 __thiscall FUN_676936a7(void *this,undefined4 param_1,undefined4 *param_2)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar2 = 0x80004003;
  }
  else {
    puVar1 = *(undefined4 **)((int)this + 0x10);
    if (puVar1 == (undefined4 *)0x0) {
      *param_2 = 0;
      uVar2 = 0;
    }
    else {
      uVar2 = (**(code **)*puVar1)(puVar1,param_1,param_2);
    }
  }
  return uVar2;
}



// Function: FUN_676936ce at 676936ce

bool __cdecl FUN_676936ce(undefined4 param_1,HKEY param_2)

{
  bool bVar1;
  int iVar2;
  LPWSTR pWVar3;
  CHAR local_13c [264];
  undefined1 local_34 [48];
  
  if (param_2 == (HKEY)0x0) {
    bVar1 = false;
  }
  else {
    param_2->unused = 0;
    FUN_676abe64(local_34);
    iVar2 = FUN_676abf6f((HKEY)0x1,5,1,local_13c,0x104,'\0','\x01');
    if (iVar2 < 0) {
      bVar1 = FUN_67694b63(param_1,param_2);
    }
    else {
      pWVar3 = FUN_67684ed6(local_13c,-1);
      param_2->unused = (int)pWVar3;
      bVar1 = pWVar3 != (LPWSTR)0x0;
    }
    FUN_676abe86();
  }
  return bVar1;
}



// Function: FUN_67693745 at 67693745

undefined4 __thiscall FUN_67693745(void *this,int *param_1,size_t *param_2)

{
  size_t _Size;
  int *piVar1;
  size_t *psVar2;
  int iVar3;
  undefined4 uVar4;
  undefined1 local_24 [16];
  int *local_14;
  int *local_10;
  int *local_c;
  int *local_8;
  
  psVar2 = param_2;
  if ((param_1 == (int *)0x0) || (param_2 == (size_t *)0x0)) {
    uVar4 = 0x80004003;
  }
  else {
    _Size = *param_2;
    _memset(param_2,0,_Size);
    *psVar2 = _Size;
                    /* WARNING: Load size is inaccurate */
    local_8 = (int *)0x0;
    (**(code **)(*this + 4))(&DAT_676bb640,&local_8);
                    /* WARNING: Load size is inaccurate */
    param_2 = (size_t *)0x0;
    (**(code **)(*this + 4))(&DAT_676bb510,&param_2);
                    /* WARNING: Load size is inaccurate */
    local_14 = (int *)0x0;
    (**(code **)(*this + 4))(&DAT_676bb500,&local_14);
                    /* WARNING: Load size is inaccurate */
    local_10 = (int *)0x0;
    (**(code **)(*this + 4))(&DAT_676bb580,&local_10);
    piVar1 = param_1;
    if ((local_8 == (int *)0x0) || (param_2 == (size_t *)0x0)) {
      if (local_10 != (int *)0x0) {
        (**(code **)(*local_10 + 8))(local_10);
      }
      if (local_14 != (int *)0x0) {
        (**(code **)(*local_14 + 8))(local_14);
      }
      if (param_2 != (size_t *)0x0) {
        (**(code **)(*param_2 + 8))(param_2);
      }
      if (local_8 != (int *)0x0) {
        (**(code **)(*local_8 + 8))(local_8);
      }
      uVar4 = 0x80004005;
    }
    else {
      (**(code **)(*local_8 + 0xc))(local_8,param_1[1]);
      if (piVar1[2] != 0) {
        (**(code **)(*param_2 + 0x1c))(param_2,1,0,piVar1[2]);
      }
                    /* WARNING: Load size is inaccurate */
      local_c = (int *)0x0;
      (**(code **)(*this + 4))(&DAT_676bb590,&local_c);
      if (piVar1[3] != 0) {
        param_1 = (int *)0x0;
        if (local_c != (int *)0x0) {
          iVar3 = (**(code **)(*local_c + 0x10))(local_c,&DAT_676bb560,&param_1);
          if (-1 < iVar3) {
            (**(code **)(*param_1 + 0x14))(param_1,piVar1[3],psVar2 + 4);
          }
          if (param_1 != (int *)0x0) {
            (**(code **)(*param_1 + 8))(param_1);
          }
        }
      }
      if (local_10 != (int *)0x0) {
        iVar3 = (**(code **)(*local_10 + 0x10))(local_10,1,local_24);
        if ((-1 < iVar3) && (piVar1[4] != 0)) {
          param_1 = (int *)0x0;
          if (local_c != (int *)0x0) {
            iVar3 = (**(code **)(*local_c + 0x10))(local_c,local_24,&param_1);
            if (-1 < iVar3) {
              (**(code **)(*param_1 + 0x14))(param_1,piVar1[4],psVar2 + 3);
            }
            if (param_1 != (int *)0x0) {
              (**(code **)(*param_1 + 8))(param_1);
            }
          }
        }
      }
      if (local_8 != (int *)0x0) {
        (**(code **)(*local_8 + 0x58))(local_8,1,psVar2 + 1);
      }
      if (param_2 != (size_t *)0x0) {
        (**(code **)(*param_2 + 0x2c))(param_2,psVar2 + 2);
      }
      if (local_14 != (int *)0x0) {
        (**(code **)(*local_14 + 0xc))(local_14,psVar2 + 5);
      }
      if (local_c != (int *)0x0) {
        (**(code **)(*local_c + 8))(local_c);
      }
      if (local_10 != (int *)0x0) {
        (**(code **)(*local_10 + 8))(local_10);
      }
      if (local_14 != (int *)0x0) {
        (**(code **)(*local_14 + 8))(local_14);
      }
      if (param_2 != (size_t *)0x0) {
        (**(code **)(*param_2 + 8))(param_2);
      }
      if (local_8 != (int *)0x0) {
        (**(code **)(*local_8 + 8))(local_8);
      }
      uVar4 = 0;
    }
  }
  return uVar4;
}



// Function: FUN_67693963 at 67693963

undefined4 __thiscall FUN_67693963(void *this,int *param_1)

{
  int *piVar1;
  undefined4 *puVar2;
  
  FUN_6768fa93((int *)((int)this + 0x10),param_1);
  piVar1 = *(int **)((int)this + 0x18);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  *(undefined4 *)((int)this + 0x18) = 0;
  puVar2 = *(undefined4 **)((int)this + 0x10);
  if (puVar2 != (undefined4 *)0x0) {
    (**(code **)*puVar2)(puVar2,&DAT_676bb4d0,(undefined4 *)((int)this + 0x18));
  }
  return 0;
}



// Function: FUN_6769399f at 6769399f

undefined4 __thiscall FUN_6769399f(void *this,undefined4 *param_1)

{
  int *piVar1;
  undefined4 uVar2;
  
  if (param_1 == (undefined4 *)0x0) {
    uVar2 = 0x80004003;
  }
  else {
    *param_1 = *(undefined4 *)((int)this + 0x10);
    piVar1 = *(int **)((int)this + 0x10);
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 4))(piVar1);
    }
    uVar2 = 0;
  }
  return uVar2;
}



// Function: FUN_676939c5 at 676939c5

void __thiscall FUN_676939c5(void *this,IAdviseSink *param_1,DWORD *param_2)

{
  IOleAdviseHolder *This;
  HRESULT HVar1;
  
  if ((*(int *)((int)this + 0xc) == 0) &&
     (HVar1 = CreateOleAdviseHolder((LPOLEADVISEHOLDER *)((int)this + 0xc)), HVar1 < 0)) {
    return;
  }
  This = *(LPOLEADVISEHOLDER *)((int)this + 0xc);
  (*This->lpVtbl->Advise)(This,param_1,param_2);
  return;
}



// Function: FUN_676939ee at 676939ee

int __thiscall FUN_676939ee(void *this,int param_1)

{
  int *piVar1;
  int iVar2;
  BOOL BVar3;
  int *local_8;
  
                    /* WARNING: Load size is inaccurate */
  local_8 = (int *)0x0;
  (**(code **)(*this + 4))(&DAT_676bb620,&local_8);
  if ((**(int **)((int)this + 0x3c) != 0) &&
     (piVar1 = *(int **)((int)this + 0x10), piVar1 != (int *)0x0)) {
    (**(code **)(*piVar1 + 0x1c))(piVar1,0);
  }
  if (((*(byte *)((int)this + 0x44) & 4) == 0) ||
     (iVar2 = (**(code **)(*local_8 + 0x14))(local_8), -1 < iVar2)) {
    if ((HWND)**(undefined4 **)((int)this + 0x3c) != (HWND)0x0) {
      BVar3 = IsWindow((HWND)**(undefined4 **)((int)this + 0x3c));
      if (BVar3 != 0) {
        DestroyWindow((HWND)**(undefined4 **)((int)this + 0x3c));
      }
      **(undefined4 **)((int)this + 0x3c) = 0;
    }
    if (((param_1 == 0) || (param_1 == 2)) && ((*(byte *)((int)this + 0x44) & 0x80) != 0)) {
      piVar1 = *(int **)((int)this + 0x10);
      if (piVar1 != (int *)0x0) {
        (**(code **)(*piVar1 + 0xc))(piVar1);
      }
      FUN_67693aca((int)this);
    }
    piVar1 = *(int **)((int)this + 4);
    if (piVar1 != (int *)0x0) {
      *(undefined4 *)((int)this + 4) = 0;
      (**(code **)(*piVar1 + 8))(piVar1);
    }
    *(uint *)((int)this + 0x44) = *(uint *)((int)this + 0x44) & 0xffffffdc;
    piVar1 = *(int **)((int)this + 0x14);
    if (piVar1 != (int *)0x0) {
      *(undefined4 *)((int)this + 0x14) = 0;
      (**(code **)(*piVar1 + 8))(piVar1);
    }
    if (local_8 != (int *)0x0) {
      (**(code **)(*local_8 + 8))(local_8);
    }
    iVar2 = 0;
  }
  else if (local_8 != (int *)0x0) {
    (**(code **)(*local_8 + 8))(local_8);
  }
  return iVar2;
}



// Function: FUN_67693aca at 67693aca

undefined4 __fastcall FUN_67693aca(int param_1)

{
  int *piVar1;
  undefined4 uVar2;
  
  piVar1 = *(int **)(param_1 + 0xc);
  uVar2 = 0;
  if (piVar1 != (int *)0x0) {
    uVar2 = (**(code **)(*piVar1 + 0x1c))(piVar1);
  }
  return uVar2;
}



// Function: FUN_67693ada at 67693ada

undefined4 __fastcall FUN_67693ada(int *param_1)

{
  int *piVar1;
  BOOL BVar2;
  int *local_8;
  
  local_8 = (int *)0x0;
  (**(code **)(*param_1 + 4))(&DAT_676bb620,&local_8);
  if ((*(byte *)(param_1 + 0x11) & 4) != 0) {
    (**(code **)(*local_8 + 0x18))(local_8);
    param_1[0x11] = param_1[0x11] & 0xfffffffb;
    if (*(HWND *)param_1[0xf] != (HWND)0x0) {
      BVar2 = IsWindow(*(HWND *)param_1[0xf]);
      if (BVar2 != 0) {
        DestroyWindow(*(HWND *)param_1[0xf]);
      }
      *(undefined4 *)param_1[0xf] = 0;
    }
    piVar1 = (int *)param_1[1];
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 0x2c))(piVar1);
    }
  }
  if (local_8 != (int *)0x0) {
    (**(code **)(*local_8 + 8))(local_8);
  }
  return 0;
}



// Function: FUN_67693b4c at 67693b4c

undefined4 __fastcall FUN_67693b4c(int param_1)

{
  int iVar1;
  undefined4 local_44 [5];
  undefined1 local_30 [16];
  undefined1 local_20 [16];
  undefined1 local_10 [4];
  int *local_c;
  int *local_8;
  
  if ((*(uint *)(param_1 + 0x44) & 8) != 0) {
    *(uint *)(param_1 + 0x44) = *(uint *)(param_1 + 0x44) & 0xfffffff7;
    local_c = (int *)0x0;
    local_8 = (int *)0x0;
    local_44[0] = 0x14;
    iVar1 = (**(code **)(**(int **)(param_1 + 4) + 0xc))(*(int **)(param_1 + 4),local_10);
    if (iVar1 == 0) {
      (**(code **)(**(int **)(param_1 + 4) + 0x20))
                (*(int **)(param_1 + 4),&local_c,&local_8,local_30,local_20,local_44);
      if (local_8 != (int *)0x0) {
        (**(code **)(*local_8 + 0x20))(local_8,0,0);
      }
      if (local_c != (int *)0x0) {
        (**(code **)(*local_c + 0x20))(local_c,0,0);
      }
    }
    (**(code **)(**(int **)(param_1 + 4) + 0x28))(*(int **)(param_1 + 4),0);
    if (local_8 != (int *)0x0) {
      (**(code **)(*local_8 + 8))(local_8);
    }
    if (local_c != (int *)0x0) {
      (**(code **)(*local_c + 8))(local_c);
    }
  }
  return 0;
}



// Function: FUN_67693beb at 67693beb

void __fastcall FUN_67693beb(int param_1)

{
  int *piVar1;
  int *piVar2;
  
  if ((*(byte *)(param_1 + 0x14) & 2) != 0) {
    for (piVar2 = *(int **)(param_1 + 8); piVar2 != *(int **)(param_1 + 0xc); piVar2 = piVar2 + 2) {
      piVar1 = (int *)*piVar2;
      if (piVar1 != (int *)0x0) {
        (**(code **)(*piVar1 + 8))(piVar1);
      }
    }
    FUN_676b0bb3(*(undefined **)(param_1 + 8));
  }
  piVar2 = *(int **)(param_1 + 4);
  if (piVar2 != (int *)0x0) {
    (**(code **)(*piVar2 + 8))(piVar2);
  }
  return;
}



// Function: FUN_67693c27 at 67693c27

undefined4 __thiscall FUN_67693c27(void *this,RECT *param_1,RECT *param_2)

{
  void *pvVar1;
  BOOL BVar2;
  undefined4 uVar3;
  HRGN hRgn;
  tagRECT local_18;
  void *local_8;
  
  if ((param_1 == (RECT *)0x0) || (param_2 == (RECT *)0x0)) {
    uVar3 = 0x80004003;
  }
  else {
    *(LONG *)((int)this + 0x2c) = param_1->left;
    *(LONG *)((int)this + 0x30) = param_1->top;
    *(LONG *)((int)this + 0x34) = param_1->right;
    *(LONG *)((int)this + 0x38) = param_1->bottom;
    if (**(int **)((int)this + 0x3c) != 0) {
      hRgn = (HRGN)0x0;
      local_8 = this;
      BVar2 = IntersectRect(&local_18,param_1,param_2);
      if (BVar2 != 0) {
        BVar2 = EqualRect(&local_18,param_1);
        if (BVar2 == 0) {
          OffsetRect(&local_18,-param_1->left,-param_1->top);
          hRgn = CreateRectRgnIndirect(&local_18);
        }
      }
      pvVar1 = local_8;
      SetWindowRgn((HWND)**(undefined4 **)((int)local_8 + 0x3c),hRgn,1);
      SetWindowPos((HWND)**(undefined4 **)((int)pvVar1 + 0x3c),(HWND)0x0,param_1->left,param_1->top,
                   param_1->right - param_1->left,param_1->bottom - param_1->top,0x14);
    }
    uVar3 = 0;
  }
  return uVar3;
}



// Function: FUN_67693ce0 at 67693ce0

uint FUN_67693ce0(int param_1,uint param_2,int *param_3,uint *param_4)

{
  int *piVar1;
  uint uVar2;
  uint uVar3;
  bool bVar4;
  
  uVar2 = param_2;
  if ((param_3 == (int *)0x0) || ((param_2 != 1 && (param_4 == (uint *)0x0)))) {
    param_2 = 0x80004003;
  }
  else if (((*(int *)(param_1 + 8) == 0) || (*(int *)(param_1 + 0xc) == 0)) ||
          (*(int *)(param_1 + 0x10) == 0)) {
    param_2 = 0x80004005;
  }
  else {
    uVar3 = *(int *)(param_1 + 0xc) - *(int *)(param_1 + 0x10) >> 3;
    bVar4 = param_2 < uVar3;
    param_2 = (uint)(uVar3 < param_2);
    if (bVar4) {
      uVar3 = uVar2;
    }
    if (param_4 != (uint *)0x0) {
      *param_4 = uVar3;
    }
    for (; uVar3 != 0; uVar3 = uVar3 - 1) {
      piVar1 = *(int **)(param_1 + 0x10);
      *param_3 = *piVar1;
      param_3[1] = piVar1[1];
      if (*param_3 != 0) {
        (**(code **)(*(int *)*param_3 + 4))((int *)*param_3);
      }
      *(int *)(param_1 + 0x10) = *(int *)(param_1 + 0x10) + 8;
      param_3 = param_3 + 2;
    }
  }
  return param_2;
}



// Function: FUN_67693d77 at 67693d77

int __thiscall FUN_67693d77(void *this,int param_1,undefined4 *param_2)

{
  int iVar1;
  int iVar2;
  bool bVar3;
  
  if (param_1 == 1) {
    if (param_2 == (undefined4 *)0x0) {
      iVar1 = -0x7fffbffd;
    }
    else {
      iVar1 = _memcmp(param_2,(void *)((int)this + 0x1c),8);
      if ((*(byte *)((int)this + 0x45) & 2) == 0) {
        iVar2 = _memcmp(param_2,(undefined4 *)((int)this + 0x24),8);
        bVar3 = iVar2 != 0;
        if (bVar3) {
          *(undefined4 *)((int)this + 0x24) = *param_2;
          *(undefined4 *)((int)this + 0x28) = param_2[1];
        }
        if (((*(uint *)((int)this + 0x44) & 0x800) != 0) && (iVar1 != 0)) {
          bVar3 = true;
          *(undefined4 *)((int)this + 0x1c) = *param_2;
          *(undefined4 *)((int)this + 0x20) = param_2[1];
        }
        if (((*(uint *)((int)this + 0x44) & 0x400) != 0) && (bVar3)) {
          FUN_67693e3f(this,0);
          FUN_67694434((int)this);
        }
        iVar1 = 0;
      }
      else {
        iVar1 = (-(uint)(iVar1 == 0) & 0x7fffbffb) + 0x80004005;
      }
    }
  }
  else {
    iVar1 = -0x7ffbff95;
  }
  return iVar1;
}



// Function: FUN_67693e3f at 67693e3f

undefined4 __thiscall FUN_67693e3f(void *this,undefined4 param_1)

{
  int iVar1;
  undefined4 uVar2;
  int *local_8;
  
  uVar2 = 0;
  if (*(int *)((int)this + 8) != 0) {
                    /* WARNING: Load size is inaccurate */
    local_8 = (int *)0x0;
    iVar1 = (**(code **)(*this + 4))(&DAT_676bb5e0,&local_8);
    if (-1 < iVar1) {
      uVar2 = (**(code **)(**(int **)((int)this + 8) + 0x18))
                        (*(int **)((int)this + 8),local_8,0,param_1);
    }
    if (local_8 != (int *)0x0) {
      (**(code **)(*local_8 + 8))(local_8);
    }
  }
  return uVar2;
}



// Function: FUN_67693eb8 at 67693eb8

int FUN_67693eb8(int *param_1,undefined4 *param_2)

{
  bool bVar1;
  int *piVar2;
  undefined4 *puVar3;
  int **ppiVar4;
  int iVar5;
  
  puVar3 = param_2;
  bVar1 = false;
  iVar5 = -0x7fffbffd;
  if (param_2 != (undefined4 *)0x0) {
    *param_2 = 0;
    iVar5 = FUN_67694bda(&param_2);
    piVar2 = param_1;
    if (-1 < iVar5) {
      if ((*(byte *)(param_1 + 5) & 1) == 0) {
        ppiVar4 = (int **)(param_1 + 1);
      }
      else {
        if (param_1 != (int *)0x0) {
          (**(code **)(*piVar2 + 4))(piVar2);
        }
        bVar1 = true;
        ppiVar4 = &param_1;
      }
      iVar5 = FUN_67694028(param_2,(int *)piVar2[2],(int *)piVar2[3],*ppiVar4,0);
      if ((bVar1) && (param_1 != (int *)0x0)) {
        (**(code **)(*param_1 + 8))(param_1);
      }
      if (-1 < iVar5) {
        param_2[4] = piVar2[4];
        iVar5 = FUN_6768f4db((int)param_2,(int *)&PTR_DAT_676ba458,(int *)&DAT_676bb5c0,puVar3);
        if (-1 < iVar5) {
          return iVar5;
        }
      }
      puVar3 = param_2;
      if (param_2 != (undefined4 *)0x0) {
        FUN_676933d1(param_2);
        FUN_676b0bb3((undefined *)puVar3);
      }
    }
  }
  return iVar5;
}



// Function: FUN_67693f7a at 67693f7a

undefined4 __thiscall
FUN_67693f7a(void *this,int param_1,undefined4 param_2,uint *param_3,int param_4,undefined4 param_5,
            undefined4 param_6,int *param_7,undefined4 param_8)

{
  undefined4 uVar1;
  uint uVar2;
  undefined4 local_40;
  int local_3c;
  undefined4 local_38;
  int local_34;
  undefined4 local_30;
  undefined4 local_2c;
  int *local_28;
  undefined4 local_24;
  uint local_20;
  
  if (param_7 == (int *)0x0) {
    if ((*(byte *)((int)this + 0x44) & 2) == 0) {
      return 0x80070057;
    }
    param_7 = (int *)((int)this + 0x2c);
  }
  if (((param_1 == 1) || (param_1 == 0x10)) || (param_1 == 0x20)) {
    if (param_4 == 0) {
      param_5 = 0;
    }
    uVar2 = 0;
    if ((param_3 != (uint *)0x0) && (7 < *param_3)) {
      uVar2 = param_3[1] & 1;
    }
    _memset(&local_40,0,0x3c);
    local_3c = param_1;
    local_38 = param_2;
    local_34 = param_4;
    local_30 = param_5;
    local_2c = param_6;
    local_28 = param_7;
    local_24 = param_8;
                    /* WARNING: Load size is inaccurate */
    local_40 = 0x3c;
    local_20 = uVar2;
    uVar1 = (**(code **)(*this + 8))(&local_40);
  }
  else {
    uVar1 = 0x8004006b;
  }
  return uVar1;
}



// Function: FUN_67694028 at 67694028

undefined4 __thiscall FUN_67694028(void *this,int *param_1,int *param_2,int *param_3,int param_4)

{
  int *piVar1;
  void *pvVar2;
  uint uVar3;
  
  if (param_4 == 3) {
    uVar3 = ((int)param_2 - (int)param_1 >> 3) * 8;
    pvVar2 = operator_new(uVar3);
    *(void **)((int)this + 8) = pvVar2;
    *(void **)((int)this + 0x10) = pvVar2;
    if (pvVar2 == (void *)0x0) {
      return 0x8007000e;
    }
    for (; param_1 != param_2; param_1 = param_1 + 2) {
      piVar1 = *(int **)((int)this + 0x10);
      *piVar1 = *param_1;
      piVar1[1] = param_1[1];
      piVar1 = (int *)*piVar1;
      if (piVar1 != (int *)0x0) {
        (**(code **)(*piVar1 + 4))(piVar1);
      }
      *(int *)((int)this + 0x10) = *(int *)((int)this + 0x10) + 8;
    }
    *(uint *)((int)this + 0xc) = uVar3 + *(int *)((int)this + 8);
  }
  else {
    *(int **)((int)this + 8) = param_1;
    *(int **)((int)this + 0xc) = param_2;
  }
  FUN_6768fa93((int *)((int)this + 4),param_3);
  *(undefined4 *)((int)this + 0x10) = *(undefined4 *)((int)this + 8);
  *(int *)((int)this + 0x14) = param_4;
  return 0;
}



// Function: FUN_676940b8 at 676940b8

undefined4 __thiscall FUN_676940b8(void *this,int param_1,undefined4 *param_2)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  HMETAFILE hmf;
  HGLOBAL hMem;
  undefined4 *puVar4;
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  HDC local_4c;
  undefined4 *local_48;
  undefined4 *local_44;
  undefined4 local_40;
  uint local_38;
  undefined4 local_24;
  undefined4 local_20;
  int local_1c;
  int local_18;
  int local_14;
  int local_10;
  int local_c;
  int local_8;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar3 = 0x80004003;
  }
  else {
    _memset(param_2,0,0xc);
    if ((*(byte *)(param_1 + 0x10) & 0x20) == 0) {
      uVar3 = 0x80040064;
    }
    else {
      if ((*(uint *)((int)this + 0x44) & 0x1000) == 0) {
        local_c = *(int *)((int)this + 0x24);
        local_8 = *(int *)((int)this + 0x28);
      }
      else {
        local_c = *(int *)((int)this + 0x1c);
        local_8 = *(int *)((int)this + 0x20);
      }
      iVar1 = local_c;
      iVar2 = local_8;
      if ((*(uint *)((int)this + 0x44) & 0x2000) == 0) {
        FUN_67694233(&local_c,&local_14);
        iVar1 = local_14;
        iVar2 = local_10;
      }
      local_10 = iVar2;
      local_14 = iVar1;
      local_1c = local_14;
      local_18 = local_10;
      local_24 = 0;
      local_20 = 0;
      _memset(&local_60,0,0x3c);
      local_48 = &local_24;
      local_44 = &local_24;
      local_58 = 0xffffffff;
      local_60 = 0x3c;
      local_38 = *(uint *)((int)this + 0x44) >> 0xd & 1;
      local_5c = 1;
      local_54 = 0;
      local_50 = 0;
      local_40 = 1;
      local_4c = CreateMetaFileA((LPCSTR)0x0);
      SaveDC(local_4c);
      SetWindowOrgEx(local_4c,0,0,(LPPOINT)0x0);
      SetWindowExtEx(local_4c,local_1c,local_18,(LPSIZE)0x0);
                    /* WARNING: Load size is inaccurate */
      (**(code **)(*this + 8))(&local_60);
      RestoreDC(local_4c,-1);
      hmf = CloseMetaFile(local_4c);
      if (hmf == (HMETAFILE)0x0) {
        uVar3 = 0x8000ffff;
      }
      else {
        hMem = GlobalAlloc(0x2002,0x10);
        if (hMem == (HGLOBAL)0x0) {
          DeleteMetaFile(hmf);
          uVar3 = 0x80030070;
        }
        else {
          puVar4 = (undefined4 *)GlobalLock(hMem);
          puVar4[3] = hmf;
          *puVar4 = 8;
          puVar4[1] = local_c;
          puVar4[2] = local_8;
          GlobalUnlock(hMem);
          *param_2 = 0x20;
          param_2[1] = hMem;
          param_2[2] = 0;
          uVar3 = 0;
        }
      }
    }
  }
  return uVar3;
}



// Function: FUN_67694233 at 67694233

void FUN_67694233(int *param_1,int *param_2)

{
  HDC hdc;
  int iVar1;
  int iVar2;
  
  hdc = GetDC((HWND)0x0);
  iVar1 = GetDeviceCaps(hdc,0x58);
  iVar2 = GetDeviceCaps(hdc,0x5a);
  ReleaseDC((HWND)0x0,hdc);
  *param_2 = (*param_1 * iVar1 + 0x4f6) / 0x9ec;
  param_2[1] = (param_1[1] * iVar2 + 0x4f6) / 0x9ec;
  return;
}



// Function: FUN_67694296 at 67694296

int __thiscall FUN_67694296(void *this,int param_1)

{
  LPVOID *ppv;
  HRESULT HVar1;
  int iVar2;
  HANDLE pvVar3;
  undefined4 *lpMem;
  undefined4 *dwFlags;
  int *piVar4;
  int *piVar5;
  LPVOID pvVar6;
  LPVOID pvVar7;
  DWORD DVar8;
  SIZE_T SVar9;
  undefined4 local_8;
  
  if (param_1 == 0) {
    return 0;
  }
  EnterCriticalSection((LPCRITICAL_SECTION)((int)this + 4));
  ppv = (LPVOID *)((int)this + 0x28);
                    /* WARNING: Load size is inaccurate */
  if (((*(int *)((int)this + 0x28) != 0) ||
      (HVar1 = CoCreateInstance((IID *)&DAT_676bb4e0,(LPUNKNOWN)0x0,0x17,(IID *)&DAT_676bb5d0,ppv),
      -1 < HVar1)) &&
     (iVar2 = (**(code **)(**ppv + 0xc))(*ppv,param_1,&DAT_676baae8,&local_8), -1 < iVar2)) {
    if (*(int *)((int)this + 0x24) == 0) {
      *(int *)((int)this + 0x1c) = param_1;
      *(undefined4 *)((int)this + 0x20) = local_8;
      *(undefined4 *)((int)this + 0x24) = 1;
      goto LAB_67694422;
    }
    if (*(int *)((int)this + 0x24) == 1) {
      SVar9 = 0x10;
      DVar8 = 8;
      pvVar3 = GetProcessHeap();
      lpMem = (undefined4 *)HeapAlloc(pvVar3,DVar8,SVar9);
      if (lpMem != (undefined4 *)0x0) {
        SVar9 = 0x10;
        DVar8 = 8;
        pvVar3 = GetProcessHeap();
        dwFlags = (undefined4 *)HeapAlloc(pvVar3,DVar8,SVar9);
        if (dwFlags != (undefined4 *)0x0) {
          *lpMem = *(undefined4 *)((int)this + 0x1c);
          *(undefined4 **)((int)this + 0x1c) = lpMem;
          *dwFlags = *(undefined4 *)((int)this + 0x20);
          *(undefined4 **)((int)this + 0x20) = dwFlags;
          *(undefined4 *)((int)this + 0x24) = 4;
          goto LAB_6769437a;
        }
        pvVar3 = GetProcessHeap();
        HeapFree(pvVar3,(DWORD)dwFlags,lpMem);
      }
    }
    else {
LAB_6769437a:
      for (piVar4 = (int *)FUN_676922fc((int)this); piVar5 = (int *)FUN_6769238c((int)this),
          piVar4 < piVar5; piVar4 = piVar4 + 1) {
        if (*piVar4 == 0) {
          *piVar4 = param_1;
          iVar2 = FUN_676922fc((int)this);
          *(undefined4 *)(*(int *)((int)this + 0x20) + ((int)piVar4 - iVar2 >> 2) * 4) = local_8;
          goto LAB_67694422;
        }
      }
      iVar2 = *(int *)((int)this + 0x24) + 4;
      SVar9 = iVar2 * 4;
      pvVar6 = *(LPVOID *)((int)this + 0x1c);
      DVar8 = 8;
      pvVar3 = GetProcessHeap();
      pvVar6 = HeapReAlloc(pvVar3,DVar8,pvVar6,SVar9);
      if (pvVar6 != (LPVOID)0x0) {
        SVar9 = iVar2 * 4;
        pvVar7 = *(LPVOID *)((int)this + 0x20);
        DVar8 = 8;
        pvVar3 = GetProcessHeap();
        pvVar7 = HeapReAlloc(pvVar3,DVar8,pvVar7,SVar9);
        if (pvVar7 != (LPVOID)0x0) {
          *(LPVOID *)((int)this + 0x1c) = pvVar6;
          *(int *)((int)pvVar6 + *(int *)((int)this + 0x24) * 4) = param_1;
          *(LPVOID *)((int)this + 0x20) = pvVar7;
          *(undefined4 *)((int)pvVar7 + *(int *)((int)this + 0x24) * 4) = local_8;
          *(int *)((int)this + 0x24) = iVar2;
          goto LAB_67694422;
        }
      }
    }
                    /* WARNING: Load size is inaccurate */
    (**(code **)(**ppv + 0x10))(*ppv,local_8);
  }
  param_1 = 0;
LAB_67694422:
  LeaveCriticalSection((LPCRITICAL_SECTION)((int)this + 4));
  return param_1;
}



// Function: FUN_67694434 at 67694434

undefined4 __fastcall FUN_67694434(int param_1)

{
  int *piVar1;
  
  if ((*(byte *)(param_1 + 0x44) & 4) == 0) {
    piVar1 = *(int **)(param_1 + 0x14);
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 0x10))(piVar1,1,0xffffffff);
    }
  }
  else if ((HWND)**(undefined4 **)(param_1 + 0x3c) == (HWND)0x0) {
    piVar1 = *(int **)(param_1 + 4);
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 100))(piVar1,0,1);
    }
  }
  else {
    InvalidateRect((HWND)**(undefined4 **)(param_1 + 0x3c),(RECT *)0x0,1);
  }
  return 0;
}



// Function: FUN_67694477 at 67694477

undefined4 FUN_67694477(int param_1)

{
  LONG *pLVar1;
  HDC pHVar2;
  int iVar3;
  undefined4 uVar4;
  tagPOINT local_1c;
  LONG LStack_14;
  LONG LStack_10;
  uint local_c;
  int *local_8;
  
  local_c = 0;
  if (*(int *)(param_1 + 0x10) == 0) {
    pHVar2 = FUN_67694554(*(HDC *)(param_1 + 0x14),*(LPCSTR *)(param_1 + 0xc));
    *(HDC *)(param_1 + 0x10) = pHVar2;
    local_c = (uint)(pHVar2 != *(HDC *)(param_1 + 0x14));
  }
  pLVar1 = *(LONG **)(param_1 + 0x18);
  local_1c.x = *pLVar1;
  local_1c.y = pLVar1[1];
  LStack_14 = pLVar1[2];
  LStack_10 = pLVar1[3];
  iVar3 = GetDeviceCaps(*(HDC *)(param_1 + 0x14),2);
  if (iVar3 != 5) {
    LPtoDP(*(HDC *)(param_1 + 0x10),&local_1c,2);
    SaveDC(*(HDC *)(param_1 + 0x14));
    SetMapMode(*(HDC *)(param_1 + 0x14),1);
    SetWindowOrgEx(*(HDC *)(param_1 + 0x14),0,0,(LPPOINT)0x0);
    SetViewportOrgEx(*(HDC *)(param_1 + 0x14),0,0,(LPPOINT)0x0);
    *(undefined4 *)(param_1 + 0x20) = 1;
  }
  *(tagPOINT **)(param_1 + 0x18) = &local_1c;
  FUN_67694749(local_8,param_1);
  uVar4 = (**(code **)(*local_8 + 0xc))(param_1);
  if (local_c != 0) {
    DeleteDC(*(HDC *)(param_1 + 0x10));
  }
  if (iVar3 != 5) {
    RestoreDC(*(HDC *)(param_1 + 0x14),-1);
  }
  return uVar4;
}



// Function: FUN_67694554 at 67694554

HDC FUN_67694554(HDC param_1,LPCSTR param_2)

{
  int iVar1;
  HDC pHVar2;
  LPCWSTR lpString;
  LPCWSTR lpString_00;
  LPCWSTR pWVar3;
  LPCSTR pwszDriver;
  LPCWSTR lpString_01;
  DEVMODEA *local_10;
  LPCSTR local_c;
  
  if (param_2 == (LPCSTR)0x0) {
    if ((param_1 != (HDC)0x0) && (iVar1 = GetDeviceCaps(param_1,2), iVar1 != 5)) {
      return param_1;
    }
    local_10 = (DEVMODEA *)0x0;
    local_c = (LPCSTR)0x0;
    param_2 = (LPCSTR)0x0;
    pwszDriver = s__DISPLAY_676c1acf + 1;
  }
  else {
    if (*(ushort *)(param_2 + 10) == 0) {
      pWVar3 = (LPCWSTR)0x0;
    }
    else {
      pWVar3 = (LPCWSTR)(param_2 + *(ushort *)(param_2 + 10));
    }
    lpString = (LPCWSTR)(param_2 + *(ushort *)(param_2 + 4));
    lpString_01 = (LPCWSTR)(param_2 + *(ushort *)(param_2 + 8));
    lpString_00 = (LPCWSTR)(param_2 + *(ushort *)(param_2 + 6));
    if (pWVar3 == (LPCWSTR)0x0) {
      local_10 = (DEVMODEA *)0x0;
    }
    else {
      FUN_676b06a0();
      local_10 = (DEVMODEA *)FUN_676946af(&stack0xffffffe0,pWVar3);
    }
    if (lpString_01 == (LPCWSTR)0x0) {
      local_c = (LPCSTR)0x0;
    }
    else {
      local_c = &stack0xffffffe0;
      iVar1 = lstrlenW(lpString_01);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,lpString_01,-1,&stack0xffffffe0,iVar1 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0)
      ;
    }
    if (lpString_00 == (LPCWSTR)0x0) {
      param_2 = (LPCSTR)0x0;
    }
    else {
      param_2 = &stack0xffffffe0;
      iVar1 = lstrlenW(lpString_00);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,lpString_00,-1,&stack0xffffffe0,iVar1 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0)
      ;
    }
    if (lpString == (LPCWSTR)0x0) {
      pwszDriver = (LPCSTR)0x0;
    }
    else {
      pwszDriver = &stack0xffffffe0;
      iVar1 = lstrlenW(lpString);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,lpString,-1,&stack0xffffffe0,iVar1 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    }
  }
  pHVar2 = CreateDCA(pwszDriver,param_2,local_c,local_10);
  return pHVar2;
}



// Function: FUN_676946af at 676946af

LPSTR FUN_676946af(LPSTR param_1,LPCWSTR param_2)

{
  if (param_2 == (LPCWSTR)0x0) {
    param_1 = (LPSTR)0x0;
  }
  else {
    *param_1 = '\0';
    WideCharToMultiByte(0,0,param_2,-1,param_1,0x20,(LPCSTR)0x0,(LPBOOL)0x0);
    FUN_676b06d0((undefined4 *)(param_1 + 0x20),(undefined4 *)(param_2 + 0x20),0x26);
    param_1[0x46] = '\0';
    WideCharToMultiByte(0,0,param_2 + 0x33,-1,param_1 + 0x46,0x20,(LPCSTR)0x0,(LPBOOL)0x0);
    FUN_676b06d0((undefined4 *)(param_1 + 0x66),(undefined4 *)(param_2 + 0x53),0x36);
    if (param_2[0x23] != L'\0') {
      FUN_676b06d0((undefined4 *)(param_1 + 0x9c),(undefined4 *)(param_2 + 0x6e),
                   (uint)(ushort)param_2[0x23]);
    }
    param_1[0x24] = -100;
    param_1[0x25] = '\0';
  }
  return param_1;
}



// Function: FUN_67694749 at 67694749

void __thiscall FUN_67694749(void *this,int param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int local_c;
  int local_8;
  
  piVar1 = *(int **)(param_1 + 0x18);
  if ((*(byte *)((int)this + 0x45) & 0x10) == 0) {
    local_c = *(int *)((int)this + 0x24);
    local_8 = *(int *)((int)this + 0x28);
  }
  else {
    local_c = *(int *)((int)this + 0x1c);
    local_8 = *(int *)((int)this + 0x20);
  }
  if (*(int *)(param_1 + 0x28) == 0) {
    FUN_67694233(&local_c,&local_c);
  }
  iVar2 = piVar1[2] - *piVar1;
  iVar3 = piVar1[3] - piVar1[1];
  *(int *)(param_1 + 0x2c) = iVar2;
  *(int *)(param_1 + 0x30) = iVar3;
  *(int *)(param_1 + 0x34) = local_c;
  *(int *)(param_1 + 0x38) = local_8;
  if ((((local_c == 0) || (local_8 == 0)) || (iVar2 == 0)) || (iVar3 == 0)) {
    *(undefined4 *)(param_1 + 0x38) = 1;
    *(undefined4 *)(param_1 + 0x34) = 1;
    *(undefined4 *)(param_1 + 0x30) = 1;
    *(undefined4 *)(param_1 + 0x2c) = 1;
  }
  else if ((iVar2 != local_c) || (iVar3 != local_8)) {
    *(undefined4 *)(param_1 + 0x24) = 1;
    return;
  }
  *(undefined4 *)(param_1 + 0x24) = 0;
  return;
}



// Function: FUN_676947df at 676947df

undefined4 __thiscall FUN_676947df(void *this,int param_1)

{
  LPCRITICAL_SECTION lpCriticalSection;
  int *piVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  
  lpCriticalSection = (LPCRITICAL_SECTION)((int)this + 4);
  EnterCriticalSection(lpCriticalSection);
  if ((param_1 == 0) || (*(int *)((int)this + 0x24) == 0)) {
    LeaveCriticalSection(lpCriticalSection);
    return 0;
  }
  if (*(int *)((int)this + 0x24) == 1) {
    if (*(int *)((int)this + 0x1c) == param_1) {
      piVar1 = *(int **)((int)this + 0x28);
      if (piVar1 != (int *)0x0) {
        (**(code **)(*piVar1 + 0x10))(piVar1,*(undefined4 *)((int)this + 0x20));
      }
      *(undefined4 *)((int)this + 0x24) = 0;
      *(undefined4 *)((int)this + 0x20) = 0;
      *(undefined4 *)((int)this + 0x1c) = 0;
LAB_67694886:
      uVar5 = 1;
      goto LAB_6769488d;
    }
  }
  else {
    for (piVar1 = (int *)FUN_676922fc((int)this); piVar2 = (int *)FUN_6769238c((int)this),
        piVar1 < piVar2; piVar1 = piVar1 + 1) {
      if (*piVar1 == param_1) {
        if (*(int **)((int)this + 0x28) != (int *)0x0) {
          iVar4 = **(int **)((int)this + 0x28);
          iVar3 = FUN_676922fc((int)this);
          (**(code **)(iVar4 + 0x10))
                    (*(undefined4 *)((int)this + 0x28),
                     *(undefined4 *)(*(int *)((int)this + 0x20) + ((int)piVar1 - iVar3 >> 2) * 4));
        }
        *piVar1 = 0;
        iVar4 = FUN_676922fc((int)this);
        *(undefined4 *)(*(int *)((int)this + 0x20) + ((int)piVar1 - iVar4 >> 2) * 4) = 0;
        goto LAB_67694886;
      }
    }
  }
  uVar5 = 0;
LAB_6769488d:
  LeaveCriticalSection(lpCriticalSection);
  return uVar5;
}



// Function: FUN_676948ac at 676948ac

undefined4 __thiscall FUN_676948ac(void *this,undefined4 param_1,HDC param_2)

{
  tagPAINTSTRUCT local_90;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  HDC local_3c;
  tagRECT *local_38;
  tagRECT local_14;
  
  local_3c = param_2;
  if ((param_2 == (HDC)0x0) &&
     (local_3c = BeginPaint((HWND)**(undefined4 **)((int)this + 0x3c),&local_90),
     local_3c == (HDC)0x0)) {
    return 0;
  }
  GetClientRect((HWND)**(undefined4 **)((int)this + 0x3c),&local_14);
  _memset(&local_50,0,0x3c);
  local_48 = 0xffffffff;
  local_38 = &local_14;
                    /* WARNING: Load size is inaccurate */
  local_50 = 0x3c;
  local_4c = 1;
  (**(code **)(*this + 8))(&local_50);
  if (param_2 == (HDC)0x0) {
    EndPaint((HWND)**(undefined4 **)((int)this + 0x3c),&local_90);
  }
  return 0;
}



// Function: FUN_6769493d at 6769493d

undefined4 FUN_6769493d(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  
  uVar2 = 0x8007000e;
  puVar1 = (undefined4 *)operator_new(0x34);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    FUN_676914fc((int)puVar1);
    FUN_67691b41(puVar1 + 6);
    *puVar1 = &PTR_FUN_676ba41c;
    InterlockedIncrement(&DAT_676c559c);
  }
  if (puVar1 != (undefined4 *)0x0) {
    uVar2 = 0;
  }
  *param_1 = puVar1;
  return uVar2;
}



// Function: FUN_67694989 at 67694989

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined1 __thiscall FUN_67694989(void *this,HKEY__ param_1,char *param_2)

{
  undefined1 uVar1;
  bool bVar2;
  LPCWSTR lpString;
  char *pcVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined4 uVar6;
  void *this_00;
  undefined1 local_7c [48];
  undefined1 local_4c [32];
  undefined **local_2c [8];
  HKEY__ local_c;
  char local_5;
  
  local_5 = '\0';
  uVar1 = FUN_67694c26(this,param_1,&local_5);
  if (param_1.unused == 0) {
    if (DAT_676c5120 != 0) {
      *param_2 = DAT_676c5120 == 1;
      return 1;
    }
    local_c.unused = 0;
    bVar2 = FUN_67694b63(0,&local_c);
    if (((bVar2) && ((LPCWSTR)local_c.unused != (LPCWSTR)0x0)) && (iVar4 = Ordinal_7(), iVar4 != 0))
    {
      uVar1 = FUN_67694989(this_00,(HKEY__)&local_c,param_2);
    }
    else {
      *param_2 = local_5;
    }
  }
  else {
    lpString = (LPCWSTR)Ordinal_2();
    *param_2 = '\0';
    local_c.unused = (int)lpString;
    FUN_676abe64(local_7c);
    if (lpString == (LPCWSTR)0x0) {
      pcVar3 = (char *)0x0;
    }
    else {
      iVar4 = lstrlenW(lpString);
      FUN_676b06a0();
      pcVar3 = FUN_6768efcb(&stack0xffffff78,lpString,iVar4 * 2 + 2,0);
    }
    iVar4 = FUN_676abe87(local_7c,pcVar3,&DAT_676c519c,&DAT_676c51a0,&DAT_676c51a4,&DAT_676c1ad8,
                         &DAT_676c51a8,&DAT_676c51ac,(undefined8 *)&DAT_676c1ae0,
                         (undefined2 *)&DAT_676c51b0);
    if (((-1 < iVar4) && (DAT_676c519c == 2)) &&
       ((DAT_676c51a0 == '\x05' && (DAT_676c51a4 == '\0')))) {
      if ((DAT_676c1ad8 < 0) || (9 < DAT_676c1ad8)) {
        EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
        DAT_676c5120 = 2;
        LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
        *param_2 = '\0';
      }
      else {
        local_2c[0] = &PTR_LAB_676b9950;
        FUN_6767d089((int)local_2c);
        puVar5 = FUN_6768ef7c(local_4c,_DAT_676c1ae0);
        uVar6 = FUN_6767cfc1(local_2c,(int)puVar5);
        if ((char)uVar6 != '\0') {
          EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
          DAT_676c5120 = 1;
          LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
          *param_2 = '\x01';
        }
      }
    }
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
    if (DAT_676c5120 == 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      *param_2 = local_5;
    }
    else {
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      uVar1 = 1;
    }
    FUN_676abe86();
  }
  Ordinal_6();
  return uVar1;
}



// Function: FUN_67694b63 at 67694b63

bool __cdecl FUN_67694b63(undefined4 param_1,HKEY param_2)

{
  bool bVar1;
  int iVar2;
  LPWSTR pWVar3;
  CHAR local_13c [264];
  undefined1 local_34 [48];
  
  if (param_2 == (HKEY)0x0) {
    bVar1 = false;
  }
  else {
    param_2->unused = 0;
    FUN_676abe64(local_34);
    iVar2 = FUN_676abf6f((HKEY)0x2,5,0,local_13c,0x104,'\0','\x01');
    if (iVar2 < 0) {
      bVar1 = FUN_67694e00(param_1,param_2);
    }
    else {
      pWVar3 = FUN_67684ed6(local_13c,-1);
      param_2->unused = (int)pWVar3;
      bVar1 = pWVar3 != (LPWSTR)0x0;
    }
    FUN_676abe86();
  }
  return bVar1;
}



// Function: FUN_67694bda at 67694bda

undefined4 FUN_67694bda(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  
  uVar2 = 0x8007000e;
  puVar1 = (undefined4 *)operator_new(0x34);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    FUN_67693473((int)puVar1);
    FUN_67691b41(puVar1 + 6);
    *puVar1 = &PTR_LAB_676ba470;
    InterlockedIncrement(&DAT_676c559c);
  }
  if (puVar1 != (undefined4 *)0x0) {
    uVar2 = 0;
  }
  *param_1 = puVar1;
  return uVar2;
}



// Function: FUN_67694c26 at 67694c26

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined1 __thiscall FUN_67694c26(void *this,HKEY__ param_1,char *param_2)

{
  undefined1 uVar1;
  bool bVar2;
  LPCWSTR lpString;
  char *pcVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined4 uVar6;
  void *this_00;
  undefined1 local_7c [48];
  undefined1 local_4c [32];
  undefined **local_2c [8];
  HKEY__ local_c;
  char local_5;
  
  local_5 = '\0';
  uVar1 = FUN_67694e77(this,param_1,&local_5);
  if (param_1.unused == 0) {
    if (DAT_676c5124 != 0) {
      *param_2 = DAT_676c5124 == 1;
      return 1;
    }
    local_c.unused = 0;
    bVar2 = FUN_67694e00(0,&local_c);
    if (((bVar2) && ((LPCWSTR)local_c.unused != (LPCWSTR)0x0)) && (iVar4 = Ordinal_7(), iVar4 != 0))
    {
      uVar1 = FUN_67694c26(this_00,(HKEY__)&local_c,param_2);
    }
    else {
      *param_2 = local_5;
    }
  }
  else {
    lpString = (LPCWSTR)Ordinal_2();
    *param_2 = '\0';
    local_c.unused = (int)lpString;
    FUN_676abe64(local_7c);
    if (lpString == (LPCWSTR)0x0) {
      pcVar3 = (char *)0x0;
    }
    else {
      iVar4 = lstrlenW(lpString);
      FUN_676b06a0();
      pcVar3 = FUN_6768efcb(&stack0xffffff78,lpString,iVar4 * 2 + 2,0);
    }
    iVar4 = FUN_676abe87(local_7c,pcVar3,&DAT_676c51b4,&DAT_676c51b8,&DAT_676c51bc,&DAT_676c1ae8,
                         &DAT_676c51c0,&DAT_676c51c4,(undefined8 *)&DAT_676c1af0,
                         (undefined2 *)&DAT_676c51c8);
    if (((-1 < iVar4) && (DAT_676c51b4 == 1)) &&
       ((DAT_676c51b8 == '\x05' && (DAT_676c51bc == '\0')))) {
      if ((DAT_676c1ae8 < 0) || (9 < DAT_676c1ae8)) {
        EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
        DAT_676c5124 = 2;
        LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
        *param_2 = '\0';
      }
      else {
        local_2c[0] = &PTR_LAB_676b9950;
        FUN_6767d089((int)local_2c);
        puVar5 = FUN_6768ef7c(local_4c,_DAT_676c1af0);
        uVar6 = FUN_6767cfc1(local_2c,(int)puVar5);
        if ((char)uVar6 != '\0') {
          EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
          DAT_676c5124 = 1;
          LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
          *param_2 = '\x01';
        }
      }
    }
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
    if (DAT_676c5124 == 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      *param_2 = local_5;
    }
    else {
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      uVar1 = 1;
    }
    FUN_676abe86();
  }
  Ordinal_6();
  return uVar1;
}



// Function: FUN_67694e00 at 67694e00

bool __cdecl FUN_67694e00(undefined4 param_1,HKEY param_2)

{
  bool bVar1;
  int iVar2;
  LPWSTR pWVar3;
  CHAR local_13c [264];
  undefined1 local_34 [48];
  
  if (param_2 == (HKEY)0x0) {
    bVar1 = false;
  }
  else {
    param_2->unused = 0;
    FUN_676abe64(local_34);
    iVar2 = FUN_676abf6f((HKEY)0x1,5,0,local_13c,0x104,'\0','\x01');
    if (iVar2 < 0) {
      bVar1 = FUN_67695051(param_1,param_2);
    }
    else {
      pWVar3 = FUN_67684ed6(local_13c,-1);
      param_2->unused = (int)pWVar3;
      bVar1 = pWVar3 != (LPWSTR)0x0;
    }
    FUN_676abe86();
  }
  return bVar1;
}



// Function: FUN_67694e77 at 67694e77

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined1 __thiscall FUN_67694e77(void *this,HKEY__ param_1,char *param_2)

{
  undefined1 uVar1;
  bool bVar2;
  LPCWSTR lpString;
  char *pcVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined4 uVar6;
  void *this_00;
  undefined1 local_7c [48];
  undefined1 local_4c [32];
  undefined **local_2c [8];
  HKEY__ local_c;
  char local_5;
  
  local_5 = '\0';
  uVar1 = FUN_676950c8(this,param_1,&local_5);
  if (param_1.unused == 0) {
    if (DAT_676c5128 != 0) {
      *param_2 = DAT_676c5128 == 1;
      return 1;
    }
    local_c.unused = 0;
    bVar2 = FUN_67695051(0,&local_c);
    if (((bVar2) && ((LPCWSTR)local_c.unused != (LPCWSTR)0x0)) && (iVar4 = Ordinal_7(), iVar4 != 0))
    {
      uVar1 = FUN_67694e77(this_00,(HKEY__)&local_c,param_2);
    }
    else {
      *param_2 = local_5;
    }
  }
  else {
    lpString = (LPCWSTR)Ordinal_2();
    *param_2 = '\0';
    local_c.unused = (int)lpString;
    FUN_676abe64(local_7c);
    if (lpString == (LPCWSTR)0x0) {
      pcVar3 = (char *)0x0;
    }
    else {
      iVar4 = lstrlenW(lpString);
      FUN_676b06a0();
      pcVar3 = FUN_6768efcb(&stack0xffffff78,lpString,iVar4 * 2 + 2,0);
    }
    iVar4 = FUN_676abe87(local_7c,pcVar3,&DAT_676c51cc,&DAT_676c51d0,&DAT_676c51d4,&DAT_676c1af8,
                         &DAT_676c51d8,&DAT_676c51dc,(undefined8 *)&DAT_676c1b00,
                         (undefined2 *)&DAT_676c51e0);
    if (((-1 < iVar4) && (DAT_676c51cc == 2)) &&
       ((DAT_676c51d0 == '\x04' && (DAT_676c51d4 == '\x05')))) {
      if ((DAT_676c1af8 < 0) || (9 < DAT_676c1af8)) {
        EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
        DAT_676c5128 = 2;
        LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
        *param_2 = '\0';
      }
      else {
        local_2c[0] = &PTR_LAB_676b9950;
        FUN_6767d089((int)local_2c);
        puVar5 = FUN_6768ef7c(local_4c,_DAT_676c1b00);
        uVar6 = FUN_6767cfc1(local_2c,(int)puVar5);
        if ((char)uVar6 != '\0') {
          EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
          DAT_676c5128 = 1;
          LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
          *param_2 = '\x01';
        }
      }
    }
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
    if (DAT_676c5128 == 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      *param_2 = local_5;
    }
    else {
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      uVar1 = 1;
    }
    FUN_676abe86();
  }
  Ordinal_6();
  return uVar1;
}



// Function: FUN_67695051 at 67695051

bool __cdecl FUN_67695051(undefined4 param_1,HKEY param_2)

{
  bool bVar1;
  int iVar2;
  LPWSTR pWVar3;
  CHAR local_13c [264];
  undefined1 local_34 [48];
  
  if (param_2 == (HKEY)0x0) {
    bVar1 = false;
  }
  else {
    param_2->unused = 0;
    FUN_676abe64(local_34);
    iVar2 = FUN_676abf6f((HKEY)0x2,4,5,local_13c,0x104,'\0','\x01');
    if (iVar2 < 0) {
      bVar1 = FUN_676952a2(param_1,param_2);
    }
    else {
      pWVar3 = FUN_67684ed6(local_13c,-1);
      param_2->unused = (int)pWVar3;
      bVar1 = pWVar3 != (LPWSTR)0x0;
    }
    FUN_676abe86();
  }
  return bVar1;
}



// Function: FUN_676950c8 at 676950c8

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined1 __thiscall FUN_676950c8(void *this,HKEY__ param_1,char *param_2)

{
  undefined1 uVar1;
  bool bVar2;
  LPCWSTR lpString;
  char *pcVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined4 uVar6;
  void *this_00;
  undefined1 local_7c [48];
  undefined1 local_4c [32];
  undefined **local_2c [8];
  HKEY__ local_c;
  char local_5;
  
  local_5 = '\0';
  uVar1 = FUN_67695319(this,param_1,&local_5);
  if (param_1.unused == 0) {
    if (DAT_676c512c != 0) {
      *param_2 = DAT_676c512c == 1;
      return 1;
    }
    local_c.unused = 0;
    bVar2 = FUN_676952a2(0,&local_c);
    if (((bVar2) && ((LPCWSTR)local_c.unused != (LPCWSTR)0x0)) && (iVar4 = Ordinal_7(), iVar4 != 0))
    {
      uVar1 = FUN_676950c8(this_00,(HKEY__)&local_c,param_2);
    }
    else {
      *param_2 = local_5;
    }
  }
  else {
    lpString = (LPCWSTR)Ordinal_2();
    *param_2 = '\0';
    local_c.unused = (int)lpString;
    FUN_676abe64(local_7c);
    if (lpString == (LPCWSTR)0x0) {
      pcVar3 = (char *)0x0;
    }
    else {
      iVar4 = lstrlenW(lpString);
      FUN_676b06a0();
      pcVar3 = FUN_6768efcb(&stack0xffffff78,lpString,iVar4 * 2 + 2,0);
    }
    iVar4 = FUN_676abe87(local_7c,pcVar3,&DAT_676c51e4,&DAT_676c51e8,&DAT_676c51ec,&DAT_676c1b08,
                         &DAT_676c51f0,&DAT_676c51f4,(undefined8 *)&DAT_676c1b10,
                         (undefined2 *)&DAT_676c51f8);
    if (((-1 < iVar4) && (DAT_676c51e4 == 1)) &&
       ((DAT_676c51e8 == '\x04' && (DAT_676c51ec == '\x05')))) {
      if ((DAT_676c1b08 < 0) || (9 < DAT_676c1b08)) {
        EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
        DAT_676c512c = 2;
        LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
        *param_2 = '\0';
      }
      else {
        local_2c[0] = &PTR_LAB_676b9950;
        FUN_6767d089((int)local_2c);
        puVar5 = FUN_6768ef7c(local_4c,_DAT_676c1b10);
        uVar6 = FUN_6767cfc1(local_2c,(int)puVar5);
        if ((char)uVar6 != '\0') {
          EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
          DAT_676c512c = 1;
          LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
          *param_2 = '\x01';
        }
      }
    }
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
    if (DAT_676c512c == 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      *param_2 = local_5;
    }
    else {
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      uVar1 = 1;
    }
    FUN_676abe86();
  }
  Ordinal_6();
  return uVar1;
}



// Function: FUN_676952a2 at 676952a2

bool __cdecl FUN_676952a2(undefined4 param_1,HKEY param_2)

{
  bool bVar1;
  int iVar2;
  LPWSTR pWVar3;
  CHAR local_13c [264];
  undefined1 local_34 [48];
  
  if (param_2 == (HKEY)0x0) {
    bVar1 = false;
  }
  else {
    param_2->unused = 0;
    FUN_676abe64(local_34);
    iVar2 = FUN_676abf6f((HKEY)0x1,4,5,local_13c,0x104,'\0','\x01');
    if (iVar2 < 0) {
      bVar1 = FUN_67695401(param_1,param_2);
    }
    else {
      pWVar3 = FUN_67684ed6(local_13c,-1);
      param_2->unused = (int)pWVar3;
      bVar1 = pWVar3 != (LPWSTR)0x0;
    }
    FUN_676abe86();
  }
  return bVar1;
}



// Function: FUN_67695319 at 67695319

undefined1 __thiscall FUN_67695319(void *this,HKEY__ param_1,char *param_2)

{
  undefined1 uVar1;
  bool bVar2;
  undefined4 uVar3;
  int iVar4;
  void *this_00;
  HKEY__ local_c;
  undefined4 uStack_8;
  
  uStack_8 = (uint)this & 0xffffff;
  local_c.unused = (int)this;
  uVar1 = FUN_676954ba(this,param_1,(char *)((int)&uStack_8 + 3));
  if (param_1.unused == 0) {
    if (DAT_676c5130 != 0) {
      *param_2 = DAT_676c5130 == 1;
      return 1;
    }
    local_c.unused = 0;
    bVar2 = FUN_67695401(0,&local_c);
    if (((bVar2) && (local_c.unused != 0)) && (iVar4 = Ordinal_7(local_c.unused), iVar4 != 0)) {
      uVar1 = FUN_67695319(this_00,(HKEY__)&local_c,param_2);
    }
    else {
      *param_2 = uStack_8._3_1_;
    }
  }
  else {
    local_c.unused = Ordinal_2(*(undefined4 *)param_1.unused);
    *param_2 = '\0';
    uVar3 = FUN_676ac7bc((uint *)&local_c,(byte *)(s__Copyright__c__2000_676c1b17 + 1),3,2,param_2);
    if ((char)uVar3 == '\0') {
      *param_2 = uStack_8._3_1_;
    }
    else {
      EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      DAT_676c5130 = (*param_2 == '\0') + 1;
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      uVar1 = 1;
    }
  }
  Ordinal_6(local_c.unused);
  return uVar1;
}



// Function: FUN_67695401 at 67695401

bool __cdecl FUN_67695401(undefined4 param_1,HKEY param_2)

{
  HKEY pHVar1;
  bool bVar2;
  LSTATUS LVar3;
  LPWSTR pWVar4;
  CHAR local_a4 [100];
  BYTE local_40 [52];
  DWORD local_c;
  DWORD local_8;
  
  pHVar1 = param_2;
  if (param_2 == (HKEY)0x0) {
    bVar2 = false;
  }
  else {
    param_2->unused = 0;
    wsprintfA(local_a4,s_Licenses__s_676c1b2c,s_414BA510_C70D_11d4_BFF5_0060082A_676c1b38);
    LVar3 = RegOpenKeyExA((HKEY)0x80000000,local_a4,0,0x20019,&param_2);
    if (LVar3 == 0) {
      local_c = 0x32;
      LVar3 = RegQueryValueExA(param_2,(LPCSTR)0x0,(LPDWORD)0x0,&local_8,local_40,&local_c);
      if (LVar3 == 0) {
        RegCloseKey(param_2);
        if (local_8 == 1) {
          pWVar4 = FUN_67684ed6((LPCSTR)local_40,-1);
          pHVar1->unused = (int)pWVar4;
          return pWVar4 != (LPWSTR)0x0;
        }
      }
      else {
        RegCloseKey(param_2);
      }
    }
    bVar2 = FUN_676955a2(param_1,pHVar1);
  }
  return bVar2;
}



// Function: FUN_676954ba at 676954ba

undefined1 __thiscall FUN_676954ba(void *this,HKEY__ param_1,char *param_2)

{
  undefined1 uVar1;
  bool bVar2;
  undefined4 uVar3;
  int iVar4;
  void *this_00;
  HKEY__ local_c;
  undefined4 uStack_8;
  
  uStack_8 = (uint)this & 0xffffff;
  local_c.unused = (int)this;
  uVar1 = FUN_6769565b(this,param_1,(char *)((int)&uStack_8 + 3));
  if (param_1.unused == 0) {
    if (DAT_676c5134 != 0) {
      *param_2 = DAT_676c5134 == 1;
      return 1;
    }
    local_c.unused = 0;
    bVar2 = FUN_676955a2(0,&local_c);
    if (((bVar2) && (local_c.unused != 0)) && (iVar4 = Ordinal_7(local_c.unused), iVar4 != 0)) {
      uVar1 = FUN_676954ba(this_00,(HKEY__)&local_c,param_2);
    }
    else {
      *param_2 = uStack_8._3_1_;
    }
  }
  else {
    local_c.unused = Ordinal_2(*(undefined4 *)param_1.unused);
    *param_2 = '\0';
    uVar3 = FUN_676ac7bc((uint *)&local_c,(byte *)(s__Copyright__c__2000_676c1b17 + 1),3,1,param_2);
    if ((char)uVar3 == '\0') {
      *param_2 = uStack_8._3_1_;
    }
    else {
      EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      DAT_676c5134 = (*param_2 == '\0') + 1;
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      uVar1 = 1;
    }
  }
  Ordinal_6(local_c.unused);
  return uVar1;
}



// Function: FUN_676955a2 at 676955a2

bool __cdecl FUN_676955a2(undefined4 param_1,HKEY param_2)

{
  HKEY pHVar1;
  bool bVar2;
  LSTATUS LVar3;
  LPWSTR pWVar4;
  CHAR local_a4 [100];
  BYTE local_40 [52];
  DWORD local_c;
  DWORD local_8;
  
  pHVar1 = param_2;
  if (param_2 == (HKEY)0x0) {
    bVar2 = false;
  }
  else {
    param_2->unused = 0;
    wsprintfA(local_a4,s_Licenses__s_676c1b2c,s_414BA510_C70D_11d4_BFF5_0060082A_676c1b38);
    LVar3 = RegOpenKeyExA((HKEY)0x80000000,local_a4,0,0x20019,&param_2);
    if (LVar3 == 0) {
      local_c = 0x32;
      LVar3 = RegQueryValueExA(param_2,(LPCSTR)0x0,(LPDWORD)0x0,&local_8,local_40,&local_c);
      if (LVar3 == 0) {
        RegCloseKey(param_2);
        if (local_8 == 1) {
          pWVar4 = FUN_67684ed6((LPCSTR)local_40,-1);
          pHVar1->unused = (int)pWVar4;
          return pWVar4 != (LPWSTR)0x0;
        }
      }
      else {
        RegCloseKey(param_2);
      }
    }
    bVar2 = FUN_67695743(param_1,pHVar1);
  }
  return bVar2;
}



// Function: FUN_6769565b at 6769565b

undefined1 __thiscall FUN_6769565b(void *this,HKEY__ param_1,char *param_2)

{
  undefined1 uVar1;
  bool bVar2;
  undefined4 uVar3;
  int iVar4;
  void *this_00;
  HKEY__ local_c;
  undefined4 uStack_8;
  
  uStack_8 = (uint)this & 0xffffff;
  local_c.unused = (int)this;
  uVar1 = FUN_676957fc(param_1,(char *)((int)&uStack_8 + 3));
  if (param_1.unused == 0) {
    if (DAT_676c5138 != 0) {
      *param_2 = DAT_676c5138 == 1;
      return 1;
    }
    local_c.unused = 0;
    bVar2 = FUN_67695743(0,&local_c);
    if (((bVar2) && (local_c.unused != 0)) && (iVar4 = Ordinal_7(local_c.unused), iVar4 != 0)) {
      uVar1 = FUN_6769565b(this_00,(HKEY__)&local_c,param_2);
    }
    else {
      *param_2 = uStack_8._3_1_;
    }
  }
  else {
    local_c.unused = Ordinal_2(*(undefined4 *)param_1.unused);
    *param_2 = '\0';
    uVar3 = FUN_676ac7bc((uint *)&local_c,(byte *)s_Xceed_Software_Inc__676c1b60,3,2,param_2);
    if ((char)uVar3 == '\0') {
      *param_2 = uStack_8._3_1_;
    }
    else {
      EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      DAT_676c5138 = (*param_2 == '\0') + 1;
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      uVar1 = 1;
    }
  }
  Ordinal_6(local_c.unused);
  return uVar1;
}



// Function: FUN_67695743 at 67695743

bool __cdecl FUN_67695743(undefined4 param_1,HKEY param_2)

{
  HKEY pHVar1;
  bool bVar2;
  LSTATUS LVar3;
  LPWSTR pWVar4;
  CHAR local_a4 [100];
  BYTE local_40 [52];
  DWORD local_c;
  DWORD local_8;
  
  pHVar1 = param_2;
  if (param_2 == (HKEY)0x0) {
    bVar2 = false;
  }
  else {
    param_2->unused = 0;
    wsprintfA(local_a4,s_Licenses__s_676c1b2c,s_423FAB50_BB80_11d2_A5A7_00105A9C_676c1b74);
    LVar3 = RegOpenKeyExA((HKEY)0x80000000,local_a4,0,0x20019,&param_2);
    if (LVar3 == 0) {
      local_c = 0x32;
      LVar3 = RegQueryValueExA(param_2,(LPCSTR)0x0,(LPDWORD)0x0,&local_8,local_40,&local_c);
      if (LVar3 == 0) {
        RegCloseKey(param_2);
        if (local_8 == 1) {
          pWVar4 = FUN_67684ed6((LPCSTR)local_40,-1);
          pHVar1->unused = (int)pWVar4;
          return pWVar4 != (LPWSTR)0x0;
        }
      }
      else {
        RegCloseKey(param_2);
      }
    }
    bVar2 = FUN_676958cc(param_1,pHVar1);
  }
  return bVar2;
}



// Function: FUN_676957fc at 676957fc

undefined1 __cdecl FUN_676957fc(HKEY__ param_1,char *param_2)

{
  undefined1 uVar1;
  undefined4 uVar2;
  int iVar3;
  bool bVar4;
  
  uVar1 = 0;
  if (param_1.unused != 0) {
    param_1.unused = Ordinal_2(*(undefined4 *)param_1.unused);
    *param_2 = '\0';
    uVar2 = FUN_676ac7bc((uint *)&param_1,(byte *)s_Xceed_Software_Inc__676c1b60,3,1,param_2);
    bVar4 = (char)uVar2 == '\0';
    if (bVar4) {
      *param_2 = '\0';
    }
    else {
      EnterCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
      DAT_676c513c = (*param_2 == '\0') + 1;
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
    }
    Ordinal_6(param_1.unused);
    return !bVar4;
  }
  if (DAT_676c513c == 0) {
    param_1.unused = 0;
    bVar4 = FUN_676958cc(0,&param_1);
    if (((bVar4) && (param_1.unused != 0)) && (iVar3 = Ordinal_7(param_1.unused), iVar3 != 0)) {
      uVar1 = FUN_676957fc((HKEY__)&param_1,param_2);
    }
    else {
      *param_2 = '\0';
    }
    Ordinal_6(param_1.unused);
    return uVar1;
  }
  *param_2 = DAT_676c513c == 1;
  return 1;
}



// Function: FUN_676958cc at 676958cc

bool __cdecl FUN_676958cc(undefined4 param_1,HKEY param_2)

{
  HKEY pHVar1;
  LSTATUS LVar2;
  LPWSTR pWVar3;
  CHAR local_a4 [100];
  BYTE local_40 [52];
  DWORD local_c;
  DWORD local_8;
  
  pHVar1 = param_2;
  if (param_2 != (HKEY)0x0) {
    param_2->unused = 0;
    wsprintfA(local_a4,s_Licenses__s_676c1b2c,s_423FAB50_BB80_11d2_A5A7_00105A9C_676c1b74);
    LVar2 = RegOpenKeyExA((HKEY)0x80000000,local_a4,0,0x20019,&param_2);
    if (LVar2 == 0) {
      local_c = 0x32;
      LVar2 = RegQueryValueExA(param_2,(LPCSTR)0x0,(LPDWORD)0x0,&local_8,local_40,&local_c);
      if (LVar2 == 0) {
        RegCloseKey(param_2);
        if (local_8 == 1) {
          pWVar3 = FUN_67684ed6((LPCSTR)local_40,-1);
          pHVar1->unused = (int)pWVar3;
          return pWVar3 != (LPWSTR)0x0;
        }
      }
      else {
        RegCloseKey(param_2);
      }
    }
  }
  return false;
}



// Function: FUN_67695d32 at 67695d32

uint __cdecl FUN_67695d32(uint param_1,undefined4 param_2,short *param_3)

{
  uint uVar1;
  short *unaff_retaddr;
  
  uVar1 = Ordinal_7(param_3);
  if ((uVar1 < param_1) && (unaff_retaddr != (short *)0x0)) {
    if (param_3 == (short *)0x0) {
      uVar1 = 0;
    }
    else {
      FUN_676ae229(unaff_retaddr,param_3,uVar1);
    }
    unaff_retaddr[uVar1] = 0;
  }
  else {
    *unaff_retaddr = 0;
  }
  if (param_3 != (short *)0x0) {
    Ordinal_6(param_3);
  }
  return uVar1;
}



// Function: FUN_67695d7f at 67695d7f

uint __cdecl FUN_67695d7f(LPSTR param_1,uint param_2,LPCWSTR param_3)

{
  uint uVar1;
  int iVar2;
  LPCWSTR pWStack_18;
  
  pWStack_18 = param_3;
  uVar1 = Ordinal_7();
  if (((uVar1 < param_2) && (param_1 != (LPSTR)0x0)) && (param_3 != (LPCWSTR)0x0)) {
    iVar2 = lstrlenW(param_3);
    FUN_676b06a0();
    pWStack_18 = (LPCWSTR)((uint)pWStack_18 & 0xffffff00);
    WideCharToMultiByte(0,0,param_3,-1,(LPSTR)&pWStack_18,iVar2 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    lstrcpynA(param_1,(LPCSTR)&pWStack_18,uVar1 + 1);
  }
  else {
    *param_1 = '\0';
  }
  if (param_3 != (LPCWSTR)0x0) {
    Ordinal_6(param_3);
  }
  return uVar1;
}



// Function: FUN_67695dff at 67695dff

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_67695dff(void)

{
  _g_xzFunctions = XceedZipInitDLL;
  _DAT_676c5204 = XceedZipShutdownDLL;
  _DAT_676c5208 = XzCreateXceedZipW;
  _DAT_676c520c = XzCreateXceedZipA;
  _DAT_676c5210 = XzDestroyXceedZip;
  _DAT_676c5218 = XcCreateXceedCompressionA;
  _DAT_676c5214 = XcCreateXceedCompressionW;
  _DAT_676c521c = XcDestroyXceedCompression;
  _DAT_676c5220 = XzSetXceedZipCallback;
  _DAT_676c5224 = XzSetXceedZipWindow;
  _DAT_676c5228 = XzAlloc;
  _DAT_676c522c = XzFree;
  _DAT_676c5230 = XzGetAbort;
  _DAT_676c5234 = XzSetAbort;
  _DAT_676c5238 = XzGetBackgroundProcessing;
  _DAT_676c523c = XzSetBackgroundProcessing;
  _DAT_676c5240 = XzGetBasePathW;
  _DAT_676c5244 = XzGetBasePathA;
  _DAT_676c5248 = XzSetBasePathW;
  _DAT_676c524c = XzSetBasePathA;
  _DAT_676c5250 = XzGetCompressionLevel;
  _DAT_676c5254 = XzSetCompressionLevel;
  _DAT_676c5258 = XzGetCurrentOperation;
  _DAT_676c525c = XzGetEncryptionPasswordW;
  _DAT_676c5260 = XzGetEncryptionPasswordA;
  _DAT_676c5264 = XzSetEncryptionPasswordW;
  _DAT_676c5268 = XzSetEncryptionPasswordA;
  _DAT_676c526c = XzGetExcludedFileAttributes;
  _DAT_676c5270 = XzSetExcludedFileAttributes;
  _DAT_676c5274 = XzGetExtraHeaders;
  _DAT_676c5278 = XzSetExtraHeaders;
  _DAT_676c527c = XzGetFilesToExcludeW;
  _DAT_676c5280 = XzGetFilesToExcludeA;
  _DAT_676c5284 = XzSetFilesToExcludeW;
  _DAT_676c5288 = XzSetFilesToExcludeA;
  _DAT_676c528c = XzGetFilesToProcessW;
  _DAT_676c5290 = XzGetFilesToProcessA;
  _DAT_676c5294 = XzSetFilesToProcessW;
  _DAT_676c5298 = XzSetFilesToProcessA;
  _DAT_676c529c = XzGetMaxDateToProcess;
  _DAT_676c52a0 = XzSetMaxDateToProcess;
  _DAT_676c52a4 = XzGetMaxSizeToProcess;
  _DAT_676c52a8 = XzSetMaxSizeToProcess;
  _DAT_676c52ac = XzGetMinDateToProcess;
  _DAT_676c52b0 = XzSetMinDateToProcess;
  _DAT_676c52b4 = XzGetMinSizeToProcess;
  _DAT_676c52b8 = XzSetMinSizeToProcess;
  _DAT_676c52bc = XzGetPreservePaths;
  _DAT_676c52c0 = XzSetPreservePaths;
  _DAT_676c52c4 = XzGetProcessSubfolders;
  _DAT_676c52c8 = XzSetProcessSubfolders;
  _DAT_676c52cc = XzGetRequiredFileAttributes;
  _DAT_676c52d0 = XzSetRequiredFileAttributes;
  _DAT_676c52d4 = XzGetSfxBinaryModuleW;
  _DAT_676c52d8 = XzGetSfxBinaryModuleA;
  _DAT_676c52dc = XzSetSfxBinaryModuleW;
  _DAT_676c52e0 = XzSetSfxBinaryModuleA;
  _DAT_676c52e4 = XzGetSfxButtonsW;
  _DAT_676c52e8 = XzGetSfxButtonsA;
  _DAT_676c52ec = XzSetSfxButtonsW;
  _DAT_676c52f0 = XzSetSfxButtonsA;
  _DAT_676c52f4 = XzGetSfxDefaultPasswordW;
  _DAT_676c52f8 = XzGetSfxDefaultPasswordA;
  _DAT_676c52fc = XzSetSfxDefaultPasswordW;
  _DAT_676c5300 = XzSetSfxDefaultPasswordA;
  _DAT_676c5304 = XzGetSfxDefaultUnzipToFolderW;
  _DAT_676c5308 = XzGetSfxDefaultUnzipToFolderA;
  _DAT_676c530c = XzSetSfxDefaultUnzipToFolderW;
  _DAT_676c5310 = XzSetSfxDefaultUnzipToFolderA;
  _DAT_676c5314 = XzGetSfxExistingFileBehavior;
  _DAT_676c5318 = XzSetSfxExistingFileBehavior;
  _DAT_676c531c = XzGetSfxExtensionsToAssociateW;
  _DAT_676c5320 = XzGetSfxExtensionsToAssociateA;
  _DAT_676c5324 = XzSetSfxExtensionsToAssociateW;
  _DAT_676c5328 = XzSetSfxExtensionsToAssociateA;
  _DAT_676c532c = XzGetSfxExecuteAfterW;
  _DAT_676c5330 = XzGetSfxExecuteAfterA;
  _DAT_676c5334 = XzSetSfxExecuteAfterW;
  _DAT_676c5338 = XzSetSfxExecuteAfterA;
  _DAT_676c533c = XzGetSfxIconFilenameW;
  _DAT_676c5340 = XzGetSfxIconFilenameA;
  _DAT_676c5344 = XzSetSfxIconFilenameW;
  _DAT_676c5348 = XzSetSfxIconFilenameA;
  _DAT_676c534c = XzGetSfxInstallMode;
  _DAT_676c5350 = XzSetSfxInstallMode;
  _DAT_676c5354 = XzGetSfxMessagesW;
  _DAT_676c5358 = XzGetSfxMessagesA;
  _DAT_676c535c = XzSetSfxMessagesW;
  _DAT_676c5360 = XzSetSfxMessagesA;
  _DAT_676c5364 = XzGetSfxProgramGroupW;
  _DAT_676c5368 = XzGetSfxProgramGroupA;
  _DAT_676c536c = XzSetSfxProgramGroupW;
  _DAT_676c5370 = XzSetSfxProgramGroupA;
  _DAT_676c5374 = XzGetSfxProgramGroupItemsW;
  _DAT_676c5378 = XzGetSfxProgramGroupItemsA;
  _DAT_676c537c = XzSetSfxProgramGroupItemsW;
  _DAT_676c5380 = XzSetSfxProgramGroupItemsA;
  _DAT_676c5384 = XzGetSfxReadmeFileW;
  _DAT_676c5388 = XzGetSfxReadmeFileA;
  _DAT_676c538c = XzSetSfxReadmeFileW;
  _DAT_676c5390 = XzSetSfxReadmeFileA;
  _DAT_676c5394 = XzGetSfxStringsW;
  _DAT_676c5398 = XzGetSfxStringsA;
  _DAT_676c539c = XzSetSfxStringsW;
  _DAT_676c53a0 = XzSetSfxStringsA;
  _DAT_676c53a4 = XzGetSkipIfExisting;
  _DAT_676c53a8 = XzSetSkipIfExisting;
  _DAT_676c53ac = XzGetSkipIfNotExisting;
  _DAT_676c53b0 = XzSetSkipIfNotExisting;
  _DAT_676c53b4 = XzGetSkipIfOlderDate;
  _DAT_676c53b8 = XzSetSkipIfOlderDate;
  _DAT_676c53bc = XzGetSkipIfOlderVersion;
  _DAT_676c53c0 = XzSetSkipIfOlderVersion;
  _DAT_676c53c4 = XzGetSpanMultipleDisks;
  _DAT_676c53c8 = XzSetSpanMultipleDisks;
  _DAT_676c53cc = XzGetSplitSize;
  _DAT_676c53d0 = XzSetSplitSize;
  _DAT_676c53d4 = XzGetTempFolderW;
  _DAT_676c53d8 = XzGetTempFolderA;
  _DAT_676c53dc = XzSetTempFolderW;
  _DAT_676c53e0 = XzSetTempFolderA;
  _DAT_676c53e4 = XzGetUnzipToFolderW;
  _DAT_676c53e8 = XzGetUnzipToFolderA;
  _DAT_676c53ec = XzSetUnzipToFolderW;
  _DAT_676c53f0 = XzSetUnzipToFolderA;
  _DAT_676c53f4 = XzGetUseTempFile;
  _DAT_676c53f8 = XzSetUseTempFile;
  _DAT_676c53fc = XzGetZipFilenameW;
  _DAT_676c5400 = XzGetZipFilenameA;
  _DAT_676c5404 = XzSetZipFilenameW;
  _DAT_676c5408 = XzSetZipFilenameA;
  _DAT_676c540c = XzGetZipOpenedFiles;
  _DAT_676c5410 = XzSetZipOpenedFiles;
  _DAT_676c5414 = XcGetEncryptionPasswordW;
  _DAT_676c5418 = XcGetEncryptionPasswordA;
  _DAT_676c541c = XcSetEncryptionPasswordW;
  _DAT_676c5420 = XcSetEncryptionPasswordA;
  _DAT_676c5424 = XcGetCompressionLevel;
  _DAT_676c5428 = XcSetCompressionLevel;
  _DAT_676c542c = XzAddFilesToProcessW;
  _DAT_676c5430 = XzAddFilesToProcessA;
  _DAT_676c5434 = XzAddFilesToExcludeW;
  _DAT_676c5438 = XzAddFilesToExcludeA;
  _DAT_676c543c = XzConvertW;
  _DAT_676c5440 = XzConvertA;
  _DAT_676c5444 = XzGetErrorDescriptionW;
  _DAT_676c5448 = XzGetErrorDescriptionA;
  _DAT_676c544c = XzGetZipFileInformation;
  _DAT_676c5450 = XzListZipContents;
  _DAT_676c5454 = XzPreviewFiles;
  _DAT_676c5458 = XzRemoveFiles;
  _DAT_676c545c = XzSfxAddExtensionToAssociateW;
  _DAT_676c5460 = XzSfxAddExtensionToAssociateA;
  _DAT_676c5464 = XzSfxAddProgramGroupItemW;
  _DAT_676c5468 = XzSfxAddProgramGroupItemA;
  _DAT_676c546c = XzSfxClearButtons;
  _DAT_676c5470 = XzSfxClearMessages;
  _DAT_676c5474 = XzSfxClearStrings;
  _DAT_676c5478 = XzSfxLoadConfigW;
  _DAT_676c547c = XzSfxLoadConfigA;
  _DAT_676c5480 = XzSfxSaveConfigW;
  _DAT_676c5484 = XzSfxSaveConfigA;
  _DAT_676c5488 = XzSfxResetButtons;
  _DAT_676c548c = XzSfxResetMessages;
  _DAT_676c5490 = XzSfxResetStrings;
  _DAT_676c5494 = XzTestZipFile;
  _DAT_676c5498 = XzUnzip;
  _DAT_676c549c = XzZip;
  _DAT_676c54a0 = XcGetErrorDescriptionW;
  _DAT_676c54a4 = XcGetErrorDescriptionA;
  _DAT_676c54a8 = XcCompress;
  _DAT_676c54ac = XcUncompress;
  _DAT_676c54b0 = XcCalculateCrc;
  _DAT_676c54b4 = XzGetSfxFilesToCopyW;
  _DAT_676c54b8 = XzGetSfxFilesToCopyA;
  _DAT_676c54bc = XzSetSfxFilesToCopyW;
  _DAT_676c54c0 = XzSetSfxFilesToCopyA;
  _DAT_676c54c4 = XzGetSfxFilesToRegisterW;
  _DAT_676c54c8 = XzGetSfxFilesToRegisterA;
  _DAT_676c54cc = XzSetSfxFilesToRegisterW;
  _DAT_676c54d0 = XzSetSfxFilesToRegisterA;
  _DAT_676c54d4 = XzGetSfxRegistryKeysW;
  _DAT_676c54d8 = XzGetSfxRegistryKeysA;
  _DAT_676c54dc = XzSetSfxRegistryKeysW;
  _DAT_676c54e0 = XzSetSfxRegistryKeysA;
  _DAT_676c54e4 = XzGetDeleteZippedFiles;
  _DAT_676c54e8 = XzSetDeleteZippedFiles;
  _DAT_676c54ec = XzSfxAddExecuteAfterW;
  _DAT_676c54f0 = XzSfxAddExecuteAfterA;
  _DAT_676c54f4 = XzSfxAddFileToCopyW;
  _DAT_676c54f8 = XzSfxAddFileToCopyA;
  _DAT_676c54fc = XzSfxAddFileToRegisterW;
  _DAT_676c5500 = XzSfxAddFileToRegisterA;
  _DAT_676c5504 = XzSfxAddRegistryKeyW;
  _DAT_676c5508 = XzSfxAddRegistryKeyA;
  _DAT_676c550c = XzGetFirstDiskFreeSpace;
  _DAT_676c5510 = XzSetFirstDiskFreeSpace;
  _DAT_676c5514 = XzGetMinDiskFreeSpace;
  _DAT_676c5518 = XzSetMinDiskFreeSpace;
  _DAT_676c551c = XzGetEventsToTrigger;
  _DAT_676c5520 = XzSetEventsToTrigger;
  _DAT_676c5524 = XziDestroyXceedZipItems;
  _DAT_676c5528 = XzGetZipContents;
  _DAT_676c552c = XziGetFirstItemW;
  _DAT_676c5530 = XziGetFirstItemA;
  _DAT_676c5534 = XziGetNextItemW;
  _DAT_676c5538 = XziGetNextItemA;
  _DAT_676c553c = XzGetCompressionMethod;
  _DAT_676c5540 = XzSetCompressionMethod;
  _DAT_676c5544 = XcGetCompressionMethod;
  _DAT_676c5548 = XcSetCompressionMethod;
  _DAT_676c554c = XzGetUse64BitEvents;
  _DAT_676c5550 = XzSetUse64BitEvents;
  _DAT_676c5554 = XzGetZipFileInformation64;
  return;
}



// Function: XzAddFilesToProcessW at 6769665c

void XzAddFilesToProcessW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x2665c  140  XzAddFilesToProcessW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x168))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzAddFilesToProcessA at 67696688

void XzAddFilesToProcessA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x26688  141  XzAddFilesToProcessA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x168))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzAddFilesToExcludeW at 676966b7

void XzAddFilesToExcludeW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x266b7  142  XzAddFilesToExcludeW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x16c))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzAddFilesToExcludeA at 676966e3

void XzAddFilesToExcludeA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x266e3  143  XzAddFilesToExcludeA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x16c))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzConvertW at 67696712

undefined4 XzConvertW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  undefined4 local_8;
  
                    /* 0x26712  144  XzConvertW */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x1b0))(param_1,uVar1,&local_8);
    Ordinal_6(uVar1);
  }
  return local_8;
}



// Function: XzConvertA at 6769674c

undefined4 XzConvertA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  undefined4 local_8;
  
                    /* 0x2674c  145  XzConvertA */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x1b0))(param_1,pWVar1,&local_8);
    Ordinal_6(pWVar1);
  }
  return local_8;
}



// Function: XzGetErrorDescriptionW at 67696789

void XzGetErrorDescriptionW
               (int *param_1,undefined4 param_2,undefined4 param_3,uint param_4,undefined4 param_5)

{
  short *local_8;
  
                    /* 0x26789  146  XzGetErrorDescriptionW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1c0))(param_1,param_2,param_3,&local_8);
  }
  FUN_67695d32(param_4,param_5,local_8);
  return;
}



// Function: XzGetErrorDescriptionA at 676967c0

void XzGetErrorDescriptionA
               (int *param_1,undefined4 param_2,undefined4 param_3,LPSTR param_4,uint param_5)

{
  LPCWSTR local_8;
  
                    /* 0x267c0  147  XzGetErrorDescriptionA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1c0))(param_1,param_2,param_3,&local_8);
  }
  FUN_67695d7f(param_4,param_5,local_8);
  return;
}



// Function: XzGetZipFileInformation at 676967f7

undefined4
XzGetZipFileInformation
          (int *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5,
          uint *param_6)

{
  undefined4 local_c;
  undefined4 local_8;
  
                    /* 0x267f7  148  XzGetZipFileInformation */
  local_c = 0;
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    if (*param_6 != 0) {
      local_8 = 0xffffffff;
    }
    (**(code **)(*param_1 + 0x188))(param_1,param_2,param_3,param_4,param_5,&local_8,&local_c);
    *param_6 = (uint)((short)local_8 != 0);
  }
  return local_c;
}



// Function: XzGetZipFileInformation64 at 67696848

undefined4
XzGetZipFileInformation64
          (int *param_1,uint *param_2,uint *param_3,uint *param_4,uint *param_5,uint *param_6,
          ushort *param_7,uint *param_8)

{
  short local_78 [4];
  uint local_70;
  short local_68 [4];
  uint local_60;
  short local_58 [4];
  uint local_50;
  short local_48 [4];
  uint local_40;
  short local_38 [4];
  uint local_30;
  short local_28 [4];
  ushort local_20;
  short local_18 [4];
  short local_10;
  undefined4 local_8;
  
                    /* 0x26848  219  XzGetZipFileInformation64 */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    local_78[0] = 0;
    local_68[0] = 0;
    local_58[0] = 0;
    local_48[0] = 0;
    local_38[0] = 0;
    local_28[0] = 0;
    local_18[0] = 0;
    (**(code **)(*param_1 + 0x224))
              (param_1,local_78,local_68,local_58,local_48,local_38,local_28,local_18,&local_8);
    if (param_2 != (uint *)0x0) {
      *param_2 = ~-(uint)(local_78[0] != 3) & local_70;
    }
    if (param_3 != (uint *)0x0) {
      *param_3 = ~-(uint)(local_68[0] != 3) & local_60;
    }
    if (param_4 != (uint *)0x0) {
      *param_4 = ~-(uint)(local_58[0] != 3) & local_50;
    }
    if (param_5 != (uint *)0x0) {
      *param_5 = ~-(uint)(local_48[0] != 3) & local_40;
    }
    if (param_6 != (uint *)0x0) {
      *param_6 = ~-(uint)(local_38[0] != 3) & local_30;
    }
    if (param_7 != (ushort *)0x0) {
      *param_7 = ~-(ushort)(local_28[0] != 2) & local_20;
    }
    if (param_8 != (uint *)0x0) {
      *param_8 = ~-(uint)(local_18[0] != 0xb) & (uint)(local_10 != 0);
    }
    Ordinal_9(local_18);
    Ordinal_9(local_28);
    Ordinal_9(local_38);
    Ordinal_9(local_48);
    Ordinal_9(local_58);
    Ordinal_9(local_68);
    Ordinal_9(local_78);
  }
  return local_8;
}



// Function: XzListZipContents at 676969a0

undefined4 XzListZipContents(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x269a0  149  XzListZipContents */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x174))(param_1,&local_8);
  }
  return local_8;
}



// Function: XzPreviewFiles at 676969c3

undefined4 XzPreviewFiles(int *param_1,int param_2)

{
  undefined4 uVar1;
  undefined4 local_8;
  
                    /* 0x269c3  150  XzPreviewFiles */
  uVar1 = 0;
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    if (param_2 != 0) {
      uVar1 = 0xffffffff;
    }
    (**(code **)(*param_1 + 0x170))(param_1,uVar1,&local_8);
  }
  return local_8;
}



// Function: XzRemoveFiles at 676969f2

undefined4 XzRemoveFiles(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x269f2  151  XzRemoveFiles */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x180))(param_1,&local_8);
  }
  return local_8;
}



// Function: XzGetZipContents at 67696a15

undefined4 * XzGetZipContents(int *param_1,undefined4 *param_2)

{
  int *piVar1;
  undefined4 *puVar2;
  int iVar3;
  int *local_10;
  int *local_c;
  int *local_8;
  
                    /* 0x26a15  208  XzGetZipContents */
  puVar2 = param_2;
  if (param_2 == (undefined4 *)0x0) {
    return (undefined4 *)0x1ff;
  }
  param_2 = (undefined4 *)0x0;
  if (param_1 == (int *)0x0) {
    return (undefined4 *)0x0;
  }
  local_10 = (int *)0x0;
  iVar3 = (**(code **)(*param_1 + 0x1c4))(param_1,&local_10,0,&param_2);
  if ((iVar3 < 0) || (param_2 != (undefined4 *)0x0)) goto LAB_67696af8;
  param_2 = (undefined4 *)0x3e7;
  local_c = (int *)0x0;
  if (local_10 == (int *)0x0) {
    return (undefined4 *)0x3e7;
  }
  (**(code **)*local_10)(local_10,&DAT_676c1bb0,&local_c);
  if (local_c == (int *)0x0) goto LAB_67696af8;
  local_8 = (int *)0x0;
  iVar3 = (**(code **)(*local_c + 0x1c))(local_c,&local_8);
  param_1 = (int *)0x0;
  if (local_8 != (int *)0x0) {
    (**(code **)*local_8)(local_8,&DAT_676c1ba0,&param_1);
  }
  piVar1 = param_1;
  if ((iVar3 < 0) || (local_8 == (int *)0x0)) {
LAB_67696ad1:
    if (param_1 != (int *)0x0) {
      (**(code **)(*param_1 + 8))(param_1);
    }
  }
  else if (param_1 != (int *)0x0) {
    param_1 = (int *)0x0;
    *puVar2 = piVar1;
    param_2 = (undefined4 *)0x0;
    goto LAB_67696ad1;
  }
  if (local_8 != (int *)0x0) {
    (**(code **)(*local_8 + 8))(local_8);
  }
  if (local_c != (int *)0x0) {
    (**(code **)(*local_c + 8))(local_c);
  }
LAB_67696af8:
  if (local_10 != (int *)0x0) {
    (**(code **)(*local_10 + 8))(local_10);
  }
  return param_2;
}



// Function: XzSfxAddExtensionToAssociateW at 67696b0e

void XzSfxAddExtensionToAssociateW
               (int *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  
                    /* 0x26b0e  152  XzSfxAddExtensionToAssociateW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    uVar2 = Ordinal_2(param_3);
    uVar3 = Ordinal_2(param_4);
    (**(code **)(*param_1 + 0x194))(param_1,uVar1,uVar2,uVar3);
    Ordinal_6(uVar1);
    Ordinal_6(uVar2);
    Ordinal_6(uVar3);
  }
  return;
}



// Function: XzSfxAddExtensionToAssociateA at 67696b60

void XzSfxAddExtensionToAssociateA(int *param_1,LPCSTR param_2,LPCSTR param_3,LPCSTR param_4)

{
  LPWSTR pWVar1;
  LPWSTR pWVar2;
  LPWSTR pWVar3;
  
                    /* 0x26b60  153  XzSfxAddExtensionToAssociateA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    pWVar2 = FUN_67684ed6(param_3,-1);
    pWVar3 = FUN_67684ed6(param_4,-1);
    (**(code **)(*param_1 + 0x194))(param_1,pWVar1,pWVar2,pWVar3);
    Ordinal_6(pWVar1);
    Ordinal_6(pWVar2);
    Ordinal_6(pWVar3);
  }
  return;
}



// Function: XzSfxAddProgramGroupItemW at 67696bb9

void XzSfxAddProgramGroupItemW(int *param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
                    /* 0x26bb9  154  XzSfxAddProgramGroupItemW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    uVar2 = Ordinal_2(param_3);
    (**(code **)(*param_1 + 400))(param_1,uVar1,uVar2);
    Ordinal_6(uVar1);
    Ordinal_6(uVar2);
  }
  return;
}



// Function: XzSfxAddProgramGroupItemA at 67696bfb

void XzSfxAddProgramGroupItemA(int *param_1,LPCSTR param_2,LPCSTR param_3)

{
  LPWSTR pWVar1;
  LPWSTR pWVar2;
  
                    /* 0x26bfb  155  XzSfxAddProgramGroupItemA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    pWVar2 = FUN_67684ed6(param_3,-1);
    (**(code **)(*param_1 + 400))(param_1,pWVar1,pWVar2);
    Ordinal_6(pWVar1);
    Ordinal_6(pWVar2);
  }
  return;
}



// Function: XzSfxClearButtons at 67696c40

void XzSfxClearButtons(int *param_1)

{
                    /* 0x26c40  156  XzSfxClearButtons */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1a4))(param_1);
  }
  return;
}



// Function: XzSfxClearMessages at 67696c54

void XzSfxClearMessages(int *param_1)

{
                    /* 0x26c54  157  XzSfxClearMessages */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1a8))(param_1);
  }
  return;
}



// Function: XzSfxClearStrings at 67696c68

void XzSfxClearStrings(int *param_1)

{
                    /* 0x26c68  158  XzSfxClearStrings */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1ac))(param_1);
  }
  return;
}



// Function: XzSfxLoadConfigW at 67696c7c

bool XzSfxLoadConfigW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  undefined4 local_8;
  
                    /* 0x26c7c  159  XzSfxLoadConfigW */
  local_8 = 0xffffffff;
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x1b8))(param_1,uVar1,&local_8);
    Ordinal_6(uVar1);
  }
  return (short)local_8 != 0;
}



// Function: XzSfxLoadConfigA at 67696cbc

bool XzSfxLoadConfigA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  undefined4 local_8;
  
                    /* 0x26cbc  160  XzSfxLoadConfigA */
  local_8 = 0xffffffff;
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x1b8))(param_1,pWVar1,&local_8);
    Ordinal_6(pWVar1);
  }
  return (short)local_8 != 0;
}



// Function: XzSfxSaveConfigW at 67696cff

bool XzSfxSaveConfigW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  undefined4 local_8;
  
                    /* 0x26cff  161  XzSfxSaveConfigW */
  local_8 = 0xffffffff;
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x1bc))(param_1,uVar1,&local_8);
    Ordinal_6(uVar1);
  }
  return (short)local_8 != 0;
}



// Function: XzSfxSaveConfigA at 67696d3f

bool XzSfxSaveConfigA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  undefined4 local_8;
  
                    /* 0x26d3f  162  XzSfxSaveConfigA */
  local_8 = 0xffffffff;
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x1bc))(param_1,pWVar1,&local_8);
    Ordinal_6(pWVar1);
  }
  return (short)local_8 != 0;
}



// Function: XzSfxResetButtons at 67696d82

void XzSfxResetButtons(int *param_1)

{
                    /* 0x26d82  163  XzSfxResetButtons */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x198))(param_1);
  }
  return;
}



// Function: XzSfxResetMessages at 67696d96

void XzSfxResetMessages(int *param_1)

{
                    /* 0x26d96  164  XzSfxResetMessages */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x19c))(param_1);
  }
  return;
}



// Function: XzSfxResetStrings at 67696daa

void XzSfxResetStrings(int *param_1)

{
                    /* 0x26daa  165  XzSfxResetStrings */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1a0))(param_1);
  }
  return;
}



// Function: XzTestZipFile at 67696dbe

undefined4 XzTestZipFile(int *param_1,int param_2)

{
  undefined4 uVar1;
  undefined4 local_8;
  
                    /* 0x26dbe  166  XzTestZipFile */
  local_8 = 0;
  uVar1 = 0xffffffff;
  if (param_1 != (int *)0x0) {
    if (param_2 == 0) {
      uVar1 = 0;
    }
    (**(code **)(*param_1 + 0x184))(param_1,uVar1,&local_8);
  }
  return local_8;
}



// Function: XzUnzip at 67696def

undefined4 XzUnzip(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x26def  167  XzUnzip */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x17c))(param_1,&local_8);
  }
  return local_8;
}



// Function: XzZip at 67696e12

undefined4 XzZip(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x26e12  168  XzZip */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x178))(param_1,&local_8);
  }
  return local_8;
}



// Function: XzSfxAddExecuteAfterW at 67696e35

void XzSfxAddExecuteAfterW(int *param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
                    /* 0x26e35  193  XzSfxAddExecuteAfterW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    uVar2 = Ordinal_2(param_3);
    (**(code **)(*param_1 + 0x200))(param_1,uVar1,uVar2);
    Ordinal_6(uVar1);
    Ordinal_6(uVar2);
  }
  return;
}



// Function: XzSfxAddExecuteAfterA at 67696e77

void XzSfxAddExecuteAfterA(int *param_1,LPCSTR param_2,LPCSTR param_3)

{
  LPWSTR pWVar1;
  LPWSTR pWVar2;
  
                    /* 0x26e77  194  XzSfxAddExecuteAfterA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    pWVar2 = FUN_67684ed6(param_3,-1);
    (**(code **)(*param_1 + 0x200))(param_1,pWVar1,pWVar2);
    Ordinal_6(pWVar1);
    Ordinal_6(pWVar2);
  }
  return;
}



// Function: XzSfxAddFileToCopyW at 67696ebc

void XzSfxAddFileToCopyW(int *param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
                    /* 0x26ebc  195  XzSfxAddFileToCopyW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    uVar2 = Ordinal_2(param_3);
    (**(code **)(*param_1 + 0x204))(param_1,uVar1,uVar2);
    Ordinal_6(uVar1);
    Ordinal_6(uVar2);
  }
  return;
}



// Function: XzSfxAddFileToCopyA at 67696efe

void XzSfxAddFileToCopyA(int *param_1,LPCSTR param_2,LPCSTR param_3)

{
  LPWSTR pWVar1;
  LPWSTR pWVar2;
  
                    /* 0x26efe  196  XzSfxAddFileToCopyA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    pWVar2 = FUN_67684ed6(param_3,-1);
    (**(code **)(*param_1 + 0x204))(param_1,pWVar1,pWVar2);
    Ordinal_6(pWVar1);
    Ordinal_6(pWVar2);
  }
  return;
}



// Function: XzSfxAddFileToRegisterW at 67696f43

void XzSfxAddFileToRegisterW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x26f43  197  XzSfxAddFileToRegisterW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x208))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSfxAddFileToRegisterA at 67696f6f

void XzSfxAddFileToRegisterA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x26f6f  198  XzSfxAddFileToRegisterA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x208))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzSfxAddRegistryKeyW at 67696f9e

void XzSfxAddRegistryKeyW(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  short *psVar1;
  short *psVar2;
  short *psVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  short *psVar7;
  
                    /* 0x26f9e  199  XzSfxAddRegistryKeyW */
  if (param_1 != 0) {
    psVar1 = (short *)Ordinal_2(param_2);
    psVar2 = (short *)Ordinal_2(param_3);
    psVar3 = (short *)Ordinal_2(param_4);
    iVar4 = Ordinal_7(psVar3);
    iVar5 = Ordinal_7(psVar2);
    iVar6 = Ordinal_7(psVar1);
    psVar7 = (short *)Ordinal_4(0,iVar4 + iVar5 + 2 + iVar6);
    FUN_676ae1fc(psVar7,psVar1);
    FUN_676ae272(psVar7,(short *)&DAT_676c1bc0);
    FUN_676ae272(psVar7,psVar2);
    FUN_676ae272(psVar7,(short *)&DAT_676c1bc0);
    FUN_676ae272(psVar7,psVar3);
    FUN_6769e7b1(param_1,(int)psVar7);
    Ordinal_6(psVar1);
    Ordinal_6(psVar2);
    Ordinal_6(psVar3);
    Ordinal_6(psVar7);
  }
  return;
}



// Function: XzSfxAddRegistryKeyA at 67697044

void XzSfxAddRegistryKeyA(int param_1,LPCSTR param_2,LPCSTR param_3,LPCSTR param_4)

{
  LPWSTR pWVar1;
  LPWSTR pWVar2;
  LPWSTR pWVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  short *psVar7;
  
                    /* 0x27044  200  XzSfxAddRegistryKeyA */
  if (param_1 != 0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    pWVar2 = FUN_67684ed6(param_3,-1);
    pWVar3 = FUN_67684ed6(param_4,-1);
    iVar4 = Ordinal_7(pWVar3);
    iVar5 = Ordinal_7(pWVar2);
    iVar6 = Ordinal_7(pWVar1);
    psVar7 = (short *)Ordinal_4(0,iVar4 + iVar5 + 2 + iVar6);
    FUN_676ae1fc(psVar7,pWVar1);
    FUN_676ae272(psVar7,(short *)&DAT_676c1bc0);
    FUN_676ae272(psVar7,pWVar2);
    FUN_676ae272(psVar7,(short *)&DAT_676c1bc0);
    FUN_676ae272(psVar7,pWVar3);
    FUN_6769e7b1(param_1,(int)psVar7);
    Ordinal_6(pWVar1);
    Ordinal_6(pWVar2);
    Ordinal_6(pWVar3);
    Ordinal_6(psVar7);
  }
  return;
}



// Function: XcGetErrorDescriptionW at 676970f6

void XcGetErrorDescriptionW(int *param_1,undefined4 param_2,uint param_3,undefined4 param_4)

{
  short *local_8;
  
                    /* 0x270f6  169  XcGetErrorDescriptionW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x3c))(param_1,param_2,&local_8);
  }
  FUN_67695d32(param_3,param_4,local_8);
  return;
}



// Function: XcGetErrorDescriptionA at 67697127

void XcGetErrorDescriptionA(int *param_1,undefined4 param_2,LPSTR param_3,uint param_4)

{
  LPCWSTR local_8;
  
                    /* 0x27127  170  XcGetErrorDescriptionA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x3c))(param_1,param_2,&local_8);
  }
  FUN_67695d7f(param_3,param_4,local_8);
  return;
}



// Function: XcCompress at 67697158

int XcCompress(int *param_1,int param_2,int param_3,undefined4 *param_4,undefined4 *param_5,
              int param_6)

{
  int *piVar1;
  int iVar2;
  undefined1 local_28 [8];
  int local_20;
  undefined2 local_18 [4];
  int *local_10;
  int local_8;
  
                    /* 0x27158  171  XcCompress */
  piVar1 = param_1;
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    Ordinal_8(local_18);
    Ordinal_8(local_28);
    param_1 = (int *)0x0;
    iVar2 = Ordinal_36(1,&param_1);
    if (-1 < iVar2) {
      *(undefined2 *)((int)param_1 + 2) = 0x12;
      param_1[1] = 1;
      param_1[4] = param_3;
      param_1[5] = 0;
      param_1[3] = param_2;
      local_18[0] = 0x2011;
      local_10 = param_1;
      iVar2 = (**(code **)(*piVar1 + 0x2c))(piVar1,local_18,local_28,-(uint)(param_6 != 0),&local_8)
      ;
      if ((-1 < iVar2) && ((local_8 == 0 || (local_8 == 0x3e9)))) {
        *param_5 = *(undefined4 *)(local_20 + 0x10);
        *param_4 = *(undefined4 *)(local_20 + 0xc);
        Ordinal_38(local_20);
      }
    }
    Ordinal_38(param_1);
  }
  return local_8;
}



// Function: XcUncompress at 67697224

int XcUncompress(int *param_1,int param_2,int param_3,undefined4 *param_4,undefined4 *param_5,
                int param_6)

{
  int *piVar1;
  int iVar2;
  undefined1 local_28 [8];
  int local_20;
  undefined2 local_18 [4];
  int *local_10;
  int local_8;
  
                    /* 0x27224  172  XcUncompress */
  piVar1 = param_1;
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    Ordinal_8(local_18);
    Ordinal_8(local_28);
    param_1 = (int *)0x0;
    iVar2 = Ordinal_36(1,&param_1);
    if (-1 < iVar2) {
      *(undefined2 *)((int)param_1 + 2) = 0x10;
      param_1[1] = 1;
      param_1[4] = param_3;
      param_1[5] = 0;
      param_1[3] = param_2;
      local_18[0] = 0x2011;
      local_10 = param_1;
      iVar2 = (**(code **)(*piVar1 + 0x30))(piVar1,local_18,local_28,-(uint)(param_6 != 0),&local_8)
      ;
      if ((-1 < iVar2) && ((local_8 == 0 || (local_8 == 0x3e9)))) {
        *param_5 = *(undefined4 *)(local_20 + 0x10);
        *param_4 = *(undefined4 *)(local_20 + 0xc);
        Ordinal_38(local_20);
      }
    }
    Ordinal_38(param_1);
  }
  return local_8;
}



// Function: XcCalculateCrc at 676972f0

undefined4 XcCalculateCrc(int *param_1,int param_2,int param_3,undefined4 param_4)

{
  int *piVar1;
  int iVar2;
  undefined2 local_18 [4];
  int *local_10;
  undefined4 local_8;
  
                    /* 0x272f0  173  XcCalculateCrc */
  piVar1 = param_1;
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    Ordinal_8(local_18);
    param_1 = (int *)0x0;
    iVar2 = Ordinal_36(1,&param_1);
    if (-1 < iVar2) {
      *(undefined2 *)((int)param_1 + 2) = 0x10;
      param_1[1] = 1;
      param_1[4] = param_3;
      param_1[5] = 0;
      param_1[3] = param_2;
      local_10 = param_1;
      local_18[0] = 0x2011;
      (**(code **)(*piVar1 + 0x34))(piVar1,local_18,param_4,&local_8);
    }
    Ordinal_38(param_1);
  }
  return local_8;
}



// Function: FUN_6769737a at 6769737a

undefined4 __cdecl FUN_6769737a(int *param_1,ushort *param_2)

{
  ushort *puVar1;
  int *piVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  undefined1 local_40 [32];
  undefined4 local_20;
  undefined4 uStack_1c;
  undefined4 uStack_18;
  undefined4 uStack_14;
  undefined8 local_10;
  short *local_8;
  
  puVar1 = param_2;
  piVar2 = param_1;
  if ((param_1 == (int *)0x0) || (param_2 == (ushort *)0x0)) {
    uVar4 = 0;
  }
  else {
    (**(code **)(*param_1 + 0x34))(param_1,param_2 + 0x50e);
    (**(code **)(*piVar2 + 0x2c))(piVar2,puVar1 + 0x50a);
    (**(code **)(*piVar2 + 0x48))(piVar2,puVar1 + 0x52a);
    (**(code **)(*piVar2 + 0x30))(piVar2,puVar1 + 0x50c);
    (**(code **)(*piVar2 + 0x38))(piVar2,puVar1 + 0x510);
    (**(code **)(*piVar2 + 0x50))(piVar2,puVar1 + 0x52e);
    (**(code **)(*piVar2 + 0x58))(piVar2,puVar1 + 0x532);
    (**(code **)(*piVar2 + 0x28))(piVar2,puVar1 + 0x508);
    if (0xa6f < *puVar1) {
      (**(code **)(*piVar2 + 0x5c))(piVar2,puVar1 + 0x534);
      (**(code **)(*piVar2 + 0x60))(piVar2,puVar1 + 0x536);
    }
    (**(code **)(*piVar2 + 0x4c))(piVar2,(int)&param_1 + 2);
    *(uint *)(puVar1 + 0x52c) = (uint)(param_1._2_2_ != 0);
    (**(code **)(*piVar2 + 0x54))(piVar2,(int)&param_1 + 2);
    *(uint *)(puVar1 + 0x530) = (uint)(param_1._2_2_ != 0);
    (**(code **)(*piVar2 + 0x44))(piVar2,&local_10);
    puVar3 = FUN_6768ef7c(local_40,local_10);
    local_20 = puVar3[2];
    uStack_1c = puVar3[3];
    uStack_18 = puVar3[4];
    uStack_14 = puVar3[5];
    *(undefined4 *)(param_2 + 0x522) = local_20;
    *(undefined4 *)(param_2 + 0x524) = uStack_1c;
    *(undefined4 *)(param_2 + 0x526) = uStack_18;
    *(undefined4 *)(param_2 + 0x528) = uStack_14;
    (**(code **)(*piVar2 + 0x40))(piVar2,&local_10);
    puVar3 = FUN_6768ef7c(local_40,local_10);
    local_20 = puVar3[2];
    uStack_1c = puVar3[3];
    uStack_18 = puVar3[4];
    uStack_14 = puVar3[5];
    *(undefined4 *)(param_2 + 0x51a) = local_20;
    *(undefined4 *)(param_2 + 0x51c) = uStack_1c;
    *(undefined4 *)(param_2 + 0x51e) = uStack_18;
    *(undefined4 *)(param_2 + 0x520) = uStack_14;
    (**(code **)(*piVar2 + 0x3c))(piVar2,&local_10);
    puVar3 = FUN_6768ef7c(local_40,local_10);
    local_20 = puVar3[2];
    uStack_1c = puVar3[3];
    uStack_18 = puVar3[4];
    uStack_14 = puVar3[5];
    *(undefined4 *)(param_2 + 0x512) = local_20;
    *(undefined4 *)(param_2 + 0x514) = uStack_1c;
    *(undefined4 *)(param_2 + 0x516) = uStack_18;
    local_8 = (short *)0x0;
    *(undefined4 *)(param_2 + 0x518) = uStack_14;
    (**(code **)(*piVar2 + 0x24))(piVar2,&local_8);
    puVar1 = param_2;
    FUN_676ae229((short *)(param_2 + 0x108),local_8,0x400);
    Ordinal_6(local_8);
    local_8 = (short *)0x0;
    (**(code **)(*piVar2 + 0x1c))(piVar2,&local_8);
    FUN_676ae229((short *)(puVar1 + 4),local_8,0x104);
    puVar1[2] = 0;
    puVar1[3] = 0;
    Ordinal_6(local_8);
    uVar4 = 1;
  }
  return uVar4;
}



// Function: FUN_6769755a at 6769755a

undefined4 __cdecl FUN_6769755a(ushort *param_1,ushort *param_2)

{
  LPCSTR lpString2;
  int iVar1;
  undefined4 uVar2;
  LPCSTR lpString2_00;
  
  lpString2_00 = (LPCSTR)0x0;
  if ((param_2 == (ushort *)0x0) || (param_1 == (ushort *)0x0)) {
    uVar2 = 0;
  }
  else {
    *(undefined4 *)(param_2 + 2) = *(undefined4 *)(param_1 + 2);
    if ((LPCWSTR)(param_1 + 4) == (LPCWSTR)0x0) {
      lpString2 = (LPCSTR)0x0;
    }
    else {
      lpString2 = &stack0xffffffec;
      iVar1 = lstrlenW((LPCWSTR)(param_1 + 4));
      FUN_676b06a0();
      WideCharToMultiByte(0,0,(LPCWSTR)(param_1 + 4),-1,&stack0xffffffec,iVar1 * 2 + 2,(LPCSTR)0x0,
                          (LPBOOL)0x0);
    }
    lstrcpynA((LPSTR)(param_2 + 4),lpString2,0x104);
    if ((LPCWSTR)(param_1 + 0x108) != (LPCWSTR)0x0) {
      lpString2_00 = &stack0xffffffec;
      iVar1 = lstrlenW((LPCWSTR)(param_1 + 0x108));
      FUN_676b06a0();
      WideCharToMultiByte(0,0,(LPCWSTR)(param_1 + 0x108),-1,&stack0xffffffec,iVar1 * 2 + 2,
                          (LPCSTR)0x0,(LPBOOL)0x0);
    }
    lstrcpynA((LPSTR)(param_2 + 0x86),lpString2_00,0x400);
    *(undefined4 *)(param_2 + 0x286) = *(undefined4 *)(param_1 + 0x508);
    *(undefined4 *)(param_2 + 0x288) = *(undefined4 *)(param_1 + 0x50a);
    param_2[0x28a] = param_1[0x50c];
    *(undefined4 *)(param_2 + 0x28c) = *(undefined4 *)(param_1 + 0x50e);
    *(undefined4 *)(param_2 + 0x28e) = *(undefined4 *)(param_1 + 0x510);
    *(undefined4 *)(param_2 + 0x290) = *(undefined4 *)(param_1 + 0x512);
    *(undefined4 *)(param_2 + 0x292) = *(undefined4 *)(param_1 + 0x514);
    *(undefined4 *)(param_2 + 0x294) = *(undefined4 *)(param_1 + 0x516);
    *(undefined4 *)(param_2 + 0x296) = *(undefined4 *)(param_1 + 0x518);
    *(undefined4 *)(param_2 + 0x298) = *(undefined4 *)(param_1 + 0x51a);
    *(undefined4 *)(param_2 + 0x29a) = *(undefined4 *)(param_1 + 0x51c);
    *(undefined4 *)(param_2 + 0x29c) = *(undefined4 *)(param_1 + 0x51e);
    *(undefined4 *)(param_2 + 0x29e) = *(undefined4 *)(param_1 + 0x520);
    *(undefined4 *)(param_2 + 0x2a0) = *(undefined4 *)(param_1 + 0x522);
    *(undefined4 *)(param_2 + 0x2a2) = *(undefined4 *)(param_1 + 0x524);
    *(undefined4 *)(param_2 + 0x2a4) = *(undefined4 *)(param_1 + 0x526);
    *(undefined4 *)(param_2 + 0x2a6) = *(undefined4 *)(param_1 + 0x528);
    *(undefined4 *)(param_2 + 0x2a8) = *(undefined4 *)(param_1 + 0x52a);
    *(undefined4 *)(param_2 + 0x2aa) = *(undefined4 *)(param_1 + 0x52c);
    *(undefined4 *)(param_2 + 0x2ac) = *(undefined4 *)(param_1 + 0x52e);
    *(undefined4 *)(param_2 + 0x2ae) = *(undefined4 *)(param_1 + 0x530);
    *(undefined4 *)(param_2 + 0x2b0) = *(undefined4 *)(param_1 + 0x532);
    if ((0xa6f < *param_1) && (0x56b < *param_2)) {
      *(undefined4 *)(param_2 + 0x2b2) = *(undefined4 *)(param_1 + 0x534);
      *(undefined4 *)(param_2 + 0x2b4) = *(undefined4 *)(param_1 + 0x536);
    }
    uVar2 = 1;
  }
  return uVar2;
}



// Function: XziGetFirstItemW at 6769770a

undefined4 XziGetFirstItemW(int *param_1,ushort *param_2)

{
  int *piVar1;
  int iVar2;
  undefined4 uVar3;
  ushort local_18 [4];
  undefined4 *local_10;
  int local_8;
  
                    /* 0x2770a  209  XziGetFirstItemW */
  piVar1 = param_1;
  if (((param_1 != (int *)0x0) && (param_2 != (ushort *)0x0)) &&
     (iVar2 = (**(code **)(*param_1 + 0x14))(param_1), -1 < iVar2)) {
    local_18[0] = 0;
    local_8 = 0;
    iVar2 = (**(code **)(*piVar1 + 0xc))(piVar1,1,local_18,&local_8);
    if (((iVar2 < 0) || (local_8 == 0)) || ((local_18[0] & 0xd) == 0)) {
      uVar3 = 0;
    }
    else {
      if ((local_18[0] & 0x4000) != 0) {
        local_10 = (undefined4 *)*local_10;
      }
      param_1 = (int *)0x0;
      if (local_10 != (undefined4 *)0x0) {
        (**(code **)*local_10)(local_10,&DAT_676c1bc8,&param_1);
      }
      uVar3 = FUN_6769737a(param_1,param_2);
      if (param_1 != (int *)0x0) {
        (**(code **)(*param_1 + 8))(param_1);
      }
    }
    Ordinal_9(local_18);
    return uVar3;
  }
  return 0;
}



// Function: XziGetFirstItemA at 676977aa

undefined4 XziGetFirstItemA(int *param_1,ushort *param_2)

{
  int iVar1;
  undefined4 uVar2;
  ushort local_a74 [1336];
  
                    /* 0x277aa  210  XziGetFirstItemA */
  local_a74[0] = 0xa70;
  iVar1 = XziGetFirstItemW(param_1,local_a74);
  if (iVar1 == 0) {
    uVar2 = 0;
  }
  else {
    uVar2 = FUN_6769755a(local_a74,param_2);
  }
  return uVar2;
}



// Function: XziGetNextItemW at 676977e8

undefined4 XziGetNextItemW(int *param_1,ushort *param_2)

{
  int iVar1;
  undefined4 uVar2;
  ushort local_18 [4];
  undefined4 *local_10;
  int local_8;
  
                    /* 0x277e8  211  XziGetNextItemW */
  if ((param_1 == (int *)0x0) || (param_2 == (ushort *)0x0)) {
    uVar2 = 0;
  }
  else {
    local_18[0] = 0;
    local_8 = 0;
    iVar1 = (**(code **)(*param_1 + 0xc))(param_1,1,local_18,&local_8);
    if (((iVar1 < 0) || (local_8 == 0)) || ((local_18[0] & 0xd) == 0)) {
      uVar2 = 0;
    }
    else {
      if ((local_18[0] & 0x4000) != 0) {
        local_10 = (undefined4 *)*local_10;
      }
      param_1 = (int *)0x0;
      if (local_10 != (undefined4 *)0x0) {
        (**(code **)*local_10)(local_10,&DAT_676c1bc8,&param_1);
      }
      uVar2 = FUN_6769737a(param_1,param_2);
      if (param_1 != (int *)0x0) {
        (**(code **)(*param_1 + 8))(param_1);
      }
    }
    Ordinal_9(local_18);
  }
  return uVar2;
}



// Function: XziGetNextItemA at 6769787a

undefined4 XziGetNextItemA(int *param_1,ushort *param_2)

{
  int iVar1;
  undefined4 uVar2;
  ushort local_a74 [1336];
  
                    /* 0x2787a  212  XziGetNextItemA */
  local_a74[0] = 0xa70;
  iVar1 = XziGetNextItemW(param_1,local_a74);
  if (iVar1 == 0) {
    uVar2 = 0;
  }
  else {
    uVar2 = FUN_6769755a(local_a74,param_2);
  }
  return uVar2;
}



// Function: XzGetAbort at 676978b8

bool XzGetAbort(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x278b8  17  XzGetAbort */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1c))(param_1,&local_8);
  }
  return (short)local_8 != 0;
}



// Function: XzSetAbort at 676978de

void XzSetAbort(int *param_1,int param_2)

{
                    /* 0x278de  18  XzSetAbort */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x20))(param_1,-(uint)(param_2 != 0));
  }
  return;
}



// Function: XzGetBackgroundProcessing at 676978f8

bool XzGetBackgroundProcessing(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x278f8  19  XzGetBackgroundProcessing */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xf0))(param_1,&local_8);
  }
  return (short)local_8 != 0;
}



// Function: XzSetBackgroundProcessing at 67697921

void XzSetBackgroundProcessing(int *param_1,int param_2)

{
                    /* 0x27921  20  XzSetBackgroundProcessing */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xf4))(param_1,-(uint)(param_2 != 0));
  }
  return;
}



// Function: XzGetBasePathW at 6769793e

void XzGetBasePathW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x2793e  21  XzGetBasePathW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x24))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetBasePathA at 6769796c

void XzGetBasePathA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x2796c  22  XzGetBasePathA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x24))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetBasePathW at 6769799a

void XzSetBasePathW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x2799a  23  XzSetBasePathW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x28))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetBasePathA at 676979c3

void XzSetBasePathA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x279c3  24  XzSetBasePathA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x28))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetCompressionLevel at 676979ef

undefined4 XzGetCompressionLevel(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x279ef  25  XzGetCompressionLevel */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x2c))(param_1,&local_8);
  }
  return local_8;
}



// Function: XzSetCompressionLevel at 67697a0f

void XzSetCompressionLevel(int *param_1,undefined4 param_2)

{
                    /* 0x27a0f  26  XzSetCompressionLevel */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x30))(param_1,param_2);
  }
  return;
}



// Function: XzGetCurrentOperation at 67697a24

undefined4 XzGetCurrentOperation(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x27a24  27  XzGetCurrentOperation */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xd4))(param_1,&local_8);
  }
  return local_8;
}



// Function: XzGetEncryptionPasswordW at 67697a47

void XzGetEncryptionPasswordW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x27a47  28  XzGetEncryptionPasswordW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x34))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetEncryptionPasswordA at 67697a75

void XzGetEncryptionPasswordA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x27a75  29  XzGetEncryptionPasswordA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x34))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetEncryptionPasswordW at 67697aa3

void XzSetEncryptionPasswordW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x27aa3  30  XzSetEncryptionPasswordW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x38))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetEncryptionPasswordA at 67697acc

void XzSetEncryptionPasswordA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x27acc  31  XzSetEncryptionPasswordA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x38))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetExcludedFileAttributes at 67697af8

int * XzGetExcludedFileAttributes(int *param_1)

{
                    /* 0x27af8  32  XzGetExcludedFileAttributes */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x44))(param_1,&param_1);
  }
  return param_1;
}



// Function: XzSetExcludedFileAttributes at 67697b13

void XzSetExcludedFileAttributes(int *param_1,undefined4 param_2)

{
                    /* 0x27b13  33  XzSetExcludedFileAttributes */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x48))(param_1,param_2);
  }
  return;
}



// Function: XzGetExtraHeaders at 67697b28

int * XzGetExtraHeaders(int *param_1)

{
                    /* 0x27b28  34  XzGetExtraHeaders */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xe0))(param_1,&param_1);
  }
  return param_1;
}



// Function: XzSetExtraHeaders at 67697b46

void XzSetExtraHeaders(int *param_1,undefined4 param_2)

{
                    /* 0x27b46  35  XzSetExtraHeaders */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xe4))(param_1,param_2);
  }
  return;
}



// Function: XzGetFilesToExcludeW at 67697b5e

void XzGetFilesToExcludeW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x27b5e  36  XzGetFilesToExcludeW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x54))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetFilesToExcludeA at 67697b8c

void XzGetFilesToExcludeA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x27b8c  37  XzGetFilesToExcludeA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x54))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetFilesToExcludeW at 67697bba

void XzSetFilesToExcludeW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x27bba  38  XzSetFilesToExcludeW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x58))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetFilesToExcludeA at 67697be3

void XzSetFilesToExcludeA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x27be3  39  XzSetFilesToExcludeA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x58))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetFilesToProcessW at 67697c0f

void XzGetFilesToProcessW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x27c0f  40  XzGetFilesToProcessW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x4c))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetFilesToProcessA at 67697c3d

void XzGetFilesToProcessA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x27c3d  41  XzGetFilesToProcessA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x4c))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetFilesToProcessW at 67697c6b

void XzSetFilesToProcessW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x27c6b  42  XzSetFilesToProcessW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x50))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetFilesToProcessA at 67697c94

void XzSetFilesToProcessA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x27c94  43  XzSetFilesToProcessA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x50))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetMaxDateToProcess at 67697cc0

void XzGetMaxDateToProcess(int *param_1,undefined4 param_2)

{
  undefined8 local_c;
  
                    /* 0x27cc0  44  XzGetMaxDateToProcess */
  if (param_1 != (int *)0x0) {
    local_c = 0;
    (**(code **)(*param_1 + 100))(param_1,&local_c);
    Ordinal_185(local_c,param_2);
  }
  return;
}



// Function: XzSetMaxDateToProcess at 67697cf0

void XzSetMaxDateToProcess(int *param_1,undefined4 param_2)

{
  undefined4 local_c;
  undefined4 uStack_8;
  
                    /* 0x27cf0  45  XzSetMaxDateToProcess */
  if (param_1 != (int *)0x0) {
    Ordinal_184(param_2,&local_c);
    (**(code **)(*param_1 + 0x68))(param_1,CONCAT44(uStack_8,local_c));
  }
  return;
}



// Function: XzGetMaxSizeToProcess at 67697d1d

undefined4 XzGetMaxSizeToProcess(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x27d1d  46  XzGetMaxSizeToProcess */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x74))(param_1,&local_8);
  }
  return local_8;
}



// Function: XzSetMaxSizeToProcess at 67697d3d

void XzSetMaxSizeToProcess(int *param_1,undefined4 param_2)

{
                    /* 0x27d3d  47  XzSetMaxSizeToProcess */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x78))(param_1,param_2);
  }
  return;
}



// Function: XzGetMinDateToProcess at 67697d52

void XzGetMinDateToProcess(int *param_1,undefined4 param_2)

{
  undefined8 local_c;
  
                    /* 0x27d52  48  XzGetMinDateToProcess */
  if (param_1 != (int *)0x0) {
    local_c = 0;
    (**(code **)(*param_1 + 0x5c))(param_1,&local_c);
    Ordinal_185(local_c,param_2);
  }
  return;
}



// Function: XzSetMinDateToProcess at 67697d82

void XzSetMinDateToProcess(int *param_1,undefined4 param_2)

{
  undefined4 local_c;
  undefined4 uStack_8;
  
                    /* 0x27d82  49  XzSetMinDateToProcess */
  if (param_1 != (int *)0x0) {
    Ordinal_184(param_2,&local_c);
    (**(code **)(*param_1 + 0x60))(param_1,CONCAT44(uStack_8,local_c));
  }
  return;
}



// Function: XzGetMinSizeToProcess at 67697daf

undefined4 XzGetMinSizeToProcess(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x27daf  50  XzGetMinSizeToProcess */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x6c))(param_1,&local_8);
  }
  return local_8;
}



// Function: XzSetMinSizeToProcess at 67697dcf

void XzSetMinSizeToProcess(int *param_1,undefined4 param_2)

{
                    /* 0x27dcf  51  XzSetMinSizeToProcess */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x70))(param_1,param_2);
  }
  return;
}



// Function: XzGetPreservePaths at 67697de4

bool XzGetPreservePaths(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x27de4  52  XzGetPreservePaths */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x84))(param_1,&local_8);
  }
  return (short)local_8 != 0;
}



// Function: XzSetPreservePaths at 67697e0d

void XzSetPreservePaths(int *param_1,int param_2)

{
                    /* 0x27e0d  53  XzSetPreservePaths */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x88))(param_1,-(uint)(param_2 != 0));
  }
  return;
}



// Function: XzGetProcessSubfolders at 67697e2a

bool XzGetProcessSubfolders(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x27e2a  54  XzGetProcessSubfolders */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x8c))(param_1,&local_8);
  }
  return (short)local_8 != 0;
}



// Function: XzSetProcessSubfolders at 67697e53

void XzSetProcessSubfolders(int *param_1,int param_2)

{
                    /* 0x27e53  55  XzSetProcessSubfolders */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x90))(param_1,-(uint)(param_2 != 0));
  }
  return;
}



// Function: XzGetRequiredFileAttributes at 67697e70

int * XzGetRequiredFileAttributes(int *param_1)

{
                    /* 0x27e70  56  XzGetRequiredFileAttributes */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x3c))(param_1,&param_1);
  }
  return param_1;
}



// Function: XzSetRequiredFileAttributes at 67697e8b

void XzSetRequiredFileAttributes(int *param_1,undefined4 param_2)

{
                    /* 0x27e8b  57  XzSetRequiredFileAttributes */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x40))(param_1,param_2);
  }
  return;
}



// Function: XzGetSfxBinaryModuleW at 67697ea0

void XzGetSfxBinaryModuleW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x27ea0  58  XzGetSfxBinaryModuleW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xf8))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetSfxBinaryModuleA at 67697ed1

void XzGetSfxBinaryModuleA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x27ed1  59  XzGetSfxBinaryModuleA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xf8))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetSfxBinaryModuleW at 67697f02

void XzSetSfxBinaryModuleW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x27f02  60  XzSetSfxBinaryModuleW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0xfc))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetSfxBinaryModuleA at 67697f2e

void XzSetSfxBinaryModuleA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x27f2e  61  XzSetSfxBinaryModuleA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0xfc))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetSfxButtonsW at 67697f5d

void XzGetSfxButtonsW(int *param_1,undefined4 param_2,uint param_3,undefined4 param_4)

{
  short *local_8;
  
                    /* 0x27f5d  62  XzGetSfxButtonsW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x100))(param_1,param_2,&local_8);
  }
  FUN_67695d32(param_3,param_4,local_8);
  return;
}



// Function: XzGetSfxButtonsA at 67697f91

void XzGetSfxButtonsA(int *param_1,undefined4 param_2,LPSTR param_3,uint param_4)

{
  LPCWSTR local_8;
  
                    /* 0x27f91  63  XzGetSfxButtonsA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x100))(param_1,param_2,&local_8);
  }
  FUN_67695d7f(param_3,param_4,local_8);
  return;
}



// Function: XzSetSfxButtonsW at 67697fc5

void XzSetSfxButtonsW(int *param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 uVar1;
  
                    /* 0x27fc5  64  XzSetSfxButtonsW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_3);
    (**(code **)(*param_1 + 0x104))(param_1,param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetSfxButtonsA at 67697ff5

void XzSetSfxButtonsA(int *param_1,undefined4 param_2,LPCSTR param_3)

{
  LPWSTR pWVar1;
  
                    /* 0x27ff5  65  XzSetSfxButtonsA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_3,-1);
    (**(code **)(*param_1 + 0x104))(param_1,param_2,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetSfxDefaultPasswordW at 67698028

void XzGetSfxDefaultPasswordW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x28028  66  XzGetSfxDefaultPasswordW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x118))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetSfxDefaultPasswordA at 67698059

void XzGetSfxDefaultPasswordA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x28059  67  XzGetSfxDefaultPasswordA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x118))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetSfxDefaultPasswordW at 6769808a

void XzSetSfxDefaultPasswordW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x2808a  68  XzSetSfxDefaultPasswordW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x11c))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetSfxDefaultPasswordA at 676980b6

void XzSetSfxDefaultPasswordA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x280b6  69  XzSetSfxDefaultPasswordA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x11c))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetSfxDefaultUnzipToFolderW at 676980e5

void XzGetSfxDefaultUnzipToFolderW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x280e5  70  XzGetSfxDefaultUnzipToFolderW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x120))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetSfxDefaultUnzipToFolderA at 67698116

void XzGetSfxDefaultUnzipToFolderA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x28116  71  XzGetSfxDefaultUnzipToFolderA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x120))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetSfxDefaultUnzipToFolderW at 67698147

void XzSetSfxDefaultUnzipToFolderW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x28147  72  XzSetSfxDefaultUnzipToFolderW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x124))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetSfxDefaultUnzipToFolderA at 67698173

void XzSetSfxDefaultUnzipToFolderA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x28173  73  XzSetSfxDefaultUnzipToFolderA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x124))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetSfxExistingFileBehavior at 676981a2

int * XzGetSfxExistingFileBehavior(int *param_1)

{
                    /* 0x281a2  74  XzGetSfxExistingFileBehavior */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x128))(param_1,&param_1);
  }
  return param_1;
}



// Function: XzSetSfxExistingFileBehavior at 676981c0

void XzSetSfxExistingFileBehavior(int *param_1,undefined4 param_2)

{
                    /* 0x281c0  75  XzSetSfxExistingFileBehavior */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 300))(param_1,param_2);
  }
  return;
}



// Function: XzGetSfxExtensionsToAssociateW at 676981d8

void XzGetSfxExtensionsToAssociateW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x281d8  76  XzGetSfxExtensionsToAssociateW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x158))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetSfxExtensionsToAssociateA at 67698209

void XzGetSfxExtensionsToAssociateA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x28209  77  XzGetSfxExtensionsToAssociateA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x158))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetSfxExtensionsToAssociateW at 6769823a

void XzSetSfxExtensionsToAssociateW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x2823a  78  XzSetSfxExtensionsToAssociateW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x15c))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetSfxExtensionsToAssociateA at 67698266

void XzSetSfxExtensionsToAssociateA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x28266  79  XzSetSfxExtensionsToAssociateA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x15c))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetSfxExecuteAfterW at 67698295

void XzGetSfxExecuteAfterW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x28295  175  XzGetSfxExecuteAfterW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x138))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetSfxExecuteAfterA at 676982c6

void XzGetSfxExecuteAfterA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x282c6  176  XzGetSfxExecuteAfterA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x138))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetSfxExecuteAfterW at 676982f7

void XzSetSfxExecuteAfterW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x282f7  177  XzSetSfxExecuteAfterW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x13c))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetSfxExecuteAfterA at 67698323

void XzSetSfxExecuteAfterA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x28323  178  XzSetSfxExecuteAfterA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x13c))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetSfxIconFilenameW at 67698352

void XzGetSfxIconFilenameW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x28352  80  XzGetSfxIconFilenameW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x160))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetSfxIconFilenameA at 67698383

void XzGetSfxIconFilenameA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x28383  81  XzGetSfxIconFilenameA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x160))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetSfxIconFilenameW at 676983b4

void XzSetSfxIconFilenameW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x283b4  82  XzSetSfxIconFilenameW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x164))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetSfxIconFilenameA at 676983e0

void XzSetSfxIconFilenameA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x283e0  83  XzSetSfxIconFilenameA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x164))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetSfxInstallMode at 6769840f

bool XzGetSfxInstallMode(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x2840f  84  XzGetSfxInstallMode */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x140))(param_1,&local_8);
  }
  return (short)local_8 != 0;
}



// Function: XzSetSfxInstallMode at 67698438

void XzSetSfxInstallMode(int *param_1,int param_2)

{
                    /* 0x28438  85  XzSetSfxInstallMode */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x144))(param_1,-(uint)(param_2 != 0));
  }
  return;
}



// Function: XzGetSfxMessagesW at 67698455

void XzGetSfxMessagesW(int *param_1,undefined4 param_2,uint param_3,undefined4 param_4)

{
  short *local_8;
  
                    /* 0x28455  86  XzGetSfxMessagesW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x108))(param_1,param_2,&local_8);
  }
  FUN_67695d32(param_3,param_4,local_8);
  return;
}



// Function: XzGetSfxMessagesA at 67698489

void XzGetSfxMessagesA(int *param_1,undefined4 param_2,LPSTR param_3,uint param_4)

{
  LPCWSTR local_8;
  
                    /* 0x28489  87  XzGetSfxMessagesA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x108))(param_1,param_2,&local_8);
  }
  FUN_67695d7f(param_3,param_4,local_8);
  return;
}



// Function: XzSetSfxMessagesW at 676984bd

void XzSetSfxMessagesW(int *param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 uVar1;
  
                    /* 0x284bd  88  XzSetSfxMessagesW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_3);
    (**(code **)(*param_1 + 0x10c))(param_1,param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetSfxMessagesA at 676984ed

void XzSetSfxMessagesA(int *param_1,undefined4 param_2,LPCSTR param_3)

{
  LPWSTR pWVar1;
  
                    /* 0x284ed  89  XzSetSfxMessagesA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_3,-1);
    (**(code **)(*param_1 + 0x10c))(param_1,param_2,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetSfxProgramGroupW at 67698520

void XzGetSfxProgramGroupW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x28520  90  XzGetSfxProgramGroupW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x148))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetSfxProgramGroupA at 67698551

void XzGetSfxProgramGroupA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x28551  91  XzGetSfxProgramGroupA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x148))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetSfxProgramGroupW at 67698582

void XzSetSfxProgramGroupW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x28582  92  XzSetSfxProgramGroupW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x14c))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetSfxProgramGroupA at 676985ae

void XzSetSfxProgramGroupA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x285ae  93  XzSetSfxProgramGroupA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x14c))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetSfxProgramGroupItemsW at 676985dd

void XzGetSfxProgramGroupItemsW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x285dd  94  XzGetSfxProgramGroupItemsW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x150))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetSfxProgramGroupItemsA at 6769860e

void XzGetSfxProgramGroupItemsA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x2860e  95  XzGetSfxProgramGroupItemsA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x150))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetSfxProgramGroupItemsW at 6769863f

void XzSetSfxProgramGroupItemsW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x2863f  96  XzSetSfxProgramGroupItemsW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x154))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetSfxProgramGroupItemsA at 6769866b

void XzSetSfxProgramGroupItemsA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x2866b  97  XzSetSfxProgramGroupItemsA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x154))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetSfxReadmeFileW at 6769869a

void XzGetSfxReadmeFileW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x2869a  98  XzGetSfxReadmeFileW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x130))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetSfxReadmeFileA at 676986cb

void XzGetSfxReadmeFileA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x286cb  99  XzGetSfxReadmeFileA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x130))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetSfxReadmeFileW at 676986fc

void XzSetSfxReadmeFileW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x286fc  100  XzSetSfxReadmeFileW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x134))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetSfxReadmeFileA at 67698728

void XzSetSfxReadmeFileA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x28728  101  XzSetSfxReadmeFileA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x134))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetSfxStringsW at 67698757

void XzGetSfxStringsW(int *param_1,undefined4 param_2,uint param_3,undefined4 param_4)

{
  short *local_8;
  
                    /* 0x28757  102  XzGetSfxStringsW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x110))(param_1,param_2,&local_8);
  }
  FUN_67695d32(param_3,param_4,local_8);
  return;
}



// Function: XzGetSfxStringsA at 6769878b

void XzGetSfxStringsA(int *param_1,undefined4 param_2,LPSTR param_3,uint param_4)

{
  LPCWSTR local_8;
  
                    /* 0x2878b  103  XzGetSfxStringsA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x110))(param_1,param_2,&local_8);
  }
  FUN_67695d7f(param_3,param_4,local_8);
  return;
}



// Function: XzSetSfxStringsW at 676987bf

void XzSetSfxStringsW(int *param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 uVar1;
  
                    /* 0x287bf  104  XzSetSfxStringsW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_3);
    (**(code **)(*param_1 + 0x114))(param_1,param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetSfxStringsA at 676987ef

void XzSetSfxStringsA(int *param_1,undefined4 param_2,LPCSTR param_3)

{
  LPWSTR pWVar1;
  
                    /* 0x287ef  105  XzSetSfxStringsA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_3,-1);
    (**(code **)(*param_1 + 0x114))(param_1,param_2,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetSkipIfExisting at 67698822

bool XzGetSkipIfExisting(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x28822  106  XzGetSkipIfExisting */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x94))(param_1,&local_8);
  }
  return (short)local_8 != 0;
}



// Function: XzSetSkipIfExisting at 6769884b

void XzSetSkipIfExisting(int *param_1,int param_2)

{
                    /* 0x2884b  107  XzSetSkipIfExisting */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x98))(param_1,-(uint)(param_2 != 0));
  }
  return;
}



// Function: XzGetSkipIfNotExisting at 67698868

bool XzGetSkipIfNotExisting(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x28868  108  XzGetSkipIfNotExisting */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x9c))(param_1,&local_8);
  }
  return (short)local_8 != 0;
}



// Function: XzSetSkipIfNotExisting at 67698891

void XzSetSkipIfNotExisting(int *param_1,int param_2)

{
                    /* 0x28891  109  XzSetSkipIfNotExisting */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xa0))(param_1,-(uint)(param_2 != 0));
  }
  return;
}



// Function: XzGetSkipIfOlderDate at 676988ae

bool XzGetSkipIfOlderDate(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x288ae  110  XzGetSkipIfOlderDate */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xa4))(param_1,&local_8);
  }
  return (short)local_8 != 0;
}



// Function: XzSetSkipIfOlderDate at 676988d7

void XzSetSkipIfOlderDate(int *param_1,int param_2)

{
                    /* 0x288d7  111  XzSetSkipIfOlderDate */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xa8))(param_1,-(uint)(param_2 != 0));
  }
  return;
}



// Function: XzGetSkipIfOlderVersion at 676988f4

bool XzGetSkipIfOlderVersion(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x288f4  112  XzGetSkipIfOlderVersion */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xac))(param_1,&local_8);
  }
  return (short)local_8 != 0;
}



// Function: XzSetSkipIfOlderVersion at 6769891d

void XzSetSkipIfOlderVersion(int *param_1,int param_2)

{
                    /* 0x2891d  113  XzSetSkipIfOlderVersion */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xb0))(param_1,-(uint)(param_2 != 0));
  }
  return;
}



// Function: XzGetSpanMultipleDisks at 6769893a

int * XzGetSpanMultipleDisks(int *param_1)

{
                    /* 0x2893a  114  XzGetSpanMultipleDisks */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xd8))(param_1,&param_1);
  }
  return param_1;
}



// Function: XzSetSpanMultipleDisks at 67698958

void XzSetSpanMultipleDisks(int *param_1,undefined4 param_2)

{
                    /* 0x28958  115  XzSetSpanMultipleDisks */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xdc))(param_1,param_2);
  }
  return;
}



// Function: XzGetSplitSize at 67698970

undefined4 XzGetSplitSize(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x28970  116  XzGetSplitSize */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x7c))(param_1,&local_8);
  }
  return local_8;
}



// Function: XzSetSplitSize at 67698990

void XzSetSplitSize(int *param_1,undefined4 param_2)

{
                    /* 0x28990  117  XzSetSplitSize */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x80))(param_1,param_2);
  }
  return;
}



// Function: XzGetTempFolderW at 676989a8

void XzGetTempFolderW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x289a8  118  XzGetTempFolderW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xb4))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetTempFolderA at 676989d9

void XzGetTempFolderA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x289d9  119  XzGetTempFolderA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xb4))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetTempFolderW at 67698a0a

void XzSetTempFolderW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x28a0a  120  XzSetTempFolderW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0xb8))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetTempFolderA at 67698a36

void XzSetTempFolderA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x28a36  121  XzSetTempFolderA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0xb8))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetUnzipToFolderW at 67698a65

void XzGetUnzipToFolderW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x28a65  122  XzGetUnzipToFolderW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xc4))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetUnzipToFolderA at 67698a96

void XzGetUnzipToFolderA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x28a96  123  XzGetUnzipToFolderA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xc4))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetUnzipToFolderW at 67698ac7

void XzSetUnzipToFolderW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x28ac7  124  XzSetUnzipToFolderW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 200))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetUnzipToFolderA at 67698af3

void XzSetUnzipToFolderA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x28af3  125  XzSetUnzipToFolderA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 200))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetUseTempFile at 67698b22

bool XzGetUseTempFile(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x28b22  126  XzGetUseTempFile */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xbc))(param_1,&local_8);
  }
  return (short)local_8 != 0;
}



// Function: XzSetUseTempFile at 67698b4b

void XzSetUseTempFile(int *param_1,int param_2)

{
                    /* 0x28b4b  127  XzSetUseTempFile */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xc0))(param_1,-(uint)(param_2 != 0));
  }
  return;
}



// Function: XzGetZipFilenameW at 67698b68

void XzGetZipFilenameW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x28b68  128  XzGetZipFilenameW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xcc))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetZipFilenameA at 67698b99

void XzGetZipFilenameA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x28b99  129  XzGetZipFilenameA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xcc))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetZipFilenameW at 67698bca

void XzSetZipFilenameW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x28bca  130  XzSetZipFilenameW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0xd0))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetZipFilenameA at 67698bf6

void XzSetZipFilenameA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x28bf6  131  XzSetZipFilenameA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0xd0))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetZipOpenedFiles at 67698c25

bool XzGetZipOpenedFiles(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x28c25  132  XzGetZipOpenedFiles */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xe8))(param_1,&local_8);
  }
  return (short)local_8 != 0;
}



// Function: XzSetZipOpenedFiles at 67698c4e

void XzSetZipOpenedFiles(int *param_1,int param_2)

{
                    /* 0x28c4e  133  XzSetZipOpenedFiles */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0xec))(param_1,-(uint)(param_2 != 0));
  }
  return;
}



// Function: XzGetSfxFilesToCopyW at 67698c6b

void XzGetSfxFilesToCopyW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x28c6b  179  XzGetSfxFilesToCopyW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1c8))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetSfxFilesToCopyA at 67698c9c

void XzGetSfxFilesToCopyA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x28c9c  180  XzGetSfxFilesToCopyA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1c8))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetSfxFilesToCopyW at 67698ccd

void XzSetSfxFilesToCopyW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x28ccd  181  XzSetSfxFilesToCopyW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x1cc))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetSfxFilesToCopyA at 67698cf9

void XzSetSfxFilesToCopyA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x28cf9  182  XzSetSfxFilesToCopyA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x1cc))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetSfxFilesToRegisterW at 67698d28

void XzGetSfxFilesToRegisterW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x28d28  183  XzGetSfxFilesToRegisterW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1d0))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetSfxFilesToRegisterA at 67698d59

void XzGetSfxFilesToRegisterA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x28d59  184  XzGetSfxFilesToRegisterA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1d0))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetSfxFilesToRegisterW at 67698d8a

void XzSetSfxFilesToRegisterW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x28d8a  185  XzSetSfxFilesToRegisterW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x1d4))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetSfxFilesToRegisterA at 67698db6

void XzSetSfxFilesToRegisterA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x28db6  186  XzSetSfxFilesToRegisterA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x1d4))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetSfxRegistryKeysW at 67698de5

void XzGetSfxRegistryKeysW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x28de5  187  XzGetSfxRegistryKeysW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1d8))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XzGetSfxRegistryKeysA at 67698e16

void XzGetSfxRegistryKeysA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x28e16  188  XzGetSfxRegistryKeysA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1d8))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XzSetSfxRegistryKeysW at 67698e47

void XzSetSfxRegistryKeysW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x28e47  189  XzSetSfxRegistryKeysW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x1dc))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XzSetSfxRegistryKeysA at 67698e73

void XzSetSfxRegistryKeysA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x28e73  190  XzSetSfxRegistryKeysA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x1dc))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XzGetDeleteZippedFiles at 67698ea2

bool XzGetDeleteZippedFiles(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x28ea2  191  XzGetDeleteZippedFiles */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1e0))(param_1,&local_8);
  }
  return (short)local_8 != 0;
}



// Function: XzSetDeleteZippedFiles at 67698ecb

void XzSetDeleteZippedFiles(int *param_1,int param_2)

{
                    /* 0x28ecb  192  XzSetDeleteZippedFiles */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1e4))(param_1,-(uint)(param_2 != 0));
  }
  return;
}



// Function: XzGetFirstDiskFreeSpace at 67698ee8

undefined4 XzGetFirstDiskFreeSpace(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x28ee8  201  XzGetFirstDiskFreeSpace */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1e8))(param_1,&local_8);
  }
  return local_8;
}



// Function: XzSetFirstDiskFreeSpace at 67698f0b

void XzSetFirstDiskFreeSpace(int *param_1,undefined4 param_2)

{
                    /* 0x28f0b  202  XzSetFirstDiskFreeSpace */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1ec))(param_1,param_2);
  }
  return;
}



// Function: XzGetMinDiskFreeSpace at 67698f23

undefined4 XzGetMinDiskFreeSpace(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x28f23  203  XzGetMinDiskFreeSpace */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1f0))(param_1,&local_8);
  }
  return local_8;
}



// Function: XzSetMinDiskFreeSpace at 67698f46

void XzSetMinDiskFreeSpace(int *param_1,undefined4 param_2)

{
                    /* 0x28f46  204  XzSetMinDiskFreeSpace */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 500))(param_1,param_2);
  }
  return;
}



// Function: XzGetEventsToTrigger at 67698f5e

undefined4 XzGetEventsToTrigger(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x28f5e  205  XzGetEventsToTrigger */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1f8))(param_1,&local_8);
  }
  return local_8;
}



// Function: XzSetEventsToTrigger at 67698f81

void XzSetEventsToTrigger(int *param_1,undefined4 param_2)

{
                    /* 0x28f81  206  XzSetEventsToTrigger */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1ec))(param_1,param_2);
  }
  return;
}



// Function: XzGetCompressionMethod at 67698f99

undefined4 XzGetCompressionMethod(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x28f99  213  XzGetCompressionMethod */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x214))(param_1,&local_8);
  }
  return local_8;
}



// Function: XzSetCompressionMethod at 67698fbc

void XzSetCompressionMethod(int *param_1,undefined4 param_2)

{
                    /* 0x28fbc  214  XzSetCompressionMethod */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x218))(param_1,param_2);
  }
  return;
}



// Function: XzGetUse64BitEvents at 67698fd4

bool XzGetUse64BitEvents(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x28fd4  217  XzGetUse64BitEvents */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x21c))(param_1,&local_8);
  }
  return (short)local_8 != 0;
}



// Function: XzSetUse64BitEvents at 67698ffd

void XzSetUse64BitEvents(int *param_1,int param_2)

{
                    /* 0x28ffd  218  XzSetUse64BitEvents */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x220))(param_1,-(uint)(param_2 != 0));
  }
  return;
}



// Function: XcGetEncryptionPasswordW at 6769901a

void XcGetEncryptionPasswordW(int *param_1,uint param_2,undefined4 param_3)

{
  short *local_8;
  
                    /* 0x2901a  134  XcGetEncryptionPasswordW */
  local_8 = (short *)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x24))(param_1,&local_8);
  }
  FUN_67695d32(param_2,param_3,local_8);
  return;
}



// Function: XcGetEncryptionPasswordA at 67699048

void XcGetEncryptionPasswordA(int *param_1,LPSTR param_2,uint param_3)

{
  LPCWSTR local_8;
  
                    /* 0x29048  135  XcGetEncryptionPasswordA */
  local_8 = (LPCWSTR)0x0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x24))(param_1,&local_8);
  }
  FUN_67695d7f(param_2,param_3,local_8);
  return;
}



// Function: XcSetEncryptionPasswordW at 67699076

void XcSetEncryptionPasswordW(int *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
                    /* 0x29076  136  XcSetEncryptionPasswordW */
  if (param_1 != (int *)0x0) {
    uVar1 = Ordinal_2(param_2);
    (**(code **)(*param_1 + 0x28))(param_1,uVar1);
    Ordinal_6(uVar1);
  }
  return;
}



// Function: XcSetEncryptionPasswordA at 6769909f

void XcSetEncryptionPasswordA(int *param_1,LPCSTR param_2)

{
  LPWSTR pWVar1;
  
                    /* 0x2909f  137  XcSetEncryptionPasswordA */
  if (param_1 != (int *)0x0) {
    pWVar1 = FUN_67684ed6(param_2,-1);
    (**(code **)(*param_1 + 0x28))(param_1,pWVar1);
    Ordinal_6(pWVar1);
  }
  return;
}



// Function: XcGetCompressionLevel at 676990cb

undefined4 XcGetCompressionLevel(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x290cb  138  XcGetCompressionLevel */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x1c))(param_1,&local_8);
  }
  return local_8;
}



// Function: XcSetCompressionLevel at 676990eb

void XcSetCompressionLevel(int *param_1,undefined4 param_2)

{
                    /* 0x290eb  139  XcSetCompressionLevel */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x20))(param_1,param_2);
  }
  return;
}



// Function: XcGetCompressionMethod at 67699100

undefined4 XcGetCompressionMethod(int *param_1)

{
  undefined4 local_8;
  
                    /* 0x29100  215  XcGetCompressionMethod */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x44))(param_1,&local_8);
  }
  return local_8;
}



// Function: XcSetCompressionMethod at 67699120

void XcSetCompressionMethod(int *param_1,undefined4 param_2)

{
                    /* 0x29120  216  XcSetCompressionMethod */
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x48))(param_1,param_2);
  }
  return;
}



// Function: FUN_67699135 at 67699135

undefined4 FUN_67699135(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = Ordinal_7(*(undefined4 *)(param_1 + 0x19c));
    uVar1 = Ordinal_4(*(undefined4 *)(param_1 + 0x19c),uVar1);
    *param_2 = uVar1;
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_676991f7 at 676991f7

undefined4 FUN_676991f7(int param_1,int param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x1d0));
  if (*(char *)(param_1 + 0x1cc) == '\0') {
    uVar1 = 0x800a0183;
  }
  else {
    *(int *)(param_1 + 0x194) = param_2 % 10;
    FUN_6767e856((void *)(param_1 + 0xb8),param_2 % 10);
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x1d0));
  return uVar1;
}



// Function: FUN_676992e9 at 676992e9

undefined4 FUN_676992e9(undefined4 param_1,int param_2,short *param_3)

{
  short *psVar1;
  char cVar2;
  undefined4 uVar3;
  
  psVar1 = param_3;
  if (param_3 == (short *)0x0) {
    uVar3 = 0x80004003;
  }
  else {
    cVar2 = FUN_6768eda2(&param_2,(HKEY__)(-(uint)(param_2 != 0) & (uint)&param_2),
                         (char *)((int)&param_3 + 3));
    *psVar1 = -(ushort)(cVar2 != '\0');
    uVar3 = 0;
  }
  return uVar3;
}



// Function: FUN_67699321 at 67699321

int FUN_67699321(int *param_1,int param_2,undefined4 *param_3)

{
  int iVar1;
  int iVar2;
  undefined1 local_1c [4];
  undefined4 *local_18;
  int local_14;
  int *local_10;
  int *local_c;
  int *local_8;
  
  if (param_3 == (undefined4 *)0x0) {
    iVar1 = -0x7fffbffd;
  }
  else {
    *param_3 = 0;
    local_10 = (int *)0x0;
    local_c = (int *)0x0;
    local_8 = (int *)0x0;
    iVar1 = (**(code **)*param_1)(param_1,&DAT_676bb580,&local_c);
    if (((-1 < iVar1) && (iVar1 = (**(code **)(*local_c + 0xc))(local_c,&local_8), -1 < iVar1)) &&
       (iVar1 = (**(code **)(*local_8 + 0x48))(local_8,&local_10,local_1c), -1 < iVar1)) {
      param_1 = (int *)0x0;
      iVar1 = (**(code **)(*local_10 + 0x18))(local_10,&DAT_676ba850,&param_1);
      if (-1 < iVar1) {
        iVar1 = (**(code **)(*param_1 + 0xc))(param_1,&local_14);
        if (-1 < iVar1) {
          if (*(int *)(local_14 + 0x28) != 0) {
            (**(code **)(*param_1 + 0x4c))(param_1,local_14);
            if (param_1 != (int *)0x0) {
              (**(code **)(*param_1 + 8))(param_1);
            }
            if (local_8 != (int *)0x0) {
              (**(code **)(*local_8 + 8))(local_8);
            }
            if (local_c != (int *)0x0) {
              (**(code **)(*local_c + 8))(local_c);
            }
            if (local_10 != (int *)0x0) {
              (**(code **)(*local_10 + 8))(local_10);
            }
            return -0x7fff0001;
          }
          iVar2 = 0;
          if (*(short *)(local_14 + 0x2e) != 0) {
            while (iVar1 = (**(code **)(*param_1 + 0x18))(param_1,iVar2,&local_18), -1 < iVar1) {
              if (*(int *)(local_18[2] + 8) == param_2) {
                iVar1 = (**(code **)(*param_1 + 0x30))(param_1,*local_18,0,param_3,0,0);
              }
              (**(code **)(*param_1 + 0x54))(param_1,local_18);
              if ((iVar1 < 0) ||
                 (iVar2 = iVar2 + 1, (int)(uint)*(ushort *)(local_14 + 0x2e) <= iVar2)) break;
            }
          }
          (**(code **)(*param_1 + 0x4c))(param_1,local_14);
        }
        if (param_1 != (int *)0x0) {
          (**(code **)(*param_1 + 8))(param_1);
        }
        if (local_8 != (int *)0x0) {
          (**(code **)(*local_8 + 8))(local_8);
        }
        if (local_c != (int *)0x0) {
          (**(code **)(*local_c + 8))(local_c);
        }
        if (local_10 == (int *)0x0) {
          return iVar1;
        }
        (**(code **)(*local_10 + 8))(local_10);
        return iVar1;
      }
      if (param_1 != (int *)0x0) {
        (**(code **)(*param_1 + 8))(param_1);
      }
    }
    if (local_8 != (int *)0x0) {
      (**(code **)(*local_8 + 8))(local_8);
    }
    if (local_c != (int *)0x0) {
      (**(code **)(*local_c + 8))(local_c);
    }
    if (local_10 != (int *)0x0) {
      (**(code **)(*local_10 + 8))(local_10);
    }
  }
  return iVar1;
}



// Function: FUN_676994e9 at 676994e9

int __thiscall FUN_676994e9(void *this,ushort *param_1,int *param_2,int *param_3)

{
  ushort uVar1;
  undefined4 *puVar2;
  int iVar3;
  int iVar4;
  ushort uVar5;
  void *local_8;
  
  uVar1 = *param_1;
  uVar5 = uVar1 & 0xbfff;
  if ((uVar1 & 0xbfff) == 0) {
LAB_676995d7:
    iVar3 = 0;
  }
  else {
    local_8 = this;
    if (uVar5 == 8) {
      if ((uVar1 & 0x4000) == 0) {
        iVar3 = *(int *)(param_1 + 4);
      }
      else {
        if (*(int **)(param_1 + 4) == (int *)0x0) goto LAB_676995a8;
        iVar3 = **(int **)(param_1 + 4);
      }
      if (iVar3 != 0) {
        iVar4 = Ordinal_149(iVar3);
        *param_3 = iVar4;
        *param_2 = iVar3;
        goto LAB_676995d7;
      }
    }
    else if ((0x200f < uVar5) && (uVar5 < 0x2012)) {
      puVar2 = *(undefined4 **)(param_1 + 4);
      if ((uVar1 & 0x4000) != 0) {
        if (puVar2 == (undefined4 *)0x0) goto LAB_676995a8;
        puVar2 = (undefined4 *)*puVar2;
      }
      *(undefined4 **)((int)this + 0xb4) = puVar2;
      if (((puVar2 != (undefined4 *)0x0) && (iVar3 = Ordinal_17(puVar2), iVar3 == 1)) &&
         (iVar3 = Ordinal_18(*(undefined4 *)((int)this + 0xb4)), iVar3 == 1)) {
        iVar3 = Ordinal_19(*(undefined4 *)((int)this + 0xb4),1,&param_1);
        if (iVar3 < 0) {
          return iVar3;
        }
        iVar3 = Ordinal_20(*(undefined4 *)((int)this + 0xb4),1,&local_8);
        if (iVar3 < 0) {
          return iVar3;
        }
        *param_3 = (int)param_1 + (1 - (int)local_8);
        iVar3 = Ordinal_23(*(undefined4 *)((int)this + 0xb4),param_2);
        if (iVar3 < 0) {
          return iVar3;
        }
        goto LAB_676995d7;
      }
    }
LAB_676995a8:
    iVar3 = -0x7ff8ffa9;
  }
  return iVar3;
}



// Function: FUN_676995de at 676995de

void __fastcall FUN_676995de(int param_1)

{
  if (*(int *)(param_1 + 0xb4) != 0) {
    Ordinal_24(*(int *)(param_1 + 0xb4));
    *(undefined4 *)(param_1 + 0xb4) = 0;
  }
  return;
}



// Function: FUN_676995fb at 676995fb

int FUN_676995fb(void *param_1,ushort *param_2,undefined2 *param_3,short param_4,int *param_5)

{
  LPCRITICAL_SECTION lpCriticalSection;
  LPCWSTR lpString;
  void *pvVar1;
  byte bVar2;
  undefined4 uVar3;
  int iVar4;
  byte *pbVar5;
  int iVar6;
  void *pvVar7;
  undefined1 *local_30;
  undefined1 local_2c [4];
  undefined4 uStack_28;
  undefined4 uStack_24;
  undefined4 uStack_20;
  byte *local_1c;
  uint local_18;
  void *local_14;
  undefined4 *local_10;
  byte *local_c;
  int local_8;
  
  iVar6 = 0;
  if (((param_2 == (ushort *)0x0) || (param_3 == (undefined2 *)0x0)) || (param_5 == (int *)0x0)) {
    return -0x7fffbffd;
  }
  uVar3 = FUN_6769a1d9();
  if ((char)uVar3 == '\0') {
    *param_5 = 0x3ef;
    return 0;
  }
  lpCriticalSection = (LPCRITICAL_SECTION)((int)param_1 + 0x1d0);
  EnterCriticalSection(lpCriticalSection);
  if (*(char *)((int)param_1 + 0x1cc) == '\0') {
    LeaveCriticalSection(lpCriticalSection);
    *param_5 = 0x3f0;
    return 0;
  }
  *(undefined1 *)((int)param_1 + 0x1cc) = 0;
  LeaveCriticalSection(lpCriticalSection);
  Ordinal_8();
  local_1c = (byte *)0x0;
  local_18 = 0;
  iVar4 = FUN_676994e9(param_1,param_2,(int *)&local_1c,(int *)&local_18);
  if (iVar4 < 0) goto LAB_67699988;
  if (local_18 == 0) {
    local_1c = (byte *)0x0;
  }
  if (((*(char *)((int)param_1 + 0x1a0) == '\0') && (*(int *)((int)param_1 + 0x19c) != 0)) &&
     (iVar4 = Ordinal_7(*(int *)((int)param_1 + 0x19c)), iVar4 != 0)) {
    local_30 = (undefined1 *)0x0;
    local_2c = (undefined1  [4])0x0;
    uStack_28 = 0;
    uStack_24 = 0;
    uStack_20 = 0;
    lpString = *(LPCWSTR *)((int)param_1 + 0x19c);
    if (lpString == (LPCWSTR)0x0) {
      local_30 = (undefined1 *)0x0;
    }
    else {
      iVar4 = lstrlenW(lpString);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,lpString,-1,&stack0xffffffc0,iVar4 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
      local_30 = &stack0xffffffc0;
    }
    iVar4 = FUN_6767e8a9((void *)((int)param_1 + 0xb8),&local_30);
    *param_5 = iVar4;
    if ((iVar4 < 1000) || (0x3ee < iVar4)) {
      FUN_6767e890((void *)((int)param_1 + 0xb8),1);
      FUN_676b06d0((undefined4 *)((int)param_1 + 0x1a2),(undefined4 *)(local_2c + 2),0xc);
    }
  }
  local_10 = (undefined4 *)0x0;
  local_14 = (void *)0x0;
  if ((*param_5 < 1000) || (0x3ee < *param_5)) {
    iVar4 = FUN_6767e984((void *)((int)param_1 + 0xb8),local_1c,local_18,&local_10,&local_14,
                         param_4 != 0);
    *param_5 = iVar4;
  }
  pvVar1 = local_14;
  FUN_676995de((int)param_1);
  if ((999 < *param_5) && (iVar4 = iVar6, *param_5 < 0x3ef)) goto LAB_67699988;
  pvVar7 = pvVar1;
  if (*(char *)((int)param_1 + 0x1a0) == '\0') {
    pvVar7 = (void *)((int)pvVar1 + 1);
    if ((*(int *)((int)param_1 + 0x19c) != 0) &&
       (iVar4 = Ordinal_7(*(int *)((int)param_1 + 0x19c)), iVar4 != 0)) {
      pvVar7 = (void *)((int)pvVar1 + 0xd);
    }
  }
  if (param_4 != 0) {
    pvVar7 = (void *)((int)pvVar7 + 4);
  }
  local_8 = 0;
  iVar4 = Ordinal_36(1,&local_8);
  if ((-1 < iVar4) && (local_8 != 0)) {
    *(undefined2 *)(local_8 + 2) = 0x10;
    *(undefined4 *)(local_8 + 4) = 1;
    *(void **)(local_8 + 0x10) = pvVar7;
    *(undefined4 *)(local_8 + 0x14) = 0;
    *(undefined4 *)(local_8 + 0xc) = 0;
    iVar4 = Ordinal_37(local_8);
    if (-1 < iVar4) {
      iVar4 = Ordinal_23(local_8,&local_c);
      pbVar5 = local_c;
      if (iVar4 < 0) {
        FUN_6767ebd6(local_10);
        goto LAB_67699988;
      }
      if (*(char *)((int)param_1 + 0x1a0) == '\0') {
        local_c = local_c + 1;
        _memset(pbVar5,0,1);
        if ((*(int *)((int)param_1 + 0x19c) != 0) &&
           (iVar4 = Ordinal_7(*(int *)((int)param_1 + 0x19c)), iVar4 != 0)) {
          *pbVar5 = *pbVar5 | 1;
          FUN_676b06d0((undefined4 *)local_c,(undefined4 *)((int)param_1 + 0x1a2),0xc);
          local_c = local_c + 0xc;
        }
        iVar4 = *(int *)((int)param_1 + 0x198);
        if (iVar4 == 0) {
          bVar2 = *pbVar5 & 0xf | 0x10;
        }
        else {
          if (iVar4 == 8) {
            *pbVar5 = *pbVar5 & 0xf;
            goto LAB_676998f6;
          }
          if (iVar4 == 9) {
            bVar2 = *pbVar5 & 0xf | 0x30;
          }
          else {
            if (iVar4 != 0x12) goto LAB_676998f6;
            bVar2 = *pbVar5 & 0xf | 0x20;
          }
        }
        *pbVar5 = bVar2;
      }
LAB_676998f6:
      if (((*param_5 < 1000) || (0x3ee < *param_5)) &&
         (FUN_676b06d0((undefined4 *)local_c,local_10,(uint)local_14), param_4 != 0)) {
        pbVar5 = local_c + (int)local_14;
        local_c = pbVar5;
        uVar3 = FUN_6767e980((int)param_1 + 0xb8);
        *(undefined4 *)pbVar5 = uVar3;
      }
      FUN_6767ebd6(local_10);
      iVar4 = Ordinal_24(local_8);
      if (-1 < iVar4) {
        *param_3 = 0x2011;
        *(int *)(param_3 + 4) = local_8;
        *(bool *)((int)param_1 + 0x1a0) = param_4 == 0;
        iVar4 = iVar6;
        if (param_4 != 0) {
          _memset((void *)((int)param_1 + 0x1a2),0,0xc);
        }
      }
      goto LAB_67699988;
    }
    Ordinal_38(local_8);
  }
  FUN_6767ebd6(local_10);
  iVar4 = -0x7ff5fff9;
LAB_67699988:
  EnterCriticalSection((LPCRITICAL_SECTION)((int)param_1 + 0x1d0));
  *(undefined1 *)((int)param_1 + 0x1cc) = 1;
  LeaveCriticalSection((LPCRITICAL_SECTION)((int)param_1 + 0x1d0));
  return iVar4;
}



// Function: FUN_676999b6 at 676999b6

int FUN_676999b6(void *param_1,ushort *param_2,undefined2 *param_3,short param_4,uint *param_5)

{
  LPCRITICAL_SECTION lpCriticalSection;
  LPCWSTR lpString;
  byte bVar1;
  undefined4 uVar2;
  int iVar3;
  uint uVar4;
  undefined4 *puVar5;
  int *piVar6;
  int iVar7;
  uint *puVar8;
  char cVar9;
  ushort **ppuVar10;
  undefined4 **ppuVar11;
  uint *puVar12;
  undefined1 *local_3c;
  undefined1 local_38 [4];
  undefined4 uStack_34;
  undefined4 uStack_30;
  undefined4 uStack_2c;
  undefined4 *local_28;
  uint local_24;
  uint local_20;
  uint local_1c;
  undefined4 *local_18;
  uint local_14;
  int local_10;
  uint local_c;
  byte *local_8;
  
  puVar8 = param_5;
  if (((param_2 == (ushort *)0x0) || (param_3 == (undefined2 *)0x0)) || (param_5 == (uint *)0x0)) {
    return -0x7fffbffd;
  }
  *param_5 = 0;
  uVar2 = FUN_6769a1d9();
  if ((char)uVar2 == '\0') {
    *puVar8 = 0x3ef;
    return 0;
  }
  lpCriticalSection = (LPCRITICAL_SECTION)((int)param_1 + 0x1d0);
  EnterCriticalSection(lpCriticalSection);
  if (*(char *)((int)param_1 + 0x1cc) == '\0') {
    LeaveCriticalSection(lpCriticalSection);
    *puVar8 = 0x3f0;
    return 0;
  }
  *(undefined1 *)((int)param_1 + 0x1cc) = 0;
  LeaveCriticalSection(lpCriticalSection);
  Ordinal_8();
  local_8 = (byte *)0x0;
  local_c = 0;
  iVar3 = FUN_676994e9(param_1,param_2,(int *)&local_8,(int *)&local_c);
  if (iVar3 < 0) goto LAB_67699ed6;
  if (local_c == 0) {
    local_8 = (byte *)0x0;
  }
  if ((*(char *)((int)param_1 + 0x1a0) == '\0') && (local_8 != (byte *)0x0)) {
    *(byte *)((int)param_1 + 0x1a1) = *local_8 & 1;
    bVar1 = *local_8 >> 4;
    if (bVar1 == 0) {
      iVar3 = 8;
LAB_67699a9f:
      iVar3 = FUN_6767e81f((void *)((int)param_1 + 0xb8),iVar3);
      if (iVar3 == 0) {
        local_c = local_c - 1;
        local_8 = local_8 + 1;
        if (local_c == 0) {
          local_8 = (byte *)0x0;
        }
        goto LAB_67699ac8;
      }
    }
    else {
      if (bVar1 == 1) {
        iVar3 = 0;
        goto LAB_67699a9f;
      }
      if (bVar1 == 2) {
        iVar3 = 0x12;
        goto LAB_67699a9f;
      }
      if (bVar1 == 3) {
        iVar3 = 9;
        goto LAB_67699a9f;
      }
    }
    *puVar8 = 0x3ea;
LAB_67699ecd:
    FUN_67699f04((int)param_1);
  }
  else {
LAB_67699ac8:
    if (((*(char *)((int)param_1 + 0x1a1) != '\0') &&
        (iVar3 = *(int *)((int)param_1 + 0x1b0), iVar3 < 0xc)) && (local_8 != (byte *)0x0)) {
      uVar4 = 0xcU - iVar3;
      if (local_c <= 0xcU - iVar3) {
        uVar4 = local_c;
      }
      FUN_676b06d0((undefined4 *)(iVar3 + 0x1a2 + (int)param_1),(undefined4 *)local_8,uVar4);
      local_c = local_c - uVar4;
      *(int *)((int)param_1 + 0x1b0) = *(int *)((int)param_1 + 0x1b0) + uVar4;
      local_8 = local_8 + uVar4;
      puVar8 = param_5;
      if (local_c == 0) {
        local_8 = (byte *)0x0;
      }
    }
    if ((*(char *)((int)param_1 + 0x1a1) != '\0') && (*(int *)((int)param_1 + 0x1b0) == 0xc)) {
      local_3c = (undefined1 *)0x0;
      *(undefined4 *)((int)param_1 + 0x1b0) = 0xd;
      local_38 = (undefined1  [4])0x0;
      uStack_34 = 0;
      uStack_30 = 0;
      uStack_2c = 0;
      lpString = *(LPCWSTR *)((int)param_1 + 0x19c);
      if (lpString == (LPCWSTR)0x0) {
        local_3c = (undefined1 *)0x0;
      }
      else {
        iVar3 = lstrlenW(lpString);
        param_2 = (ushort *)(iVar3 * 2 + 2);
        FUN_676b06a0();
        WideCharToMultiByte(0,0,lpString,-1,&stack0xffffffb4,(int)param_2,(LPCSTR)0x0,(LPBOOL)0x0);
        local_3c = &stack0xffffffb4;
      }
      FUN_676b06d0((undefined4 *)(local_38 + 2),(undefined4 *)((int)param_1 + 0x1a2),0xc);
      uVar4 = FUN_6767e8a9((void *)((int)param_1 + 0xb8),&local_3c);
      *param_5 = uVar4;
      if (((int)uVar4 < 1000) || (puVar8 = param_5, 0x3ee < (int)uVar4)) {
        FUN_6767e890((void *)((int)param_1 + 0xb8),1);
        puVar8 = param_5;
      }
    }
    FUN_6769a0a4((void *)((int)param_1 + 0x1b4),(undefined4 *)local_8,local_c);
    FUN_6769a135((void *)((int)param_1 + 0x1b4),(int *)&local_1c);
    FUN_6769a153((void *)((int)param_1 + 0x1b4),(int *)&local_20);
    cVar9 = '\0';
    param_5 = (uint *)0x0;
    local_14 = 0;
    if ((local_1c != 0) && (((int)*puVar8 < 1000 || (0x3ee < (int)*puVar8)))) {
      param_2 = (ushort *)0x0;
      if ((param_4 != 0) && (local_20 == 0)) {
        cVar9 = '\x01';
      }
      puVar12 = &local_14;
      ppuVar10 = &param_2;
      uVar4 = local_1c;
      puVar5 = (undefined4 *)FUN_6769a135((void *)((int)param_1 + 0x1b4),(int *)&local_1c);
      uVar4 = FUN_6767ea8d((void *)((int)param_1 + 0xb8),puVar5,uVar4,ppuVar10,puVar12,cVar9);
      *puVar8 = uVar4;
      if ((((int)uVar4 < 1000) || (0x3ee < (int)uVar4)) && (local_14 != 0)) {
        param_5 = (uint *)operator_new(local_14);
        if (param_5 == (uint *)0x0) {
          FUN_67699f04((int)param_1);
          EnterCriticalSection((LPCRITICAL_SECTION)((int)param_1 + 0x1d0));
          *(undefined1 *)((int)param_1 + 0x1cc) = 1;
          LeaveCriticalSection((LPCRITICAL_SECTION)((int)param_1 + 0x1d0));
          return -0x7ff5fff9;
        }
        FUN_676b06d0(param_5,(undefined4 *)param_2,local_14);
      }
      FUN_6767ebd6(param_2);
    }
    local_18 = (undefined4 *)0x0;
    local_24 = 0;
    if ((((local_1c == 0) || (local_20 != 0)) || (param_4 == 0)) &&
       (((int)*puVar8 < 1000 || (0x3ee < (int)*puVar8)))) {
      cVar9 = param_4 != 0;
      puVar12 = &local_24;
      ppuVar11 = &local_18;
      puVar5 = (undefined4 *)FUN_6769a153((void *)((int)param_1 + 0x1b4),(int *)&local_20);
      uVar4 = FUN_6767ea8d((void *)((int)param_1 + 0xb8),puVar5,local_20,ppuVar11,puVar12,cVar9);
      *puVar8 = uVar4;
    }
    FUN_676995de((int)param_1);
    if ((param_4 != 0) && (((int)*puVar8 < 1000 || (0x3ee < (int)*puVar8)))) {
      param_2 = (ushort *)0x0;
      FUN_6769a171((void *)((int)param_1 + 0x1b4),(int *)&param_2);
      if (param_2 == (ushort *)0x4) {
        piVar6 = (int *)FUN_6769a171((void *)((int)param_1 + 0x1b4),(int *)&param_2);
        iVar3 = *piVar6;
        iVar7 = FUN_6767e980((int)param_1 + 0xb8);
        if (iVar3 == iVar7) goto LAB_67699d84;
      }
      *puVar8 = 0x3ed;
    }
LAB_67699d84:
    uVar4 = *puVar8;
    if (((999 < (int)uVar4) && ((int)uVar4 < 0x3ef)) && (uVar4 != 0x3ed)) {
      FUN_6767ebd6(local_18);
      goto LAB_67699ecd;
    }
    local_10 = 0;
    iVar3 = Ordinal_36(1,&local_10);
    if ((iVar3 < 0) || (local_10 == 0)) {
LAB_67699e08:
      FUN_6767ebd6(local_18);
      iVar3 = -0x7ff5fff9;
      goto LAB_67699ed6;
    }
    *(undefined2 *)(local_10 + 2) = 0x10;
    *(undefined4 *)(local_10 + 4) = 1;
    *(uint *)(local_10 + 0x10) = local_24 + local_14;
    *(undefined4 *)(local_10 + 0x14) = 0;
    *(undefined4 *)(local_10 + 0xc) = 0;
    iVar3 = Ordinal_37(local_10);
    if (iVar3 < 0) {
      Ordinal_38(local_10);
      goto LAB_67699e08;
    }
    iVar3 = Ordinal_23(local_10,&local_28);
    if (iVar3 < 0) {
      FUN_6767ebd6(local_18);
LAB_67699e41:
      FUN_67699f04((int)param_1);
      goto LAB_67699ed6;
    }
    if ((local_14 != 0) && (param_5 != (uint *)0x0)) {
      FUN_676b06d0(local_28,param_5,local_14);
      local_28 = (undefined4 *)((int)local_28 + local_14);
      FUN_676b0bb3((undefined *)param_5);
    }
    if ((local_24 != 0) && (local_18 != (undefined4 *)0x0)) {
      FUN_676b06d0(local_28,local_18,local_24);
    }
    FUN_6767ebd6(local_18);
    iVar3 = Ordinal_24(local_10);
    if (iVar3 < 0) goto LAB_67699e41;
    *param_3 = 0x2011;
    *(int *)(param_3 + 4) = local_10;
    *(bool *)((int)param_1 + 0x1a0) = param_4 == 0;
    if (param_4 != 0) goto LAB_67699ecd;
  }
  iVar3 = 0;
LAB_67699ed6:
  EnterCriticalSection((LPCRITICAL_SECTION)((int)param_1 + 0x1d0));
  *(undefined1 *)((int)param_1 + 0x1cc) = 1;
  LeaveCriticalSection((LPCRITICAL_SECTION)((int)param_1 + 0x1d0));
  return iVar3;
}



// Function: FUN_67699f04 at 67699f04

void __fastcall FUN_67699f04(int param_1)

{
  *(undefined1 *)(param_1 + 0x1a1) = 0;
  _memset((void *)(param_1 + 0x1a2),0,0xc);
  *(undefined4 *)(param_1 + 0x1b0) = 0;
  FUN_6769259c((void *)(param_1 + 0x1b4));
  return;
}



// Function: FUN_67699f35 at 67699f35

ushort * FUN_67699f35(void *param_1,ushort *param_2,uint param_3,uint *param_4)

{
  LPCRITICAL_SECTION lpCriticalSection;
  undefined4 uVar1;
  uint uVar2;
  byte *local_c;
  uint local_8;
  
  if ((param_4 == (uint *)0x0) || (param_2 == (ushort *)0x0)) {
    param_2 = (ushort *)0x80004003;
  }
  else {
    uVar1 = FUN_6769a1d9();
    if ((char)uVar1 == '\0') {
      param_2 = (ushort *)0x800a0046;
    }
    else {
      lpCriticalSection = (LPCRITICAL_SECTION)((int)param_1 + 0x1d0);
      EnterCriticalSection(lpCriticalSection);
      if (*(char *)((int)param_1 + 0x1cc) == '\0') {
        param_2 = (ushort *)0x800a0044;
      }
      else {
        *(undefined1 *)((int)param_1 + 0x1cc) = 0;
        LeaveCriticalSection(lpCriticalSection);
        local_c = (byte *)0x0;
        local_8 = 0;
        param_2 = (ushort *)FUN_676994e9(param_1,param_2,(int *)&local_c,(int *)&local_8);
        if (-1 < (int)param_2) {
          uVar2 = FUN_67677cc6(param_3,local_c,local_8);
          *param_4 = uVar2;
          FUN_676995de((int)param_1);
          param_2 = (ushort *)0x0;
        }
        EnterCriticalSection(lpCriticalSection);
        *(undefined1 *)((int)param_1 + 0x1cc) = 1;
      }
      LeaveCriticalSection(lpCriticalSection);
    }
  }
  return param_2;
}



// Function: FUN_67699ffc at 67699ffc

undefined4 FUN_67699ffc(void)

{
  HWND hWndParent;
  undefined **local_cc [2];
  undefined4 local_c4 [6];
  undefined1 local_ac [84];
  undefined1 local_58 [84];
  
  FUN_6769a06e(local_cc);
  local_cc[0] = &PTR_FUN_676ba860;
  hWndParent = GetActiveWindow();
  FUN_6769171f(0x676c5588,local_c4,local_cc);
  DialogBoxParamA(DAT_676c5590,(LPCSTR)0xca,hWndParent,(DLGPROC)&LAB_6769b218,0);
  FUN_6769a2ef((int)local_58);
  FUN_6769a2ef((int)local_ac);
  return 0;
}



// Function: FUN_6769a06e at 6769a06e

undefined4 * __fastcall FUN_6769a06e(undefined4 *param_1)

{
  param_1[1] = 0;
  param_1[6] = 0;
  FUN_6769a2a9((int)(param_1 + 8));
  param_1[8] = &PTR_FUN_676ba878;
  FUN_6769a2a9((int)(param_1 + 0x1d));
  param_1[0x1d] = &PTR_FUN_676ba878;
  *param_1 = &PTR_FUN_676ba86c;
  return param_1;
}



// Function: FUN_6769a0a4 at 6769a0a4

void __thiscall FUN_6769a0a4(void *this,undefined4 *param_1,uint param_2)

{
  uint uVar1;
  int iVar2;
  
  *(undefined4 *)((int)this + 0xc) = 0;
  *(undefined4 *)((int)this + 0x14) = 0;
  if ((param_1 != (undefined4 *)0x0) && (param_2 != 0)) {
    uVar1 = *(uint *)((int)this + 8) + param_2;
    if (4 < uVar1) {
      FUN_676b06d0((undefined4 *)((int)this + 4),(undefined4 *)this,*(uint *)((int)this + 8));
      if (3 < param_2) {
        *(undefined4 *)((int)this + 0xc) = *(undefined4 *)((int)this + 8);
        *(uint *)((int)this + 0x14) = param_2 - 4;
        *(undefined4 **)((int)this + 0x10) = param_1;
        FUN_676b06d0((undefined4 *)this,(undefined4 *)((param_2 - 4) + (int)param_1),4);
        *(undefined4 *)((int)this + 8) = 4;
        return;
      }
      iVar2 = uVar1 - 4;
      *(int *)((int)this + 0xc) = iVar2;
                    /* WARNING: Load size is inaccurate */
      *(uint *)this = *this >> ((char)iVar2 * '\b' & 0x1fU);
      *(int *)((int)this + 8) = *(int *)((int)this + 8) - iVar2;
    }
    FUN_676b06d0((undefined4 *)(*(int *)((int)this + 8) + (int)this),param_1,param_2);
    *(int *)((int)this + 8) = *(int *)((int)this + 8) + param_2;
  }
  return;
}



// Function: FUN_6769a135 at 6769a135

int __thiscall FUN_6769a135(void *this,int *param_1)

{
  int iVar1;
  
  if (*(int *)((int)this + 0xc) == 0) {
    *param_1 = 0;
    iVar1 = 0;
  }
  else {
    *param_1 = *(int *)((int)this + 0xc);
    iVar1 = (int)this + 4;
  }
  return iVar1;
}



// Function: FUN_6769a153 at 6769a153

undefined4 __thiscall FUN_6769a153(void *this,int *param_1)

{
  undefined4 uVar1;
  
  if (*(int *)((int)this + 0x14) == 0) {
    *param_1 = 0;
    uVar1 = 0;
  }
  else {
    *param_1 = *(int *)((int)this + 0x14);
    uVar1 = *(undefined4 *)((int)this + 0x10);
  }
  return uVar1;
}



// Function: FUN_6769a171 at 6769a171

int __thiscall FUN_6769a171(void *this,int *param_1)

{
  if (*(int *)((int)this + 8) == 0) {
    *param_1 = 0;
    this = (void *)0x0;
  }
  else {
    *param_1 = *(int *)((int)this + 8);
  }
  return (int)this;
}



// Function: FUN_6769a19b at 6769a19b

void FUN_6769a19b(int param_1,int param_2)

{
  if (param_2 == 1) {
    (**(code **)(*(int *)(param_1 + -0x74) + 0x40))((int *)(param_1 + -0x74));
  }
  else {
    FUN_6769a1f0(param_1,param_2);
  }
  return;
}



// Function: FUN_6769a1d9 at 6769a1d9

undefined4 FUN_6769a1d9(void)

{
  uint uVar1;
  
  uVar1 = FUN_67683dbd();
  if (uVar1 == 0) {
    uVar1 = FUN_67683dee();
    if (uVar1 == 0) {
      return 0;
    }
  }
  return 1;
}



// Function: FUN_6769a1f0 at 6769a1f0

int FUN_6769a1f0(int param_1,undefined4 param_2)

{
  int iVar1;
  uint uVar2;
  undefined4 in_stack_00000018;
  undefined4 in_stack_0000001c;
  
  uVar2 = -(uint)(param_1 != 0) & param_1 - 0x74U;
  iVar1 = -0x7fffbfff;
  switch(param_2) {
  case 0:
    iVar1 = FUN_6769a5fd((void *)(uVar2 + 0x74),in_stack_0000001c,in_stack_00000018);
    break;
  case 0xfffffff9:
    iVar1 = FUN_6769b312((void *)(uVar2 + 4),in_stack_0000001c,in_stack_00000018);
    break;
  case 0xfffffffb:
    iVar1 = FUN_6769a674(uVar2 + 0x74);
    break;
  case 0xfffffffc:
    iVar1 = FUN_6769a6a7(uVar2 + 0x74);
    break;
  case 0xfffffffd:
    iVar1 = FUN_6769a6cf(uVar2 + 0x74);
    break;
  case 0xffffffff:
    iVar1 = FUN_6769b51b((void *)((-(uint)(uVar2 != 0xffffff8c) & uVar2) + 4),-1);
    if (iVar1 < 0) {
      return iVar1;
    }
  case 0xfffffffa:
  case 0xfffffffe:
    iVar1 = 0;
  }
  return iVar1;
}



// Function: FUN_6769a2a9 at 6769a2a9

int __fastcall FUN_6769a2a9(int param_1)

{
  code *pcVar1;
  
  pcVar1 = DefWindowProcA_exref;
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined4 *)(param_1 + 0x18) = 0;
  *(code **)(param_1 + 0x1c) = pcVar1;
  *(undefined4 *)(param_1 + 0x20) = 0;
  *(undefined4 *)(param_1 + 0x24) = 0;
  *(undefined4 *)(param_1 + 0x28) = 0;
  *(undefined4 *)(param_1 + 0x2c) = 0;
  *(undefined1 *)(param_1 + 0x40) = 1;
  *(undefined4 *)(param_1 + 0x44) = 0;
  *(undefined1 *)(param_1 + 0x48) = 0;
  *(undefined4 *)(param_1 + 0x4c) = 0xff0000;
  *(undefined4 *)(param_1 + 0x50) = 0x800080;
  SetRectEmpty((LPRECT)(param_1 + 0x30));
  return param_1;
}



// Function: FUN_6769a2ef at 6769a2ef

void __fastcall FUN_6769a2ef(int param_1)

{
  FUN_676b0201(*(undefined **)(param_1 + 0x20));
  FUN_676b0201(*(undefined **)(param_1 + 0x24));
  if (*(HGDIOBJ *)(param_1 + 0x2c) != (HGDIOBJ)0x0) {
    DeleteObject(*(HGDIOBJ *)(param_1 + 0x2c));
  }
  return;
}



// Function: FUN_6769a314 at 6769a314

undefined4 __thiscall
FUN_6769a314(void *this,undefined4 param_1,uint param_2,HDC param_3,undefined4 param_4,int *param_5,
            int param_6)

{
  POINT pt;
  POINT pt_00;
  POINT pt_01;
  POINT pt_02;
  int iVar1;
  int iVar2;
  BOOL BVar3;
  HWND pHVar4;
  short sVar5;
  bool bVar7;
  undefined4 uVar8;
  tagPOINT local_c;
  short sVar6;
  
  if (param_6 != 0) {
    return 0;
  }
  iVar2 = 1;
  local_c.x = (LONG)this;
  local_c.y = (LONG)this;
  if (param_2 == 1) {
    param_6 = 1;
    FUN_6769aa32(this);
    *param_5 = 0;
LAB_6769a546:
    bVar7 = param_6 == 0;
    goto LAB_6769a549;
  }
  if ((0x1ff < param_2) && (param_2 < 0x20b)) {
    param_6 = 1;
    iVar1 = FUN_6769a7d4(this,param_2,param_3,param_4,&param_6);
    *param_5 = iVar1;
    if (param_6 != 0) {
      return 1;
    }
  }
  if (param_2 == 0x14) {
    param_6 = 1;
    iVar2 = FUN_6769a701(this,0x14,param_3,param_4,&param_6);
LAB_6769a39c:
    *param_5 = iVar2;
  }
  else {
    if (param_2 == 0xf) {
      uVar8 = 0xf;
LAB_6769a3d2:
      param_6 = 1;
      iVar2 = FUN_6769a75e(this,uVar8,param_3,param_4,&param_6);
      goto LAB_6769a39c;
    }
    if (param_2 == 0x318) {
      uVar8 = 0x318;
      goto LAB_6769a3d2;
    }
    if ((param_2 == 7) || (param_2 == 8)) {
      param_6 = 1;
      if (*(char *)((int)this + 0x40) == '\0') {
LAB_6769a3f8:
        param_6 = 0;
        iVar2 = param_6;
      }
      else {
        InvalidateRect(*(HWND *)((int)this + 4),(RECT *)0x0,1);
        iVar2 = param_6;
      }
LAB_6769a3fb:
      param_6 = iVar2;
      bVar7 = param_6 == 0;
      *param_5 = 0;
      goto LAB_6769a549;
    }
    sVar5 = (short)param_4;
    sVar6 = (short)((uint)param_4 >> 0x10);
    if (param_2 == 0x200) {
      param_6 = 1;
      if ((*(int *)((int)this + 0x24) == 0) ||
         (pt.y = (int)sVar6, pt.x = (int)sVar5, BVar3 = PtInRect((RECT *)((int)this + 0x30),pt),
         BVar3 == 0)) goto LAB_6769a3f8;
      SetCursor(*(HCURSOR *)((int)this + 0x28));
      iVar2 = param_6;
      goto LAB_6769a3fb;
    }
    if (param_2 == 0x201) {
      param_6 = 1;
      pt_00.y = (int)sVar6;
      pt_00.x = (int)sVar5;
      BVar3 = PtInRect((RECT *)((int)this + 0x30),pt_00);
      if (BVar3 != 0) {
        SetFocus(*(HWND *)((int)this + 4));
        SetCapture(*(HWND *)((int)this + 4));
      }
    }
    else {
      if (param_2 != 0x202) {
        if (param_2 != 0x102) {
          if (param_2 == 0x87) {
            *param_5 = 0x80;
            return 1;
          }
          if (param_2 != 0x20) {
            return 0;
          }
          param_6 = 1;
          GetCursorPos(&local_c);
          ScreenToClient(*(HWND *)((int)this + 4),&local_c);
          if ((*(int *)((int)this + 0x24) == 0) ||
             (pt_02.y = local_c.y, pt_02.x = local_c.x,
             BVar3 = PtInRect((RECT *)((int)this + 0x30),pt_02), BVar3 == 0)) {
            param_6 = 0;
            iVar2 = 0;
          }
          *param_5 = iVar2;
          goto LAB_6769a546;
        }
        param_6 = 1;
        if ((param_3 == (HDC)0xd) || (param_3 == (HDC)0x20)) {
          FUN_6769a9f4((int)this);
          iVar2 = param_6;
        }
        goto LAB_6769a3fb;
      }
      param_6 = 1;
      pHVar4 = GetCapture();
      if (pHVar4 == *(HWND *)((int)this + 4)) {
        ReleaseCapture();
        pt_01.y = (int)sVar6;
        pt_01.x = (int)sVar5;
        BVar3 = PtInRect((RECT *)((int)this + 0x30),pt_01);
        if (BVar3 != 0) {
          FUN_6769a9f4((int)this);
        }
      }
    }
    *param_5 = 0;
  }
  bVar7 = param_6 == 0;
LAB_6769a549:
  if (bVar7) {
    return 0;
  }
  return 1;
}



// Function: FUN_6769a558 at 6769a558

undefined4 __thiscall
FUN_6769a558(void *this,undefined4 param_1,int param_2,undefined4 param_3,undefined4 param_4,
            undefined4 *param_5,int param_6)

{
  undefined4 uVar1;
  
  if (param_6 == 0) {
    if (param_2 == 0x110) {
      uVar1 = FUN_6769a82e((int)this);
      *param_5 = uVar1;
    }
    else {
      if (param_2 == 2) {
        if (*(HGDIOBJ *)((int)this + 0x1c) != (HGDIOBJ)0x0) {
          DeleteObject(*(HGDIOBJ *)((int)this + 0x1c));
          *(undefined4 *)((int)this + 0x1c) = 0;
        }
        *(undefined4 *)((int)this + 0x44) = 0;
        *(undefined4 *)((int)this + 0x98) = 0;
      }
      else {
        if (((param_2 != 0x111) || ((short)param_3 != 2)) || ((short)((uint)param_3 >> 0x10) != 0))
        goto LAB_6769a5f4;
        EndDialog(*(HWND *)((int)this + 4),0);
      }
      *param_5 = 0;
    }
    uVar1 = 1;
  }
  else {
LAB_6769a5f4:
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769a5fd at 6769a5fd

int __thiscall FUN_6769a5fd(void *this,undefined4 param_1,undefined4 param_2)

{
  int iVar1;
  uint uVar2;
  short local_14 [4];
  short local_c;
  
  local_14[0] = 0;
  uVar2 = -(uint)(this != (void *)0x0) & (int)this - 0x74U;
  if (*(int **)(uVar2 + 0x1c) != (int *)0x0) {
    iVar1 = FUN_67690205(*(int **)(uVar2 + 0x1c),0xfffffd3b,local_14);
    if (((-1 < iVar1) && (local_14[0] == 0xb)) && (local_c == 0)) {
      iVar1 = FUN_6769b312((void *)(uVar2 + 4),param_1,param_2);
      goto LAB_6769a660;
    }
  }
  iVar1 = FUN_6769a674(uVar2 + 0x74);
LAB_6769a660:
  Ordinal_9(local_14);
  return iVar1;
}



// Function: FUN_6769a674 at 6769a674

int __fastcall FUN_6769a674(int param_1)

{
  void *this;
  int iVar1;
  
  this = (void *)((-(uint)(param_1 != 0) & param_1 - 0x74U) + 4);
  iVar1 = FUN_6769b51b(this,-5);
  if (-1 < iVar1) {
    iVar1 = 0;
    FUN_67694434((int)this);
  }
  return iVar1;
}



// Function: FUN_6769a6a7 at 6769a6a7

int __fastcall FUN_6769a6a7(int param_1)

{
  int iVar1;
  uint uVar2;
  
  uVar2 = -(uint)(param_1 != 0) & param_1 - 0x74U;
  iVar1 = 0;
  if ((*(byte *)(uVar2 + 0x48) & 8) == 0) {
    iVar1 = FUN_6769b51b((void *)(uVar2 + 4),-4);
    if (-1 < iVar1) {
      iVar1 = 0;
    }
  }
  return iVar1;
}



// Function: FUN_6769a6cf at 6769a6cf

undefined4 __fastcall FUN_6769a6cf(int param_1)

{
  uint uVar1;
  
  uVar1 = -(uint)(param_1 != 0) & param_1 - 0x74U;
  (**(code **)(*(int *)(uVar1 + 0x80) + 0x18))(uVar1 + 0x80);
  if (*(HWND *)(uVar1 + 0x50) != (HWND)0x0) {
    ShowWindow(*(HWND *)(uVar1 + 0x50),0);
  }
  return 0;
}



// Function: FUN_6769a701 at 6769a701

undefined4 __thiscall
FUN_6769a701(void *this,undefined4 param_1,HDC param_2,undefined4 param_3,undefined4 *param_4)

{
  HWND hWnd;
  HBRUSH hbr;
  tagRECT local_14;
  
  if (*(char *)((int)this + 0x40) == '\0') {
    *param_4 = 0;
  }
  else {
    hWnd = GetParent(*(HWND *)((int)this + 4));
    hbr = (HBRUSH)SendMessageA(hWnd,0x138,(WPARAM)param_2,*(LPARAM *)((int)this + 4));
    if (hbr != (HBRUSH)0x0) {
      GetClientRect(*(HWND *)((int)this + 4),&local_14);
      FillRect(param_2,&local_14,hbr);
    }
  }
  return 1;
}



// Function: FUN_6769a75e at 6769a75e

undefined4 __thiscall
FUN_6769a75e(void *this,undefined4 param_1,HDC param_2,undefined4 param_3,undefined4 *param_4)

{
  undefined4 uVar1;
  HDC local_4c;
  HWND local_48;
  tagPAINTSTRUCT local_44;
  
  if (*(char *)((int)this + 0x40) == '\0') {
    *param_4 = 0;
    uVar1 = 1;
  }
  else {
    if (param_2 == (HDC)0x0) {
      local_48 = *(HWND *)((int)this + 4);
      local_4c = (HDC)0x0;
      local_4c = BeginPaint(local_48,&local_44);
      FUN_6769acc6(this,local_4c);
      FUN_6769a7bf(&local_4c);
    }
    else {
      FUN_6769acc6(this,param_2);
    }
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769a7bf at 6769a7bf

void __fastcall FUN_6769a7bf(undefined4 *param_1)

{
  EndPaint((HWND)param_1[1],(PAINTSTRUCT *)(param_1 + 2));
  *param_1 = 0;
  return;
}



// Function: FUN_6769a7d4 at 6769a7d4

undefined4 __thiscall
FUN_6769a7d4(void *this,undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 *param_4
            )

{
  BOOL BVar1;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 uStack_c;
  undefined4 uStack_8;
  
  local_20 = *(undefined4 *)((int)this + 4);
  local_1c = param_1;
  local_18 = param_2;
  local_14 = param_3;
  local_10 = 0;
  uStack_c = 0;
  uStack_8 = 0;
  BVar1 = IsWindow(*(HWND *)((int)this + 0x44));
  if (BVar1 != 0) {
    SendMessageA(*(HWND *)((int)this + 0x44),0x407,0,(LPARAM)&local_20);
  }
  *param_4 = 0;
  return 1;
}



// Function: FUN_6769a82e at 6769a82e

undefined4 __fastcall FUN_6769a82e(int param_1)

{
  CHAR local_20 [20];
  ushort local_c;
  ushort local_a;
  ushort local_8;
  ushort local_6;
  
  FUN_6769ad52(param_1);
  FUN_6769ada6(param_1);
  FUN_6769ae08((LPCSTR)0x0,&local_c,&local_a,&local_8,&local_6);
  wsprintfA(local_20,s__hu__hu__hu__hu_676c1bf8,(uint)local_c,(uint)local_a,(uint)local_8,
            (uint)local_6);
  SetDlgItemTextA(*(HWND *)(param_1 + 4),0xc9,local_20);
  FUN_6769a8a7((undefined4 *)(param_1 + 4),(HWND)0x0);
  return 1;
}



// Function: FUN_6769a8a7 at 6769a8a7

void __thiscall FUN_6769a8a7(void *this,HWND param_1)

{
  uint uVar1;
  HWND hWnd;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  tagRECT local_3c;
  tagRECT local_2c;
  tagRECT local_1c;
  undefined4 *local_c;
  uint local_8;
  
                    /* WARNING: Load size is inaccurate */
  local_c = (undefined4 *)this;
  local_8 = GetWindowLongA(*this,-0x10);
  if (param_1 == (HWND)0x0) {
    if ((local_8 & 0x40000000) == 0) {
                    /* WARNING: Load size is inaccurate */
      param_1 = GetWindow(*this,4);
    }
    else {
                    /* WARNING: Load size is inaccurate */
      param_1 = GetParent(*this);
    }
  }
                    /* WARNING: Load size is inaccurate */
  GetWindowRect(*this,&local_3c);
  if ((local_8 & 0x40000000) == 0) {
    if ((param_1 != (HWND)0x0) &&
       ((uVar1 = GetWindowLongA(param_1,-0x10), (uVar1 & 0x10000000) == 0 ||
        ((uVar1 & 0x20000000) != 0)))) {
      param_1 = (HWND)0x0;
    }
    SystemParametersInfoA(0x30,0,&local_1c,0);
    if (param_1 == (HWND)0x0) {
      local_2c.left = local_1c.left;
      local_2c.top = local_1c.top;
      local_2c.right = local_1c.right;
      local_2c.bottom = local_1c.bottom;
    }
    else {
      GetWindowRect(param_1,&local_2c);
    }
  }
  else {
                    /* WARNING: Load size is inaccurate */
    hWnd = GetParent(*this);
    GetClientRect(hWnd,&local_1c);
    GetClientRect(param_1,&local_2c);
    MapWindowPoints(param_1,hWnd,(LPPOINT)&local_2c,2);
  }
  iVar2 = local_3c.right - local_3c.left;
  iVar4 = local_3c.bottom - local_3c.top;
  iVar5 = (local_2c.left + local_2c.right) / 2 - iVar2 / 2;
  iVar3 = (local_2c.top + local_2c.bottom) / 2 - iVar4 / 2;
  if ((local_1c.left <= iVar5) && (local_1c.left = iVar5, local_1c.right < iVar5 + iVar2)) {
    local_1c.left = local_1c.right - iVar2;
  }
  if ((local_1c.top <= iVar3) && (local_1c.top = iVar3, local_1c.bottom < iVar3 + iVar4)) {
    local_1c.top = local_1c.bottom - iVar4;
  }
  SetWindowPos((HWND)*local_c,(HWND)0x0,local_1c.left,local_1c.top,-1,-1,0x15);
  return;
}



// Function: FUN_6769a9f4 at 6769a9f4

bool __fastcall FUN_6769a9f4(int param_1)

{
  HINSTANCE pHVar1;
  
  pHVar1 = ShellExecuteA((HWND)0x0,&DAT_676c1c08,*(LPCSTR *)(param_1 + 0x24),(LPCSTR)0x0,(LPCSTR)0x0
                         ,1);
  if ((HINSTANCE)0x20 < pHVar1) {
    *(undefined1 *)(param_1 + 0x48) = 1;
    InvalidateRect(*(HWND *)(param_1 + 4),(RECT *)0x0,1);
  }
  return (HINSTANCE)0x20 < pHVar1;
}



// Function: FUN_6769aa32 at 6769aa32

void __fastcall FUN_6769aa32(void *param_1)

{
  undefined4 *this;
  int iVar1;
  uint uVar2;
  HCURSOR pHVar3;
  HWND hWnd;
  HANDLE h;
  HFONT pHVar4;
  LSTATUS LVar5;
  HMENU extraout_ECX;
  int *extraout_ECX_00;
  undefined4 extraout_ECX_01;
  void *this_00;
  void *this_01;
  int *piVar6;
  LPCSTR pCVar7;
  DWORD DVar8;
  DWORD DVar9;
  undefined4 uVar10;
  HMENU pHVar11;
  undefined4 *puVar12;
  LPVOID pvVar13;
  LOGFONTA local_60;
  byte local_24 [12];
  CHAR local_18 [8];
  DWORD local_10;
  LPCSTR local_c;
  HKEY local_8;
  
  iVar1 = GetClassNameA(*(HWND *)((int)param_1 + 4),local_18,8);
  if (iVar1 != 0) {
    iVar1 = lstrcmpiA(local_18,s_static_676c1c68);
    if (iVar1 == 0) {
      uVar2 = GetWindowLongA(*(HWND *)((int)param_1 + 4),-0x10);
      if (uVar2 != (uVar2 | 0x100)) {
        SetWindowLongA(*(HWND *)((int)param_1 + 4),-0x10,uVar2 | 0x100);
      }
      uVar2 = GetWindowLongA(*(HWND *)((int)param_1 + 4),-0x10);
      uVar2 = uVar2 & 0xff;
      if ((((((uVar2 == 3) || (uVar2 == 4)) || (uVar2 == 5)) || ((uVar2 == 6 || (uVar2 == 7)))) ||
          ((uVar2 == 8 || ((uVar2 == 9 || (uVar2 == 0xd)))))) || ((uVar2 == 0xe || (uVar2 == 0xf))))
      {
        *(undefined1 *)((int)param_1 + 0x40) = 0;
      }
    }
  }
  pHVar3 = LoadCursorA((HINSTANCE)0x0,(LPCSTR)0x7f89);
  *(HCURSOR *)((int)param_1 + 0x28) = pHVar3;
  if (*(char *)((int)param_1 + 0x40) != '\0') {
    hWnd = GetParent(*(HWND *)((int)param_1 + 4));
    h = (HANDLE)SendMessageA(hWnd,0x31,0,0);
    if (h != (HANDLE)0x0) {
      GetObjectA(h,0x3c,&local_60);
      local_60.lfUnderline = '\x01';
      pHVar4 = CreateFontIndirectA(&local_60);
      *(HFONT *)((int)param_1 + 0x2c) = pHVar4;
    }
  }
  if (*(int *)((int)param_1 + 0x20) == 0) {
    iVar1 = GetWindowTextLengthA(*(HWND *)((int)param_1 + 4));
    if (0 < iVar1) {
      FUN_676b06a0();
      local_c = &stack0xffffff94;
      iVar1 = GetWindowTextA(*(HWND *)((int)param_1 + 4),&stack0xffffff94,iVar1 + 1);
      if (iVar1 != 0) {
        FUN_6769b014(param_1,local_c);
      }
    }
  }
  if ((*(int *)((int)param_1 + 0x24) == 0) && (*(LPCSTR *)((int)param_1 + 0x20) != (LPCSTR)0x0)) {
    FUN_6769b059(param_1,*(LPCSTR *)((int)param_1 + 0x20));
  }
  FUN_6769b124((int)param_1);
  pvVar13 = (LPVOID)0x0;
  this = (undefined4 *)((int)param_1 + 0x44);
  pHVar11 = extraout_ECX;
  FUN_6769ac72(&stack0xffffff8c,0);
  DVar9 = 0;
  DVar8 = 0;
  pCVar7 = (LPCSTR)0x0;
  piVar6 = extraout_ECX_00;
  FUN_6769ac67(&stack0xffffff7c,0);
  FUN_6769af1b(this,*(HWND *)((int)param_1 + 4),piVar6,pCVar7,DVar8,DVar9,pHVar11,pvVar13);
  SendMessageA((HWND)*this,0x401,1,0);
  iVar1 = 0;
  puVar12 = (undefined4 *)0x0;
  uVar10 = extraout_ECX_01;
  FUN_6769ac7d(&stack0xffffff88,*(undefined4 *)((int)param_1 + 0x24));
  FUN_6769af6d(this,*(HWND *)((int)param_1 + 4),uVar10,puVar12,iVar1);
  if (*(char *)((int)param_1 + 0x40) != '\0') {
    local_8 = (HKEY)0x0;
    iVar1 = FUN_6769ac88(&local_8,(HKEY)0x80000001,s_Software_Microsoft_Internet_Expl_676c1c38,
                         0xf003f);
    if (iVar1 == 0) {
      local_c = (LPCSTR)0xc;
      local_10 = 0;
      LVar5 = RegQueryValueExA(local_8,s_Anchor_Color_676c1c28,(LPDWORD)0x0,&local_10,local_24,
                               (LPDWORD)&local_c);
      if (LVar5 == 0) {
        uVar2 = FUN_6769b0a4(this_00,local_24);
        if (uVar2 != 0xffffffff) {
          *(uint *)((int)param_1 + 0x4c) = uVar2;
        }
      }
      local_c = (LPCSTR)0xc;
      local_10 = 0;
      LVar5 = RegQueryValueExA(local_8,s_Anchor_Color_Visited_676c1c10,(LPDWORD)0x0,&local_10,
                               local_24,(LPDWORD)&local_c);
      if (LVar5 == 0) {
        uVar2 = FUN_6769b0a4(this_01,local_24);
        if (uVar2 != 0xffffffff) {
          *(uint *)((int)param_1 + 0x50) = uVar2;
        }
      }
    }
    if (local_8 != (HKEY)0x0) {
      RegCloseKey(local_8);
    }
  }
  return;
}



// Function: FUN_6769ac67 at 6769ac67

void __thiscall FUN_6769ac67(void *this,undefined4 param_1)

{
  *(undefined4 *)this = param_1;
  return;
}



// Function: FUN_6769ac72 at 6769ac72

void __thiscall FUN_6769ac72(void *this,undefined4 param_1)

{
  *(undefined4 *)this = param_1;
  return;
}



// Function: FUN_6769ac7d at 6769ac7d

void __thiscall FUN_6769ac7d(void *this,undefined4 param_1)

{
  *(undefined4 *)this = param_1;
  return;
}



// Function: FUN_6769ac88 at 6769ac88

void __thiscall FUN_6769ac88(void *this,HKEY param_1,LPCSTR param_2,REGSAM param_3)

{
  LSTATUS LVar1;
  HKEY local_8;
  
  local_8 = (HKEY)0x0;
  LVar1 = RegOpenKeyExA(param_1,param_2,0,param_3,&local_8);
  if (LVar1 == 0) {
                    /* WARNING: Load size is inaccurate */
    if (*this != (HKEY)0x0) {
      RegCloseKey(*this);
      *(undefined4 *)this = 0;
    }
    *(HKEY *)this = local_8;
  }
  return;
}



// Function: FUN_6769acc6 at 6769acc6

void __thiscall FUN_6769acc6(void *this,HDC param_1)

{
  COLORREF color;
  uint uVar1;
  HWND pHVar2;
  uint uVar3;
  LPCSTR lpchText;
  
  SetBkMode(param_1,1);
  if (*(char *)((int)this + 0x48) == '\0') {
    color = *(COLORREF *)((int)this + 0x4c);
  }
  else {
    color = *(COLORREF *)((int)this + 0x50);
  }
  SetTextColor(param_1,color);
  if (*(HGDIOBJ *)((int)this + 0x2c) != (HGDIOBJ)0x0) {
    SelectObject(param_1,*(HGDIOBJ *)((int)this + 0x2c));
  }
  lpchText = *(LPCSTR *)((int)this + 0x20);
  if (lpchText == (LPCSTR)0x0) {
    lpchText = *(LPCSTR *)((int)this + 0x24);
  }
  uVar1 = GetWindowLongA(*(HWND *)((int)this + 4),-0x10);
  uVar3 = 0;
  if ((uVar1 & 1) == 0) {
    if ((uVar1 & 2) != 0) {
      uVar3 = 2;
    }
  }
  else {
    uVar3 = 1;
  }
  DrawTextA(param_1,lpchText,-1,(RECT *)((int)this + 0x30),uVar3 | 0x10);
  pHVar2 = GetFocus();
  if (pHVar2 == *(HWND *)((int)this + 4)) {
    DrawFocusRect(param_1,(RECT *)((int)this + 0x30));
  }
  return;
}



// Function: FUN_6769ad52 at 6769ad52

void __fastcall FUN_6769ad52(int param_1)

{
  HFONT wParam;
  
  wParam = CreateFontA(0x12,0,0,0,700,0,0,0,1,0,0,0,0,s_Arial_676c1c70);
  *(HFONT *)(param_1 + 0x1c) = wParam;
  if (wParam != (HFONT)0x0) {
    SendDlgItemMessageA(*(HWND *)(param_1 + 4),0xcd,0x30,(WPARAM)wParam,1);
    SendDlgItemMessageA(*(HWND *)(param_1 + 4),0xce,0x30,*(WPARAM *)(param_1 + 0x1c),1);
  }
  return;
}



// Function: FUN_6769ada6 at 6769ada6

void __fastcall FUN_6769ada6(int param_1)

{
  HWND pHVar1;
  LONG LVar2;
  
  pHVar1 = GetDlgItem(*(HWND *)(param_1 + 4),0xcf);
  LVar2 = FUN_6769b884((void *)(param_1 + 0x20),pHVar1);
  if (LVar2 != 0) {
    FUN_6769aa32((void *)(param_1 + 0x20));
  }
  pHVar1 = GetDlgItem(*(HWND *)(param_1 + 4),0xd0);
  LVar2 = FUN_6769b884((void *)(param_1 + 0x74),pHVar1);
  if (LVar2 != 0) {
    FUN_6769aa32((void *)(param_1 + 0x74));
  }
  *(undefined **)(param_1 + 0x44) = PTR_s_mailto_support_xceedsoft_com_sub_676c1ee8;
  *(undefined **)(param_1 + 0x98) = PTR_s_http___www_xceedsoft_com_redirec_676c1eec;
  return;
}



// Function: FUN_6769ae08 at 6769ae08

undefined4
FUN_6769ae08(LPCSTR param_1,undefined2 *param_2,undefined2 *param_3,undefined2 *param_4,
            undefined2 *param_5)

{
  undefined2 *puVar1;
  DWORD DVar2;
  HANDLE pvVar3;
  LPVOID lpData;
  BOOL BVar4;
  int iVar5;
  undefined4 uVar6;
  undefined4 *puVar7;
  DWORD dwFlags;
  DWORD dwBytes;
  CHAR local_114;
  undefined4 local_113 [65];
  uint local_c;
  LPVOID local_8;
  
  puVar1 = param_3;
  local_114 = '\0';
  *param_2 = 0;
  *param_3 = 0;
  *param_4 = 0;
  *param_5 = 0;
  puVar7 = local_113;
  for (iVar5 = 0x41; iVar5 != 0; iVar5 = iVar5 + -1) {
    *puVar7 = 0;
    puVar7 = puVar7 + 1;
  }
  if (param_1 == (LPCSTR)0x0) {
    GetModuleFileNameA(DAT_676c558c,&local_114,0x104);
  }
  else {
    lstrcpynA(&local_114,param_1,0x104);
  }
  DVar2 = GetFileVersionInfoSizeA(&local_114,(LPDWORD)&param_3);
  if (DVar2 != 0) {
    dwFlags = 8;
    dwBytes = DVar2;
    pvVar3 = GetProcessHeap();
    lpData = HeapAlloc(pvVar3,dwFlags,dwBytes);
    if (lpData != (LPVOID)0x0) {
      BVar4 = GetFileVersionInfoA(&local_114,(DWORD)param_3,DVar2,lpData);
      if ((BVar4 == 0) ||
         (BVar4 = VerQueryValueA(lpData,&DAT_676c1c78,&local_8,&local_c), BVar4 == 0)) {
        uVar6 = 0;
      }
      else {
        *param_2 = (short)((uint)*(undefined4 *)((int)local_8 + 8) >> 0x10);
        *puVar1 = *(undefined2 *)((int)local_8 + 8);
        *param_4 = (short)((uint)*(undefined4 *)((int)local_8 + 0xc) >> 0x10);
        uVar6 = 1;
        *param_5 = *(undefined2 *)((int)local_8 + 0xc);
      }
      DVar2 = 0;
      pvVar3 = GetProcessHeap();
      HeapFree(pvVar3,DVar2,lpData);
      return uVar6;
    }
  }
  return 0;
}



// Function: FUN_6769af1b at 6769af1b

void __thiscall
FUN_6769af1b(void *this,HWND param_1,int *param_2,LPCSTR param_3,DWORD param_4,DWORD param_5,
            HMENU param_6,LPVOID param_7)

{
  HWND pHVar1;
  
  if (param_2 == (int *)0x0) {
    param_2 = &DAT_676c1bd8;
  }
  pHVar1 = CreateWindowExA(param_5,s_tooltips_class32_676c1c7c,param_3,param_4,*param_2,param_2[1],
                           param_2[2] - *param_2,param_2[3] - param_2[1],param_1,param_6,
                           DAT_676c558c,param_7);
  *(HWND *)this = pHVar1;
  return;
}



// Function: FUN_6769af6d at 6769af6d

void __thiscall
FUN_6769af6d(void *this,HWND param_1,undefined4 param_2,undefined4 *param_3,int param_4)

{
  undefined1 local_30 [44];
  
  FUN_6769afa6(local_30,0,param_1,param_4,param_3,param_2,0);
                    /* WARNING: Load size is inaccurate */
  SendMessageA(*this,0x404,0,(LPARAM)local_30);
  return;
}



// Function: FUN_6769afa6 at 6769afa6

void __thiscall
FUN_6769afa6(void *this,undefined4 param_1,HWND param_2,int param_3,undefined4 *param_4,
            undefined4 param_5,undefined4 param_6)

{
  HWND pHVar1;
  
  _memset(this,0,0x2c);
  *(undefined4 *)((int)this + 4) = param_1;
  *(undefined4 *)this = 0x2c;
  if (param_3 == 0) {
    pHVar1 = GetParent(param_2);
    *(uint *)((int)this + 4) = *(uint *)((int)this + 4) | 1;
    *(HWND *)((int)this + 8) = pHVar1;
    *(HWND *)((int)this + 0xc) = param_2;
  }
  else {
    *(int *)((int)this + 0xc) = param_3;
    *(HWND *)((int)this + 8) = param_2;
  }
  if (param_4 != (undefined4 *)0x0) {
    *(undefined4 *)((int)this + 0x10) = *param_4;
    *(undefined4 *)((int)this + 0x14) = param_4[1];
    *(undefined4 *)((int)this + 0x18) = param_4[2];
    *(undefined4 *)((int)this + 0x1c) = param_4[3];
  }
  *(undefined4 *)((int)this + 0x20) = DAT_676c5590;
  *(undefined4 *)((int)this + 0x24) = param_5;
  *(undefined4 *)((int)this + 0x28) = param_6;
  return;
}



// Function: FUN_6769b014 at 6769b014

bool __thiscall FUN_6769b014(void *this,LPCSTR param_1)

{
  int iVar1;
  LPSTR lpString1;
  
  FUN_676b0201(*(undefined **)((int)this + 0x20));
  *(undefined4 *)((int)this + 0x20) = 0;
  iVar1 = lstrlenA(param_1);
  lpString1 = (LPSTR)_malloc(iVar1 + 1);
  *(LPSTR *)((int)this + 0x20) = lpString1;
  if (lpString1 != (LPSTR)0x0) {
    lstrcpyA(lpString1,param_1);
    FUN_6769b124((int)this);
  }
  return lpString1 != (LPSTR)0x0;
}



// Function: FUN_6769b059 at 6769b059

undefined4 __thiscall FUN_6769b059(void *this,LPCSTR param_1)

{
  int iVar1;
  LPSTR pCVar2;
  undefined4 uVar3;
  
  FUN_676b0201(*(undefined **)((int)this + 0x24));
  *(undefined4 *)((int)this + 0x24) = 0;
  iVar1 = lstrlenA(param_1);
  pCVar2 = (LPSTR)_malloc(iVar1 + 1);
  *(LPSTR *)((int)this + 0x24) = pCVar2;
  if (pCVar2 == (LPSTR)0x0) {
    uVar3 = 0;
  }
  else {
    pCVar2 = lstrcpyA(pCVar2,param_1);
    if (*(int *)((int)this + 0x20) == 0) {
      pCVar2 = (LPSTR)FUN_6769b124((int)this);
    }
    uVar3 = CONCAT31((int3)((uint)pCVar2 >> 8),1);
  }
  return uVar3;
}



// Function: FUN_6769b0a4 at 6769b0a4

uint __thiscall FUN_6769b0a4(void *this,byte *param_1)

{
  byte *pbVar1;
  byte bVar2;
  byte *lpsz;
  uint uVar3;
  byte *extraout_ECX;
  uint *puVar4;
  uint local_14 [4];
  
  local_14[0] = 0xffffffff;
  local_14[1] = 0xffffffff;
  local_14[2] = 0xffffffff;
  local_14[3] = 0;
  puVar4 = local_14;
  do {
    bVar2 = *param_1;
    lpsz = param_1;
    while (bVar2 != 0) {
      if (bVar2 == 0x2c) {
        *lpsz = 0;
        pbVar1 = param_1;
        uVar3 = FUN_676b1256(this,param_1);
        this = pbVar1;
        *puVar4 = uVar3;
        param_1 = lpsz + 1;
        break;
      }
      lpsz = (byte *)CharNextA((LPCSTR)lpsz);
      this = extraout_ECX;
      bVar2 = *lpsz;
    }
    uVar3 = 0xffffffff;
    if (*puVar4 == 0xffffffff) {
      return 0xffffffff;
    }
    local_14[3] = local_14[3] + 1;
    puVar4 = puVar4 + 1;
    if (1 < (int)local_14[3]) {
      if (*param_1 != 0) {
        uVar3 = FUN_676b1256(this,param_1);
        uVar3 = ((uVar3 & 0xff) << 8 | local_14[1] & 0xff) << 8 | local_14[0] & 0xff;
      }
      return uVar3;
    }
  } while( true );
}



// Function: FUN_6769b124 at 6769b124

uint __fastcall FUN_6769b124(int param_1)

{
  uint uVar1;
  undefined4 uVar2;
  uint uVar3;
  LPCSTR lpchText;
  tagRECT local_20;
  HDC local_10;
  HWND local_c;
  HGDIOBJ local_8;
  
  uVar1 = IsWindow(*(HWND *)(param_1 + 4));
  if ((uVar1 == 0) || ((*(int *)(param_1 + 0x20) == 0 && (*(int *)(param_1 + 0x24) == 0)))) {
    uVar1 = uVar1 & 0xffffff00;
  }
  else {
    local_c = *(HWND *)(param_1 + 4);
    local_10 = (HDC)0x0;
    local_10 = GetDC(local_c);
    GetClientRect(*(HWND *)(param_1 + 4),&local_20);
    *(LONG *)(param_1 + 0x30) = local_20.left;
    *(LONG *)(param_1 + 0x34) = local_20.top;
    *(LONG *)(param_1 + 0x38) = local_20.right;
    *(LONG *)(param_1 + 0x3c) = local_20.bottom;
    if (*(char *)(param_1 + 0x40) != '\0') {
      local_8 = (HGDIOBJ)0x0;
      if (*(HGDIOBJ *)(param_1 + 0x2c) != (HGDIOBJ)0x0) {
        local_8 = SelectObject(local_10,*(HGDIOBJ *)(param_1 + 0x2c));
      }
      lpchText = *(LPCSTR *)(param_1 + 0x20);
      if (lpchText == (LPCSTR)0x0) {
        lpchText = *(LPCSTR *)(param_1 + 0x24);
      }
      uVar1 = GetWindowLongA(*(HWND *)(param_1 + 4),-0x10);
      uVar3 = 0;
      if ((uVar1 & 1) == 0) {
        if ((uVar1 & 2) != 0) {
          uVar3 = 2;
        }
      }
      else {
        uVar3 = 1;
      }
      DrawTextA(local_10,lpchText,-1,(LPRECT)(param_1 + 0x30),uVar3 | 0x410);
      if (*(int *)(param_1 + 0x2c) != 0) {
        SelectObject(local_10,local_8);
      }
    }
    uVar2 = FUN_6769b1f4(&local_10);
    uVar1 = CONCAT31((int3)((uint)uVar2 >> 8),1);
  }
  return uVar1;
}



// Function: FUN_6769b1f4 at 6769b1f4

void __fastcall FUN_6769b1f4(undefined4 *param_1)

{
  HDC pHVar1;
  
  pHVar1 = (HDC)*param_1;
  *param_1 = 0;
  ReleaseDC((HWND)param_1[1],pHVar1);
  pHVar1 = (HDC)*param_1;
  if (pHVar1 != (HDC)0x0) {
    *param_1 = 0;
    DeleteDC(pHVar1);
  }
  return;
}



// Function: FUN_6769b25c at 6769b25c

LONG FUN_6769b25c(int *param_1,uint param_2,undefined4 param_3,LONG param_4)

{
  int iVar1;
  int iVar2;
  int local_20;
  uint local_1c;
  undefined4 local_18;
  LONG local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  local_18 = param_3;
  local_14 = param_4;
  local_10 = 0;
  local_c = 0;
  local_8 = 0;
  iVar1 = param_1[6];
  local_20 = param_1[1];
  param_1[6] = (int)&local_20;
  local_1c = param_2;
  iVar2 = (**(code **)*param_1)(local_20,param_2,param_3,param_4,&param_4,0);
  param_1[6] = iVar1;
  if (iVar2 == 0) {
    if (param_2 == 0x82) {
      iVar1 = param_1[1];
      param_1[1] = 0;
      (**(code **)(*param_1 + 8))(iVar1);
    }
    param_4 = 0;
  }
  else if ((param_2 < 0x2e) ||
          ((((0x2f < param_2 && (param_2 != 0x37)) && (param_2 != 0x39)) &&
           ((param_2 != 0x110 && ((param_2 < 0x132 || (0x138 < param_2)))))))) {
    SetWindowLongA((HWND)param_1[1],0,param_4);
    param_4 = 1;
  }
  return param_4;
}



// Function: FUN_6769b312 at 6769b312

int __thiscall FUN_6769b312(void *this,undefined4 param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 local_28;
  LPVOID local_24;
  undefined4 local_20;
  LPVOID local_1c;
  int local_18;
  int *local_14;
  int *local_10;
  int *local_c;
  int *local_8;
  
  local_14 = (int *)0x0;
  puVar1 = *(undefined4 **)((int)this + 0x10);
  local_10 = (int *)0x0;
  local_c = (int *)0x0;
  if (((puVar1 == (undefined4 *)0x0) ||
      ((**(code **)*puVar1)(puVar1,&DAT_676bb570,&local_c), local_c == (int *)0x0)) ||
     (iVar2 = (**(code **)(*local_c + 0x24))(local_c), iVar2 < 0)) {
                    /* WARNING: Load size is inaccurate */
    local_8 = (int *)0x0;
    (**(code **)(*this + 4))(&DAT_676bb600,&local_8);
    FUN_6769b47b((int *)&local_14,local_8,&DAT_676bb550);
    if (local_14 == (int *)0x0) {
      local_18 = 0x40181;
    }
    else {
      local_18 = (**(code **)(*local_14 + 0xc))(local_14,&local_28);
      if (-1 < local_18) {
        FUN_6769b4a9(&local_10,local_8);
        if (local_10 == (int *)0x0) {
          local_18 = 0x40181;
        }
        else {
          local_1c = (LPVOID)0x0;
          (**(code **)(*local_10 + 0x40))(local_10,2,&local_1c);
          iVar2 = FUN_6769b4d6(this,&local_20);
          if (iVar2 < 0) {
            local_20 = 0x400;
          }
          local_18 = Ordinal_417(param_2,*(undefined4 *)((int)this + 0x30),
                                 *(undefined4 *)((int)this + 0x2c),local_1c,1,&local_8,local_28,
                                 local_24,local_20,0,0);
          CoTaskMemFree(local_1c);
        }
        CoTaskMemFree(local_24);
      }
    }
    if (local_8 != (int *)0x0) {
      (**(code **)(*local_8 + 8))(local_8);
    }
    if (local_c != (int *)0x0) {
      (**(code **)(*local_c + 8))(local_c);
    }
    if (local_10 != (int *)0x0) {
      (**(code **)(*local_10 + 8))(local_10);
    }
    iVar2 = local_18;
    if (local_14 != (int *)0x0) {
      (**(code **)(*local_14 + 8))(local_14);
      iVar2 = local_18;
    }
  }
  else {
    if (local_c != (int *)0x0) {
      (**(code **)(*local_c + 8))(local_c);
    }
    if (local_10 != (int *)0x0) {
      (**(code **)(*local_10 + 8))(local_10);
    }
    if (local_14 != (int *)0x0) {
      (**(code **)(*local_14 + 8))(local_14);
    }
  }
  return iVar2;
}



// Function: FUN_6769b47b at 6769b47b

int FUN_6769b47b(int *param_1,undefined4 *param_2,undefined4 param_3)

{
  int *piVar1;
  
  piVar1 = (int *)*param_1;
  *param_1 = 0;
  if (param_2 != (undefined4 *)0x0) {
    (**(code **)*param_2)(param_2,param_3,param_1);
  }
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  return *param_1;
}



// Function: FUN_6769b4a9 at 6769b4a9

int __thiscall FUN_6769b4a9(void *this,undefined4 *param_1)

{
  int *piVar1;
  
                    /* WARNING: Load size is inaccurate */
  piVar1 = *this;
  *(undefined4 *)this = 0;
  if (param_1 != (undefined4 *)0x0) {
    (**(code **)*param_1)(param_1,&DAT_676bb640,this);
  }
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
  }
                    /* WARNING: Load size is inaccurate */
  return *this;
}



// Function: FUN_6769b4d6 at 6769b4d6

undefined4 __thiscall FUN_6769b4d6(void *this,undefined4 *param_1)

{
  undefined4 uVar1;
  undefined2 local_14 [4];
  undefined4 local_c;
  
  local_14[0] = 0;
  uVar1 = 0x80004005;
  if (*(int **)((int)this + 0x18) != (int *)0x0) {
    uVar1 = FUN_67690205(*(int **)((int)this + 0x18),0xfffffd3f,local_14);
  }
  *param_1 = local_c;
  Ordinal_9(local_14);
  return uVar1;
}



// Function: FUN_6769b51b at 6769b51b

int __thiscall FUN_6769b51b(void *this,int param_1)

{
  int *piVar1;
  int *piVar2;
  uint uVar3;
  int iVar4;
  HWND hWnd;
  BOOL BVar5;
  undefined4 uVar6;
  undefined4 local_50 [5];
  undefined1 local_3c [16];
  undefined1 local_2c [16];
  undefined4 local_1c;
  undefined4 local_18;
  int *local_14;
  int *local_10;
  int *local_c;
  int *local_8;
  
  if (*(int *)((int)this + 0x10) == 0) {
    return 0;
  }
                    /* WARNING: Load size is inaccurate */
  local_8 = (int *)0x0;
  (**(code **)(*this + 4))(&DAT_676bb620,&local_8);
  if ((*(uint *)((int)this + 0x44) & 1) == 0) {
    if ((*(uint *)((int)this + 0x44) & 0x40) == 0) {
      (**(code **)**(undefined4 **)((int)this + 0x10))
                (*(undefined4 **)((int)this + 0x10),&DAT_676bb520,(int)this + 4);
    }
    piVar2 = *(int **)((int)this + 4);
    piVar1 = (int *)((int)this + 4);
    if (piVar2 == (int *)0x0) {
      (**(code **)**(undefined4 **)((int)this + 0x10))
                (*(undefined4 **)((int)this + 0x10),&DAT_676bb530,piVar1);
      if (*piVar1 == 0) {
        (**(code **)**(undefined4 **)((int)this + 0x10))
                  (*(undefined4 **)((int)this + 0x10),&DAT_676bb610,piVar1);
      }
      else {
        *(uint *)((int)this + 0x44) = *(uint *)((int)this + 0x44) | 0x20;
      }
    }
    else {
      *(uint *)((int)this + 0x44) = *(uint *)((int)this + 0x44) | 0x20;
      iVar4 = (**(code **)(*piVar2 + 0x48))(piVar2);
      if (iVar4 == 0) {
        *(ushort *)((int)this + 0x44) = *(ushort *)((int)this + 0x44) | 0x102;
      }
      else {
        *(uint *)((int)this + 0x44) = *(uint *)((int)this + 0x44) & 0xfffffffd;
      }
    }
  }
  piVar1 = *(int **)((int)this + 4);
  if (piVar1 == (int *)0x0) {
LAB_6769b5ef:
    if (local_8 != (int *)0x0) {
      (**(code **)(*local_8 + 8))(local_8);
    }
    return -0x7fffbffb;
  }
  *(uint *)((int)this + 0x44) = *(uint *)((int)this + 0x44) | 1;
  uVar3 = *(uint *)((int)this + 0x44);
  if ((uVar3 & 4) == 0) {
    local_18 = 0;
    if ((uVar3 & 2) == 0) {
      iVar4 = *piVar1;
      if ((uVar3 & 0x20) == 0) {
        iVar4 = (**(code **)(iVar4 + 0x14))(piVar1);
        if (iVar4 < 0) goto LAB_6769b712;
        if (iVar4 != 0) goto LAB_6769b5ef;
        (**(code **)(**(int **)((int)this + 4) + 0x18))(*(int **)((int)this + 4));
        goto LAB_6769b60f;
      }
      uVar6 = 0;
    }
    else {
      iVar4 = *piVar1;
      uVar6 = 1;
    }
    (**(code **)(iVar4 + 0x3c))(piVar1,&local_18,uVar6);
  }
LAB_6769b60f:
  *(uint *)((int)this + 0x44) = *(uint *)((int)this + 0x44) | 4;
  local_14 = (int *)0x0;
  local_10 = (int *)0x0;
  local_50[0] = 0x14;
  iVar4 = (**(code **)(**(int **)((int)this + 4) + 0xc))(*(int **)((int)this + 4),&local_1c);
  if (iVar4 == 0) {
    (**(code **)(**(int **)((int)this + 4) + 0x20))
              (*(int **)((int)this + 4),&local_14,&local_10,local_2c,local_3c,local_50);
    if ((*(byte *)((int)this + 0x44) & 2) == 0) {
      if ((HWND)**(undefined4 **)((int)this + 0x3c) == (HWND)0x0) {
                    /* WARNING: Load size is inaccurate */
        (*(code *)**this)(local_1c,local_2c);
      }
      else {
        ShowWindow((HWND)**(undefined4 **)((int)this + 0x3c),5);
        hWnd = GetFocus();
        BVar5 = IsChild((HWND)**(undefined4 **)((int)this + 0x3c),hWnd);
        if (BVar5 == 0) {
          SetFocus((HWND)**(undefined4 **)((int)this + 0x3c));
        }
      }
    }
    (**(code **)(*local_8 + 0x1c))(local_8,local_2c,local_3c);
  }
                    /* WARNING: Load size is inaccurate */
  local_c = (int *)0x0;
  (**(code **)(*this + 4))(&DAT_676bb630,&local_c);
  iVar4 = FUN_6769b7b8(this,param_1);
  if ((iVar4 != 0) && ((*(uint *)((int)this + 0x44) & 8) == 0)) {
    *(uint *)((int)this + 0x44) = *(uint *)((int)this + 0x44) | 8;
    iVar4 = (**(code **)(**(int **)((int)this + 4) + 0x1c))(*(int **)((int)this + 4));
    if (iVar4 < 0) {
      if (local_c != (int *)0x0) {
        (**(code **)(*local_c + 8))(local_c);
      }
      if (local_10 != (int *)0x0) {
        (**(code **)(*local_10 + 8))(local_10);
      }
      if (local_14 != (int *)0x0) {
        (**(code **)(*local_14 + 8))(local_14);
      }
LAB_6769b712:
      if (local_8 != (int *)0x0) {
        (**(code **)(*local_8 + 8))(local_8);
        return iVar4;
      }
      return iVar4;
    }
    FUN_6769b7e9(this,1);
    if (local_c != (int *)0x0) {
      if (local_14 != (int *)0x0) {
        (**(code **)(*local_14 + 0x20))(local_14,local_c,0);
      }
      if (local_10 != (int *)0x0) {
        (**(code **)(*local_10 + 0x20))(local_10,local_c,0);
      }
    }
    if (local_14 != (int *)0x0) {
      (**(code **)(*local_14 + 0x1c))(local_14,0);
    }
    if (local_10 != (int *)0x0) {
      (**(code **)(*local_10 + 0x1c))(local_10,0);
    }
  }
  (**(code **)(**(int **)((int)this + 0x10) + 0x18))(*(int **)((int)this + 0x10));
  if (local_c != (int *)0x0) {
    (**(code **)(*local_c + 8))(local_c);
  }
  if (local_10 != (int *)0x0) {
    (**(code **)(*local_10 + 8))(local_10);
  }
  if (local_14 != (int *)0x0) {
    (**(code **)(*local_14 + 8))(local_14);
  }
  if (local_8 != (int *)0x0) {
    (**(code **)(*local_8 + 8))(local_8);
  }
  return 0;
}



// Function: FUN_6769b7b8 at 6769b7b8

undefined4 __thiscall FUN_6769b7b8(void *this,int param_1)

{
  undefined4 uVar1;
  
  uVar1 = 0;
  if ((param_1 == -4) || (param_1 == 0)) {
    uVar1 = 1;
  }
  if ((-6 < param_1) &&
     (((param_1 < -3 || ((-2 < param_1 && (param_1 < 1)))) && (*(int *)((int)this + 0x18) == 0)))) {
    uVar1 = 1;
  }
  return uVar1;
}



// Function: FUN_6769b7e9 at 6769b7e9

bool __thiscall FUN_6769b7e9(void *this,int param_1)

{
  uint uVar1;
  int iVar2;
  HWND hWndParent;
  HWND hWnd;
  BOOL BVar3;
  
  uVar1 = *(uint *)((int)this + 0x44);
  if ((uVar1 & 2) == 0) {
    if ((uVar1 & 4) != 0) {
      if (param_1 == 0) {
        hWndParent = GetParent((HWND)**(undefined4 **)((int)this + 0x3c));
      }
      else {
        hWndParent = (HWND)**(undefined4 **)((int)this + 0x3c);
      }
      if (((*(byte *)((int)this + 0x44) & 8) == 0) && (param_1 != 0)) {
        iVar2 = FUN_6769b51b(this,-4);
        return -1 < iVar2;
      }
      hWnd = GetFocus();
      BVar3 = IsChild(hWndParent,hWnd);
      if (BVar3 == 0) {
        SetFocus(hWndParent);
      }
      return true;
    }
  }
  else if ((((uVar1 & 8) != 0) || (param_1 == 0)) || (iVar2 = FUN_6769b51b(this,-4), -1 < iVar2)) {
    iVar2 = (**(code **)(**(int **)((int)this + 4) + 0x58))(*(int **)((int)this + 4),param_1);
    return (bool)('\x01' - (iVar2 != 0));
  }
  return false;
}



// Function: FUN_6769b884 at 6769b884

LONG __thiscall FUN_6769b884(void *this,HWND param_1)

{
  int iVar1;
  LONG LVar2;
  void *pvVar3;
  
                    /* WARNING: Load size is inaccurate */
  pvVar3 = this;
  iVar1 = (**(code **)(*this + 4))();
  FUN_67691681((void *)((int)this + 8),iVar1,pvVar3);
  LVar2 = SetWindowLongA(param_1,-4,(LONG)((int)this + 8));
  if (LVar2 != 0) {
    *(LONG *)((int)this + 0x1c) = LVar2;
    *(HWND *)((int)this + 4) = param_1;
    LVar2 = 1;
  }
  return LVar2;
}



// Function: FUN_6769b8d9 at 6769b8d9

undefined4 FUN_6769b8d9(int param_1,int param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    if ((param_2 < 0) || (9 < param_2)) {
      uVar1 = 0x800a017c;
    }
    else {
      *(int *)(param_1 + 0x748) = param_2;
      *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
      uVar1 = 0;
    }
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769b94f at 6769b94f

undefined4 FUN_6769b94f(int param_1,short param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(bool *)(param_1 + 0x73c) = param_2 != 0;
    (**(code **)(*(int *)(param_1 + 0xbc8) + 0xc))();
    (**(code **)(*(int *)(param_1 + 0x1300) + 0xc))();
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769b9d4 at 6769b9d4

undefined4 FUN_6769b9d4(int param_1,short param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(bool *)(param_1 + 0x798) = param_2 != 0;
    (**(code **)(*(int *)(param_1 + 0x1300) + 0xc))();
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769ba4a at 6769ba4a

undefined4 FUN_6769ba4a(int param_1,short param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(bool *)(param_1 + 0x73f) = param_2 != 0;
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769bab5 at 6769bab5

undefined4 FUN_6769bab5(int param_1,short param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(bool *)(param_1 + 0x79a) = param_2 != 0;
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769bb20 at 6769bb20

undefined4 FUN_6769bb20(int param_1,short param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(bool *)(param_1 + 0x73e) = param_2 != 0;
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769bb8b at 6769bb8b

undefined4 FUN_6769bb8b(int param_1,short param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(bool *)(param_1 + 0x799) = param_2 != 0;
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769bbd1 at 6769bbd1

undefined4 FUN_6769bbd1(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = Ordinal_2(param_1 + 0x2f2);
    uVar2 = Ordinal_7(uVar1);
    uVar2 = Ordinal_4(uVar1,uVar2);
    *param_2 = uVar2;
    Ordinal_6(uVar1);
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769bc84 at 6769bc84

undefined4 FUN_6769bc84(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = Ordinal_2(param_1 + 0xea);
    uVar2 = Ordinal_7(uVar1);
    uVar2 = Ordinal_4(uVar1,uVar2);
    *param_2 = uVar2;
    Ordinal_6(uVar1);
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769bd4c at 6769bd4c

undefined4 FUN_6769bd4c(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = FUN_676ae5f4(param_1 + 0x704);
    *param_2 = uVar1;
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769bd73 at 6769bd73

undefined4 FUN_6769bd73(int param_1,int param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    FUN_676ae4bc((void *)(param_1 + 0x704),param_2);
    (**(code **)(*(int *)(param_1 + 0xbc8) + 0xc))();
    (**(code **)(*(int *)(param_1 + 0x1300) + 0xc))();
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769bdd7 at 6769bdd7

undefined4 FUN_6769bdd7(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  LPWSTR pWVar2;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    pWVar2 = FUN_67684ed6((LPCSTR)(param_1 + 0x4fa),-1);
    uVar1 = Ordinal_7(pWVar2);
    uVar1 = Ordinal_4(pWVar2,uVar1);
    *param_2 = uVar1;
    Ordinal_6(pWVar2);
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769be1c at 6769be1c

undefined4 FUN_6769be1c(int param_1,LPCWSTR param_2)

{
  LPCRITICAL_SECTION lpCriticalSection;
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  
  lpCriticalSection = (LPCRITICAL_SECTION)(param_1 + 0x17d8);
  EnterCriticalSection(lpCriticalSection);
  uVar3 = 0;
  if (*(int *)(param_1 + 0x16dc) == 0) {
    uVar1 = Ordinal_7(param_2);
    if (uVar1 < 0x51) {
      *(LPSTR)(param_1 + 0x4fa) = '\0';
      *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
      if (param_2 != (LPCWSTR)0x0) {
        iVar2 = lstrlenW(param_2);
        FUN_676b06a0();
        WideCharToMultiByte(0,0,param_2,-1,&stack0xffffffec,iVar2 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
        lstrcpyA((LPSTR)(param_1 + 0x4fa),&stack0xffffffec);
        LeaveCriticalSection(lpCriticalSection);
        return 0;
      }
    }
    else {
      uVar3 = 0x800a017c;
    }
  }
  else {
    uVar3 = 0x800a0183;
  }
  LeaveCriticalSection(lpCriticalSection);
  return uVar3;
}



// Function: FUN_6769beed at 6769beed

undefined4 FUN_6769beed(int param_1,short param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(bool *)(param_1 + 0x79b) = param_2 != 0;
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769bf33 at 6769bf33

undefined4 FUN_6769bf33(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = Ordinal_2(param_1 + 0x7a0);
    uVar2 = Ordinal_7(uVar1);
    uVar2 = Ordinal_4(uVar1,uVar2);
    *param_2 = uVar2;
    Ordinal_6(uVar1);
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769c006 at 6769c006

undefined4 FUN_6769c006(int param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(undefined4 *)(param_1 + 0x79c) = param_2;
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769c047 at 6769c047

undefined4 FUN_6769c047(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = FUN_676ae5f4(param_1 + 0x720);
    *param_2 = uVar1;
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769c06e at 6769c06e

undefined4 FUN_6769c06e(int param_1,int param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    FUN_676ae4bc((void *)(param_1 + 0x720),param_2);
    (**(code **)(*(int *)(param_1 + 0xbc8) + 0xc))();
    (**(code **)(*(int *)(param_1 + 0x1300) + 0xc))();
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769c133 at 6769c133

undefined4 FUN_6769c133(int param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(undefined4 *)(param_1 + 0x740) = param_2;
    (**(code **)(*(int *)(param_1 + 0x1300) + 0xc))();
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769c19f at 6769c19f

undefined4 FUN_6769c19f(int param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(undefined4 *)(param_1 + 0x744) = param_2;
    (**(code **)(*(int *)(param_1 + 0x1300) + 0xc))();
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769c1eb at 6769c1eb

undefined4 FUN_6769c1eb(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = Ordinal_2(param_1 + 0x9a8);
    uVar2 = Ordinal_7(uVar1);
    uVar2 = Ordinal_4(uVar1,uVar2);
    *param_2 = uVar2;
    Ordinal_6(uVar1);
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769c2d3 at 6769c2d3

undefined4 FUN_6769c2d3(int param_1,undefined8 param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(undefined8 *)(param_1 + 0x768) = param_2;
    Ordinal_185(param_2,param_1 + 0x758);
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769c34a at 6769c34a

undefined4 FUN_6769c34a(int param_1,undefined8 param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(undefined8 *)(param_1 + 0x788) = param_2;
    Ordinal_185(param_2,param_1 + 0x778);
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769c3c1 at 6769c3c1

undefined4 FUN_6769c3c1(int param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(undefined4 *)(param_1 + 0x790) = param_2;
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769c422 at 6769c422

undefined4 FUN_6769c422(int param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(undefined4 *)(param_1 + 0x794) = param_2;
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769c4a3 at 6769c4a3

undefined4 FUN_6769c4a3(int param_1,int param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    if ((param_2 < 0) || (2 < param_2)) {
      uVar1 = 0x800a017c;
    }
    else {
      *(int *)(param_1 + 0xbb0) = param_2;
      *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
      uVar1 = 0;
    }
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769c514 at 6769c514

undefined4 FUN_6769c514(int param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(undefined4 *)(param_1 + 0xbb4) = param_2;
    (**(code **)(*(int *)(param_1 + 0x1300) + 0xc))();
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769c585 at 6769c585

undefined4 FUN_6769c585(int param_1,short param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(bool *)(param_1 + 3000) = param_2 != 0;
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769c5f0 at 6769c5f0

undefined4 FUN_6769c5f0(int param_1,short param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(bool *)(param_1 + 0x16e0) = param_2 != 0;
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769c6e9 at 6769c6e9

undefined4 FUN_6769c6e9(int param_1,int param_2)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  
  if (param_2 != 0) {
    iVar1 = FUN_67683c76();
    uVar2 = FUN_67683dbd();
    if (((int)uVar2 < iVar1) && (uVar2 = FUN_67683dee(), (int)uVar2 < iVar1)) {
      return 0x800a0183;
    }
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(int *)(param_1 + 0xbbc) = param_2;
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar3 = 0;
  }
  else {
    uVar3 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar3;
}



// Function: FUN_6769c770 at 6769c770

undefined4 FUN_6769c770(int param_1,int param_2)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  
  if (param_2 != 0) {
    iVar1 = FUN_67683c76();
    uVar2 = FUN_67683dbd();
    if (((int)uVar2 < iVar1) && (uVar2 = FUN_67683dee(), (int)uVar2 < iVar1)) {
      return 0x800a0183;
    }
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(int *)(param_1 + 0xbc0) = param_2;
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar3 = 0;
  }
  else {
    uVar3 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar3;
}



// Function: FUN_6769c7f7 at 6769c7f7

undefined4 FUN_6769c7f7(int param_1,int param_2)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  
  if (param_2 != 0x7fffffff) {
    iVar1 = FUN_67683c76();
    uVar2 = FUN_67683dbd();
    if (((int)uVar2 < iVar1) && (uVar2 = FUN_67683dee(), (int)uVar2 < iVar1)) {
      return 0x800a0183;
    }
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(int *)(param_1 + 0x1810) = param_2;
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar3 = 0;
  }
  else {
    uVar3 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar3;
}



// Function: FUN_6769c910 at 6769c910

undefined4 FUN_6769c910(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = Ordinal_2(param_1 + 0x1498);
    uVar2 = Ordinal_7(uVar1);
    uVar2 = Ordinal_4(uVar1,uVar2);
    *param_2 = uVar2;
    Ordinal_6(uVar1);
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769c952 at 6769c952

undefined4 FUN_6769c952(int param_1,short *param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    if (param_2 == (short *)0x0) {
      *(undefined2 *)(param_1 + 0x1498) = 0;
    }
    else {
      FUN_676ae1fc((short *)(param_1 + 0x1498),param_2);
    }
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769c9ac at 6769c9ac

undefined4 FUN_6769c9ac(int param_1,int param_2,undefined4 *param_3)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_3 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else if ((param_2 < 0) || (0xc < param_2)) {
    uVar1 = 0x800a017d;
  }
  else {
    uVar1 = Ordinal_2(*(undefined4 *)(param_1 + 0x13b4 + param_2 * 4));
    uVar2 = Ordinal_7(uVar1);
    uVar2 = Ordinal_4(uVar1,uVar2);
    *param_3 = uVar2;
    Ordinal_6(uVar1);
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769ca03 at 6769ca03

undefined4 FUN_6769ca03(int param_1,int param_2,short *param_3)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    if ((param_2 < 0) || (0xc < param_2)) {
      uVar1 = 0x800a017d;
    }
    else {
      FUN_6768be2e((void *)(param_1 + 0x135c),param_2,param_3);
      *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
      uVar1 = 0;
    }
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769ca61 at 6769ca61

undefined4 FUN_6769ca61(int param_1,int param_2,undefined4 *param_3)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_3 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else if ((param_2 < 0) || (0xc < param_2)) {
    uVar1 = 0x800a017d;
  }
  else {
    uVar1 = Ordinal_2(*(undefined4 *)(param_1 + 0x13e8 + param_2 * 4));
    uVar2 = Ordinal_7(uVar1);
    uVar2 = Ordinal_4(uVar1,uVar2);
    *param_3 = uVar2;
    Ordinal_6(uVar1);
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769cab8 at 6769cab8

undefined4 FUN_6769cab8(int param_1,int param_2,short *param_3)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    if ((param_2 < 0) || (0xc < param_2)) {
      uVar1 = 0x800a017d;
    }
    else {
      FUN_6768bf3d((void *)(param_1 + 0x135c),param_2,param_3);
      *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
      uVar1 = 0;
    }
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769cb16 at 6769cb16

undefined4 FUN_6769cb16(int param_1,int param_2,undefined4 *param_3)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_3 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else if ((param_2 < 0) || (4 < param_2)) {
    uVar1 = 0x800a017d;
  }
  else {
    uVar1 = Ordinal_2(*(undefined4 *)(param_1 + 0x141c + param_2 * 4));
    uVar2 = Ordinal_7(uVar1);
    uVar2 = Ordinal_4(uVar1,uVar2);
    *param_3 = uVar2;
    Ordinal_6(uVar1);
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769cb6d at 6769cb6d

undefined4 FUN_6769cb6d(int param_1,int param_2,short *param_3)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    if ((param_2 < 0) || (4 < param_2)) {
      uVar1 = 0x800a017d;
    }
    else {
      FUN_6768bfe2((void *)(param_1 + 0x135c),param_2,param_3);
      *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
      uVar1 = 0;
    }
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769cbcb at 6769cbcb

undefined4 FUN_6769cbcb(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = Ordinal_2(*(undefined4 *)(param_1 + 0x1494));
    uVar2 = Ordinal_7(uVar1);
    uVar2 = Ordinal_4(uVar1,uVar2);
    *param_2 = uVar2;
    Ordinal_6(uVar1);
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769cc0d at 6769cc0d

undefined4 FUN_6769cc0d(int param_1,short *param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    FUN_6769cc53((void *)(param_1 + 0x135c),param_2);
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769cc53 at 6769cc53

void __thiscall FUN_6769cc53(void *this,short *param_1)

{
  int iVar1;
  short *psVar2;
  
  if (*(undefined **)((int)this + 0x138) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)((int)this + 0x138));
    *(undefined4 *)((int)this + 0x138) = 0;
  }
  if (param_1 != (short *)0x0) {
    iVar1 = FUN_676ae2a4(param_1);
    psVar2 = (short *)operator_new(iVar1 * 2 + 2);
    *(short **)((int)this + 0x138) = psVar2;
    if (psVar2 != (short *)0x0) {
      FUN_676ae1fc(psVar2,param_1);
    }
  }
  return;
}



// Function: FUN_6769cca1 at 6769cca1

undefined4 FUN_6769cca1(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = Ordinal_2(*(undefined4 *)(param_1 + 0x1430));
    uVar2 = Ordinal_7(uVar1);
    uVar2 = Ordinal_4(uVar1,uVar2);
    *param_2 = uVar2;
    Ordinal_6(uVar1);
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769cce3 at 6769cce3

undefined4 FUN_6769cce3(int param_1,short *param_2)

{
  uint uVar1;
  undefined4 uVar2;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    uVar1 = Ordinal_7(param_2);
    if (uVar1 < 0x51) {
      FUN_6769cd3f((void *)(param_1 + 0x135c),param_2);
      *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
      uVar2 = 0;
    }
    else {
      uVar2 = 0x800a017c;
    }
  }
  else {
    uVar2 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar2;
}



// Function: FUN_6769cd3f at 6769cd3f

void __thiscall FUN_6769cd3f(void *this,short *param_1)

{
  int iVar1;
  short *psVar2;
  
  if (*(undefined **)((int)this + 0xd4) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)((int)this + 0xd4));
    *(undefined4 *)((int)this + 0xd4) = 0;
  }
  if (param_1 != (short *)0x0) {
    iVar1 = FUN_676ae2a4(param_1);
    psVar2 = (short *)operator_new(iVar1 * 2 + 2);
    *(short **)((int)this + 0xd4) = psVar2;
    if (psVar2 != (short *)0x0) {
      FUN_676ae1fc(psVar2,param_1);
    }
  }
  return;
}



// Function: FUN_6769cdb2 at 6769cdb2

undefined4 FUN_6769cdb2(int param_1,short param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(bool *)(param_1 + 0x16a2) = param_2 != 0;
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769cdf8 at 6769cdf8

undefined4 FUN_6769cdf8(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = Ordinal_2(*(undefined4 *)(param_1 + 0x1434));
    uVar2 = Ordinal_7(uVar1);
    uVar2 = Ordinal_4(uVar1,uVar2);
    *param_2 = uVar2;
    Ordinal_6(uVar1);
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769ce3a at 6769ce3a

undefined4 FUN_6769ce3a(int param_1,short *param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    FUN_6769ce80((void *)(param_1 + 0x135c),param_2);
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769ce80 at 6769ce80

void __thiscall FUN_6769ce80(void *this,short *param_1)

{
  int iVar1;
  short *psVar2;
  
  if (*(undefined **)((int)this + 0xd8) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)((int)this + 0xd8));
    *(undefined4 *)((int)this + 0xd8) = 0;
  }
  if (param_1 != (short *)0x0) {
    iVar1 = FUN_676ae2a4(param_1);
    psVar2 = (short *)operator_new(iVar1 * 2 + 2);
    *(short **)((int)this + 0xd8) = psVar2;
    if (psVar2 != (short *)0x0) {
      FUN_676ae1fc(psVar2,param_1);
    }
  }
  return;
}



// Function: FUN_6769ceee at 6769ceee

undefined4 FUN_6769ceee(int param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    *(undefined4 *)(param_1 + 0x16a4) = param_2;
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769cf2f at 6769cf2f

undefined4 FUN_6769cf2f(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = Ordinal_2(*(undefined4 *)(param_1 + 0x1438));
    uVar2 = Ordinal_7(uVar1);
    uVar2 = Ordinal_4(uVar1,uVar2);
    *param_2 = uVar2;
    Ordinal_6(uVar1);
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769cf71 at 6769cf71

undefined4 FUN_6769cf71(int param_1,short *param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    FUN_6769cfb7((void *)(param_1 + 0x135c),param_2);
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769cfb7 at 6769cfb7

void __thiscall FUN_6769cfb7(void *this,short *param_1)

{
  int iVar1;
  short *psVar2;
  
  if (*(undefined **)((int)this + 0xdc) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)((int)this + 0xdc));
    *(undefined4 *)((int)this + 0xdc) = 0;
  }
  if (param_1 != (short *)0x0) {
    iVar1 = FUN_676ae2a4(param_1);
    psVar2 = (short *)operator_new(iVar1 * 2 + 2);
    *(short **)((int)this + 0xdc) = psVar2;
    if (psVar2 != (short *)0x0) {
      FUN_676ae1fc(psVar2,param_1);
    }
  }
  return;
}



// Function: FUN_6769d005 at 6769d005

undefined4 FUN_6769d005(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = FUN_6769d04d(param_1 + 0x135c);
    uVar1 = Ordinal_2(uVar1);
    uVar2 = Ordinal_7(uVar1);
    uVar2 = Ordinal_4(uVar1,uVar2);
    *param_2 = uVar2;
    Ordinal_6(uVar1);
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769d04d at 6769d04d

void __fastcall FUN_6769d04d(int param_1)

{
  short *psVar1;
  
  if (*(undefined **)(param_1 + 0x34c) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)(param_1 + 0x34c));
    *(undefined4 *)(param_1 + 0x34c) = 0;
  }
  psVar1 = FUN_676ae4ce(param_1 + 0xe0);
  *(short **)(param_1 + 0x34c) = psVar1;
  return;
}



// Function: FUN_6769d0d7 at 6769d0d7

undefined4 FUN_6769d0d7(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = Ordinal_2(*(undefined4 *)(param_1 + 0x1474));
    uVar2 = Ordinal_7(uVar1);
    uVar2 = Ordinal_4(uVar1,uVar2);
    *param_2 = uVar2;
    Ordinal_6(uVar1);
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769d119 at 6769d119

undefined4 FUN_6769d119(int param_1,short *param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    FUN_6769d15f((void *)(param_1 + 0x135c),param_2);
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0183;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769d15f at 6769d15f

void __thiscall FUN_6769d15f(void *this,short *param_1)

{
  int iVar1;
  short *psVar2;
  
  if (*(undefined **)((int)this + 0x118) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)((int)this + 0x118));
    *(undefined4 *)((int)this + 0x118) = 0;
  }
  if (param_1 != (short *)0x0) {
    iVar1 = FUN_676ae2a4(param_1);
    psVar2 = (short *)operator_new(iVar1 * 2 + 2);
    *(short **)((int)this + 0x118) = psVar2;
    if (psVar2 != (short *)0x0) {
      FUN_676ae1fc(psVar2,param_1);
    }
  }
  return;
}



// Function: FUN_6769d1ad at 6769d1ad

undefined4 FUN_6769d1ad(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = FUN_6769d1f5(param_1 + 0x135c);
    uVar1 = Ordinal_2(uVar1);
    uVar2 = Ordinal_7(uVar1);
    uVar2 = Ordinal_4(uVar1,uVar2);
    *param_2 = uVar2;
    Ordinal_6(uVar1);
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769d1f5 at 6769d1f5

void __fastcall FUN_6769d1f5(int param_1)

{
  short *psVar1;
  
  if (*(undefined **)(param_1 + 0x34c) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)(param_1 + 0x34c));
    *(undefined4 *)(param_1 + 0x34c) = 0;
  }
  psVar1 = FUN_676ae4ce(param_1 + 0xfc);
  *(short **)(param_1 + 0x34c) = psVar1;
  return;
}



// Function: FUN_6769d27f at 6769d27f

undefined4 FUN_6769d27f(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = FUN_6769d2c7(param_1 + 0x135c);
    uVar1 = Ordinal_2(uVar1);
    uVar2 = Ordinal_7(uVar1);
    uVar2 = Ordinal_4(uVar1,uVar2);
    *param_2 = uVar2;
    Ordinal_6(uVar1);
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769d2c7 at 6769d2c7

void __fastcall FUN_6769d2c7(int param_1)

{
  short *psVar1;
  
  if (*(undefined **)(param_1 + 0x34c) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)(param_1 + 0x34c));
    *(undefined4 *)(param_1 + 0x34c) = 0;
  }
  psVar1 = FUN_676ae4ce(param_1 + 0x11c);
  *(short **)(param_1 + 0x34c) = psVar1;
  return;
}



// Function: FUN_6769d351 at 6769d351

undefined4 FUN_6769d351(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = FUN_676ae5f4(param_1 + 0x1360);
    *param_2 = uVar1;
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769d3c9 at 6769d3c9

undefined4 FUN_6769d3c9(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = FUN_676ae5f4(param_1 + 0x1398);
    *param_2 = uVar1;
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769d441 at 6769d441

undefined4 FUN_6769d441(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = FUN_676ae5f4(param_1 + 0x137c);
    *param_2 = uVar1;
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769d548 at 6769d548

undefined4 FUN_6769d548(int param_1,int param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    FUN_676ae469((void *)(param_1 + 0x704),param_2);
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0046;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769d58e at 6769d58e

undefined4 FUN_6769d58e(int param_1,int param_2)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    FUN_676ae469((void *)(param_1 + 0x720),param_2);
    *(byte *)(param_1 + 0x48) = *(byte *)(param_1 + 0x48) | 0x80;
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0046;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769d5d4 at 6769d5d4

undefined4 FUN_6769d5d4(void *param_1,short param_2,int *param_3)

{
  LPCRITICAL_SECTION lpCriticalSection;
  undefined4 uVar1;
  int iVar2;
  
  uVar1 = FUN_6769a1d9();
  if ((char)uVar1 == '\0') {
    if ((*(byte *)((int)param_1 + 0x1811) & 8) != 0) {
      FUN_676a557f((void *)((int)param_1 + 0xa8),0,0,0,0,0,0,0,0,0,0,0,0,0x212,
                   (int *)((int)param_1 + 0x17f4),(int *)((int)param_1 + 0x1800));
    }
    *param_3 = 0x212;
  }
  else {
    lpCriticalSection = (LPCRITICAL_SECTION)((int)param_1 + 0x17d8);
    EnterCriticalSection(lpCriticalSection);
    if (*(int *)((int)param_1 + 0x16dc) == 0) {
      *(undefined4 *)((int)param_1 + 0x16dc) = 1;
      LeaveCriticalSection(lpCriticalSection);
      if (*(char *)((int)param_1 + 0x16e0) == '\0') {
        iVar2 = FUN_676a0c69(param_1,param_2 != 0);
      }
      else {
        iVar2 = FUN_676a1adf(param_1,param_2 != 0);
      }
      *param_3 = iVar2;
    }
    else {
      LeaveCriticalSection(lpCriticalSection);
      *param_3 = 0x204;
    }
  }
  return 0;
}



// Function: FUN_6769d696 at 6769d696

undefined4 FUN_6769d696(void *param_1,int *param_2)

{
  LPCRITICAL_SECTION lpCriticalSection;
  undefined4 uVar1;
  int iVar2;
  
  uVar1 = FUN_6769a1d9();
  if ((char)uVar1 == '\0') {
    if ((*(byte *)((int)param_1 + 0x1811) & 8) != 0) {
      FUN_676a557f((void *)((int)param_1 + 0xa8),0,0,0,0,0,0,0,0,0,0,0,0,0x212,
                   (int *)((int)param_1 + 0x17f4),(int *)((int)param_1 + 0x1800));
    }
    *param_2 = 0x212;
  }
  else {
    lpCriticalSection = (LPCRITICAL_SECTION)((int)param_1 + 0x17d8);
    EnterCriticalSection(lpCriticalSection);
    if (*(int *)((int)param_1 + 0x16dc) == 0) {
      *(undefined4 *)((int)param_1 + 0x16dc) = 3;
      LeaveCriticalSection(lpCriticalSection);
      if (*(char *)((int)param_1 + 0x16e0) == '\0') {
        iVar2 = FUN_676a0e82((int)param_1);
      }
      else {
        iVar2 = FUN_676a1b51(param_1);
      }
      *param_2 = iVar2;
    }
    else {
      LeaveCriticalSection(lpCriticalSection);
      *param_2 = 0x204;
    }
  }
  return 0;
}



// Function: FUN_6769d746 at 6769d746

undefined4 FUN_6769d746(void *param_1,int *param_2)

{
  LPCRITICAL_SECTION lpCriticalSection;
  undefined4 uVar1;
  int iVar2;
  
  uVar1 = FUN_6769a1d9();
  if ((char)uVar1 == '\0') {
    if ((*(byte *)((int)param_1 + 0x1811) & 8) != 0) {
      FUN_676a557f((void *)((int)param_1 + 0xa8),0,0,0,0,0,0,0,0,0,0,0,0,0x212,
                   (int *)((int)param_1 + 0x17f4),(int *)((int)param_1 + 0x1800));
    }
    *param_2 = 0x212;
  }
  else {
    lpCriticalSection = (LPCRITICAL_SECTION)((int)param_1 + 0x17d8);
    EnterCriticalSection(lpCriticalSection);
    if (*(int *)((int)param_1 + 0x16dc) == 0) {
      *(undefined4 *)((int)param_1 + 0x16dc) = 2;
      LeaveCriticalSection(lpCriticalSection);
      if (*(char *)((int)param_1 + 0x16e0) == '\0') {
        iVar2 = FUN_676a0db9((int)param_1);
      }
      else {
        iVar2 = FUN_676a1b1d(param_1);
      }
      *param_2 = iVar2;
    }
    else {
      LeaveCriticalSection(lpCriticalSection);
      *param_2 = 0x204;
    }
  }
  return 0;
}



// Function: FUN_6769d7f6 at 6769d7f6

undefined4 FUN_6769d7f6(void *param_1,int *param_2)

{
  LPCRITICAL_SECTION lpCriticalSection;
  undefined4 uVar1;
  int iVar2;
  
  uVar1 = FUN_6769a1d9();
  if ((char)uVar1 == '\0') {
    if ((*(byte *)((int)param_1 + 0x1811) & 8) != 0) {
      FUN_676a557f((void *)((int)param_1 + 0xa8),0,0,0,0,0,0,0,0,0,0,0,0,0x212,
                   (int *)((int)param_1 + 0x17f4),(int *)((int)param_1 + 0x1800));
    }
    *param_2 = 0x212;
  }
  else {
    lpCriticalSection = (LPCRITICAL_SECTION)((int)param_1 + 0x17d8);
    EnterCriticalSection(lpCriticalSection);
    if (*(int *)((int)param_1 + 0x16dc) == 0) {
      *(undefined4 *)((int)param_1 + 0x16dc) = 4;
      LeaveCriticalSection(lpCriticalSection);
      if (*(char *)((int)param_1 + 0x16e0) == '\0') {
        iVar2 = FUN_676a0f47((int)param_1);
      }
      else {
        iVar2 = FUN_676a1b85(param_1);
      }
      *param_2 = iVar2;
    }
    else {
      LeaveCriticalSection(lpCriticalSection);
      *param_2 = 0x204;
    }
  }
  return 0;
}



// Function: FUN_6769d8a6 at 6769d8a6

undefined4 FUN_6769d8a6(void *param_1,int *param_2)

{
  LPCRITICAL_SECTION lpCriticalSection;
  undefined4 uVar1;
  int iVar2;
  
  uVar1 = FUN_6769a1d9();
  if ((char)uVar1 == '\0') {
    if ((*(byte *)((int)param_1 + 0x1811) & 8) != 0) {
      FUN_676a557f((void *)((int)param_1 + 0xa8),0,0,0,0,0,0,0,0,0,0,0,0,0x212,
                   (int *)((int)param_1 + 0x17f4),(int *)((int)param_1 + 0x1800));
    }
    *param_2 = 0x212;
  }
  else {
    lpCriticalSection = (LPCRITICAL_SECTION)((int)param_1 + 0x17d8);
    EnterCriticalSection(lpCriticalSection);
    if (*(int *)((int)param_1 + 0x16dc) == 0) {
      *(undefined4 *)((int)param_1 + 0x16dc) = 5;
      LeaveCriticalSection(lpCriticalSection);
      if (*(char *)((int)param_1 + 0x16e0) == '\0') {
        iVar2 = FUN_676a100c((int)param_1);
      }
      else {
        iVar2 = FUN_676a1bb9(param_1);
      }
      *param_2 = iVar2;
    }
    else {
      LeaveCriticalSection(lpCriticalSection);
      *param_2 = 0x204;
    }
  }
  return 0;
}



// Function: FUN_6769d956 at 6769d956

undefined4 FUN_6769d956(void *param_1,short param_2,int *param_3)

{
  LPCRITICAL_SECTION lpCriticalSection;
  undefined4 uVar1;
  int iVar2;
  
  uVar1 = FUN_6769a1d9();
  if ((char)uVar1 == '\0') {
    if ((*(byte *)((int)param_1 + 0x1811) & 8) != 0) {
      FUN_676a557f((void *)((int)param_1 + 0xa8),0,0,0,0,0,0,0,0,0,0,0,0,0x212,
                   (int *)((int)param_1 + 0x17f4),(int *)((int)param_1 + 0x1800));
    }
    *param_3 = 0x212;
  }
  else {
    lpCriticalSection = (LPCRITICAL_SECTION)((int)param_1 + 0x17d8);
    EnterCriticalSection(lpCriticalSection);
    if (*(int *)((int)param_1 + 0x16dc) == 0) {
      *(undefined4 *)((int)param_1 + 0x16dc) = 6;
      LeaveCriticalSection(lpCriticalSection);
      if (*(char *)((int)param_1 + 0x16e0) == '\0') {
        iVar2 = FUN_676a10d1(param_1,param_2 != 0);
      }
      else {
        iVar2 = FUN_676a1bed(param_1,param_2 != 0);
      }
      *param_3 = iVar2;
    }
    else {
      LeaveCriticalSection(lpCriticalSection);
      *param_3 = 0x204;
    }
  }
  return 0;
}



// Function: FUN_6769da18 at 6769da18

undefined4
FUN_6769da18(void *param_1,undefined4 *param_2,undefined4 *param_3,undefined4 *param_4,
            undefined2 *param_5,short *param_6,undefined4 *param_7)

{
  LPCRITICAL_SECTION lpCriticalSection;
  undefined4 uVar1;
  char local_5;
  
  uVar1 = FUN_6769a1d9();
  if ((char)uVar1 == '\0') {
    if ((*(byte *)((int)param_1 + 0x1811) & 8) != 0) {
      FUN_676a557f((void *)((int)param_1 + 0xa8),0,0,0,0,0,0,0,0,0,0,0,0,0x212,
                   (int *)((int)param_1 + 0x17f4),(int *)((int)param_1 + 0x1800));
    }
    *param_7 = 0x212;
  }
  else {
    if ((((param_2 == (undefined4 *)0x0) || (param_3 == (undefined4 *)0x0)) ||
        (param_4 == (undefined4 *)0x0)) ||
       (((param_5 == (undefined2 *)0x0 || (param_6 == (short *)0x0)) ||
        (param_7 == (undefined4 *)0x0)))) {
      return 0x80004003;
    }
    lpCriticalSection = (LPCRITICAL_SECTION)((int)param_1 + 0x17d8);
    EnterCriticalSection(lpCriticalSection);
    if (*(int *)((int)param_1 + 0x16dc) == 0) {
      *(undefined4 *)((int)param_1 + 0x16dc) = 7;
      LeaveCriticalSection(lpCriticalSection);
      uVar1 = FUN_676a119c(param_1,param_2,(undefined4 *)0x0,param_3,(undefined4 *)0x0,param_4,
                           param_5,&local_5);
      *param_7 = uVar1;
      *param_6 = -(ushort)(local_5 != '\0');
    }
    else {
      LeaveCriticalSection(lpCriticalSection);
      *param_7 = 0x204;
    }
  }
  return 0;
}



// Function: FUN_6769db0e at 6769db0e

undefined4
FUN_6769db0e(void *param_1,undefined2 *param_2,undefined2 *param_3,undefined2 *param_4,
            undefined2 *param_5,undefined2 *param_6,undefined2 *param_7,undefined2 *param_8,
            undefined4 *param_9)

{
  LPCRITICAL_SECTION lpCriticalSection;
  undefined4 uVar1;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  char local_5;
  
  uVar1 = FUN_6769a1d9();
  if ((char)uVar1 == '\0') {
    if ((*(byte *)((int)param_1 + 0x1811) & 8) != 0) {
      FUN_676a557f((void *)((int)param_1 + 0xa8),0,0,0,0,0,0,0,0,0,0,0,0,0x212,
                   (int *)((int)param_1 + 0x17f4),(int *)((int)param_1 + 0x1800));
    }
    *param_9 = 0x212;
  }
  else {
    if (((((param_2 == (undefined2 *)0x0) || (param_3 == (undefined2 *)0x0)) ||
         (param_4 == (undefined2 *)0x0)) ||
        ((param_5 == (undefined2 *)0x0 || (param_6 == (undefined2 *)0x0)))) ||
       ((param_7 == (undefined2 *)0x0 ||
        ((param_8 == (undefined2 *)0x0 || (param_9 == (undefined4 *)0x0)))))) {
      return 0x80004003;
    }
    Ordinal_9(param_2);
    Ordinal_9(param_3);
    Ordinal_9(param_4);
    Ordinal_9(param_5);
    Ordinal_9(param_6);
    Ordinal_9(param_7);
    Ordinal_9(param_8);
    lpCriticalSection = (LPCRITICAL_SECTION)((int)param_1 + 0x17d8);
    EnterCriticalSection(lpCriticalSection);
    if (*(int *)((int)param_1 + 0x16dc) == 0) {
      *(undefined4 *)((int)param_1 + 0x16dc) = 7;
      LeaveCriticalSection(lpCriticalSection);
      local_c = 0;
      local_10 = 0;
      local_14 = 0;
      local_18 = 0;
      local_1c = 0;
      local_20 = 0;
      local_5 = '\0';
      uVar1 = FUN_676a119c(param_1,&local_c,&local_14,&local_10,&local_1c,&local_18,
                           (undefined2 *)&local_20,&local_5);
      *param_9 = uVar1;
      *param_2 = 3;
      *(undefined4 *)(param_2 + 4) = local_c;
      *param_3 = 3;
      *(undefined4 *)(param_3 + 4) = local_10;
      *param_4 = 3;
      *(undefined4 *)(param_4 + 4) = local_14;
      *param_5 = 3;
      *(undefined4 *)(param_5 + 4) = local_18;
      *param_6 = 3;
      *(undefined4 *)(param_6 + 4) = local_1c;
      *param_7 = 2;
      param_7[4] = (undefined2)local_20;
      *param_8 = 0xb;
      param_8[4] = -(ushort)(local_5 != '\0');
    }
    else {
      LeaveCriticalSection(lpCriticalSection);
      *param_9 = 0x204;
    }
  }
  return 0;
}



// Function: FUN_6769dcc9 at 6769dcc9

undefined4 FUN_6769dcc9(void *param_1,uint param_2,int *param_3)

{
  LPCRITICAL_SECTION lpCriticalSection;
  undefined4 uVar1;
  int iVar2;
  
  if (param_3 == (int *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    *param_3 = 0;
    uVar1 = FUN_6769a1d9();
    if ((char)uVar1 == '\0') {
      if ((*(byte *)((int)param_1 + 0x1811) & 8) != 0) {
        FUN_676a557f((void *)((int)param_1 + 0xa8),0,0,0,0,0,0,0,0,0,0,0,0,0x212,
                     (int *)((int)param_1 + 0x17f4),(int *)((int)param_1 + 0x1800));
      }
      *param_3 = 0x212;
    }
    else {
      lpCriticalSection = (LPCRITICAL_SECTION)((int)param_1 + 0x17d8);
      EnterCriticalSection(lpCriticalSection);
      if (*(int *)((int)param_1 + 0x16dc) == 0) {
        *(undefined4 *)((int)param_1 + 0x16dc) = 10;
        LeaveCriticalSection(lpCriticalSection);
        if (*(char *)((int)param_1 + 0x16e0) == '\0') {
          iVar2 = FUN_676a1548(param_1,param_2);
        }
        else {
          iVar2 = FUN_676a1c6e(param_1,param_2);
        }
        *param_3 = iVar2;
      }
      else {
        LeaveCriticalSection(lpCriticalSection);
        *param_3 = 0x204;
      }
    }
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_6769dd8c at 6769dd8c

undefined4 FUN_6769dd8c(void)

{
  HWND hWndParent;
  undefined **local_cc [2];
  undefined4 local_c4 [6];
  undefined1 local_ac [84];
  undefined1 local_58 [84];
  
  FUN_6769a06e(local_cc);
  local_cc[0] = &PTR_FUN_676ba860;
  hWndParent = GetActiveWindow();
  FUN_6769171f(0x676c5588,local_c4,local_cc);
  DialogBoxParamA(DAT_676c5590,(LPCSTR)0xca,hWndParent,(DLGPROC)&LAB_6769b218,0);
  FUN_6769a2ef((int)local_58);
  FUN_6769a2ef((int)local_ac);
  return 0;
}



// Function: FUN_6769ddfe at 6769ddfe

undefined4 FUN_6769ddfe(void *param_1,int *param_2,int param_3,int *param_4)

{
  LPCRITICAL_SECTION lpCriticalSection;
  int *piVar1;
  int iVar2;
  uint uVar3;
  
  if ((param_2 != (int *)0x0) && (param_4 != (int *)0x0)) {
    *param_4 = 0;
    piVar1 = (int *)*param_2;
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 8))(piVar1);
      *param_2 = 0;
    }
    iVar2 = FUN_67683c76();
    uVar3 = FUN_67683dbd();
    if (((int)uVar3 < iVar2) && (uVar3 = FUN_67683dee(), (int)uVar3 < iVar2)) {
      if ((*(byte *)((int)param_1 + 0x1811) & 8) != 0) {
        FUN_676a557f((void *)((int)param_1 + 0xa8),0,0,0,0,0,0,0,0,0,0,0,0,0x212,
                     (int *)((int)param_1 + 0x17f4),(int *)((int)param_1 + 0x1800));
      }
      *param_4 = 0x212;
    }
    else {
      if (param_3 != 0) {
        return 0x80070057;
      }
      lpCriticalSection = (LPCRITICAL_SECTION)((int)param_1 + 0x17d8);
      EnterCriticalSection(lpCriticalSection);
      if (*(int *)((int)param_1 + 0x16dc) == 0) {
        *(undefined4 *)((int)param_1 + 0x16dc) = 9;
        LeaveCriticalSection(lpCriticalSection);
        iVar2 = FUN_676a140b(param_1,param_2,0);
        *param_4 = iVar2;
      }
      else {
        LeaveCriticalSection(lpCriticalSection);
        *param_4 = 0x204;
      }
    }
    return 0;
  }
  return 0x80004003;
}



// Function: FUN_6769deea at 6769deea

int FUN_6769deea(int *param_1,int *param_2,undefined4 param_3,undefined4 *param_4)

{
  int *piVar1;
  int *piVar2;
  undefined4 *puVar3;
  int iVar4;
  
  puVar3 = param_4;
  piVar1 = param_2;
  if ((param_2 == (int *)0x0) || (param_4 == (undefined4 *)0x0)) {
    iVar4 = -0x7fffbffd;
  }
  else {
    *param_4 = 0;
    Ordinal_9(param_2);
    param_2 = (int *)0x0;
    iVar4 = (**(code **)(*param_1 + 0x1c4))(param_1,&param_2,param_3,puVar3);
    piVar2 = param_2;
    if (-1 < iVar4) {
      param_2 = (int *)0x0;
      *(undefined2 *)piVar1 = 9;
      piVar1[2] = (int)piVar2;
    }
    if (param_2 != (int *)0x0) {
      (**(code **)(*param_2 + 8))(param_2);
    }
  }
  return iVar4;
}



// Function: FUN_6769df50 at 6769df50

undefined4 FUN_6769df50(int param_1,short *param_2,short *param_3)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    FUN_6769df96((void *)(param_1 + 0x135c),param_2,param_3);
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0046;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769df96 at 6769df96

void __thiscall FUN_6769df96(void *this,short *param_1,short *param_2)

{
  int iVar1;
  int iVar2;
  short *psVar3;
  
  iVar1 = FUN_676ae2a4(param_1);
  iVar2 = FUN_676ae2a4(param_2);
  psVar3 = (short *)operator_new((iVar1 + iVar2) * 2 + 4);
  if (psVar3 != (short *)0x0) {
    FUN_676ae1fc(psVar3,param_1);
    FUN_676ae272(psVar3,(short *)&DAT_676c1bc0);
    FUN_676ae272(psVar3,param_2);
    FUN_676ae3f9((void *)((int)this + 0xe0),(int)psVar3);
    FUN_676b0bb3((undefined *)psVar3);
  }
  return;
}



// Function: FUN_6769dffd at 6769dffd

undefined4 FUN_6769dffd(int param_1,short *param_2,short *param_3,short *param_4)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    FUN_6769e047((void *)(param_1 + 0x135c),param_2,param_3,param_4);
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0046;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769e047 at 6769e047

void __thiscall FUN_6769e047(void *this,short *param_1,short *param_2,short *param_3)

{
  int iVar1;
  int iVar2;
  int iVar3;
  short *psVar4;
  
  iVar1 = FUN_676ae2a4(param_1);
  iVar2 = FUN_676ae2a4(param_2);
  iVar3 = FUN_676ae2a4(param_3);
  psVar4 = (short *)operator_new((iVar1 + iVar2 + iVar3) * 2 + 6);
  if (psVar4 != (short *)0x0) {
    FUN_676ae1fc(psVar4,param_1);
    FUN_676ae272(psVar4,(short *)&DAT_676c1bc0);
    FUN_676ae272(psVar4,param_2);
    FUN_676ae272(psVar4,(short *)&DAT_676c1bc0);
    FUN_676ae272(psVar4,param_3);
    FUN_676ae3f9((void *)((int)this + 0xfc),(int)psVar4);
    FUN_676b0bb3((undefined *)psVar4);
  }
  return;
}



// Function: FUN_6769e0cb at 6769e0cb

undefined4 FUN_6769e0cb(int param_1)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    FUN_6768bd75((void *)(param_1 + 0x135c));
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0046;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769e109 at 6769e109

undefined4 FUN_6769e109(int param_1)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    FUN_6768be84((void *)(param_1 + 0x135c));
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0046;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769e147 at 6769e147

undefined4 FUN_6769e147(int param_1)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    FUN_6768bf99((void *)(param_1 + 0x135c));
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0046;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769e185 at 6769e185

undefined4 FUN_6769e185(int param_1)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    FUN_6768c03e(param_1 + 0x135c);
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0046;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769e1c3 at 6769e1c3

undefined4 FUN_6769e1c3(int param_1)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    FUN_6768c05f(param_1 + 0x135c);
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0046;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769e201 at 6769e201

undefined4 FUN_6769e201(int param_1)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  if (*(int *)(param_1 + 0x16dc) == 0) {
    FUN_6768c083(param_1 + 0x135c);
    uVar1 = 0;
  }
  else {
    uVar1 = 0x800a0046;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return uVar1;
}



// Function: FUN_6769e23f at 6769e23f

undefined4 FUN_6769e23f(int param_1,LPCWSTR param_2,ushort *param_3)

{
  byte bVar1;
  undefined **local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  local_10 = 0;
  local_24 = 0;
  local_20 = 0;
  local_1c = 0;
  local_18 = 0;
  local_c = 0;
  local_8 = 0;
  local_14 = 0;
  local_28 = &PTR_LAB_676b99c8;
  bVar1 = FUN_6768c193((void *)(param_1 + 0x135c),&local_28,param_2);
  *param_3 = (ushort)bVar1;
  return 0;
}



// Function: FUN_6769e28b at 6769e28b

undefined4 FUN_6769e28b(int param_1,LPCWSTR param_2,ushort *param_3)

{
  byte bVar1;
  undefined **local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  local_10 = 0;
  local_24 = 0;
  local_20 = 0;
  local_1c = 0;
  local_18 = 0;
  local_c = 0;
  local_8 = 0;
  local_14 = 0;
  local_28 = &PTR_LAB_676b99c8;
  bVar1 = FUN_6768c599((void *)(param_1 + 0x135c),&local_28,param_2);
  *param_3 = (ushort)bVar1;
  return 0;
}



// Function: FUN_6769e2d7 at 6769e2d7

undefined4 FUN_6769e2d7(void *param_1,LPCWSTR param_2,int *param_3)

{
  LPCRITICAL_SECTION lpCriticalSection;
  undefined4 uVar1;
  int iVar2;
  
  uVar1 = FUN_6769a1d9();
  if ((char)uVar1 == '\0') {
    if ((*(byte *)((int)param_1 + 0x1811) & 8) != 0) {
      FUN_676a557f((void *)((int)param_1 + 0xa8),0,0,0,0,0,0,0,0,0,0,0,0,0x212,
                   (int *)((int)param_1 + 0x17f4),(int *)((int)param_1 + 0x1800));
    }
    *param_3 = 0x212;
  }
  else {
    lpCriticalSection = (LPCRITICAL_SECTION)((int)param_1 + 0x17d8);
    EnterCriticalSection(lpCriticalSection);
    if (*(int *)((int)param_1 + 0x16dc) == 0) {
      *(undefined4 *)((int)param_1 + 0x16dc) = 8;
      LeaveCriticalSection(lpCriticalSection);
      if (*(char *)((int)param_1 + 0x16e0) == '\0') {
        iVar2 = FUN_676a1340(param_1,param_2);
      }
      else {
        iVar2 = FUN_676a1c2b(param_1,param_2);
      }
      *param_3 = iVar2;
    }
    else {
      LeaveCriticalSection(lpCriticalSection);
      *param_3 = 0x204;
    }
  }
  return 0;
}



// Function: FUN_6769e38a at 6769e38a

undefined4 FUN_6769e38a(int param_1,short *param_2,short *param_3)

{
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  short *psVar4;
  
  iVar1 = FUN_67683c61();
  uVar2 = FUN_676abcf2(iVar1);
  if ((char)uVar2 == '\0') {
    uVar2 = 0x800a0183;
  }
  else {
    iVar1 = Ordinal_7(param_2);
    if (iVar1 == 0) {
      uVar2 = 0x80070057;
    }
    else {
      iVar1 = Ordinal_7(param_2);
      iVar3 = Ordinal_7(param_3);
      psVar4 = (short *)Ordinal_4(0,iVar1 + 1 + iVar3);
      if (psVar4 == (short *)0x0) {
        Ordinal_6(0);
        uVar2 = 0x8007000e;
      }
      else {
        FUN_676ae1fc(psVar4,param_2);
        FUN_676ae272(psVar4,(short *)&DAT_676c1bc0);
        iVar1 = Ordinal_7(param_3);
        if (iVar1 != 0) {
          FUN_676ae272(psVar4,param_3);
        }
        FUN_676ae3f9((void *)(param_1 + 0x1478),(int)psVar4);
        Ordinal_6(psVar4);
        uVar2 = 0;
      }
    }
  }
  return uVar2;
}



// Function: FUN_6769e435 at 6769e435

undefined4 FUN_6769e435(int param_1,short *param_2,short *param_3)

{
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  short *psVar4;
  
  iVar1 = FUN_67683c61();
  uVar2 = FUN_676abcf2(iVar1);
  if ((char)uVar2 == '\0') {
    uVar2 = 0x800a0183;
  }
  else {
    iVar1 = Ordinal_7(param_2);
    if ((iVar1 != 0) && (iVar1 = Ordinal_7(param_3), iVar1 != 0)) {
      iVar1 = Ordinal_7(param_2);
      iVar3 = Ordinal_7(param_3);
      psVar4 = (short *)Ordinal_4(0,iVar1 + 1 + iVar3);
      if (psVar4 == (short *)0x0) {
        Ordinal_6(0);
        return 0x8007000e;
      }
      FUN_676ae1fc(psVar4,param_2);
      FUN_676ae272(psVar4,(short *)&DAT_676c1bc0);
      FUN_676ae272(psVar4,param_3);
      FUN_676ae3f9((void *)(param_1 + 0x1360),(int)psVar4);
      Ordinal_6(psVar4);
      return 0;
    }
    uVar2 = 0x80070057;
  }
  return uVar2;
}



// Function: FUN_6769e522 at 6769e522

undefined4
FUN_6769e522(int param_1,short *param_2,short *param_3,uint param_4,undefined4 param_5,
            short *param_6)

{
  int iVar1;
  undefined4 uVar2;
  uint uVar3;
  LPWSTR pWVar4;
  int iVar5;
  int iVar6;
  short *psVar7;
  undefined4 local_38 [2];
  byte *local_30;
  uint local_2c;
  undefined1 local_24 [4];
  undefined **local_20;
  LPWSTR local_1c;
  undefined1 local_18;
  CHAR local_14 [8];
  uint local_c;
  LPWSTR local_8;
  
  iVar1 = FUN_67683c61();
  uVar2 = FUN_676abcf2(iVar1);
  if ((char)uVar2 == '\0') {
    return 0x800a0183;
  }
  iVar1 = Ordinal_7(param_2);
  if (iVar1 == 0) {
    return 0x80070057;
  }
  uVar3 = param_4 & 0xbfff;
  if (uVar3 < 2) {
LAB_6769e57d:
    FUN_676afacf(local_38,&param_4);
    if (local_2c != 0) {
      local_1c = (LPWSTR)0x0;
      local_18 = 0;
      local_20 = &PTR_FUN_676ba8d8;
      FUN_676a877d(&local_20,local_2c * 5 + 4);
      local_8 = local_1c;
      lstrcpyA((LPSTR)local_1c,&DAT_676c1c9c);
      local_8 = local_8 + 1;
      local_c = 0;
      if (local_2c != 0) {
        do {
          wsprintfA(local_14,s__x_03x_676c1c94,(uint)*local_30);
          lstrcpyA((LPSTR)local_8,local_14);
          local_8 = (LPWSTR)((int)local_8 + 5);
          local_30 = local_30 + 1;
          local_c = local_c + 1;
        } while (local_c < local_2c);
      }
      lstrcpyA((LPSTR)local_8,&DAT_676c1c90);
      local_8 = FUN_67684ed6((LPCSTR)local_1c,-1);
      local_20 = &PTR_FUN_676ba8d8;
      FUN_676a87b8((int)&local_20);
      FUN_676afb11(local_38);
      goto LAB_6769e6fb;
    }
    FUN_676afb11(local_38);
  }
  else {
    if (3 < uVar3) {
      if (uVar3 == 8) {
        local_8 = param_6;
        if ((param_4 & 0x4000) != 0) {
          local_8 = *(LPWSTR *)param_6;
        }
        iVar1 = Ordinal_7(local_8);
        pWVar4 = (LPWSTR)Ordinal_4(0,iVar1 + 2);
        if ((pWVar4 == (LPWSTR)0x0) || (iVar1 = Ordinal_7(pWVar4), iVar1 == 0)) {
          Ordinal_6(pWVar4);
          Ordinal_6(0);
          return 0x8007000e;
        }
        FUN_676ae1fc(pWVar4,(short *)&DAT_676c1ca0);
        iVar1 = Ordinal_7(local_8);
        if (iVar1 != 0) {
          FUN_676ae1fc(pWVar4 + 1,local_8);
        }
        FUN_676ae272(pWVar4,(short *)&DAT_676c1ca0);
        local_8 = pWVar4;
        Ordinal_6(0);
        goto LAB_6769e6fb;
      }
      if ((uVar3 < 0x10) || (0x13 < uVar3)) goto LAB_6769e57d;
    }
    Ordinal_8(local_24);
    iVar1 = Ordinal_12(local_24,&param_4,0,8);
    if (-1 < iVar1) {
      local_8 = local_1c;
LAB_6769e6fb:
      if ((local_8 == (LPWSTR)0x0) || (iVar1 = Ordinal_7(local_8), iVar1 == 0)) {
        uVar2 = 0x8000ffff;
      }
      else {
        iVar1 = Ordinal_7(local_8);
        iVar5 = Ordinal_7(param_2);
        iVar6 = Ordinal_7(param_3);
        psVar7 = (short *)Ordinal_4(0,iVar1 + iVar5 + 2 + iVar6);
        if (psVar7 == (short *)0x0) {
          Ordinal_6(0);
          uVar2 = 0x8007000e;
        }
        else {
          FUN_676ae1fc(psVar7,param_2);
          FUN_676ae272(psVar7,(short *)&DAT_676c1bc0);
          iVar1 = Ordinal_7(param_3);
          if (iVar1 != 0) {
            FUN_676ae272(psVar7,param_3);
          }
          FUN_676ae272(psVar7,(short *)&DAT_676c1bc0);
          FUN_676ae272(psVar7,local_8);
          FUN_676ae3f9((void *)(param_1 + 0x1398),(int)psVar7);
          Ordinal_6(psVar7);
          uVar2 = 0;
        }
      }
      Ordinal_6(local_8);
      return uVar2;
    }
  }
  Ordinal_6(0);
  return 0x80070057;
}



// Function: FUN_6769e7b1 at 6769e7b1

undefined4 FUN_6769e7b1(int param_1,int param_2)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = FUN_67683c61();
  uVar2 = FUN_676abcf2(iVar1);
  if ((char)uVar2 == '\0') {
    uVar2 = 0x800a0183;
  }
  else {
    FUN_676ae3f9((void *)(param_1 + 0x1398),param_2);
    uVar2 = 0;
  }
  return uVar2;
}



// Function: FUN_6769e7e0 at 6769e7e0

undefined4 FUN_6769e7e0(undefined4 param_1,int param_2,short *param_3)

{
  short *psVar1;
  char cVar2;
  undefined4 uVar3;
  
  psVar1 = param_3;
  if (param_3 == (short *)0x0) {
    uVar3 = 0x80004003;
  }
  else {
    cVar2 = FUN_6768eda2(&param_2,(HKEY__)(-(uint)(param_2 != 0) & (uint)&param_2),
                         (char *)((int)&param_3 + 3));
    *psVar1 = -(ushort)(cVar2 != '\0');
    uVar3 = 0;
  }
  return uVar3;
}



// Function: FUN_6769e818 at 6769e818

int FUN_6769e818(int *param_1,undefined4 *param_2,int param_3,undefined4 *param_4)

{
  int iVar1;
  int iVar2;
  undefined *puVar3;
  undefined1 local_18 [4];
  int local_14;
  int *local_10;
  int *local_c;
  int *local_8;
  
  if (param_4 == (undefined4 *)0x0) {
    iVar1 = -0x7fffbffd;
  }
  else {
    *param_4 = 0;
    local_8 = (int *)0x0;
    local_10 = (int *)0x0;
    local_c = (int *)0x0;
    iVar1 = (**(code **)*param_1)(param_1,&DAT_676bb580,&local_10);
    if (((-1 < iVar1) && (iVar1 = (**(code **)(*local_10 + 0xc))(local_10,&local_c), -1 < iVar1)) &&
       (iVar1 = (**(code **)(*local_c + 0x48))(local_c,&local_8,local_18), -1 < iVar1)) {
      param_1 = (int *)0x0;
      if (param_2 == (undefined4 *)0x0) {
        puVar3 = &DAT_676ba8a8;
        iVar1 = *local_8;
      }
      else if (param_2 == (undefined4 *)0x1) {
        puVar3 = &DAT_676ba8b8;
        iVar1 = *local_8;
      }
      else {
        if (param_2 != (undefined4 *)0x2) {
          if (local_c != (int *)0x0) {
            (**(code **)(*local_c + 8))(local_c);
          }
          if (local_10 != (int *)0x0) {
            (**(code **)(*local_10 + 8))(local_10);
          }
          if (local_8 != (int *)0x0) {
            (**(code **)(*local_8 + 8))(local_8);
          }
          return -0x7ff8ffa9;
        }
        puVar3 = &DAT_676ba8c8;
        iVar1 = *local_8;
      }
      iVar1 = (**(code **)(iVar1 + 0x18))(local_8,puVar3,&param_1);
      if (-1 < iVar1) {
        iVar1 = (**(code **)(*param_1 + 0xc))(param_1,&local_14);
        if (-1 < iVar1) {
          if (*(int *)(local_14 + 0x28) != 0) {
            (**(code **)(*param_1 + 0x4c))(param_1,local_14);
            if (param_1 != (int *)0x0) {
              (**(code **)(*param_1 + 8))(param_1);
            }
            if (local_c != (int *)0x0) {
              (**(code **)(*local_c + 8))(local_c);
            }
            if (local_10 != (int *)0x0) {
              (**(code **)(*local_10 + 8))(local_10);
            }
            if (local_8 != (int *)0x0) {
              (**(code **)(*local_8 + 8))(local_8);
            }
            return -0x7fff0001;
          }
          iVar2 = 0;
          if (*(short *)(local_14 + 0x2e) != 0) {
            while (iVar1 = (**(code **)(*param_1 + 0x18))(param_1,iVar2,&param_2), -1 < iVar1) {
              if (*(int *)(param_2[2] + 8) == param_3) {
                iVar1 = (**(code **)(*param_1 + 0x30))(param_1,*param_2,0,param_4,0,0);
              }
              (**(code **)(*param_1 + 0x54))(param_1,param_2);
              if ((iVar1 < 0) ||
                 (iVar2 = iVar2 + 1, (int)(uint)*(ushort *)(local_14 + 0x2e) <= iVar2)) break;
            }
          }
          (**(code **)(*param_1 + 0x4c))(param_1,local_14);
        }
        if (param_1 != (int *)0x0) {
          (**(code **)(*param_1 + 8))(param_1);
        }
        if (local_c != (int *)0x0) {
          (**(code **)(*local_c + 8))(local_c);
        }
        if (local_10 != (int *)0x0) {
          (**(code **)(*local_10 + 8))(local_10);
        }
        if (local_8 == (int *)0x0) {
          return iVar1;
        }
        (**(code **)(*local_8 + 8))(local_8);
        return iVar1;
      }
      if (param_1 != (int *)0x0) {
        (**(code **)(*param_1 + 8))(param_1);
      }
    }
    if (local_c != (int *)0x0) {
      (**(code **)(*local_c + 8))(local_c);
    }
    if (local_10 != (int *)0x0) {
      (**(code **)(*local_10 + 8))(local_10);
    }
    if (local_8 != (int *)0x0) {
      (**(code **)(*local_8 + 8))(local_8);
    }
  }
  return iVar1;
}



// Function: FUN_6769eb2c at 6769eb2c

void FUN_6769eb2c(int param_1,int param_2)

{
  if (param_2 == 1) {
    (**(code **)(*(int *)(param_1 + -0x74) + 0x18c))((int *)(param_1 + -0x74));
  }
  else {
    FUN_676a1fb4(param_1,param_2);
  }
  return;
}



// Function: FUN_6769eb64 at 6769eb64

uint __thiscall FUN_6769eb64(void *this,void *param_1,LPCWSTR param_2)

{
  uint *puVar1;
  uint uVar2;
  LPCWSTR pWVar3;
  LPCWSTR pWVar4;
  int *piVar5;
  int iVar6;
  undefined4 *puVar7;
  undefined4 uVar8;
  uint uVar9;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined8 uVar10;
  undefined8 uVar11;
  ulonglong uVar12;
  undefined8 uVar13;
  undefined8 uVar14;
  short sVar15;
  short sVar16;
  int iVar17;
  int *piVar18;
  undefined4 local_2c4 [8];
  undefined4 local_2a4 [8];
  undefined4 local_284 [8];
  undefined4 local_264 [8];
  undefined **local_244 [8];
  undefined **local_224 [8];
  undefined **local_204 [8];
  undefined **local_1e4 [8];
  undefined **local_1c4 [8];
  undefined **local_1a4 [8];
  undefined **local_184 [8];
  undefined **local_164 [8];
  undefined **local_144 [8];
  undefined **local_124 [8];
  undefined **local_104 [8];
  undefined **local_e4 [8];
  undefined **local_c4 [8];
  undefined **local_a4 [8];
  undefined **local_84 [6];
  undefined8 local_6c;
  undefined **local_64 [6];
  ulonglong local_4c;
  undefined **local_44 [6];
  undefined8 local_2c;
  undefined8 local_24;
  undefined8 local_1c;
  undefined8 local_14;
  undefined8 local_c;
  
  pWVar4 = param_2;
  if (((*(int *)((int)this + 0x15fc) == 8) &&
      (piVar5 = (int *)FUN_6767d6bf(this,param_1,(int *)param_2), (char)piVar5 == '\0')) ||
     (piVar5 = (int *)FUN_6767cda5(this,param_1,pWVar4), (char)piVar5 == '\0')) goto LAB_6769efab;
  if (*(int *)((int)this + 0x15fc) != 3) {
    *(int *)((int)this + 0x1604) = *(int *)((int)this + 0x1604) + 1;
    uVar2 = *(uint *)(pWVar4 + 0x10);
    iVar17 = *(int *)(pWVar4 + 0x12);
    puVar1 = (uint *)((int)this + 0x1610);
    uVar9 = *puVar1;
    *puVar1 = *puVar1 + uVar2;
    *(int *)((int)this + 0x1614) = *(int *)((int)this + 0x1614) + iVar17 + (uint)CARRY4(uVar9,uVar2)
    ;
  }
  switch(*(undefined4 *)((int)this + 0x15fc)) {
  case 2:
    if ((*(byte *)((int)this + 0x1730) & 1) != 0) {
      local_44[0] = &PTR_LAB_676b9950;
      FUN_67683181(local_44,(int)(pWVar4 + 0xd0));
      local_24 = local_2c;
      local_64[0] = &PTR_LAB_676b9950;
      FUN_67683181(local_64,(int)(pWVar4 + 0xe0));
      local_c = local_4c;
      local_84[0] = &PTR_LAB_676b9950;
      FUN_67683181(local_84,(int)(pWVar4 + 0xf0));
      param_2 = *(LPCWSTR *)(pWVar4 + 0xb6);
      piVar5 = (int *)((int)this + 0x1720);
      iVar17 = *(int *)(pWVar4 + 0x26);
      piVar18 = (int *)((int)this + 0x1714);
      sVar15 = -(ushort)(iVar17 != 0);
      pWVar3 = *(LPCWSTR *)(pWVar4 + 0xbc);
      iVar6 = *(int *)(pWVar4 + 0x1c) + 1;
      uVar14 = CONCAT44(-(uint)((pWVar4[10] & L'\x01') != L'\0'),(uint)(ushort)pWVar4[0xb]);
      uVar9 = *(uint *)(pWVar4 + 0x1a) & 0x3fff;
      uVar8 = *(undefined4 *)(pWVar4 + 0xc);
      uVar12 = local_c;
      uVar13 = local_24;
      uVar10 = FUN_676ad42d(piVar18,extraout_EDX,*(ulonglong *)(pWVar4 + 0x10),
                            *(uint *)(pWVar4 + 0x14),*(uint *)(pWVar4 + 0x16));
      FUN_676a206d((int)this + -0x38,param_2,pWVar3,*(LPCWSTR *)(pWVar4 + 0x14),
                   *(LPCWSTR *)(pWVar4 + 0x16),*(LPCWSTR *)(pWVar4 + 0x10),
                   *(LPCWSTR *)(pWVar4 + 0x12),(short)uVar10,uVar9,uVar8,local_6c,uVar12,uVar13,
                   (int)uVar14,(short)((ulonglong)uVar14 >> 0x20),iVar6,sVar15,iVar17,piVar18,piVar5
                  );
    }
    break;
  case 3:
  case 6:
    pWVar4[0x26] = L'\0';
    pWVar4[0x27] = L'\0';
    if (((*(byte *)((int)this + 0x1730) & 0x80) != 0) &&
       ((*(int *)((int)this + 0x15fc) == 6 || (*(char *)((int)this + 0x1735) != '\0')))) {
      puVar7 = FUN_67682bbb(pWVar4,local_264);
      local_14 = *(undefined8 *)(puVar7 + 6);
      puVar7 = FUN_67682b88(pWVar4,local_2a4);
      local_1c = *(undefined8 *)(puVar7 + 6);
      puVar7 = FUN_6767d0b1(pWVar4,local_284);
      uVar13 = *(undefined8 *)(puVar7 + 6);
      param_2 = *(LPCWSTR *)(pWVar4 + 0xb6);
      pWVar3 = *(LPCWSTR *)(pWVar4 + 0xbc);
      piVar5 = (int *)((int)this + 0x1720);
      piVar18 = (int *)((int)this + 0x1714);
      iVar17 = *(int *)(pWVar4 + 0x1c) + 1;
      sVar15 = -(ushort)((pWVar4[10] & L'\x01') != L'\0');
      uVar9 = (uint)(ushort)pWVar4[0xb];
      uVar12 = CONCAT44(*(undefined4 *)(pWVar4 + 0xc),*(undefined4 *)(pWVar4 + 0x1a)) &
               0xffffffff00003fff;
      uVar10 = local_1c;
      uVar14 = local_14;
      uVar11 = FUN_676ad42d(extraout_ECX_00,extraout_EDX_01,
                            CONCAT26((short)((uint)*(undefined4 *)(pWVar4 + 0x12) >> 0x10),
                                     *(undefined6 *)(pWVar4 + 0x10)),*(uint *)(pWVar4 + 0x14),
                            *(uint *)(pWVar4 + 0x16));
      FUN_676a4705((int)this + -0x38,param_2,pWVar3,*(LPCWSTR *)(pWVar4 + 0x14),
                   *(LPCWSTR *)(pWVar4 + 0x16),*(LPCWSTR *)(pWVar4 + 0x10),
                   *(LPCWSTR *)(pWVar4 + 0x12),(short)uVar11,(int)uVar12,(int)(uVar12 >> 0x20),
                   uVar13,uVar10,uVar14,uVar9,sVar15,iVar17,piVar18,piVar5);
    }
    break;
  case 4:
    piVar5 = (int *)FUN_676a04f6((void *)((int)this + -0xe0),param_1,pWVar4);
    goto LAB_6769efa3;
  case 7:
    uVar2 = *(uint *)(pWVar4 + 0x14);
    iVar17 = *(int *)(pWVar4 + 0x16);
    puVar1 = (uint *)((int)this + 0x1628);
    uVar9 = *puVar1;
    *puVar1 = *puVar1 + uVar2;
    *(int *)((int)this + 0x162c) = *(int *)((int)this + 0x162c) + iVar17 + (uint)CARRY4(uVar9,uVar2)
    ;
    break;
  case 8:
    piVar5 = (int *)FUN_676a0a5e((void *)((int)this + -0xe0),param_1,pWVar4);
LAB_6769efa3:
    if ((char)piVar5 == '\0') {
LAB_6769efab:
      return (uint)piVar5 & 0xffffff00;
    }
    break;
  case 9:
    if (*(int *)((int)this + 0x171c) == 0) {
      iVar17 = 999;
    }
    else {
      param_2 = (LPCWSTR)0x0;
      iVar17 = FUN_676a8222(&param_2);
      if (iVar17 < 0) {
        iVar17 = 0x1ff;
      }
      else {
        puVar7 = FUN_67682bbb(pWVar4,local_1e4);
        local_1c = *(undefined8 *)(puVar7 + 6);
        puVar7 = FUN_67682b88(pWVar4,local_e4);
        local_14 = *(undefined8 *)(puVar7 + 6);
        puVar7 = FUN_6767d0b1(pWVar4,local_164);
        uVar13 = *(undefined8 *)(puVar7 + 6);
        uVar8 = *(undefined4 *)(pWVar4 + 0xbc);
        local_24 = CONCAT44(*(undefined4 *)(pWVar4 + 0xb6),(undefined4)local_24);
        iVar17 = *(int *)(pWVar4 + 0x26);
        sVar15 = -(ushort)(iVar17 != 0);
        iVar6 = *(int *)(pWVar4 + 0x1c) + 1;
        sVar16 = -(ushort)((pWVar4[10] & L'\x01') != L'\0');
        uVar9 = (uint)(ushort)pWVar4[0xb];
        uVar12 = CONCAT44(*(undefined4 *)(pWVar4 + 0xc),*(undefined4 *)(pWVar4 + 0x1a)) &
                 0xffffffff00003fff;
        uVar10 = local_14;
        uVar14 = local_1c;
        uVar11 = FUN_676ad42d(extraout_ECX,extraout_EDX_00,
                              CONCAT26((short)((uint)*(undefined4 *)(pWVar4 + 0x12) >> 0x10),
                                       *(undefined6 *)(pWVar4 + 0x10)),*(uint *)(pWVar4 + 0x14),
                              *(uint *)(pWVar4 + 0x16));
        iVar17 = FUN_676a8abb(param_2,local_24._4_4_,0,uVar8,*(undefined4 *)(pWVar4 + 0x14),
                              *(undefined4 *)(pWVar4 + 0x16),*(undefined4 *)(pWVar4 + 0x10),
                              *(undefined4 *)(pWVar4 + 0x12),(short)uVar11,(int)uVar12,
                              (int)(uVar12 >> 0x20),uVar13,uVar10,uVar14,uVar9,sVar16,iVar6,sVar15,
                              iVar17);
        pWVar4 = param_2;
        local_164[0] = &PTR_LAB_676b9950;
        local_e4[0] = &PTR_LAB_676b9950;
        local_1e4[0] = &PTR_LAB_676b9950;
        if (-1 < iVar17) {
          local_c = (ulonglong)(uint)local_c;
          iVar17 = (*(code *)**(undefined4 **)param_2)(param_2,&DAT_676c1bc8,(int)&local_c + 4);
          pWVar4 = param_2;
          if (iVar17 < 0) {
            if (param_2 != (LPCWSTR)0x0) {
              FUN_676a7f93((undefined4 *)param_2);
              FUN_676b0bb3((undefined *)pWVar4);
            }
            FUN_6767ca9c(param_1,999,0x4000000);
            piVar5 = local_c._4_4_;
            if (local_c._4_4_ != (int *)0x0) {
              piVar5 = (int *)(**(code **)(*local_c._4_4_ + 8))(local_c._4_4_);
            }
            goto LAB_6769efab;
          }
          piVar5 = local_c._4_4_;
          if (local_c._4_4_ != (int *)0x0) {
            (**(code **)(*local_c._4_4_ + 4))(local_c._4_4_);
          }
          FUN_676a81f3((void *)(*(int *)((int)this + 0x171c) + 4),piVar5);
          if (local_c._4_4_ != (int *)0x0) {
            (**(code **)(*local_c._4_4_ + 8))(local_c._4_4_);
          }
          break;
        }
        if (param_2 != (LPCWSTR)0x0) {
          FUN_676a7f93((undefined4 *)param_2);
          FUN_676b0bb3((undefined *)pWVar4);
        }
        iVar17 = 999;
      }
    }
    piVar5 = (int *)FUN_6767ca9c(param_1,iVar17,0x4000000);
    goto LAB_6769efab;
  case 10:
    if (*(int *)(pWVar4 + 0x26) == 0) {
      iVar17 = (int)this + 0x1638;
      puVar7 = FUN_6767d0b1(pWVar4,local_124);
      uVar8 = FUN_6767cfc1(puVar7,iVar17);
      local_124[0] = &PTR_LAB_676b9950;
      if ((char)uVar8 != '\0') {
        param_2 = (LPCWSTR)FUN_6767d0b1(pWVar4,local_244);
        FUN_676b06d0((undefined4 *)((int)this + 0x1640),(undefined4 *)(param_2 + 4),0x10);
        local_244[0] = &PTR_LAB_676b9950;
        *(undefined8 *)((int)this + 0x1650) = *(undefined8 *)(param_2 + 0xc);
      }
      iVar17 = (int)this + 0x1658;
      puVar7 = FUN_6767d0b1(pWVar4,local_a4);
      uVar8 = FUN_6767cf97(puVar7,iVar17);
      local_a4[0] = &PTR_LAB_676b9950;
      if ((char)uVar8 != '\0') {
        param_2 = (LPCWSTR)FUN_6767d0b1(pWVar4,local_224);
        FUN_676b06d0((undefined4 *)((int)this + 0x1660),(undefined4 *)(param_2 + 4),0x10);
        local_224[0] = &PTR_LAB_676b9950;
        *(undefined8 *)((int)this + 0x1670) = *(undefined8 *)(param_2 + 0xc);
      }
      if (*(char *)((int)pWVar4 + 0x203) == '\0') {
        iVar17 = (int)this + 0x1678;
        puVar7 = FUN_67682bbb(pWVar4,local_1a4);
        uVar8 = FUN_6767cfc1(puVar7,iVar17);
        local_1a4[0] = &PTR_LAB_676b9950;
        if ((char)uVar8 != '\0') {
          param_2 = (LPCWSTR)FUN_67682bbb(pWVar4,local_204);
          FUN_676b06d0((undefined4 *)((int)this + 0x1680),(undefined4 *)(param_2 + 4),0x10);
          local_204[0] = &PTR_LAB_676b9950;
          *(undefined8 *)((int)this + 0x1690) = *(undefined8 *)(param_2 + 0xc);
        }
        iVar17 = (int)this + 0x1698;
        puVar7 = FUN_67682bbb(pWVar4,local_c4);
        uVar8 = FUN_6767cf97(puVar7,iVar17);
        local_c4[0] = &PTR_LAB_676b9950;
        if ((char)uVar8 != '\0') {
          param_2 = (LPCWSTR)FUN_67682bbb(pWVar4,local_104);
          FUN_676b06d0((undefined4 *)((int)this + 0x16a0),(undefined4 *)(param_2 + 4),0x10);
          local_104[0] = &PTR_LAB_676b9950;
          *(undefined8 *)((int)this + 0x16b0) = *(undefined8 *)(param_2 + 0xc);
        }
      }
      if ((char)pWVar4[0x102] == '\0') {
        iVar17 = (int)this + 0x16b8;
        puVar7 = FUN_67682b88(pWVar4,local_144);
        uVar8 = FUN_6767cfc1(puVar7,iVar17);
        local_144[0] = &PTR_LAB_676b9950;
        if ((char)uVar8 != '\0') {
          param_2 = (LPCWSTR)FUN_67682b88(pWVar4,local_184);
          FUN_676b06d0((undefined4 *)((int)this + 0x16c0),(undefined4 *)(param_2 + 4),0x10);
          local_184[0] = &PTR_LAB_676b9950;
          *(undefined8 *)((int)this + 0x16d0) = *(undefined8 *)(param_2 + 0xc);
        }
        iVar17 = (int)this + 0x16d8;
        puVar7 = FUN_67682b88(pWVar4,local_1c4);
        uVar8 = FUN_6767cf97(puVar7,iVar17);
        local_1c4[0] = &PTR_LAB_676b9950;
        if ((char)uVar8 != '\0') {
          puVar7 = FUN_67682b88(pWVar4,local_2c4);
          FUN_676b06d0((undefined4 *)((int)this + 0x16e0),puVar7 + 2,0x10);
          *(undefined8 *)((int)this + 0x16f0) = *(undefined8 *)(puVar7 + 6);
        }
      }
    }
  }
                    /* WARNING: Load size is inaccurate */
  uVar9 = (**(code **)(*this + 0x60))(param_1);
  return uVar9;
}



// Function: FUN_6769f23a at 6769f23a

void __thiscall FUN_6769f23a(void *this,void *param_1,LPCWSTR param_2,int *param_3)

{
  uint *puVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  undefined4 *puVar5;
  undefined4 local_74 [8];
  undefined4 local_54 [8];
  undefined4 local_34 [8];
  undefined8 local_14;
  undefined8 local_c;
  
  uVar4 = FUN_6767d116(this,param_1,(int *)param_2);
  if ((char)uVar4 != '\0') {
    *(int *)((int)this + 0x1604) = *(int *)((int)this + 0x1604) + 1;
    uVar2 = *(uint *)(param_2 + 0x14);
    iVar3 = *(int *)(param_2 + 0x16);
    puVar1 = (uint *)((int)this + 0x1610);
    uVar4 = *puVar1;
    *puVar1 = *puVar1 + uVar2;
    *(int *)((int)this + 0x1614) = *(int *)((int)this + 0x1614) + iVar3 + (uint)CARRY4(uVar4,uVar2);
    if (*(int *)((int)this + 0x15fc) == 1) {
      if ((*(byte *)((int)this + 0x1730) & 2) != 0) {
        puVar5 = FUN_67682bbb(param_2,local_34);
        local_c = *(undefined8 *)(puVar5 + 6);
        puVar5 = FUN_67682b88(param_2,local_54);
        local_14 = *(undefined8 *)(puVar5 + 6);
        puVar5 = FUN_6767d0b1(param_2,local_74);
        FUN_676a26aa((int)this + -0x38,*(LPCWSTR *)(param_2 + 0xb6),*(LPCWSTR *)(param_2 + 0xb8),
                     *(LPCWSTR *)(param_2 + 0x14),*(LPCWSTR *)(param_2 + 0x16),
                     *(uint *)(param_2 + 0x1a) & 0x3fff,*(undefined8 *)(puVar5 + 6),local_14,local_c
                     ,-(ushort)(*(int *)(param_2 + 0x26) != 0),*(int *)(param_2 + 0x26),
                     (int *)((int)this + 0x1714),(int *)((int)this + 0x1720));
      }
    }
    else if (*(int *)((int)this + 0x15fc) == 3) {
      FUN_676a077a((void *)((int)this + -0xe0),param_1,param_2,param_3);
      return;
    }
                    /* WARNING: Load size is inaccurate */
    (**(code **)(*this + 0x60))(param_1);
  }
  return;
}



// Function: FUN_6769f336 at 6769f336

uint __thiscall FUN_6769f336(void *this,void *param_1,short *param_2,undefined4 param_3)

{
  short *psVar1;
  uint uVar2;
  int iVar3;
  short *psVar4;
  
  psVar1 = param_2;
  uVar2 = FUN_6767d547(this,param_1);
  if ((char)uVar2 == '\0') {
LAB_6769f3f4:
    uVar2 = uVar2 & 0xffffff00;
  }
  else {
    if ((*(byte *)((int)this + 0x1731) & 0x10) != 0) {
      param_2 = (short *)Ordinal_2(*(undefined4 *)psVar1);
      switch(*(undefined4 *)((int)this + 0x15fc)) {
      case 2:
      case 4:
      case 6:
      case 7:
      case 9:
      case 10:
        if ((char)param_3 == '\0') {
          FUN_676a5910((void *)((int)this + -0x38),&param_2,(int *)((int)this + 0x1714),
                       (int *)((int)this + 0x1720));
        }
        break;
      case 3:
      case 5:
      case 8:
        if ((char)param_3 != '\0') {
          FUN_676a5910((void *)((int)this + -0x38),&param_2,(int *)((int)this + 0x1714),
                       (int *)((int)this + 0x1720));
          if (*(undefined **)psVar1 != (undefined *)0x0) {
            FUN_676b0bb3(*(undefined **)psVar1);
            psVar1[0] = 0;
            psVar1[1] = 0;
          }
          if (param_2 != (short *)0x0) {
            iVar3 = Ordinal_7(param_2);
            psVar4 = (short *)operator_new(iVar3 * 2 + 2);
            *(short **)psVar1 = psVar4;
            if (psVar4 == (short *)0x0) {
              Ordinal_6();
              uVar2 = FUN_6767ca9c(param_1,0x1ff,0x4000000);
              goto LAB_6769f3f4;
            }
            FUN_676ae1fc(psVar4,param_2);
          }
        }
      }
      Ordinal_6(param_2);
    }
                    /* WARNING: Load size is inaccurate */
    uVar2 = (**(code **)(*this + 0x60))(param_1);
  }
  return uVar2;
}



// Function: FUN_6769f45f at 6769f45f

uint __thiscall FUN_6769f45f(void *this,void *param_1)

{
  bool bVar1;
  undefined3 extraout_var;
  uint uVar2;
  tagMSG local_24;
  int local_8;
  
  bVar1 = FUN_6767d553(this,param_1);
  uVar2 = CONCAT31(extraout_var,bVar1);
  if (bVar1) {
    if (*(char *)((int)this + 0x1600) == '\0') {
      local_8 = 0x14;
      do {
        uVar2 = PeekMessageA(&local_24,(HWND)0x0,0,0,0);
        if (uVar2 == 0) break;
        if (local_24.message == 0x12) {
          *(undefined1 *)((int)this + 8) = 1;
          break;
        }
        uVar2 = PeekMessageA(&local_24,(HWND)0x0,0,0,1);
        if (uVar2 != 0) {
          TranslateMessage(&local_24);
          uVar2 = DispatchMessageA(&local_24);
        }
        if (local_24.message == 0xf) {
          local_8 = local_8 + -2;
        }
        local_8 = local_8 + -1;
      } while (0 < local_8);
    }
    if (*(char *)((int)this + 8) == '\0') {
      return CONCAT31((int3)(uVar2 >> 8),1);
    }
    uVar2 = FUN_6767ca9c(param_1,0x206,0x4000000);
  }
  return uVar2 & 0xffffff00;
}



// Function: FUN_6769f50c at 6769f50c

uint __thiscall FUN_6769f50c(void *this,void *param_1,int param_2)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  
  iVar1 = param_2;
  uVar2 = FUN_6767d53b(this,param_1);
  if ((char)uVar2 != '\0') {
    param_2 = 0;
    if ((*(byte *)((int)this + 0x1730) & 4) != 0) {
      uVar3 = FUN_676a2aed((void *)((int)this + -0x38),-(uint)(iVar1 != -1) & iVar1 + 1U,
                           (short *)&param_2,(int *)((int)this + 0x1714),(int *)((int)this + 0x1720)
                          );
      if ((short)param_2 != 0) {
        return CONCAT31((int3)((uint)uVar3 >> 8),1);
      }
    }
    uVar2 = FUN_6767ca9c(param_1,0x205,0x4000000);
  }
  return uVar2 & 0xffffff00;
}



// Function: FUN_6769f57a at 6769f57a

void __thiscall
FUN_6769f57a(void *this,undefined4 param_1,int param_2,LPCWSTR param_3,LPCWSTR param_4,uint param_5,
            int param_6,char param_7)

{
  uint *puVar1;
  LPCWSTR pWVar2;
  char cVar3;
  undefined2 uVar4;
  int iVar5;
  uint uVar6;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  int iVar7;
  undefined4 extraout_EDX;
  uint uVar8;
  uint uVar9;
  undefined8 uVar10;
  undefined4 uVar11;
  int iVar12;
  undefined4 uVar13;
  undefined2 uVar14;
  undefined2 uVar15;
  undefined2 uVar16;
  short sVar17;
  int *piVar18;
  int *piVar19;
  uint local_c;
  uint local_8;
  
  cVar3 = FUN_6767d58d(this,param_1);
  if (cVar3 != '\0') {
    iVar5 = *(int *)((int)this + 0x15fc);
    local_c = 0;
    local_8 = 0;
    if (iVar5 == 3) {
      local_c = *(uint *)(param_2 + 0x28);
      local_8 = *(uint *)(param_2 + 0x2c);
    }
    else if (((iVar5 == 4) || (iVar5 == 6)) || (iVar5 == 8)) {
      local_c = *(uint *)(param_2 + 0x20);
      local_8 = *(uint *)(param_2 + 0x24);
    }
    if ((*(byte *)((int)this + 0x1731) & 1) != 0) {
      piVar19 = (int *)((int)this + 0x1720);
      pWVar2 = *(LPCWSTR *)(param_2 + 0x16c);
      piVar18 = (int *)((int)this + 0x1714);
      sVar17 = -(ushort)(param_7 != '\0');
      uVar10 = FUN_676ad42d(extraout_ECX,extraout_EDX,
                            CONCAT26((short)((uint)param_6 >> 0x10),CONCAT24((short)param_6,param_5)
                                    ),(uint)param_3,(uint)param_4);
      uVar4 = (undefined2)uVar10;
      uVar10 = FUN_676ad38e(extraout_ECX_00,(int)((ulonglong)uVar10 >> 0x20),
                            CONCAT44(param_4,param_3),local_c,local_8);
      FUN_676a4c64((void *)((int)this + -0x38),pWVar2,*(int *)(param_2 + 0x28),
                   *(int *)(param_2 + 0x2c),*(LPCWSTR *)(param_2 + 0x20),*(int *)(param_2 + 0x24),
                   param_3,param_4,(short)uVar10,uVar4,sVar17,piVar18,piVar19);
    }
    uVar9 = *(uint *)((int)this + 0x1618) + (int)param_3;
    uVar8 = (int)param_4 +
            (uint)CARRY4(*(uint *)((int)this + 0x1618),(uint)param_3) + *(int *)((int)this + 0x161c)
    ;
    iVar5 = *(uint *)((int)this + 0x1628) + param_5;
    iVar7 = *(int *)((int)this + 0x162c) + param_6 +
            (uint)CARRY4(*(uint *)((int)this + 0x1628),param_5);
    if (param_7 != '\0') {
      *(int *)((int)this + 0x1608) = *(int *)((int)this + 0x1608) + 1;
      puVar1 = (uint *)((int)this + 0x1618);
      uVar6 = *puVar1;
      *puVar1 = *puVar1 + (int)param_3;
      *(int *)((int)this + 0x161c) =
           (int)param_4 + (uint)CARRY4(uVar6,(uint)param_3) + *(int *)((int)this + 0x161c);
      puVar1 = (uint *)((int)this + 0x1628);
      uVar6 = *puVar1;
      *puVar1 = *puVar1 + param_5;
      *(int *)((int)this + 0x162c) =
           *(int *)((int)this + 0x162c) + param_6 + (uint)CARRY4(uVar6,param_5);
    }
    if ((*(byte *)((int)this + 0x1731) & 2) != 0) {
      piVar19 = (int *)((int)this + 0x1720);
      piVar18 = (int *)((int)this + 0x1714);
      uVar10 = FUN_676ad42d(iVar7,piVar18,
                            CONCAT26((short)((uint)iVar7 >> 0x10),CONCAT24((short)iVar7,iVar5)),
                            uVar9,uVar8);
      uVar4 = (undefined2)uVar10;
      uVar15 = (undefined2)iVar5;
      uVar16 = (undefined2)((uint)iVar5 >> 0x10);
      iVar5 = uVar8 + *(int *)((int)this + 0x1624) +
              (uint)CARRY4(uVar9,*(uint *)((int)this + 0x1620));
      uVar10 = FUN_676ad38e(iVar5,(int)((ulonglong)uVar10 >> 0x20),
                            CONCAT44(iVar5,uVar9 + *(uint *)((int)this + 0x1620)),
                            *(uint *)((int)this + 0x1610),*(uint *)((int)this + 0x1614));
      uVar14 = (undefined2)uVar10;
      iVar5 = *(int *)((int)this + 0x1624);
      uVar13 = *(undefined4 *)((int)this + 0x1620);
      iVar12 = *(int *)((int)this + 0x1614);
      uVar11 = *(undefined4 *)((int)this + 0x1610);
      uVar6 = FUN_676ad346(*(int *)((int)this + 0x160c) + *(int *)((int)this + 0x1608),
                           *(uint *)((int)this + 0x1604));
      FUN_676a505c((void *)((int)this + -0x38),*(undefined4 *)((int)this + 0x1604),
                   *(int *)((int)this + 0x1608),*(int *)((int)this + 0x160c),(short)uVar6,uVar11,
                   iVar12,uVar9,uVar8,uVar13,iVar5,uVar14,CONCAT22(uVar16,uVar15),iVar7,uVar4,
                   piVar18,piVar19);
    }
                    /* WARNING: Load size is inaccurate */
    (**(code **)(*this + 0x60))(param_1);
  }
  return;
}



// Function: FUN_6769f755 at 6769f755

void __thiscall FUN_6769f755(void *this,undefined4 param_1,void *param_2)

{
  uint *puVar1;
  uint uVar2;
  char cVar3;
  undefined4 *puVar4;
  uint uVar5;
  uint extraout_ECX;
  int iVar6;
  int iVar7;
  int extraout_EDX;
  undefined8 uVar8;
  undefined4 uVar9;
  undefined8 uVar10;
  undefined2 uVar11;
  int iVar12;
  undefined2 uVar13;
  int *piVar14;
  int *piVar15;
  undefined4 local_74 [8];
  undefined4 local_54 [8];
  undefined4 local_34 [8];
  undefined8 local_14;
  undefined8 local_c;
  
  cVar3 = FUN_6767d599(this,param_1);
  if (cVar3 != '\0') {
    iVar12 = *(int *)((int)this + 0x15fc);
    uVar5 = 0;
    iVar7 = 0;
    if (iVar12 == 3) {
      uVar5 = *(uint *)((int)param_2 + 0x28);
      iVar7 = *(int *)((int)param_2 + 0x2c);
    }
    else if (((iVar12 == 4) || (iVar12 == 6)) || (iVar12 == 8)) {
      uVar5 = *(uint *)((int)param_2 + 0x20);
      iVar7 = *(int *)((int)param_2 + 0x24);
    }
    *(int *)((int)this + 0x160c) = *(int *)((int)this + 0x160c) + 1;
    puVar1 = (uint *)((int)this + 0x1620);
    uVar2 = *puVar1;
    *puVar1 = *puVar1 + uVar5;
    *(int *)((int)this + 0x1624) = *(int *)((int)this + 0x1624) + iVar7 + (uint)CARRY4(uVar2,uVar5);
    if ((*(byte *)((int)this + 0x1730) & 0x20) != 0) {
      puVar4 = FUN_67682bbb(param_2,local_34);
      local_c = *(undefined8 *)(puVar4 + 6);
      puVar4 = FUN_67682b88(param_2,local_54);
      local_14 = *(undefined8 *)(puVar4 + 6);
      puVar4 = FUN_6767d0b1(param_2,local_74);
      FUN_676a3ca7((int)this + -0x38,*(LPCWSTR *)((int)param_2 + 0x16c),
                   *(LPCWSTR *)((int)param_2 + 0x178),*(LPCWSTR *)((int)param_2 + 0x170),
                   *(LPCWSTR *)((int)param_2 + 0x28),*(LPCWSTR *)((int)param_2 + 0x2c),
                   *(LPCWSTR *)((int)param_2 + 0x20),*(LPCWSTR *)((int)param_2 + 0x24),
                   *(uint *)((int)param_2 + 0x34) & 0x3fff,*(undefined4 *)((int)param_2 + 0x18),
                   *(undefined8 *)(puVar4 + 6),local_14,local_c,
                   (uint)*(ushort *)((int)param_2 + 0x16),
                   -(ushort)((*(byte *)((int)param_2 + 0x14) & 1) != 0),
                   *(undefined4 *)((int)param_2 + 0x4c),(int *)((int)this + 0x1714),
                   (int *)((int)this + 0x1720));
      uVar5 = extraout_ECX;
      iVar7 = extraout_EDX;
    }
    if ((*(byte *)((int)this + 0x1731) & 2) != 0) {
      piVar15 = (int *)((int)this + 0x1720);
      piVar14 = (int *)((int)this + 0x1714);
      uVar8 = FUN_676ad42d(uVar5,iVar7,*(ulonglong *)((int)this + 0x1628),
                           *(uint *)((int)this + 0x1618),*(uint *)((int)this + 0x161c));
      uVar13 = (undefined2)uVar8;
      iVar12 = *(int *)((int)this + 0x162c);
      iVar7 = *(int *)((int)this + 0x1628);
      iVar6 = *(int *)((int)this + 0x1624) + *(int *)((int)this + 0x161c) +
              (uint)CARRY4(*(uint *)((int)this + 0x1620),*(uint *)((int)this + 0x1618));
      uVar8 = FUN_676ad38e(iVar6,(int)((ulonglong)uVar8 >> 0x20),
                           CONCAT44(iVar6,*(uint *)((int)this + 0x1620) +
                                          *(uint *)((int)this + 0x1618)),
                           *(uint *)((int)this + 0x1610),*(uint *)((int)this + 0x1614));
      uVar11 = (undefined2)uVar8;
      iVar6 = *(int *)((int)this + 0x1624);
      uVar8 = *(undefined8 *)((int)this + 0x161c);
      uVar10 = *(undefined8 *)((int)this + 0x1614);
      uVar9 = *(undefined4 *)((int)this + 0x1610);
      uVar5 = FUN_676ad346(*(int *)((int)this + 0x160c) + *(int *)((int)this + 0x1608),
                           *(uint *)((int)this + 0x1604));
      FUN_676a505c((void *)((int)this + -0x38),*(undefined4 *)((int)this + 0x1604),
                   *(int *)((int)this + 0x1608),*(int *)((int)this + 0x160c),(short)uVar5,uVar9,
                   (int)uVar10,(int)((ulonglong)uVar10 >> 0x20),(int)uVar8,
                   (int)((ulonglong)uVar8 >> 0x20),iVar6,uVar11,iVar7,iVar12,uVar13,piVar14,piVar15)
      ;
    }
                    /* WARNING: Load size is inaccurate */
    (**(code **)(*this + 0x60))(param_1);
  }
  return;
}



// Function: FUN_6769f931 at 6769f931

void __thiscall FUN_6769f931(void *this,undefined4 param_1,LPWSTR param_2,char *param_3)

{
  uint *puVar1;
  uint uVar2;
  uint uVar3;
  LPWSTR this_00;
  char cVar4;
  undefined4 *puVar5;
  int iVar6;
  LPCWSTR pWVar7;
  undefined4 local_58 [8];
  undefined8 local_38;
  undefined8 local_30;
  undefined8 local_28;
  LPWSTR local_20;
  LPCWSTR local_1c;
  int local_18;
  uint local_14;
  int local_10;
  LPCWSTR local_c;
  LPCWSTR local_8;
  
  this_00 = param_2;
  cVar4 = FUN_6767d5a5(this,param_1,param_2,param_3);
  if (cVar4 != '\0') {
    if ((*(byte *)((int)this + 0x1731) & 0x20) != 0) {
      local_8 = (LPCWSTR)Ordinal_2();
      local_c = (LPCWSTR)Ordinal_2();
      local_14 = *(uint *)(this_00 + 0x1a) & 0x3fff;
      puVar5 = FUN_6767d0b1(this_00,local_58);
      local_28 = *(undefined8 *)(puVar5 + 6);
      puVar5 = FUN_67682b88(this_00,local_58);
      local_30 = *(undefined8 *)(puVar5 + 6);
      puVar5 = FUN_67682bbb(this_00,local_58);
      local_38 = *(undefined8 *)(puVar5 + 6);
      local_18 = -(uint)((this_00[10] & L'\x01') != L'\0');
      param_2 = FUN_67684ed6(*(LPCSTR *)(this_00 + 0xbe),-1);
      local_10 = -(uint)(*param_3 != '\0');
      FUN_676a5b1e((void *)((int)this + -0x38),(undefined4 *)(this_00 + 0x28),&local_8,&local_c,
                   &local_14,&local_28,&local_30,&local_38,(short *)&local_18,&param_2,
                   (short *)&local_10,(int *)((int)this + 0x1714),(int *)((int)this + 0x1720));
      pWVar7 = (LPCWSTR)0x0;
      *param_3 = (short)local_10 != 0;
      if ((short)local_10 != 0) {
        local_1c = local_8;
        if (local_8 != (LPCWSTR)0x0) {
          iVar6 = lstrlenW(local_8);
          param_3 = (char *)(iVar6 * 2 + 2);
          FUN_676b06a0();
          local_20 = (LPWSTR)&stack0xffffff94;
          WideCharToMultiByte(0,0,local_1c,-1,&stack0xffffff94,(int)param_3,(LPCSTR)0x0,(LPBOOL)0x0)
          ;
        }
        FUN_67680c87((int)this_00);
        FUN_67684e25(this_00,local_c);
        *(uint *)(this_00 + 0x1a) =
             (*(uint *)(this_00 + 0x1a) ^ local_14) & 0x3fff ^ *(uint *)(this_00 + 0x1a);
        FUN_6768ef7c(&stack0xffffff74,local_28);
        FUN_676815b7(this_00);
        FUN_6768ef7c(&stack0xffffff74,local_30);
        FUN_67681635(this_00);
        FUN_6768ef7c(&stack0xffffff74,local_38);
        FUN_6768166a(this_00);
        FUN_67689c05(this_00,*(int *)((int)this + 0x668),*(int *)((int)this + 0x66c));
        if (((((short)local_18 != 0) && (param_2 != (LPWSTR)0x0)) &&
            (iVar6 = Ordinal_7(), iVar6 != 0)) && (local_20 = param_2, param_2 != (LPWSTR)0x0)) {
          iVar6 = lstrlenW(param_2);
          param_3 = (char *)(iVar6 * 2 + 2);
          FUN_676b06a0();
          local_1c = (LPCWSTR)&stack0xffffff94;
          WideCharToMultiByte(0,0,local_20,-1,&stack0xffffff94,(int)param_3,(LPCSTR)0x0,(LPBOOL)0x0)
          ;
          pWVar7 = local_1c;
        }
        FUN_6767d4d0(this_00,(LPCSTR)pWVar7,'\x01');
        *(int *)((int)this + 0x1604) = *(int *)((int)this + 0x1604) + 1;
        uVar3 = *(uint *)(this_00 + 0x14);
        iVar6 = *(int *)(this_00 + 0x16);
        puVar1 = (uint *)((int)this + 0x1610);
        uVar2 = *puVar1;
        *puVar1 = *puVar1 + uVar3;
        *(int *)((int)this + 0x1614) =
             *(int *)((int)this + 0x1614) + iVar6 + (uint)CARRY4(uVar2,uVar3);
      }
      Ordinal_6();
      Ordinal_6();
      Ordinal_6();
    }
                    /* WARNING: Load size is inaccurate */
    (**(code **)(*this + 0x60))();
  }
  return;
}



// Function: FUN_6769fba7 at 6769fba7

uint __thiscall
FUN_6769fba7(void *this,void *param_1,int param_2,undefined4 *param_3,uint *param_4,
            undefined1 *param_5)

{
  undefined1 *puVar1;
  ushort uVar2;
  uint uVar3;
  void *pvVar4;
  undefined4 *puVar5;
  int iVar6;
  ushort local_1c [4];
  undefined4 *local_14;
  undefined4 *local_c;
  int local_8;
  
  puVar1 = param_5;
  iVar6 = param_2;
  uVar3 = FUN_6767d5b8(this,param_1,param_2,param_3,param_4,param_5);
  if ((char)uVar3 == '\0') goto LAB_6769fd33;
  *puVar1 = 1;
  if ((*(byte *)((int)this + 0x1731) & 0x40) == 0) goto LAB_6769fd9b;
  local_1c[0] = 0;
  param_5 = (undefined1 *)0xffffffff;
  FUN_676a60b1((void *)((int)this + -0x38),*(undefined4 *)(iVar6 + 0x50),*(LPCWSTR *)(iVar6 + 0x16c)
               ,local_1c,(short *)&param_5,(int *)((int)this + 0x1714),(int *)((int)this + 0x1720));
  *puVar1 = (short)param_5 != 0;
  uVar2 = local_1c[0] & 0xbfff;
  if ((local_1c[0] & 0xbfff) == 0) goto LAB_6769fd91;
  if (uVar2 == 8) {
    puVar5 = local_14;
    if ((local_1c[0] & 0x4000) == 0) {
LAB_6769fd57:
      if (puVar5 != (undefined4 *)0x0) {
        uVar3 = Ordinal_149(puVar5);
        pvVar4 = operator_new(uVar3);
        *param_3 = pvVar4;
        if (pvVar4 != (void *)0x0) {
          *param_4 = uVar3;
          FUN_676b06d0((undefined4 *)*param_3,puVar5,uVar3);
          goto LAB_6769fd91;
        }
LAB_6769fd74:
        iVar6 = 0x1ff;
        goto LAB_6769fd21;
      }
    }
    else if (local_14 != (undefined4 *)0x0) {
      puVar5 = (undefined4 *)*local_14;
      goto LAB_6769fd57;
    }
    iVar6 = 0x208;
  }
  else {
    if ((uVar2 < 0x2010) || (0x2011 < uVar2)) {
      iVar6 = 0x20d;
      goto LAB_6769fd21;
    }
    puVar5 = local_14;
    if ((local_1c[0] & 0x4000) == 0) {
LAB_6769fc6b:
      if (puVar5 == (undefined4 *)0x0) goto LAB_6769fc55;
      iVar6 = Ordinal_17(puVar5);
      if (iVar6 != 1) {
        iVar6 = 0x20a;
        goto LAB_6769fd21;
      }
      iVar6 = Ordinal_18(puVar5);
      if (iVar6 != 1) {
        iVar6 = 0x20b;
        goto LAB_6769fd21;
      }
      iVar6 = Ordinal_19(puVar5,1,&param_2);
      if ((iVar6 < 0) || (iVar6 = Ordinal_20(puVar5,1,&local_8), iVar6 < 0)) {
LAB_6769fcc3:
        iVar6 = 0x20c;
        goto LAB_6769fd21;
      }
      uVar3 = (param_2 - local_8) + 1;
      if (uVar3 != 0) {
        iVar6 = Ordinal_23(puVar5,&local_c);
        if (iVar6 < 0) goto LAB_6769fcc3;
        pvVar4 = operator_new(uVar3);
        *param_3 = pvVar4;
        if (pvVar4 != (void *)0x0) {
          *param_4 = uVar3;
          FUN_676b06d0((undefined4 *)*param_3,local_c,uVar3);
          Ordinal_24(puVar5);
          goto LAB_6769fd91;
        }
        goto LAB_6769fd74;
      }
LAB_6769fd91:
      Ordinal_9(local_1c);
LAB_6769fd9b:
                    /* WARNING: Load size is inaccurate */
      uVar3 = (**(code **)(*this + 0x60))(param_1);
      return uVar3;
    }
    if (local_14 != (undefined4 *)0x0) {
      puVar5 = (undefined4 *)*local_14;
      goto LAB_6769fc6b;
    }
LAB_6769fc55:
    iVar6 = 0x209;
  }
LAB_6769fd21:
  FUN_6767ca9c(param_1,iVar6,0x4000000);
  uVar3 = Ordinal_9(local_1c);
LAB_6769fd33:
  return uVar3 & 0xffffff00;
}



// Function: FUN_6769fdac at 6769fdac

uint __thiscall
FUN_6769fdac(void *this,void *param_1,int param_2,undefined4 param_3,undefined4 param_4,int param_5)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  short local_14 [4];
  int local_c;
  
  iVar1 = param_5;
  uVar2 = FUN_6767d5d9(this,param_1);
  if ((char)uVar2 == '\0') {
LAB_6769fe04:
    uVar2 = uVar2 & 0xffffff00;
  }
  else {
    if ((*(byte *)((int)this + 0x1731) & 0x80) != 0) {
      param_5 = 0;
      iVar3 = Ordinal_36(1,&param_5);
      if (iVar3 < 0) {
        uVar2 = FUN_6767ca9c(param_1,0x1ff,0x4000000);
        goto LAB_6769fe04;
      }
      *(undefined2 *)(param_5 + 2) = 0x12;
      *(undefined4 *)(param_5 + 4) = 1;
      *(undefined4 *)(param_5 + 0x10) = param_4;
      *(undefined4 *)(param_5 + 0x14) = 0;
      *(undefined4 *)(param_5 + 0xc) = param_3;
      Ordinal_8(local_14);
      local_c = param_5;
      local_14[0] = 0x2011;
      FUN_676a6346((void *)((int)this + -0x38),*(LPCWSTR *)(param_2 + 0x16c),local_14,
                   -(ushort)((char)iVar1 != '\0'),(int *)((int)this + 0x1714),
                   (int *)((int)this + 0x1720));
      Ordinal_38(param_5);
    }
                    /* WARNING: Load size is inaccurate */
    uVar2 = (**(code **)(*this + 0x60))(param_1);
  }
  return uVar2;
}



// Function: FUN_6769fe89 at 6769fe89

void __thiscall FUN_6769fe89(void *this,int param_1,int param_2)

{
  char cVar1;
  LPCWSTR pWVar2;
  
  cVar1 = FUN_6767d5e5(this,param_1);
  if (cVar1 != '\0') {
    if ((*(byte *)((int)this + 0x1732) & 1) != 0) {
      if (param_2 == 0) {
        pWVar2 = (LPCWSTR)0x0;
      }
      else {
        pWVar2 = *(LPCWSTR *)(param_2 + 0x16c);
      }
      FUN_676a656e((void *)((int)this + -0x38),pWVar2,*(undefined4 *)(param_1 + 4),
                   (int *)((int)this + 0x1714),(int *)((int)this + 0x1720));
    }
                    /* WARNING: Load size is inaccurate */
    (**(code **)(*this + 0x60))(param_1);
  }
  return;
}



// Function: FUN_6769fee0 at 6769fee0

undefined1 __thiscall FUN_6769fee0(void *this,undefined4 param_1,void *param_2,undefined1 *param_3)

{
  char cVar1;
  undefined1 uVar2;
  int iVar3;
  LPCSTR pCVar4;
  short local_10 [2];
  LPCWSTR local_c;
  LPCWSTR local_8;
  
  cVar1 = FUN_6767d5f1(this,param_1,param_2,param_3);
  if (cVar1 == '\0') {
    return 0;
  }
  pCVar4 = (LPCSTR)((int)this + 0x51e);
  if ((*pCVar4 != '\0') &&
     ((*(LPCSTR *)((int)param_2 + 0x17c) == (LPCSTR)0x0 ||
      (iVar3 = lstrcmpA(*(LPCSTR *)((int)param_2 + 0x17c),pCVar4), iVar3 != 0)))) {
    FUN_6767d4d0(param_2,pCVar4,'\0');
    if ((*(LPCSTR *)((int)param_2 + 0x17c) != (LPCSTR)0x0) &&
       (iVar3 = lstrcmpA(*(LPCSTR *)((int)param_2 + 0x17c),pCVar4), iVar3 == 0)) {
      *param_3 = 1;
                    /* WARNING: Load size is inaccurate */
      uVar2 = (**(code **)(*this + 0x60))(param_1);
      return uVar2;
    }
  }
  local_8 = (LPCWSTR)0x0;
  local_10[0] = 0;
  local_10[1] = 0;
  if ((*(byte *)((int)this + 0x1732) & 2) != 0) {
    FUN_676a672d((void *)((int)this + -0x38),*(LPCWSTR *)((int)param_2 + 0x16c),&local_8,local_10,
                 (int *)((int)this + 0x1714),(int *)((int)this + 0x1720));
  }
  *param_3 = local_10[0] != 0;
  if (local_10[0] != 0) {
    local_c = local_8;
    if (local_8 == (LPCWSTR)0x0) {
      pCVar4 = (LPCSTR)0x0;
    }
    else {
      pCVar4 = &stack0xffffffdc;
      iVar3 = lstrlenW(local_8);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,local_c,-1,&stack0xffffffdc,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    }
    FUN_6767d4d0(param_2,pCVar4,'\0');
    local_c = local_8;
    if (local_8 == (LPCWSTR)0x0) {
      pCVar4 = (LPCSTR)0x0;
    }
    else {
      pCVar4 = &stack0xffffffdc;
      iVar3 = lstrlenW(local_8);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,local_c,-1,&stack0xffffffdc,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    }
    lstrcpyA((LPSTR)((int)this + 0x51e),pCVar4);
  }
                    /* WARNING: Load size is inaccurate */
  uVar2 = (**(code **)(*this + 0x60))(param_1);
  Ordinal_6(local_8);
  return uVar2;
}



// Function: FUN_676a0063 at 676a0063

void __thiscall FUN_676a0063(void *this,undefined4 param_1,uint param_2,uint param_3)

{
  char cVar1;
  uint uVar2;
  int *piVar3;
  int *piVar4;
  
  cVar1 = FUN_6767d604(this,param_1);
  if (cVar1 != '\0') {
    if (((*(byte *)((int)this + 0x1732) & 8) != 0) &&
       ((param_3 < 0x33 || ((int)((ulonglong)param_2 % ((ulonglong)param_3 / 0x32)) == 0)))) {
      piVar4 = (int *)((int)this + 0x1720);
      piVar3 = (int *)((int)this + 0x1714);
      uVar2 = FUN_676ad346(param_2,param_3);
      FUN_676a6f8f((void *)((int)this + -0x38),param_3,param_2,(short)uVar2,piVar3,piVar4);
    }
                    /* WARNING: Load size is inaccurate */
    (**(code **)(*this + 0x60))(param_1);
  }
  return;
}



// Function: FUN_676a00d5 at 676a00d5

void __thiscall FUN_676a00d5(void *this,undefined4 param_1,undefined4 *param_2)

{
  char cVar1;
  
  cVar1 = FUN_6767d610(this,param_1);
  if (cVar1 != '\0') {
    if ((*(byte *)((int)this + 0x1731) & 4) != 0) {
      FUN_676a5427((void *)((int)this + -0x38),param_2,(int *)((int)this + 0x1714),
                   (int *)((int)this + 0x1720));
    }
                    /* WARNING: Load size is inaccurate */
    (**(code **)(*this + 0x60))(param_1);
  }
  return;
}



// Function: FUN_676a011b at 676a011b

void __thiscall FUN_676a011b(void *this,undefined4 param_1,void *param_2)

{
  char cVar1;
  undefined4 *puVar2;
  undefined4 local_74 [8];
  undefined4 local_54 [8];
  undefined4 local_34 [8];
  undefined8 local_14;
  undefined8 local_c;
  
  cVar1 = FUN_6767d61c(this,param_1);
  if (cVar1 != '\0') {
    if ((*(byte *)((int)this + 0x1730) & 0x40) != 0) {
      puVar2 = FUN_67682bbb(param_2,local_34);
      local_c = *(undefined8 *)(puVar2 + 6);
      puVar2 = FUN_67682b88(param_2,local_54);
      local_14 = *(undefined8 *)(puVar2 + 6);
      puVar2 = FUN_6767d0b1(param_2,local_74);
      FUN_676a4219((void *)((int)this + -0x38),*(LPCWSTR *)((int)param_2 + 0x16c),
                   *(LPCWSTR *)((int)param_2 + 0x178),*(LPCWSTR *)((int)param_2 + 0x28),
                   *(LPCWSTR *)((int)param_2 + 0x2c),*(LPCWSTR *)((int)param_2 + 0x20),
                   *(LPCWSTR *)((int)param_2 + 0x24),*(uint *)((int)param_2 + 0x34) & 0x3fff,
                   *(undefined4 *)((int)param_2 + 0x18),*(undefined8 *)(puVar2 + 6),local_14,local_c
                   ,(uint)*(ushort *)((int)param_2 + 0x16),
                   -(ushort)((*(byte *)((int)param_2 + 0x14) & 1) != 0),(int *)((int)this + 0x1714),
                   (int *)((int)this + 0x1720));
    }
                    /* WARNING: Load size is inaccurate */
    (**(code **)(*this + 0x60))(param_1);
  }
  return;
}



// Function: FUN_676a01e4 at 676a01e4

void __thiscall FUN_676a01e4(void *this,undefined4 param_1,void *param_2,void *param_3)

{
  LPCWSTR pWVar1;
  char cVar2;
  LPCWSTR pWVar3;
  undefined4 *puVar4;
  undefined4 local_f0 [8];
  undefined4 local_d0 [8];
  undefined4 local_b0 [8];
  undefined4 local_90 [8];
  undefined4 local_70 [8];
  undefined **local_50 [6];
  undefined8 local_38;
  undefined8 local_30;
  undefined8 local_28;
  undefined8 local_20;
  undefined8 local_18;
  undefined8 local_10;
  short local_8 [2];
  
  cVar2 = FUN_6767d628(this,param_1);
  if (cVar2 == '\0') {
    return;
  }
  local_8[0] = -1;
  local_8[1] = -1;
  if ((*(byte *)((int)this + 0x1732) & 4) != 0) {
    if (*(int *)((int)this + 0x15fc) == 3) {
      pWVar1 = *(LPCWSTR *)((int)param_2 + 0x16c);
      pWVar3 = *(LPCWSTR *)((int)param_3 + 0x16c);
    }
    else {
      pWVar1 = *(LPCWSTR *)((int)param_2 + 0x170);
      pWVar3 = *(LPCWSTR *)((int)param_3 + 0x170);
    }
    local_50[0] = &PTR_LAB_676b9950;
    FUN_67683181(local_50,(int)param_3 + 0x1a0);
    local_30 = local_38;
    puVar4 = FUN_67682b88(param_3,local_90);
    local_28 = *(undefined8 *)(puVar4 + 6);
    puVar4 = FUN_6767d0b1(param_3,local_d0);
    local_18 = *(undefined8 *)(puVar4 + 6);
    puVar4 = FUN_67682bbb(param_2,local_70);
    local_20 = *(undefined8 *)(puVar4 + 6);
    puVar4 = FUN_67682b88(param_2,local_b0);
    local_10 = *(undefined8 *)(puVar4 + 6);
    puVar4 = FUN_6767d0b1(param_2,local_f0);
    FUN_676a69bc((int)this + -0x38,pWVar1,*(LPCWSTR *)((int)param_2 + 0x178),
                 *(LPCWSTR *)((int)param_2 + 0x28),*(LPCWSTR *)((int)param_2 + 0x2c),
                 (LPCWSTR)(*(uint *)((int)param_2 + 0x34) & 0x3fff),*(undefined8 *)(puVar4 + 6),
                 local_10,local_20,pWVar3,*(LPCWSTR *)((int)param_3 + 0x28),
                 *(LPCWSTR *)((int)param_3 + 0x2c),*(uint *)((int)param_3 + 0x34) & 0x3fff,local_18,
                 local_28,local_30,local_8,(int *)((int)this + 0x1714),(int *)((int)this + 0x1720));
    if (local_8[0] == 0) {
      *(undefined4 *)((int)param_2 + 0x4c) = 0xe;
      goto LAB_676a034e;
    }
  }
  *(undefined4 *)((int)param_3 + 0x4c) = 0xc;
LAB_676a034e:
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_676a0383 at 676a0383

void __thiscall FUN_676a0383(void *this,undefined4 param_1,void *param_2)

{
  void *this_00;
  char cVar1;
  undefined4 *puVar2;
  undefined4 local_74 [8];
  undefined4 local_54 [8];
  undefined4 local_34 [8];
  undefined8 local_14;
  undefined8 local_c;
  
  this_00 = param_2;
  cVar1 = FUN_6767d6b3(this,param_1);
  if (cVar1 != '\0') {
    if ((*(byte *)((int)this + 0x1732) & 0x10) != 0) {
      param_2 = (void *)0x0;
      puVar2 = FUN_67682bbb(this_00,local_34);
      local_c = *(undefined8 *)(puVar2 + 6);
      puVar2 = FUN_67682b88(this_00,local_54);
      local_14 = *(undefined8 *)(puVar2 + 6);
      puVar2 = FUN_6767d0b1(this_00,local_74);
      FUN_676a710e((void *)((int)this + -0x38),*(LPCWSTR *)((int)this_00 + 0x170),
                   *(LPCWSTR *)((int)this_00 + 0x28),*(LPCWSTR *)((int)this_00 + 0x2c),
                   *(uint *)((int)this_00 + 0x34) & 0x3fff,*(undefined8 *)(puVar2 + 6),local_14,
                   local_c,(short *)&param_2,(int *)((int)this + 0x1714),(int *)((int)this + 0x1720)
                  );
      if ((short)param_2 != 0) {
        *(undefined4 *)((int)this_00 + 0x4c) = 0xc;
      }
    }
                    /* WARNING: Load size is inaccurate */
    (**(code **)(*this + 0x60))(param_1);
  }
  return;
}



// Function: FUN_676a045f at 676a045f

void __thiscall FUN_676a045f(void *this,undefined4 param_1,uint param_2,uint param_3)

{
  short sVar1;
  uint uVar2;
  
  uVar2 = FUN_676ad346(param_2,param_3);
  if ((*(byte *)((int)this + 0x1732) & 0x40) != 0) {
    sVar1 = (short)uVar2;
    if (*(short *)((int)this + 0x1630) != sVar1) {
      *(short *)((int)this + 0x1630) = sVar1;
      FUN_676a7c83((void *)((int)this + -0x38),sVar1,(int *)((int)this + 0x1714),
                   (int *)((int)this + 0x1720));
    }
  }
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_676a04b2 at 676a04b2

void __thiscall FUN_676a04b2(void *this,undefined4 param_1,short param_2)

{
  if ((*(byte *)((int)this + 0x1732) & 0x80) != 0) {
    if (*(short *)((int)this + 0x1630) != param_2) {
      *(short *)((int)this + 0x1630) = param_2;
      FUN_676a7dd8((void *)((int)this + -0x38),param_2,(int *)((int)this + 0x1714),
                   (int *)((int)this + 0x1720));
    }
  }
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x60))(param_1);
  return;
}



// Function: FUN_676a04f6 at 676a04f6

void __thiscall FUN_676a04f6(void *this,undefined4 param_1,LPWSTR param_2)

{
  WCHAR WVar1;
  LPWSTR this_00;
  bool bVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  int iVar5;
  LPCSTR pCVar6;
  int *piVar7;
  int *piVar8;
  undefined4 local_6c [8];
  double local_4c;
  double local_44;
  double local_3c;
  double local_34;
  double local_2c;
  double local_24;
  LPCWSTR local_1c;
  LPCWSTR local_18;
  uint local_14;
  undefined4 local_10;
  undefined4 local_c;
  int local_8;
  
  this_00 = param_2;
  if ((*(byte *)((int)this + 0x1810) & 0x10) != 0) {
    local_c = Ordinal_2();
    param_2 = FUN_67684ed6((LPCSTR)((int)this + 0x4fa),-1);
    local_8 = -(uint)(*(int *)(this_00 + 0x26) != 0);
    local_10 = *(undefined4 *)(this_00 + 0x2c);
    local_14 = *(uint *)(this_00 + 0x1a) & 0x3fff;
    puVar3 = FUN_6767d0b1(this_00,local_6c);
    local_24 = *(double *)(puVar3 + 6);
    puVar3 = FUN_67682b88(this_00,local_6c);
    local_2c = *(double *)(puVar3 + 6);
    puVar3 = FUN_67682bbb(this_00,local_6c);
    local_4c = *(double *)(puVar3 + 6);
    local_18 = *(LPCWSTR *)(this_00 + 0xbc);
    WVar1 = this_00[10];
    local_1c = *(LPCWSTR *)(this_00 + 0xb6);
    local_3c = local_24;
    piVar8 = (int *)((int)this + 0x1800);
    local_44 = local_2c;
    piVar7 = (int *)((int)this + 0x17f4);
    puVar3 = &local_10;
    local_34 = local_4c;
    bVar2 = FUN_6767d0e4((int)this_00);
    FUN_676a3448((void *)((int)this + 0xa8),local_1c,local_18,(LPCWSTR)&local_c,
                 *(LPCWSTR *)(this_00 + 0x14),*(LPCWSTR *)(this_00 + 0x16),
                 *(LPCWSTR *)(this_00 + 0x10),*(LPCWSTR *)(this_00 + 0x12),&local_14,
                 *(undefined4 *)(this_00 + 0xc),&local_24,&local_2c,&local_34,
                 (uint)(ushort)this_00[0xb],-(ushort)((WVar1 & L'\x01') != L'\0'),&param_2,
                 *(int *)(this_00 + 0x1c) + 1,(short *)&local_8,*(undefined4 *)(this_00 + 0x26),
                 -(ushort)bVar2,puVar3,piVar7,piVar8);
    Ordinal_6();
    uVar4 = Ordinal_2();
    *(undefined4 *)(this_00 + 0xb8) = uVar4;
    *(undefined4 *)(this_00 + 0x2c) = local_10;
    *(uint *)(this_00 + 0x1a) =
         (*(uint *)(this_00 + 0x1a) ^ local_14) & 0x3fff ^ *(uint *)(this_00 + 0x1a);
    if (local_24 != local_3c) {
      FUN_6768ef7c(&stack0xffffff5c,local_24);
      FUN_676815b7(this_00);
    }
    if (local_2c != local_44) {
      FUN_6768ef7c(&stack0xffffff5c,local_2c);
      FUN_67681635(this_00);
    }
    if (local_34 != local_4c) {
      FUN_6768ef7c(&stack0xffffff5c,local_34);
      FUN_6768166a(this_00);
    }
    if ((((this_00[10] & L'\x01') == L'\0') || (pCVar6 = (LPCSTR)0x0, param_2 == (LPWSTR)0x0)) ||
       (iVar5 = Ordinal_7(), iVar5 == 0)) {
      pCVar6 = (LPCSTR)0x0;
    }
    else {
      local_18 = param_2;
      if (param_2 != (LPWSTR)0x0) {
        pCVar6 = &stack0xffffff7c;
        iVar5 = lstrlenW(param_2);
        local_1c = (LPCWSTR)(iVar5 * 2 + 2);
        FUN_676b06a0();
        WideCharToMultiByte(0,0,local_18,-1,&stack0xffffff7c,(int)local_1c,(LPCSTR)0x0,(LPBOOL)0x0);
      }
    }
    FUN_6767d4d0(this_00,pCVar6,'\0');
    if (*(int *)(this_00 + 0x26) == 0) {
      if ((short)local_8 != 0) {
        this_00[0x26] = L'\f';
        this_00[0x27] = L'\0';
      }
    }
    else if ((*(int *)(this_00 + 0x26) < 100) && ((short)local_8 == 0)) {
      this_00[0x26] = L'\0';
      this_00[0x27] = L'\0';
    }
    Ordinal_6();
    Ordinal_6();
  }
  (**(code **)(*(int *)((int)this + 0xe0) + 0x60))();
  return;
}



// Function: FUN_676a077a at 676a077a

void __thiscall FUN_676a077a(void *this,undefined4 param_1,LPCWSTR param_2,int *param_3)

{
  LPCWSTR this_00;
  char cVar1;
  int iVar2;
  undefined4 *puVar3;
  LPCSTR pCVar4;
  uint uStack_74;
  LPCSTR pCStack_70;
  undefined4 local_60 [8];
  undefined8 local_40;
  undefined8 local_38;
  undefined8 local_30;
  LPCWSTR local_28;
  LPCSTR local_24;
  LPCWSTR local_20;
  int local_1c;
  uint local_18;
  uint local_14;
  LPCWSTR local_10;
  int local_c;
  LPWSTR local_8;
  
  this_00 = param_2;
  if ((*(byte *)((int)this + 0x1810) & 8) != 0) {
    pCStack_70 = *(LPCSTR *)(param_2 + 0xb6);
    uStack_74 = 0x676a07a7;
    local_24 = pCStack_70;
    param_2 = (LPCWSTR)Ordinal_2();
    uStack_74 = *(uint *)(this_00 + 0xbc);
    local_10 = (LPCWSTR)Ordinal_2();
    local_8 = FUN_67684ed6((LPCSTR)((int)this + 0x4fa),-1);
    local_1c = -(uint)((this_00[10] & L'\x01') != L'\0');
    iVar2 = FUN_67689ce0((void *)((int)this + 0xbc8),(int *)this_00);
    local_c = -(uint)(*(int *)(this_00 + 0x26) != 0);
    local_14 = (uint)(ushort)this_00[0xb];
    local_18 = *(uint *)(this_00 + 0x1a) & 0x3fff;
    puVar3 = FUN_6767d0b1(this_00,local_60);
    local_30 = *(undefined8 *)(puVar3 + 6);
    puVar3 = FUN_67682b88(this_00,local_60);
    local_38 = *(undefined8 *)(puVar3 + 6);
    puVar3 = FUN_67682bbb(this_00,local_60);
    local_40 = *(undefined8 *)(puVar3 + 6);
    local_20 = param_2;
    FUN_676a2c6e((void *)((int)this + 0xa8),(LPCWSTR)&param_2,(LPCWSTR)&local_10,
                 *(LPCWSTR *)(this_00 + 0xb8),*(LPCWSTR *)(this_00 + 0x14),
                 *(LPCWSTR *)(this_00 + 0x16),&local_18,&local_30,&local_38,&local_40,&local_14,
                 (short *)&local_1c,(int *)&local_8,(short *)&local_c,
                 *(undefined4 *)(this_00 + 0x26),(undefined1 *)-(uint)(iVar2 != 0),
                 (int *)((int)this + 0x17f4),(int *)((int)this + 0x1800));
    if (local_20 != param_2) {
      if (param_3 != (int *)0x0) {
        (**(code **)(*param_3 + 0x48))();
      }
      local_20 = param_2;
      if (param_2 != (LPCWSTR)0x0) {
        iVar2 = lstrlenW(param_2);
        local_24 = (LPCSTR)(iVar2 * 2 + 2);
        FUN_676b06a0();
        uStack_74 = uStack_74 & 0xffffff00;
        local_28 = (LPCWSTR)&uStack_74;
        WideCharToMultiByte(0,0,local_20,-1,(LPSTR)&uStack_74,(int)local_24,(LPCSTR)0x0,(LPBOOL)0x0)
        ;
      }
      FUN_67680c87((int)this_00);
      if ((param_3 != (int *)0x0) && (cVar1 = (**(code **)(*param_3 + 0x40))(), cVar1 == '\0')) {
        this_00[0x26] = L'\r';
        this_00[0x27] = L'\0';
      }
    }
    FUN_67684e25(this_00,local_10);
    if ((local_14 == 0) || ((7 < (int)local_14 && (((int)local_14 < 10 || (local_14 == 0x12)))))) {
      FUN_67689c05(this_00,*(int *)((int)this + 0x748),local_14);
    }
    *(uint *)(this_00 + 0x1a) =
         (*(uint *)(this_00 + 0x1a) ^ local_18) & 0x3fff ^ *(uint *)(this_00 + 0x1a);
    FUN_6768ef7c(&stack0xffffff6c,local_30);
    FUN_676815b7(this_00);
    FUN_6768ef7c(&stack0xffffff6c,local_38);
    FUN_67681635(this_00);
    FUN_6768ef7c(&stack0xffffff6c,local_40);
    FUN_6768166a(this_00);
    if ((((short)local_1c == 0) || (local_8 == (LPWSTR)0x0)) || (iVar2 = Ordinal_7(), iVar2 == 0)) {
      pCVar4 = (LPCSTR)0x0;
    }
    else {
      local_28 = local_8;
      if (local_8 == (LPCWSTR)0x0) {
        pCVar4 = (LPCSTR)0x0;
      }
      else {
        iVar2 = lstrlenW(local_8);
        param_3 = (int *)(iVar2 * 2 + 2);
        FUN_676b06a0();
        uStack_74 = uStack_74 & 0xffffff00;
        local_24 = (LPCSTR)&uStack_74;
        WideCharToMultiByte(0,0,local_28,-1,(LPSTR)&uStack_74,(int)param_3,(LPCSTR)0x0,(LPBOOL)0x0);
        pCVar4 = local_24;
      }
    }
    FUN_6767d4d0(this_00,pCVar4,'\x01');
    if (*(int *)(this_00 + 0x26) == 0) {
      if ((short)local_c != 0) {
        this_00[0x26] = L'\f';
        this_00[0x27] = L'\0';
      }
    }
    else if ((*(int *)(this_00 + 0x26) < 100) && ((short)local_c == 0)) {
      this_00[0x26] = L'\0';
      this_00[0x27] = L'\0';
    }
    Ordinal_6();
    Ordinal_6();
    Ordinal_6();
  }
  pCStack_70 = (LPCSTR)param_1;
  uStack_74 = 0x676a0a54;
  (**(code **)(*(int *)((int)this + 0xe0) + 0x60))();
  return;
}



// Function: FUN_676a0a5e at 676a0a5e

void __thiscall FUN_676a0a5e(void *this,undefined4 param_1,void *param_2)

{
  byte bVar1;
  void *this_00;
  bool bVar2;
  undefined4 *puVar3;
  int *piVar4;
  undefined4 uVar5;
  int *piVar6;
  undefined4 local_68 [8];
  double local_48;
  double local_40;
  double local_38;
  double local_30;
  double local_28;
  double local_20;
  uint local_18;
  LPCWSTR local_14;
  void *local_10;
  LPCWSTR local_c;
  undefined *local_8;
  
  this_00 = param_2;
  local_10 = this;
  if ((*(byte *)((int)this + 0x1812) & 0x20) != 0) {
    local_c = (LPCWSTR)Ordinal_2();
    local_8 = (undefined *)Ordinal_2();
    param_2 = (void *)-(uint)(*(int *)((int)this_00 + 0x4c) != 0);
    local_18 = *(uint *)((int)this_00 + 0x34) & 0x3fff;
    puVar3 = FUN_6767d0b1(this_00,local_68);
    local_20 = *(double *)(puVar3 + 6);
    puVar3 = FUN_67682b88(this_00,local_68);
    local_28 = *(double *)(puVar3 + 6);
    puVar3 = FUN_67682bbb(this_00,local_68);
    local_48 = *(double *)(puVar3 + 6);
    local_14 = *(LPCWSTR *)((int)this_00 + 0x16c);
    bVar1 = *(byte *)((int)this_00 + 0x14);
    local_38 = local_20;
    piVar6 = (int *)((int)local_10 + 0x1800);
    piVar4 = (int *)((int)local_10 + 0x17f4);
    local_40 = local_28;
    local_30 = local_48;
    bVar2 = FUN_6767d0e4((int)this_00);
    FUN_676a74c7((void *)((int)local_10 + 0xa8),local_14,&local_c,(LPCWSTR)&local_8,
                 *(undefined4 **)((int)this_00 + 0x28),*(LPCWSTR *)((int)this_00 + 0x2c),
                 *(undefined4 **)((int)this_00 + 0x20),*(undefined4 **)((int)this_00 + 0x24),
                 &local_18,*(undefined4 *)((int)this_00 + 0x18),&local_20,&local_28,&local_30,
                 (uint)*(ushort *)((int)this_00 + 0x16),-(ushort)((bVar1 & 1) != 0),
                 *(int *)((int)this_00 + 0x38) + 1,(short *)&param_2,
                 *(undefined4 *)((int)this_00 + 0x4c),-(ushort)bVar2,piVar4,piVar6);
    FUN_67684e25(this_00,local_c);
    local_14 = (LPCWSTR)local_8;
    if (local_8 == (undefined *)0x0) {
      local_14 = (LPCWSTR)&DAT_676c509c;
    }
    Ordinal_6();
    uVar5 = Ordinal_2();
    *(undefined4 *)((int)this_00 + 0x170) = uVar5;
    *(uint *)((int)this_00 + 0x34) =
         (*(uint *)((int)this_00 + 0x34) ^ local_18) & 0x3fff ^ *(uint *)((int)this_00 + 0x34);
    if (local_20 != local_38) {
      FUN_6768ef7c(&stack0xffffff5c,local_20);
      FUN_676815b7(this_00);
    }
    if (local_28 != local_40) {
      FUN_6768ef7c(&stack0xffffff5c,local_28);
      FUN_67681635(this_00);
    }
    if (local_30 != local_48) {
      FUN_6768ef7c(&stack0xffffff5c,local_30);
      FUN_6768166a(this_00);
    }
    if (*(int *)((int)this_00 + 0x4c) == 0) {
      if ((short)param_2 != 0) {
        *(undefined4 *)((int)this_00 + 0x4c) = 0xc;
      }
    }
    else if ((*(int *)((int)this_00 + 0x4c) < 100) && ((short)param_2 == 0)) {
      *(undefined4 *)((int)this_00 + 0x4c) = 0;
    }
    Ordinal_6();
    Ordinal_6();
  }
  (**(code **)(*(int *)((int)local_10 + 0xe0) + 0x60))();
  return;
}



// Function: FUN_676a0c69 at 676a0c69

undefined4 __thiscall FUN_676a0c69(void *this,char param_1)

{
  undefined2 uVar1;
  undefined8 uVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  int *piVar6;
  int *piVar7;
  int local_10;
  int local_c;
  undefined4 local_8;
  
  FUN_676a0d57((int)this);
  local_10 = 0;
  local_c = 0;
  uVar2 = FUN_6767d8a6((void *)((int)this + 0xe0),param_1 != '\0',&local_10);
  uVar5 = (undefined4)uVar2;
  local_8 = uVar5;
  if ((*(byte *)((int)this + 0x1811) & 8) != 0) {
    piVar7 = (int *)((int)this + 0x1800);
    piVar6 = (int *)((int)this + 0x17f4);
    if (param_1 == '\0') {
      uVar1 = 100;
      iVar4 = *(int *)((int)this + 0x170c);
      iVar3 = *(int *)((int)this + 0x1708);
    }
    else {
      uVar2 = FUN_676ad42d(piVar6,(int)((ulonglong)uVar2 >> 0x20),CONCAT44(local_c,local_10),
                           *(uint *)((int)this + 0x16f0),*(uint *)((int)this + 0x16f4));
      uVar1 = (undefined2)uVar2;
      iVar3 = local_10;
      iVar4 = local_c;
    }
    FUN_676a557f((void *)((int)this + 0xa8),*(int *)((int)this + 0x16e4),
                 *(int *)((int)this + 0x16e8),*(int *)((int)this + 0x16ec),
                 *(int *)((int)this + 0x16f0),*(int *)((int)this + 0x16f4),
                 *(int *)((int)this + 0x16f8),*(int *)((int)this + 0x16fc),
                 *(int *)((int)this + 0x1700),*(int *)((int)this + 0x1704),iVar3,iVar4,uVar1,uVar5,
                 piVar6,piVar7);
  }
  *(undefined1 *)((int)this + 0xe8) = 0;
  EnterCriticalSection((LPCRITICAL_SECTION)((int)this + 0x17d8));
  *(undefined4 *)((int)this + 0x16dc) = 0;
  LeaveCriticalSection((LPCRITICAL_SECTION)((int)this + 0x17d8));
  return local_8;
}



// Function: FUN_676a0d57 at 676a0d57

void __fastcall FUN_676a0d57(int param_1)

{
  *(undefined2 *)(param_1 + 0x1710) = 0xffff;
  *(undefined4 *)(param_1 + 0x16f0) = 0;
  *(undefined4 *)(param_1 + 0x16f8) = 0;
  *(undefined4 *)(param_1 + 0x1700) = 0;
  *(undefined4 *)(param_1 + 0x1708) = 0;
  *(undefined4 *)(param_1 + 0x16e4) = 0;
  *(undefined4 *)(param_1 + 0x16e8) = 0;
  *(undefined4 *)(param_1 + 0x16ec) = 0;
  *(undefined4 *)(param_1 + 0x16f4) = 0;
  *(undefined4 *)(param_1 + 0x16fc) = 0;
  *(undefined4 *)(param_1 + 0x1704) = 0;
  *(undefined4 *)(param_1 + 0x170c) = 0;
  lstrcpyA((LPSTR)(param_1 + 0x5fe),(LPCSTR)(param_1 + 0x4fa));
  return;
}



// Function: FUN_676a0db9 at 676a0db9

undefined4 __fastcall FUN_676a0db9(int param_1)

{
  undefined4 extraout_ECX;
  undefined8 uVar1;
  undefined8 uVar2;
  undefined4 uVar3;
  int *piVar4;
  int *piVar5;
  
  FUN_676a0d57(param_1);
  uVar1 = FUN_6767d9b7((void *)(param_1 + 0xe0),'\x01',(undefined1 *)0x0);
  if ((*(byte *)(param_1 + 0x1811) & 8) != 0) {
    piVar5 = (int *)(param_1 + 0x1800);
    piVar4 = (int *)(param_1 + 0x17f4);
    uVar3 = (int)uVar1;
    uVar2 = FUN_676ad42d(extraout_ECX,(int)((ulonglong)uVar1 >> 0x20),
                         *(ulonglong *)(param_1 + 0x1708),*(uint *)(param_1 + 0x16f8),
                         *(uint *)(param_1 + 0x16fc));
    FUN_676a557f((void *)(param_1 + 0xa8),*(int *)(param_1 + 0x16e4),*(int *)(param_1 + 0x16e8),
                 *(int *)(param_1 + 0x16ec),*(int *)(param_1 + 0x16f0),*(int *)(param_1 + 0x16f4),
                 *(int *)(param_1 + 0x16f8),*(int *)(param_1 + 0x16fc),*(int *)(param_1 + 0x1700),
                 *(int *)(param_1 + 0x1704),*(int *)(param_1 + 0x1708),*(int *)(param_1 + 0x170c),
                 (short)uVar2,uVar3,piVar4,piVar5);
  }
  *(undefined1 *)(param_1 + 0xe8) = 0;
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  *(undefined4 *)(param_1 + 0x16dc) = 0;
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return (int)uVar1;
}



// Function: FUN_676a0e82 at 676a0e82

undefined4 __fastcall FUN_676a0e82(int param_1)

{
  undefined4 extraout_ECX;
  undefined8 uVar1;
  undefined8 uVar2;
  undefined4 uVar3;
  int *piVar4;
  int *piVar5;
  
  FUN_676a0d57(param_1);
  uVar1 = FUN_6767daee((int *)(param_1 + 0xe0));
  if ((*(byte *)(param_1 + 0x1811) & 8) != 0) {
    piVar5 = (int *)(param_1 + 0x1800);
    piVar4 = (int *)(param_1 + 0x17f4);
    uVar3 = (int)uVar1;
    uVar2 = FUN_676ad42d(extraout_ECX,(int)((ulonglong)uVar1 >> 0x20),
                         *(ulonglong *)(param_1 + 0x1708),*(uint *)(param_1 + 0x16f8),
                         *(uint *)(param_1 + 0x16fc));
    FUN_676a557f((void *)(param_1 + 0xa8),*(int *)(param_1 + 0x16e4),*(int *)(param_1 + 0x16e8),
                 *(int *)(param_1 + 0x16ec),*(int *)(param_1 + 0x16f0),*(int *)(param_1 + 0x16f4),
                 *(int *)(param_1 + 0x16f8),*(int *)(param_1 + 0x16fc),*(int *)(param_1 + 0x1700),
                 *(int *)(param_1 + 0x1704),*(int *)(param_1 + 0x1708),*(int *)(param_1 + 0x170c),
                 (short)uVar2,uVar3,piVar4,piVar5);
  }
  *(undefined1 *)(param_1 + 0xe8) = 0;
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  *(undefined4 *)(param_1 + 0x16dc) = 0;
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return (int)uVar1;
}



// Function: FUN_676a0f47 at 676a0f47

undefined4 __fastcall FUN_676a0f47(int param_1)

{
  undefined4 extraout_ECX;
  undefined8 uVar1;
  undefined8 uVar2;
  undefined4 uVar3;
  int *piVar4;
  int *piVar5;
  
  FUN_676a0d57(param_1);
  uVar1 = FUN_6767dea3((int *)(param_1 + 0xe0));
  if ((*(byte *)(param_1 + 0x1811) & 8) != 0) {
    piVar5 = (int *)(param_1 + 0x1800);
    piVar4 = (int *)(param_1 + 0x17f4);
    uVar3 = (int)uVar1;
    uVar2 = FUN_676ad42d(extraout_ECX,(int)((ulonglong)uVar1 >> 0x20),
                         *(ulonglong *)(param_1 + 0x1708),*(uint *)(param_1 + 0x16f8),
                         *(uint *)(param_1 + 0x16fc));
    FUN_676a557f((void *)(param_1 + 0xa8),*(int *)(param_1 + 0x16e4),*(int *)(param_1 + 0x16e8),
                 *(int *)(param_1 + 0x16ec),*(int *)(param_1 + 0x16f0),*(int *)(param_1 + 0x16f4),
                 *(int *)(param_1 + 0x16f8),*(int *)(param_1 + 0x16fc),*(int *)(param_1 + 0x1700),
                 *(int *)(param_1 + 0x1704),*(int *)(param_1 + 0x1708),*(int *)(param_1 + 0x170c),
                 (short)uVar2,uVar3,piVar4,piVar5);
  }
  *(undefined1 *)(param_1 + 0xe8) = 0;
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  *(undefined4 *)(param_1 + 0x16dc) = 0;
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return (int)uVar1;
}



// Function: FUN_676a100c at 676a100c

undefined4 __fastcall FUN_676a100c(int param_1)

{
  undefined4 extraout_ECX;
  undefined8 uVar1;
  undefined8 uVar2;
  undefined4 uVar3;
  int *piVar4;
  int *piVar5;
  
  FUN_676a0d57(param_1);
  uVar1 = FUN_6767dfa0((int *)(param_1 + 0xe0));
  if ((*(byte *)(param_1 + 0x1811) & 8) != 0) {
    piVar5 = (int *)(param_1 + 0x1800);
    piVar4 = (int *)(param_1 + 0x17f4);
    uVar3 = (int)uVar1;
    uVar2 = FUN_676ad42d(extraout_ECX,(int)((ulonglong)uVar1 >> 0x20),
                         *(ulonglong *)(param_1 + 0x1708),*(uint *)(param_1 + 0x16f8),
                         *(uint *)(param_1 + 0x16fc));
    FUN_676a557f((void *)(param_1 + 0xa8),*(int *)(param_1 + 0x16e4),*(int *)(param_1 + 0x16e8),
                 *(int *)(param_1 + 0x16ec),*(int *)(param_1 + 0x16f0),*(int *)(param_1 + 0x16f4),
                 *(int *)(param_1 + 0x16f8),*(int *)(param_1 + 0x16fc),*(int *)(param_1 + 0x1700),
                 *(int *)(param_1 + 0x1704),*(int *)(param_1 + 0x1708),*(int *)(param_1 + 0x170c),
                 (short)uVar2,uVar3,piVar4,piVar5);
  }
  *(undefined1 *)(param_1 + 0xe8) = 0;
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  *(undefined4 *)(param_1 + 0x16dc) = 0;
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x17d8));
  return (int)uVar1;
}



// Function: FUN_676a10d1 at 676a10d1

undefined4 __thiscall FUN_676a10d1(void *this,char param_1)

{
  undefined4 extraout_ECX;
  undefined8 uVar1;
  undefined8 uVar2;
  undefined4 uVar3;
  int *piVar4;
  int *piVar5;
  
  FUN_676a0d57((int)this);
  uVar1 = FUN_6767e148((void *)((int)this + 0xe0),param_1);
  if ((*(byte *)((int)this + 0x1811) & 8) != 0) {
    piVar5 = (int *)((int)this + 0x1800);
    piVar4 = (int *)((int)this + 0x17f4);
    uVar3 = (int)uVar1;
    uVar2 = FUN_676ad42d(extraout_ECX,(int)((ulonglong)uVar1 >> 0x20),
                         *(ulonglong *)((int)this + 0x16f0),*(uint *)((int)this + 0x1708),
                         *(uint *)((int)this + 0x170c));
    FUN_676a557f((void *)((int)this + 0xa8),*(int *)((int)this + 0x16e4),
                 *(int *)((int)this + 0x16e8),*(int *)((int)this + 0x16ec),
                 *(int *)((int)this + 0x16f0),*(int *)((int)this + 0x16f4),
                 *(int *)((int)this + 0x16f8),*(int *)((int)this + 0x16fc),
                 *(int *)((int)this + 0x1700),*(int *)((int)this + 0x1704),
                 *(int *)((int)this + 0x1708),*(int *)((int)this + 0x170c),(short)uVar2,uVar3,piVar4
                 ,piVar5);
  }
  *(undefined1 *)((int)this + 0xe8) = 0;
  EnterCriticalSection((LPCRITICAL_SECTION)((int)this + 0x17d8));
  *(undefined4 *)((int)this + 0x16dc) = 0;
  LeaveCriticalSection((LPCRITICAL_SECTION)((int)this + 0x17d8));
  return (int)uVar1;
}



// Function: FUN_676a119c at 676a119c

undefined4 __thiscall
FUN_676a119c(void *this,undefined4 *param_1,undefined4 *param_2,undefined4 *param_3,
            undefined4 *param_4,undefined4 *param_5,undefined2 *param_6,undefined1 *param_7)

{
  undefined4 uVar1;
  undefined4 extraout_ECX;
  undefined4 uVar2;
  undefined8 uVar3;
  ulonglong uVar4;
  undefined8 uVar5;
  int *piVar6;
  int *piVar7;
  
  FUN_676a0d57((int)this);
  uVar3 = FUN_6767d9b7((void *)((int)this + 0xe0),'\0',param_7);
  uVar2 = (undefined4)((ulonglong)uVar3 >> 0x20);
  *param_1 = *(undefined4 *)((int)this + 0x16e4);
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = *(undefined4 *)((int)this + 0x16f0);
    if (*(int *)((int)this + 0x16f4) != 0) {
      uVar1 = 0xffffffff;
    }
    *param_3 = uVar1;
  }
  else {
    *param_3 = *(undefined4 *)((int)this + 0x16f0);
    uVar4 = __aullshr(0x20,*(uint *)((int)this + 0x16f4));
    uVar2 = (undefined4)(uVar4 >> 0x20);
    *param_2 = (int)uVar4;
  }
  if (param_4 == (undefined4 *)0x0) {
    uVar1 = *(undefined4 *)((int)this + 0x1708);
    if (*(int *)((int)this + 0x170c) != 0) {
      uVar1 = 0xffffffff;
    }
    *param_5 = uVar1;
  }
  else {
    *param_5 = *(undefined4 *)((int)this + 0x1708);
    uVar4 = __aullshr(0x20,*(uint *)((int)this + 0x170c));
    uVar2 = (undefined4)(uVar4 >> 0x20);
    *param_4 = (int)uVar4;
    uVar1 = extraout_ECX;
  }
  uVar5 = FUN_676ad42d(uVar1,uVar2,*(ulonglong *)((int)this + 0x16f0),*(uint *)((int)this + 0x1708),
                       *(uint *)((int)this + 0x170c));
  *param_6 = (short)uVar5;
  if ((*(byte *)((int)this + 0x1811) & 8) != 0) {
    piVar7 = (int *)((int)this + 0x1800);
    piVar6 = (int *)((int)this + 0x17f4);
    uVar2 = (int)uVar3;
    uVar5 = FUN_676ad42d(param_6,(int)((ulonglong)uVar5 >> 0x20),*(ulonglong *)((int)this + 0x16f0),
                         *(uint *)((int)this + 0x1708),*(uint *)((int)this + 0x170c));
    FUN_676a557f((void *)((int)this + 0xa8),*(int *)((int)this + 0x16e4),
                 *(int *)((int)this + 0x16e8),*(int *)((int)this + 0x16ec),
                 *(int *)((int)this + 0x16f0),*(int *)((int)this + 0x16f4),
                 *(int *)((int)this + 0x16f8),*(int *)((int)this + 0x16fc),
                 *(int *)((int)this + 0x1700),*(int *)((int)this + 0x1704),
                 *(int *)((int)this + 0x1708),*(int *)((int)this + 0x170c),(short)uVar5,uVar2,piVar6
                 ,piVar7);
  }
  *(undefined1 *)((int)this + 0xe8) = 0;
  EnterCriticalSection((LPCRITICAL_SECTION)((int)this + 0x17d8));
  *(undefined4 *)((int)this + 0x16dc) = 0;
  LeaveCriticalSection((LPCRITICAL_SECTION)((int)this + 0x17d8));
  return (int)uVar3;
}



// Function: FUN_676a1340 at 676a1340

int __thiscall FUN_676a1340(void *this,LPCWSTR param_1)

{
  int iVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_EDX;
  undefined8 uVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  
  FUN_676a0d57((int)this);
  iVar1 = FUN_6767e253((void *)((int)this + 0xe0),param_1);
  if ((*(byte *)((int)this + 0x1811) & 8) != 0) {
    piVar5 = (int *)((int)this + 0x1800);
    piVar4 = (int *)((int)this + 0x17f4);
    iVar3 = iVar1;
    uVar2 = FUN_676ad42d(extraout_ECX,extraout_EDX,*(ulonglong *)((int)this + 0x1708),
                         *(uint *)((int)this + 0x16f8),*(uint *)((int)this + 0x16fc));
    FUN_676a557f((void *)((int)this + 0xa8),*(int *)((int)this + 0x16e4),
                 *(int *)((int)this + 0x16e8),*(int *)((int)this + 0x16ec),
                 *(int *)((int)this + 0x16f0),*(int *)((int)this + 0x16f4),
                 *(int *)((int)this + 0x16f8),*(int *)((int)this + 0x16fc),
                 *(int *)((int)this + 0x1700),*(int *)((int)this + 0x1704),
                 *(int *)((int)this + 0x1708),*(int *)((int)this + 0x170c),(short)uVar2,iVar3,piVar4
                 ,piVar5);
  }
  *(undefined1 *)((int)this + 0xe8) = 0;
  EnterCriticalSection((LPCRITICAL_SECTION)((int)this + 0x17d8));
  *(undefined4 *)((int)this + 0x16dc) = 0;
  LeaveCriticalSection((LPCRITICAL_SECTION)((int)this + 0x17d8));
  return iVar1;
}



// Function: FUN_676a140b at 676a140b

int __thiscall FUN_676a140b(void *this,undefined4 param_1,int param_2)

{
  int *piVar1;
  int iVar2;
  undefined8 uVar3;
  int *piVar4;
  int *piVar5;
  int local_8;
  
  FUN_676a0d57((int)this);
  piVar1 = (int *)((int)this + 0x17fc);
  iVar2 = FUN_676a82fb(piVar1);
  if (iVar2 < 0) {
    local_8 = 0x1ff;
  }
  else {
    uVar3 = FUN_6767d9b7((void *)((int)this + 0xe0),'\x01',(undefined1 *)0x0);
    local_8 = (int)uVar3;
    if ((*(byte *)((int)this + 0x1811) & 8) != 0) {
      piVar5 = (int *)((int)this + 0x1800);
      piVar4 = (int *)((int)this + 0x17f4);
      iVar2 = local_8;
      uVar3 = FUN_676ad42d(piVar4,(int)((ulonglong)uVar3 >> 0x20),*(ulonglong *)((int)this + 0x1708)
                           ,*(uint *)((int)this + 0x16f8),*(uint *)((int)this + 0x16fc));
      FUN_676a557f((void *)((int)this + 0xa8),*(int *)((int)this + 0x16e4),
                   *(int *)((int)this + 0x16e8),*(int *)((int)this + 0x16ec),
                   *(int *)((int)this + 0x16f0),*(int *)((int)this + 0x16f4),
                   *(int *)((int)this + 0x16f8),*(int *)((int)this + 0x16fc),
                   *(int *)((int)this + 0x1700),*(int *)((int)this + 0x1704),
                   *(int *)((int)this + 0x1708),*(int *)((int)this + 0x170c),(short)uVar3,iVar2,
                   piVar4,piVar5);
    }
    *(undefined1 *)((int)this + 0xe8) = 0;
    if (param_2 == 0) {
      iVar2 = (*(code *)**(undefined4 **)*piVar1)((undefined4 *)*piVar1,&DAT_676c0fd8,param_1);
      if (iVar2 < 0) {
        if (*piVar1 != 0) {
          (*(code *)**(undefined4 **)(*piVar1 + 4))(1);
        }
        if (local_8 == 0) {
          local_8 = 999;
        }
      }
    }
    else {
      if (local_8 == 0) {
        local_8 = 999;
      }
      if (*piVar1 != 0) {
        (*(code *)**(undefined4 **)(*piVar1 + 4))(1);
      }
    }
    *piVar1 = 0;
    EnterCriticalSection((LPCRITICAL_SECTION)((int)this + 0x17d8));
    *(undefined4 *)((int)this + 0x16dc) = 0;
    LeaveCriticalSection((LPCRITICAL_SECTION)((int)this + 0x17d8));
  }
  return local_8;
}



// Function: FUN_676a1548 at 676a1548

undefined4 __thiscall FUN_676a1548(void *this,uint param_1)

{
  DWORD DVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  HANDLE hFile;
  BOOL BVar5;
  int extraout_ECX;
  uint3 uVar6;
  int extraout_ECX_00;
  int extraout_ECX_01;
  int extraout_ECX_02;
  int extraout_ECX_03;
  int extraout_ECX_04;
  int extraout_ECX_05;
  int extraout_ECX_06;
  int extraout_ECX_07;
  int extraout_ECX_08;
  int extraout_ECX_09;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  undefined4 extraout_EDX_05;
  undefined4 extraout_EDX_06;
  undefined4 extraout_EDX_07;
  undefined4 extraout_EDX_08;
  void *pvVar7;
  bool bVar8;
  undefined8 uVar9;
  int iVar10;
  int *piVar11;
  undefined ***pppuVar12;
  int *piVar13;
  undefined **local_c4 [2];
  SYSTEMTIME local_bc;
  undefined8 local_ac;
  undefined **local_a4 [2];
  SYSTEMTIME local_9c;
  undefined8 local_8c;
  undefined **local_84 [2];
  SYSTEMTIME local_7c;
  undefined8 local_6c;
  _FILETIME local_64;
  undefined **local_5c [2];
  undefined4 local_54;
  undefined2 local_50;
  undefined2 local_4e;
  undefined2 local_4c;
  undefined2 local_4a;
  undefined2 local_48;
  undefined2 local_46;
  undefined8 local_44;
  undefined **local_3c [2];
  undefined4 local_34;
  undefined2 local_30;
  undefined2 local_2e;
  undefined2 local_2c;
  undefined2 local_2a;
  undefined2 local_28;
  undefined2 local_26;
  undefined8 local_24;
  _FILETIME local_1c;
  _FILETIME local_14;
  char local_a;
  char local_9;
  int local_8;
  
  FUN_676a0d57((int)this);
  local_8 = 0;
  local_3c[0] = &PTR_LAB_676b9950;
  local_34._0_2_ = 0x76c;
  local_34._2_2_ = 1;
  local_2e = 1;
  local_2c = 0;
  local_2a = 0;
  local_28 = 0;
  local_30 = 0;
  local_26 = 0;
  iVar2 = Ordinal_184(&local_34,&local_24);
  if (iVar2 == 0) {
    local_24 = 0x4000000000000000;
  }
  local_5c[0] = &PTR_LAB_676b9950;
  local_54._0_2_ = 0x270e;
  local_54._2_2_ = 1;
  local_4e = 1;
  local_4c = 0;
  local_4a = 0;
  local_48 = 0;
  local_50 = 0;
  local_46 = 0;
  iVar2 = Ordinal_184(&local_54,&local_44);
  if (iVar2 == 0) {
    local_44 = 0x4000000000000000;
  }
  local_a4[0] = &PTR_LAB_676b9950;
  FUN_6767d089((int)local_a4);
  local_84[0] = &PTR_LAB_676b9950;
  FUN_6767d089((int)local_84);
  local_c4[0] = &PTR_LAB_676b9950;
  FUN_6767d089((int)local_c4);
  local_14.dwHighDateTime = param_1 & 0xf;
  local_1c.dwHighDateTime = param_1 & 0xf0;
  bVar8 = (param_1 & 0x100) != 0x100;
  if (local_1c.dwHighDateTime != 0x40) {
    FUN_676b06d0((undefined4 *)((int)this + 0x1720),&local_54,0x10);
    *(undefined8 *)((int)this + 0x1730) = local_44;
    FUN_676b06d0((undefined4 *)((int)this + 0x1760),&local_54,0x10);
    *(undefined8 *)((int)this + 6000) = local_44;
    FUN_676b06d0((undefined4 *)((int)this + 0x17a0),&local_54,0x10);
    *(undefined8 *)((int)this + 0x17b0) = local_44;
    FUN_676b06d0((undefined4 *)((int)this + 0x1740),&local_34,0x10);
    *(undefined8 *)((int)this + 0x1750) = local_24;
    FUN_676b06d0((undefined4 *)((int)this + 0x1780),&local_34,0x10);
    *(undefined8 *)((int)this + 0x1790) = local_24;
    FUN_676b06d0((undefined4 *)((int)this + 0x17c0),&local_34,0x10);
    *(undefined8 *)((int)this + 0x17d0) = local_24;
    uVar9 = FUN_6767d9b7((void *)((int)this + 0xe0),'\x01',(undefined1 *)0x0);
    local_8 = (int)uVar9;
    iVar2 = extraout_ECX;
    if (local_8 != 0) goto LAB_676a1a2b;
    uVar6 = (uint3)((uint)extraout_ECX >> 8);
    if (((local_1c.dwHighDateTime == 0) && ((local_14.dwHighDateTime & 1) != 0)) ||
       (local_1c.dwHighDateTime == 0x10)) {
      iVar2 = CONCAT31(uVar6,1);
    }
    else {
      iVar2 = (uint)uVar6 << 8;
    }
    if (((local_1c.dwHighDateTime == 0) && ((local_14.dwHighDateTime & 2) != 0)) ||
       (local_1c.dwHighDateTime == 0x20)) {
      local_a = '\x01';
    }
    else {
      local_a = '\0';
    }
    if (((local_1c.dwHighDateTime == 0) && ((local_14.dwHighDateTime & 4) != 0)) ||
       (local_1c.dwHighDateTime == 0x30)) {
      local_9 = '\x01';
    }
    else {
      local_9 = '\0';
    }
    if ((char)iVar2 != '\0') {
      if (bVar8) {
        uVar3 = FUN_6767d035((void *)((int)this + 0x1738),(int)local_3c);
        iVar2 = extraout_ECX_02;
        uVar4 = extraout_EDX_01;
        if ((char)uVar3 != '\0') goto LAB_676a1768;
        FUN_676b06d0((undefined4 *)&local_9c,(undefined4 *)((int)this + 0x1740),0x10);
        uVar9 = CONCAT44(extraout_EDX_02,local_8);
        local_8c = *(undefined8 *)((int)this + 0x1750);
        iVar2 = extraout_ECX_03;
      }
      else {
        uVar3 = FUN_6767d035((void *)((int)this + 0x1718),(int)local_5c);
        iVar2 = extraout_ECX_00;
        uVar4 = extraout_EDX;
        if ((char)uVar3 == '\0') {
          FUN_676b06d0((undefined4 *)&local_9c,(undefined4 *)((int)this + 0x1720),0x10);
          uVar9 = CONCAT44(extraout_EDX_00,local_8);
          local_8c = *(undefined8 *)((int)this + 0x1730);
          iVar2 = extraout_ECX_01;
        }
        else {
LAB_676a1768:
          uVar9 = CONCAT44(uVar4,0x1fd);
        }
      }
    }
    local_8 = (int)uVar9;
    if (local_a != '\0') {
      if (bVar8) {
        pppuVar12 = local_3c;
        pvVar7 = (void *)((int)this + 0x1778);
      }
      else {
        pppuVar12 = local_5c;
        pvVar7 = (void *)((int)this + 0x1758);
      }
      uVar4 = FUN_6767d035(pvVar7,(int)pppuVar12);
      if ((char)uVar4 == '\0') {
        FUN_676b06d0((undefined4 *)&local_7c,(undefined4 *)((int)pvVar7 + 8),0x10);
        uVar9 = CONCAT44(extraout_EDX_04,local_8);
        local_6c = *(undefined8 *)((int)pvVar7 + 0x18);
        iVar2 = extraout_ECX_05;
      }
      else {
        uVar9 = CONCAT44(extraout_EDX_03,0x1fd);
        iVar2 = extraout_ECX_04;
      }
    }
    local_8 = (int)uVar9;
    if (local_9 != '\0') {
      if (bVar8) {
        pppuVar12 = local_3c;
        pvVar7 = (void *)((int)this + 0x17b8);
      }
      else {
        pppuVar12 = local_5c;
        pvVar7 = (void *)((int)this + 0x1798);
      }
      uVar4 = FUN_6767d035(pvVar7,(int)pppuVar12);
      if ((char)uVar4 != '\0') {
        uVar9 = CONCAT44(extraout_EDX_05,0x1fd);
        iVar2 = extraout_ECX_06;
        goto LAB_676a1a2b;
      }
      FUN_676b06d0((undefined4 *)&local_bc,(undefined4 *)((int)pvVar7 + 8),0x10);
      uVar9 = CONCAT44(extraout_EDX_06,local_8);
      local_ac = *(undefined8 *)((int)pvVar7 + 0x18);
      iVar2 = extraout_ECX_07;
    }
    local_8 = (int)uVar9;
    if (local_8 != 0) goto LAB_676a1a2b;
  }
  DVar1 = local_14.dwHighDateTime;
  if ((local_1c.dwHighDateTime == 0x10) || (local_1c.dwHighDateTime == 0x40)) {
    FUN_676b06d0((undefined4 *)&local_7c,(undefined4 *)&local_9c,0x10);
    local_6c = local_8c;
    FUN_676b06d0((undefined4 *)&local_bc,(undefined4 *)&local_9c,0x10);
    local_ac = local_8c;
  }
  else if (local_1c.dwHighDateTime == 0x20) {
    FUN_676b06d0((undefined4 *)&local_9c,(undefined4 *)&local_7c,0x10);
    local_8c = local_6c;
    FUN_676b06d0((undefined4 *)&local_bc,(undefined4 *)&local_7c,0x10);
    local_ac = local_6c;
  }
  else if (local_1c.dwHighDateTime == 0x30) {
    FUN_676b06d0((undefined4 *)&local_9c,(undefined4 *)&local_bc,0x10);
    local_8c = local_ac;
    FUN_676b06d0((undefined4 *)&local_7c,(undefined4 *)&local_bc,0x10);
    local_6c = local_ac;
  }
  hFile = FUN_676aeee9((LPCWSTR)((int)this + 0xea),0x40000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0,
                       (HANDLE)0x0);
  if (hFile == (HANDLE)0xffffffff) {
    uVar9 = CONCAT44(extraout_EDX_07,0x1f7);
    iVar2 = extraout_ECX_08;
  }
  else {
    FUN_676831a8((int)local_a4);
    FUN_676831a8((int)local_84);
    FUN_676831a8((int)local_c4);
    if ((&stack0x00000000 != (undefined1 *)0x1c) &&
       (BVar5 = SystemTimeToFileTime(&local_9c,&local_1c), BVar5 == 0)) {
      local_1c.dwHighDateTime = 0;
      local_1c.dwLowDateTime = 0;
    }
    if ((&stack0x00000000 != (undefined1 *)0x64) &&
       (BVar5 = SystemTimeToFileTime(&local_7c,&local_64), BVar5 == 0)) {
      local_64.dwHighDateTime = 0;
      local_64.dwLowDateTime = 0;
    }
    if ((&stack0x00000000 != (undefined1 *)0x14) &&
       (BVar5 = SystemTimeToFileTime(&local_bc,&local_14), BVar5 == 0)) {
      local_14.dwHighDateTime = 0;
      local_14.dwLowDateTime = 0;
    }
    BVar5 = SetFileTime(hFile,(FILETIME *)(-(uint)((DVar1 & 2) != 0) & (uint)&local_64),
                        (FILETIME *)(-(uint)((DVar1 & 4) != 0) & (uint)&local_14),
                        (FILETIME *)(-(uint)((DVar1 & 1) != 0) & (uint)&local_1c));
    if (BVar5 == 0) {
      local_8 = 0x1fb;
    }
    CloseHandle(hFile);
    uVar9 = CONCAT44(extraout_EDX_08,local_8);
    iVar2 = extraout_ECX_09;
  }
LAB_676a1a2b:
  local_8 = (int)uVar9;
  if ((*(byte *)((int)this + 0x1811) & 8) != 0) {
    piVar13 = (int *)((int)this + 0x1800);
    piVar11 = (int *)((int)this + 0x17f4);
    iVar10 = local_8;
    uVar9 = FUN_676ad42d(iVar2,(int)((ulonglong)uVar9 >> 0x20),*(ulonglong *)((int)this + 0x1708),
                         *(uint *)((int)this + 0x16f8),*(uint *)((int)this + 0x16fc));
    FUN_676a557f((void *)((int)this + 0xa8),*(int *)((int)this + 0x16e4),
                 *(int *)((int)this + 0x16e8),*(int *)((int)this + 0x16ec),
                 *(int *)((int)this + 0x16f0),*(int *)((int)this + 0x16f4),
                 *(int *)((int)this + 0x16f8),*(int *)((int)this + 0x16fc),
                 *(int *)((int)this + 0x1700),*(int *)((int)this + 0x1704),
                 *(int *)((int)this + 0x1708),*(int *)((int)this + 0x170c),(short)uVar9,iVar10,
                 piVar11,piVar13);
  }
  *(undefined1 *)((int)this + 0xe8) = 0;
  EnterCriticalSection((LPCRITICAL_SECTION)((int)this + 0x17d8));
  *(undefined4 *)((int)this + 0x16dc) = 0;
  LeaveCriticalSection((LPCRITICAL_SECTION)((int)this + 0x17d8));
  return local_8;
}



// Function: FUN_676a1adf at 676a1adf

int __thiscall FUN_676a1adf(void *this,byte param_1)

{
  bool bVar1;
  undefined4 *puVar2;
  
  puVar2 = (undefined4 *)operator_new(0x34);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    puVar2[0xc] = 0;
    puVar2[0xb] = 0;
  }
  puVar2[1] = (uint)param_1;
  *puVar2 = this;
  bVar1 = FUN_676a1cab(this,puVar2);
  return (-(uint)bVar1 & 0xfffffc1a) + 999;
}



// Function: FUN_676a1b1d at 676a1b1d

int __fastcall FUN_676a1b1d(void *param_1)

{
  bool bVar1;
  undefined4 *puVar2;
  
  puVar2 = (undefined4 *)operator_new(0x34);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    puVar2[0xc] = 0;
    puVar2[0xb] = 0;
  }
  *puVar2 = param_1;
  bVar1 = FUN_676a1cab(param_1,puVar2);
  return (-(uint)bVar1 & 0xfffffc1a) + 999;
}



// Function: FUN_676a1b51 at 676a1b51

int __fastcall FUN_676a1b51(void *param_1)

{
  bool bVar1;
  undefined4 *puVar2;
  
  puVar2 = (undefined4 *)operator_new(0x34);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    puVar2[0xc] = 0;
    puVar2[0xb] = 0;
  }
  *puVar2 = param_1;
  bVar1 = FUN_676a1cab(param_1,puVar2);
  return (-(uint)bVar1 & 0xfffffc1a) + 999;
}



// Function: FUN_676a1b85 at 676a1b85

int __fastcall FUN_676a1b85(void *param_1)

{
  bool bVar1;
  undefined4 *puVar2;
  
  puVar2 = (undefined4 *)operator_new(0x34);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    puVar2[0xc] = 0;
    puVar2[0xb] = 0;
  }
  *puVar2 = param_1;
  bVar1 = FUN_676a1cab(param_1,puVar2);
  return (-(uint)bVar1 & 0xfffffc1a) + 999;
}



// Function: FUN_676a1bb9 at 676a1bb9

int __fastcall FUN_676a1bb9(void *param_1)

{
  bool bVar1;
  undefined4 *puVar2;
  
  puVar2 = (undefined4 *)operator_new(0x34);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    puVar2[0xc] = 0;
    puVar2[0xb] = 0;
  }
  *puVar2 = param_1;
  bVar1 = FUN_676a1cab(param_1,puVar2);
  return (-(uint)bVar1 & 0xfffffc1a) + 999;
}



// Function: FUN_676a1bed at 676a1bed

int __thiscall FUN_676a1bed(void *this,byte param_1)

{
  bool bVar1;
  undefined4 *puVar2;
  
  puVar2 = (undefined4 *)operator_new(0x34);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    puVar2[0xc] = 0;
    puVar2[0xb] = 0;
  }
  puVar2[1] = (uint)param_1;
  *puVar2 = this;
  bVar1 = FUN_676a1cab(this,puVar2);
  return (-(uint)bVar1 & 0xfffffc1a) + 999;
}



// Function: FUN_676a1c2b at 676a1c2b

int __thiscall FUN_676a1c2b(void *this,undefined4 param_1)

{
  bool bVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  
  puVar2 = (undefined4 *)operator_new(0x34);
  puVar4 = (undefined4 *)0x0;
  if (puVar2 != (undefined4 *)0x0) {
    puVar2[0xc] = 0;
    puVar2[0xb] = 0;
    puVar4 = puVar2;
  }
  uVar3 = Ordinal_2(param_1);
  *puVar4 = this;
  puVar4[1] = uVar3;
  bVar1 = FUN_676a1cab(this,puVar4);
  return (-(uint)bVar1 & 0xfffffc1a) + 999;
}



// Function: FUN_676a1c6e at 676a1c6e

int __thiscall FUN_676a1c6e(void *this,undefined4 param_1)

{
  bool bVar1;
  undefined4 *puVar2;
  
  puVar2 = (undefined4 *)operator_new(0x34);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    puVar2[0xc] = 0;
    puVar2[0xb] = 0;
  }
  puVar2[1] = param_1;
  *puVar2 = this;
  bVar1 = FUN_676a1cab(this,puVar2);
  return (-(uint)bVar1 & 0xfffffc1a) + 999;
}



// Function: FUN_676a1cab at 676a1cab

bool __thiscall FUN_676a1cab(void *this,LPVOID param_1)

{
  int iVar1;
  uint uVar2;
  LPUNKNOWN This;
  HRESULT HVar3;
  HANDLE pvVar4;
  DWORD local_14;
  LPSTREAM local_10;
  void *local_c;
  int local_8;
  
  FUN_676a1d4e((int)this);
  local_8 = 0;
  uVar2 = -(uint)(this != (void *)0x0) & (int)this + 0xa8U;
  iVar1 = *(int *)(uVar2 + 0x28);
  if (0 < iVar1) {
    local_c = (void *)(uVar2 + 4);
    do {
      This = (LPUNKNOWN)FUN_676a7f2d(local_c,local_8);
      if (This != (LPUNKNOWN)0x0) {
        (*This->lpVtbl->AddRef)(This);
      }
      HVar3 = CoMarshalInterThreadInterfaceInStream((IID *)&DAT_676bb4d0,This,&local_10);
      if (-1 < HVar3) {
        FUN_6769189b((void *)((int)param_1 + 0x2c),(int)local_10);
      }
      if (This != (LPUNKNOWN)0x0) {
        (*This->lpVtbl->Release)(This);
      }
      local_8 = local_8 + 1;
    } while (local_8 < iVar1);
  }
  pvVar4 = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,(LPTHREAD_START_ROUTINE)&LAB_676a1dd7,param_1,0
                        ,&local_14);
  *(HANDLE *)((int)this + 0x17f0) = pvVar4;
  return pvVar4 != (HANDLE)0x0;
}



// Function: FUN_676a1d4e at 676a1d4e

void __fastcall FUN_676a1d4e(int param_1)

{
  HANDLE *pHandles;
  DWORD DVar1;
  BOOL BVar2;
  tagMSG local_1c;
  
  pHandles = (HANDLE *)(param_1 + 0x17f0);
  if (*(int *)(param_1 + 0x17f0) != 0) {
    *(undefined1 *)(param_1 + 0xe8) = 1;
    while (DVar1 = MsgWaitForMultipleObjects(1,pHandles,0,0xffffffff,0xff), DVar1 == 1) {
      while (BVar2 = PeekMessageA(&local_1c,(HWND)0x0,0,0,1), BVar2 != 0) {
        TranslateMessage(&local_1c);
        DispatchMessageA(&local_1c);
      }
    }
    CloseHandle(*pHandles);
    *pHandles = (HANDLE)0x0;
    *(undefined1 *)(param_1 + 0xe8) = 0;
  }
  return;
}



// Function: FUN_676a1fb4 at 676a1fb4

int FUN_676a1fb4(int param_1,undefined4 param_2)

{
  int iVar1;
  uint uVar2;
  undefined4 in_stack_00000018;
  undefined4 in_stack_0000001c;
  
  uVar2 = -(uint)(param_1 != 0) & param_1 - 0x74U;
  iVar1 = -0x7fffbfff;
  switch(param_2) {
  case 0:
    iVar1 = FUN_676a80ef((void *)(uVar2 + 0x74),in_stack_0000001c,in_stack_00000018);
    break;
  case 0xfffffff9:
    iVar1 = FUN_6769b312((void *)(uVar2 + 4),in_stack_0000001c,in_stack_00000018);
    break;
  case 0xfffffffb:
    iVar1 = FUN_676a8166(uVar2 + 0x74);
    break;
  case 0xfffffffc:
    iVar1 = FUN_676a8199(uVar2 + 0x74);
    break;
  case 0xfffffffd:
    iVar1 = FUN_676a81c1(uVar2 + 0x74);
    break;
  case 0xffffffff:
    iVar1 = FUN_6769b51b((void *)((-(uint)(uVar2 != 0xffffff8c) & uVar2) + 4),-1);
    if (iVar1 < 0) {
      return iVar1;
    }
  case 0xfffffffa:
  case 0xfffffffe:
    iVar1 = 0;
  }
  return iVar1;
}



// Function: FUN_676a206d at 676a206d

void __thiscall
FUN_676a206d(int param_1,LPCWSTR param_2,LPCWSTR param_3,LPCWSTR param_4,LPCWSTR param_5,
            LPCWSTR param_6,LPCWSTR param_7,undefined2 param_8,undefined4 param_9,
            undefined4 param_10,undefined8 param_11,undefined8 param_12,undefined8 param_13,
            undefined4 param_14,short param_15,undefined4 param_16,short param_17,
            undefined4 param_18,int *param_19,int *param_20)

{
  char cVar1;
  undefined2 *lParam;
  int *piVar2;
  int iVar3;
  undefined2 local_14c [4];
  undefined4 local_144;
  undefined2 local_13c;
  short local_134;
  undefined2 local_12c;
  undefined4 local_124;
  undefined2 local_11c;
  short local_114;
  undefined2 local_10c;
  undefined4 local_104;
  undefined2 local_fc;
  undefined8 local_f4;
  undefined2 local_ec;
  undefined8 local_e4;
  undefined2 local_dc;
  undefined8 local_d4;
  undefined2 local_cc;
  undefined4 local_c4;
  undefined2 local_bc;
  undefined4 local_b4;
  undefined2 local_ac;
  undefined2 local_a4;
  undefined2 local_9c;
  LPCWSTR local_94;
  undefined2 local_8c;
  LPCWSTR local_84;
  undefined2 local_7c;
  LPCWSTR local_74;
  undefined2 local_6c;
  LPCWSTR local_64;
  undefined2 local_5c;
  LPCWSTR local_54;
  undefined2 local_4c;
  LPCWSTR local_44;
  undefined2 *local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 *local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  int local_1c;
  int local_18;
  uint local_14;
  int local_10;
  int *local_c;
  int local_8;
  
  local_1c = param_1;
  if (*param_20 == 0) {
    local_14 = -(uint)(param_1 != 0) & param_1 - 0xa8U;
    local_18 = param_19[1];
    local_10 = local_18;
    if (local_18 == 0) {
      local_10 = *(int *)(param_1 + 0x28);
    }
    local_8 = 0;
    if (0 < local_10) {
      do {
        EnterCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        local_c = (int *)0x0;
        if (local_18 == 0) {
          piVar2 = (int *)FUN_676a7f2d((void *)(local_1c + 4),local_8);
        }
        else if ((local_8 < 0) || (param_19[1] <= local_8)) {
          piVar2 = (int *)0x0;
        }
        else {
          piVar2 = (int *)*param_19;
          if (1 < param_19[1]) {
            piVar2 = (int *)piVar2[local_8];
          }
        }
        FUN_6768fa93((int *)&local_c,piVar2);
        cVar1 = *(char *)(local_14 + 0x1814);
        LeaveCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        if (local_c != (int *)0x0) {
          local_14c[0] = 3;
          if (cVar1 == '\0') {
            local_64 = param_2;
            local_6c = 8;
            local_74 = param_3;
            if (param_5 == (LPCWSTR)0x0) {
              local_84 = param_4;
            }
            else {
              local_84 = (LPCWSTR)0xffffffff;
            }
            if (param_7 == (LPCWSTR)0x0) {
              local_94 = param_6;
            }
            else {
              local_94 = (LPCWSTR)0xffffffff;
            }
            local_3c = local_14c;
            iVar3 = *local_c;
            local_38 = 0;
            local_34 = 0xf;
            local_30 = 0;
          }
          else {
            local_44 = param_2;
            local_54 = param_3;
            local_64 = param_4;
            local_74 = param_5;
            local_84 = param_6;
            local_94 = param_7;
            local_2c = local_14c;
            local_4c = 8;
            local_5c = 8;
            iVar3 = *local_c;
            local_28 = 0;
            local_24 = 0x11;
            local_20 = 0;
            local_6c = local_14c[0];
          }
          local_a4 = param_8;
          local_ac = 2;
          local_b4 = param_9;
          local_c4 = param_10;
          local_d4 = param_11;
          local_dc = 7;
          local_e4 = param_12;
          local_ec = 7;
          local_f4 = param_13;
          local_fc = 7;
          local_104 = param_14;
          local_114 = param_15;
          local_11c = 0xb;
          local_124 = param_16;
          local_134 = param_17;
          local_13c = 0xb;
          local_144 = param_18;
          local_12c = local_14c[0];
          local_10c = local_14c[0];
          local_cc = local_14c[0];
          local_bc = local_14c[0];
          local_9c = local_14c[0];
          local_8c = local_14c[0];
          local_7c = local_6c;
          (**(code **)(iVar3 + 0x18))(local_c);
          if (local_c != (int *)0x0) {
            (**(code **)(*local_c + 8))(local_c);
          }
        }
        local_8 = local_8 + 1;
      } while (local_8 < local_10);
    }
  }
  else if ((param_20[2] != 0) || (param_20[3] != 0)) {
    if (param_20[1] == 0) {
      lParam = (undefined2 *)operator_new(0xa70);
      *lParam = 0xa70;
      *(int *)(lParam + 2) = *param_20;
      *(LPCWSTR *)(lParam + 0x508) = param_4;
      *(LPCWSTR *)(lParam + 0x50a) = param_6;
      lParam[0x50c] = param_8;
      *(undefined4 *)(lParam + 0x50e) = param_9;
      *(undefined4 *)(lParam + 0x510) = param_10;
      *(LPCWSTR *)(lParam + 0x534) = param_5;
      *(LPCWSTR *)(lParam + 0x536) = param_7;
      Ordinal_185(param_11,lParam + 0x512);
      Ordinal_185(param_12,lParam + 0x51a);
      Ordinal_185(param_13,lParam + 0x522);
      *(undefined4 *)(lParam + 0x52a) = param_14;
      *(uint *)(lParam + 0x52c) = (uint)(param_15 != 0);
      *(undefined4 *)(lParam + 0x52e) = param_16;
      *(uint *)(lParam + 0x530) = (uint)(param_17 != 0);
      *(undefined4 *)(lParam + 0x532) = param_18;
      if (param_2 == (LPCWSTR)0x0) {
        lParam[4] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 4,param_2);
      }
      if (param_3 == (LPCWSTR)0x0) {
        lParam[0x108] = 0;
      }
      else {
        FUN_676ae229(lParam + 0x108,param_3,0x400);
        lParam[0x507] = 0;
      }
    }
    else {
      lParam = (undefined2 *)operator_new(0x56c);
      *lParam = 0x56c;
      *(int *)(lParam + 2) = *param_20;
      *(LPCWSTR *)(lParam + 0x286) = param_4;
      *(LPCWSTR *)(lParam + 0x288) = param_6;
      lParam[0x28a] = param_8;
      *(undefined4 *)(lParam + 0x28c) = param_9;
      *(undefined4 *)(lParam + 0x28e) = param_10;
      *(LPCWSTR *)(lParam + 0x2b2) = param_5;
      *(LPCWSTR *)(lParam + 0x2b4) = param_7;
      Ordinal_185(param_11,lParam + 0x290);
      Ordinal_185(param_12,lParam + 0x298);
      Ordinal_185(param_13,lParam + 0x2a0);
      *(undefined4 *)(lParam + 0x2a8) = param_14;
      *(uint *)(lParam + 0x2aa) = (uint)(param_15 != 0);
      *(undefined4 *)(lParam + 0x2ac) = param_16;
      *(uint *)(lParam + 0x2ae) = (uint)(param_17 != 0);
      *(undefined4 *)(lParam + 0x2b0) = param_18;
      FUN_676a2644(param_2,(LPSTR)(lParam + 4),0x104);
      FUN_676a2644(param_3,(LPSTR)(lParam + 0x86),0x400);
    }
    if ((HWND)param_20[2] != (HWND)0x0) {
      SendMessageA((HWND)param_20[2],0xa13,1,(LPARAM)lParam);
    }
    if ((code *)param_20[3] != (code *)0x0) {
      (*(code *)param_20[3])(1,lParam);
    }
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a2644 at 676a2644

void __cdecl FUN_676a2644(LPCWSTR param_1,LPSTR param_2,int param_3)

{
  DWORD DVar1;
  int iVar2;
  int local_8;
  
  iVar2 = 0;
  if (param_1 != (LPCWSTR)0x0) {
    iVar2 = WideCharToMultiByte(0,0,param_1,-1,param_2,param_3,(LPCSTR)0x0,(LPBOOL)0x0);
    if (iVar2 == 0) {
      DVar1 = GetLastError();
      if (DVar1 == 0x7a) {
        local_8 = param_3;
        do {
          iVar2 = WideCharToMultiByte(0,0,param_1,local_8,param_2,param_3,(LPCSTR)0x0,(LPBOOL)0x0);
          local_8 = local_8 + -1;
          if (local_8 == 0) break;
        } while (iVar2 == 0);
      }
    }
  }
  param_2[iVar2] = '\0';
  return;
}



// Function: FUN_676a26aa at 676a26aa

void __thiscall
FUN_676a26aa(int param_1,LPCWSTR param_2,LPCWSTR param_3,LPCWSTR param_4,LPCWSTR param_5,
            undefined4 param_6,undefined8 param_7,undefined8 param_8,undefined8 param_9,
            short param_10,undefined4 param_11,int *param_12,int *param_13)

{
  char cVar1;
  undefined2 *lParam;
  int *piVar2;
  int iVar3;
  undefined2 local_dc [4];
  undefined4 local_d4;
  undefined2 local_cc;
  short local_c4;
  undefined2 local_bc;
  undefined8 local_b4;
  undefined2 local_ac;
  undefined8 local_a4;
  undefined2 local_9c;
  undefined8 local_94;
  undefined2 local_8c;
  undefined4 local_84;
  undefined2 local_7c;
  LPCWSTR local_74;
  undefined2 local_6c;
  LPCWSTR local_64;
  undefined2 local_5c;
  LPCWSTR local_54;
  undefined2 local_4c;
  LPCWSTR local_44;
  undefined2 *local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 *local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  int local_1c;
  int local_18;
  uint local_14;
  int local_10;
  int *local_c;
  int local_8;
  
  local_1c = param_1;
  if (*param_13 == 0) {
    local_14 = -(uint)(param_1 != 0) & param_1 - 0xa8U;
    local_18 = param_12[1];
    local_10 = local_18;
    if (local_18 == 0) {
      local_10 = *(int *)(param_1 + 0x28);
    }
    local_8 = 0;
    if (0 < local_10) {
      do {
        EnterCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        local_c = (int *)0x0;
        if (local_18 == 0) {
          piVar2 = (int *)FUN_676a7f2d((void *)(local_1c + 4),local_8);
        }
        else if ((local_8 < 0) || (param_12[1] <= local_8)) {
          piVar2 = (int *)0x0;
        }
        else {
          piVar2 = (int *)*param_12;
          if (1 < param_12[1]) {
            piVar2 = (int *)piVar2[local_8];
          }
        }
        FUN_6768fa93((int *)&local_c,piVar2);
        cVar1 = *(char *)(local_14 + 0x1814);
        LeaveCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        if (local_c != (int *)0x0) {
          if (cVar1 == '\0') {
            local_54 = param_2;
            local_6c = 8;
            local_64 = param_3;
            if (param_5 == (LPCWSTR)0x0) {
              local_74 = param_4;
            }
            else {
              local_74 = (LPCWSTR)0xffffffff;
            }
            local_3c = local_dc;
            iVar3 = *local_c;
            local_38 = 0;
            local_34 = 9;
            local_30 = 0;
          }
          else {
            local_64 = param_4;
            local_44 = param_2;
            local_74 = param_5;
            local_54 = param_3;
            local_6c = 3;
            local_2c = local_dc;
            local_4c = 8;
            iVar3 = *local_c;
            local_28 = 0;
            local_24 = 10;
            local_20 = 0;
          }
          local_7c = 3;
          local_8c = 3;
          local_dc[0] = 3;
          local_5c = 8;
          local_84 = param_6;
          local_94 = param_7;
          local_9c = 7;
          local_a4 = param_8;
          local_ac = 7;
          local_b4 = param_9;
          local_bc = 7;
          local_c4 = param_10;
          local_cc = 0xb;
          local_d4 = param_11;
          (**(code **)(iVar3 + 0x18))(local_c);
          if (local_c != (int *)0x0) {
            (**(code **)(*local_c + 8))(local_c);
          }
        }
        local_8 = local_8 + 1;
      } while (local_8 < local_10);
    }
  }
  else if ((param_13[2] != 0) || (param_13[3] != 0)) {
    if (param_13[1] == 0) {
      lParam = (undefined2 *)operator_new(0x45c);
      *lParam = 0x45c;
      *(int *)(lParam + 2) = *param_13;
      *(LPCWSTR *)(lParam + 0x20c) = param_4;
      *(undefined4 *)(lParam + 0x20e) = param_6;
      *(LPCWSTR *)(lParam + 0x22c) = param_5;
      Ordinal_185(param_7,lParam + 0x210);
      Ordinal_185(param_8,lParam + 0x218);
      Ordinal_185(param_9,lParam + 0x220);
      *(uint *)(lParam + 0x228) = (uint)(param_10 != 0);
      *(undefined4 *)(lParam + 0x22a) = param_11;
      if (param_2 == (LPCWSTR)0x0) {
        lParam[4] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 4,param_2);
      }
      if (param_3 == (LPCWSTR)0x0) {
        lParam[0x108] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 0x108,param_3);
      }
    }
    else {
      lParam = (undefined2 *)operator_new(0x254);
      *lParam = 0x254;
      *(int *)(lParam + 2) = *param_13;
      *(LPCWSTR *)(lParam + 0x108) = param_4;
      *(undefined4 *)(lParam + 0x10a) = param_6;
      *(LPCWSTR *)(lParam + 0x128) = param_5;
      Ordinal_185(param_7,lParam + 0x10c);
      Ordinal_185(param_8,lParam + 0x114);
      Ordinal_185(param_9,lParam + 0x11c);
      *(uint *)(lParam + 0x124) = (uint)(param_10 != 0);
      *(undefined4 *)(lParam + 0x126) = param_11;
      FUN_676a2644(param_2,(LPSTR)(lParam + 4),0x104);
      FUN_676a2644(param_3,(LPSTR)(lParam + 0x86),0x104);
    }
    if ((HWND)param_13[2] != (HWND)0x0) {
      SendMessageA((HWND)param_13[2],0xa13,2,(LPARAM)lParam);
    }
    if ((code *)param_13[3] != (code *)0x0) {
      (*(code *)param_13[3])(2,lParam);
    }
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a2aed at 676a2aed

void __thiscall FUN_676a2aed(void *this,undefined4 param_1,short *param_2,int *param_3,int *param_4)

{
  int iVar1;
  int *piVar2;
  undefined2 *lParam;
  int *piVar3;
  undefined2 local_44 [4];
  short *local_3c;
  undefined2 local_34;
  undefined4 local_2c;
  undefined2 *local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  void *local_14;
  int local_10;
  LPCRITICAL_SECTION local_c;
  int local_8;
  
  piVar3 = param_4;
  piVar2 = param_3;
  local_14 = this;
  if (*param_4 == 0) {
    local_10 = param_3[1];
    local_8 = local_10;
    if (local_10 == 0) {
      local_8 = *(int *)((int)this + 0x28);
    }
    param_4 = (int *)0x0;
    if (0 < local_8) {
      local_c = (LPCRITICAL_SECTION)((-(uint)(this != (void *)0x0) & (int)this - 0xa8U) + 0x16c4);
      do {
        EnterCriticalSection(local_c);
        param_3 = (int *)0x0;
        if (local_10 == 0) {
          piVar3 = (int *)FUN_676a7f2d((void *)((int)local_14 + 4),(int)param_4);
        }
        else if (((int)param_4 < 0) || (iVar1 = piVar2[1], iVar1 <= (int)param_4)) {
          piVar3 = (int *)0x0;
        }
        else {
          piVar3 = (int *)*piVar2;
          if (1 < iVar1) {
            piVar3 = (int *)piVar3[(int)param_4];
          }
        }
        FUN_6768fa93((int *)&param_3,piVar3);
        LeaveCriticalSection(local_c);
        if (param_3 != (int *)0x0) {
          local_2c = param_1;
          local_3c = param_2;
          local_24 = local_44;
          local_34 = 3;
          local_44[0] = 0x400b;
          local_20 = 0;
          local_1c = 2;
          local_18 = 0;
          (**(code **)(*param_3 + 0x18))(param_3,0x1838,&DAT_676bb4f0,0x400,1,&local_24,0,0,0);
          if (param_3 != (int *)0x0) {
            (**(code **)(*param_3 + 8))(param_3);
          }
        }
        param_4 = (int *)((int)param_4 + 1);
      } while ((int)param_4 < local_8);
    }
  }
  else if ((param_4[2] != 0) || (param_4[3] != 0)) {
    lParam = (undefined2 *)operator_new(0x10);
    *lParam = 0x10;
    *(int *)(lParam + 2) = *piVar3;
    *(undefined4 *)(lParam + 4) = param_1;
    *(uint *)(lParam + 6) = (uint)(*param_2 != 0);
    if ((HWND)piVar3[2] != (HWND)0x0) {
      SendMessageA((HWND)piVar3[2],0xa13,3,(LPARAM)lParam);
    }
    if ((code *)piVar3[3] != (code *)0x0) {
      (*(code *)piVar3[3])(3,lParam);
    }
    *param_2 = -(ushort)(*(int *)(lParam + 6) != 0);
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a2c6e at 676a2c6e

void __thiscall
FUN_676a2c6e(void *this,LPCWSTR param_1,LPCWSTR param_2,LPCWSTR param_3,LPCWSTR param_4,
            LPCWSTR param_5,undefined4 *param_6,undefined4 param_7,undefined4 param_8,
            undefined4 param_9,undefined4 *param_10,short *param_11,int *param_12,short *param_13,
            undefined4 param_14,undefined1 *param_15,int *param_16,int *param_17)

{
  short *psVar1;
  undefined2 *lParam;
  undefined4 uVar2;
  int iVar3;
  int *piVar4;
  undefined1 *puVar5;
  int *piVar6;
  undefined2 local_124 [4];
  undefined2 local_11c;
  undefined2 local_114;
  undefined4 local_10c;
  undefined2 local_104;
  short *local_fc;
  undefined2 local_f4;
  int *local_ec;
  undefined2 local_e4;
  short *local_dc;
  undefined2 local_d4;
  undefined4 *local_cc;
  undefined2 local_c4;
  undefined4 local_bc;
  undefined2 local_b4;
  undefined4 local_ac;
  undefined2 local_a4;
  undefined4 local_9c;
  undefined2 local_94;
  undefined4 *local_8c;
  undefined2 local_84;
  LPCWSTR local_7c;
  undefined2 local_74;
  LPCWSTR local_6c;
  undefined2 local_64;
  LPCWSTR local_5c;
  undefined2 local_54;
  LPCWSTR local_4c;
  undefined2 local_44;
  LPCWSTR local_3c;
  undefined2 *local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined2 *local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  int local_14;
  void *local_10;
  uint local_c;
  int local_8;
  
  piVar4 = param_17;
  psVar1 = param_13;
  piVar6 = param_12;
  local_10 = this;
  if (*param_17 == 0) {
    local_c = -(uint)(this != (void *)0x0) & (int)this - 0xa8U;
    local_14 = param_16[1];
    local_8 = local_14;
    if (local_14 == 0) {
      local_8 = *(int *)((int)this + 0x28);
    }
    param_17 = (int *)0x0;
    if (0 < local_8) {
      do {
        EnterCriticalSection((LPCRITICAL_SECTION)(local_c + 0x16c4));
        param_12 = (int *)0x0;
        if (local_14 == 0) {
          piVar4 = (int *)FUN_676a7f2d((void *)((int)local_10 + 4),(int)param_17);
        }
        else if (((int)param_17 < 0) || (param_16[1] <= (int)param_17)) {
          piVar4 = (int *)0x0;
        }
        else {
          piVar4 = (int *)*param_16;
          if (1 < param_16[1]) {
            piVar4 = (int *)piVar4[(int)param_17];
          }
        }
        FUN_6768fa93((int *)&param_12,piVar4);
        param_13 = (short *)CONCAT13(*(undefined1 *)(local_c + 0x1814),param_13._0_3_);
        LeaveCriticalSection((LPCRITICAL_SECTION)(local_c + 0x16c4));
        if (param_12 != (int *)0x0) {
          if (param_13._3_1_ == '\0') {
            local_4c = param_1;
            local_5c = param_2;
            local_64 = 0x4008;
            local_74 = 8;
            local_6c = param_3;
            if (param_5 == (LPCWSTR)0x0) {
              local_7c = param_4;
            }
            else {
              local_7c = (LPCWSTR)0xffffffff;
            }
            local_34 = local_124;
            iVar3 = *param_12;
            local_30 = 0;
            local_2c = 0xe;
            local_28 = 0;
          }
          else {
            local_3c = param_1;
            local_4c = param_2;
            local_5c = param_3;
            local_6c = param_4;
            local_7c = param_5;
            local_24 = local_124;
            local_44 = 0x4008;
            local_64 = 8;
            local_74 = 3;
            iVar3 = *param_12;
            local_20 = 0;
            local_1c = 0xf;
            local_18 = 0;
          }
          local_54 = 0x4008;
          local_84 = 3;
          local_8c = param_6;
          local_94 = 0x4003;
          local_9c = param_7;
          local_a4 = 0x4007;
          local_ac = param_8;
          local_b4 = 0x4007;
          local_bc = param_9;
          local_c4 = 0x4007;
          local_cc = param_10;
          local_d4 = 0x4003;
          local_dc = param_11;
          local_e4 = 0x400b;
          local_ec = piVar6;
          local_f4 = 0x4008;
          local_fc = psVar1;
          local_104 = 0x400b;
          local_10c = param_14;
          local_114 = 3;
          local_11c = (short)param_15;
          local_124[0] = 0xb;
          (**(code **)(iVar3 + 0x18))();
          if (param_12 != (int *)0x0) {
            (**(code **)(*param_12 + 8))();
          }
        }
        param_17 = (int *)((int)param_17 + 1);
      } while ((int)param_17 < local_8);
    }
  }
  else if ((param_17[2] != 0) || (param_17[3] != 0)) {
    if (param_17[1] == 0) {
      lParam = (undefined2 *)operator_new(0xe70);
      *lParam = 0xe70;
      *(int *)(lParam + 2) = *piVar4;
      *(LPCWSTR *)(lParam + 0x60c) = param_4;
      *(undefined4 *)(lParam + 0x60e) = *param_6;
      *(LPCWSTR *)(lParam + 0x736) = param_5;
      Ordinal_185();
      Ordinal_185();
      Ordinal_185();
      *(undefined4 *)(lParam + 0x628) = *param_10;
      *(uint *)(lParam + 0x62a) = (uint)(*param_11 != 0);
      *(uint *)(lParam + 0x730) = (uint)(*param_13 != 0);
      *(undefined4 *)(lParam + 0x732) = param_14;
      *(uint *)(lParam + 0x734) = (uint)((short)param_15 != 0);
      if (*(short **)param_1 == (short *)0x0) {
        lParam[4] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 4,*(short **)param_1);
      }
      if (*(short **)param_2 == (short *)0x0) {
        lParam[0x108] = 0;
      }
      else {
        FUN_676ae229(lParam + 0x108,*(short **)param_2,0x400);
        lParam[0x507] = 0;
      }
      if (param_3 == (LPCWSTR)0x0) {
        lParam[0x508] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 0x508,param_3);
      }
      if ((short *)*param_12 == (short *)0x0) {
        lParam[0x62c] = 0;
        piVar6 = param_12;
      }
      else {
        FUN_676ae1fc(lParam + 0x62c,(short *)*param_12);
        piVar6 = param_12;
      }
    }
    else {
      lParam = (undefined2 *)operator_new(0x764);
      *lParam = 0x764;
      *(int *)(lParam + 2) = *piVar4;
      *(LPCWSTR *)(lParam + 0x308) = param_4;
      *(undefined4 *)(lParam + 0x30a) = *param_6;
      *(LPCWSTR *)(lParam + 0x3b0) = param_5;
      Ordinal_185();
      Ordinal_185();
      Ordinal_185();
      *(undefined4 *)(lParam + 0x324) = *param_10;
      *(uint *)(lParam + 0x326) = (uint)(*param_11 != 0);
      *(uint *)(lParam + 0x3aa) = (uint)(*param_13 != 0);
      *(undefined4 *)(lParam + 0x3ac) = param_14;
      *(uint *)(lParam + 0x3ae) = (uint)((short)param_15 != 0);
      FUN_676a2644(*(LPCWSTR *)param_1,(LPSTR)(lParam + 4),0x104);
      FUN_676a2644(*(LPCWSTR *)param_2,(LPSTR)(lParam + 0x86),0x400);
      FUN_676a2644(param_3,(LPSTR)(lParam + 0x286),0x104);
      piVar6 = param_12;
      FUN_676a2644((LPCWSTR)*param_12,(LPSTR)(lParam + 0x328),0x104);
    }
    if ((HWND)param_17[2] != (HWND)0x0) {
      SendMessageA((HWND)param_17[2],0xa13,4,(LPARAM)lParam);
    }
    if ((code *)param_17[3] != (code *)0x0) {
      (*(code *)param_17[3])();
    }
    Ordinal_6();
    Ordinal_6();
    Ordinal_6();
    if (param_17[1] == 0) {
      *param_6 = *(undefined4 *)(lParam + 0x60e);
      Ordinal_184();
      Ordinal_184();
      Ordinal_184();
      *param_10 = *(undefined4 *)(lParam + 0x628);
      *param_11 = -(ushort)(*(int *)(lParam + 0x62a) != 0);
      *param_13 = -(ushort)(*(int *)(lParam + 0x730) != 0);
      uVar2 = Ordinal_2();
      *(undefined4 *)param_1 = uVar2;
      uVar2 = Ordinal_2();
      *(undefined4 *)param_2 = uVar2;
      iVar3 = Ordinal_2(lParam + 0x62c);
      *piVar6 = iVar3;
    }
    else {
      *param_6 = *(undefined4 *)(lParam + 0x30a);
      Ordinal_184();
      Ordinal_184();
      Ordinal_184();
      *param_10 = *(undefined4 *)(lParam + 0x324);
      *param_11 = -(ushort)(*(int *)(lParam + 0x326) != 0);
      *param_13 = -(ushort)(*(int *)(lParam + 0x3aa) != 0);
      if ((LPCSTR)(lParam + 4) != (LPCSTR)0x0) {
        iVar3 = lstrlenA((LPCSTR)(lParam + 4));
        FUN_676b06a0();
        param_15 = &stack0xfffffe88;
        MultiByteToWideChar(0,0,(LPCSTR)(lParam + 4),-1,(LPWSTR)&stack0xfffffe88,iVar3 + 1);
      }
      uVar2 = Ordinal_2();
      *(undefined4 *)param_1 = uVar2;
      if ((LPCSTR)(lParam + 0x86) != (LPCSTR)0x0) {
        iVar3 = lstrlenA((LPCSTR)(lParam + 0x86));
        FUN_676b06a0();
        param_15 = &stack0xfffffe84;
        MultiByteToWideChar(0,0,(LPCSTR)(lParam + 0x86),-1,(LPWSTR)&stack0xfffffe84,iVar3 + 1);
      }
      uVar2 = Ordinal_2();
      *(undefined4 *)param_2 = uVar2;
      puVar5 = (undefined1 *)0x0;
      if ((LPCSTR)(lParam + 0x328) != (LPCSTR)0x0) {
        iVar3 = lstrlenA((LPCSTR)(lParam + 0x328));
        FUN_676b06a0();
        param_15 = &stack0xfffffe80;
        MultiByteToWideChar(0,0,(LPCSTR)(lParam + 0x328),-1,(LPWSTR)&stack0xfffffe80,iVar3 + 1);
        puVar5 = param_15;
      }
      iVar3 = Ordinal_2(puVar5);
      *param_12 = iVar3;
    }
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a3448 at 676a3448

void __thiscall
FUN_676a3448(void *this,LPCWSTR param_1,LPCWSTR param_2,LPCWSTR param_3,LPCWSTR param_4,
            LPCWSTR param_5,LPCWSTR param_6,LPCWSTR param_7,undefined4 *param_8,undefined4 param_9,
            undefined4 param_10,undefined4 param_11,undefined4 param_12,undefined4 param_13,
            short param_14,undefined4 *param_15,undefined4 param_16,short *param_17,
            undefined4 param_18,short param_19,undefined4 *param_20,int *param_21,int *param_22)

{
  char cVar1;
  undefined2 *lParam;
  undefined4 uVar2;
  int iVar3;
  int *piVar4;
  undefined1 *puVar5;
  undefined2 local_17c [4];
  undefined4 *local_174;
  undefined2 local_16c;
  short local_164;
  undefined2 local_15c;
  undefined4 local_154;
  undefined2 local_14c;
  short *local_144;
  undefined2 local_13c;
  undefined4 local_134;
  undefined2 local_12c;
  undefined4 *local_124;
  undefined2 local_11c;
  short local_114;
  undefined2 local_10c;
  undefined4 local_104;
  undefined2 local_fc;
  undefined4 local_f4;
  undefined2 local_ec;
  undefined4 local_e4;
  undefined2 local_dc;
  undefined4 local_d4;
  undefined2 local_cc;
  undefined4 local_c4;
  undefined2 local_bc;
  undefined4 *local_b4;
  undefined2 local_ac;
  LPCWSTR local_a4;
  undefined2 local_9c;
  LPCWSTR local_94;
  undefined2 local_8c;
  LPCWSTR local_84;
  undefined2 local_7c;
  LPCWSTR local_74;
  undefined2 local_6c;
  LPCWSTR local_64;
  undefined2 local_5c;
  LPCWSTR local_54;
  undefined2 local_4c;
  LPCWSTR local_44;
  undefined2 *local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 *local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  void *local_1c;
  int local_18;
  uint local_14;
  int local_10;
  int *local_c;
  int local_8;
  
  local_1c = this;
  if (*param_22 == 0) {
    local_14 = -(uint)(this != (void *)0x0) & (int)this - 0xa8U;
    local_18 = param_21[1];
    local_10 = local_18;
    if (local_18 == 0) {
      local_10 = *(int *)((int)this + 0x28);
    }
    local_8 = 0;
    if (0 < local_10) {
      do {
        EnterCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        local_c = (int *)0x0;
        if (local_18 == 0) {
          piVar4 = (int *)FUN_676a7f2d((void *)((int)local_1c + 4),local_8);
        }
        else if ((local_8 < 0) || (param_21[1] <= local_8)) {
          piVar4 = (int *)0x0;
        }
        else {
          piVar4 = (int *)*param_21;
          if (1 < param_21[1]) {
            piVar4 = (int *)piVar4[local_8];
          }
        }
        FUN_6768fa93((int *)&local_c,piVar4);
        cVar1 = *(char *)(local_14 + 0x1814);
        LeaveCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        if (local_c != (int *)0x0) {
          local_15c = 3;
          if (cVar1 == '\0') {
            local_84 = param_3;
            local_64 = param_1;
            local_8c = 0x4008;
            local_6c = 8;
            local_7c = 8;
            local_74 = param_2;
            if (param_5 == (LPCWSTR)0x0) {
              local_94 = param_4;
            }
            else {
              local_94 = (LPCWSTR)0xffffffff;
            }
            if (param_7 == (LPCWSTR)0x0) {
              local_a4 = param_6;
            }
            else {
              local_a4 = (LPCWSTR)0xffffffff;
            }
            local_3c = local_17c;
            iVar3 = *local_c;
            local_38 = 0;
            local_34 = 0x12;
            local_30 = 0;
          }
          else {
            local_64 = param_3;
            local_44 = param_1;
            local_54 = param_2;
            local_74 = param_4;
            local_84 = param_5;
            local_94 = param_6;
            local_a4 = param_7;
            local_2c = local_17c;
            local_6c = 0x4008;
            local_4c = 8;
            local_5c = 8;
            iVar3 = *local_c;
            local_28 = 0;
            local_24 = 0x14;
            local_20 = 0;
            local_8c = local_15c;
            local_7c = local_15c;
          }
          local_b4 = param_8;
          local_bc = 0x4003;
          local_c4 = param_9;
          local_d4 = param_10;
          local_dc = 0x4007;
          local_e4 = param_11;
          local_ec = 0x4007;
          local_f4 = param_12;
          local_fc = 0x4007;
          local_104 = param_13;
          local_114 = param_14;
          local_11c = 0xb;
          local_124 = param_15;
          local_12c = 0x4008;
          local_134 = param_16;
          local_144 = param_17;
          local_14c = 0x400b;
          local_154 = param_18;
          local_164 = param_19;
          local_16c = 0xb;
          local_174 = param_20;
          local_17c[0] = 0x4003;
          local_13c = local_15c;
          local_10c = local_15c;
          local_cc = local_15c;
          local_ac = local_15c;
          local_9c = local_15c;
          (**(code **)(iVar3 + 0x18))();
          if (local_c != (int *)0x0) {
            (**(code **)(*local_c + 8))();
          }
        }
        local_8 = local_8 + 1;
      } while (local_8 < local_10);
    }
  }
  else if ((param_22[2] != 0) || (param_22[3] != 0)) {
    if (param_22[1] == 0) {
      lParam = (undefined2 *)operator_new(0xe84);
      *lParam = 0xe84;
      *(int *)(lParam + 2) = *param_22;
      *(LPCWSTR *)(lParam + 0x60c) = param_4;
      *(LPCWSTR *)(lParam + 0x60e) = param_6;
      *(undefined4 *)(lParam + 0x610) = *param_8;
      *(undefined4 *)(lParam + 0x612) = param_9;
      *(LPCWSTR *)(lParam + 0x73e) = param_5;
      *(LPCWSTR *)(lParam + 0x740) = param_7;
      Ordinal_185();
      Ordinal_185();
      Ordinal_185();
      *(undefined4 *)(lParam + 0x62c) = param_13;
      *(uint *)(lParam + 0x62e) = (uint)(param_14 != 0);
      *(undefined4 *)(lParam + 0x734) = param_16;
      *(uint *)(lParam + 0x736) = (uint)(*param_17 != 0);
      *(undefined4 *)(lParam + 0x738) = param_18;
      *(uint *)(lParam + 0x73a) = (uint)(param_19 != 0);
      *(undefined4 *)(lParam + 0x73c) = *param_20;
      if (param_1 == (LPCWSTR)0x0) {
        lParam[4] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 4,param_1);
      }
      if (param_2 == (LPCWSTR)0x0) {
        lParam[0x108] = 0;
      }
      else {
        FUN_676ae229(lParam + 0x108,param_2,0x400);
        lParam[0x507] = 0;
      }
      if (*(short **)param_3 == (short *)0x0) {
        lParam[0x508] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 0x508,*(short **)param_3);
      }
      if ((short *)*param_15 == (short *)0x0) {
        lParam[0x630] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 0x630,(short *)*param_15);
      }
    }
    else {
      lParam = (undefined2 *)operator_new(0x778);
      *lParam = 0x778;
      *(int *)(lParam + 2) = *param_22;
      *(LPCWSTR *)(lParam + 0x308) = param_4;
      *(LPCWSTR *)(lParam + 0x30a) = param_6;
      *(undefined4 *)(lParam + 0x30c) = *param_8;
      *(undefined4 *)(lParam + 0x30e) = param_9;
      *(LPCWSTR *)(lParam + 0x3b8) = param_5;
      *(LPCWSTR *)(lParam + 0x3ba) = param_7;
      Ordinal_185();
      Ordinal_185();
      Ordinal_185();
      *(undefined4 *)(lParam + 0x328) = param_13;
      *(uint *)(lParam + 0x32a) = (uint)(param_14 != 0);
      *(undefined4 *)(lParam + 0x3ae) = param_16;
      *(uint *)(lParam + 0x3b0) = (uint)(*param_17 != 0);
      *(undefined4 *)(lParam + 0x3b2) = param_18;
      *(uint *)(lParam + 0x3b4) = (uint)(param_19 != 0);
      *(undefined4 *)(lParam + 0x3b6) = *param_20;
      FUN_676a2644(param_1,(LPSTR)(lParam + 4),0x104);
      FUN_676a2644(param_2,(LPSTR)(lParam + 0x86),0x400);
      FUN_676a2644(*(LPCWSTR *)param_3,(LPSTR)(lParam + 0x286),0x104);
      FUN_676a2644((LPCWSTR)*param_15,(LPSTR)(lParam + 0x32c),0x104);
    }
    if ((HWND)param_22[2] != (HWND)0x0) {
      SendMessageA((HWND)param_22[2],0xa13,5,(LPARAM)lParam);
    }
    if ((code *)param_22[3] != (code *)0x0) {
      (*(code *)param_22[3])();
    }
    Ordinal_6();
    Ordinal_6();
    if (param_22[1] == 0) {
      *param_8 = *(undefined4 *)(lParam + 0x610);
      Ordinal_184();
      Ordinal_184();
      Ordinal_184();
      *param_17 = -(ushort)(*(int *)(lParam + 0x736) != 0);
      *param_20 = *(undefined4 *)(lParam + 0x73c);
      uVar2 = Ordinal_2();
      *(undefined4 *)param_3 = uVar2;
      uVar2 = Ordinal_2(lParam + 0x630);
      *param_15 = uVar2;
    }
    else {
      *param_8 = *(undefined4 *)(lParam + 0x30c);
      Ordinal_184();
      Ordinal_184();
      Ordinal_184();
      *param_17 = -(ushort)(*(int *)(lParam + 0x3b0) != 0);
      *param_20 = *(undefined4 *)(lParam + 0x3b6);
      if ((LPCSTR)(lParam + 0x286) != (LPCSTR)0x0) {
        iVar3 = lstrlenA((LPCSTR)(lParam + 0x286));
        FUN_676b06a0();
        MultiByteToWideChar(0,0,(LPCSTR)(lParam + 0x286),-1,(LPWSTR)&stack0xfffffe34,iVar3 + 1);
      }
      uVar2 = Ordinal_2();
      *(undefined4 *)param_3 = uVar2;
      if ((LPCSTR)(lParam + 0x32c) == (LPCSTR)0x0) {
        puVar5 = (undefined1 *)0x0;
      }
      else {
        puVar5 = &stack0xfffffe30;
        iVar3 = lstrlenA((LPCSTR)(lParam + 0x32c));
        FUN_676b06a0();
        MultiByteToWideChar(0,0,(LPCSTR)(lParam + 0x32c),-1,(LPWSTR)&stack0xfffffe30,iVar3 + 1);
      }
      uVar2 = Ordinal_2(puVar5);
      *param_15 = uVar2;
    }
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a3ca7 at 676a3ca7

void __thiscall
FUN_676a3ca7(int param_1,LPCWSTR param_2,LPCWSTR param_3,LPCWSTR param_4,LPCWSTR param_5,
            LPCWSTR param_6,LPCWSTR param_7,LPCWSTR param_8,undefined4 param_9,undefined4 param_10,
            undefined8 param_11,undefined8 param_12,undefined8 param_13,undefined4 param_14,
            short param_15,undefined4 param_16,int *param_17,int *param_18)

{
  char cVar1;
  undefined2 *lParam;
  int *piVar2;
  int iVar3;
  undefined2 local_12c [4];
  undefined4 local_124;
  undefined2 local_11c;
  short local_114;
  undefined2 local_10c;
  undefined4 local_104;
  undefined2 local_fc;
  undefined8 local_f4;
  undefined2 local_ec;
  undefined8 local_e4;
  undefined2 local_dc;
  undefined8 local_d4;
  undefined2 local_cc;
  undefined4 local_c4;
  undefined2 local_bc;
  undefined4 local_b4;
  undefined2 local_ac;
  LPCWSTR local_a4;
  undefined2 local_9c;
  LPCWSTR local_94;
  undefined2 local_8c;
  LPCWSTR local_84;
  undefined2 local_7c;
  LPCWSTR local_74;
  undefined2 local_6c;
  LPCWSTR local_64;
  undefined2 local_5c;
  LPCWSTR local_54;
  undefined2 local_4c;
  LPCWSTR local_44;
  undefined2 *local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 *local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  int local_1c;
  int local_18;
  uint local_14;
  int local_10;
  int *local_c;
  int local_8;
  
  local_1c = param_1;
  if (*param_18 == 0) {
    local_14 = -(uint)(param_1 != 0) & param_1 - 0xa8U;
    local_18 = param_17[1];
    local_10 = local_18;
    if (local_18 == 0) {
      local_10 = *(int *)(param_1 + 0x28);
    }
    local_8 = 0;
    if (0 < local_10) {
      do {
        EnterCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        local_c = (int *)0x0;
        if (local_18 == 0) {
          piVar2 = (int *)FUN_676a7f2d((void *)(local_1c + 4),local_8);
        }
        else if ((local_8 < 0) || (param_17[1] <= local_8)) {
          piVar2 = (int *)0x0;
        }
        else {
          piVar2 = (int *)*param_17;
          if (1 < param_17[1]) {
            piVar2 = (int *)piVar2[local_8];
          }
        }
        FUN_6768fa93((int *)&local_c,piVar2);
        cVar1 = *(char *)(local_14 + 0x1814);
        LeaveCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        if (local_c != (int *)0x0) {
          local_12c[0] = 3;
          if (cVar1 == '\0') {
            local_64 = param_2;
            local_74 = param_3;
            local_7c = 8;
            local_84 = param_4;
            if (param_6 == (LPCWSTR)0x0) {
              local_94 = param_5;
            }
            else {
              local_94 = (LPCWSTR)0xffffffff;
            }
            if (param_8 == (LPCWSTR)0x0) {
              local_a4 = param_7;
            }
            else {
              local_a4 = (LPCWSTR)0xffffffff;
            }
            local_3c = local_12c;
            iVar3 = *local_c;
            local_38 = 0;
            local_34 = 0xd;
            local_30 = 0;
          }
          else {
            local_44 = param_2;
            local_54 = param_3;
            local_64 = param_4;
            local_74 = param_5;
            local_84 = param_6;
            local_94 = param_7;
            local_a4 = param_8;
            local_2c = local_12c;
            local_4c = 8;
            local_5c = 8;
            iVar3 = *local_c;
            local_28 = 0;
            local_24 = 0xf;
            local_20 = 0;
            local_7c = local_12c[0];
          }
          local_6c = 8;
          local_b4 = param_9;
          local_c4 = param_10;
          local_d4 = param_11;
          local_dc = 7;
          local_e4 = param_12;
          local_ec = 7;
          local_f4 = param_13;
          local_fc = 7;
          local_104 = param_14;
          local_114 = param_15;
          local_11c = 0xb;
          local_124 = param_16;
          local_10c = local_12c[0];
          local_cc = local_12c[0];
          local_bc = local_12c[0];
          local_ac = local_12c[0];
          local_9c = local_12c[0];
          local_8c = local_7c;
          (**(code **)(iVar3 + 0x18))(local_c);
          if (local_c != (int *)0x0) {
            (**(code **)(*local_c + 8))(local_c);
          }
        }
        local_8 = local_8 + 1;
      } while (local_8 < local_10);
    }
  }
  else if ((param_18[2] != 0) || (param_18[3] != 0)) {
    if (param_18[1] == 0) {
      lParam = (undefined2 *)operator_new(0xc6c);
      *lParam = 0xc6c;
      *(int *)(lParam + 2) = *param_18;
      *(LPCWSTR *)(lParam + 0x60c) = param_5;
      *(LPCWSTR *)(lParam + 0x60e) = param_7;
      *(undefined4 *)(lParam + 0x610) = param_9;
      *(undefined4 *)(lParam + 0x612) = param_10;
      *(LPCWSTR *)(lParam + 0x632) = param_6;
      *(LPCWSTR *)(lParam + 0x634) = param_8;
      Ordinal_185(param_11,lParam + 0x614);
      Ordinal_185(param_12,lParam + 0x61c);
      Ordinal_185(param_13,lParam + 0x624);
      *(undefined4 *)(lParam + 0x62c) = param_14;
      *(uint *)(lParam + 0x62e) = (uint)(param_15 != 0);
      *(undefined4 *)(lParam + 0x630) = param_16;
      if (param_2 == (LPCWSTR)0x0) {
        lParam[4] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 4,param_2);
      }
      if (param_3 == (LPCWSTR)0x0) {
        lParam[0x108] = 0;
      }
      else {
        FUN_676ae229(lParam + 0x108,param_3,0x400);
        lParam[0x507] = 0;
      }
      if (param_4 == (LPCWSTR)0x0) {
        lParam[0x508] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 0x508,param_4);
      }
    }
    else {
      lParam = (undefined2 *)operator_new(0x664);
      *lParam = 0x664;
      *(int *)(lParam + 2) = *param_18;
      *(LPCWSTR *)(lParam + 0x308) = param_5;
      *(LPCWSTR *)(lParam + 0x30a) = param_7;
      *(undefined4 *)(lParam + 0x30c) = param_9;
      *(undefined4 *)(lParam + 0x30e) = param_10;
      *(LPCWSTR *)(lParam + 0x32e) = param_6;
      *(LPCWSTR *)(lParam + 0x330) = param_8;
      Ordinal_185(param_11,lParam + 0x310);
      Ordinal_185(param_12,lParam + 0x318);
      Ordinal_185(param_13,lParam + 800);
      *(undefined4 *)(lParam + 0x328) = param_14;
      *(uint *)(lParam + 0x32a) = (uint)(param_15 != 0);
      *(undefined4 *)(lParam + 0x32c) = param_16;
      FUN_676a2644(param_2,(LPSTR)(lParam + 4),0x104);
      FUN_676a2644(param_3,(LPSTR)(lParam + 0x86),0x400);
      FUN_676a2644(param_4,(LPSTR)(lParam + 0x286),0x104);
    }
    if ((HWND)param_18[2] != (HWND)0x0) {
      SendMessageA((HWND)param_18[2],0xa13,6,(LPARAM)lParam);
    }
    if ((code *)param_18[3] != (code *)0x0) {
      (*(code *)param_18[3])(6,lParam);
    }
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a4219 at 676a4219

void __thiscall
FUN_676a4219(void *this,LPCWSTR param_1,LPCWSTR param_2,LPCWSTR param_3,LPCWSTR param_4,
            LPCWSTR param_5,LPCWSTR param_6,undefined4 param_7,undefined4 param_8,undefined8 param_9
            ,undefined8 param_10,undefined8 param_11,undefined4 param_12,short param_13,
            int *param_14,int *param_15)

{
  char cVar1;
  undefined2 *lParam;
  int *piVar2;
  int iVar3;
  undefined2 local_10c [4];
  short local_104;
  undefined2 local_fc;
  undefined4 local_f4;
  undefined2 local_ec;
  undefined8 local_e4;
  undefined2 local_dc;
  undefined8 local_d4;
  undefined2 local_cc;
  undefined8 local_c4;
  undefined2 local_bc;
  undefined4 local_b4;
  undefined2 local_ac;
  undefined4 local_a4;
  undefined2 local_9c;
  LPCWSTR local_94;
  undefined2 local_8c;
  LPCWSTR local_84;
  undefined2 local_7c;
  LPCWSTR local_74;
  undefined2 local_6c;
  LPCWSTR local_64;
  undefined2 local_5c;
  LPCWSTR local_54;
  undefined2 local_4c;
  LPCWSTR local_44;
  undefined2 *local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 *local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  void *local_1c;
  int local_18;
  uint local_14;
  int local_10;
  int *local_c;
  int local_8;
  
  local_1c = this;
  if (*param_15 == 0) {
    local_14 = -(uint)(this != (void *)0x0) & (int)this - 0xa8U;
    local_18 = param_14[1];
    local_10 = local_18;
    if (local_18 == 0) {
      local_10 = *(int *)((int)this + 0x28);
    }
    local_8 = 0;
    if (0 < local_10) {
      do {
        EnterCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        local_c = (int *)0x0;
        if (local_18 == 0) {
          piVar2 = (int *)FUN_676a7f2d((void *)((int)local_1c + 4),local_8);
        }
        else if ((local_8 < 0) || (param_14[1] <= local_8)) {
          piVar2 = (int *)0x0;
        }
        else {
          piVar2 = (int *)*param_14;
          if (1 < param_14[1]) {
            piVar2 = (int *)piVar2[local_8];
          }
        }
        FUN_6768fa93((int *)&local_c,piVar2);
        cVar1 = *(char *)(local_14 + 0x1814);
        LeaveCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        if (local_c != (int *)0x0) {
          local_fc = 3;
          if (cVar1 == '\0') {
            local_64 = param_1;
            local_6c = 8;
            local_74 = param_2;
            if (param_4 == (LPCWSTR)0x0) {
              local_84 = param_3;
            }
            else {
              local_84 = (LPCWSTR)0xffffffff;
            }
            if (param_6 == (LPCWSTR)0x0) {
              local_94 = param_5;
            }
            else {
              local_94 = (LPCWSTR)0xffffffff;
            }
            local_3c = local_10c;
            local_34 = 0xb;
            iVar3 = *local_c;
            local_38 = 0;
            local_30 = 0;
          }
          else {
            local_44 = param_1;
            local_54 = param_2;
            local_64 = param_3;
            local_74 = param_4;
            local_84 = param_5;
            local_94 = param_6;
            local_2c = local_10c;
            local_4c = 8;
            local_5c = 8;
            iVar3 = *local_c;
            local_28 = 0;
            local_24 = 0xd;
            local_20 = 0;
            local_6c = local_fc;
          }
          local_10c[0] = 0xb;
          local_a4 = param_7;
          local_b4 = param_8;
          local_c4 = param_9;
          local_cc = 7;
          local_d4 = param_10;
          local_dc = 7;
          local_e4 = param_11;
          local_ec = 7;
          local_f4 = param_12;
          local_104 = param_13;
          local_bc = local_fc;
          local_ac = local_fc;
          local_9c = local_fc;
          local_8c = local_fc;
          local_7c = local_6c;
          (**(code **)(iVar3 + 0x18))(local_c);
          if (local_c != (int *)0x0) {
            (**(code **)(*local_c + 8))(local_c);
          }
        }
        local_8 = local_8 + 1;
      } while (local_8 < local_10);
    }
  }
  else if ((param_15[2] != 0) || (param_15[3] != 0)) {
    if (param_15[1] == 0) {
      lParam = (undefined2 *)operator_new(0xa60);
      *lParam = 0xa60;
      *(int *)(lParam + 2) = *param_15;
      *(LPCWSTR *)(lParam + 0x508) = param_3;
      *(LPCWSTR *)(lParam + 0x50a) = param_5;
      *(undefined4 *)(lParam + 0x50c) = param_7;
      *(undefined4 *)(lParam + 0x50e) = param_8;
      *(LPCWSTR *)(lParam + 0x52c) = param_4;
      *(LPCWSTR *)(lParam + 0x52e) = param_6;
      Ordinal_185(param_9,lParam + 0x510);
      Ordinal_185(param_10,lParam + 0x518);
      Ordinal_185(param_11,lParam + 0x520);
      *(undefined4 *)(lParam + 0x528) = param_12;
      *(uint *)(lParam + 0x52a) = (uint)(param_13 != 0);
      if (param_1 == (LPCWSTR)0x0) {
        lParam[4] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 4,param_1);
      }
      if (param_2 == (LPCWSTR)0x0) {
        lParam[0x108] = 0;
      }
      else {
        FUN_676ae229(lParam + 0x108,param_2,0x400);
        lParam[0x507] = 0;
      }
    }
    else {
      lParam = (undefined2 *)operator_new(0x55c);
      *lParam = 0x55c;
      *(int *)(lParam + 2) = *param_15;
      *(LPCWSTR *)(lParam + 0x286) = param_3;
      *(LPCWSTR *)(lParam + 0x288) = param_5;
      *(undefined4 *)(lParam + 0x28a) = param_7;
      *(undefined4 *)(lParam + 0x28c) = param_8;
      *(LPCWSTR *)(lParam + 0x2aa) = param_4;
      *(LPCWSTR *)(lParam + 0x2ac) = param_6;
      Ordinal_185(param_9,lParam + 0x28e);
      Ordinal_185(param_10,lParam + 0x296);
      Ordinal_185(param_11,lParam + 0x29e);
      *(undefined4 *)(lParam + 0x2a6) = param_12;
      *(uint *)(lParam + 0x2a8) = (uint)(param_13 != 0);
      FUN_676a2644(param_1,(LPSTR)(lParam + 4),0x104);
      FUN_676a2644(param_2,(LPSTR)(lParam + 0x86),0x400);
    }
    if ((HWND)param_15[2] != (HWND)0x0) {
      SendMessageA((HWND)param_15[2],0xa13,7,(LPARAM)lParam);
    }
    if ((code *)param_15[3] != (code *)0x0) {
      (*(code *)param_15[3])(7,lParam);
    }
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a4705 at 676a4705

void __thiscall
FUN_676a4705(int param_1,LPCWSTR param_2,LPCWSTR param_3,LPCWSTR param_4,LPCWSTR param_5,
            LPCWSTR param_6,LPCWSTR param_7,undefined2 param_8,undefined4 param_9,
            undefined4 param_10,undefined8 param_11,undefined8 param_12,undefined8 param_13,
            undefined4 param_14,short param_15,undefined4 param_16,int *param_17,int *param_18)

{
  char cVar1;
  undefined2 *lParam;
  int *piVar2;
  int iVar3;
  undefined2 local_12c [4];
  undefined4 local_124;
  undefined2 local_11c;
  short local_114;
  undefined2 local_10c;
  undefined4 local_104;
  undefined2 local_fc;
  undefined8 local_f4;
  undefined2 local_ec;
  undefined8 local_e4;
  undefined2 local_dc;
  undefined8 local_d4;
  undefined2 local_cc;
  undefined4 local_c4;
  undefined2 local_bc;
  undefined4 local_b4;
  undefined2 local_ac;
  undefined2 local_a4;
  undefined2 local_9c;
  LPCWSTR local_94;
  undefined2 local_8c;
  LPCWSTR local_84;
  undefined2 local_7c;
  LPCWSTR local_74;
  undefined2 local_6c;
  LPCWSTR local_64;
  undefined2 local_5c;
  LPCWSTR local_54;
  undefined2 local_4c;
  LPCWSTR local_44;
  undefined2 *local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 *local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  int local_1c;
  int local_18;
  uint local_14;
  int local_10;
  int *local_c;
  int local_8;
  
  local_1c = param_1;
  if (*param_18 == 0) {
    local_14 = -(uint)(param_1 != 0) & param_1 - 0xa8U;
    local_18 = param_17[1];
    local_10 = local_18;
    if (local_18 == 0) {
      local_10 = *(int *)(param_1 + 0x28);
    }
    local_8 = 0;
    if (0 < local_10) {
      do {
        EnterCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        local_c = (int *)0x0;
        if (local_18 == 0) {
          piVar2 = (int *)FUN_676a7f2d((void *)(local_1c + 4),local_8);
        }
        else if ((local_8 < 0) || (param_17[1] <= local_8)) {
          piVar2 = (int *)0x0;
        }
        else {
          piVar2 = (int *)*param_17;
          if (1 < param_17[1]) {
            piVar2 = (int *)piVar2[local_8];
          }
        }
        FUN_6768fa93((int *)&local_c,piVar2);
        cVar1 = *(char *)(local_14 + 0x1814);
        LeaveCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        if (local_c != (int *)0x0) {
          local_12c[0] = 3;
          if (cVar1 == '\0') {
            local_64 = param_2;
            local_6c = 8;
            local_74 = param_3;
            if (param_5 == (LPCWSTR)0x0) {
              local_84 = param_4;
            }
            else {
              local_84 = (LPCWSTR)0xffffffff;
            }
            if (param_7 == (LPCWSTR)0x0) {
              local_94 = param_6;
            }
            else {
              local_94 = (LPCWSTR)0xffffffff;
            }
            local_3c = local_12c;
            iVar3 = *local_c;
            local_38 = 0;
            local_34 = 0xd;
            local_30 = 0;
          }
          else {
            local_44 = param_2;
            local_54 = param_3;
            local_64 = param_4;
            local_74 = param_5;
            local_84 = param_6;
            local_94 = param_7;
            local_2c = local_12c;
            local_4c = 8;
            local_5c = 8;
            iVar3 = *local_c;
            local_28 = 0;
            local_24 = 0xf;
            local_20 = 0;
            local_6c = local_12c[0];
          }
          local_a4 = param_8;
          local_ac = 2;
          local_b4 = param_9;
          local_c4 = param_10;
          local_d4 = param_11;
          local_dc = 7;
          local_e4 = param_12;
          local_ec = 7;
          local_f4 = param_13;
          local_fc = 7;
          local_104 = param_14;
          local_114 = param_15;
          local_11c = 0xb;
          local_124 = param_16;
          local_10c = local_12c[0];
          local_cc = local_12c[0];
          local_bc = local_12c[0];
          local_9c = local_12c[0];
          local_8c = local_12c[0];
          local_7c = local_6c;
          (**(code **)(iVar3 + 0x18))(local_c);
          if (local_c != (int *)0x0) {
            (**(code **)(*local_c + 8))(local_c);
          }
        }
        local_8 = local_8 + 1;
      } while (local_8 < local_10);
    }
  }
  else if ((param_18[2] != 0) || (param_18[3] != 0)) {
    if (param_18[1] == 0) {
      lParam = (undefined2 *)operator_new(0xa68);
      *lParam = 0xa68;
      *(int *)(lParam + 2) = *param_18;
      *(LPCWSTR *)(lParam + 0x508) = param_4;
      *(LPCWSTR *)(lParam + 0x50a) = param_6;
      lParam[0x50c] = param_8;
      *(undefined4 *)(lParam + 0x50e) = param_9;
      *(undefined4 *)(lParam + 0x510) = param_10;
      *(LPCWSTR *)(lParam + 0x530) = param_5;
      *(LPCWSTR *)(lParam + 0x532) = param_7;
      Ordinal_185(param_11,lParam + 0x512);
      Ordinal_185(param_12,lParam + 0x51a);
      Ordinal_185(param_13,lParam + 0x522);
      *(undefined4 *)(lParam + 0x52a) = param_14;
      *(uint *)(lParam + 0x52c) = (uint)(param_15 != 0);
      *(undefined4 *)(lParam + 0x52e) = param_16;
      if (param_2 == (LPCWSTR)0x0) {
        lParam[4] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 4,param_2);
      }
      if (param_3 == (LPCWSTR)0x0) {
        lParam[0x108] = 0;
      }
      else {
        FUN_676ae229(lParam + 0x108,param_3,0x400);
        lParam[0x507] = 0;
      }
    }
    else {
      lParam = (undefined2 *)operator_new(0x564);
      *lParam = 0x564;
      *(int *)(lParam + 2) = *param_18;
      *(LPCWSTR *)(lParam + 0x286) = param_4;
      *(LPCWSTR *)(lParam + 0x288) = param_6;
      lParam[0x28a] = param_8;
      *(undefined4 *)(lParam + 0x28c) = param_9;
      *(undefined4 *)(lParam + 0x28e) = param_10;
      *(LPCWSTR *)(lParam + 0x2ae) = param_5;
      *(LPCWSTR *)(lParam + 0x2b0) = param_7;
      Ordinal_185(param_11,lParam + 0x290);
      Ordinal_185(param_12,lParam + 0x298);
      Ordinal_185(param_13,lParam + 0x2a0);
      *(undefined4 *)(lParam + 0x2a8) = param_14;
      *(uint *)(lParam + 0x2aa) = (uint)(param_15 != 0);
      *(undefined4 *)(lParam + 0x2ac) = param_16;
      FUN_676a2644(param_2,(LPSTR)(lParam + 4),0x104);
      FUN_676a2644(param_3,(LPSTR)(lParam + 0x86),0x400);
    }
    if ((HWND)param_18[2] != (HWND)0x0) {
      SendMessageA((HWND)param_18[2],0xa13,8,(LPARAM)lParam);
    }
    if ((code *)param_18[3] != (code *)0x0) {
      (*(code *)param_18[3])(8,lParam);
    }
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a4c64 at 676a4c64

void __thiscall
FUN_676a4c64(void *this,LPCWSTR param_1,int param_2,int param_3,LPCWSTR param_4,int param_5,
            LPCWSTR param_6,LPCWSTR param_7,undefined2 param_8,undefined2 param_9,short param_10,
            int *param_11,int *param_12)

{
  char cVar1;
  undefined2 *lParam;
  int *piVar2;
  int iVar3;
  undefined4 uVar4;
  undefined2 **ppuVar5;
  undefined2 local_dc [4];
  short local_d4;
  undefined2 local_cc;
  undefined2 local_c4;
  undefined2 local_bc;
  undefined2 local_b4;
  undefined2 local_ac;
  LPCWSTR local_a4;
  undefined2 local_9c;
  LPCWSTR local_94;
  undefined2 local_8c;
  int local_84;
  undefined2 local_7c;
  LPCWSTR local_74;
  undefined2 local_6c;
  int local_64;
  undefined2 local_5c;
  int local_54;
  undefined2 local_4c;
  LPCWSTR local_44;
  undefined2 *local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 *local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  void *local_1c;
  int local_18;
  uint local_14;
  int local_10;
  int *local_c;
  int local_8;
  
  local_1c = this;
  if (*param_12 == 0) {
    local_14 = -(uint)(this != (void *)0x0) & (int)this - 0xa8U;
    local_18 = param_11[1];
    local_10 = local_18;
    if (local_18 == 0) {
      local_10 = *(int *)((int)this + 0x28);
    }
    local_8 = 0;
    if (0 < local_10) {
      do {
        EnterCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        local_c = (int *)0x0;
        if (local_18 == 0) {
          piVar2 = (int *)FUN_676a7f2d((void *)((int)local_1c + 4),local_8);
        }
        else if ((local_8 < 0) || (param_11[1] <= local_8)) {
          piVar2 = (int *)0x0;
        }
        else {
          piVar2 = (int *)*param_11;
          if (1 < param_11[1]) {
            piVar2 = (int *)piVar2[local_8];
          }
        }
        FUN_6768fa93((int *)&local_c,piVar2);
        cVar1 = *(char *)(local_14 + 0x1814);
        LeaveCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        if (local_c != (int *)0x0) {
          local_ac = 3;
          if (cVar1 == '\0') {
            local_7c = 8;
            local_74 = param_1;
            if (param_3 == 0) {
              local_84 = param_2;
            }
            else {
              local_84 = -1;
            }
            if (param_5 == 0) {
              local_94 = param_4;
            }
            else {
              local_94 = (LPCWSTR)0xffffffff;
            }
            if (param_7 == (LPCWSTR)0x0) {
              local_a4 = param_6;
            }
            else {
              local_a4 = (LPCWSTR)0xffffffff;
            }
            ppuVar5 = &local_3c;
            local_3c = local_dc;
            iVar3 = *local_c;
            local_38 = 0;
            local_34 = 7;
            local_30 = 0;
            uVar4 = 0x17d4;
          }
          else {
            local_44 = param_1;
            local_54 = param_2;
            local_64 = param_3;
            local_74 = param_4;
            local_84 = param_5;
            local_94 = param_6;
            local_a4 = param_7;
            ppuVar5 = &local_2c;
            local_2c = local_dc;
            local_4c = 8;
            iVar3 = *local_c;
            local_28 = 0;
            local_24 = 10;
            local_20 = 0;
            uVar4 = 0x17d9;
            local_7c = local_ac;
            local_6c = local_ac;
            local_5c = local_ac;
          }
          local_b4 = param_8;
          local_bc = 2;
          local_c4 = param_9;
          local_cc = 2;
          local_d4 = param_10;
          local_dc[0] = 0xb;
          local_9c = local_ac;
          local_8c = local_ac;
          (**(code **)(iVar3 + 0x18))(local_c,uVar4,&DAT_676bb4f0,0x400,1,ppuVar5,0,0,0);
          if (local_c != (int *)0x0) {
            (**(code **)(*local_c + 8))(local_c);
          }
        }
        local_8 = local_8 + 1;
      } while (local_8 < local_10);
    }
  }
  else if ((param_12[2] != 0) || (param_12[3] != 0)) {
    if (param_12[1] == 0) {
      lParam = (undefined2 *)operator_new(0x230);
      *lParam = 0x230;
      *(int *)(lParam + 2) = *param_12;
      *(int *)(lParam + 0x108) = param_2;
      *(LPCWSTR *)(lParam + 0x10a) = param_4;
      *(LPCWSTR *)(lParam + 0x10c) = param_6;
      lParam[0x10e] = param_8;
      lParam[0x10f] = param_9;
      *(uint *)(lParam + 0x110) = (uint)(param_10 != 0);
      *(int *)(lParam + 0x112) = param_3;
      *(int *)(lParam + 0x114) = param_5;
      *(LPCWSTR *)(lParam + 0x116) = param_7;
      if (param_1 == (LPCWSTR)0x0) {
        lParam[4] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 4,param_1);
      }
    }
    else {
      lParam = (undefined2 *)operator_new(300);
      *lParam = 300;
      *(int *)(lParam + 2) = *param_12;
      *(int *)(lParam + 0x86) = param_2;
      *(LPCWSTR *)(lParam + 0x88) = param_4;
      *(LPCWSTR *)(lParam + 0x8a) = param_6;
      lParam[0x8c] = param_8;
      lParam[0x8d] = param_9;
      *(uint *)(lParam + 0x8e) = (uint)(param_10 != 0);
      *(int *)(lParam + 0x90) = param_3;
      *(int *)(lParam + 0x92) = param_5;
      *(LPCWSTR *)(lParam + 0x94) = param_7;
      FUN_676a2644(param_1,(LPSTR)(lParam + 4),0x104);
    }
    if ((HWND)param_12[2] != (HWND)0x0) {
      SendMessageA((HWND)param_12[2],0xa13,9,(LPARAM)lParam);
    }
    if ((code *)param_12[3] != (code *)0x0) {
      (*(code *)param_12[3])(9,lParam);
    }
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a505c at 676a505c

/* WARNING: Removing unreachable block (ram,0x676a5336) */

void __thiscall
FUN_676a505c(void *this,undefined4 param_1,int param_2,int param_3,undefined2 param_4,
            undefined4 param_5,int param_6,int param_7,int param_8,undefined4 param_9,int param_10,
            undefined2 param_11,int param_12,int param_13,undefined2 param_14,int *param_15,
            int *param_16)

{
  char cVar1;
  undefined2 *lParam;
  int *piVar2;
  int iVar3;
  undefined4 uVar4;
  undefined2 **ppuVar5;
  undefined2 local_11c [4];
  undefined2 local_114;
  undefined2 local_10c;
  int local_104;
  undefined2 local_fc;
  int local_f4;
  undefined2 local_ec;
  undefined4 local_e4;
  undefined2 local_dc;
  int local_d4;
  undefined2 local_cc;
  undefined4 local_c4;
  undefined2 local_bc;
  int local_b4;
  undefined2 local_ac;
  int local_a4;
  undefined2 local_9c;
  int local_94;
  undefined2 local_8c;
  undefined4 local_84;
  undefined2 local_7c;
  undefined2 local_74;
  undefined2 local_6c;
  int local_64;
  undefined2 local_5c;
  int local_54;
  undefined2 local_4c;
  undefined4 local_44;
  undefined2 *local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 *local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  void *local_1c;
  int local_18;
  uint local_14;
  int local_10;
  int *local_c;
  int local_8;
  
  local_1c = this;
  if (*param_16 == 0) {
    local_14 = -(uint)(this != (void *)0x0) & (int)this - 0xa8U;
    local_18 = param_15[1];
    local_10 = local_18;
    if (local_18 == 0) {
      local_10 = *(int *)((int)this + 0x28);
    }
    local_8 = 0;
    if (0 < local_10) {
      do {
        EnterCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        local_c = (int *)0x0;
        if (local_18 == 0) {
          piVar2 = (int *)FUN_676a7f2d((void *)((int)local_1c + 4),local_8);
        }
        else if ((local_8 < 0) || (param_15[1] <= local_8)) {
          piVar2 = (int *)0x0;
        }
        else {
          piVar2 = (int *)*param_15;
          if (1 < param_15[1]) {
            piVar2 = (int *)piVar2[local_8];
          }
        }
        FUN_6768fa93((int *)&local_c,piVar2);
        cVar1 = *(char *)(local_14 + 0x1814);
        LeaveCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        if (local_c != (int *)0x0) {
          local_10c = 3;
          if (cVar1 == '\0') {
            local_84 = param_1;
            local_94 = param_2;
            local_a4 = param_3;
            local_bc = 2;
            local_b4 = CONCAT22(local_b4._2_2_,param_4);
            if (param_6 == 0) {
              local_c4 = param_5;
            }
            else {
              local_c4 = 0xffffffff;
            }
            if (param_8 == 0) {
              local_d4 = param_7;
            }
            else {
              local_d4 = -1;
            }
            if (param_10 == 0) {
              local_e4 = param_9;
            }
            else {
              local_e4 = 0xffffffff;
            }
            local_f4 = CONCAT22(local_f4._2_2_,param_11);
            if (param_13 == 0) {
              local_104 = param_12;
            }
            else {
              local_104 = -1;
            }
            ppuVar5 = &local_3c;
            local_3c = local_11c;
            iVar3 = *local_c;
            local_38 = 0;
            local_34 = 10;
            local_30 = 0;
            uVar4 = 0x17d5;
            local_ec = local_10c;
          }
          else {
            local_44 = param_1;
            local_54 = param_2;
            local_64 = param_3;
            local_74 = param_4;
            local_84 = param_5;
            local_94 = param_6;
            local_a4 = param_7;
            local_b4 = param_8;
            local_c4 = param_9;
            local_d4 = param_10;
            local_e4 = CONCAT22(local_e4._2_2_,param_11);
            local_f4 = param_12;
            local_104 = param_13;
            ppuVar5 = &local_2c;
            local_2c = local_11c;
            local_7c = 2;
            local_ec = 2;
            iVar3 = *local_c;
            local_28 = 0;
            local_24 = 0xe;
            local_20 = 0;
            uVar4 = 0x17da;
            local_bc = local_10c;
            local_6c = local_10c;
            local_5c = local_10c;
            local_4c = local_10c;
          }
          local_114 = param_14;
          local_11c[0] = 2;
          local_fc = local_bc;
          local_dc = local_10c;
          local_cc = local_10c;
          local_ac = local_10c;
          local_9c = local_10c;
          local_8c = local_10c;
          (**(code **)(iVar3 + 0x18))(local_c,uVar4,&DAT_676bb4f0,0x400,1,ppuVar5,0,0,0);
          if (local_c != (int *)0x0) {
            (**(code **)(*local_c + 8))(local_c);
          }
        }
        local_8 = local_8 + 1;
      } while (local_8 < local_10);
    }
  }
  else if ((param_16[2] != 0) || (param_16[3] != 0)) {
    lParam = (undefined2 *)operator_new(0x40);
    *lParam = 0x40;
    *(int *)(lParam + 2) = *param_16;
    *(undefined4 *)(lParam + 4) = param_1;
    *(int *)(lParam + 6) = param_2;
    *(int *)(lParam + 8) = param_3;
    lParam[10] = param_4;
    *(undefined4 *)(lParam + 0xc) = param_5;
    *(int *)(lParam + 0xe) = param_7;
    *(undefined4 *)(lParam + 0x10) = param_9;
    lParam[0x12] = param_11;
    *(int *)(lParam + 0x14) = param_12;
    lParam[0x16] = param_14;
    *(int *)(lParam + 0x18) = param_6;
    *(int *)(lParam + 0x1a) = param_8;
    *(int *)(lParam + 0x1c) = param_10;
    *(int *)(lParam + 0x1e) = param_13;
    if ((HWND)param_16[2] != (HWND)0x0) {
      SendMessageA((HWND)param_16[2],0xa13,10,(LPARAM)lParam);
    }
    if ((code *)param_16[3] != (code *)0x0) {
      (*(code *)param_16[3])(10,lParam);
    }
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a5427 at 676a5427

void __thiscall FUN_676a5427(void *this,undefined4 *param_1,int *param_2,int *param_3)

{
  int iVar1;
  int *piVar2;
  undefined2 *lParam;
  int *piVar3;
  int iVar4;
  undefined2 local_30 [4];
  undefined4 *local_28;
  undefined2 *local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  void *local_10;
  int *local_c;
  LPCRITICAL_SECTION local_8;
  
  piVar3 = param_3;
  piVar2 = param_2;
  local_10 = this;
  if (*param_3 == 0) {
    local_c = (int *)param_2[1];
    param_2 = local_c;
    if (local_c == (int *)0x0) {
      param_2 = *(int **)((int)this + 0x28);
    }
    iVar4 = 0;
    if (0 < (int)param_2) {
      local_8 = (LPCRITICAL_SECTION)((-(uint)(this != (void *)0x0) & (int)this - 0xa8U) + 0x16c4);
      do {
        EnterCriticalSection(local_8);
        param_3 = (int *)0x0;
        if (local_c == (int *)0x0) {
          piVar3 = (int *)FUN_676a7f2d((void *)((int)local_10 + 4),iVar4);
        }
        else if ((iVar4 < 0) || (iVar1 = piVar2[1], iVar1 <= iVar4)) {
          piVar3 = (int *)0x0;
        }
        else {
          piVar3 = (int *)*piVar2;
          if (1 < iVar1) {
            piVar3 = (int *)piVar3[iVar4];
          }
        }
        FUN_6768fa93((int *)&param_3,piVar3);
        LeaveCriticalSection(local_8);
        if (param_3 != (int *)0x0) {
          local_28 = param_1;
          local_20 = local_30;
          local_30[0] = 0x4003;
          local_1c = 0;
          local_18 = 1;
          local_14 = 0;
          (**(code **)(*param_3 + 0x18))(param_3,0x1839,&DAT_676bb4f0,0x400,1,&local_20,0,0,0);
          if (param_3 != (int *)0x0) {
            (**(code **)(*param_3 + 8))(param_3);
          }
        }
        iVar4 = iVar4 + 1;
      } while (iVar4 < (int)param_2);
    }
  }
  else if ((param_3[2] != 0) || (param_3[3] != 0)) {
    lParam = (undefined2 *)operator_new(0xc);
    *lParam = 0xc;
    *(int *)(lParam + 2) = *piVar3;
    *(undefined4 *)(lParam + 4) = *param_1;
    if ((HWND)piVar3[2] != (HWND)0x0) {
      SendMessageA((HWND)piVar3[2],0xa13,0xb,(LPARAM)lParam);
    }
    if ((code *)piVar3[3] != (code *)0x0) {
      (*(code *)piVar3[3])(0xb,lParam);
    }
    *param_1 = *(undefined4 *)(lParam + 4);
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a557f at 676a557f

/* WARNING: Removing unreachable block (ram,0x676a5823) */

void __thiscall
FUN_676a557f(void *this,int param_1,int param_2,int param_3,int param_4,int param_5,int param_6,
            int param_7,int param_8,int param_9,int param_10,int param_11,undefined2 param_12,
            undefined4 param_13,int *param_14,int *param_15)

{
  char cVar1;
  undefined2 *lParam;
  int *piVar2;
  int iVar3;
  undefined4 uVar4;
  undefined2 **ppuVar5;
  undefined2 local_10c [4];
  undefined4 local_104;
  undefined2 local_fc;
  undefined2 local_f4;
  undefined2 local_ec;
  int local_e4;
  undefined2 local_dc;
  int local_d4;
  undefined2 local_cc;
  int local_c4;
  undefined2 local_bc;
  int local_b4;
  undefined2 local_ac;
  int local_a4;
  undefined2 local_9c;
  int local_94;
  undefined2 local_8c;
  int local_84;
  undefined2 local_7c;
  int local_74;
  undefined2 local_6c;
  int local_64;
  undefined2 local_5c;
  int local_54;
  undefined2 local_4c;
  int local_44;
  undefined2 *local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 *local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  void *local_1c;
  int local_18;
  uint local_14;
  int local_10;
  int *local_c;
  int local_8;
  
  local_1c = this;
  if (*param_15 == 0) {
    local_14 = -(uint)(this != (void *)0x0) & (int)this - 0xa8U;
    local_18 = param_14[1];
    local_10 = local_18;
    if (local_18 == 0) {
      local_10 = *(int *)((int)this + 0x28);
    }
    local_8 = 0;
    if (0 < local_10) {
      do {
        EnterCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        local_c = (int *)0x0;
        if (local_18 == 0) {
          piVar2 = (int *)FUN_676a7f2d((void *)((int)local_1c + 4),local_8);
        }
        else if ((local_8 < 0) || (param_14[1] <= local_8)) {
          piVar2 = (int *)0x0;
        }
        else {
          piVar2 = (int *)*param_14;
          if (1 < param_14[1]) {
            piVar2 = (int *)piVar2[local_8];
          }
        }
        FUN_6768fa93((int *)&local_c,piVar2);
        cVar1 = *(char *)(local_14 + 0x1814);
        LeaveCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        if (local_c != (int *)0x0) {
          local_10c[0] = 3;
          if (cVar1 == '\0') {
            local_84 = param_1;
            local_94 = param_2;
            local_a4 = param_3;
            if (param_5 == 0) {
              local_b4 = param_4;
            }
            else {
              local_b4 = -1;
            }
            if (param_7 == 0) {
              local_c4 = param_6;
            }
            else {
              local_c4 = -1;
            }
            if (param_9 == 0) {
              local_d4 = param_8;
            }
            else {
              local_d4 = -1;
            }
            if (param_11 == 0) {
              local_e4 = param_10;
            }
            else {
              local_e4 = -1;
            }
            ppuVar5 = &local_3c;
            local_3c = local_10c;
            iVar3 = *local_c;
            local_38 = 0;
            local_34 = 9;
            local_30 = 0;
            uVar4 = 0x22c4;
          }
          else {
            local_44 = param_1;
            local_54 = param_2;
            local_64 = param_3;
            local_74 = param_4;
            local_84 = param_5;
            local_94 = param_6;
            local_a4 = param_7;
            local_b4 = param_8;
            local_c4 = param_9;
            local_d4 = param_10;
            local_e4 = param_11;
            ppuVar5 = &local_2c;
            local_2c = local_10c;
            iVar3 = *local_c;
            local_28 = 0;
            local_24 = 0xd;
            local_20 = 0;
            uVar4 = 0x22c6;
            local_7c = local_10c[0];
            local_6c = local_10c[0];
            local_5c = local_10c[0];
            local_4c = local_10c[0];
          }
          local_f4 = param_12;
          local_fc = 2;
          local_104 = param_13;
          local_ec = local_10c[0];
          local_dc = local_10c[0];
          local_cc = local_10c[0];
          local_bc = local_10c[0];
          local_ac = local_10c[0];
          local_9c = local_10c[0];
          local_8c = local_10c[0];
          (**(code **)(iVar3 + 0x18))(local_c,uVar4,&DAT_676bb4f0,0x400,1,ppuVar5,0,0,0);
          if (local_c != (int *)0x0) {
            (**(code **)(*local_c + 8))(local_c);
          }
        }
        local_8 = local_8 + 1;
      } while (local_8 < local_10);
    }
  }
  else if ((param_15[2] != 0) || (param_15[3] != 0)) {
    lParam = (undefined2 *)operator_new(0x3c);
    *lParam = 0x3c;
    *(int *)(lParam + 2) = *param_15;
    *(int *)(lParam + 4) = param_1;
    *(int *)(lParam + 6) = param_2;
    *(int *)(lParam + 8) = param_3;
    *(int *)(lParam + 10) = param_4;
    *(int *)(lParam + 0xc) = param_6;
    *(int *)(lParam + 0xe) = param_8;
    *(int *)(lParam + 0x10) = param_10;
    lParam[0x12] = param_12;
    *(undefined4 *)(lParam + 0x14) = param_13;
    *(int *)(lParam + 0x16) = param_5;
    *(int *)(lParam + 0x18) = param_7;
    *(int *)(lParam + 0x1a) = param_9;
    *(int *)(lParam + 0x1c) = param_11;
    if ((HWND)param_15[2] != (HWND)0x0) {
      SendMessageA((HWND)param_15[2],0xa13,0xc,(LPARAM)lParam);
    }
    if ((code *)param_15[3] != (code *)0x0) {
      (*(code *)param_15[3])(0xc,lParam);
    }
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a5910 at 676a5910

void __thiscall FUN_676a5910(void *this,undefined4 *param_1,int *param_2,int *param_3)

{
  LPCSTR lpString;
  int iVar1;
  int *piVar2;
  undefined2 *lParam;
  int iVar3;
  LPCSTR pCVar4;
  undefined4 uVar5;
  int *piVar6;
  undefined2 local_30 [4];
  undefined4 *local_28;
  undefined2 *local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  void *local_10;
  int *local_c;
  LPCRITICAL_SECTION local_8;
  
  piVar6 = param_3;
  piVar2 = param_2;
  local_10 = this;
  if (*param_3 == 0) {
    local_c = (int *)param_2[1];
    param_2 = local_c;
    if (local_c == (int *)0x0) {
      param_2 = *(int **)((int)this + 0x28);
    }
    iVar3 = 0;
    if (0 < (int)param_2) {
      local_8 = (LPCRITICAL_SECTION)((-(uint)(this != (void *)0x0) & (int)this - 0xa8U) + 0x16c4);
      do {
        EnterCriticalSection(local_8);
        param_3 = (int *)0x0;
        if (local_c == (int *)0x0) {
          piVar6 = (int *)FUN_676a7f2d((void *)((int)local_10 + 4),iVar3);
        }
        else if ((iVar3 < 0) || (iVar1 = piVar2[1], iVar1 <= iVar3)) {
          piVar6 = (int *)0x0;
        }
        else {
          piVar6 = (int *)*piVar2;
          if (1 < iVar1) {
            piVar6 = (int *)piVar6[iVar3];
          }
        }
        FUN_6768fa93((int *)&param_3,piVar6);
        LeaveCriticalSection(local_8);
        if (param_3 != (int *)0x0) {
          local_28 = param_1;
          local_20 = local_30;
          local_30[0] = 0x4008;
          local_1c = 0;
          local_18 = 1;
          local_14 = 0;
          (**(code **)(*param_3 + 0x18))(param_3,0x22c5,&DAT_676bb4f0,0x400,1,&local_20,0,0);
          if (param_3 != (int *)0x0) {
            (**(code **)(*param_3 + 8))();
          }
        }
        iVar3 = iVar3 + 1;
      } while (iVar3 < (int)param_2);
    }
  }
  else if ((param_3[2] != 0) || (param_3[3] != 0)) {
    if (param_3[1] == 0) {
      lParam = (undefined2 *)operator_new(0x5008);
      *lParam = 0x5008;
      *(int *)(lParam + 2) = *piVar6;
      if ((short *)*param_1 == (short *)0x0) {
        lParam[4] = 0;
      }
      else {
        FUN_676ae229(lParam + 4,(short *)*param_1,0x2800);
        lParam[0x2803] = 0;
      }
    }
    else {
      lParam = (undefined2 *)operator_new(0x2808);
      *lParam = 0x2808;
      *(int *)(lParam + 2) = *piVar6;
      FUN_676a2644((LPCWSTR)*param_1,(LPSTR)(lParam + 4),0x2800);
    }
    if ((HWND)piVar6[2] != (HWND)0x0) {
      SendMessageA((HWND)piVar6[2],0xa13,0xd,(LPARAM)lParam);
    }
    if ((code *)piVar6[3] != (code *)0x0) {
      (*(code *)piVar6[3])(0xd);
    }
    Ordinal_6();
    lpString = (LPCSTR)(lParam + 4);
    pCVar4 = lpString;
    if ((piVar6[1] != 0) && (lpString != (LPCSTR)0x0)) {
      pCVar4 = &stack0xffffffc0;
      iVar3 = lstrlenA(lpString);
      FUN_676b06a0();
      MultiByteToWideChar(0,0,(LPCSTR)(lParam + 4),-1,(LPWSTR)&stack0xffffffc0,iVar3 + 1);
    }
    uVar5 = Ordinal_2(pCVar4);
    *param_1 = uVar5;
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a5b1e at 676a5b1e

void __thiscall
FUN_676a5b1e(void *this,undefined4 *param_1,undefined4 *param_2,undefined4 *param_3,
            undefined4 *param_4,undefined4 param_5,undefined4 param_6,undefined4 param_7,
            short *param_8,undefined4 *param_9,short *param_10,int *param_11,int *param_12)

{
  int iVar1;
  int *piVar2;
  undefined2 *lParam;
  undefined4 uVar3;
  int iVar4;
  int *piVar5;
  undefined1 *puVar6;
  undefined2 local_c0 [4];
  short *local_b8;
  undefined2 local_b0;
  undefined4 *local_a8;
  undefined2 local_a0;
  short *local_98;
  undefined2 local_90;
  undefined4 local_88;
  undefined2 local_80;
  undefined4 local_78;
  undefined2 local_70;
  undefined4 local_68;
  undefined2 local_60;
  undefined4 *local_58;
  undefined2 local_50;
  undefined4 *local_48;
  undefined2 local_40;
  undefined4 *local_38;
  undefined2 local_30;
  undefined4 *local_28;
  undefined2 *local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  int *local_10;
  void *local_c;
  LPCRITICAL_SECTION local_8;
  
  piVar5 = param_12;
  piVar2 = param_11;
  puVar6 = (undefined1 *)0x0;
  local_c = this;
  if (*param_12 == 0) {
    local_10 = (int *)param_11[1];
    param_11 = local_10;
    if (local_10 == (int *)0x0) {
      param_11 = *(int **)((int)this + 0x28);
    }
    iVar4 = 0;
    if (0 < (int)param_11) {
      local_8 = (LPCRITICAL_SECTION)((-(uint)(this != (void *)0x0) & (int)this - 0xa8U) + 0x16c4);
      do {
        EnterCriticalSection(local_8);
        param_12 = (int *)0x0;
        if (local_10 == (int *)0x0) {
          piVar5 = (int *)FUN_676a7f2d((void *)((int)local_c + 4),iVar4);
        }
        else if ((iVar4 < 0) || (iVar1 = piVar2[1], iVar1 <= iVar4)) {
          piVar5 = (int *)0x0;
        }
        else {
          piVar5 = (int *)*piVar2;
          if (1 < iVar1) {
            piVar5 = (int *)piVar5[iVar4];
          }
        }
        FUN_6768fa93((int *)&param_12,piVar5);
        LeaveCriticalSection(local_8);
        if (param_12 != (int *)0x0) {
          local_28 = param_1;
          local_38 = param_2;
          local_48 = param_3;
          local_58 = param_4;
          local_68 = param_5;
          local_78 = param_6;
          local_88 = param_7;
          local_98 = param_8;
          local_a8 = param_9;
          local_b8 = param_10;
          local_20 = local_c0;
          local_30 = 0x4003;
          local_40 = 0x4008;
          local_50 = 0x4008;
          local_60 = 0x4003;
          local_70 = 0x4007;
          local_80 = 0x4007;
          local_90 = 0x4007;
          local_a0 = 0x400b;
          local_b0 = 0x4008;
          local_c0[0] = 0x400b;
          local_1c = 0;
          local_18 = 10;
          local_14 = 0;
          (**(code **)(*param_12 + 0x18))();
          if (param_12 != (int *)0x0) {
            (**(code **)(*param_12 + 8))();
          }
        }
        iVar4 = iVar4 + 1;
      } while (iVar4 < (int)param_11);
    }
  }
  else if ((param_12[2] != 0) || (param_12[3] != 0)) {
    if (param_12[1] == 0) {
      lParam = (undefined2 *)operator_new(0xc58);
      *lParam = 0xc58;
      *(int *)(lParam + 2) = *piVar5;
      *(undefined4 *)(lParam + 4) = *param_1;
      *(undefined4 *)(lParam + 0x50a) = *param_4;
      Ordinal_185();
      Ordinal_185();
      Ordinal_185();
      *(uint *)(lParam + 0x524) = (uint)(*param_8 != 0);
      *(uint *)(lParam + 0x62a) = (uint)(*param_10 != 0);
      if ((short *)*param_2 == (short *)0x0) {
        lParam[6] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 6,(short *)*param_2);
      }
      if ((short *)*param_3 == (short *)0x0) {
        lParam[0x10a] = 0;
      }
      else {
        FUN_676ae229(lParam + 0x10a,(short *)*param_3,0x400);
        lParam[0x509] = 0;
      }
      if ((short *)*param_9 == (short *)0x0) {
        lParam[0x526] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 0x526,(short *)*param_9);
      }
    }
    else {
      lParam = (undefined2 *)operator_new(0x650);
      *lParam = 0x650;
      *(int *)(lParam + 2) = *piVar5;
      *(undefined4 *)(lParam + 4) = *param_1;
      *(undefined4 *)(lParam + 0x288) = *param_4;
      Ordinal_185();
      Ordinal_185();
      Ordinal_185();
      *(uint *)(lParam + 0x2a2) = (uint)(*param_8 != 0);
      *(uint *)(lParam + 0x326) = (uint)(*param_10 != 0);
      FUN_676a2644((LPCWSTR)*param_2,(LPSTR)(lParam + 6),0x104);
      FUN_676a2644((LPCWSTR)*param_3,(LPSTR)(lParam + 0x88),0x400);
      FUN_676a2644((LPCWSTR)*param_9,(LPSTR)(lParam + 0x2a4),0x104);
    }
    if ((HWND)param_12[2] != (HWND)0x0) {
      SendMessageA((HWND)param_12[2],0xa13,0xe,(LPARAM)lParam);
    }
    if ((code *)param_12[3] != (code *)0x0) {
      (*(code *)param_12[3])();
    }
    Ordinal_6();
    Ordinal_6();
    Ordinal_6();
    iVar4 = param_12[1];
    *param_1 = *(undefined4 *)(lParam + 4);
    if (iVar4 == 0) {
      *param_4 = *(undefined4 *)(lParam + 0x50a);
      Ordinal_184();
      Ordinal_184();
      Ordinal_184();
      *param_8 = -(ushort)(*(int *)(lParam + 0x524) != 0);
      *param_10 = -(ushort)(*(int *)(lParam + 0x62a) != 0);
      uVar3 = Ordinal_2();
      *param_2 = uVar3;
      uVar3 = Ordinal_2();
      *param_3 = uVar3;
      uVar3 = Ordinal_2(lParam + 0x526);
      *param_9 = uVar3;
    }
    else {
      *param_4 = *(undefined4 *)(lParam + 0x288);
      Ordinal_184();
      Ordinal_184();
      Ordinal_184();
      *param_8 = -(ushort)(*(int *)(lParam + 0x2a2) != 0);
      *param_10 = -(ushort)(*(int *)(lParam + 0x326) != 0);
      if ((LPCSTR)(lParam + 6) != (LPCSTR)0x0) {
        iVar4 = lstrlenA((LPCSTR)(lParam + 6));
        FUN_676b06a0();
        MultiByteToWideChar(0,0,(LPCSTR)(lParam + 6),-1,(LPWSTR)&stack0xfffffeec,iVar4 + 1);
      }
      uVar3 = Ordinal_2();
      *param_2 = uVar3;
      if ((LPCSTR)(lParam + 0x88) != (LPCSTR)0x0) {
        iVar4 = lstrlenA((LPCSTR)(lParam + 0x88));
        FUN_676b06a0();
        MultiByteToWideChar(0,0,(LPCSTR)(lParam + 0x88),-1,(LPWSTR)&stack0xfffffee8,iVar4 + 1);
      }
      uVar3 = Ordinal_2();
      *param_3 = uVar3;
      if ((LPCSTR)(lParam + 0x2a4) != (LPCSTR)0x0) {
        puVar6 = &stack0xfffffee4;
        iVar4 = lstrlenA((LPCSTR)(lParam + 0x2a4));
        FUN_676b06a0();
        MultiByteToWideChar(0,0,(LPCSTR)(lParam + 0x2a4),-1,(LPWSTR)&stack0xfffffee4,iVar4 + 1);
      }
      uVar3 = Ordinal_2(puVar6);
      *param_9 = uVar3;
    }
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a60b1 at 676a60b1

void __thiscall
FUN_676a60b1(void *this,undefined4 param_1,LPCWSTR param_2,undefined2 *param_3,short *param_4,
            int *param_5,int *param_6)

{
  int *piVar1;
  undefined2 *lParam;
  int iVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  undefined2 local_60 [4];
  short *local_58;
  undefined2 local_50;
  undefined2 *local_48;
  undefined2 local_40;
  LPCWSTR local_38;
  undefined2 local_30;
  undefined4 local_28;
  undefined2 *local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  void *local_10;
  int *local_c;
  LPCRITICAL_SECTION local_8;
  
  piVar4 = param_6;
  piVar1 = param_5;
  local_10 = this;
  if (*param_6 == 0) {
    local_c = (int *)param_5[1];
    param_5 = local_c;
    if (local_c == (int *)0x0) {
      param_5 = *(int **)((int)this + 0x28);
    }
    iVar5 = 0;
    if (0 < (int)param_5) {
      local_8 = (LPCRITICAL_SECTION)((-(uint)(this != (void *)0x0) & (int)this - 0xa8U) + 0x16c4);
      do {
        EnterCriticalSection(local_8);
        param_6 = (int *)0x0;
        if (local_c == (int *)0x0) {
          piVar4 = (int *)FUN_676a7f2d((void *)((int)local_10 + 4),iVar5);
        }
        else if ((iVar5 < 0) || (iVar2 = piVar1[1], iVar2 <= iVar5)) {
          piVar4 = (int *)0x0;
        }
        else {
          piVar4 = (int *)*piVar1;
          if (1 < iVar2) {
            piVar4 = (int *)piVar4[iVar5];
          }
        }
        FUN_6768fa93((int *)&param_6,piVar4);
        LeaveCriticalSection(local_8);
        if (param_6 != (int *)0x0) {
          local_58 = param_4;
          local_28 = param_1;
          local_38 = param_2;
          local_48 = param_3;
          local_20 = local_60;
          local_60[0] = 0x400b;
          local_30 = 3;
          local_40 = 8;
          local_50 = 0x400c;
          local_1c = 0;
          local_18 = 4;
          local_14 = 0;
          (**(code **)(*param_6 + 0x18))(param_6,0x1773,&DAT_676bb4f0,0x400,1,&local_20,0,0,0);
          if (param_6 != (int *)0x0) {
            (**(code **)(*param_6 + 8))(param_6);
          }
        }
        iVar5 = iVar5 + 1;
      } while (iVar5 < (int)param_5);
    }
  }
  else if ((param_6[2] != 0) || (param_6[3] != 0)) {
    if (param_6[1] == 0) {
      lParam = (undefined2 *)operator_new(0x220);
      *lParam = 0x220;
      *(int *)(lParam + 2) = *piVar4;
      *(undefined4 *)(lParam + 4) = param_1;
      *(undefined4 *)(lParam + 0x10a) = 0;
      *(undefined4 *)(lParam + 0x10c) = 0;
      *(uint *)(lParam + 0x10e) = (uint)(*param_4 != 0);
      if (param_2 == (LPCWSTR)0x0) {
        lParam[6] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 6,param_2);
      }
    }
    else {
      lParam = (undefined2 *)operator_new(0x11c);
      *lParam = 0x11c;
      *(int *)(lParam + 2) = *piVar4;
      *(undefined4 *)(lParam + 4) = param_1;
      *(undefined4 *)(lParam + 0x88) = 0;
      *(undefined4 *)(lParam + 0x8a) = 0;
      *(uint *)(lParam + 0x8c) = (uint)(*param_4 != 0);
      FUN_676a2644(param_2,(LPSTR)(lParam + 6),0x104);
    }
    if ((HWND)piVar4[2] != (HWND)0x0) {
      SendMessageA((HWND)piVar4[2],0xa13,0xf,(LPARAM)lParam);
    }
    if ((code *)piVar4[3] != (code *)0x0) {
      (*(code *)piVar4[3])(0xf,lParam);
    }
    if (piVar4[1] == 0) {
      *param_4 = -(ushort)(*(int *)(lParam + 0x10e) != 0);
      iVar5 = *(int *)(lParam + 0x10c);
      iVar2 = *(int *)(lParam + 0x10a);
    }
    else {
      *param_4 = -(ushort)(*(int *)(lParam + 0x8c) != 0);
      iVar5 = *(int *)(lParam + 0x8a);
      iVar2 = *(int *)(lParam + 0x88);
    }
    FUN_676b0bb3((undefined *)lParam);
    param_6 = (int *)0x0;
    iVar3 = Ordinal_36(1,&param_6);
    if (-1 < iVar3) {
      *(undefined2 *)((int)param_6 + 2) = 0x10;
      param_6[1] = 1;
      param_6[4] = iVar5;
      param_6[5] = 0;
      param_6[3] = iVar2;
      *param_3 = 0x2011;
      *(int **)(param_3 + 4) = param_6;
    }
  }
  return;
}



// Function: FUN_676a6346 at 676a6346

void __thiscall
FUN_676a6346(void *this,LPCWSTR param_1,short *param_2,short param_3,int *param_4,int *param_5)

{
  int iVar1;
  int *piVar2;
  undefined2 *lParam;
  int *piVar3;
  int iVar4;
  undefined2 local_50 [4];
  short local_48;
  undefined2 local_40;
  short *local_38;
  undefined2 local_30;
  LPCWSTR local_28;
  undefined2 *local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  void *local_10;
  int *local_c;
  LPCRITICAL_SECTION local_8;
  
  piVar3 = param_5;
  piVar2 = param_4;
  local_10 = this;
  if (*param_5 == 0) {
    local_c = (int *)param_4[1];
    param_4 = local_c;
    if (local_c == (int *)0x0) {
      param_4 = *(int **)((int)this + 0x28);
    }
    iVar4 = 0;
    if (0 < (int)param_4) {
      local_8 = (LPCRITICAL_SECTION)((-(uint)(this != (void *)0x0) & (int)this - 0xa8U) + 0x16c4);
      do {
        EnterCriticalSection(local_8);
        param_5 = (int *)0x0;
        if (local_c == (int *)0x0) {
          piVar3 = (int *)FUN_676a7f2d((void *)((int)local_10 + 4),iVar4);
        }
        else if ((iVar4 < 0) || (iVar1 = piVar2[1], iVar1 <= iVar4)) {
          piVar3 = (int *)0x0;
        }
        else {
          piVar3 = (int *)*piVar2;
          if (1 < iVar1) {
            piVar3 = (int *)piVar3[iVar4];
          }
        }
        FUN_6768fa93((int *)&param_5,piVar3);
        LeaveCriticalSection(local_8);
        if (param_5 != (int *)0x0) {
          local_28 = param_1;
          local_38 = param_2;
          local_48 = param_3;
          local_20 = local_50;
          local_30 = 8;
          local_40 = 0x400c;
          local_50[0] = 0xb;
          local_1c = 0;
          local_18 = 3;
          local_14 = 0;
          (**(code **)(*param_5 + 0x18))(param_5,0x1776,&DAT_676bb4f0,0x400,1,&local_20,0,0,0);
          if (param_5 != (int *)0x0) {
            (**(code **)(*param_5 + 8))(param_5);
          }
        }
        iVar4 = iVar4 + 1;
      } while (iVar4 < (int)param_4);
    }
  }
  else if ((param_5[2] != 0) || (param_5[3] != 0)) {
    iVar4 = 0;
    param_5 = (int *)0x0;
    param_4 = (int *)0x0;
    if (*param_2 == 0x2011) {
      param_4 = *(int **)(param_2 + 4);
      Ordinal_23(param_4,&param_5);
      iVar4 = param_4[4];
    }
    if (piVar3[1] == 0) {
      lParam = (undefined2 *)operator_new(0x21c);
      *lParam = 0x21c;
      *(int *)(lParam + 2) = *piVar3;
      *(int *)(lParam + 0x10a) = iVar4;
      *(uint *)(lParam + 0x10c) = (uint)(param_3 != 0);
      *(int **)(lParam + 0x108) = param_5;
      if (param_1 != (LPCWSTR)0x0) {
        FUN_676ae1fc(lParam + 4,param_1);
      }
    }
    else {
      lParam = (undefined2 *)operator_new(0x118);
      *lParam = 0x118;
      *(int *)(lParam + 2) = *piVar3;
      *(int *)(lParam + 0x88) = iVar4;
      *(uint *)(lParam + 0x8a) = (uint)(param_3 != 0);
      *(int **)(lParam + 0x86) = param_5;
      FUN_676a2644(param_1,(LPSTR)(lParam + 4),0x104);
    }
    if ((HWND)piVar3[2] != (HWND)0x0) {
      SendMessageA((HWND)piVar3[2],0xa13,0x10,(LPARAM)lParam);
    }
    if ((code *)piVar3[3] != (code *)0x0) {
      (*(code *)piVar3[3])(0x10,lParam);
    }
    if (param_4 != (int *)0x0) {
      Ordinal_24(param_4);
    }
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a656e at 676a656e

void __thiscall
FUN_676a656e(void *this,LPCWSTR param_1,undefined4 param_2,int *param_3,int *param_4)

{
  int iVar1;
  int *piVar2;
  undefined2 *lParam;
  int *piVar3;
  int iVar4;
  undefined2 local_40 [4];
  undefined4 local_38;
  undefined2 local_30;
  LPCWSTR local_28;
  undefined2 *local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  void *local_10;
  int *local_c;
  LPCRITICAL_SECTION local_8;
  
  piVar3 = param_4;
  piVar2 = param_3;
  local_10 = this;
  if (*param_4 == 0) {
    local_c = (int *)param_3[1];
    param_3 = local_c;
    if (local_c == (int *)0x0) {
      param_3 = *(int **)((int)this + 0x28);
    }
    iVar4 = 0;
    if (0 < (int)param_3) {
      local_8 = (LPCRITICAL_SECTION)((-(uint)(this != (void *)0x0) & (int)this - 0xa8U) + 0x16c4);
      do {
        EnterCriticalSection(local_8);
        param_4 = (int *)0x0;
        if (local_c == (int *)0x0) {
          piVar3 = (int *)FUN_676a7f2d((void *)((int)local_10 + 4),iVar4);
        }
        else if ((iVar4 < 0) || (iVar1 = piVar2[1], iVar1 <= iVar4)) {
          piVar3 = (int *)0x0;
        }
        else {
          piVar3 = (int *)*piVar2;
          if (1 < iVar1) {
            piVar3 = (int *)piVar3[iVar4];
          }
        }
        FUN_6768fa93((int *)&param_4,piVar3);
        LeaveCriticalSection(local_8);
        if (param_4 != (int *)0x0) {
          local_28 = param_1;
          local_38 = param_2;
          local_20 = local_40;
          local_30 = 8;
          local_40[0] = 3;
          local_1c = 0;
          local_18 = 2;
          local_14 = 0;
          (**(code **)(*param_4 + 0x18))(param_4,0x17d7,&DAT_676bb4f0,0x400,1,&local_20,0,0,0);
          if (param_4 != (int *)0x0) {
            (**(code **)(*param_4 + 8))(param_4);
          }
        }
        iVar4 = iVar4 + 1;
      } while (iVar4 < (int)param_3);
    }
  }
  else if ((param_4[2] != 0) || (param_4[3] != 0)) {
    if (param_4[1] == 0) {
      lParam = (undefined2 *)operator_new(0x214);
      *lParam = 0x214;
      *(int *)(lParam + 2) = *piVar3;
      *(undefined4 *)(lParam + 0x108) = param_2;
      if (param_1 == (LPCWSTR)0x0) {
        lParam[4] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 4,param_1);
      }
    }
    else {
      lParam = (undefined2 *)operator_new(0x110);
      *lParam = 0x110;
      *(int *)(lParam + 2) = *piVar3;
      *(undefined4 *)(lParam + 0x86) = param_2;
      FUN_676a2644(param_1,(LPSTR)(lParam + 4),0x104);
    }
    if ((HWND)piVar3[2] != (HWND)0x0) {
      SendMessageA((HWND)piVar3[2],0xa13,0x11,(LPARAM)lParam);
    }
    if ((code *)piVar3[3] != (code *)0x0) {
      (*(code *)piVar3[3])(0x11,lParam);
    }
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a672d at 676a672d

void __thiscall
FUN_676a672d(void *this,LPCWSTR param_1,undefined4 *param_2,short *param_3,int *param_4,int *param_5
            )

{
  LPCSTR lpString;
  int iVar1;
  int *piVar2;
  undefined2 *lParam;
  int iVar3;
  LPCSTR pCVar4;
  undefined4 uVar5;
  int *piVar6;
  undefined2 local_50 [4];
  short *local_48;
  undefined2 local_40;
  undefined4 *local_38;
  undefined2 local_30;
  LPCWSTR local_28;
  undefined2 *local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  void *local_10;
  int *local_c;
  LPCRITICAL_SECTION local_8;
  
  piVar6 = param_5;
  piVar2 = param_4;
  local_10 = this;
  if (*param_5 == 0) {
    local_c = (int *)param_4[1];
    param_4 = local_c;
    if (local_c == (int *)0x0) {
      param_4 = *(int **)((int)this + 0x28);
    }
    iVar3 = 0;
    if (0 < (int)param_4) {
      local_8 = (LPCRITICAL_SECTION)((-(uint)(this != (void *)0x0) & (int)this - 0xa8U) + 0x16c4);
      do {
        EnterCriticalSection(local_8);
        param_5 = (int *)0x0;
        if (local_c == (int *)0x0) {
          piVar6 = (int *)FUN_676a7f2d((void *)((int)local_10 + 4),iVar3);
        }
        else if ((iVar3 < 0) || (iVar1 = piVar2[1], iVar1 <= iVar3)) {
          piVar6 = (int *)0x0;
        }
        else {
          piVar6 = (int *)*piVar2;
          if (1 < iVar1) {
            piVar6 = (int *)piVar6[iVar3];
          }
        }
        FUN_6768fa93((int *)&param_5,piVar6);
        LeaveCriticalSection(local_8);
        if (param_5 != (int *)0x0) {
          local_38 = param_2;
          local_48 = param_3;
          local_28 = param_1;
          local_20 = local_50;
          local_40 = 0x4008;
          local_50[0] = 0x400b;
          local_30 = 8;
          local_1c = 0;
          local_18 = 3;
          local_14 = 0;
          (**(code **)(*param_5 + 0x18))(param_5,0x183a,&DAT_676bb4f0,0x400,1,&local_20,0,0);
          if (param_5 != (int *)0x0) {
            (**(code **)(*param_5 + 8))();
          }
        }
        iVar3 = iVar3 + 1;
      } while (iVar3 < (int)param_4);
    }
  }
  else if ((param_5[2] != 0) || (param_5[3] != 0)) {
    if (param_5[1] == 0) {
      lParam = (undefined2 *)operator_new(0x41c);
      *lParam = 0x41c;
      *(int *)(lParam + 2) = *piVar6;
      *(uint *)(lParam + 0x20c) = (uint)(*param_3 != 0);
      if (param_1 == (LPCWSTR)0x0) {
        lParam[4] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 4,param_1);
      }
      if ((short *)*param_2 == (short *)0x0) {
        lParam[0x108] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 0x108,(short *)*param_2);
      }
    }
    else {
      lParam = (undefined2 *)operator_new(0x214);
      *lParam = 0x214;
      *(int *)(lParam + 2) = *piVar6;
      *(uint *)(lParam + 0x108) = (uint)(*param_3 != 0);
      FUN_676a2644(param_1,(LPSTR)(lParam + 4),0x104);
      FUN_676a2644((LPCWSTR)*param_2,(LPSTR)(lParam + 0x86),0x104);
    }
    if ((HWND)piVar6[2] != (HWND)0x0) {
      SendMessageA((HWND)piVar6[2],0xa13,0x12,(LPARAM)lParam);
    }
    if ((code *)piVar6[3] != (code *)0x0) {
      (*(code *)piVar6[3])(0x12);
    }
    Ordinal_6();
    if (piVar6[1] == 0) {
      *param_3 = -(ushort)(*(int *)(lParam + 0x20c) != 0);
      pCVar4 = (LPCSTR)(lParam + 0x108);
    }
    else {
      *param_3 = -(ushort)(*(int *)(lParam + 0x108) != 0);
      lpString = (LPCSTR)(lParam + 0x86);
      pCVar4 = lpString;
      if (lpString != (LPCSTR)0x0) {
        pCVar4 = &stack0xffffffa0;
        iVar3 = lstrlenA(lpString);
        FUN_676b06a0();
        MultiByteToWideChar(0,0,(LPCSTR)(lParam + 0x86),-1,(LPWSTR)&stack0xffffffa0,iVar3 + 1);
      }
    }
    uVar5 = Ordinal_2(pCVar4);
    *param_2 = uVar5;
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a69bc at 676a69bc

void __thiscall
FUN_676a69bc(int param_1,LPCWSTR param_2,LPCWSTR param_3,LPCWSTR param_4,LPCWSTR param_5,
            LPCWSTR param_6,undefined8 param_7,undefined8 param_8,undefined8 param_9,
            LPCWSTR param_10,LPCWSTR param_11,LPCWSTR param_12,undefined4 param_13,
            undefined8 param_14,undefined8 param_15,undefined8 param_16,short *param_17,
            int *param_18,int *param_19)

{
  char cVar1;
  undefined2 *lParam;
  int iVar2;
  int *piVar3;
  undefined2 local_13c [4];
  short *local_134;
  undefined2 local_12c;
  undefined8 local_124;
  undefined2 local_11c;
  undefined8 local_114;
  undefined2 local_10c;
  undefined8 local_104;
  undefined2 local_fc;
  undefined4 local_f4;
  undefined2 local_ec;
  LPCWSTR local_e4;
  undefined2 local_dc;
  LPCWSTR local_d4;
  undefined2 local_cc;
  undefined8 local_c4;
  undefined2 local_bc;
  undefined8 local_b4;
  undefined2 local_ac;
  undefined8 local_a4;
  undefined2 local_9c;
  undefined8 local_94;
  undefined2 local_8c;
  LPCWSTR local_84;
  undefined2 local_7c;
  LPCWSTR local_74;
  undefined2 local_6c;
  LPCWSTR local_64;
  undefined2 local_5c;
  LPCWSTR local_54;
  undefined2 local_4c;
  LPCWSTR local_44;
  undefined2 *local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 *local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  int local_1c;
  int local_18;
  uint local_14;
  int local_10;
  int *local_c;
  int local_8;
  
  local_1c = param_1;
  if (*param_19 == 0) {
    local_14 = -(uint)(param_1 != 0) & param_1 - 0xa8U;
    local_18 = param_18[1];
    local_10 = local_18;
    if (local_18 == 0) {
      local_10 = *(int *)(param_1 + 0x28);
    }
    local_8 = 0;
    if (0 < local_10) {
      do {
        EnterCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        local_c = (int *)0x0;
        if (local_18 == 0) {
          piVar3 = (int *)FUN_676a7f2d((void *)(local_1c + 4),local_8);
        }
        else if ((local_8 < 0) || (param_18[1] <= local_8)) {
          piVar3 = (int *)0x0;
        }
        else {
          piVar3 = (int *)*param_18;
          if (1 < param_18[1]) {
            piVar3 = (int *)piVar3[local_8];
          }
        }
        FUN_6768fa93((int *)&local_c,piVar3);
        cVar1 = *(char *)(local_14 + 0x1814);
        LeaveCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        if (local_c != (int *)0x0) {
          local_13c[0] = 0x400b;
          local_134 = param_17;
          local_12c = 7;
          local_fc = 3;
          if (cVar1 == '\0') {
            local_64 = param_2;
            local_6c = 8;
            local_74 = param_3;
            if (param_5 == (LPCWSTR)0x0) {
              local_84 = param_4;
            }
            else {
              local_84 = (LPCWSTR)0xffffffff;
            }
            local_a4 = param_7;
            local_94 = CONCAT44(local_94._4_4_,param_6);
            local_b4 = param_8;
            local_9c = 3;
            local_c4 = param_9;
            local_d4 = param_10;
            if (param_12 == (LPCWSTR)0x0) {
              local_e4 = param_11;
            }
            else {
              local_e4 = (LPCWSTR)0xffffffff;
            }
            local_3c = local_13c;
            iVar2 = *local_c;
            local_38 = 0;
            local_34 = 0xe;
            local_30 = 0;
            local_cc = local_12c;
          }
          else {
            local_44 = param_2;
            local_94 = param_7;
            local_54 = param_3;
            local_a4 = param_8;
            local_64 = param_4;
            local_b4 = param_9;
            local_74 = param_5;
            local_84 = param_6;
            local_c4 = CONCAT44(local_c4._4_4_,param_10);
            local_d4 = param_11;
            local_e4 = param_12;
            local_2c = local_13c;
            local_4c = 8;
            local_5c = 8;
            local_cc = 8;
            iVar2 = *local_c;
            local_28 = 0;
            local_24 = 0x10;
            local_20 = 0;
            local_9c = local_12c;
            local_6c = local_fc;
          }
          local_f4 = param_13;
          local_104 = param_14;
          local_114 = param_15;
          local_124 = param_16;
          local_11c = local_12c;
          local_10c = local_12c;
          local_ec = local_fc;
          local_dc = local_6c;
          local_bc = local_12c;
          local_ac = local_12c;
          local_8c = local_fc;
          local_7c = local_6c;
          (**(code **)(iVar2 + 0x18))(local_c);
          if (local_c != (int *)0x0) {
            (**(code **)(*local_c + 8))(local_c);
          }
        }
        local_8 = local_8 + 1;
      } while (local_8 < local_10);
    }
  }
  else if ((param_19[2] != 0) || (param_19[3] != 0)) {
    if (param_19[1] == 0) {
      lParam = (undefined2 *)operator_new(0xc94);
      *lParam = 0xc94;
      *(int *)(lParam + 2) = *param_19;
      *(LPCWSTR *)(lParam + 0x508) = param_4;
      *(LPCWSTR *)(lParam + 0x50a) = param_6;
      Ordinal_185(param_7,lParam + 0x50c);
      Ordinal_185(param_8,lParam + 0x514);
      Ordinal_185(param_9,lParam + 0x51c);
      *(LPCWSTR *)(lParam + 0x628) = param_11;
      *(undefined4 *)(lParam + 0x62a) = param_13;
      *(LPCWSTR *)(lParam + 0x646) = param_5;
      *(LPCWSTR *)(lParam + 0x648) = param_12;
      Ordinal_185(param_14,lParam + 0x62c);
      Ordinal_185(param_15,lParam + 0x634);
      Ordinal_185(param_16,lParam + 0x63c);
      *(uint *)(lParam + 0x644) = (uint)(*param_17 != 0);
      if (param_2 == (LPCWSTR)0x0) {
        lParam[4] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 4,param_2);
      }
      if (param_3 == (LPCWSTR)0x0) {
        lParam[0x108] = 0;
      }
      else {
        FUN_676ae229(lParam + 0x108,param_3,0x400);
        lParam[0x507] = 0;
      }
      if (param_10 == (LPCWSTR)0x0) {
        lParam[0x524] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 0x524,param_10);
      }
    }
    else {
      lParam = (undefined2 *)operator_new(0x68c);
      *lParam = 0x68c;
      *(int *)(lParam + 2) = *param_19;
      *(LPCWSTR *)(lParam + 0x286) = param_4;
      *(LPCWSTR *)(lParam + 0x288) = param_6;
      Ordinal_185(param_7,lParam + 0x28a);
      Ordinal_185(param_8,lParam + 0x292);
      Ordinal_185(param_9,lParam + 0x29a);
      *(LPCWSTR *)(lParam + 0x324) = param_11;
      *(undefined4 *)(lParam + 0x326) = param_13;
      *(LPCWSTR *)(lParam + 0x342) = param_5;
      *(LPCWSTR *)(lParam + 0x344) = param_12;
      Ordinal_185(param_14,lParam + 0x328);
      Ordinal_185(param_15,lParam + 0x330);
      Ordinal_185(param_16,lParam + 0x338);
      *(uint *)(lParam + 0x340) = (uint)(*param_17 != 0);
      FUN_676a2644(param_2,(LPSTR)(lParam + 4),0x104);
      FUN_676a2644(param_3,(LPSTR)(lParam + 0x86),0x400);
      FUN_676a2644(param_10,(LPSTR)(lParam + 0x2a2),0x104);
    }
    if ((HWND)param_19[2] != (HWND)0x0) {
      SendMessageA((HWND)param_19[2],0xa13,0x13,(LPARAM)lParam);
    }
    if ((code *)param_19[3] != (code *)0x0) {
      (*(code *)param_19[3])(0x13,lParam);
    }
    if (param_19[1] == 0) {
      iVar2 = *(int *)(lParam + 0x644);
    }
    else {
      iVar2 = *(int *)(lParam + 0x340);
    }
    *param_17 = -(ushort)(iVar2 != 0);
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a6f8f at 676a6f8f

void __thiscall
FUN_676a6f8f(void *this,undefined4 param_1,undefined4 param_2,undefined2 param_3,int *param_4,
            int *param_5)

{
  int iVar1;
  int *piVar2;
  undefined2 *lParam;
  int *piVar3;
  undefined2 local_54 [4];
  undefined2 local_4c;
  undefined2 local_44;
  undefined4 local_3c;
  undefined2 local_34;
  undefined4 local_2c;
  undefined2 *local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  void *local_14;
  int local_10;
  LPCRITICAL_SECTION local_c;
  int local_8;
  
  piVar3 = param_5;
  piVar2 = param_4;
  local_14 = this;
  if (*param_5 == 0) {
    local_10 = param_4[1];
    local_8 = local_10;
    if (local_10 == 0) {
      local_8 = *(int *)((int)this + 0x28);
    }
    param_5 = (int *)0x0;
    if (0 < local_8) {
      local_c = (LPCRITICAL_SECTION)((-(uint)(this != (void *)0x0) & (int)this - 0xa8U) + 0x16c4);
      do {
        EnterCriticalSection(local_c);
        param_4 = (int *)0x0;
        if (local_10 == 0) {
          piVar3 = (int *)FUN_676a7f2d((void *)((int)local_14 + 4),(int)param_5);
        }
        else if (((int)param_5 < 0) || (iVar1 = piVar2[1], iVar1 <= (int)param_5)) {
          piVar3 = (int *)0x0;
        }
        else {
          piVar3 = (int *)*piVar2;
          if (1 < iVar1) {
            piVar3 = (int *)piVar3[(int)param_5];
          }
        }
        FUN_6768fa93((int *)&param_4,piVar3);
        LeaveCriticalSection(local_c);
        if (param_4 != (int *)0x0) {
          local_2c = param_1;
          local_3c = param_2;
          local_4c = param_3;
          local_24 = local_54;
          local_44 = 3;
          local_54[0] = 2;
          local_20 = 0;
          local_1c = 3;
          local_18 = 0;
          local_34 = local_44;
          (**(code **)(*param_4 + 0x18))(param_4,0x17d8,&DAT_676bb4f0,0x400,1,&local_24,0,0,0);
          if (param_4 != (int *)0x0) {
            (**(code **)(*param_4 + 8))(param_4);
          }
        }
        param_5 = (int *)((int)param_5 + 1);
      } while ((int)param_5 < local_8);
    }
  }
  else if ((param_5[2] != 0) || (param_5[3] != 0)) {
    lParam = (undefined2 *)operator_new(0x14);
    *lParam = 0x14;
    *(int *)(lParam + 2) = *piVar3;
    *(undefined4 *)(lParam + 4) = param_1;
    *(undefined4 *)(lParam + 6) = param_2;
    lParam[8] = param_3;
    if ((HWND)piVar3[2] != (HWND)0x0) {
      SendMessageA((HWND)piVar3[2],0xa13,0x14,(LPARAM)lParam);
    }
    if ((code *)piVar3[3] != (code *)0x0) {
      (*(code *)piVar3[3])(0x14,lParam);
    }
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a710e at 676a710e

void __thiscall
FUN_676a710e(void *this,LPCWSTR param_1,LPCWSTR param_2,LPCWSTR param_3,undefined4 param_4,
            undefined8 param_5,undefined8 param_6,undefined8 param_7,short *param_8,int *param_9,
            int *param_10)

{
  char cVar1;
  undefined2 *lParam;
  int iVar2;
  int *piVar3;
  undefined2 local_bc [4];
  short *local_b4;
  undefined2 local_ac;
  undefined8 local_a4;
  undefined2 local_9c;
  undefined8 local_94;
  undefined2 local_8c;
  undefined8 local_84;
  undefined2 local_7c;
  undefined4 local_74;
  undefined2 local_6c;
  LPCWSTR local_64;
  undefined2 local_5c;
  LPCWSTR local_54;
  undefined2 local_4c;
  LPCWSTR local_44;
  undefined2 *local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 *local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  void *local_1c;
  int local_18;
  uint local_14;
  int local_10;
  int *local_c;
  int local_8;
  
  local_1c = this;
  if (*param_10 == 0) {
    local_14 = -(uint)(this != (void *)0x0) & (int)this - 0xa8U;
    local_18 = param_9[1];
    local_10 = local_18;
    if (local_18 == 0) {
      local_10 = *(int *)((int)this + 0x28);
    }
    local_8 = 0;
    if (0 < local_10) {
      do {
        EnterCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        local_c = (int *)0x0;
        if (local_18 == 0) {
          piVar3 = (int *)FUN_676a7f2d((void *)((int)local_1c + 4),local_8);
        }
        else if ((local_8 < 0) || (param_9[1] <= local_8)) {
          piVar3 = (int *)0x0;
        }
        else {
          piVar3 = (int *)*param_9;
          if (1 < param_9[1]) {
            piVar3 = (int *)piVar3[local_8];
          }
        }
        FUN_6768fa93((int *)&local_c,piVar3);
        cVar1 = *(char *)(local_14 + 0x1814);
        LeaveCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        if (local_c != (int *)0x0) {
          local_bc[0] = 0x400b;
          local_b4 = param_8;
          local_ac = 7;
          if (cVar1 == '\0') {
            local_5c = 8;
            local_54 = param_1;
            if (param_3 == (LPCWSTR)0x0) {
              local_64 = param_2;
            }
            else {
              local_64 = (LPCWSTR)0xffffffff;
            }
            local_3c = local_bc;
            iVar2 = *local_c;
            local_38 = 0;
            local_34 = 7;
            local_30 = 0;
          }
          else {
            local_44 = param_1;
            local_54 = param_2;
            local_64 = param_3;
            local_2c = local_bc;
            local_4c = 8;
            local_5c = 3;
            local_24 = 8;
            iVar2 = *local_c;
            local_28 = 0;
            local_20 = 0;
          }
          local_6c = 3;
          local_74 = param_4;
          local_7c = 3;
          local_84 = param_5;
          local_94 = param_6;
          local_a4 = param_7;
          local_9c = local_ac;
          local_8c = local_ac;
          (**(code **)(iVar2 + 0x18))(local_c);
          if (local_c != (int *)0x0) {
            (**(code **)(*local_c + 8))(local_c);
          }
        }
        local_8 = local_8 + 1;
      } while (local_8 < local_10);
    }
  }
  else if ((param_10[2] != 0) || (param_10[3] != 0)) {
    if (param_10[1] == 0) {
      lParam = (undefined2 *)operator_new(0x250);
      *lParam = 0x250;
      *(int *)(lParam + 2) = *param_10;
      *(LPCWSTR *)(lParam + 0x108) = param_2;
      *(undefined4 *)(lParam + 0x10a) = param_4;
      *(LPCWSTR *)(lParam + 0x126) = param_3;
      Ordinal_185(param_5,lParam + 0x10c);
      Ordinal_185(param_6,lParam + 0x114);
      Ordinal_185(param_7,lParam + 0x11c);
      *(uint *)(lParam + 0x124) = (uint)(*param_8 != 0);
      if (param_1 == (LPCWSTR)0x0) {
        lParam[4] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 4,param_1);
      }
    }
    else {
      lParam = (undefined2 *)operator_new(0x14c);
      *lParam = 0x14c;
      *(int *)(lParam + 2) = *param_10;
      *(LPCWSTR *)(lParam + 0x86) = param_2;
      *(undefined4 *)(lParam + 0x88) = param_4;
      *(LPCWSTR *)(lParam + 0xa4) = param_3;
      Ordinal_185(param_5,lParam + 0x8a);
      Ordinal_185(param_6,lParam + 0x92);
      Ordinal_185(param_7,lParam + 0x9a);
      *(uint *)(lParam + 0xa2) = (uint)(*param_8 != 0);
      FUN_676a2644(param_1,(LPSTR)(lParam + 4),0x104);
    }
    if ((HWND)param_10[2] != (HWND)0x0) {
      SendMessageA((HWND)param_10[2],0xa13,0x15,(LPARAM)lParam);
    }
    if ((code *)param_10[3] != (code *)0x0) {
      (*(code *)param_10[3])(0x15,lParam);
    }
    if (param_10[1] == 0) {
      iVar2 = *(int *)(lParam + 0x124);
    }
    else {
      iVar2 = *(int *)(lParam + 0xa2);
    }
    *param_8 = -(ushort)(iVar2 != 0);
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a74c7 at 676a74c7

void __thiscall
FUN_676a74c7(void *this,LPCWSTR param_1,undefined4 *param_2,LPCWSTR param_3,undefined4 *param_4,
            LPCWSTR param_5,undefined4 *param_6,undefined4 *param_7,undefined4 *param_8,
            undefined4 param_9,undefined4 param_10,undefined4 param_11,undefined4 param_12,
            undefined4 param_13,short param_14,undefined4 param_15,short *param_16,
            undefined4 param_17,short param_18,int *param_19,int *param_20)

{
  char cVar1;
  undefined2 *lParam;
  undefined4 uVar2;
  int iVar3;
  int *piVar4;
  undefined1 *puVar5;
  undefined2 local_15c [4];
  short local_154;
  undefined2 local_14c;
  undefined4 local_144;
  undefined2 local_13c;
  short *local_134;
  undefined2 local_12c;
  undefined4 local_124;
  undefined2 local_11c;
  short local_114;
  undefined2 local_10c;
  undefined4 local_104;
  undefined2 local_fc;
  undefined4 local_f4;
  undefined2 local_ec;
  undefined4 local_e4;
  undefined2 local_dc;
  undefined4 local_d4;
  undefined2 local_cc;
  undefined4 local_c4;
  undefined2 local_bc;
  undefined4 *local_b4;
  undefined2 local_ac;
  undefined4 *local_a4;
  undefined2 local_9c;
  undefined4 *local_94;
  undefined2 local_8c;
  LPCWSTR local_84;
  undefined2 local_7c;
  undefined4 *local_74;
  undefined2 local_6c;
  LPCWSTR local_64;
  undefined2 local_5c;
  undefined4 *local_54;
  undefined2 local_4c;
  LPCWSTR local_44;
  undefined2 *local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 *local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  void *local_1c;
  int local_18;
  uint local_14;
  int local_10;
  int *local_c;
  int local_8;
  
  local_1c = this;
  if (*param_20 == 0) {
    local_14 = -(uint)(this != (void *)0x0) & (int)this - 0xa8U;
    local_18 = param_19[1];
    local_10 = local_18;
    if (local_18 == 0) {
      local_10 = *(int *)((int)this + 0x28);
    }
    local_8 = 0;
    if (0 < local_10) {
      do {
        EnterCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        local_c = (int *)0x0;
        if (local_18 == 0) {
          piVar4 = (int *)FUN_676a7f2d((void *)((int)local_1c + 4),local_8);
        }
        else if ((local_8 < 0) || (param_19[1] <= local_8)) {
          piVar4 = (int *)0x0;
        }
        else {
          piVar4 = (int *)*param_19;
          if (1 < param_19[1]) {
            piVar4 = (int *)piVar4[local_8];
          }
        }
        FUN_6768fa93((int *)&local_c,piVar4);
        cVar1 = *(char *)(local_14 + 0x1814);
        LeaveCriticalSection((LPCRITICAL_SECTION)(local_14 + 0x16c4));
        if (local_c != (int *)0x0) {
          local_14c = 3;
          if (cVar1 == '\0') {
            local_74 = param_2;
            local_84 = param_3;
            local_7c = 0x4008;
            local_6c = 8;
            local_64 = param_1;
            if (param_5 == (LPCWSTR)0x0) {
              local_94 = param_4;
            }
            else {
              local_94 = (undefined4 *)0xffffffff;
            }
            if (param_7 == (undefined4 *)0x0) {
              local_a4 = param_6;
            }
            else {
              local_a4 = (undefined4 *)0xffffffff;
            }
            local_3c = local_15c;
            iVar3 = *local_c;
            local_38 = 0;
            local_34 = 0x10;
            local_30 = 0;
          }
          else {
            local_54 = param_2;
            local_64 = param_3;
            local_44 = param_1;
            local_74 = param_4;
            local_84 = param_5;
            local_94 = param_6;
            local_a4 = param_7;
            local_2c = local_15c;
            local_5c = 0x4008;
            local_6c = 0x4008;
            local_4c = 8;
            iVar3 = *local_c;
            local_28 = 0;
            local_24 = 0x12;
            local_20 = 0;
            local_7c = local_14c;
          }
          local_b4 = param_8;
          local_bc = 0x4003;
          local_c4 = param_9;
          local_d4 = param_10;
          local_dc = 0x4007;
          local_e4 = param_11;
          local_ec = 0x4007;
          local_f4 = param_12;
          local_fc = 0x4007;
          local_104 = param_13;
          local_114 = param_14;
          local_11c = 0xb;
          local_124 = param_15;
          local_134 = param_16;
          local_13c = 0x400b;
          local_144 = param_17;
          local_154 = param_18;
          local_15c[0] = 0xb;
          local_12c = local_14c;
          local_10c = local_14c;
          local_cc = local_14c;
          local_ac = local_14c;
          local_9c = local_14c;
          local_8c = local_7c;
          (**(code **)(iVar3 + 0x18))();
          if (local_c != (int *)0x0) {
            (**(code **)(*local_c + 8))();
          }
        }
        local_8 = local_8 + 1;
      } while (local_8 < local_10);
    }
  }
  else if ((param_20[2] != 0) || (param_20[3] != 0)) {
    if (param_20[1] == 0) {
      lParam = (undefined2 *)operator_new(0xc78);
      *lParam = 0xc78;
      *(int *)(lParam + 2) = *param_20;
      *(undefined4 **)(lParam + 0x60c) = param_4;
      *(undefined4 **)(lParam + 0x60e) = param_6;
      *(undefined4 *)(lParam + 0x610) = *param_8;
      *(undefined4 *)(lParam + 0x612) = param_9;
      *(LPCWSTR *)(lParam + 0x638) = param_5;
      *(undefined4 **)(lParam + 0x63a) = param_7;
      Ordinal_185();
      Ordinal_185();
      Ordinal_185();
      *(undefined4 *)(lParam + 0x62c) = param_13;
      *(uint *)(lParam + 0x62e) = (uint)(param_14 != 0);
      *(undefined4 *)(lParam + 0x630) = param_15;
      *(uint *)(lParam + 0x632) = (uint)(*param_16 != 0);
      *(undefined4 *)(lParam + 0x634) = param_17;
      *(uint *)(lParam + 0x636) = (uint)(param_18 != 0);
      if (param_1 == (LPCWSTR)0x0) {
        lParam[4] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 4,param_1);
      }
      if ((short *)*param_2 == (short *)0x0) {
        lParam[0x108] = 0;
      }
      else {
        FUN_676ae229(lParam + 0x108,(short *)*param_2,0x400);
        lParam[0x507] = 0;
      }
      if (*(short **)param_3 == (short *)0x0) {
        lParam[0x508] = 0;
      }
      else {
        FUN_676ae1fc(lParam + 0x508,*(short **)param_3);
      }
    }
    else {
      lParam = (undefined2 *)operator_new(0x670);
      *lParam = 0x670;
      *(int *)(lParam + 2) = *param_20;
      *(undefined4 **)(lParam + 0x308) = param_4;
      *(undefined4 **)(lParam + 0x30a) = param_6;
      *(undefined4 *)(lParam + 0x30c) = *param_8;
      *(undefined4 *)(lParam + 0x30e) = param_9;
      *(LPCWSTR *)(lParam + 0x334) = param_5;
      *(undefined4 **)(lParam + 0x336) = param_7;
      Ordinal_185();
      Ordinal_185();
      Ordinal_185();
      *(undefined4 *)(lParam + 0x328) = param_13;
      *(uint *)(lParam + 0x32a) = (uint)(param_14 != 0);
      *(undefined4 *)(lParam + 0x32c) = param_15;
      *(uint *)(lParam + 0x32e) = (uint)(*param_16 != 0);
      *(undefined4 *)(lParam + 0x330) = param_17;
      *(uint *)(lParam + 0x332) = (uint)(param_18 != 0);
      FUN_676a2644(param_1,(LPSTR)(lParam + 4),0x104);
      FUN_676a2644((LPCWSTR)*param_2,(LPSTR)(lParam + 0x86),0x400);
      FUN_676a2644(*(LPCWSTR *)param_3,(LPSTR)(lParam + 0x286),0x104);
    }
    if ((HWND)param_20[2] != (HWND)0x0) {
      SendMessageA((HWND)param_20[2],0xa13,0x16,(LPARAM)lParam);
    }
    if ((code *)param_20[3] != (code *)0x0) {
      (*(code *)param_20[3])();
    }
    Ordinal_6();
    Ordinal_6();
    if (param_20[1] == 0) {
      *param_8 = *(undefined4 *)(lParam + 0x610);
      Ordinal_184();
      Ordinal_184();
      Ordinal_184();
      *param_16 = -(ushort)(*(int *)(lParam + 0x632) != 0);
      uVar2 = Ordinal_2();
      *param_2 = uVar2;
      uVar2 = Ordinal_2(lParam + 0x508);
      *(undefined4 *)param_3 = uVar2;
    }
    else {
      *param_8 = *(undefined4 *)(lParam + 0x30c);
      Ordinal_184();
      Ordinal_184();
      Ordinal_184();
      *param_16 = -(ushort)(*(int *)(lParam + 0x32e) != 0);
      if ((LPCSTR)(lParam + 0x86) != (LPCSTR)0x0) {
        iVar3 = lstrlenA((LPCSTR)(lParam + 0x86));
        FUN_676b06a0();
        MultiByteToWideChar(0,0,(LPCSTR)(lParam + 0x86),-1,(LPWSTR)&stack0xfffffe54,iVar3 + 1);
      }
      uVar2 = Ordinal_2();
      *param_2 = uVar2;
      if ((LPCSTR)(lParam + 0x286) == (LPCSTR)0x0) {
        puVar5 = (undefined1 *)0x0;
      }
      else {
        puVar5 = &stack0xfffffe50;
        iVar3 = lstrlenA((LPCSTR)(lParam + 0x286));
        FUN_676b06a0();
        MultiByteToWideChar(0,0,(LPCSTR)(lParam + 0x286),-1,(LPWSTR)&stack0xfffffe50,iVar3 + 1);
      }
      uVar2 = Ordinal_2(puVar5);
      *(undefined4 *)param_3 = uVar2;
    }
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a7c83 at 676a7c83

void __thiscall FUN_676a7c83(void *this,undefined2 param_1,int *param_2,int *param_3)

{
  int iVar1;
  int *piVar2;
  undefined2 *lParam;
  int *piVar3;
  int iVar4;
  undefined2 local_30 [4];
  undefined2 local_28;
  undefined2 *local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  void *local_10;
  int *local_c;
  LPCRITICAL_SECTION local_8;
  
  piVar3 = param_3;
  piVar2 = param_2;
  local_10 = this;
  if (*param_3 == 0) {
    local_c = (int *)param_2[1];
    param_2 = local_c;
    if (local_c == (int *)0x0) {
      param_2 = *(int **)((int)this + 0x28);
    }
    iVar4 = 0;
    if (0 < (int)param_2) {
      local_8 = (LPCRITICAL_SECTION)((-(uint)(this != (void *)0x0) & (int)this - 0xa8U) + 0x16c4);
      do {
        EnterCriticalSection(local_8);
        param_3 = (int *)0x0;
        if (local_c == (int *)0x0) {
          piVar3 = (int *)FUN_676a7f2d((void *)((int)local_10 + 4),iVar4);
        }
        else if ((iVar4 < 0) || (iVar1 = piVar2[1], iVar1 <= iVar4)) {
          piVar3 = (int *)0x0;
        }
        else {
          piVar3 = (int *)*piVar2;
          if (1 < iVar1) {
            piVar3 = (int *)piVar3[iVar4];
          }
        }
        FUN_6768fa93((int *)&param_3,piVar3);
        LeaveCriticalSection(local_8);
        if (param_3 != (int *)0x0) {
          local_28 = param_1;
          local_20 = local_30;
          local_30[0] = 2;
          local_1c = 0;
          local_18 = 1;
          local_14 = 0;
          (**(code **)(*param_3 + 0x18))(param_3,0x17dc,&DAT_676bb4f0,0x400,1,&local_20,0,0,0);
          if (param_3 != (int *)0x0) {
            (**(code **)(*param_3 + 8))(param_3);
          }
        }
        iVar4 = iVar4 + 1;
      } while (iVar4 < (int)param_2);
    }
  }
  else if ((param_3[2] != 0) || (param_3[3] != 0)) {
    lParam = (undefined2 *)operator_new(0xc);
    *lParam = 0xc;
    *(int *)(lParam + 2) = *piVar3;
    lParam[4] = param_1;
    if ((HWND)piVar3[2] != (HWND)0x0) {
      SendMessageA((HWND)piVar3[2],0xa13,0x17,(LPARAM)lParam);
    }
    if ((code *)piVar3[3] != (code *)0x0) {
      (*(code *)piVar3[3])(0x17,lParam);
    }
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a7dd8 at 676a7dd8

void __thiscall FUN_676a7dd8(void *this,undefined2 param_1,int *param_2,int *param_3)

{
  int iVar1;
  int *piVar2;
  undefined2 *lParam;
  int *piVar3;
  int iVar4;
  undefined2 local_30 [4];
  undefined2 local_28;
  undefined2 *local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  void *local_10;
  int *local_c;
  LPCRITICAL_SECTION local_8;
  
  piVar3 = param_3;
  piVar2 = param_2;
  local_10 = this;
  if (*param_3 == 0) {
    local_c = (int *)param_2[1];
    param_2 = local_c;
    if (local_c == (int *)0x0) {
      param_2 = *(int **)((int)this + 0x28);
    }
    iVar4 = 0;
    if (0 < (int)param_2) {
      local_8 = (LPCRITICAL_SECTION)((-(uint)(this != (void *)0x0) & (int)this - 0xa8U) + 0x16c4);
      do {
        EnterCriticalSection(local_8);
        param_3 = (int *)0x0;
        if (local_c == (int *)0x0) {
          piVar3 = (int *)FUN_676a7f2d((void *)((int)local_10 + 4),iVar4);
        }
        else if ((iVar4 < 0) || (iVar1 = piVar2[1], iVar1 <= iVar4)) {
          piVar3 = (int *)0x0;
        }
        else {
          piVar3 = (int *)*piVar2;
          if (1 < iVar1) {
            piVar3 = (int *)piVar3[iVar4];
          }
        }
        FUN_6768fa93((int *)&param_3,piVar3);
        LeaveCriticalSection(local_8);
        if (param_3 != (int *)0x0) {
          local_28 = param_1;
          local_20 = local_30;
          local_30[0] = 2;
          local_1c = 0;
          local_18 = 1;
          local_14 = 0;
          (**(code **)(*param_3 + 0x18))(param_3,0x17dd,&DAT_676bb4f0,0x400,1,&local_20,0,0,0);
          if (param_3 != (int *)0x0) {
            (**(code **)(*param_3 + 8))(param_3);
          }
        }
        iVar4 = iVar4 + 1;
      } while (iVar4 < (int)param_2);
    }
  }
  else if ((param_3[2] != 0) || (param_3[3] != 0)) {
    lParam = (undefined2 *)operator_new(0xc);
    *lParam = 0xc;
    *(int *)(lParam + 2) = *piVar3;
    lParam[4] = param_1;
    if ((HWND)piVar3[2] != (HWND)0x0) {
      SendMessageA((HWND)piVar3[2],0xa13,0x18,(LPARAM)lParam);
    }
    if ((code *)piVar3[3] != (code *)0x0) {
      (*(code *)piVar3[3])(0x18,lParam);
    }
    FUN_676b0bb3((undefined *)lParam);
  }
  return;
}



// Function: FUN_676a7f2d at 676a7f2d

int __thiscall FUN_676a7f2d(void *this,int param_1)

{
  LPCRITICAL_SECTION lpCriticalSection;
  undefined4 uVar1;
  void *local_8;
  
  lpCriticalSection = (LPCRITICAL_SECTION)((int)this + 4);
  local_8 = this;
  EnterCriticalSection(lpCriticalSection);
  if (((param_1 < 0) || (*(int *)((int)this + 0x24) <= param_1)) ||
     (*(int *)((int)this + 0x28) == 0)) {
    LeaveCriticalSection(lpCriticalSection);
    local_8 = (void *)0x0;
  }
  else {
    if (*(int *)((int)this + 0x24) < 2) {
      uVar1 = *(undefined4 *)((int)this + 0x20);
    }
    else {
      uVar1 = *(undefined4 *)(*(int *)((int)this + 0x20) + param_1 * 4);
    }
    LeaveCriticalSection(lpCriticalSection);
    (**(code **)(**(int **)((int)this + 0x28) + 0x14))
              (*(int **)((int)this + 0x28),uVar1,&DAT_676baae8,&local_8);
  }
  return (int)local_8;
}



// Function: FUN_676a7f93 at 676a7f93

void __fastcall FUN_676a7f93(undefined4 *param_1)

{
  *param_1 = &PTR_LAB_676ba8dc;
  param_1[1] = 1;
  InterlockedDecrement(&DAT_676c559c);
  FUN_676a80ad((int)param_1);
  return;
}



// Function: FUN_676a7fef at 676a7fef

void FUN_676a7fef(undefined4 param_1,undefined4 param_2,undefined4 *param_3,int param_4,int *param_5
                 ,int param_6)

{
  FUN_67690c6e(&PTR_DAT_676c1cf8,param_2,param_3,param_4,param_5,param_6);
  return;
}



// Function: FUN_676a800f at 676a800f

void FUN_676a800f(undefined4 param_1,undefined4 param_2,undefined4 param_3,int *param_4,
                 undefined4 param_5,undefined4 param_6,undefined4 param_7,undefined4 param_8,
                 undefined4 param_9)

{
  if ((DAT_676c1d04 == (int *)0x0) &&
     (FUN_67691000(&PTR_DAT_676c1cf8,param_4), DAT_676c1d04 == (int *)0x0)) {
    return;
  }
  (**(code **)(*DAT_676c1d04 + 0x2c))
            (DAT_676c1d04,param_1,param_2,param_5,param_6,param_7,param_8,param_9);
  return;
}



// Function: FUN_676a8065 at 676a8065

LONG FUN_676a8065(undefined4 *param_1)

{
  LONG LVar1;
  
  LVar1 = InterlockedDecrement(param_1 + 1);
  if ((LVar1 == 0) && (param_1 != (undefined4 *)0x0)) {
    FUN_676a7f93(param_1);
    FUN_676b0bb3((undefined *)param_1);
  }
  return LVar1;
}



// Function: FUN_676a80ad at 676a80ad

void __fastcall FUN_676a80ad(int param_1)

{
  *(undefined ***)(param_1 + 0x90) = &PTR_LAB_676b9950;
  *(undefined ***)(param_1 + 0x70) = &PTR_LAB_676b9950;
  *(undefined ***)(param_1 + 0x50) = &PTR_LAB_676b9950;
  Ordinal_6(*(undefined4 *)(param_1 + 0x28));
  Ordinal_6(*(undefined4 *)(param_1 + 0x24));
  Ordinal_6(*(undefined4 *)(param_1 + 0x20));
  DeleteCriticalSection((LPCRITICAL_SECTION)((-(uint)(param_1 != 0) & param_1 + 4U) + 4));
  return;
}



// Function: FUN_676a80ef at 676a80ef

int __thiscall FUN_676a80ef(void *this,undefined4 param_1,undefined4 param_2)

{
  int iVar1;
  uint uVar2;
  short local_14 [4];
  short local_c;
  
  local_14[0] = 0;
  uVar2 = -(uint)(this != (void *)0x0) & (int)this - 0x74U;
  if (*(int **)(uVar2 + 0x1c) != (int *)0x0) {
    iVar1 = FUN_67690205(*(int **)(uVar2 + 0x1c),0xfffffd3b,local_14);
    if (((-1 < iVar1) && (local_14[0] == 0xb)) && (local_c == 0)) {
      iVar1 = FUN_6769b312((void *)(uVar2 + 4),param_1,param_2);
      goto LAB_676a8152;
    }
  }
  iVar1 = FUN_676a8166(uVar2 + 0x74);
LAB_676a8152:
  Ordinal_9(local_14);
  return iVar1;
}



// Function: FUN_676a8166 at 676a8166

int __fastcall FUN_676a8166(int param_1)

{
  void *this;
  int iVar1;
  
  this = (void *)((-(uint)(param_1 != 0) & param_1 - 0x74U) + 4);
  iVar1 = FUN_6769b51b(this,-5);
  if (-1 < iVar1) {
    iVar1 = 0;
    FUN_67694434((int)this);
  }
  return iVar1;
}



// Function: FUN_676a8199 at 676a8199

int __fastcall FUN_676a8199(int param_1)

{
  int iVar1;
  uint uVar2;
  
  uVar2 = -(uint)(param_1 != 0) & param_1 - 0x74U;
  iVar1 = 0;
  if ((*(byte *)(uVar2 + 0x48) & 8) == 0) {
    iVar1 = FUN_6769b51b((void *)(uVar2 + 4),-4);
    if (-1 < iVar1) {
      iVar1 = 0;
    }
  }
  return iVar1;
}



// Function: FUN_676a81c1 at 676a81c1

undefined4 __fastcall FUN_676a81c1(int param_1)

{
  uint uVar1;
  
  uVar1 = -(uint)(param_1 != 0) & param_1 - 0x74U;
  (**(code **)(*(int *)(uVar1 + 0x80) + 0x18))(uVar1 + 0x80);
  if (*(HWND *)(uVar1 + 0x50) != (HWND)0x0) {
    ShowWindow(*(HWND *)(uVar1 + 0x50),0);
  }
  return 0;
}



// Function: FUN_676a81f3 at 676a81f3

void * __thiscall FUN_676a81f3(void *this,int *param_1)

{
  int *piVar1;
  
  piVar1 = param_1;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 4))(param_1);
  }
  FUN_676a861b(this,piVar1);
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 8))(param_1);
  }
  return this;
}



// Function: FUN_676a8222 at 676a8222

undefined4 FUN_676a8222(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  
  uVar2 = 0x8007000e;
  puVar1 = (undefined4 *)operator_new(200);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    FUN_676a827c((int)puVar1);
    *puVar1 = &PTR_LAB_676ba8dc;
    InterlockedIncrement(&DAT_676c559c);
  }
  if (puVar1 != (undefined4 *)0x0) {
    InterlockedIncrement(puVar1 + 1);
    uVar2 = 0;
    InterlockedDecrement(puVar1 + 1);
  }
  *param_1 = puVar1;
  return uVar2;
}



// Function: FUN_676a827c at 676a827c

int __fastcall FUN_676a827c(int param_1)

{
  *(undefined4 *)(param_1 + 4) = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 8));
  *(undefined4 *)(param_1 + 0x20) = 0;
  *(undefined4 *)(param_1 + 0x24) = 0;
  *(undefined4 *)(param_1 + 0x28) = 0;
  *(undefined4 *)(param_1 + 0x50) = &PTR_LAB_676b9950;
  FUN_6767d089(param_1 + 0x50);
  *(undefined4 *)(param_1 + 0x70) = &PTR_LAB_676b9950;
  FUN_6767d089(param_1 + 0x70);
  *(undefined4 *)(param_1 + 0x90) = &PTR_LAB_676b9950;
  FUN_6767d089(param_1 + 0x90);
  *(undefined4 *)(param_1 + 0x30) = 0;
  *(undefined4 *)(param_1 + 0x38) = 0;
  *(undefined4 *)(param_1 + 0x34) = 0;
  *(undefined4 *)(param_1 + 0x3c) = 0;
  *(undefined2 *)(param_1 + 0x40) = 0;
  *(undefined4 *)(param_1 + 0x44) = 0;
  *(undefined4 *)(param_1 + 0x48) = 0;
  *(undefined4 *)(param_1 + 0xb0) = 0;
  *(undefined2 *)(param_1 + 0xb4) = 0;
  *(undefined4 *)(param_1 + 0xb8) = 0;
  *(undefined2 *)(param_1 + 0xbc) = 0;
  *(undefined4 *)(param_1 + 0xc0) = 0;
  return param_1;
}



// Function: FUN_676a82fb at 676a82fb

undefined4 FUN_676a82fb(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  
  uVar2 = 0x8007000e;
  puVar1 = (undefined4 *)operator_new(0x38);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    puVar1 = FUN_676a8365(puVar1);
  }
  if (puVar1 != (undefined4 *)0x0) {
    InterlockedIncrement(puVar1 + 7);
    uVar2 = 0;
    InterlockedDecrement(puVar1 + 7);
  }
  *param_1 = puVar1;
  return uVar2;
}



// Function: FUN_676a8343 at 676a8343

undefined4 * __thiscall FUN_676a8343(void *this,byte param_1)

{
  *(undefined ***)this = &PTR_FUN_676ba8d8;
  FUN_676a87b8((int)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_676a8365 at 676a8365

undefined4 * __fastcall FUN_676a8365(undefined4 *param_1)

{
  FUN_676a838b((int)param_1);
  *param_1 = &PTR_LAB_676ba980;
  param_1[1] = &PTR_FUN_676ba978;
  InterlockedIncrement(&DAT_676c559c);
  return param_1;
}



// Function: FUN_676a838b at 676a838b

int __fastcall FUN_676a838b(int param_1)

{
  *(undefined4 *)(param_1 + 0x1c) = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x20));
  FUN_676a8516((undefined4 *)(param_1 + 4));
  return param_1;
}



// Function: FUN_676a83e0 at 676a83e0

void FUN_676a83e0(undefined4 param_1,undefined4 param_2,undefined4 *param_3,int param_4,int *param_5
                 ,int param_6)

{
  FUN_67690c6e(&PTR_DAT_676c1d18,param_2,param_3,param_4,param_5,param_6);
  return;
}



// Function: FUN_676a8400 at 676a8400

void FUN_676a8400(undefined4 param_1,undefined4 param_2,undefined4 param_3,int *param_4,
                 undefined4 param_5,undefined4 param_6,undefined4 param_7,undefined4 param_8,
                 undefined4 param_9)

{
  if ((DAT_676c1d24 == (int *)0x0) &&
     (FUN_67691000(&PTR_DAT_676c1d18,param_4), DAT_676c1d24 == (int *)0x0)) {
    return;
  }
  (**(code **)(*DAT_676c1d24 + 0x2c))
            (DAT_676c1d24,param_1,param_2,param_5,param_6,param_7,param_8,param_9);
  return;
}



// Function: FUN_676a8456 at 676a8456

LONG FUN_676a8456(int param_1)

{
  LONG LVar1;
  
  LVar1 = InterlockedDecrement((LONG *)(param_1 + 0x1c));
  if ((LVar1 == 0) && (param_1 != 0)) {
    (*(code *)**(undefined4 **)(param_1 + 4))(1);
  }
  return LVar1;
}



// Function: FUN_676a849a at 676a849a

int * __thiscall FUN_676a849a(void *this,byte param_1)

{
  FUN_676a84ba((int *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)((int)this + -4));
  }
  return (int *)((int)this + -4);
}



// Function: FUN_676a84ba at 676a84ba

void __fastcall FUN_676a84ba(int *param_1)

{
  param_1[-1] = (int)&PTR_LAB_676ba980;
  *param_1 = (int)&PTR_FUN_676ba978;
  param_1[6] = 1;
  (**(code **)(*param_1 + 4))();
  InterlockedDecrement(&DAT_676c559c);
  FUN_676a84ec((uint)param_1);
  return;
}



// Function: FUN_676a84ec at 676a84ec

void __fastcall FUN_676a84ec(uint param_1)

{
  FUN_676a85b3((undefined4 *)(-(uint)(param_1 != 4) & param_1));
  DeleteCriticalSection((LPCRITICAL_SECTION)((-(uint)(param_1 != 4) & param_1 + 0x18) + 4));
  return;
}



// Function: FUN_676a8516 at 676a8516

undefined4 * __fastcall FUN_676a8516(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  
  *param_1 = &PTR_FUN_676ba9d8;
  puVar2 = (undefined4 *)operator_new(0x14);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    puVar2[1] = 0;
    *puVar2 = &PTR_FUN_676ba9d4;
    puVar2[2] = 0;
    puVar2[3] = 0;
    puVar2[4] = 1;
  }
  param_1[3] = puVar2;
  puVar2 = (undefined4 *)operator_new(0x14);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    puVar2[1] = 0;
    *puVar2 = &PTR_FUN_676ba9d4;
    puVar2[2] = 0;
    puVar2[3] = 0;
    puVar2[4] = 2;
  }
  puVar1 = (undefined4 *)param_1[3];
  param_1[4] = puVar2;
  if (puVar1 != (undefined4 *)0x0) {
    if (puVar2 != (undefined4 *)0x0) goto LAB_676a859a;
    if (puVar1 != (undefined4 *)0x0) {
      (**(code **)*puVar1)(1);
      param_1[3] = 0;
    }
  }
  if ((undefined4 *)param_1[4] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[4])(1);
    param_1[4] = 0;
  }
LAB_676a859a:
  FUN_676a8719(param_1,0);
  FUN_676a874b(param_1,0);
  param_1[5] = 0;
  return param_1;
}



// Function: FUN_676a85b3 at 676a85b3

void __fastcall FUN_676a85b3(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676ba9d8;
  while (param_1[1] != 0) {
    FUN_676a86c8(param_1,(int *)0x0);
  }
  if ((undefined4 *)param_1[3] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[3])(1);
  }
  if ((undefined4 *)param_1[4] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[4])(1);
  }
  return;
}



// Function: FUN_676a85e9 at 676a85e9

void __fastcall FUN_676a85e9(void *param_1)

{
  while (*(int *)((int)param_1 + 4) != 0) {
    FUN_676a86c8(param_1,(int *)0x0);
  }
  return;
}



// Function: FUN_676a85ff at 676a85ff

undefined4 * __thiscall FUN_676a85ff(void *this,byte param_1)

{
  FUN_676a85b3((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_676a861b at 676a861b

undefined4 __thiscall FUN_676a861b(void *this,int *param_1)

{
  void *pvVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  int *piVar4;
  
  if (*(int *)((int)this + 4) == 0) {
    pvVar1 = operator_new(0x14);
    if (pvVar1 == (void *)0x0) {
      puVar2 = (undefined4 *)0x0;
    }
    else {
      piVar4 = param_1;
      if (param_1 != (int *)0x0) {
        (**(code **)(*param_1 + 4))(param_1);
      }
      puVar2 = FUN_676a8807(pvVar1,piVar4);
    }
    if (puVar2 == (undefined4 *)0x0) {
LAB_676a8691:
      if (param_1 != (int *)0x0) {
        puVar2 = (undefined4 *)(**(code **)(*param_1 + 8))(param_1);
      }
      return (uint)puVar2 & 0xffffff00;
    }
    FUN_676a8719(this,(int)puVar2);
  }
  else {
    pvVar1 = operator_new(0x14);
    if (pvVar1 == (void *)0x0) {
      puVar2 = (undefined4 *)0x0;
    }
    else {
      piVar4 = param_1;
      if (param_1 != (int *)0x0) {
        (**(code **)(*param_1 + 4))(param_1);
      }
      puVar2 = FUN_676a8807(pvVar1,piVar4);
    }
    if (puVar2 == (undefined4 *)0x0) goto LAB_676a8691;
    *(undefined4 **)(*(int *)((int)this + 8) + 0xc) = puVar2;
    puVar2[2] = *(undefined4 *)((int)this + 8);
  }
  uVar3 = FUN_676a874b(this,(int)puVar2);
  *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + 1;
  if (param_1 != (int *)0x0) {
    uVar3 = (**(code **)(*param_1 + 8))(param_1);
  }
  return CONCAT31((int3)((uint)uVar3 >> 8),1);
}



// Function: FUN_676a86c8 at 676a86c8

uint __thiscall FUN_676a86c8(void *this,int *param_1)

{
  undefined4 *puVar1;
  uint in_EAX;
  uint uVar2;
  int *piVar3;
  
  puVar1 = *(undefined4 **)((int)this + 4);
  if (puVar1 == (undefined4 *)0x0) {
    uVar2 = in_EAX & 0xffffff00;
  }
  else {
    piVar3 = (int *)FUN_676a8719(this,puVar1[3]);
    if (*(int *)((int)this + 4) == 0) {
      piVar3 = (int *)FUN_676a874b(this,0);
    }
    if (param_1 != (int *)0x0) {
      piVar3 = FUN_6768fa93(param_1,(int *)puVar1[1]);
    }
    *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + -1;
    if (puVar1 != (undefined4 *)0x0) {
      piVar3 = (int *)(**(code **)*puVar1)(1);
    }
    uVar2 = CONCAT31((int3)((uint)piVar3 >> 8),1);
  }
  return uVar2;
}



// Function: FUN_676a8719 at 676a8719

void __thiscall FUN_676a8719(void *this,int param_1)

{
  *(int *)((int)this + 4) = param_1;
  if ((param_1 != 0) && (*(int *)(param_1 + 0x10) != 0)) {
    *(undefined4 *)((int)this + 4) = 0;
  }
  if (*(int *)((int)this + 0xc) != 0) {
    *(undefined4 *)(*(int *)((int)this + 0xc) + 0xc) = *(undefined4 *)((int)this + 4);
    if (*(int *)((int)this + 4) != 0) {
      *(undefined4 *)(*(int *)((int)this + 4) + 8) = *(undefined4 *)((int)this + 0xc);
    }
  }
  return;
}



// Function: FUN_676a874b at 676a874b

void __thiscall FUN_676a874b(void *this,int param_1)

{
  *(int *)((int)this + 8) = param_1;
  if ((param_1 != 0) && (*(int *)(param_1 + 0x10) != 0)) {
    *(undefined4 *)((int)this + 8) = 0;
  }
  if (*(int *)((int)this + 0x10) != 0) {
    *(undefined4 *)(*(int *)((int)this + 0x10) + 8) = *(undefined4 *)((int)this + 8);
    if (*(int *)((int)this + 8) != 0) {
      *(undefined4 *)(*(int *)((int)this + 8) + 0xc) = *(undefined4 *)((int)this + 0x10);
    }
  }
  return;
}



// Function: FUN_676a877d at 676a877d

void __thiscall FUN_676a877d(void *this,uint param_1)

{
  void *pvVar1;
  
  FUN_676a87b8((int)this);
  if (param_1 == 1) {
    pvVar1 = operator_new(1);
    *(void **)((int)this + 4) = pvVar1;
  }
  else {
    if (1 < (int)param_1) {
      pvVar1 = operator_new(param_1);
      *(void **)((int)this + 4) = pvVar1;
      *(undefined1 *)((int)this + 8) = 1;
      return;
    }
    *(undefined4 *)((int)this + 4) = 0;
  }
  *(undefined1 *)((int)this + 8) = 0;
  return;
}



// Function: FUN_676a87b8 at 676a87b8

void __fastcall FUN_676a87b8(int param_1)

{
  if (*(undefined **)(param_1 + 4) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)(param_1 + 4));
  }
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined1 *)(param_1 + 8) = 0;
  return;
}



// Function: FUN_676a87d7 at 676a87d7

undefined4 * __thiscall FUN_676a87d7(void *this,byte param_1)

{
  FUN_676a87f3((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_676a87f3 at 676a87f3

void __fastcall FUN_676a87f3(undefined4 *param_1)

{
  int *piVar1;
  
  *param_1 = &PTR_FUN_676ba9d4;
  piVar1 = (int *)param_1[1];
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  return;
}



// Function: FUN_676a8807 at 676a8807

undefined4 * __thiscall FUN_676a8807(void *this,int *param_1)

{
  *(undefined4 *)((int)this + 4) = 0;
  *(undefined ***)this = &PTR_FUN_676ba9d4;
  FUN_6768fa93((int *)((int)this + 4),param_1);
  *(undefined4 *)((int)this + 8) = 0;
  *(undefined4 *)((int)this + 0xc) = 0;
  *(undefined4 *)((int)this + 0x10) = 0;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 8))(param_1);
  }
  return (undefined4 *)this;
}



// Function: FUN_676a8840 at 676a8840

undefined4 FUN_676a8840(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = Ordinal_7(*(undefined4 *)(param_1 + 0x20));
    uVar1 = Ordinal_4(*(undefined4 *)(param_1 + 0x20),uVar1);
    *param_2 = uVar1;
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_676a8871 at 676a8871

undefined4 FUN_676a8871(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = Ordinal_7(*(undefined4 *)(param_1 + 0x24));
    uVar1 = Ordinal_4(*(undefined4 *)(param_1 + 0x24),uVar1);
    *param_2 = uVar1;
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_676a88a2 at 676a88a2

undefined4 FUN_676a88a2(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar1 = Ordinal_7(*(undefined4 *)(param_1 + 0x28));
    uVar1 = Ordinal_4(*(undefined4 *)(param_1 + 0x28),uVar1);
    *param_2 = uVar1;
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_676a8a67 at 676a8a67

undefined8 __fastcall
FUN_676a8a67(undefined4 param_1,undefined4 param_2,int param_3,undefined4 *param_4)

{
  undefined4 uVar1;
  ulonglong uVar2;
  
  if (param_4 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar2 = __aullshr(0x20,*(uint *)(param_3 + 0x34));
    param_2 = (undefined4)(uVar2 >> 0x20);
    *param_4 = (int)uVar2;
    uVar1 = 0;
  }
  return CONCAT44(param_2,uVar1);
}



// Function: FUN_676a8a91 at 676a8a91

undefined8 __fastcall
FUN_676a8a91(undefined4 param_1,undefined4 param_2,int param_3,undefined4 *param_4)

{
  undefined4 uVar1;
  ulonglong uVar2;
  
  if (param_4 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    uVar2 = __aullshr(0x20,*(uint *)(param_3 + 0x3c));
    param_2 = (undefined4)(uVar2 >> 0x20);
    *param_4 = (int)uVar2;
    uVar1 = 0;
  }
  return CONCAT44(param_2,uVar1);
}



// Function: FUN_676a8abb at 676a8abb

undefined4 __thiscall
FUN_676a8abb(void *this,undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5,undefined4 param_6,undefined4 param_7,undefined2 param_8,
            undefined4 param_9,undefined4 param_10,undefined8 param_11,undefined8 param_12,
            undefined8 param_13,undefined4 param_14,undefined2 param_15,undefined4 param_16,
            undefined2 param_17,undefined4 param_18)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)((int)this + 8));
  Ordinal_6(*(undefined4 *)((int)this + 0x20));
  uVar1 = Ordinal_2(param_1);
  *(undefined4 *)((int)this + 0x20) = uVar1;
  Ordinal_6(*(undefined4 *)((int)this + 0x24));
  uVar1 = Ordinal_2(param_2);
  *(undefined4 *)((int)this + 0x24) = uVar1;
  Ordinal_6(*(undefined4 *)((int)this + 0x28));
  uVar1 = Ordinal_2(param_3);
  *(undefined4 *)((int)this + 0x28) = uVar1;
  *(undefined4 *)((int)this + 0x30) = param_4;
  *(undefined4 *)((int)this + 0x34) = param_5;
  *(undefined4 *)((int)this + 0x38) = param_6;
  *(undefined4 *)((int)this + 0x3c) = param_7;
  *(undefined2 *)((int)this + 0x40) = param_8;
  *(undefined4 *)((int)this + 0x44) = param_9;
  *(undefined4 *)((int)this + 0x48) = param_10;
  *(undefined8 *)((int)this + 0x68) = param_11;
  Ordinal_185(param_11,(int)this + 0x58);
  *(undefined8 *)((int)this + 0x88) = param_12;
  Ordinal_185(param_12,(int)this + 0x78);
  *(undefined8 *)((int)this + 0xa8) = param_13;
  Ordinal_185(param_13,(int)this + 0x98);
  *(undefined4 *)((int)this + 0xb0) = param_14;
  *(undefined2 *)((int)this + 0xb4) = param_15;
  *(undefined4 *)((int)this + 0xb8) = param_16;
  *(undefined2 *)((int)this + 0xbc) = param_17;
  *(undefined4 *)((int)this + 0xc0) = param_18;
  LeaveCriticalSection((LPCRITICAL_SECTION)((int)this + 8));
  return 0;
}



// Function: FUN_676a8bc8 at 676a8bc8

void FUN_676a8bc8(void)

{
  FUN_676a8fac((undefined4 *)&DAT_676c5570);
  return;
}



// Function: FUN_676a8bd2 at 676a8bd2

void FUN_676a8bd2(void)

{
  FUN_676b0c45(&LAB_676a8bde);
  return;
}



// Function: FUN_676a8bf9 at 676a8bf9

int FUN_676a8bf9(int *param_1,undefined4 *param_2)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  undefined *puVar4;
  uint uVar5;
  undefined2 *puVar6;
  undefined4 local_34;
  int local_30 [2];
  int local_28;
  int local_24;
  undefined **local_20;
  undefined2 *local_1c;
  undefined1 local_18;
  LPCRITICAL_SECTION local_14;
  int *local_10;
  undefined4 *local_c;
  int *local_8;
  
  if (param_2 == (undefined4 *)0x0) {
    iVar3 = -0x7fffbffd;
  }
  else {
    *param_2 = 0;
    iVar3 = FUN_676a9292(&local_c);
    if (iVar3 < 0) {
      iVar3 = ((iVar3 != -0x7ff8fff2) - 1 & 0x6000f) + 0x8000ffff;
    }
    else {
      local_8 = (int *)0x0;
      iVar3 = (**(code **)*local_c)(local_c,&DAT_676c1d38,&local_8);
      piVar2 = param_1;
      if (iVar3 < 0) {
        if (local_c != (undefined4 *)0x0) {
          FUN_676a8f0a(local_c);
          FUN_676b0bb3((undefined *)local_c);
        }
        if (local_8 != (int *)0x0) {
          (**(code **)(*local_8 + 8))(local_8);
        }
      }
      else {
        local_18 = 0;
        local_1c = (undefined2 *)0x0;
        iVar1 = param_1[6];
        local_20 = &PTR_FUN_676ba9e0;
        iVar3 = iVar1 + 1;
        FUN_676a938a(&local_20,iVar3);
        if (local_1c == (undefined2 *)0x0) {
          local_20 = &PTR_FUN_676ba9e0;
          FUN_676a93c9((int)&local_20);
          if (local_8 != (int *)0x0) {
            (**(code **)(*local_8 + 8))(local_8);
          }
          iVar3 = -0x7ff8fff2;
        }
        else {
          _memset(local_1c,0,iVar3 * 0x10);
          local_14 = (LPCRITICAL_SECTION)(piVar2 + 8);
          EnterCriticalSection(local_14);
          FUN_676a8fac(&local_34);
          puVar6 = local_1c;
          puVar4 = (undefined *)piVar2[2];
          if ((puVar4 == (undefined *)0x0) &&
             (puVar4 = (undefined *)piVar2[5], puVar4 == (undefined *)0x0)) {
            puVar4 = &DAT_676c5570;
          }
          FUN_676a8fc4(&local_34,(int)puVar4);
          while( true ) {
            puVar4 = (undefined *)piVar2[5];
            if (puVar4 == (undefined *)0x0) {
              puVar4 = &DAT_676c5570;
            }
            uVar5 = FUN_676a9364(&local_34,(int)puVar4);
            if ((char)uVar5 != '\0') break;
            FUN_676a9300(&param_1,local_30);
            local_10 = param_1;
            if (param_1 != (int *)0x0) {
              (**(code **)(*param_1 + 4))(param_1);
            }
            *puVar6 = 9;
            *(int **)(puVar6 + 4) = local_10;
            if (param_1 != (int *)0x0) {
              (**(code **)(*param_1 + 8))(param_1);
            }
            if ((local_24 != 2) && (local_28 != 0)) {
              FUN_676a8fc4(&local_34,local_28);
            }
            puVar6 = puVar6 + 8;
          }
          LeaveCriticalSection(local_14);
          iVar3 = FUN_676a91cc(local_c,(int)local_1c,(int)(local_1c + iVar1 * 8),(int *)0x0,2);
          piVar2 = local_8;
          if (iVar3 < 0) {
            FUN_676a87f3(&local_34);
            local_20 = &PTR_FUN_676ba9e0;
            FUN_676a93c9((int)&local_20);
            if (local_8 != (int *)0x0) {
              (**(code **)(*local_8 + 8))(local_8);
            }
          }
          else {
            local_1c = (undefined2 *)0x0;
            local_8 = (int *)0x0;
            *param_2 = piVar2;
            FUN_676a87f3(&local_34);
            local_20 = &PTR_FUN_676ba9e0;
            FUN_676a93c9((int)&local_20);
            if (local_8 != (int *)0x0) {
              (**(code **)(*local_8 + 8))(local_8);
            }
            iVar3 = 0;
          }
        }
      }
    }
  }
  return iVar3;
}



// Function: FUN_676a8e08 at 676a8e08

undefined4 FUN_676a8e08(int param_1,int param_2,undefined4 *param_3)

{
  LPCRITICAL_SECTION lpCriticalSection;
  int *piVar1;
  int iVar2;
  undefined *puVar3;
  undefined4 uVar4;
  undefined **local_28;
  int *local_24;
  undefined2 local_14 [4];
  int local_c;
  
  if (param_3 == (undefined4 *)0x0) {
    return 0x80004003;
  }
  *param_3 = 0;
  if (param_2 == 0) {
    return 0x80070057;
  }
  local_14[0] = 0;
  iVar2 = Ordinal_12(local_14,param_2,0,0x13);
  if (-1 < iVar2) {
    lpCriticalSection = (LPCRITICAL_SECTION)(param_1 + 0x20);
    EnterCriticalSection(lpCriticalSection);
    if (local_c - 1U < *(uint *)(param_1 + 0x18)) {
      puVar3 = FUN_676a932f((void *)(param_1 + 4),local_c - 1U);
      local_24 = (int *)0x0;
      local_28 = &PTR_FUN_676ba9d4;
      FUN_676a8fc4(&local_28,(int)puVar3);
      piVar1 = local_24;
      if (local_24 != (int *)0x0) {
        (**(code **)(*local_24 + 4))(local_24);
      }
      *param_3 = piVar1;
      if (piVar1 != (int *)0x0) {
        (**(code **)(*piVar1 + 4))(piVar1);
        (**(code **)(*piVar1 + 8))(piVar1);
      }
      LeaveCriticalSection(lpCriticalSection);
      FUN_676a87f3(&local_28);
      uVar4 = 0;
      goto LAB_676a8ec3;
    }
    LeaveCriticalSection(lpCriticalSection);
  }
  uVar4 = 0x80070057;
LAB_676a8ec3:
  Ordinal_9(local_14);
  return uVar4;
}



// Function: FUN_676a8ed6 at 676a8ed6

undefined4 FUN_676a8ed6(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (param_2 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x20));
    *param_2 = *(undefined4 *)(param_1 + 0x18);
    LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x20));
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_676a8f0a at 676a8f0a

void __fastcall FUN_676a8f0a(undefined4 *param_1)

{
  *param_1 = &PTR_LAB_676ba9e4;
  param_1[6] = 1;
  InterlockedDecrement(&DAT_676c559c);
  DeleteCriticalSection
            ((LPCRITICAL_SECTION)((-(uint)(param_1 != (undefined4 *)0x0) & (uint)(param_1 + 6)) + 4)
            );
  FUN_676a8ff1((int)param_1);
  return;
}



// Function: FUN_676a8f55 at 676a8f55

LONG FUN_676a8f55(undefined4 *param_1)

{
  LONG LVar1;
  
  LVar1 = InterlockedDecrement(param_1 + 6);
  if ((LVar1 == 0) && (param_1 != (undefined4 *)0x0)) {
    FUN_676a8f0a(param_1);
    FUN_676b0bb3((undefined *)param_1);
  }
  return LVar1;
}



// Function: FUN_676a8fac at 676a8fac

void __fastcall FUN_676a8fac(undefined4 *param_1)

{
  param_1[1] = 0;
  param_1[4] = 0xffffffff;
  *param_1 = &PTR_FUN_676ba9d4;
  param_1[2] = 0;
  param_1[3] = 0;
  return;
}



// Function: FUN_676a8fc4 at 676a8fc4

int __thiscall FUN_676a8fc4(void *this,int param_1)

{
  FUN_6768fa93((int *)((int)this + 4),*(int **)(param_1 + 4));
  *(undefined4 *)((int)this + 8) = *(undefined4 *)(param_1 + 8);
  *(undefined4 *)((int)this + 0xc) = *(undefined4 *)(param_1 + 0xc);
  *(undefined4 *)((int)this + 0x10) = *(undefined4 *)(param_1 + 0x10);
  return (int)this;
}



// Function: FUN_676a8ff1 at 676a8ff1

void __fastcall FUN_676a8ff1(int param_1)

{
  int *piVar1;
  int iVar2;
  
  if ((*(byte *)(param_1 + 0x14) & 2) != 0) {
    for (iVar2 = *(int *)(param_1 + 8); iVar2 != *(int *)(param_1 + 0xc); iVar2 = iVar2 + 0x10) {
      Ordinal_9(iVar2);
    }
    FUN_676b0bb3(*(undefined **)(param_1 + 8));
  }
  piVar1 = *(int **)(param_1 + 4);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  return;
}



// Function: FUN_676a9028 at 676a9028

uint FUN_676a9028(int param_1,uint param_2,uint param_3,uint *param_4)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  bool bVar4;
  
  uVar3 = param_2;
  if ((param_3 == 0) || ((param_2 != 1 && (param_4 == (uint *)0x0)))) {
    param_2 = 0x80004003;
  }
  else if (((*(int *)(param_1 + 8) == 0) || (*(int *)(param_1 + 0xc) == 0)) ||
          (*(int *)(param_1 + 0x10) == 0)) {
    param_2 = 0x80004005;
  }
  else {
    uVar1 = *(int *)(param_1 + 0xc) - *(int *)(param_1 + 0x10) >> 4;
    bVar4 = uVar1 <= param_2;
    param_2 = (uint)(uVar1 < param_2);
    if (bVar4) {
      uVar3 = uVar1;
    }
    uVar1 = param_3;
    if (param_4 != (uint *)0x0) {
      *param_4 = uVar3;
    }
    while (uVar3 != 0) {
      uVar2 = Ordinal_10(uVar1,*(undefined4 *)(param_1 + 0x10));
      if ((int)uVar2 < 0) {
        for (; param_3 < uVar1; param_3 = param_3 + 0x10) {
          Ordinal_9(param_3);
        }
        if (param_4 == (uint *)0x0) {
          return uVar2;
        }
        *param_4 = 0;
        return uVar2;
      }
      uVar1 = uVar1 + 0x10;
      *(int *)(param_1 + 0x10) = *(int *)(param_1 + 0x10) + 0x10;
      uVar3 = uVar3 - 1;
    }
  }
  return param_2;
}



// Function: FUN_676a910a at 676a910a

int FUN_676a910a(int *param_1,undefined4 *param_2)

{
  bool bVar1;
  int *piVar2;
  undefined4 *puVar3;
  int **ppiVar4;
  int iVar5;
  
  puVar3 = param_2;
  bVar1 = false;
  iVar5 = -0x7fffbffd;
  if (param_2 != (undefined4 *)0x0) {
    *param_2 = 0;
    iVar5 = FUN_676a9292(&param_2);
    piVar2 = param_1;
    if (-1 < iVar5) {
      if ((*(byte *)(param_1 + 5) & 1) == 0) {
        ppiVar4 = (int **)(param_1 + 1);
      }
      else {
        if (param_1 != (int *)0x0) {
          (**(code **)(*piVar2 + 4))(piVar2);
        }
        bVar1 = true;
        ppiVar4 = &param_1;
      }
      iVar5 = FUN_676a91cc(param_2,piVar2[2],piVar2[3],*ppiVar4,0);
      if ((bVar1) && (param_1 != (int *)0x0)) {
        (**(code **)(*param_1 + 8))(param_1);
      }
      if (-1 < iVar5) {
        param_2[4] = piVar2[4];
        iVar5 = FUN_6768f4db((int)param_2,(int *)&PTR_DAT_676baa00,(int *)&DAT_676bb4c0,puVar3);
        if (-1 < iVar5) {
          return iVar5;
        }
      }
      puVar3 = param_2;
      if (param_2 != (undefined4 *)0x0) {
        FUN_676a8f0a(param_2);
        FUN_676b0bb3((undefined *)puVar3);
      }
    }
  }
  return iVar5;
}



// Function: FUN_676a91cc at 676a91cc

int __thiscall FUN_676a91cc(void *this,int param_1,int param_2,int *param_3,int param_4)

{
  void *pvVar1;
  int iVar2;
  uint uVar3;
  
  if (param_4 == 3) {
    uVar3 = (param_2 - param_1 >> 4) * 0x10;
    pvVar1 = operator_new(uVar3);
    *(void **)((int)this + 8) = pvVar1;
    *(void **)((int)this + 0x10) = pvVar1;
    if (pvVar1 == (void *)0x0) {
      return -0x7ff8fff2;
    }
    for (; param_1 != param_2; param_1 = param_1 + 0x10) {
      **(undefined2 **)((int)this + 0x10) = 0;
      iVar2 = Ordinal_10(*(undefined4 *)((int)this + 0x10),param_1);
      if (iVar2 < 0) {
        for (uVar3 = *(uint *)((int)this + 8); uVar3 < *(uint *)((int)this + 0x10);
            uVar3 = uVar3 + 0x10) {
          Ordinal_9(uVar3);
        }
        FUN_676b0bb3(*(undefined **)((int)this + 8));
        *(undefined4 *)((int)this + 0x10) = 0;
        *(undefined4 *)((int)this + 0xc) = 0;
        *(undefined4 *)((int)this + 8) = 0;
        return iVar2;
      }
      *(int *)((int)this + 0x10) = *(int *)((int)this + 0x10) + 0x10;
    }
    *(uint *)((int)this + 0xc) = uVar3 + *(int *)((int)this + 8);
  }
  else {
    *(int *)((int)this + 8) = param_1;
    *(int *)((int)this + 0xc) = param_2;
  }
  FUN_6768fa93((int *)((int)this + 4),param_3);
  *(undefined4 *)((int)this + 0x10) = *(undefined4 *)((int)this + 8);
  *(int *)((int)this + 0x14) = param_4;
  return 0;
}



// Function: FUN_676a9292 at 676a9292

undefined4 FUN_676a9292(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  
  uVar2 = 0x8007000e;
  puVar1 = (undefined4 *)operator_new(0x34);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    FUN_676a931b((int)puVar1);
    FUN_67691b41(puVar1 + 6);
    *puVar1 = &PTR_LAB_676ba9e4;
    InterlockedIncrement(&DAT_676c559c);
  }
  if (puVar1 != (undefined4 *)0x0) {
    uVar2 = 0;
  }
  *param_1 = puVar1;
  return uVar2;
}



// Function: FUN_676a92de at 676a92de

undefined4 * __thiscall FUN_676a92de(void *this,byte param_1)

{
  *(undefined ***)this = &PTR_FUN_676ba9e0;
  FUN_676a93c9((int)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_676a9300 at 676a9300

int * __thiscall FUN_676a9300(void *this,int *param_1)

{
  int *piVar1;
  
  piVar1 = (int *)*param_1;
  *(int **)this = piVar1;
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 4))(piVar1);
  }
  return (int *)this;
}



// Function: FUN_676a931b at 676a931b

void __fastcall FUN_676a931b(int param_1)

{
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined4 *)(param_1 + 0x10) = 0;
  *(undefined4 *)(param_1 + 0xc) = 0;
  *(undefined4 *)(param_1 + 8) = 0;
  *(undefined4 *)(param_1 + 0x14) = 0;
  return;
}



// Function: FUN_676a932f at 676a932f

undefined * __thiscall FUN_676a932f(void *this,uint param_1)

{
  undefined *puVar1;
  uint uVar2;
  
  if (param_1 < *(uint *)((int)this + 0x14)) {
    puVar1 = *(undefined **)((int)this + 4);
    uVar2 = 0;
    if (param_1 != 0) {
      do {
        if (puVar1 == (undefined *)0x0) goto LAB_676a9352;
        puVar1 = *(undefined **)(puVar1 + 0xc);
        uVar2 = uVar2 + 1;
      } while (uVar2 < param_1);
    }
    if (puVar1 != (undefined *)0x0) {
      return puVar1;
    }
  }
LAB_676a9352:
  puVar1 = *(undefined **)((int)this + 0x10);
  if (puVar1 == (undefined *)0x0) {
    puVar1 = &DAT_676c5570;
  }
  return puVar1;
}



// Function: FUN_676a9364 at 676a9364

uint __thiscall FUN_676a9364(void *this,int param_1)

{
  int iVar1;
  uint3 uVar3;
  uint uVar2;
  
  iVar1 = *(int *)((int)this + 0x10);
  uVar3 = (uint3)((uint)iVar1 >> 8);
  if (iVar1 == *(int *)(param_1 + 0x10)) {
    if (iVar1 == 0) {
      uVar2 = (uint)(*(int *)((int)this + 4) == *(int *)(param_1 + 4));
    }
    else {
      uVar2 = CONCAT31(uVar3,1);
    }
  }
  else {
    uVar2 = (uint)uVar3 << 8;
  }
  return uVar2;
}



// Function: FUN_676a938a at 676a938a

void __thiscall FUN_676a938a(void *this,int param_1)

{
  void *pvVar1;
  
  FUN_676a93c9((int)this);
  if (param_1 == 1) {
    pvVar1 = operator_new(0x10);
    *(void **)((int)this + 4) = pvVar1;
  }
  else {
    if (1 < param_1) {
      pvVar1 = operator_new(param_1 << 4);
      *(void **)((int)this + 4) = pvVar1;
      *(undefined1 *)((int)this + 8) = 1;
      return;
    }
    *(undefined4 *)((int)this + 4) = 0;
  }
  *(undefined1 *)((int)this + 8) = 0;
  return;
}



// Function: FUN_676a93c9 at 676a93c9

void __fastcall FUN_676a93c9(int param_1)

{
  if (*(undefined **)(param_1 + 4) != (undefined *)0x0) {
    FUN_676b0bb3(*(undefined **)(param_1 + 4));
  }
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined1 *)(param_1 + 8) = 0;
  return;
}



// Function: FUN_676a9428 at 676a9428

int FUN_676a9428(int param_1)

{
  LPCWSTR pWVar1;
  int iVar2;
  int iVar3;
  WCHAR *pWVar4;
  DWORD DVar5;
  WCHAR local_41c;
  undefined4 auStack_41a [129];
  WCHAR local_214 [260];
  int *local_c;
  LPCWSTR local_8;
  
  local_8 = (LPCWSTR)0x0;
  local_c = (int *)0x0;
  iVar2 = FUN_676aad81(param_1,(LPCWSTR)0x0,&local_8,&local_c);
  pWVar1 = local_8;
  if (-1 < iVar2) {
    iVar2 = lstrlenW(local_8);
    FUN_676b06d0((undefined4 *)local_214,(undefined4 *)pWVar1,iVar2 * 2 + 2);
    iVar3 = FUN_676aa963(local_214);
    iVar2 = iVar3 + -2;
    local_214[iVar3] = L'\0';
    if (0 < iVar2) {
      pWVar4 = local_214 + iVar2;
      do {
        if ((*pWVar4 == L'\\') || (*pWVar4 == L'/')) break;
        iVar2 = iVar2 + -1;
        pWVar4 = pWVar4 + -1;
      } while (0 < iVar2);
      if (0 < iVar2) {
        iVar3 = lstrlenW(local_214);
        FUN_676b06d0((undefined4 *)&local_41c,(undefined4 *)local_214,iVar3 * 2 + 2);
        iVar3 = lstrlenW(u_Help_676c1db4);
        FUN_676b06d0((undefined4 *)((int)auStack_41a + iVar2 * 2),(undefined4 *)u_Help_676c1db4,
                     iVar3 * 2 + 2);
        DVar5 = FUN_676af4e2(&local_41c);
        if ((DVar5 != 0xffffffff) && (((byte)DVar5 & 0x10) == 0x10)) {
          iVar2 = lstrlenW(&local_41c);
          FUN_676b06d0((undefined4 *)local_214,(undefined4 *)&local_41c,iVar2 * 2 + 2);
        }
      }
    }
    iVar2 = Ordinal_163(local_c,local_8,local_214);
  }
  if (local_c != (int *)0x0) {
    (**(code **)(*local_c + 8))(local_c);
  }
  Ordinal_6(local_8);
  return iVar2;
}



// Function: FUN_676a956a at 676a956a

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 FUN_676a956a(HMODULE param_1,int param_2)

{
  if (param_2 == 1) {
    _DAT_676c55f8 = &DAT_676c1be8;
    DAT_676c515c = &DAT_676c5588;
    _DAT_676c5588 = 0x84;
    _DAT_676c55ec = 0x300;
    FUN_676aa99f((int *)&DAT_676c5588,0x676c1d48,(int)param_1);
    FUN_676b06d0((undefined4 *)&DAT_676c5558,(undefined4 *)&DAT_676baa38,0x10);
    DisableThreadLibraryCalls(param_1);
    FUN_67695dff();
  }
  else if (param_2 == 0) {
    FUN_676aaaf5((int *)&DAT_676c5588);
  }
  return 1;
}



// Function: DllCanUnloadNow at 676a95eb

HRESULT DllCanUnloadNow(void)

{
                    /* 0x395eb  1  DllCanUnloadNow */
  return (uint)(DAT_676c559c != 0);
}



// Function: DllGetClassObject at 676a95f7

HRESULT DllGetClassObject(IID *rclsid,IID *riid,LPVOID *ppv)

{
  int *piVar1;
  
                    /* 0x395f7  2  DllGetClassObject */
  piVar1 = FUN_676aaa22((int *)&DAT_676c5588,(int *)rclsid,riid,(int *)ppv);
  return (HRESULT)piVar1;
}



// Function: DllRegisterServer at 676a9610

void DllRegisterServer(void)

{
  int iVar1;
  
                    /* 0x39610  3  DllRegisterServer */
  iVar1 = FUN_676aaba5((int *)&DAT_676c5588,0,(void *)0x0);
  if (-1 < iVar1) {
    FUN_676a9428(0x676c5588);
  }
  return;
}



// Function: DllUnregisterServer at 676a962d

void DllUnregisterServer(void)

{
                    /* 0x3962d  4  DllUnregisterServer */
  FUN_676aacfe((int *)&DAT_676c5588,1,(void *)0x0);
  return;
}



// Function: FUN_676a963c at 676a963c

undefined4 FUN_676a963c(LPCWSTR param_1,ushort param_2,int param_3,undefined4 *param_4)

{
  LPCWSTR pWVar1;
  HMODULE pHVar2;
  DWORD DVar3;
  int iVar4;
  LPCSTR lpMultiByteStr;
  undefined4 uVar5;
  CHAR local_234 [260];
  CHAR local_130 [260];
  int local_2c [3];
  _RTL_CRITICAL_SECTION local_20;
  LPCWSTR local_8;
  
  FUN_676a982c(local_2c);
  InitializeCriticalSection(&local_20);
  GetModuleFileNameA(*(HMODULE *)(DAT_676c515c + 4),local_130,0x104);
  if ((*(int *)(param_1 + 2) == 0) ||
     (pHVar2 = GetModuleHandleA((LPCSTR)0x0), *(HMODULE *)(param_1 + 2) == pHVar2)) {
    DVar3 = GetShortPathNameA(local_130,local_234,0x104);
    if (DVar3 == 0x104) {
      FUN_676a991d(local_2c);
      return 0x8007000e;
    }
    if ((DVar3 == 0) || (DVar3 == 0x57)) goto LAB_676a96fc;
    if (&stack0x00000000 == (undefined1 *)0x234) goto LAB_676a96c9;
    iVar4 = lstrlenA(local_234);
    FUN_676b06a0();
    lpMultiByteStr = local_234;
  }
  else {
LAB_676a96fc:
    if (&stack0x00000000 == (undefined1 *)0x130) {
LAB_676a96c9:
      param_1 = (LPCWSTR)0x0;
      goto LAB_676a973e;
    }
    iVar4 = lstrlenA(local_130);
    FUN_676b06a0();
    lpMultiByteStr = local_130;
  }
  param_1 = (LPCWSTR)&stack0xfffffdc0;
  MultiByteToWideChar(0,0,lpMultiByteStr,-1,(LPWSTR)&stack0xfffffdc0,iVar4 + 1);
LAB_676a973e:
  lstrlenW(param_1);
  FUN_676b06a0();
  FUN_676a97fb((short *)&stack0xfffffdc0,param_1);
  EnterCriticalSection(&local_20);
  FUN_676a9848(local_2c,u_Module_676c1dd4,(LPCWSTR)&stack0xfffffdc0);
  LeaveCriticalSection(&local_20);
  if (param_4 != (undefined4 *)0x0) {
    for (; pWVar1 = (LPCWSTR)*param_4, pWVar1 != (LPCWSTR)0x0; param_4 = param_4 + 2) {
      local_8 = (LPCWSTR)param_4[1];
      EnterCriticalSection(&local_20);
      FUN_676a9848(local_2c,pWVar1,local_8);
      LeaveCriticalSection(&local_20);
    }
  }
  if (param_3 == 0) {
    uVar5 = FUN_676a9abc(local_2c,param_1,param_2,u_REGISTRY_676c1dc0);
  }
  else {
    uVar5 = FUN_676a993a(local_2c,param_1,param_2,u_REGISTRY_676c1dc0);
  }
  FUN_676a991d(local_2c);
  return uVar5;
}



// Function: FUN_676a97fb at 676a97fb

void __cdecl FUN_676a97fb(short *param_1,short *param_2)

{
  short sVar1;
  short *psVar2;
  
  sVar1 = *param_2;
  while (sVar1 != 0) {
    *param_1 = sVar1;
    psVar2 = param_1 + 1;
    if (*param_2 == 0x27) {
      *psVar2 = 0x27;
      psVar2 = param_1 + 2;
    }
    param_2 = param_2 + 1;
    param_1 = psVar2;
    sVar1 = *param_2;
  }
  *param_1 = 0;
  return;
}



// Function: FUN_676a982c at 676a982c

undefined4 * __fastcall FUN_676a982c(undefined4 *param_1)

{
  void *pvVar1;
  
  param_1[1] = 0;
  param_1[2] = 10;
  pvVar1 = _malloc(0x28);
  *param_1 = pvVar1;
  return param_1;
}



// Function: FUN_676a9848 at 676a9848

undefined4 __thiscall FUN_676a9848(void *this,LPCWSTR param_1,LPCWSTR param_2)

{
  SIZE_T cb;
  SIZE_T cb_00;
  undefined4 *pv;
  undefined4 *puVar1;
  int iVar2;
  LPVOID pvVar3;
  byte *pbVar4;
  
  puVar1 = (undefined4 *)operator_new(8);
  if (puVar1 != (undefined4 *)0x0) {
    iVar2 = lstrlenW(param_1);
    cb = iVar2 * 2 + 2;
    iVar2 = lstrlenW(param_2);
    cb_00 = iVar2 * 2 + 2;
    pvVar3 = CoTaskMemAlloc(cb);
    *puVar1 = pvVar3;
    pvVar3 = CoTaskMemAlloc(cb_00);
    pv = (undefined4 *)*puVar1;
    puVar1[1] = pvVar3;
    if ((pv != (undefined4 *)0x0) && (pvVar3 != (LPVOID)0x0)) {
      FUN_676b06d0(pv,(undefined4 *)param_1,cb);
      FUN_676b06d0((undefined4 *)puVar1[1],(undefined4 *)param_2,cb_00);
      iVar2 = *(int *)((int)this + 8);
      if (*(int *)((int)this + 4) == iVar2) {
        *(int *)((int)this + 8) = iVar2 * 2;
                    /* WARNING: Load size is inaccurate */
        pbVar4 = FUN_676b0e9c(*this,(uint *)(iVar2 << 3));
        *(byte **)this = pbVar4;
      }
                    /* WARNING: Load size is inaccurate */
      if (*this != 0) {
        *(undefined4 **)(*this + *(int *)((int)this + 4) * 4) = puVar1;
        *(int *)((int)this + 4) = *(int *)((int)this + 4) + 1;
        return 0;
      }
      return 0x8007000e;
    }
    CoTaskMemFree(pv);
    CoTaskMemFree((LPVOID)puVar1[1]);
    FUN_676b0bb3((undefined *)puVar1);
  }
  return 0x8007000e;
}



// Function: FUN_676a991d at 676a991d

void __fastcall FUN_676a991d(int *param_1)

{
  FUN_676a9b17(param_1);
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 3));
  FUN_676b0201((undefined *)*param_1);
  return;
}



// Function: FUN_676a993a at 676a993a

void FUN_676a993a(undefined4 param_1,LPCWSTR param_2,ushort param_3,LPCWSTR param_4)

{
  int iVar1;
  LPCSTR pCVar2;
  
  if (param_4 == (LPCWSTR)0x0) {
    pCVar2 = (LPCSTR)0x0;
  }
  else {
    pCVar2 = &stack0xfffffff0;
    iVar1 = lstrlenW(param_4);
    FUN_676b06a0();
    WideCharToMultiByte(0,0,param_4,-1,&stack0xfffffff0,iVar1 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
  }
  FUN_676a9996(param_2,(LPCSTR)(uint)param_3,pCVar2,1);
  return;
}



// Function: FUN_676a9996 at 676a9996

DWORD FUN_676a9996(LPCWSTR param_1,LPCSTR param_2,LPCSTR param_3,int param_4)

{
  int iVar1;
  HMODULE hModule;
  DWORD DVar2;
  HRSRC hResInfo;
  LPCSTR pCVar3;
  
  if (param_1 == (LPCWSTR)0x0) {
    pCVar3 = (LPCSTR)0x0;
  }
  else {
    pCVar3 = &stack0xffffffe4;
    iVar1 = lstrlenW(param_1);
    FUN_676b06a0();
    WideCharToMultiByte(0,0,param_1,-1,&stack0xffffffe4,iVar1 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
  }
  hModule = LoadLibraryExA(pCVar3,(HANDLE)0x0,2);
  if (hModule == (HMODULE)0x0) {
    DVar2 = GetLastError();
    if ((int)DVar2 < 1) {
      DVar2 = GetLastError();
    }
    else {
      DVar2 = GetLastError();
      DVar2 = DVar2 & 0xffff | 0x80070000;
    }
  }
  else {
    hResInfo = FindResourceA(hModule,param_2,param_3);
    if ((hResInfo == (HRSRC)0x0) ||
       (pCVar3 = (LPCSTR)LoadResource(hModule,hResInfo), pCVar3 == (LPCSTR)0x0)) {
      DVar2 = GetLastError();
      if ((int)DVar2 < 1) {
        DVar2 = GetLastError();
      }
      else {
        DVar2 = GetLastError();
        DVar2 = DVar2 & 0xffff | 0x80070000;
      }
    }
    else {
      DVar2 = SizeofResource(hModule,hResInfo);
      if (pCVar3[DVar2] != '\0') {
        FUN_676b06a0();
        FUN_676b06d0((undefined4 *)&stack0xffffffe4,(undefined4 *)pCVar3,DVar2 + 1);
        (&stack0xffffffe4)[DVar2] = 0;
        pCVar3 = &stack0xffffffe4;
      }
      DVar2 = FUN_676a9b77(pCVar3,param_4);
    }
    FreeLibrary(hModule);
  }
  return DVar2;
}



// Function: FUN_676a9abc at 676a9abc

void FUN_676a9abc(undefined4 param_1,LPCWSTR param_2,ushort param_3,LPCWSTR param_4)

{
  int iVar1;
  LPCSTR pCVar2;
  
  if (param_4 == (LPCWSTR)0x0) {
    pCVar2 = (LPCSTR)0x0;
  }
  else {
    pCVar2 = &stack0xfffffff0;
    iVar1 = lstrlenW(param_4);
    FUN_676b06a0();
    WideCharToMultiByte(0,0,param_4,-1,&stack0xfffffff0,iVar1 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
  }
  FUN_676a9996(param_2,(LPCSTR)(uint)param_3,pCVar2,0);
  return;
}



// Function: FUN_676a9b17 at 676a9b17

undefined4 FUN_676a9b17(int *param_1)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 3));
  uVar1 = FUN_676a9b3e(param_1);
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 3));
  return uVar1;
}



// Function: FUN_676a9b3e at 676a9b3e

undefined4 __fastcall FUN_676a9b3e(int *param_1)

{
  undefined4 *puVar1;
  int iVar2;
  
  iVar2 = 0;
  if (0 < param_1[1]) {
    do {
      puVar1 = *(undefined4 **)(*param_1 + iVar2 * 4);
      CoTaskMemFree((LPVOID)puVar1[1]);
      CoTaskMemFree((LPVOID)*puVar1);
      FUN_676b0bb3((undefined *)puVar1);
      iVar2 = iVar2 + 1;
    } while (iVar2 < param_1[1]);
  }
  param_1[1] = 0;
  return 0;
}



// Function: FUN_676a9b77 at 676a9b77

int FUN_676a9b77(LPCSTR param_1,int param_2)

{
  undefined4 uVar1;
  int iVar2;
  char *pcVar3;
  HKEY pHVar4;
  int extraout_EAX;
  int extraout_EAX_00;
  undefined4 *this;
  char *unaff_ESI;
  undefined4 *this_00;
  HKEY__ local_1008 [1017];
  undefined4 uStackY_24;
  
  FUN_676b06a0();
  iVar2 = FUN_676a9db5(this,param_1,(undefined4 *)&stack0xfffffff8);
  if (-1 < iVar2) {
    *this = unaff_ESI;
    pcVar3 = unaff_ESI;
    this_00 = this;
    while( true ) {
      if ((*pcVar3 == '\0') || (iVar2 = FUN_676a9cd0(this_00,(CHAR *)local_1008), iVar2 < 0))
      goto LAB_676a9c63;
      pHVar4 = (HKEY)FUN_676a9c75((LPCSTR)local_1008);
      if (pHVar4 == (HKEY)0x0) break;
      iVar2 = FUN_676a9cd0(this_00,(CHAR *)local_1008);
      if (iVar2 < 0) goto LAB_676a9c63;
      if ((char)local_1008[0].unused != '{') break;
      if (param_2 == 0) {
        uStackY_24 = 0x676a9c31;
        this_00 = (undefined4 *)FUN_676aa021(this_00,local_1008,pHVar4,0,0);
        iVar2 = extraout_EAX_00;
        if (extraout_EAX_00 < 0) goto LAB_676a9c63;
      }
      else {
        uVar1 = *this_00;
        uStackY_24 = 0x676a9c16;
        this_00 = (undefined4 *)FUN_676aa021(this_00,local_1008,pHVar4,param_2,0);
        iVar2 = extraout_EAX;
        if (extraout_EAX < 0) {
          *this_00 = uVar1;
          uStackY_24 = 0x676a9c63;
          FUN_676aa021(this_00,local_1008,pHVar4,0,0);
          goto LAB_676a9c63;
        }
      }
      FUN_676a9ca8(this_00);
      pcVar3 = (char *)*this_00;
    }
    iVar2 = -0x7ffdfff7;
LAB_676a9c63:
    CoTaskMemFree(unaff_ESI);
  }
  return iVar2;
}



// Function: FUN_676a9c75 at 676a9c75

undefined4 __cdecl FUN_676a9c75(LPCSTR param_1)

{
  int iVar1;
  undefined **ppuVar2;
  int iVar3;
  
  iVar3 = 0;
  ppuVar2 = &PTR_DAT_676bab78;
  do {
    iVar1 = lstrcmpiA(param_1,*ppuVar2);
    if (iVar1 == 0) {
      return (&DAT_676bab7c)[iVar3 * 2];
    }
    ppuVar2 = ppuVar2 + 2;
    iVar3 = iVar3 + 1;
  } while (ppuVar2 < &PTR_FUN_676babe8);
  return 0;
}



// Function: FUN_676a9ca8 at 676a9ca8

void __fastcall FUN_676a9ca8(undefined4 *param_1)

{
  char cVar1;
  LPSTR pCVar2;
  
  while( true ) {
    cVar1 = *(LPCSTR)*param_1;
    if ((cVar1 < '\t') || ((('\n' < cVar1 && (cVar1 != '\r')) && (cVar1 != ' ')))) break;
    pCVar2 = CharNextA((LPCSTR)*param_1);
    *param_1 = pCVar2;
  }
  return;
}



// Function: FUN_676a9cd0 at 676a9cd0

undefined4 __thiscall FUN_676a9cd0(void *this,CHAR *param_1)

{
  CHAR CVar1;
  char cVar2;
  char *pcVar3;
  int iVar4;
  LPSTR pCVar5;
  LPCSTR pCVar6;
  undefined4 uVar7;
  CHAR *pCVar8;
  
  FUN_676a9ca8((undefined4 *)this);
                    /* WARNING: Load size is inaccurate */
  pCVar6 = *this;
  cVar2 = *pCVar6;
  if (cVar2 == '\0') {
LAB_676a9d4e:
    uVar7 = 0x80020009;
  }
  else {
    if (cVar2 == '\'') {
      pcVar3 = CharNextA(pCVar6);
      *(char **)this = pcVar3;
      pCVar8 = param_1;
      while ((*pcVar3 != '\0' && (iVar4 = FUN_676a9d9b((undefined4 *)this), iVar4 == 0))) {
                    /* WARNING: Load size is inaccurate */
        if (**this == '\'') {
          pCVar5 = CharNextA(*this);
          *(LPSTR *)this = pCVar5;
        }
                    /* WARNING: Load size is inaccurate */
        pCVar6 = *this;
        pCVar5 = CharNextA(pCVar6);
        *(LPSTR *)this = pCVar5;
        if (param_1 + 0x1000 <= pCVar8 + 2) goto LAB_676a9d4e;
        if (pCVar6 < pCVar5) {
          do {
            CVar1 = *pCVar6;
            pCVar6 = pCVar6 + 1;
            *pCVar8 = CVar1;
            pCVar8 = pCVar8 + 1;
                    /* WARNING: Load size is inaccurate */
          } while (pCVar6 < *this);
        }
                    /* WARNING: Load size is inaccurate */
        pcVar3 = *this;
      }
                    /* WARNING: Load size is inaccurate */
      if (**this == '\0') goto LAB_676a9d4e;
      *pCVar8 = '\0';
                    /* WARNING: Load size is inaccurate */
      pCVar5 = CharNextA(*this);
      *(LPSTR *)this = pCVar5;
    }
    else {
      do {
        if (('\b' < cVar2) && (((cVar2 < '\v' || (cVar2 == '\r')) || (cVar2 == ' ')))) break;
        pCVar5 = CharNextA(pCVar6);
        *(LPSTR *)this = pCVar5;
        if (pCVar6 < pCVar5) {
          do {
            CVar1 = *pCVar6;
            pCVar6 = pCVar6 + 1;
            *param_1 = CVar1;
            param_1 = param_1 + 1;
                    /* WARNING: Load size is inaccurate */
          } while (pCVar6 < *this);
        }
                    /* WARNING: Load size is inaccurate */
        pCVar6 = *this;
        cVar2 = *pCVar6;
      } while (cVar2 != '\0');
      *param_1 = '\0';
    }
    uVar7 = 0;
  }
  return uVar7;
}



// Function: FUN_676a9d9b at 676a9d9b

undefined4 __fastcall FUN_676a9d9b(undefined4 *param_1)

{
  LPSTR pCVar1;
  
  if (*(LPCSTR)*param_1 == '\'') {
    pCVar1 = CharNextA((LPCSTR)*param_1);
    if (*pCVar1 != '\'') {
      return 1;
    }
  }
  return 0;
}



// Function: FUN_676a9db5 at 676a9db5

int __thiscall FUN_676a9db5(void *this,LPCSTR param_1,undefined4 *param_2)

{
  char cVar1;
  LPVOID pvVar2;
  int iVar3;
  BYTE *lpsz;
  LPSTR pCVar4;
  LPCWSTR pWVar5;
  BYTE *pBVar6;
  CHAR local_30 [32];
  undefined4 local_10;
  SIZE_T local_c;
  LPVOID local_8;
  
  *param_2 = 0;
  iVar3 = lstrlenA(param_1);
  local_c = iVar3 << 1;
  local_10 = 0;
  local_8 = CoTaskMemAlloc(local_c);
  if (local_8 == (LPVOID)0x0) {
    param_1 = (LPCSTR)0x8007000e;
  }
  else {
    *(LPCSTR *)this = param_1;
    cVar1 = *param_1;
    param_1 = (LPCSTR)0x0;
    while (cVar1 != '\0') {
                    /* WARNING: Load size is inaccurate */
      lpsz = *this;
      if (*lpsz == '%') {
        lpsz = (BYTE *)CharNextA((LPCSTR)lpsz);
        *(BYTE **)this = lpsz;
        if (*lpsz == '%') goto LAB_676a9e17;
        while( true ) {
          if (*lpsz == '\0') goto LAB_676a9e8b;
          if (*lpsz == '%') break;
          lpsz = (BYTE *)CharNextA((LPCSTR)lpsz);
        }
        if (lpsz == (BYTE *)0x0) {
LAB_676a9e8b:
          param_1 = (LPCSTR)0x80020009;
          break;
        }
                    /* WARNING: Load size is inaccurate */
        iVar3 = (int)lpsz - (int)*this;
        if (0x1f < iVar3) {
          param_1 = (LPCSTR)0x80004005;
          break;
        }
        lstrcpynA(local_30,*this,iVar3 + 1);
        pWVar5 = (LPCWSTR)FUN_676a9f70(*(void **)((int)this + 4),local_30);
        if (pWVar5 == (LPCWSTR)0x0) goto LAB_676a9e8b;
        FUN_676a9f10(&local_10,pWVar5);
                    /* WARNING: Load size is inaccurate */
        pBVar6 = *this;
        while (pBVar6 != lpsz) {
                    /* WARNING: Load size is inaccurate */
          pBVar6 = (BYTE *)CharNextA(*this);
          *(BYTE **)this = pBVar6;
        }
      }
      else {
LAB_676a9e17:
        FUN_676a9ec1(&local_10,lpsz);
      }
                    /* WARNING: Load size is inaccurate */
      pCVar4 = CharNextA(*this);
      *(LPSTR *)this = pCVar4;
      cVar1 = *pCVar4;
    }
                    /* WARNING: Load size is inaccurate */
    FUN_676a9ec1(&local_10,*this);
    pvVar2 = local_8;
    if (-1 < (int)param_1) {
      local_8 = (LPVOID)0x0;
      *param_2 = pvVar2;
    }
  }
  CoTaskMemFree(local_8);
  return (int)param_1;
}



// Function: FUN_676a9ec1 at 676a9ec1

undefined4 __thiscall FUN_676a9ec1(void *this,BYTE *param_1)

{
  SIZE_T cb;
  LPVOID pvVar1;
  BOOL BVar2;
  
                    /* WARNING: Load size is inaccurate */
  if (*this == *(int *)((int)this + 4)) {
    cb = *(int *)((int)this + 4) * 2;
    *(SIZE_T *)((int)this + 4) = cb;
    pvVar1 = CoTaskMemRealloc(*(LPVOID *)((int)this + 8),cb);
    *(LPVOID *)((int)this + 8) = pvVar1;
  }
                    /* WARNING: Load size is inaccurate */
  *(BYTE *)(*(int *)((int)this + 8) + *this) = *param_1;
                    /* WARNING: Load size is inaccurate */
  *(int *)this = *this + 1;
  BVar2 = IsDBCSLeadByte(*param_1);
  if (BVar2 != 0) {
                    /* WARNING: Load size is inaccurate */
    *(BYTE *)(*(int *)((int)this + 8) + *this) = param_1[1];
                    /* WARNING: Load size is inaccurate */
    *(int *)this = *this + 1;
  }
  return 1;
}



// Function: FUN_676a9f10 at 676a9f10

undefined4 __thiscall FUN_676a9f10(void *this,LPCWSTR param_1)

{
  int iVar1;
  BYTE *pBVar2;
  
  if (param_1 == (LPCWSTR)0x0) {
    pBVar2 = (BYTE *)0x0;
  }
  else {
    pBVar2 = &stack0xffffffec;
    iVar1 = lstrlenW(param_1);
    FUN_676b06a0();
    WideCharToMultiByte(0,0,param_1,-1,&stack0xffffffec,iVar1 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
  }
  for (; *pBVar2 != '\0'; pBVar2 = pBVar2 + 1) {
    FUN_676a9ec1(this,pBVar2);
  }
  return 1;
}



// Function: FUN_676a9f70 at 676a9f70

undefined4 __thiscall FUN_676a9f70(void *this,LPCSTR param_1)

{
  undefined4 uVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)((int)this + 0xc));
  uVar1 = FUN_676a9f99(this,param_1);
  LeaveCriticalSection((LPCRITICAL_SECTION)((int)this + 0xc));
  return uVar1;
}



// Function: FUN_676a9f99 at 676a9f99

undefined4 __thiscall FUN_676a9f99(void *this,LPCSTR param_1)

{
  LPCWSTR lpString;
  LPCSTR lpString1;
  int iVar1;
  int local_8;
  
  local_8 = 0;
  if (0 < *(int *)((int)this + 4)) {
    do {
                    /* WARNING: Load size is inaccurate */
      lpString = (LPCWSTR)**(undefined4 **)(*this + local_8 * 4);
      if (lpString == (LPCWSTR)0x0) {
        lpString1 = (LPCSTR)0x0;
      }
      else {
        lpString1 = &stack0xffffffe8;
        iVar1 = lstrlenW(lpString);
        FUN_676b06a0();
        WideCharToMultiByte(0,0,lpString,-1,&stack0xffffffe8,iVar1 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
      }
      iVar1 = lstrcmpiA(lpString1,param_1);
      if (iVar1 == 0) {
                    /* WARNING: Load size is inaccurate */
        return *(undefined4 *)(*(int *)(*this + local_8 * 4) + 4);
      }
      local_8 = local_8 + 1;
    } while (local_8 < *(int *)((int)this + 4));
  }
  return 0;
}



// Function: FUN_676aa021 at 676aa021

int __thiscall FUN_676aa021(void *param_1,HKEY param_2,HKEY param_3,int param_4,int param_5)

{
  HKEY lpString1;
  int iVar1;
  int iVar2;
  HKEY pHVar3;
  LSTATUS LVar4;
  undefined3 extraout_var;
  int extraout_EAX;
  undefined3 extraout_var_00;
  int extraout_EAX_00;
  char cVar5;
  int unaff_ESI;
  undefined **ppuVar6;
  bool bVar7;
  CHAR local_120 [260];
  DWORD local_1c;
  int local_18;
  int local_14;
  LPSTR local_10;
  void *local_c;
  HKEY local_8;
  
  lpString1 = param_2;
  local_8 = (HKEY)0x0;
  local_10 = (LPSTR)0x0;
  local_14 = 1;
  local_18 = param_5;
  local_c = param_1;
  iVar1 = FUN_676a9cd0(param_1,(CHAR *)param_2);
joined_r0x676aa052:
  if (-1 < iVar1) {
LAB_676aa058:
    do {
      if ((char)lpString1->unused == '}') goto LAB_676aa4d2;
      iVar1 = lstrcmpiA((LPCSTR)lpString1,s_Delete_676c0e3c);
      iVar2 = lstrcmpiA((LPCSTR)lpString1,s_ForceRemove_676c0e50);
      if ((iVar2 == 0) || (iVar1 == 0)) {
        iVar2 = FUN_676a9cd0(local_c,(CHAR *)lpString1);
        if (iVar2 < 0) goto LAB_676aa4d2;
        if (param_4 == 0) goto LAB_676aa14f;
        param_2 = (HKEY)0x0;
        cVar5 = (char)lpString1->unused;
        pHVar3 = lpString1;
        while (cVar5 != '\0') {
          if (cVar5 == '\\') {
            if (pHVar3 != (HKEY)0x0) {
              if (param_2 != (HKEY)0x0) {
                RegCloseKey(param_2);
                param_2 = (HKEY)0x0;
              }
              bVar7 = local_8 == (HKEY)0x0;
              goto LAB_676aa4fa;
            }
            break;
          }
          pHVar3 = (HKEY)CharNextA((LPCSTR)pHVar3);
          cVar5 = (char)pHVar3->unused;
        }
        ppuVar6 = &PTR_s_CLSID_676c0e24;
        do {
          iVar2 = lstrcmpiA((LPCSTR)lpString1,*ppuVar6);
          if (iVar2 == 0) goto LAB_676aa0fd;
          ppuVar6 = ppuVar6 + 1;
        } while ((int)ppuVar6 < 0x676c0e2c);
        param_2 = param_3;
        FUN_676aa50c(&param_2,(LPCSTR)lpString1);
        param_2 = (HKEY)0x0;
LAB_676aa0fd:
        if (iVar1 != 0) {
          if (param_2 != (HKEY)0x0) {
            RegCloseKey(param_2);
          }
          goto LAB_676aa14f;
        }
        iVar1 = FUN_676a9cd0(local_c,(CHAR *)lpString1);
        if ((iVar1 < 0) || (iVar1 = FUN_676aa913((CHAR *)lpString1), iVar1 < 0)) {
          if (param_2 != (HKEY)0x0) {
            RegCloseKey(param_2);
          }
          goto LAB_676aa4d2;
        }
        if (param_2 != (HKEY)0x0) {
          RegCloseKey(param_2);
        }
      }
      else {
LAB_676aa14f:
        iVar1 = lstrcmpiA((LPCSTR)lpString1,s_NoRemove_676c0e44);
        if (iVar1 == 0) {
          local_14 = 0;
          iVar1 = FUN_676a9cd0(local_c,(CHAR *)lpString1);
          if (iVar1 < 0) goto LAB_676aa4d2;
        }
        iVar1 = lstrcmpiA((LPCSTR)lpString1,&DAT_676c0e5c);
        if (iVar1 == 0) {
          iVar1 = FUN_676a9cd0(local_c,local_120);
          if ((iVar1 < 0) || (iVar1 = FUN_676a9cd0(local_c,(CHAR *)lpString1), iVar1 < 0))
          goto LAB_676aa4d2;
          if ((char)lpString1->unused != '=') {
            bVar7 = local_8 == (HKEY)0x0;
            goto LAB_676aa4fa;
          }
          if (param_4 == 0) {
            if (param_5 == 0) {
              RegDeleteValueA(param_3,local_120);
            }
            iVar1 = FUN_676aa913((CHAR *)lpString1);
            goto joined_r0x676aa052;
          }
          param_2 = param_3;
          iVar1 = FUN_676aa5f0(&param_2,local_120,(CHAR *)lpString1);
          param_2 = (HKEY)0x0;
        }
        else {
          cVar5 = (char)lpString1->unused;
          pHVar3 = lpString1;
          while (cVar5 != '\0') {
            if (cVar5 == '\\') {
              if (pHVar3 != (HKEY)0x0) goto LAB_676aa4f7;
              break;
            }
            pHVar3 = (HKEY)CharNextA((LPCSTR)pHVar3);
            cVar5 = (char)pHVar3->unused;
          }
          if (param_4 == 0) {
            if ((param_5 == 0) &&
               (iVar1 = FUN_6769ac88(&local_8,param_3,(LPCSTR)lpString1,0x20019), iVar1 != 0)) {
              param_5 = 1;
            }
            if (local_10 == (LPSTR)0x0) {
              FUN_676b06a0();
              local_10 = &stack0xfffffed4;
            }
            lstrcpynA(local_10,(LPCSTR)lpString1,0x104);
            if (((param_5 != 0) ||
                (bVar7 = FUN_676aa867(local_8), CONCAT31(extraout_var,bVar7) != 0)) ||
               (iVar1 = FUN_676aa89c(local_8), iVar1 != 0)) {
              iVar1 = FUN_676a9cd0(local_c,(CHAR *)lpString1);
              if ((iVar1 < 0) || (iVar1 = FUN_676aa913((CHAR *)lpString1), iVar1 < 0))
              goto LAB_676aa4d2;
              if ((char)lpString1->unused == '{') {
                FUN_676aa021(local_c,lpString1,local_8,0,param_5);
                if (extraout_EAX < 0) goto LAB_676aa4d2;
                if (param_5 != 0) {
                  param_5 = local_18;
                  iVar1 = FUN_676a9cd0(local_c,(CHAR *)lpString1);
                  if (iVar1 < 0) goto LAB_676aa4d2;
                  iVar1 = FUN_676aa913((CHAR *)lpString1);
                  goto joined_r0x676aa052;
                }
              }
              else if (param_5 != 0) goto LAB_676aa058;
              bVar7 = FUN_676aa867(local_8);
              if (CONCAT31(extraout_var_00,bVar7) != 0) {
                ppuVar6 = &PTR_s_CLSID_676c0e24;
                goto LAB_676aa3de;
              }
            }
            if (local_8 != (HKEY)0x0) {
              LVar4 = RegCloseKey(local_8);
              local_8 = (HKEY)0x0;
              if (LVar4 != 0) {
                return unaff_ESI;
              }
            }
            if (local_14 != 0) {
              RegDeleteKeyA(param_3,local_10);
            }
            iVar1 = FUN_676a9cd0(local_c,(CHAR *)lpString1);
            if (iVar1 < 0) goto LAB_676aa4d2;
            iVar1 = FUN_676aa913((CHAR *)lpString1);
          }
          else {
            iVar1 = FUN_6769ac88(&local_8,param_3,(LPCSTR)lpString1,0xf003f);
            if ((iVar1 != 0) &&
               (iVar1 = FUN_6769ac88(&local_8,param_3,(LPCSTR)lpString1,0x20019), iVar1 != 0)) {
              param_2 = (HKEY)0x0;
              LVar4 = RegCreateKeyExA(param_3,(LPCSTR)lpString1,0,(LPSTR)0x0,0,0xf003f,
                                      (LPSECURITY_ATTRIBUTES)0x0,&param_2,&local_1c);
              if (LVar4 == 0) {
                iVar1 = 0;
                if (local_8 != (HKEY)0x0) {
                  iVar1 = RegCloseKey(local_8);
                }
                local_8 = param_2;
                if (iVar1 == 0) goto LAB_676aa2b4;
              }
LAB_676aa4f7:
              bVar7 = local_8 == (HKEY)0x0;
LAB_676aa4fa:
              if (bVar7) {
                return unaff_ESI;
              }
              RegCloseKey(local_8);
              return unaff_ESI;
            }
LAB_676aa2b4:
            iVar1 = FUN_676a9cd0(local_c,(CHAR *)lpString1);
            if (iVar1 < 0) goto LAB_676aa4d2;
            if ((char)lpString1->unused != '=') goto LAB_676aa45a;
            iVar1 = FUN_676aa5f0(&local_8,(LPCSTR)0x0,(CHAR *)lpString1);
          }
        }
        if (iVar1 < 0) goto LAB_676aa4d2;
      }
LAB_676aa45a:
    } while (((param_4 == 0) || ((char)lpString1->unused != '{')) ||
            (iVar1 = lstrlenA((LPCSTR)lpString1), iVar1 != 1));
    FUN_676aa021(local_c,lpString1,local_8,param_4,0);
    if (-1 < extraout_EAX_00) goto LAB_676aa494;
  }
LAB_676aa4d2:
  if (local_8 != (HKEY)0x0) {
    RegCloseKey(local_8);
  }
  return unaff_ESI;
  while (ppuVar6 = ppuVar6 + 1, (int)ppuVar6 < 0x676c0e2c) {
LAB_676aa3de:
    iVar1 = lstrcmpiA(local_10,*ppuVar6);
    if (iVar1 == 0) goto LAB_676aa494;
  }
  FUN_676aa50c(&local_8,local_10);
LAB_676aa494:
  iVar1 = FUN_676a9cd0(local_c,(CHAR *)lpString1);
  goto joined_r0x676aa052;
}



// Function: FUN_676aa50c at 676aa50c

int __thiscall FUN_676aa50c(void *this,LPCSTR param_1)

{
  int iVar1;
  LSTATUS LVar2;
  CHAR local_118 [256];
  _FILETIME local_18;
  int local_10;
  DWORD local_c;
  HKEY local_8;
  
                    /* WARNING: Load size is inaccurate */
  local_8 = (HKEY)0x0;
  iVar1 = FUN_6769ac88(&local_8,*this,param_1,0x2001f);
  if (iVar1 == 0) {
    while( true ) {
      local_c = 0x100;
      LVar2 = RegEnumKeyExA(local_8,0,local_118,&local_c,(LPDWORD)0x0,(LPSTR)0x0,(LPDWORD)0x0,
                            &local_18);
      if (LVar2 != 0) break;
      local_10 = FUN_676aa50c(&local_8,local_118);
      if (local_10 != 0) {
        if (local_8 == (HKEY)0x0) {
          return local_10;
        }
        RegCloseKey(local_8);
        return local_10;
      }
      local_10 = 0;
    }
    if (local_8 != (HKEY)0x0) {
      RegCloseKey(local_8);
      local_8 = (HKEY)0x0;
    }
                    /* WARNING: Load size is inaccurate */
    iVar1 = RegDeleteKeyA(*this,param_1);
    if (local_8 != (HKEY)0x0) {
      RegCloseKey(local_8);
    }
  }
  else if (local_8 != (HKEY)0x0) {
    RegCloseKey(local_8);
  }
  return iVar1;
}



// Function: FUN_676aa5f0 at 676aa5f0

int FUN_676aa5f0(undefined4 *param_1,LPCSTR param_2,CHAR *param_3)

{
  char cVar1;
  int iVar2;
  uint uVar3;
  undefined4 *this;
  undefined4 unaff_EDI;
  uint uVar4;
  CHAR local_2018 [4096];
  BYTE local_1018 [4076];
  undefined4 uStackY_2c;
  DWORD dwType;
  BYTE *lpData;
  DWORD cbData;
  short sVar5;
  
  FUN_676b06a0();
  iVar2 = FUN_676a9cd0(this,local_2018);
  uVar4 = 0;
  if (iVar2 < 0) {
    return iVar2;
  }
  iVar2 = FUN_676aa7b5(local_2018,(undefined2 *)&stack0xfffffff2);
  if (iVar2 == 0) {
    return -0x7ffdfff7;
  }
  FUN_676a9ca8(this);
  lpData = (BYTE *)0x676aa650;
  iVar2 = FUN_676a9cd0(this,(CHAR *)local_1018);
  if (iVar2 < 0) {
    return iVar2;
  }
  sVar5 = (short)((uint)unaff_EDI >> 0x10);
  if (sVar5 == 8) {
    iVar2 = lstrlenA((LPCSTR)local_1018);
    cbData = iVar2 + 1;
    lpData = local_1018;
    dwType = 1;
  }
  else {
    if (sVar5 == 0x11) {
      lpData = &stack0xfffffff0;
      uVar3 = lstrlenA((LPCSTR)local_1018);
      if ((uVar3 & 1) == 0) {
        FUN_676b06a0();
        _memset(&stack0xfffffff0,0,(int)uVar3 / 2);
        if (&stack0x00000000 != (undefined1 *)0x10) {
          if (0 < (int)uVar3) {
            do {
              cVar1 = FUN_676aa83c(local_1018[uVar4]);
              (&stack0xfffffff0)[(int)uVar4 / 2] =
                   (&stack0xfffffff0)[(int)uVar4 / 2] |
                   cVar1 << (4U - (char)((uVar4 & 1) << 2) & 0x1f);
              uVar4 = uVar4 + 1;
            } while ((int)uVar4 < (int)uVar3);
          }
          uStackY_2c = 0x676aa76c;
          RegSetValueExA((HKEY)*param_1,param_2,0,3,&stack0xfffffff0,(int)uVar3 / 2);
          goto LAB_676aa797;
        }
      }
      return -0x7fffbffb;
    }
    if (sVar5 != 0x13) goto LAB_676aa797;
    if (&stack0x00000000 != (undefined1 *)0x1018) {
      iVar2 = lstrlenA((LPCSTR)local_1018);
      FUN_676b06a0();
      uStackY_2c = 0x676aa6b5;
      MultiByteToWideChar(0,0,(LPCSTR)local_1018,-1,(LPWSTR)&stack0xfffffff0,iVar2 + 1);
    }
    Ordinal_277();
    cbData = 4;
    lpData = &stack0xfffffff4;
    dwType = 4;
  }
  uStackY_2c = 0x676aa797;
  RegSetValueExA((HKEY)*param_1,param_2,0,dwType,lpData,cbData);
LAB_676aa797:
  iVar2 = FUN_676a9cd0(lpData,param_3);
  if (-1 < iVar2) {
    iVar2 = 0;
  }
  return iVar2;
}



// Function: FUN_676aa7b5 at 676aa7b5

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 __cdecl FUN_676aa7b5(LPCSTR param_1,undefined2 *param_2)

{
  int iVar1;
  undefined4 *puVar2;
  int iVar3;
  
  if ((DAT_676c5a10 & 1) == 0) {
    DAT_676c5a10 = DAT_676c5a10 | 1;
    DAT_676c5610 = &DAT_676c0e68;
    DAT_676c5618 = &DAT_676c0e64;
    DAT_676c5614 = 8;
    _DAT_676c561c = 0x13;
    _DAT_676c5620 = &DAT_676c0e60;
    _DAT_676c5624 = 0x11;
  }
  iVar3 = 0;
  puVar2 = &DAT_676c5610;
  do {
    iVar1 = lstrcmpiA(param_1,(LPCSTR)*puVar2);
    if (iVar1 == 0) {
      *param_2 = (&DAT_676c5614)[iVar3 * 4];
      return 1;
    }
    puVar2 = puVar2 + 2;
    iVar3 = iVar3 + 1;
  } while (puVar2 < &DAT_676c5628);
  return 0;
}



// Function: FUN_676aa83c at 676aa83c

char __cdecl FUN_676aa83c(char param_1)

{
  if ('/' < param_1) {
    if (param_1 < ':') {
      return param_1 + -0x30;
    }
    if ('@' < param_1) {
      if (param_1 < 'G') {
        return param_1 + -0x37;
      }
      if (('`' < param_1) && (param_1 < 'g')) {
        return param_1 + -0x57;
      }
    }
  }
  return '\0';
}



// Function: FUN_676aa867 at 676aa867

bool FUN_676aa867(HKEY param_1)

{
  LSTATUS LVar1;
  DWORD local_8;
  
  local_8 = 0;
  LVar1 = RegQueryInfoKeyA(param_1,(LPSTR)0x0,(LPDWORD)0x0,(LPDWORD)0x0,&local_8,(LPDWORD)0x0,
                           (LPDWORD)0x0,(LPDWORD)0x0,(LPDWORD)0x0,(LPDWORD)0x0,(LPDWORD)0x0,
                           (PFILETIME)0x0);
  return -1 < LVar1 && local_8 != 0;
}



// Function: FUN_676aa89c at 676aa89c

/* WARNING: Removing unreachable block (ram,0x676aa8d0) */
/* WARNING: Removing unreachable block (ram,0x676aa8f4) */
/* WARNING: Removing unreachable block (ram,0x676aa8fc) */

undefined4 FUN_676aa89c(HKEY param_1)

{
  FUN_676b06a0();
  RegQueryInfoKeyA(param_1,(LPSTR)0x0,(LPDWORD)0x0,(LPDWORD)0x0,(LPDWORD)0x0,(LPDWORD)0x0,
                   (LPDWORD)0x0,(LPDWORD)&stack0xfffffff8,(LPDWORD)0x0,(LPDWORD)0x0,(LPDWORD)0x0,
                   (PFILETIME)0x0);
  return 0;
}



// Function: FUN_676aa913 at 676aa913

int FUN_676aa913(CHAR *param_1)

{
  int iVar1;
  undefined4 *this;
  CHAR local_1004 [4080];
  undefined4 uStackY_14;
  
  FUN_676b06a0();
  if (*param_1 == '=') {
    uStackY_14 = 0x676aa932;
    iVar1 = FUN_676a9cd0(this,param_1);
    if (iVar1 < 0) {
      return iVar1;
    }
    FUN_676a9ca8(this);
    uStackY_14 = 0x676aa94b;
    iVar1 = FUN_676a9cd0(this,local_1004);
    if (iVar1 < 0) {
      return iVar1;
    }
    uStackY_14 = 0x676aa957;
    iVar1 = FUN_676a9cd0(this,param_1);
    if (iVar1 < 0) {
      return iVar1;
    }
  }
  return 0;
}



// Function: FUN_676aa963 at 676aa963

int FUN_676aa963(short *param_1)

{
  short sVar1;
  short *psVar2;
  short *psVar3;
  
  sVar1 = *param_1;
  psVar2 = param_1;
  psVar3 = param_1;
  while (sVar1 != 0) {
    sVar1 = *psVar3;
    if (sVar1 != 0) {
      psVar3 = psVar3 + 1;
    }
    if (((sVar1 == 0x5c) || (sVar1 == 0x2f)) || (sVar1 == 0x3a)) {
      psVar2 = psVar3;
    }
    sVar1 = *psVar3;
  }
  return (int)psVar2 - (int)param_1 >> 1;
}



// Function: FUN_676aa99f at 676aa99f

undefined4 FUN_676aa99f(int *param_1,int param_2,int param_3)

{
  undefined4 uVar1;
  int *piVar2;
  
  if (param_1 == (int *)0x0) {
    uVar1 = 0x80070057;
  }
  else {
    param_1[4] = param_2;
    param_1[5] = 0;
    param_1[2] = param_3;
    param_1[3] = param_3;
    param_1[1] = param_3;
    param_1[6] = 0;
    InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 7));
    InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xd));
    InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x13));
    piVar2 = (int *)param_1[4];
    param_1[0x1a] = 0;
    *(undefined1 *)(param_1 + 0x1b) = 1;
    param_1[0x1d] = 0;
    param_1[0x1f] = 0;
    param_1[0x1e] = 0;
    param_1[0x20] = 0;
    if (piVar2 != (int *)0x0) {
      while (*piVar2 != 0) {
        (*(code *)piVar2[8])(1);
        if (*param_1 == 100) {
          piVar2 = piVar2 + 7;
        }
        else {
          piVar2 = piVar2 + 9;
        }
      }
    }
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_676aaa22 at 676aaa22

int * FUN_676aaa22(int *param_1,int *param_2,undefined4 param_3,int *param_4)

{
  int *piVar1;
  int *piVar2;
  undefined4 *puVar3;
  
  piVar2 = param_1;
  if (param_1 == (int *)0x0) {
    param_1 = (int *)0x80070057;
  }
  else {
    param_1 = (int *)0x0;
    puVar3 = (undefined4 *)piVar2[4];
    if (param_4 == (int *)0x0) {
      param_1 = (int *)0x80004003;
    }
    else {
      *param_4 = 0;
      piVar1 = (int *)*puVar3;
      while (piVar1 != (int *)0x0) {
        if ((((puVar3[2] != 0) && (*param_2 == *piVar1)) && (param_2[1] == piVar1[1])) &&
           ((param_2[2] == piVar1[2] && (param_2[3] == piVar1[3])))) {
          piVar1 = puVar3 + 4;
          if (puVar3[4] == 0) {
            EnterCriticalSection((LPCRITICAL_SECTION)(piVar2 + 0x13));
            if (*piVar1 == 0) {
              param_1 = (int *)(*(code *)puVar3[2])(puVar3[3],&DAT_676bb600,piVar1);
            }
            LeaveCriticalSection((LPCRITICAL_SECTION)(piVar2 + 0x13));
          }
          puVar3 = (undefined4 *)*piVar1;
          if (puVar3 != (undefined4 *)0x0) {
            param_1 = (int *)(**(code **)*puVar3)(puVar3,param_3,param_4);
          }
          break;
        }
        if (*piVar2 == 100) {
          puVar3 = puVar3 + 7;
        }
        else {
          puVar3 = puVar3 + 9;
        }
        piVar1 = (int *)*puVar3;
      }
      if ((*param_4 == 0) && (param_1 == (int *)0x0)) {
        param_1 = (int *)0x80040111;
      }
    }
  }
  return param_1;
}



// Function: FUN_676aaaf5 at 676aaaf5

undefined4 FUN_676aaaf5(int *param_1)

{
  int *piVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  int *piVar5;
  uint uVar6;
  
  if (param_1 == (int *)0x0) {
    uVar4 = 0x80070057;
  }
  else {
    piVar5 = (int *)param_1[4];
    if (piVar5 != (int *)0x0) {
      while (*piVar5 != 0) {
        piVar1 = (int *)piVar5[4];
        if (piVar1 != (int *)0x0) {
          (**(code **)(*piVar1 + 8))(piVar1);
        }
        piVar5[4] = 0;
        (*(code *)piVar5[8])(0);
        if (*param_1 == 100) {
          piVar5 = piVar5 + 7;
        }
        else {
          piVar5 = piVar5 + 9;
        }
      }
    }
    DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 7));
    DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xd));
    DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x13));
    puVar3 = (undefined4 *)param_1[0x20];
    while (puVar3 != (undefined4 *)0x0) {
      (*(code *)*puVar3)(puVar3[1]);
      puVar2 = (undefined4 *)puVar3[2];
      FUN_676b0bb3((undefined *)puVar3);
      puVar3 = puVar2;
    }
    if ((param_1[6] != 0) && ((char)param_1[0x1b] != '\0')) {
      if (param_1[0x1e] != 0) {
        uVar6 = 0;
        do {
          HeapDestroy(*(HANDLE *)(param_1[0x1e] + uVar6 * 4));
          uVar6 = uVar6 + 1;
        } while (uVar6 <= (uint)param_1[0x1d]);
      }
      HeapDestroy((HANDLE)param_1[6]);
    }
    uVar4 = 0;
  }
  return uVar4;
}



// Function: FUN_676aaba5 at 676aaba5

int FUN_676aaba5(int *param_1,int param_2,void *param_3)

{
  int iVar1;
  void *_Buf2;
  int iVar2;
  int *piVar3;
  int *piVar4;
  
  if (param_1 == (int *)0x0) {
    iVar1 = -0x7ff8ffa9;
  }
  else {
    piVar4 = (int *)param_1[4];
    iVar1 = 0;
    _Buf2 = (void *)*piVar4;
    if (_Buf2 != (void *)0x0) {
      do {
        if (param_3 == (void *)0x0) {
          if ((code *)piVar4[6] != (code *)0x0) {
            iVar2 = (*(code *)piVar4[6])();
            goto LAB_676aabe6;
          }
LAB_676aabea:
          iVar1 = (*(code *)piVar4[1])(1);
          if (iVar1 < 0) {
            return iVar1;
          }
          if (*param_1 == 0x84) {
            iVar1 = 1;
            piVar3 = (int *)(*(code *)piVar4[7])();
            iVar1 = FUN_676aac40(*piVar4,piVar3,iVar1);
            if (iVar1 < 0) {
              return iVar1;
            }
          }
        }
        else {
          iVar2 = _memcmp(param_3,_Buf2,0x10);
LAB_676aabe6:
          if (iVar2 == 0) goto LAB_676aabea;
        }
        if (*param_1 == 100) {
          piVar4 = piVar4 + 7;
        }
        else {
          piVar4 = piVar4 + 9;
        }
        _Buf2 = (void *)*piVar4;
      } while (_Buf2 != (void *)0x0);
      if (iVar1 < 0) {
        return iVar1;
      }
    }
    if (param_2 != 0) {
      iVar1 = FUN_676aaf90((int)param_1,(LPCWSTR)0x0);
    }
  }
  return iVar1;
}



// Function: FUN_676aac40 at 676aac40

int FUN_676aac40(undefined4 param_1,int *param_2,int param_3)

{
  undefined4 *puVar1;
  HRESULT HVar2;
  int iVar3;
  undefined4 local_18;
  undefined4 uStack_14;
  undefined4 uStack_10;
  undefined4 uStack_c;
  int *local_8;
  
  local_8 = (int *)0x0;
  if (param_2 != (int *)0x0) {
    HVar2 = CoCreateInstance((IID *)&DAT_676bb650,(LPUNKNOWN)0x0,1,(IID *)&DAT_676bb660,&local_8);
    if (-1 < HVar2) {
      iVar3 = *param_2;
      while (iVar3 != 0) {
        puVar1 = (undefined4 *)param_2[1];
        local_18 = *puVar1;
        uStack_14 = puVar1[1];
        uStack_10 = puVar1[2];
        uStack_c = puVar1[3];
        if (param_3 == 0) {
          if (*param_2 == 1) {
            (**(code **)(*local_8 + 0x18))();
          }
          else {
            (**(code **)(*local_8 + 0x20))(local_8,param_1,1,&local_18);
          }
        }
        else {
          if (*param_2 == 1) {
            iVar3 = (**(code **)(*local_8 + 0x14))();
          }
          else {
            iVar3 = (**(code **)(*local_8 + 0x1c))(local_8,param_1,1,&local_18);
          }
          if (iVar3 < 0) {
            if (local_8 == (int *)0x0) {
              return iVar3;
            }
            (**(code **)(*local_8 + 8))(local_8);
            return iVar3;
          }
        }
        param_2 = param_2 + 2;
        iVar3 = *param_2;
      }
    }
    if (local_8 != (int *)0x0) {
      (**(code **)(*local_8 + 8))(local_8);
    }
  }
  return 0;
}



// Function: FUN_676aacfe at 676aacfe

undefined4 FUN_676aacfe(int *param_1,int param_2,void *param_3)

{
  undefined4 uVar1;
  int iVar2;
  int *piVar3;
  undefined4 *puVar4;
  
  if (param_1 == (int *)0x0) {
    uVar1 = 0x80070057;
  }
  else {
    puVar4 = (undefined4 *)param_1[4];
    while( true ) {
      if ((void *)*puVar4 == (void *)0x0) break;
      if (param_3 == (void *)0x0) {
        if ((code *)puVar4[6] != (code *)0x0) {
          iVar2 = (*(code *)puVar4[6])();
          goto LAB_676aad3b;
        }
LAB_676aad3f:
        (*(code *)puVar4[1])(0);
        if ((*param_1 == 0x84) && ((code *)puVar4[7] != (code *)0x0)) {
          iVar2 = 0;
          piVar3 = (int *)(*(code *)puVar4[7])();
          FUN_676aac40(*puVar4,piVar3,iVar2);
        }
      }
      else {
        iVar2 = _memcmp(param_3,(void *)*puVar4,0x10);
LAB_676aad3b:
        if (iVar2 == 0) goto LAB_676aad3f;
      }
      if (*param_1 == 100) {
        puVar4 = puVar4 + 7;
      }
      else {
        puVar4 = puVar4 + 9;
      }
    }
    if (param_2 != 0) {
      FUN_676aaeef((int)param_1,(LPCWSTR)0x0);
    }
    uVar1 = 0;
  }
  return uVar1;
}



// Function: FUN_676aad81 at 676aad81

int FUN_676aad81(int param_1,LPCWSTR param_2,undefined4 *param_3,undefined4 *param_4)

{
  int iVar1;
  LPCSTR lpsz;
  undefined4 uVar2;
  LPCSTR lpString1;
  undefined1 *puVar3;
  char local_114 [272];
  
  *param_3 = 0;
  *param_4 = 0;
  GetModuleFileNameA(*(HMODULE *)(param_1 + 0xc),local_114,0x104);
  if (param_2 != (LPCWSTR)0x0) {
    iVar1 = lstrlenW(param_2);
    FUN_676b06a0();
    WideCharToMultiByte(0,0,param_2,-1,&stack0xfffffee0,iVar1 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    lstrcatA(local_114,&stack0xfffffee0);
  }
  if (&stack0x00000000 == (undefined1 *)0x114) {
    puVar3 = (undefined1 *)0x0;
  }
  else {
    puVar3 = &stack0xfffffee0;
    iVar1 = lstrlenA(local_114);
    FUN_676b06a0();
    MultiByteToWideChar(0,0,local_114,-1,(LPWSTR)&stack0xfffffee0,iVar1 + 1);
  }
  iVar1 = Ordinal_161();
  if (-1 < iVar1) goto LAB_676aaed4;
  lpString1 = (LPCSTR)0x0;
  lpsz = local_114;
  if (local_114[0] == '\0') {
LAB_676aae73:
    lpString1 = lpsz;
  }
  else {
    do {
      if (local_114[0] == '.') {
        lpString1 = lpsz;
      }
      lpsz = CharNextA(lpsz);
      local_114[0] = *lpsz;
    } while (local_114[0] != '\0');
    if (lpString1 == (LPCSTR)0x0) goto LAB_676aae73;
  }
  lstrcpyA(lpString1,&DAT_676c1e9c);
  if (&stack0x00000000 == (undefined1 *)0x114) {
    puVar3 = (undefined1 *)0x0;
  }
  else {
    puVar3 = &stack0xfffffed8;
    iVar1 = lstrlenA(local_114);
    FUN_676b06a0();
    MultiByteToWideChar(0,0,local_114,-1,(LPWSTR)&stack0xfffffed8,iVar1 + 1);
  }
  iVar1 = Ordinal_161(puVar3,param_4);
  if (iVar1 < 0) {
    return iVar1;
  }
LAB_676aaed4:
  uVar2 = Ordinal_2(puVar3);
  *param_3 = uVar2;
  return iVar1;
}



// Function: FUN_676aaeef at 676aaeef

int FUN_676aaeef(int param_1,LPCWSTR param_2)

{
  int iVar1;
  int iVar2;
  HMODULE hModule;
  FARPROC pFVar3;
  undefined2 extraout_var;
  undefined4 local_c;
  int *local_8;
  
  local_c = 0;
  local_8 = (int *)0x0;
  iVar1 = FUN_676aad81(param_1,param_2,&local_c,&local_8);
  if (-1 < iVar1) {
    iVar2 = (**(code **)(*local_8 + 0x1c))(local_8,&param_2);
    if (-1 < iVar2) {
      hModule = LoadLibraryA(s_oleaut32_dll_676c1eb8);
      if (hModule != (HMODULE)0x0) {
        pFVar3 = GetProcAddress(hModule,s_UnRegisterTypeLib_676c1ea4);
        if (pFVar3 != (FARPROC)0x0) {
          (*pFVar3)(param_2,CONCAT22(extraout_var,param_2[0xc]),CONCAT22(extraout_var,param_2[0xd]),
                    *(undefined4 *)(param_2 + 8),*(undefined4 *)(param_2 + 10));
        }
        FreeLibrary(hModule);
      }
      (**(code **)(*local_8 + 0x30))(local_8,param_2);
    }
  }
  if (local_8 != (int *)0x0) {
    (**(code **)(*local_8 + 8))(local_8);
  }
  Ordinal_6(local_c);
  return iVar1;
}



// Function: FUN_676aaf90 at 676aaf90

int FUN_676aaf90(int param_1,LPCWSTR param_2)

{
  LPCWSTR pWVar1;
  int iVar2;
  short local_214 [260];
  int *local_c;
  LPCWSTR local_8;
  
  local_8 = (LPCWSTR)0x0;
  local_c = (int *)0x0;
  iVar2 = FUN_676aad81(param_1,param_2,&local_8,&local_c);
  pWVar1 = local_8;
  if (-1 < iVar2) {
    iVar2 = lstrlenW(local_8);
    FUN_676b06d0((undefined4 *)local_214,(undefined4 *)pWVar1,iVar2 * 2 + 2);
    iVar2 = FUN_676aa963(local_214);
    local_214[iVar2] = 0;
    iVar2 = Ordinal_163(local_c,local_8,local_214);
  }
  if (local_c != (int *)0x0) {
    (**(code **)(*local_c + 8))(local_c);
  }
  Ordinal_6(local_8);
  return iVar2;
}



// Function: FUN_676ab0b8 at 676ab0b8

undefined4 FUN_676ab0b8(int param_1,int param_2,int *param_3,undefined4 *param_4)

{
  undefined4 uVar1;
  undefined4 *extraout_ECX;
  undefined4 *this;
  
  if (param_4 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    *param_4 = 0;
    if ((param_2 == 0) ||
       ((((*param_3 == 0 && (param_3[1] == 0)) && (param_3[2] == 0xc0)) &&
        (param_3[3] == 0x46000000)))) {
      uVar1 = (**(code **)(param_1 + 0x20))(param_2,param_3,param_4);
      this = extraout_ECX;
    }
    else {
      uVar1 = 0x80040110;
      this = param_4;
    }
    FUN_6768eda2(this,(HKEY__)0x0,(char *)((int)&param_2 + 3));
  }
  return uVar1;
}



// Function: FUN_676ab11a at 676ab11a

undefined4
FUN_676ab11a(int param_1,int param_2,undefined4 param_3,int *param_4,int param_5,undefined4 *param_6
            )

{
  undefined4 uVar1;
  
  if (param_6 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    *param_6 = 0;
    if ((param_2 == 0) ||
       ((((*param_4 == 0 && (param_4[1] == 0)) && (param_4[2] == 0xc0)) &&
        (param_4[3] == 0x46000000)))) {
      uVar1 = (**(code **)(param_1 + 0x20))(param_2,param_4,param_6);
    }
    else {
      uVar1 = 0x80040110;
    }
    FUN_6768eda2(&param_5,(HKEY__)(-(uint)(param_5 != 0) & (uint)&param_5),
                 (char *)((int)&param_2 + 3));
  }
  return uVar1;
}



// Function: FUN_676ab186 at 676ab186

int __thiscall FUN_676ab186(void *this,undefined4 param_1,undefined4 param_2,HKEY param_3)

{
  HKEY pHVar1;
  char cVar2;
  bool bVar3;
  int iVar4;
  
  pHVar1 = param_3;
  if (param_3 == (HKEY)0x0) {
    iVar4 = -0x7fffbffd;
  }
  else {
    param_3->unused = 0;
    cVar2 = FUN_6768eda2(this,(HKEY__)0x0,(char *)((int)&param_3 + 3));
    if (cVar2 == '\0') {
      iVar4 = -0x7ffbfeee;
    }
    else {
      bVar3 = FUN_6768eff2(param_2,pHVar1);
      iVar4 = (-(uint)bVar3 & 0x7fffbffb) + 0x80004005;
    }
  }
  return iVar4;
}



// Function: FUN_676ab1d1 at 676ab1d1

undefined4 __thiscall FUN_676ab1d1(void *this,undefined4 param_1,undefined4 *param_2)

{
  undefined4 *puVar1;
  char cVar2;
  undefined4 uVar3;
  
  puVar1 = param_2;
  if (param_2 == (undefined4 *)0x0) {
    uVar3 = 0x80004003;
  }
  else {
    *param_2 = 0xc;
    cVar2 = FUN_6768eda2(this,(HKEY__)0x0,(char *)((int)&param_2 + 3));
    puVar1[2] = (uint)(cVar2 != '\0');
    puVar1[1] = 1;
    uVar3 = 0;
  }
  return uVar3;
}



// Function: FUN_676ab20d at 676ab20d

void FUN_676ab20d(int param_1,undefined4 param_2,undefined4 param_3)

{
  if (param_1 == 0) {
    FUN_676ab32e(0,param_2,param_3);
  }
  else {
    FUN_676ab398(param_1,param_2,param_3);
  }
  return;
}



// Function: FUN_676ab231 at 676ab231

void FUN_676ab231(int param_1,undefined4 param_2,undefined4 param_3)

{
  if (param_1 == 0) {
    FUN_676ab3eb(0,param_2,param_3);
  }
  else {
    FUN_676ab452(param_1,param_2,param_3);
  }
  return;
}



// Function: FUN_676ab255 at 676ab255

void __fastcall FUN_676ab255(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676babe8;
  param_1[1] = 1;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 9));
  DeleteCriticalSection
            ((LPCRITICAL_SECTION)((-(uint)(param_1 != (undefined4 *)0x0) & (uint)(param_1 + 1)) + 4)
            );
  return;
}



// Function: FUN_676ab285 at 676ab285

LONG FUN_676ab285(int param_1)

{
  LONG LVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x24));
  LVar1 = InterlockedIncrement((LONG *)(param_1 + 4));
  if (*(LONG *)(param_1 + 4) == 2) {
    InterlockedIncrement(&DAT_676c559c);
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x24));
  return LVar1;
}



// Function: FUN_676ab2c1 at 676ab2c1

int FUN_676ab2c1(undefined4 *param_1)

{
  int iVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 9));
  InterlockedDecrement(param_1 + 1);
  iVar1 = param_1[1];
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 9));
  if (iVar1 == 0) {
    if (param_1 != (undefined4 *)0x0) {
      FUN_676ab255(param_1);
      FUN_676b0bb3((undefined *)param_1);
    }
  }
  else if (iVar1 == 1) {
    InterlockedDecrement(&DAT_676c559c);
  }
  return iVar1;
}



// Function: FUN_676ab315 at 676ab315

void FUN_676ab315(int param_1,int *param_2,undefined4 *param_3)

{
  FUN_6768f4db(param_1,(int *)&PTR_DAT_676bac28,param_2,param_3);
  return;
}



// Function: FUN_676ab32e at 676ab32e

int FUN_676ab32e(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 *puVar1;
  int iVar2;
  
  iVar2 = -0x7ff8fff2;
  puVar1 = (undefined4 *)operator_new(0x1818);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    puVar1 = FUN_6768f105(puVar1);
  }
  if (puVar1 != (undefined4 *)0x0) {
    InterlockedIncrement(puVar1 + 0x5b0);
    InterlockedDecrement(puVar1 + 0x5b0);
    iVar2 = (**(code **)*puVar1)(puVar1,param_2,param_3);
    if (iVar2 != 0) {
      (**(code **)(puVar1[0x38] + 100))(1);
    }
  }
  return iVar2;
}



// Function: FUN_676ab398 at 676ab398

int FUN_676ab398(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  void *this;
  undefined4 *puVar1;
  int iVar2;
  
  iVar2 = -0x7ff8fff2;
  this = operator_new(0x1828);
  if (this == (void *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    puVar1 = FUN_676ab4c0(this,param_1);
  }
  if (puVar1 != (undefined4 *)0x0) {
    iVar2 = (**(code **)*puVar1)(puVar1,param_2,param_3);
    if (iVar2 != 0) {
      FUN_676ab4ea(puVar1);
      FUN_676b0bb3((undefined *)puVar1);
    }
  }
  return iVar2;
}



// Function: FUN_676ab3eb at 676ab3eb

int FUN_676ab3eb(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 *puVar1;
  int iVar2;
  
  iVar2 = -0x7ff8fff2;
  puVar1 = (undefined4 *)operator_new(0x1e8);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    puVar1 = FUN_67692429(puVar1);
  }
  if (puVar1 != (undefined4 *)0x0) {
    InterlockedIncrement(puVar1 + 0x26);
    InterlockedDecrement(puVar1 + 0x26);
    iVar2 = (**(code **)*puVar1)(puVar1,param_2,param_3);
    if (iVar2 != 0) {
      FUN_676932a6(puVar1);
      FUN_676b0bb3((undefined *)puVar1);
    }
  }
  return iVar2;
}



// Function: FUN_676ab452 at 676ab452

int FUN_676ab452(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  void *this;
  undefined4 *puVar1;
  int iVar2;
  
  iVar2 = -0x7ff8fff2;
  this = operator_new(500);
  if (this == (void *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    puVar1 = FUN_676ab5b7(this,param_1);
  }
  if (puVar1 != (undefined4 *)0x0) {
    iVar2 = (**(code **)*puVar1)(puVar1,param_2,param_3);
    if (iVar2 != 0) {
      FUN_676ab5e1(puVar1);
      FUN_676b0bb3((undefined *)puVar1);
    }
  }
  return iVar2;
}



// Function: FUN_676ab4a5 at 676ab4a5

undefined4 * __fastcall FUN_676ab4a5(undefined4 *param_1)

{
  param_1[1] = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *param_1 = &PTR_LAB_676bac4c;
  return param_1;
}



// Function: FUN_676ab4c0 at 676ab4c0

undefined4 * __thiscall FUN_676ab4c0(void *this,undefined4 param_1)

{
  *(undefined4 *)((int)this + 4) = 0;
  FUN_676ab6a3((void *)((int)this + 0x10),param_1);
  *(undefined ***)this = &PTR_FUN_676bac6c;
  InterlockedIncrement(&DAT_676c559c);
  return (undefined4 *)this;
}



// Function: FUN_676ab4ea at 676ab4ea

void __fastcall FUN_676ab4ea(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676bac6c;
  param_1[1] = 1;
  FUN_676a1d4e((int)(param_1 + 4));
  InterlockedDecrement(&DAT_676c559c);
  FUN_67690b8f((uint)(param_1 + 0x3c));
  return;
}



// Function: FUN_676ab52b at 676ab52b

LONG FUN_676ab52b(undefined4 *param_1)

{
  LONG LVar1;
  
  LVar1 = InterlockedDecrement(param_1 + 1);
  if ((LVar1 == 0) && (param_1 != (undefined4 *)0x0)) {
    FUN_676ab4ea(param_1);
    FUN_676b0bb3((undefined *)param_1);
  }
  return LVar1;
}



// Function: FUN_676ab55a at 676ab55a

int FUN_676ab55a(int *param_1,int *param_2,undefined4 *param_3)

{
  int iVar1;
  
  iVar1 = 0;
  if ((((*param_2 == 0) && (param_2[1] == 0)) && (param_2[2] == 0xc0)) && (param_2[3] == 0x46000000)
     ) {
    if (param_3 == (undefined4 *)0x0) {
      iVar1 = -0x7fffbffd;
    }
    else {
      *param_3 = param_1;
      (**(code **)(*param_1 + 4))(param_1);
    }
  }
  else {
    iVar1 = FUN_6768f4db((int)(param_1 + 4),(int *)&PTR_DAT_676ba2c0,param_2,param_3);
  }
  return iVar1;
}



// Function: FUN_676ab5b7 at 676ab5b7

undefined4 * __thiscall FUN_676ab5b7(void *this,undefined4 param_1)

{
  *(undefined4 *)((int)this + 4) = 0;
  FUN_676ab7dc((void *)((int)this + 0xc),param_1);
  *(undefined ***)this = &PTR_FUN_676bac78;
  InterlockedIncrement(&DAT_676c559c);
  return (undefined4 *)this;
}



// Function: FUN_676ab5e1 at 676ab5e1

void __fastcall FUN_676ab5e1(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676bac78;
  param_1[1] = 1;
  InterlockedDecrement(&DAT_676c559c);
  FUN_6769333a((int)(param_1 + 3));
  return;
}



// Function: FUN_676ab617 at 676ab617

LONG FUN_676ab617(undefined4 *param_1)

{
  LONG LVar1;
  
  LVar1 = InterlockedDecrement(param_1 + 1);
  if ((LVar1 == 0) && (param_1 != (undefined4 *)0x0)) {
    FUN_676ab5e1(param_1);
    FUN_676b0bb3((undefined *)param_1);
  }
  return LVar1;
}



// Function: FUN_676ab646 at 676ab646

int FUN_676ab646(int *param_1,int *param_2,undefined4 *param_3)

{
  int iVar1;
  
  iVar1 = 0;
  if ((((*param_2 == 0) && (param_2[1] == 0)) && (param_2[2] == 0xc0)) && (param_2[3] == 0x46000000)
     ) {
    if (param_3 == (undefined4 *)0x0) {
      iVar1 = -0x7fffbffd;
    }
    else {
      *param_3 = param_1;
      (**(code **)(*param_1 + 4))(param_1);
    }
  }
  else {
    iVar1 = FUN_6768f4db((int)(param_1 + 3),(int *)&PTR_DAT_676ba6c8,param_2,param_3);
  }
  return iVar1;
}



// Function: FUN_676ab6a3 at 676ab6a3

undefined4 * __thiscall FUN_676ab6a3(void *this,undefined4 param_1)

{
  FUN_6768f1d7((int)this);
  *(undefined ***)this = &PTR_FUN_676baf68;
  *(undefined4 *)((int)this + 0x16c0) = param_1;
  *(undefined ***)((int)this + 4) = &PTR_FUN_676baf58;
  *(undefined ***)((int)this + 0x4c) = &PTR_FUN_676baf4c;
  *(undefined ***)((int)this + 0x6c) = &PTR_LAB_676baf28;
  *(undefined ***)((int)this + 0x70) = &PTR_LAB_676baf0c;
  *(undefined ***)((int)this + 0x74) = &PTR_LAB_676baeac;
  *(undefined ***)((int)this + 0x78) = &PTR_LAB_676bae84;
  *(undefined ***)((int)this + 0x7c) = &PTR_LAB_676bae48;
  *(undefined ***)((int)this + 0x80) = &PTR_LAB_676bae1c;
  *(undefined ***)((int)this + 0x84) = &PTR_LAB_676bae08;
  *(undefined ***)((int)this + 0x88) = &PTR_LAB_676bade0;
  *(undefined ***)((int)this + 0x8c) = &PTR_LAB_676badd0;
  *(undefined ***)((int)this + 0x90) = &PTR_LAB_676badb8;
  *(undefined ***)((int)this + 0x94) = &PTR_LAB_676bad88;
  *(undefined ***)((int)this + 0x98) = &PTR_LAB_676bad74;
  *(undefined ***)((int)this + 0x9c) = &PTR_LAB_676bad54;
  *(undefined ***)((int)this + 0xa8) = &PTR_LAB_676bad34;
  *(undefined ***)((int)this + 0xd8) = &PTR_LAB_676bad18;
  *(undefined ***)((int)this + 0xdc) = &PTR_LAB_676bad04;
  *(undefined ***)((int)this + 0xe0) = &PTR_FUN_676bac90;
  *(undefined ***)((int)this + 0xe4) = &PTR_LAB_676bac84;
  return (undefined4 *)this;
}



// Function: FUN_676ab774 at 676ab774

void FUN_676ab774(int param_1)

{
  (**(code **)(**(int **)(param_1 + 0x16c0) + 4))(*(int **)(param_1 + 0x16c0));
  return;
}



// Function: FUN_676ab787 at 676ab787

void FUN_676ab787(int param_1)

{
  (**(code **)(**(int **)(param_1 + 0x16c0) + 8))(*(int **)(param_1 + 0x16c0));
  return;
}



// Function: FUN_676ab79a at 676ab79a

void FUN_676ab79a(int param_1,int *param_2,undefined4 *param_3)

{
  int iVar1;
  
  iVar1 = (**(code **)**(undefined4 **)(param_1 + 0x16c0))
                    (*(undefined4 **)(param_1 + 0x16c0),param_2,param_3);
  if ((iVar1 < 0) && (param_1 != *(int *)(param_1 + 0x16c0))) {
    FUN_6768f4db(param_1,(int *)&PTR_DAT_676ba2c0,param_2,param_3);
  }
  return;
}



// Function: FUN_676ab7dc at 676ab7dc

undefined4 * __thiscall FUN_676ab7dc(void *this,undefined4 param_1)

{
  FUN_676924b5((int)this);
  *(undefined ***)this = &PTR_FUN_676bb380;
  *(undefined4 *)((int)this + 0x98) = param_1;
  *(undefined ***)((int)this + 4) = &PTR_FUN_676bb370;
  *(undefined ***)((int)this + 0x4c) = &PTR_FUN_676bb364;
  *(undefined ***)((int)this + 0x6c) = &PTR_LAB_676bb340;
  *(undefined ***)((int)this + 0x70) = &PTR_LAB_676bb324;
  *(undefined ***)((int)this + 0x74) = &PTR_LAB_676bb2c4;
  *(undefined ***)((int)this + 0x78) = &PTR_LAB_676bb29c;
  *(undefined ***)((int)this + 0x7c) = &PTR_LAB_676bb260;
  *(undefined ***)((int)this + 0x80) = &PTR_LAB_676bb234;
  *(undefined ***)((int)this + 0x84) = &PTR_LAB_676bb20c;
  *(undefined ***)((int)this + 0x88) = &PTR_LAB_676bb1f4;
  *(undefined ***)((int)this + 0x8c) = &PTR_LAB_676bb1c4;
  *(undefined ***)((int)this + 0x90) = &PTR_LAB_676bb1b0;
  *(undefined ***)((int)this + 0x94) = &PTR_LAB_676bb194;
  return (undefined4 *)this;
}



// Function: FUN_676ab867 at 676ab867

void FUN_676ab867(int param_1)

{
  (**(code **)(**(int **)(param_1 + 0x98) + 4))(*(int **)(param_1 + 0x98));
  return;
}



// Function: FUN_676ab87a at 676ab87a

void FUN_676ab87a(int param_1)

{
  (**(code **)(**(int **)(param_1 + 0x98) + 8))(*(int **)(param_1 + 0x98));
  return;
}



// Function: FUN_676ab88d at 676ab88d

void FUN_676ab88d(int param_1,int *param_2,undefined4 *param_3)

{
  int iVar1;
  
  iVar1 = (**(code **)**(undefined4 **)(param_1 + 0x98))
                    (*(undefined4 **)(param_1 + 0x98),param_2,param_3);
  if ((iVar1 < 0) && (param_1 != *(int *)(param_1 + 0x98))) {
    FUN_6768f4db(param_1,(int *)&PTR_DAT_676ba6c8,param_2,param_3);
  }
  return;
}



// Function: FUN_676ab8cf at 676ab8cf

int __thiscall FUN_676ab8cf(void *this,byte param_1)

{
  FUN_67690b8f((uint)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)((int)this + -0xe0));
  }
  return (int)this + -0xe0;
}



// Function: FUN_676ab8f5 at 676ab8f5

void FUN_676ab8f5(void)

{
  InitializeCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return;
}



// Function: FUN_676ab901 at 676ab901

void FUN_676ab901(void)

{
  DeleteCriticalSection((LPCRITICAL_SECTION)&DAT_676c5100);
  return;
}



// Function: FUN_676abcb6 at 676abcb6

undefined4 __cdecl FUN_676abcb6(int param_1)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  
  uVar1 = FUN_67683c8b();
  uVar2 = FUN_67683c61();
  uVar3 = FUN_67683c37();
  uVar4 = FUN_67683f07();
  uVar5 = FUN_67683edd();
  uVar6 = FUN_67683dbd();
  uVar6 = (uVar1 | uVar2 | uVar3 | uVar4 | uVar5) & uVar6;
  if ((0 < (int)uVar6) && (param_1 <= (int)uVar6)) {
    return 1;
  }
  return 0;
}



// Function: FUN_676abcf2 at 676abcf2

undefined4 __cdecl FUN_676abcf2(int param_1)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  undefined4 uVar11;
  
  uVar1 = FUN_67683c8b();
  uVar2 = FUN_67683c61();
  uVar3 = FUN_67683c4c();
  uVar4 = FUN_67683c37();
  uVar5 = FUN_67683c22();
  uVar6 = FUN_67683f07();
  uVar7 = FUN_67683ef2();
  uVar8 = FUN_67683edd();
  uVar9 = FUN_67683dee();
  uVar10 = FUN_67683dbd();
  uVar1 = (uVar1 | uVar2 | uVar3 | uVar4 | uVar5 | uVar6 | uVar7 | uVar8) & (uVar9 | uVar10);
  if (((int)uVar1 < 1) || ((int)uVar1 < param_1)) {
    uVar11 = 0;
  }
  else {
    uVar11 = 1;
  }
  return uVar11;
}



// Function: FUN_676abd4e at 676abd4e

uint __thiscall FUN_676abd4e(void *this,LPCWSTR param_1,int param_2)

{
  HANDLE hFindFile;
  FILETIME *lpFileTime;
  int iVar1;
  uint uVar2;
  _WIN32_FIND_DATAW local_25c;
  _FILETIME local_c;
  
  hFindFile = FUN_676aee00(param_1,&local_25c);
  if (hFindFile == (HANDLE)0xffffffff) {
LAB_676abdbf:
    uVar2 = (uint)hFindFile & 0xffffff00;
  }
  else {
    FindClose(hFindFile);
    if (param_2 == 0) {
      lpFileTime = &local_25c.ftLastWriteTime;
    }
    else if (param_2 == 1) {
      lpFileTime = &local_25c.ftLastAccessTime;
    }
    else {
      hFindFile = (HANDLE)(param_2 + -2);
      if (hFindFile != (HANDLE)0x0) goto LAB_676abdbf;
      lpFileTime = &local_25c.ftCreationTime;
    }
    FileTimeToLocalFileTime(lpFileTime,&local_c);
    iVar1 = FUN_67681512((int)this);
    uVar2 = CONCAT31((int3)((uint)iVar1 >> 8),1);
  }
  return uVar2;
}



// Function: FUN_676abdc6 at 676abdc6

bool __thiscall FUN_676abdc6(void *this,LPCWSTR param_1,int param_2)

{
  HANDLE hFile;
  BOOL BVar1;
  _FILETIME *lpCreationTime;
  _FILETIME *lpLastAccessTime;
  _FILETIME *lpLastWriteTime;
  _FILETIME local_14;
  _FILETIME local_c;
  
  hFile = FUN_676aeee9(param_1,0x40000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,0,(HANDLE)0x0);
  if (hFile == (HANDLE)0xffffffff) {
    return false;
  }
  if ((&stack0x00000000 != (undefined1 *)0xc) &&
     (BVar1 = SystemTimeToFileTime((SYSTEMTIME *)((int)this + 8),&local_c), BVar1 == 0)) {
    local_c.dwHighDateTime = 0;
    local_c.dwLowDateTime = 0;
  }
  LocalFileTimeToFileTime(&local_c,&local_14);
  if (param_2 == 0) {
    lpLastWriteTime = &local_14;
    lpLastAccessTime = (_FILETIME *)0x0;
LAB_676abe43:
    lpCreationTime = (FILETIME *)0x0;
  }
  else {
    if (param_2 == 1) {
      lpLastAccessTime = &local_14;
      lpLastWriteTime = (_FILETIME *)0x0;
      goto LAB_676abe43;
    }
    if (param_2 != 2) {
      BVar1 = 0;
      goto LAB_676abe4d;
    }
    lpLastWriteTime = (FILETIME *)0x0;
    lpCreationTime = &local_14;
    lpLastAccessTime = (FILETIME *)0x0;
  }
  BVar1 = SetFileTime(hFile,lpCreationTime,lpLastAccessTime,lpLastWriteTime);
LAB_676abe4d:
  CloseHandle(hFile);
  return BVar1 != 0;
}



// Function: FUN_676abe64 at 676abe64

void * __fastcall FUN_676abe64(void *param_1)

{
  *(undefined4 *)((int)param_1 + 0x14) = 0;
  *(undefined1 *)((int)param_1 + 0x18) = 0;
  *(undefined1 *)((int)param_1 + 0x19) = 0;
  *(undefined4 *)((int)param_1 + 0x1c) = 0x3f;
  *(undefined2 *)((int)param_1 + 0x22) = 0;
  FUN_676ac47c(param_1);
  return param_1;
}



// Function: FUN_676abe86 at 676abe86

void FUN_676abe86(void)

{
  return;
}



// Function: FUN_676abe87 at 676abe87

int __thiscall
FUN_676abe87(void *this,char *param_1,undefined4 *param_2,char *param_3,char *param_4,
            undefined4 *param_5,char *param_6,undefined4 param_7,undefined8 *param_8,
            undefined2 *param_9)

{
  int iVar1;
  
  FUN_676ac47c(this);
  FUN_676ac4c7(this,param_1);
  iVar1 = lstrlenA((LPCSTR)this);
  if (iVar1 == 0x13) {
    iVar1 = lstrlenA((LPCSTR)this);
    if (*(char *)(iVar1 + -1 + (int)this) == 'A') {
      iVar1 = FUN_676ac0c2(this);
      if (-1 < iVar1) {
        if ((*(int *)((int)this + 0x14) < 1) || (0x17 < *(int *)((int)this + 0x14))) {
          iVar1 = -0x7ffbfd00;
        }
        else if ((*(int *)((int)this + 0x1c) < 0) || (0xe < *(int *)((int)this + 0x1c))) {
          iVar1 = -0x7ffbfcff;
        }
        else if ((*(byte *)((int)this + 0x18) < 10) && (*(byte *)((int)this + 0x19) < 10)) {
          iVar1 = FUN_676ac275((char *)this);
          if (-1 < iVar1) {
            *param_2 = *(undefined4 *)((int)this + 0x14);
            *param_3 = *(char *)((int)this + 0x18);
            *param_4 = *(char *)((int)this + 0x19);
            *param_5 = *(undefined4 *)((int)this + 0x1c);
            *param_6 = *(char *)((int)this + 0x20);
            *(bool *)param_7 = *(char *)((int)this + 0x20) == -1;
            *param_8 = *(undefined8 *)((int)this + 0x28);
            *param_9 = *(undefined2 *)((int)this + 0x22);
            iVar1 = 0;
          }
        }
        else {
          iVar1 = -0x7ffbfcfe;
        }
      }
    }
    else {
      iVar1 = -0x7ffbfcfc;
    }
  }
  else {
    iVar1 = -0x7ffbfcfb;
  }
  return iVar1;
}



// Function: FUN_676abf6f at 676abf6f

undefined4
FUN_676abf6f(HKEY param_1,uint param_2,byte param_3,LPSTR param_4,uint param_5,char param_6,
            char param_7)

{
  LSTATUS LVar1;
  undefined4 uVar2;
  byte bVar3;
  uint uVar4;
  char cStack0000000f;
  BYTE local_21c [264];
  CHAR local_114 [264];
  DWORD local_c [2];
  
  bVar3 = param_3;
  if ((param_4 == (LPSTR)0x0) || (param_5 < 0x14)) {
    uVar2 = 0x80040303;
  }
  else if (((int)param_1 < 1) || (0x17 < (int)param_1)) {
    uVar2 = 0x80040300;
  }
  else if (((byte)param_2 < 10) && (param_3 < 10)) {
    *param_4 = '\0';
    wsprintfA(local_114,s_Licenses__s__s_676c2060,s_4507C5F2_9077_40DE_A621_64EC59BF_676c2070,
              (&PTR_DAT_676c1f70)[(int)param_1]);
    LVar1 = RegOpenKeyExA((HKEY)0x80000000,local_114,0,0x20019,&param_1);
    if (LVar1 == 0) {
      cStack0000000f = '\0';
      uVar4 = param_2 & 0xff;
      while( true ) {
        wsprintfA(local_114,s__d__d_676c2058,uVar4,(uint)bVar3);
        param_2 = 0x104;
        LVar1 = RegQueryValueExA(param_1,local_114,(LPDWORD)0x0,local_c,local_21c,&param_2);
        if (((LVar1 == 0) && (local_c[0] == 1)) && (param_2 <= param_5)) break;
        if ((param_7 != '\0') || (bVar3 == 0)) goto LAB_676ac06e;
        bVar3 = bVar3 - 1;
      }
      cStack0000000f = '\x01';
LAB_676ac06e:
      RegCloseKey(param_1);
      if (cStack0000000f != '\0') {
        if (param_6 == '\0') {
          lstrcpyA(param_4,(LPCSTR)local_21c);
        }
        else {
          FUN_676ac500(param_4,(LPCSTR)local_21c);
        }
        return 0;
      }
    }
    uVar2 = 0x8004030a;
  }
  else {
    uVar2 = 0x80040302;
  }
  return uVar2;
}



// Function: FUN_676ac0c2 at 676ac0c2

int __fastcall FUN_676ac0c2(void *param_1)

{
  byte *_Dst;
  int iVar1;
  uint uVar2;
  undefined2 local_30;
  undefined4 local_2e;
  undefined4 local_2a;
  undefined4 uStack_26;
  undefined2 uStack_22;
  double local_20;
  uint local_18;
  undefined4 uStack_14;
  char local_10 [4];
  byte *local_c;
  uint local_8;
  
  _Dst = (byte *)operator_new(9);
  if (_Dst == (byte *)0x0) {
    iVar1 = -0x7ff8fff2;
  }
  else {
    local_c = _Dst;
    _memset(_Dst,0,9);
    iVar1 = FUN_676ac3d5(param_1,(int)_Dst,9);
    if (((-1 < iVar1) && (iVar1 = FUN_676ac36f((int)local_c,9,(uint *)local_10,""), -1 < iVar1)) &&
       (iVar1 = FUN_676ac2c2((int)local_c,9,0,&DAT_676bb430), -1 < iVar1)) {
      uVar2 = FUN_676ac451(param_1,local_c,9);
      if (local_10[0] == (char)uVar2) {
        iVar1 = FUN_676ac36f((int)local_c,9,&local_8,&DAT_676bb3e8);
        if (-1 < iVar1) {
          uStack_26 = 0;
          uStack_22 = 0;
          local_30 = 0x7d1;
          local_2e = 1;
          local_2a = 1;
          Ordinal_184(&local_30,&local_20);
          uStack_14 = 0;
          local_18 = local_8;
          *(double *)((int)param_1 + 0x28) = (double)local_8 + local_20;
          iVar1 = FUN_676ac36f((int)local_c,9,&local_8,&DAT_676bb3f8);
          if (-1 < iVar1) {
            *(undefined2 *)((int)param_1 + 0x22) = (undefined2)local_8;
            iVar1 = FUN_676ac36f((int)local_c,9,&local_8,&DAT_676bb40c);
            if (-1 < iVar1) {
              *(uint *)((int)param_1 + 0x14) = local_8;
              iVar1 = FUN_676ac36f((int)local_c,9,&local_8,&DAT_676bb414);
              if (-1 < iVar1) {
                *(char *)((int)param_1 + 0x18) = (char)((ulonglong)(local_8 & 0xff) / 10);
                *(char *)((int)param_1 + 0x19) = (char)((ulonglong)(local_8 & 0xff) % 10);
                iVar1 = FUN_676ac36f((int)local_c,9,&local_8,&DAT_676bb41c);
                if (-1 < iVar1) {
                  *(undefined1 *)((int)param_1 + 0x20) = (undefined1)local_8;
                  iVar1 = FUN_676ac36f((int)local_c,9,&local_8,&DAT_676bb428);
                  if (-1 < iVar1) {
                    *(uint *)((int)param_1 + 0x1c) = local_8;
                    iVar1 = 0;
                  }
                }
              }
            }
          }
        }
      }
      else {
        iVar1 = -0x7ffbfcfa;
      }
    }
    FUN_676b0bb3(local_c);
  }
  return iVar1;
}



// Function: FUN_676ac275 at 676ac275

undefined4 __fastcall FUN_676ac275(char *param_1)

{
  char *pcVar1;
  
  pcVar1 = (&PTR_DAT_676c1f70)[*(int *)(param_1 + 0x14)];
  if (((*param_1 == *pcVar1) && (param_1[1] == pcVar1[1])) && (param_1[2] == pcVar1[2])) {
    if (((int)param_1[3] == (byte)param_1[0x18] + 0x30) &&
       ((int)param_1[4] == (byte)param_1[0x19] + 0x30)) {
      return 0;
    }
    return 0x80040308;
  }
  return 0x80040307;
}



// Function: FUN_676ac2c2 at 676ac2c2

undefined4 FUN_676ac2c2(int param_1,int param_2,uint param_3,byte *param_4)

{
  int iVar1;
  byte bVar2;
  byte bVar3;
  int iVar4;
  byte *pbVar5;
  int iVar6;
  
  iVar6 = 0;
  if (((param_1 != 0) && (param_2 != 0)) && (param_4 != (byte *)0x0)) {
    bVar3 = 0;
    iVar4 = 0;
    bVar2 = *param_4;
    while (bVar2 != 0xff) {
      if (bVar3 < bVar2) {
        bVar3 = bVar2;
      }
      iVar1 = iVar4 + 1;
      iVar4 = iVar4 + 1;
      bVar2 = param_4[iVar1];
    }
    if ((param_3 < (uint)(1 << ((byte)iVar4 & 0x1f))) && ((uint)bVar3 < (uint)(param_2 << 3))) {
      if (0 < iVar4) {
        do {
          bVar2 = param_4[iVar6];
          bVar3 = '\x01' << (7 - bVar2 % 8 & 0x1f);
          if ((param_3 & 1 << ((byte)iVar6 & 0x1f)) == 0) {
            pbVar5 = (byte *)(param_1 + (uint)(bVar2 >> 3));
            *pbVar5 = *pbVar5 & ~bVar3;
          }
          else {
            pbVar5 = (byte *)(param_1 + (uint)(bVar2 >> 3));
            *pbVar5 = *pbVar5 | bVar3;
          }
          iVar6 = iVar6 + 1;
        } while (iVar6 < iVar4);
      }
      return 0;
    }
  }
  return 0x8000ffff;
}



// Function: FUN_676ac36f at 676ac36f

undefined4 FUN_676ac36f(int param_1,int param_2,uint *param_3,char *param_4)

{
  char cVar1;
  undefined4 uVar2;
  int iVar3;
  
  iVar3 = 0;
  if (((param_1 == 0) || (param_2 == 0)) || (param_4 == (char *)0x0)) {
    uVar2 = 0x8000ffff;
  }
  else {
    *param_3 = 0;
    cVar1 = *param_4;
    while (cVar1 != -1) {
      if ((*(byte *)((uint)((byte)param_4[iVar3] >> 3) + param_1) &
          '\x01' << (7 - (byte)param_4[iVar3] % 8 & 0x1f)) != 0) {
        *param_3 = *param_3 | 1 << ((byte)iVar3 & 0x1f);
      }
      iVar3 = iVar3 + 1;
      cVar1 = param_4[iVar3];
    }
    uVar2 = 0;
  }
  return uVar2;
}



// Function: FUN_676ac3d5 at 676ac3d5

undefined4 __thiscall FUN_676ac3d5(void *this,int param_1,uint param_2)

{
  char cVar1;
  ushort uVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  char *pcVar6;
  uint local_c;
  
  uVar5 = 0;
  uVar2 = 0xb;
  local_c = 0;
  if (param_2 != 0) {
    pcVar6 = (char *)((int)this + 5);
    do {
      if (0x40 < local_c) {
        return 0;
      }
      cVar1 = *pcVar6;
      pcVar6 = pcVar6 + 1;
      uVar3 = 0;
      do {
        if (PTR_s_ABJCKTDL4UEMW71FNX52YGP98Z63HRS0_676c1fd4[uVar3 & 0xffff] == cVar1)
        goto LAB_676ac416;
        uVar3 = uVar3 + 1;
      } while ((ushort)uVar3 < 0x20);
      uVar3 = 0xffff;
LAB_676ac416:
      iVar4 = uVar3 << ((byte)uVar2 & 0x1f);
      *(ushort *)(param_1 + uVar5) =
           *(ushort *)(param_1 + uVar5) | CONCAT11((char)iVar4,(char)((uint)iVar4 >> 8));
      if (uVar2 < 8) {
        uVar2 = uVar2 + 3;
        uVar5 = uVar5 + 1;
      }
      else {
        uVar2 = uVar2 - 5;
      }
      local_c = local_c + 5;
    } while (uVar5 < param_2);
  }
  return 0;
}



// Function: FUN_676ac451 at 676ac451

uint __thiscall FUN_676ac451(void *this,byte *param_1,uint param_2)

{
  uint uVar1;
  
  uVar1 = FUN_676ac579(0,(byte *)this,5);
  uVar1 = FUN_676ac579(uVar1,param_1,param_2);
  uVar1 = uVar1 >> 0x10 ^ uVar1;
  return uVar1 >> 8 & 0xff ^ uVar1;
}



// Function: FUN_676ac47c at 676ac47c

void __fastcall FUN_676ac47c(void *param_1)

{
  _SYSTEMTIME local_14;
  
  _memset(param_1,0,0x14);
  *(undefined4 *)((int)param_1 + 0x14) = 0;
  *(undefined1 *)((int)param_1 + 0x18) = 0;
  *(undefined1 *)((int)param_1 + 0x19) = 0;
  *(undefined4 *)((int)param_1 + 0x1c) = 0x3f;
  *(undefined1 *)((int)param_1 + 0x20) = 0;
  *(undefined2 *)((int)param_1 + 0x22) = 0;
  GetLocalTime(&local_14);
  Ordinal_184(&local_14,(int)param_1 + 0x28);
  return;
}



// Function: FUN_676ac4c7 at 676ac4c7

void __thiscall FUN_676ac4c7(void *this,char *param_1)

{
  char cVar1;
  uint uVar2;
  
  _memset(this,0,0x14);
  if (param_1 != (char *)0x0) {
    uVar2 = 0;
    cVar1 = *param_1;
    while ((cVar1 != '\0' && (uVar2 < 0x13))) {
      if (*param_1 != '-') {
        *(char *)(uVar2 + (int)this) = *param_1;
        uVar2 = uVar2 + 1;
      }
      param_1 = param_1 + 1;
      cVar1 = *param_1;
    }
  }
  return;
}



// Function: FUN_676ac500 at 676ac500

void FUN_676ac500(LPSTR param_1,LPCSTR param_2)

{
  if (param_1 != (LPSTR)0x0) {
    _memset(param_1,0,0x14);
    if (*param_2 != '\0') {
      lstrcpynA(param_1,param_2,6);
      lstrcatA(param_1,&DAT_676c2098);
      lstrcpynA(param_1 + 6,param_2 + 5,6);
      lstrcatA(param_1,&DAT_676c2098);
      lstrcpynA(param_1 + 0xc,param_2 + 10,6);
      lstrcatA(param_1,&DAT_676c2098);
      lstrcpyA(param_1 + 0x12,param_2 + 0xf);
    }
  }
  return;
}



// Function: FUN_676ac579 at 676ac579

uint __cdecl FUN_676ac579(uint param_1,byte *param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  int iVar18;
  uint uVar19;
  
  if (param_2 == (byte *)0x0) {
    return 1;
  }
  uVar3 = param_1 & 0xffff;
  uVar19 = param_1 >> 0x10;
  if (param_3 != 0) {
    do {
      uVar2 = 0x15b0;
      if (param_3 < 0x15b0) {
        uVar2 = param_3;
      }
      param_3 = param_3 - uVar2;
      if (0xf < (int)uVar2) {
        uVar1 = uVar2 >> 4;
        uVar2 = uVar2 + uVar1 * -0x10;
        do {
          iVar4 = uVar3 + *param_2;
          iVar5 = iVar4 + (uint)param_2[1];
          iVar6 = iVar5 + (uint)param_2[2];
          iVar7 = iVar6 + (uint)param_2[3];
          iVar8 = iVar7 + (uint)param_2[4];
          iVar9 = iVar8 + (uint)param_2[5];
          iVar10 = iVar9 + (uint)param_2[6];
          iVar11 = iVar10 + (uint)param_2[7];
          iVar12 = iVar11 + (uint)param_2[8];
          iVar13 = iVar12 + (uint)param_2[9];
          iVar14 = iVar13 + (uint)param_2[10];
          iVar15 = iVar14 + (uint)param_2[0xb];
          iVar16 = iVar15 + (uint)param_2[0xc];
          iVar17 = iVar16 + (uint)param_2[0xd];
          iVar18 = iVar17 + (uint)param_2[0xe];
          uVar3 = iVar18 + (uint)param_2[0xf];
          uVar19 = uVar19 + iVar4 + iVar5 + iVar6 + iVar7 + iVar8 + iVar9 + iVar10 + iVar11 + iVar12
                   + iVar13 + iVar14 + iVar15 + iVar16 + iVar17 + iVar18 + uVar3;
          param_2 = param_2 + 0x10;
          uVar1 = uVar1 - 1;
        } while (uVar1 != 0);
      }
      for (; uVar2 != 0; uVar2 = uVar2 - 1) {
        uVar3 = uVar3 + *param_2;
        param_2 = param_2 + 1;
        uVar19 = uVar19 + uVar3;
      }
      uVar3 = uVar3 % 0xfff1;
      uVar19 = uVar19 % 0xfff1;
    } while (param_3 != 0);
  }
  return uVar19 << 0x10 | uVar3;
}



// Function: FUN_676ac68f at 676ac68f

uint __cdecl FUN_676ac68f(uint *param_1)

{
  UINT UVar1;
  CHAR local_14c;
  char local_14b;
  undefined1 local_14a;
  undefined1 local_149;
  _SYSTEM_INFO local_44;
  DWORD local_20;
  DWORD local_1c [2];
  DWORD local_14;
  DWORD local_10;
  DWORD local_c;
  DWORD local_8;
  
  local_c = 0;
  local_8 = 0;
  local_1c[1] = 0;
  local_10 = 0;
  local_14 = 0xbc614e;
  local_44.wProcessorLevel = 0;
  local_44.wProcessorRevision = 0;
  GetSystemInfo(&local_44);
  UVar1 = GetWindowsDirectoryA(&local_14c,0x105);
  if (UVar1 != 0) {
    local_149 = 0;
    local_14a = 0x5c;
    if (local_14b != ':') {
      local_14c = 'C';
      local_14b = ':';
    }
    GetVolumeInformationA(&local_14c,(LPSTR)0x0,0,&local_14,local_1c,&local_20,(LPSTR)0x0,0);
    GetDiskFreeSpaceA(&local_14c,&local_c,&local_8,local_1c + 1,&local_10);
  }
  if (param_1 != (uint *)0x0) {
    *param_1 = local_14;
  }
  return ((uint)local_44.wProcessorRevision + (uint)local_44.wProcessorLevel) * 0x10001 ^
         local_10 + local_8 + local_c ^ local_14 ^ 0x52d2c330;
}



// Function: FUN_676ac767 at 676ac767

void __cdecl FUN_676ac767(byte *param_1,char *param_2,byte *param_3)

{
  char *pcVar1;
  byte *pbVar2;
  char cVar3;
  char cVar4;
  byte *pbVar5;
  
  cVar4 = *param_2;
  pbVar5 = param_1;
  while (cVar4 != '\0') {
    if (cVar4 < 'A') {
      cVar4 = cVar4 + -0x30;
    }
    else {
      cVar4 = cVar4 + -0x37;
    }
    pcVar1 = param_2 + 1;
    if (*pcVar1 < 'A') {
      cVar3 = -0x30;
    }
    else {
      cVar3 = -0x37;
    }
    param_2 = param_2 + 2;
    *param_3 = *pcVar1 + cVar3 + cVar4 * '\x10' ^ *pbVar5;
    pbVar2 = pbVar5 + 1;
    param_3 = param_3 + 1;
    pbVar5 = param_1;
    if (*pbVar2 != 0) {
      pbVar5 = pbVar2;
    }
    cVar4 = *param_2;
  }
  return;
}



// Function: FUN_676ac7bc at 676ac7bc

uint __cdecl FUN_676ac7bc(uint *param_1,byte *param_2,int param_3,uint param_4,undefined1 *param_5)

{
  LPCWSTR lpString;
  uint uVar1;
  int iVar2;
  uint uVar3;
  uint *puVar4;
  uint uStack_24;
  uint local_14;
  uint local_10;
  byte abStack_c [8];
  
  *param_5 = 0;
  uVar1 = *param_1;
  if ((uVar1 != 0) && (uStack_24 = uVar1, uVar1 = Ordinal_7(), uVar1 == 0x20)) {
    lpString = (LPCWSTR)*param_1;
    local_14 = 0;
    local_10 = 0;
    abStack_c[0] = 0;
    abStack_c[1] = 0;
    abStack_c[2] = 0;
    abStack_c[3] = 0;
    abStack_c[4] = 0;
    abStack_c[5] = 0;
    abStack_c[6] = 0;
    abStack_c[7] = 0;
    if (lpString == (LPCWSTR)0x0) {
      puVar4 = (uint *)0x0;
    }
    else {
      puVar4 = &uStack_24;
      iVar2 = lstrlenW(lpString);
      FUN_676b06a0();
      uStack_24 = uStack_24 & 0xffffff00;
      WideCharToMultiByte(0,0,lpString,-1,(LPSTR)&uStack_24,iVar2 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    }
    FUN_676ac767(param_2,(char *)puVar4,(byte *)&local_14);
    uVar3 = (local_10 & 0xffff) + (uint)abStack_c[param_3] + (local_10 >> 0x10) + local_14;
    uVar1 = uVar3 / 0xff;
    if ((char)((ulonglong)uVar3 % 0xff) == abStack_c[7]) {
      if ((param_4 & abStack_c[param_3]) != 0) {
        *param_5 = 1;
        uVar1 = FUN_676ac68f((uint *)0x0);
        if (local_14 != uVar1) goto LAB_676ac87b;
      }
      return CONCAT31((int3)(uVar1 >> 8),1);
    }
  }
LAB_676ac87b:
  return uVar1 & 0xffffff00;
}



// Function: FUN_676ac893 at 676ac893

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_676ac893(void)

{
  _DAT_676c5640 = 0;
  _DAT_676c5644 = 0;
  _DAT_676c5648 = 0xffffffff;
  _DAT_676c5638 = &PTR_LAB_676bb440;
  return;
}



// Function: FUN_676ac8b3 at 676ac8b3

void FUN_676ac8b3(void)

{
  FUN_676b0c45(&LAB_676ac8bf);
  return;
}



// Function: FUN_676ac8da at 676ac8da

undefined4 __cdecl FUN_676ac8da(short *param_1,short *param_2,short *param_3,short *param_4)

{
  short sVar1;
  short *psVar2;
  short *psVar3;
  int iVar4;
  
  if (param_2 != (short *)0x0) {
    *param_2 = 0;
  }
  if (param_3 != (short *)0x0) {
    *param_3 = 0;
  }
  if (param_4 != (short *)0x0) {
    *param_4 = 0;
  }
  sVar1 = *param_1;
  if (((sVar1 == 0x5c) || (sVar1 == 0x2f)) && ((param_1[1] == 0x5c || (param_1[1] == 0x2f)))) {
    psVar2 = param_3;
    if (param_2 != (short *)0x0) {
      FUN_676ae229(param_2,param_1,2);
      psVar2 = param_2 + 2;
    }
    iVar4 = 0;
    for (param_1 = param_1 + 2; *param_1 != 0; param_1 = param_1 + 1) {
      if (param_2 != (short *)0x0) {
        *psVar2 = *param_1;
        psVar2 = psVar2 + 1;
      }
      if (((*param_1 == 0x5c) || (*param_1 == 0x2f)) && (iVar4 = iVar4 + 1, iVar4 == 2)) {
        param_1 = param_1 + 1;
        break;
      }
    }
    psVar3 = param_1;
    if (param_2 != (short *)0x0) {
      *psVar2 = 0;
    }
  }
  else {
    psVar3 = param_1;
    if ((sVar1 != 0) && (param_1[1] == 0x3a)) {
      if ((param_1[2] == 0x5c) || (param_1[2] == 0x2f)) {
        iVar4 = 3;
      }
      else {
        iVar4 = 2;
      }
      if (param_2 != (short *)0x0) {
        FUN_676ae229(param_2,param_1,iVar4);
        param_2[iVar4] = 0;
      }
      param_1 = param_1 + iVar4;
      psVar3 = param_1;
    }
  }
  do {
    sVar1 = *psVar3;
    if ((sVar1 == 0x5c) || (sVar1 == 0x2f)) {
      if (param_3 != (short *)0x0) {
        iVar4 = ((int)psVar3 - (int)param_1 >> 1) + 1;
        FUN_676ae229(param_3,param_1,iVar4);
        param_3 = param_3 + iVar4;
        *param_3 = 0;
      }
      param_1 = psVar3 + 1;
    }
    else if (sVar1 == 0) {
      if (param_4 != (short *)0x0) {
        iVar4 = (int)psVar3 - (int)param_1 >> 1;
        FUN_676ae229(param_4,param_1,iVar4);
        param_4[iVar4] = 0;
      }
      return 1;
    }
    psVar3 = psVar3 + 1;
  } while( true );
}



// Function: FUN_676aca1a at 676aca1a

void __cdecl FUN_676aca1a(LPCWSTR param_1,short *param_2,short *param_3,short *param_4)

{
  int iVar1;
  undefined4 *puVar2;
  WCHAR local_210;
  undefined4 local_20e [130];
  
  local_210 = L'\0';
  puVar2 = local_20e;
  for (iVar1 = 0x82; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  FUN_676aeff1(param_1,0x104,&local_210,(LPWSTR *)0x0);
  FUN_676ac8da(&local_210,param_2,param_3,param_4);
  return;
}



// Function: FUN_676aca6b at 676aca6b

void __cdecl FUN_676aca6b(int param_1,short *param_2)

{
  short *psVar1;
  short sVar2;
  int iVar3;
  int local_8;
  
  sVar2 = *param_2;
  iVar3 = 0;
  local_8 = 0;
  if (sVar2 != 0) {
    psVar1 = param_2;
    do {
      if ((sVar2 == 0x2a) || (*psVar1 == 0x3f)) {
        *(undefined2 *)(param_1 + local_8 * 2) = 0;
        break;
      }
      *(short *)((param_1 - (int)param_2) + (int)psVar1) = *psVar1;
      if ((*psVar1 == 0x5c) || (*psVar1 == 0x2f)) {
        local_8 = iVar3 + 1;
      }
      iVar3 = iVar3 + 1;
      psVar1 = psVar1 + 1;
      sVar2 = *psVar1;
    } while (sVar2 != 0);
  }
  if (param_2[iVar3] == 0) {
    *(undefined2 *)(iVar3 * 2 + param_1) = 0;
  }
  return;
}



// Function: FUN_676acade at 676acade

void __cdecl FUN_676acade(short *param_1,short *param_2)

{
  short *psVar1;
  short sVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = 0;
  sVar2 = *param_2;
  if (sVar2 != 0) {
    iVar3 = 1;
    psVar1 = param_2;
    do {
      if ((sVar2 == 0x2a) || (sVar2 = *psVar1, sVar2 == 0x3f)) {
        FUN_676ae1fc(param_1,param_2 + iVar4);
        return;
      }
      if ((sVar2 == 0x5c) || (sVar2 == 0x2f)) {
        iVar4 = iVar3;
      }
      iVar3 = iVar3 + 1;
      psVar1 = psVar1 + 1;
      sVar2 = *psVar1;
    } while (sVar2 != 0);
  }
  *param_1 = 0;
  return;
}



// Function: FUN_676acb37 at 676acb37

short * __cdecl FUN_676acb37(short *param_1)

{
  short sVar1;
  
  while( true ) {
    sVar1 = *param_1;
    if (sVar1 == 0) {
      return param_1;
    }
    if ((sVar1 == 0x5c) || (sVar1 == 0x2f)) break;
    param_1 = param_1 + 1;
  }
  return param_1 + 1;
}



// Function: FUN_676acb57 at 676acb57

void __cdecl FUN_676acb57(LPWSTR param_1,short *param_2)

{
  int iVar1;
  DWORD DVar2;
  DWORD DVar3;
  _RTL_CRITICAL_SECTION local_3c;
  WCHAR local_24 [10];
  CHAR local_10 [12];
  
  iVar1 = FUN_676ae2a4(param_2);
  if (iVar1 == 0) {
    FUN_676af0d8(0x104,param_1);
  }
  else {
    FUN_676ae1fc(param_1,param_2);
    if (((param_1 == (LPWSTR)0x0) || (iVar1 = FUN_676ae2a4(param_1), iVar1 == 0)) ||
       ((iVar1 = FUN_676ae2a4(param_1), param_1[iVar1 + -1] != L'\\' &&
        (iVar1 = FUN_676ae2a4(param_1), param_1[iVar1 + -1] != L'/')))) {
      FUN_676ae272(param_1,(short *)&DAT_676c057c);
    }
  }
  InitializeCriticalSection(&local_3c);
  EnterCriticalSection(&local_3c);
  DVar2 = GetTickCount();
  do {
    DVar3 = GetTickCount();
  } while (DVar3 == DVar2);
  LeaveCriticalSection(&local_3c);
  wsprintfW(local_24,u__Z_06d_676c20a4,DVar2 % 999999);
  DVar3 = GetLastError();
  if (DVar3 == 0x78) {
    wsprintfA(local_10,s__Z_06d_676c209c,DVar2 % 999999);
    iVar1 = lstrlenA(local_10);
    iVar1 = MultiByteToWideChar(0,1,local_10,-1,local_24,iVar1 + 1);
    if (iVar1 == 0) {
      local_24[0] = L'\0';
    }
  }
  FUN_676ae272(param_1,local_24);
  DeleteCriticalSection(&local_3c);
  return;
}



// Function: FUN_676acc74 at 676acc74

undefined4 __cdecl FUN_676acc74(int param_1,int param_2,int param_3,int param_4,int param_5)

{
  ushort uVar1;
  ushort uVar2;
  LPWSTR pWVar3;
  int iVar4;
  short *psVar5;
  ushort *puVar6;
  int iVar7;
  bool bVar8;
  ushort *local_10;
  int local_8;
  
  iVar7 = param_3;
  if (-1 < param_4) {
    local_8 = param_4 + -1;
    puVar6 = (ushort *)(param_1 + param_3 * 2);
    local_10 = (ushort *)(param_2 + param_4 * 2);
    param_3 = param_3 + -1;
    do {
      uVar1 = *local_10;
      if (uVar1 == 0x2a) {
        param_4 = param_4 + -1;
        local_10 = local_10 + -1;
        local_8 = local_8 + -1;
      }
      else {
        if (uVar1 == 0x3f) {
          if (iVar7 < 0) {
            return 0;
          }
          if (*puVar6 == 0x5c) {
            return 0;
          }
          if (*puVar6 == 0x2f) {
            return 0;
          }
          iVar4 = FUN_676acc74(param_1,param_2,param_3,local_8,param_5);
          if (iVar4 != 0) {
            return 1;
          }
          bVar8 = param_5 == 0;
        }
        else {
          if (iVar7 < 0) {
            return 0;
          }
          uVar2 = *puVar6;
          if ((uVar2 != uVar1) &&
             (((uVar2 != 0x5c && (uVar2 != 0x2f)) || ((uVar1 != 0x5c && (uVar1 != 0x2f)))))) {
            uVar1 = *local_10;
            pWVar3 = FUN_676af891((LPWSTR)(uint)uVar2);
            if (pWVar3 != (LPWSTR)(uint)uVar1) {
              uVar2 = *puVar6;
              pWVar3 = FUN_676af891((LPWSTR)(uint)uVar1);
              if ((LPWSTR)(uint)uVar2 != pWVar3) {
                if (param_5 == 0) {
                  return 0;
                }
                if (uVar2 == 0x5c) {
                  return 0;
                }
                bVar8 = uVar2 == 0x2f;
                goto LAB_676acd9f;
              }
            }
          }
          iVar4 = FUN_676acc74(param_1,param_2,param_3,local_8,0);
          if (iVar4 != 0) {
            return 1;
          }
          if (param_5 == 0) {
            return 0;
          }
          if (*puVar6 == 0x5c) {
            return 0;
          }
          bVar8 = *puVar6 == 0x2f;
        }
LAB_676acd9f:
        if (bVar8) {
          return 0;
        }
        iVar7 = iVar7 + -1;
        puVar6 = puVar6 + -1;
        param_3 = param_3 + -1;
      }
      param_5 = 1;
    } while (-1 < param_4);
  }
  if (-1 < iVar7) {
    if (param_5 == 0) {
      return 0;
    }
    psVar5 = (short *)(param_1 + iVar7 * 2);
    do {
      if (*psVar5 == 0x5c) {
        return 0;
      }
      if (*psVar5 == 0x2f) {
        return 0;
      }
      iVar7 = iVar7 + -1;
      psVar5 = psVar5 + -1;
    } while (-1 < iVar7);
  }
  return 1;
}



// Function: FUN_676acdfe at 676acdfe

void __cdecl FUN_676acdfe(short *param_1,short *param_2)

{
  int iVar1;
  int iVar2;
  
  iVar1 = FUN_676ae2a4(param_1);
  iVar2 = FUN_676ae2a4(param_2);
  FUN_676acc74((int)param_1,(int)param_2,iVar1 + -1,iVar2 + -1,0);
  return;
}



// Function: FUN_676ace2b at 676ace2b

undefined4 __cdecl FUN_676ace2b(short *param_1,short *param_2)

{
  undefined4 uVar1;
  int iVar2;
  short sVar3;
  int iVar4;
  short local_20c [260];
  
  iVar4 = 0;
  sVar3 = *param_2;
  if (sVar3 != 0) {
    iVar2 = (int)local_20c - (int)param_2;
    do {
      if ((sVar3 == 0x5c) || (*param_2 == 0x2f)) break;
      *(short *)(iVar2 + (int)param_2) = *param_2;
      iVar4 = iVar4 + 1;
      param_2 = param_2 + 1;
      sVar3 = *param_2;
    } while (sVar3 != 0);
    if (iVar4 != 0) {
      local_20c[iVar4] = 0;
      uVar1 = FUN_676acdfe(param_1,local_20c);
      return uVar1;
    }
  }
  return 1;
}



// Function: FUN_676ace8e at 676ace8e

undefined4 __cdecl FUN_676ace8e(LPCWSTR param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  WCHAR *pWVar4;
  undefined4 uVar5;
  WCHAR local_20c [260];
  
  BVar1 = FUN_676aef7c(param_1,(LPSECURITY_ATTRIBUTES)0x0);
  if (BVar1 == 1) {
LAB_676acec8:
    uVar5 = 1;
  }
  else {
    DVar2 = GetLastError();
    if (DVar2 == 3) {
LAB_676acecd:
      iVar3 = FUN_676ae2a4(param_1);
      iVar3 = iVar3 + -2;
      FUN_676ae1fc(local_20c,param_1);
      if (0 < iVar3) {
        pWVar4 = local_20c + iVar3;
        do {
          if ((*pWVar4 == L'\\') || (*pWVar4 == L'/')) break;
          *pWVar4 = L'\0';
          iVar3 = iVar3 + -1;
          pWVar4 = pWVar4 + -1;
        } while (0 < iVar3);
      }
      local_20c[iVar3] = L'\0';
      if (0 < iVar3) {
        iVar3 = FUN_676ace8e(local_20c);
        if (iVar3 != 0) {
          BVar1 = FUN_676aef7c(param_1,(LPSECURITY_ATTRIBUTES)0x0);
          if (BVar1 != 0) goto LAB_676acec8;
        }
      }
    }
    else {
      DVar2 = GetLastError();
      if (DVar2 == 2) goto LAB_676acecd;
      DVar2 = GetLastError();
      if (DVar2 == 0xb7) goto LAB_676acec8;
    }
    uVar5 = 0;
  }
  return uVar5;
}



// Function: FUN_676acf3e at 676acf3e

undefined4 __cdecl
FUN_676acf3e(short *param_1,undefined2 *param_2,undefined2 *param_3,undefined2 *param_4,
            undefined2 *param_5)

{
  undefined2 *puVar1;
  DWORD DVar2;
  HANDLE pvVar3;
  LPVOID pBlock;
  BOOL BVar4;
  int iVar5;
  undefined4 uVar6;
  undefined4 *puVar7;
  DWORD dwFlags;
  DWORD dwBytes;
  WCHAR local_218;
  undefined4 local_216 [130];
  uint local_c;
  LPVOID local_8;
  
  puVar1 = param_3;
  *param_2 = 0;
  *param_3 = 0;
  *param_4 = 0;
  local_218 = L'\0';
  *param_5 = 0;
  puVar7 = local_216;
  for (iVar5 = 0x82; iVar5 != 0; iVar5 = iVar5 + -1) {
    *puVar7 = 0;
    puVar7 = puVar7 + 1;
  }
  if (param_1 == (short *)0x0) {
    FUN_676af242(DAT_676c558c,&local_218,0x104);
  }
  else {
    FUN_676ae229(&local_218,param_1,0x104);
  }
  DVar2 = FUN_676af150(&local_218,(LPDWORD)&param_3);
  if (DVar2 != 0) {
    dwFlags = 8;
    dwBytes = DVar2;
    pvVar3 = GetProcessHeap();
    pBlock = HeapAlloc(pvVar3,dwFlags,dwBytes);
    if (pBlock != (LPVOID)0x0) {
      BVar4 = FUN_676af1c3(&local_218,(DWORD)param_3,DVar2,pBlock);
      if ((BVar4 == 0) ||
         (BVar4 = VerQueryValueA(pBlock,&DAT_676c1c78,&local_8,&local_c), BVar4 == 0)) {
        uVar6 = 0;
      }
      else {
        *param_2 = (short)((uint)*(undefined4 *)((int)local_8 + 8) >> 0x10);
        *puVar1 = *(undefined2 *)((int)local_8 + 8);
        *param_4 = (short)((uint)*(undefined4 *)((int)local_8 + 0xc) >> 0x10);
        uVar6 = 1;
        *param_5 = *(undefined2 *)((int)local_8 + 0xc);
      }
      DVar2 = 0;
      pvVar3 = GetProcessHeap();
      HeapFree(pvVar3,DVar2,pBlock);
      return uVar6;
    }
  }
  return 0;
}



// Function: FUN_676ad058 at 676ad058

undefined1 __cdecl FUN_676ad058(LPCWSTR param_1,short *param_2,int param_3)

{
  char cVar1;
  undefined1 uVar2;
  int iVar3;
  ushort *puVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  BOOL BVar8;
  short *psVar9;
  LPCWSTR pWVar10;
  WCHAR *pWVar11;
  _WIN32_FIND_DATAW local_278;
  undefined **local_28;
  short *local_24;
  undefined1 local_20;
  undefined **local_1c;
  short *local_18;
  undefined1 local_14;
  int local_10;
  uint local_c;
  uint local_8;
  
  pWVar10 = param_1;
  if (param_1 == (LPCWSTR)0x0) {
    return 0;
  }
  if (param_2 == (short *)0x0) {
    return 0;
  }
  iVar3 = FUN_676ae2a4(param_2);
  iVar3 = iVar3 + -1;
  if (-1 < iVar3) {
    psVar9 = param_2 + iVar3;
    do {
      if (*psVar9 == 0x2e) break;
      iVar3 = iVar3 + -1;
      psVar9 = psVar9 + -1;
    } while (-1 < iVar3);
  }
  for (puVar4 = (ushort *)(param_2 + iVar3 + 1); *puVar4 != 0; puVar4 = puVar4 + 1) {
    if ((0x2f < *puVar4) && (*puVar4 < 0x3a)) goto LAB_676ad0e7;
  }
  if (param_3 == 0) {
    FUN_676ae1fc(param_1,param_2);
    return 1;
  }
  if (param_3 != -1) {
    FUN_676ae1fc(param_1,param_2);
    iVar3 = FUN_676ae2a4(param_1);
    if (iVar3 == 0) {
      return 0;
    }
    iVar3 = iVar3 + -1;
    if (0 < iVar3) {
      pWVar10 = param_1 + iVar3;
      do {
        if (*pWVar10 == L'.') break;
        iVar3 = iVar3 + -1;
        pWVar10 = pWVar10 + -1;
      } while (0 < iVar3);
    }
    FUN_676ad2a6(param_3 + 1,param_1 + iVar3 + 2,2);
    return 1;
  }
  cVar1 = FUN_676ad058(param_1,param_2,1);
  if (cVar1 == '\0') {
    return 0;
  }
  iVar3 = FUN_676ae2a4(param_1);
  if (iVar3 == 0) {
LAB_676ad0e7:
    FUN_676ae1fc(param_1,param_2);
    return 0;
  }
  local_18 = (short *)0x0;
  local_14 = 0;
  local_1c = &PTR_FUN_676b9b1c;
  FUN_67685091(&local_1c,iVar3 + 1);
  local_24 = (short *)0x0;
  local_20 = 0;
  local_28 = &PTR_FUN_676b9b1c;
  FUN_67685091(&local_28,iVar3 + 1);
  FUN_676ac8da(param_1,local_18,local_24,(short *)0x0);
  psVar9 = local_18;
  iVar5 = FUN_676ae2a4(local_24);
  iVar6 = FUN_676ae2a4(psVar9);
  param_1[iVar3 + -2] = L'*';
  param_1[iVar3 + -1] = L'\0';
  param_1 = (LPCWSTR)FUN_676aee00(param_1,&local_278);
  local_c = 0;
  if (param_1 != (LPCWSTR)0xffffffff) {
    local_10 = (iVar3 - (iVar5 + iVar6)) + -2;
    do {
      local_8 = 0;
      param_3 = 0;
      iVar3 = FUN_676ae2a4(local_278.cFileName);
      iVar5 = iVar3 + -1;
      if (local_10 <= iVar5) {
        pWVar11 = local_278.cFileName + iVar3 + -1;
        do {
          if (((ushort)*pWVar11 < 0x30) || (0x39 < (ushort)*pWVar11)) {
            uVar7 = 0;
            break;
          }
          iVar3 = FUN_676ad332(10,param_3);
          uVar7 = local_8 + iVar3 * ((ushort)*pWVar11 - 0x30);
          local_8 = uVar7;
          iVar5 = iVar5 + -1;
          pWVar11 = pWVar11 + -1;
          param_3 = param_3 + 1;
        } while (local_10 <= iVar5);
        if (local_c < uVar7) {
          local_c = uVar7;
        }
      }
      BVar8 = FUN_676aee96(param_1,&local_278);
      if (BVar8 == 0) {
        FindClose(param_1);
        param_1 = (LPCWSTR)0xffffffff;
      }
    } while (param_1 != (LPCWSTR)0xffffffff);
    if (local_c != 0) {
      uVar2 = FUN_676ad058(pWVar10,param_2,local_c - 1);
      goto LAB_676ad23f;
    }
  }
  FUN_676ae1fc(pWVar10,param_2);
  uVar2 = 0;
LAB_676ad23f:
  local_28 = &PTR_FUN_676b9b1c;
  FUN_676850f1((int)&local_28);
  local_1c = &PTR_FUN_676b9b1c;
  FUN_676850f1((int)&local_1c);
  return uVar2;
}



// Function: FUN_676ad2a6 at 676ad2a6

void __cdecl FUN_676ad2a6(uint param_1,short *param_2,int param_3)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  if (param_2 != (short *)0x0) {
    iVar4 = 1;
    iVar3 = param_3 + -1;
    iVar2 = iVar4;
    if (1 < param_3) {
      do {
        if (SBORROW4(param_1,iVar2 * 10) != (int)(param_1 + iVar2 * -10) < 0) {
          *param_2 = 0x30;
          param_2 = param_2 + 1;
        }
        iVar3 = iVar3 + -1;
        iVar2 = iVar2 * 10;
      } while (iVar3 != 0);
    }
    if ((int)param_1 < 0) {
      *param_2 = 0x2d;
      param_2 = param_2 + 1;
    }
    uVar1 = param_1;
    if ((int)param_1 < 10) goto LAB_676ad2f8;
    do {
      iVar4 = iVar4 + 1;
      uVar1 = (int)uVar1 / 10;
    } while (9 < (int)uVar1);
    while (0 < iVar4) {
LAB_676ad2f8:
      iVar4 = iVar4 + -1;
      uVar1 = FUN_676ad332(10,iVar4);
      *param_2 = (short)((ulonglong)param_1 / (ulonglong)uVar1) + 0x30;
      param_2 = param_2 + 1;
      iVar2 = FUN_676ad332(10,iVar4);
      param_1 = param_1 - iVar2 * (int)((ulonglong)param_1 / (ulonglong)uVar1);
    }
    *param_2 = 0;
  }
  return;
}



// Function: FUN_676ad332 at 676ad332

int __cdecl FUN_676ad332(int param_1,int param_2)

{
  int iVar1;
  
  iVar1 = 1;
  if (param_2 != 0) {
    do {
      iVar1 = iVar1 * param_1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
  }
  return iVar1;
}



// Function: FUN_676ad346 at 676ad346

uint __cdecl FUN_676ad346(uint param_1,uint param_2)

{
  uint in_EAX;
  
  if (param_2 == 0) {
    return in_EAX & 0xffff0000;
  }
  if (0xffffff < param_2) {
    param_2 = param_2 + 0x80 >> 8;
    param_1 = param_1 + 0x80 >> 8;
  }
  if (param_2 <= param_1) {
    return 100;
  }
  return (param_1 * 200) / param_2 + 1 >> 1 & 0xffff;
}



// Function: FUN_676ad38e at 676ad38e

undefined8 __fastcall
FUN_676ad38e(undefined4 param_1,undefined4 param_2,ulonglong param_3,uint param_4,uint param_5)

{
  uint uVar1;
  ulonglong uVar2;
  longlong lVar3;
  undefined8 uVar4;
  
  if (param_4 == 0 && param_5 == 0) {
    uVar1 = param_4 & 0xffff0000;
  }
  else {
    uVar2 = CONCAT44(param_5,param_4);
    if ((0xfffffe < param_5) && (uVar2 = CONCAT44(param_5,param_4), 0xffffff < param_5)) {
      uVar2 = __aullshr(8,param_5 + (0xffffff7f < param_4));
      param_3 = __aullshr(8,param_3._4_4_ + (0xffffff7f < (uint)param_3));
      param_2 = (undefined4)(param_3 >> 0x20);
    }
    uVar1 = (uint)(uVar2 >> 0x20);
    param_4 = (uint)uVar2;
    if ((uVar1 < param_3._4_4_) || ((uVar1 <= param_3._4_4_ && (param_4 <= (uint)param_3)))) {
      uVar1 = 100;
    }
    else {
      lVar3 = __allmul((uint)param_3,param_3._4_4_,200,0);
      uVar4 = __aulldiv((uint)lVar3,(uint)((ulonglong)lVar3 >> 0x20),param_4,uVar1);
      uVar2 = __aullshr(1,(int)((ulonglong)uVar4 >> 0x20) + (uint)(0xfffffffe < (uint)uVar4));
      param_2 = (undefined4)(uVar2 >> 0x20);
      uVar1 = (uint)uVar2 & 0xffff;
    }
  }
  return CONCAT44(param_2,uVar1);
}



// Function: FUN_676ad42d at 676ad42d

undefined8 __fastcall
FUN_676ad42d(undefined4 param_1,undefined4 param_2,ulonglong param_3,uint param_4,uint param_5)

{
  uint uVar1;
  ulonglong uVar2;
  longlong lVar3;
  undefined8 uVar4;
  
  if (param_4 == 0 && param_5 == 0) {
    uVar1 = 0;
  }
  else {
    uVar2 = CONCAT44(param_5,param_4);
    if ((0xfffffe < param_5) && (uVar2 = CONCAT44(param_5,param_4), 0xffffff < param_5)) {
      uVar2 = __aullshr(8,param_5 + (0xffffff7f < param_4));
      param_3 = __aullshr(8,param_3._4_4_ + (0xffffff7f < (uint)param_3));
      param_2 = (undefined4)(param_3 >> 0x20);
    }
    uVar1 = (uint)(uVar2 >> 0x20);
    if ((uVar1 < param_3._4_4_) || ((uVar1 <= param_3._4_4_ && ((uint)uVar2 <= (uint)param_3)))) {
      uVar1 = 0;
    }
    else {
      lVar3 = __allmul((uint)(uVar2 - param_3),(int)(uVar2 - param_3 >> 0x20),200,0);
      uVar4 = __aulldiv((uint)lVar3,(uint)((ulonglong)lVar3 >> 0x20),(uint)uVar2,uVar1);
      param_2 = (undefined4)((ulonglong)uVar4 >> 0x20);
      uVar1 = ((int)uVar4 + 1U & 0xffff) >> 1;
    }
  }
  return CONCAT44(param_2,uVar1);
}



// Function: FUN_676ad4c2 at 676ad4c2

void __cdecl FUN_676ad4c2(LPCSTR param_1,char param_2,char param_3)

{
  int iVar1;
  LPWSTR pWVar2;
  undefined **local_14;
  LPWSTR local_10;
  undefined1 local_c;
  int local_8;
  
  if (param_1 != (LPCSTR)0x0) {
    iVar1 = lstrlenA(param_1);
    iVar1 = iVar1 + 1;
    local_8 = MultiByteToWideChar(0,1,param_1,iVar1,(LPWSTR)0x0,0);
    local_10 = (LPWSTR)0x0;
    local_c = 0;
    local_14 = &PTR_FUN_676b9b1c;
    FUN_67685091(&local_14,local_8);
    if (local_10 != (LPWSTR)0x0) {
      MultiByteToWideChar(0,1,param_1,iVar1,local_10,local_8);
      if (*local_10 != L'\0') {
        pWVar2 = local_10;
        do {
          if (*pWVar2 == (short)param_2) {
            *pWVar2 = (short)param_3;
          }
          pWVar2 = pWVar2 + 1;
        } while (*pWVar2 != L'\0');
      }
      WideCharToMultiByte(0,0,local_10,local_8,param_1,iVar1,(LPCSTR)0x0,(LPBOOL)0x0);
    }
    local_14 = &PTR_FUN_676b9b1c;
    FUN_676850f1((int)&local_14);
  }
  return;
}



// Function: FUN_676ad569 at 676ad569

void __cdecl FUN_676ad569(LPCWSTR param_1)

{
  LPCWSTR pWVar1;
  int iVar2;
  HANDLE hFindFile;
  BOOL BVar3;
  _WIN32_FIND_DATAW local_254;
  
  if (param_1 != (LPCWSTR)0x0) {
    iVar2 = FUN_676ae2a4(param_1);
    if ((iVar2 == 0) ||
       ((iVar2 = FUN_676ae2a4(param_1), param_1[iVar2 + -1] != L'\\' &&
        (iVar2 = FUN_676ae2a4(param_1), param_1[iVar2 + -1] != L'/')))) {
      FUN_676ae272(param_1,(short *)&DAT_676c057c);
    }
    iVar2 = FUN_676ae2a4(param_1);
    pWVar1 = param_1 + iVar2;
    FUN_676ae1fc(pWVar1,(short *)&DAT_676c05a4);
    hFindFile = FUN_676aee00(param_1,&local_254);
    if (hFindFile != (HANDLE)0xffffffff) {
      do {
        if (((byte)local_254.dwFileAttributes & 0x10) == 0) {
          FUN_676ae1fc(pWVar1,local_254.cFileName);
          FUN_676af46d(param_1,0x80);
          FUN_676af551(param_1);
        }
        else if ((local_254.cFileName[0] != L'.') ||
                ((local_254.cFileName[1] != L'\0' &&
                 ((local_254.cFileName[1] != L'.' || (local_254.cFileName[2] != L'\0')))))) {
          FUN_676ae1fc(pWVar1,local_254.cFileName);
          FUN_676ad569(param_1);
          FUN_676af5c0(param_1);
        }
        BVar3 = FUN_676aee96(hFindFile,&local_254);
      } while (BVar3 != 0);
      FindClose(hFindFile);
    }
    *pWVar1 = L'\0';
    FUN_676af746(param_1,(LPCWSTR)0x0);
    return;
  }
  return;
}



// Function: FUN_676ad688 at 676ad688

int __cdecl FUN_676ad688(int param_1,uint param_2,int param_3,int param_4)

{
  char *pcVar1;
  uint uVar2;
  int iVar3;
  
  if ((((param_1 != 0) && (param_3 != 0)) && (param_2 != 0)) && (param_4 != 0)) {
    uVar2 = 0;
    iVar3 = 0;
    if (param_2 != 0) {
      do {
        pcVar1 = (char *)(uVar2 + param_1);
        uVar2 = uVar2 + 1;
        if (*pcVar1 == *(char *)(iVar3 + param_3)) {
          iVar3 = iVar3 + 1;
          if (iVar3 == param_4) {
            return uVar2 - iVar3;
          }
        }
        else if (iVar3 != 0) {
          uVar2 = uVar2 - iVar3;
          iVar3 = 0;
        }
      } while (uVar2 < param_2);
    }
  }
  return -1;
}



// Function: FUN_676ad6f8 at 676ad6f8

undefined4 * __fastcall FUN_676ad6f8(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676bb444;
  FUN_676adf5a('\x01');
  param_1[1] = 0;
  return param_1;
}



// Function: FUN_676ad711 at 676ad711

undefined4 * __thiscall FUN_676ad711(void *this,byte param_1)

{
  FUN_676ad72d((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_676ad72d at 676ad72d

void __fastcall FUN_676ad72d(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676bb444;
  FUN_676ada88((int)param_1);
  FUN_676adf5a('\0');
  return;
}



// Function: FUN_676ad741 at 676ad741

undefined4 * __thiscall FUN_676ad741(void *this,int param_1)

{
  DWORD DVar1;
  HANDLE hHeap;
  LPVOID pvVar2;
  DWORD dwFlags;
  
  *(undefined ***)this = &PTR_FUN_676bb444;
  FUN_676adf5a('\x01');
  if (*(int *)(param_1 + 4) == 0) {
    *(undefined4 *)((int)this + 4) = 0;
  }
  else {
    DVar1 = FUN_676adaa8(param_1);
    dwFlags = 8;
    hHeap = GetProcessHeap();
    pvVar2 = HeapAlloc(hHeap,dwFlags,DVar1);
    *(LPVOID *)((int)this + 4) = pvVar2;
    if (pvVar2 != (LPVOID)0x0) {
      DVar1 = FUN_676adaa8(param_1);
      FUN_676b06d0(*(undefined4 **)((int)this + 4),*(undefined4 **)(param_1 + 4),DVar1);
    }
  }
  return (undefined4 *)this;
}



// Function: FUN_676ad79e at 676ad79e

void FUN_676ad79e(void)

{
  FUN_676adf5a('\x01');
  return;
}



// Function: FUN_676ad7a7 at 676ad7a7

void FUN_676ad7a7(void)

{
  FUN_676adf5a('\0');
  return;
}



// Function: FUN_676ad7b0 at 676ad7b0

bool __thiscall FUN_676ad7b0(void *this,LPCWSTR param_1)

{
  char extraout_AL;
  int iVar1;
  DWORD DVar2;
  HANDLE Handle;
  HANDLE hHeap;
  LPVOID pSecurityDescriptor;
  BOOL BVar3;
  char cVar4;
  DWORD DVar5;
  char cVar6;
  bool bVar7;
  uint local_18;
  SECURITY_INFORMATION local_14;
  uint local_10;
  DWORD local_c;
  char local_5;
  
  FUN_676ada88((int)this);
  if ((param_1 != (LPCWSTR)0x0) && (iVar1 = FUN_676ae2a4(param_1), iVar1 != 0)) {
    local_5 = '\0';
    local_18 = 0;
    local_10 = 0;
    FUN_676add9e(this,param_1,&local_18,&local_5,&local_10);
    if (extraout_AL != '\0') {
      if ((local_18 & 8) == 0) {
        return true;
      }
      bVar7 = false;
      if ((param_1[iVar1 + -1] == L'/') || (param_1[iVar1 + -1] == L'\\')) {
        bVar7 = true;
      }
      cVar4 = DAT_676c564e;
      cVar6 = DAT_676c564c;
      if ((local_5 != '\0') && (cVar6 = (local_10 & 1) != 0, cVar4 = '\0', (local_10 & 4) != 0)) {
        cVar4 = '\x01';
      }
      DVar5 = 0x20000;
      local_14 = 7;
      if ((cVar6 != '\0') || (cVar4 != '\0')) {
        DVar5 = 0x1020000;
        local_14 = 0xf;
      }
      DVar2 = 0;
      if ((cVar6 != '\0') || (bVar7)) {
        DVar2 = 0x2000000;
      }
      Handle = FUN_676aeee9(param_1,DVar5,7,(LPSECURITY_ATTRIBUTES)0x0,3,DVar2,(HANDLE)0x0);
      if (Handle == (HANDLE)0xffffffff) {
        return true;
      }
      bVar7 = false;
      local_c = 0;
      GetKernelObjectSecurity(Handle,local_14,(PSECURITY_DESCRIPTOR)0x0,0,&local_c);
      DVar5 = GetLastError();
      if (DVar5 == 0x7a) {
        DVar2 = 8;
        DVar5 = local_c;
        hHeap = GetProcessHeap();
        pSecurityDescriptor = HeapAlloc(hHeap,DVar2,DVar5);
        if (pSecurityDescriptor == (LPVOID)0x0) {
          return true;
        }
        BVar3 = GetKernelObjectSecurity(Handle,local_14,pSecurityDescriptor,local_c,&local_c);
        bVar7 = BVar3 != 0;
        if (bVar7) {
          *(LPVOID *)((int)this + 4) = pSecurityDescriptor;
        }
      }
      CloseHandle(Handle);
      return !bVar7;
    }
  }
  return true;
}



// Function: FUN_676ad911 at 676ad911

bool __thiscall FUN_676ad911(void *this,LPCWSTR param_1)

{
  char extraout_AL;
  DWORD DVar1;
  undefined4 uVar2;
  int iVar3;
  BOOL BVar4;
  HANDLE Handle;
  DWORD DVar5;
  uint SecurityInformation;
  DWORD local_24;
  int local_20;
  uint local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  uint local_c;
  byte local_8 [3];
  char local_5;
  
  if (param_1 != (LPCWSTR)0x0) {
    local_10 = this;
    DVar1 = FUN_676adaa8((int)this);
    if (DVar1 == 0) {
      return true;
    }
    uVar2 = FUN_676adacc((int)local_10);
    if ((char)uVar2 == '\0') {
      return true;
    }
    iVar3 = FUN_676ae2a4(param_1);
    if (iVar3 != 0) {
      local_1c = 0;
      local_5 = '\0';
      local_14 = 0;
      FUN_676add9e(local_10,param_1,&local_1c,&local_5,&local_14);
      if (extraout_AL != '\0') {
        if ((local_1c & 8) == 0) {
          return true;
        }
        local_c = 0;
        local_18 = 0;
        local_20 = 0;
        if ((param_1[iVar3 + -1] == L'/') || (param_1[iVar3 + -1] == L'\\')) {
          local_20 = 1;
        }
        BVar4 = GetSecurityDescriptorControl
                          (*(PSECURITY_DESCRIPTOR *)((int)local_10 + 4),
                           (PSECURITY_DESCRIPTOR_CONTROL)local_8,&local_24);
        if (BVar4 == 0) {
          return true;
        }
        if (local_5 == '\0') {
          local_c = (uint)DAT_676c564d;
          local_18 = (uint)DAT_676c564e;
        }
        else {
          if ((local_14 & 2) != 0) {
            local_c = 1;
          }
          if ((local_14 & 4) != 0) {
            local_18 = 1;
          }
        }
        DVar1 = 0;
        DVar5 = 0;
        SecurityInformation = 0;
        if ((local_8[0] & 4) != 0) {
          DVar1 = 0x40000;
          SecurityInformation = 4;
          if (local_c != 0) {
            DVar1 = 0xc0000;
            SecurityInformation = 7;
          }
        }
        if (((local_8[0] & 0x10) != 0) && ((local_c != 0 || (local_18 != 0)))) {
          DVar1 = DVar1 | 0x1000000;
          SecurityInformation = SecurityInformation | 8;
        }
        if (SecurityInformation == 0) {
          return false;
        }
        if ((local_c != 0) || (local_20 != 0)) {
          DVar5 = 0x2000000;
        }
        Handle = FUN_676aeee9(param_1,DVar1,7,(LPSECURITY_ATTRIBUTES)0x0,3,DVar5,(HANDLE)0x0);
        if (Handle == (HANDLE)0xffffffff) {
          return true;
        }
        BVar4 = SetKernelObjectSecurity
                          (Handle,SecurityInformation,*(PSECURITY_DESCRIPTOR *)((int)local_10 + 4));
        CloseHandle(Handle);
        return BVar4 == 0;
      }
    }
  }
  return true;
}



// Function: FUN_676ada88 at 676ada88

void __fastcall FUN_676ada88(int param_1)

{
  HANDLE hHeap;
  DWORD dwFlags;
  LPVOID lpMem;
  
  lpMem = *(LPVOID *)(param_1 + 4);
  if (lpMem != (LPVOID)0x0) {
    dwFlags = 0;
    hHeap = GetProcessHeap();
    HeapFree(hHeap,dwFlags,lpMem);
    *(undefined4 *)(param_1 + 4) = 0;
  }
  return;
}



// Function: FUN_676adaa8 at 676adaa8

DWORD __fastcall FUN_676adaa8(int param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  
  if (*(PSECURITY_DESCRIPTOR *)(param_1 + 4) != (PSECURITY_DESCRIPTOR)0x0) {
    BVar1 = IsValidSecurityDescriptor(*(PSECURITY_DESCRIPTOR *)(param_1 + 4));
    if (BVar1 != 0) {
      DVar2 = GetSecurityDescriptorLength(*(PSECURITY_DESCRIPTOR *)(param_1 + 4));
      return DVar2;
    }
  }
  return 0;
}



// Function: FUN_676adacc at 676adacc

uint __fastcall FUN_676adacc(int param_1)

{
  PSECURITY_DESCRIPTOR pSecurityDescriptor;
  BOOL local_14;
  int local_10;
  PACL local_c;
  PSID local_8;
  
  pSecurityDescriptor = *(PSECURITY_DESCRIPTOR *)(param_1 + 4);
  if ((pSecurityDescriptor != (PSECURITY_DESCRIPTOR)0x0) &&
     ((((pSecurityDescriptor = (PSECURITY_DESCRIPTOR)IsValidSecurityDescriptor(pSecurityDescriptor),
        pSecurityDescriptor == (PSECURITY_DESCRIPTOR)0x0 ||
        (pSecurityDescriptor =
              (PSECURITY_DESCRIPTOR)
              GetSecurityDescriptorDacl
                        (*(PSECURITY_DESCRIPTOR *)(param_1 + 4),&local_10,&local_c,&local_14),
        pSecurityDescriptor == (PSECURITY_DESCRIPTOR)0x0)) ||
       ((local_10 != 0 &&
        (pSecurityDescriptor = (PSECURITY_DESCRIPTOR)IsValidAcl(local_c),
        pSecurityDescriptor == (PSECURITY_DESCRIPTOR)0x0)))) ||
      ((pSecurityDescriptor =
             (PSECURITY_DESCRIPTOR)
             GetSecurityDescriptorSacl
                       (*(PSECURITY_DESCRIPTOR *)(param_1 + 4),&local_10,&local_c,&local_14),
       pSecurityDescriptor == (PSECURITY_DESCRIPTOR)0x0 ||
       ((((((local_10 != 0 && (local_c != (PACL)0x0)) &&
           (pSecurityDescriptor = (PSECURITY_DESCRIPTOR)IsValidAcl(local_c),
           pSecurityDescriptor == (PSECURITY_DESCRIPTOR)0x0)) ||
          (pSecurityDescriptor =
                (PSECURITY_DESCRIPTOR)
                GetSecurityDescriptorOwner
                          (*(PSECURITY_DESCRIPTOR *)(param_1 + 4),&local_8,&local_14),
          pSecurityDescriptor == (PSECURITY_DESCRIPTOR)0x0)) ||
         ((local_8 != (PSID)0x0 &&
          (pSecurityDescriptor = (PSECURITY_DESCRIPTOR)IsValidSid(local_8),
          pSecurityDescriptor == (PSECURITY_DESCRIPTOR)0x0)))) ||
        ((pSecurityDescriptor =
               (PSECURITY_DESCRIPTOR)
               GetSecurityDescriptorGroup(*(PSECURITY_DESCRIPTOR *)(param_1 + 4),&local_8,&local_14)
         , pSecurityDescriptor == (PSECURITY_DESCRIPTOR)0x0 ||
         ((local_8 != (PSID)0x0 &&
          (pSecurityDescriptor = (PSECURITY_DESCRIPTOR)IsValidSid(local_8),
          pSecurityDescriptor == (PSECURITY_DESCRIPTOR)0x0)))))))))))) {
    return (uint)pSecurityDescriptor & 0xffffff00;
  }
  return CONCAT31((int3)((uint)pSecurityDescriptor >> 8),1);
}



// Function: FUN_676adba7 at 676adba7

undefined4 __fastcall FUN_676adba7(int param_1)

{
  return *(undefined4 *)(param_1 + 4);
}



// Function: FUN_676adbab at 676adbab

int __thiscall FUN_676adbab(void *this,undefined4 *param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  HANDLE hHeap;
  undefined4 *puVar3;
  DWORD dwFlags;
  DWORD dwBytes;
  
  FUN_676ada88((int)this);
  if (param_1 != (undefined4 *)0x0) {
    BVar1 = IsValidSecurityDescriptor(param_1);
    if (BVar1 != 0) {
      DVar2 = GetSecurityDescriptorLength(param_1);
      if (DVar2 != 0) {
        dwFlags = 8;
        dwBytes = DVar2;
        hHeap = GetProcessHeap();
        puVar3 = (undefined4 *)HeapAlloc(hHeap,dwFlags,dwBytes);
        *(undefined4 **)((int)this + 4) = puVar3;
        if (puVar3 != (undefined4 *)0x0) {
          FUN_676b06d0(puVar3,param_1,DVar2);
        }
      }
    }
  }
  return (int)this;
}



// Function: FUN_676adbff at 676adbff

void FUN_676adbff(LPCWSTR param_1,uint *param_2)

{
  HANDLE pvVar1;
  DWORD DVar2;
  HANDLE pvVar3;
  BOOL BVar4;
  LPVOID pvVar5;
  DWORD DVar6;
  DWORD local_8;
  LPVOID pvStack_4;
  
  if ((param_2 != (uint *)0x0) && (*param_2 = 0, param_1 != (LPCWSTR)0x0)) {
    pvVar1 = FUN_676aeee9(param_1,0x81020000,7,(LPSECURITY_ATTRIBUTES)0x0,3,0x2000000,(HANDLE)0x0);
    if (pvVar1 != (HANDLE)0xffffffff) {
      local_8 = 0;
      GetKernelObjectSecurity(pvVar1,0xc,(PSECURITY_DESCRIPTOR)0x0,0,&local_8);
      DVar2 = GetLastError();
      if (DVar2 == 0x7a) {
        DVar6 = 8;
        DVar2 = local_8;
        pvVar3 = GetProcessHeap();
        pvStack_4 = HeapAlloc(pvVar3,DVar6,DVar2);
        if (pvStack_4 == (LPVOID)0x0) {
          return;
        }
        BVar4 = GetKernelObjectSecurity(pvVar1,0xc,pvStack_4,local_8,&local_8);
        if (BVar4 != 0) {
          *param_2 = *param_2 | 1;
        }
        DVar2 = 0;
        pvVar5 = pvStack_4;
        pvVar3 = GetProcessHeap();
        HeapFree(pvVar3,DVar2,pvVar5);
      }
      CloseHandle(pvVar1);
    }
    pvVar1 = FUN_676aeee9(param_1,0x10e0000,5,(LPSECURITY_ATTRIBUTES)0x0,3,0x2000000,(HANDLE)0x0);
    if (pvVar1 != (HANDLE)0xffffffff) {
      local_8 = 0;
      GetKernelObjectSecurity(pvVar1,0xf,(PSECURITY_DESCRIPTOR)0x0,0,&local_8);
      DVar2 = GetLastError();
      if (DVar2 == 0x7a) {
        DVar6 = 8;
        DVar2 = local_8;
        pvVar3 = GetProcessHeap();
        pvVar5 = HeapAlloc(pvVar3,DVar6,DVar2);
        if (pvVar5 == (LPVOID)0x0) {
          return;
        }
        BVar4 = GetKernelObjectSecurity(pvVar1,0xf,pvVar5,local_8,&local_8);
        if ((BVar4 != 0) && (BVar4 = SetKernelObjectSecurity(pvVar1,0xf,pvVar5), BVar4 != 0)) {
          *param_2 = *param_2 | 2;
        }
        DVar2 = 0;
        pvVar3 = GetProcessHeap();
        HeapFree(pvVar3,DVar2,pvVar5);
      }
      CloseHandle(pvVar1);
    }
    if ((((*param_2 & 1) == 0) || ((*param_2 & 2) == 0)) &&
       (pvVar1 = FUN_676aeee9(param_1,0x1000000,7,(LPSECURITY_ATTRIBUTES)0x0,3,0,(HANDLE)0x0),
       pvVar1 != (HANDLE)0xffffffff)) {
      *param_2 = *param_2 | 4;
      CloseHandle(pvVar1);
    }
  }
  return;
}



// Function: FUN_676add9e at 676add9e

bool __thiscall
FUN_676add9e(undefined4 param_1,LPCWSTR param_2,uint *param_3,undefined1 *param_4,uint *param_5)

{
  short sVar1;
  uint uVar2;
  BOOL BVar3;
  UINT UVar4;
  DWORD DVar5;
  short *psVar6;
  uint uVar7;
  undefined1 uVar8;
  int iVar9;
  bool bVar10;
  short local_220 [262];
  undefined4 local_14;
  uint local_10;
  DWORD local_c;
  undefined1 in_stack_fffffffb;
  
  local_14 = param_1;
  if ((param_2 != (LPCWSTR)0x0) && (*param_2 != L'\0')) {
    uVar2 = FUN_676ae2a4(param_2);
    if (0x104 < uVar2) {
      return (bool)in_stack_fffffffb;
    }
    psVar6 = local_220;
    iVar9 = uVar2 + 1;
    uVar7 = 2;
    do {
      sVar1 = *(short *)(((int)param_2 - (int)local_220) + (int)psVar6);
      if (sVar1 == 0x2f) {
        *psVar6 = 0x5c;
      }
      else {
        *psVar6 = sVar1;
      }
      psVar6 = psVar6 + 1;
      iVar9 = iVar9 + -1;
    } while (iVar9 != 0);
    if ((local_220[0] == 0x5c) && (local_220[1] == 0x5c)) {
      iVar9 = 0;
      if (2 < uVar2) {
        psVar6 = local_220 + 2;
        do {
          if ((*psVar6 == 0x5c) && (iVar9 = iVar9 + 1, iVar9 == 2)) {
            uVar2 = uVar7 + 1;
            local_220[uVar2] = 0;
            break;
          }
          uVar7 = uVar7 + 1;
          psVar6 = psVar6 + 1;
        } while (uVar7 < uVar2);
        if ((iVar9 == 1) && (local_220[uVar2] != 0x5c)) {
          local_220[uVar2] = 0x5c;
          local_220[uVar2 + 1] = 0;
        }
      }
    }
    else if (local_220[1] == 0x3a) {
      local_220[3] = 0;
      local_220[2] = 0x5c;
    }
    else {
      local_220[0] = 0;
    }
  }
  uVar8 = 0;
  local_c = 0;
  local_10 = 0;
  BVar3 = GetVolumeInformationW
                    ((LPCWSTR)(-(uint)(local_220[0] != 0) & (uint)local_220),(LPWSTR)0x0,0,
                     (LPDWORD)0x0,(LPDWORD)0x0,&local_c,(LPWSTR)0x0,0);
  bVar10 = BVar3 != 0;
  if (bVar10) {
    if (((local_c & 8) != 0) &&
       (UVar4 = FUN_676af2c4((LPCWSTR)(-(uint)(local_220[0] != 0) & (uint)local_220)), UVar4 == 4))
    {
      uVar8 = 1;
      FUN_676adbff(param_2,&local_10);
    }
  }
  else {
    DVar5 = GetLastError();
    if (DVar5 != 0x78) {
      return bVar10;
    }
    bVar10 = true;
  }
  if (param_3 != (uint *)0x0) {
    *param_3 = local_c;
  }
  if (param_4 != (undefined1 *)0x0) {
    *param_4 = uVar8;
  }
  if (param_5 != (uint *)0x0) {
    *param_5 = local_10;
  }
  return bVar10;
}



// Function: FUN_676adf5a at 676adf5a

void __cdecl FUN_676adf5a(char param_1)

{
  LONG LVar1;
  HANDLE ProcessHandle;
  BOOL BVar2;
  DWORD DVar3;
  HANDLE *TokenHandle;
  _TOKEN_PRIVILEGES local_18;
  HANDLE local_8;
  
  if (param_1 == '\0') {
    LVar1 = InterlockedDecrement((LONG *)&DAT_676c20b4);
    if (-1 < LVar1) {
      return;
    }
  }
  else {
    LVar1 = InterlockedIncrement((LONG *)&DAT_676c20b4);
    if (0 < LVar1) {
      return;
    }
  }
  TokenHandle = &local_8;
  DVar3 = 0x28;
  ProcessHandle = GetCurrentProcess();
  BVar2 = OpenProcessToken(ProcessHandle,DVar3,TokenHandle);
  if (BVar2 != 0) {
    local_18.Privileges[0].Attributes = -(uint)(param_1 != '\0') & 2;
    local_18.PrivilegeCount = 1;
    BVar2 = LookupPrivilegeValueA
                      ((LPCSTR)0x0,s_SeBackupPrivilege_676c20e0,&local_18.Privileges[0].Luid);
    if (((BVar2 != 0) &&
        (BVar2 = AdjustTokenPrivileges(local_8,0,&local_18,0,(PTOKEN_PRIVILEGES)0x0,(PDWORD)0x0),
        BVar2 != 0)) && (DVar3 = GetLastError(), DVar3 == 0)) {
      DAT_676c564c = param_1;
    }
    BVar2 = LookupPrivilegeValueA
                      ((LPCSTR)0x0,s_SeRestorePrivilege_676c20cc,&local_18.Privileges[0].Luid);
    if (((BVar2 != 0) &&
        (BVar2 = AdjustTokenPrivileges(local_8,0,&local_18,0,(PTOKEN_PRIVILEGES)0x0,(PDWORD)0x0),
        BVar2 != 0)) && (DVar3 = GetLastError(), DVar3 == 0)) {
      DAT_676c564d = param_1;
    }
    if (((DAT_676c564c == '\0') || (DAT_676c564d == '\0')) &&
       ((BVar2 = LookupPrivilegeValueA
                           ((LPCSTR)0x0,s_SeSecurityPrivilege_676c20b8,&local_18.Privileges[0].Luid)
        , BVar2 != 0 &&
        ((BVar2 = AdjustTokenPrivileges(local_8,0,&local_18,0,(PTOKEN_PRIVILEGES)0x0,(PDWORD)0x0),
         BVar2 != 0 && (DVar3 = GetLastError(), DVar3 == 0)))))) {
      DAT_676c564e = param_1;
    }
    CloseHandle(local_8);
  }
  return;
}



// Function: FUN_676ae089 at 676ae089

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_676ae089(void)

{
  _DAT_676c5658 = &PTR_FUN_676b9a34;
  DAT_676c565c = 0;
  DAT_676c5660 = 0;
  DAT_676c5664 = 0;
  DAT_676c5668 = 0;
  return;
}



// Function: FUN_676ae0aa at 676ae0aa

void FUN_676ae0aa(void)

{
  FUN_676b0c45(&LAB_676ae0b6);
  return;
}



// Function: FUN_676ae0e5 at 676ae0e5

undefined4 * __thiscall FUN_676ae0e5(void *this,short *param_1)

{
  int iVar1;
  short *psVar2;
  
  FUN_676aeb44((undefined4 *)this);
  *(undefined ***)this = &PTR_FUN_676bb448;
  if (param_1 == (short *)0x0) {
    *(undefined4 *)((int)this + 0x10) = 0;
  }
  else {
    iVar1 = FUN_676ae2a4(param_1);
    psVar2 = (short *)operator_new(iVar1 * 2 + 2);
    *(short **)((int)this + 0x10) = psVar2;
    FUN_676ae1fc(psVar2,param_1);
  }
  return (undefined4 *)this;
}



// Function: FUN_676ae12c at 676ae12c

undefined4 * __thiscall FUN_676ae12c(void *this,byte param_1)

{
  FUN_676ae148((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_676ae148 at 676ae148

void __fastcall FUN_676ae148(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676bb448;
  if ((undefined *)param_1[4] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[4]);
    param_1[4] = 0;
  }
  *param_1 = &PTR_FUN_676b9c30;
  FUN_676aeb74(param_1);
  return;
}



// Function: FUN_676ae172 at 676ae172

undefined4 * __thiscall FUN_676ae172(void *this,short *param_1)

{
  int iVar1;
  short *psVar2;
  
  FUN_676aeb44((undefined4 *)this);
  *(undefined ***)this = &PTR_FUN_676bb458;
  if (param_1 == (short *)0x0) {
    *(undefined4 *)((int)this + 0x10) = 0;
  }
  else {
    iVar1 = FUN_676ae2a4(param_1);
    psVar2 = (short *)operator_new(iVar1 * 2 + 2);
    *(short **)((int)this + 0x10) = psVar2;
    FUN_676ae1fc(psVar2,param_1);
  }
  return (undefined4 *)this;
}



// Function: FUN_676ae1b6 at 676ae1b6

undefined4 * __thiscall FUN_676ae1b6(void *this,byte param_1)

{
  FUN_676ae1d2((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_676ae1d2 at 676ae1d2

void __fastcall FUN_676ae1d2(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676bb458;
  if ((undefined *)param_1[4] != (undefined *)0x0) {
    FUN_676b0bb3((undefined *)param_1[4]);
    param_1[4] = 0;
  }
  *param_1 = &PTR_FUN_676b9c30;
  FUN_676aeb74(param_1);
  return;
}



// Function: FUN_676ae1fc at 676ae1fc

void __cdecl FUN_676ae1fc(short *param_1,short *param_2)

{
  short sVar1;
  
  if ((param_1 != (short *)0x0) && (param_2 != (short *)0x0)) {
    sVar1 = *param_2;
    *param_1 = sVar1;
    while( true ) {
      param_1 = param_1 + 1;
      param_2 = param_2 + 1;
      if (sVar1 == 0) break;
      sVar1 = *param_2;
      *param_1 = sVar1;
    }
  }
  return;
}



// Function: FUN_676ae229 at 676ae229

short * __cdecl FUN_676ae229(short *param_1,short *param_2,int param_3)

{
  short sVar1;
  uint uVar2;
  uint uVar3;
  short *psVar4;
  
  if ((param_1 == (short *)0x0) || (param_2 == (short *)0x0)) {
    return param_1;
  }
  psVar4 = param_1;
  if (param_3 != 0) {
    do {
      sVar1 = *param_2;
      *psVar4 = sVar1;
      psVar4 = psVar4 + 1;
      param_2 = param_2 + 1;
      if (sVar1 == 0) break;
      param_3 = param_3 + -1;
    } while (param_3 != 0);
    if ((param_3 != 0) && (uVar2 = param_3 - 1, uVar2 != 0)) {
      for (uVar3 = uVar2 >> 1; uVar3 != 0; uVar3 = uVar3 - 1) {
        psVar4[0] = 0;
        psVar4[1] = 0;
        psVar4 = psVar4 + 2;
      }
      for (uVar2 = (uint)((uVar2 & 1) != 0); uVar2 != 0; uVar2 = uVar2 - 1) {
        *psVar4 = 0;
        psVar4 = psVar4 + 1;
      }
    }
  }
  return param_1;
}



// Function: FUN_676ae272 at 676ae272

void __cdecl FUN_676ae272(short *param_1,short *param_2)

{
  short sVar1;
  
  if ((param_1 != (short *)0x0) && (param_2 != (short *)0x0)) {
    sVar1 = *param_1;
    while (sVar1 != 0) {
      param_1 = param_1 + 1;
      sVar1 = *param_1;
    }
    do {
      sVar1 = *param_2;
      *param_1 = sVar1;
      param_1 = param_1 + 1;
      param_2 = param_2 + 1;
    } while (sVar1 != 0);
  }
  return;
}



// Function: FUN_676ae2a4 at 676ae2a4

int __cdecl FUN_676ae2a4(short *param_1)

{
  short sVar1;
  short *psVar2;
  
  if (param_1 != (short *)0x0) {
    sVar1 = *param_1;
    psVar2 = param_1 + 1;
    while (sVar1 != 0) {
      sVar1 = *psVar2;
      psVar2 = psVar2 + 1;
    }
    return ((int)psVar2 - (int)param_1 >> 1) + -1;
  }
  return 0;
}



// Function: FUN_676ae2c8 at 676ae2c8

int __cdecl FUN_676ae2c8(ushort *param_1,ushort *param_2)

{
  int iVar1;
  
  if ((param_1 == (ushort *)0x0) || (param_2 == (ushort *)0x0)) {
    iVar1 = 0;
  }
  else {
    while( true ) {
      iVar1 = (uint)*param_1 - (uint)*param_2;
      if ((iVar1 != 0) || (*param_2 == 0)) break;
      param_1 = param_1 + 1;
      param_2 = param_2 + 1;
    }
    if (iVar1 < 0) {
      return -1;
    }
    if (0 < iVar1) {
      return 1;
    }
  }
  return iVar1;
}



// Function: FUN_676ae307 at 676ae307

int __cdecl FUN_676ae307(ushort *param_1,ushort *param_2)

{
  ushort uVar1;
  ushort uVar2;
  
  if ((param_1 != (ushort *)0x0) && (param_2 != (ushort *)0x0)) {
    do {
      uVar1 = *param_1;
      if ((0x5a < uVar1) || (uVar2 = uVar1 + 0x20, uVar1 < 0x41)) {
        uVar2 = uVar1;
      }
      uVar1 = *param_2;
      if ((uVar1 < 0x5b) && (0x40 < uVar1)) {
        uVar1 = uVar1 + 0x20;
      }
      param_1 = param_1 + 1;
      param_2 = param_2 + 1;
    } while ((uVar2 != 0) && (uVar2 == uVar1));
    return (uint)uVar2 - (uint)uVar1;
  }
  return 0;
}



// Function: FUN_676ae364 at 676ae364

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_676ae364(void)

{
  DAT_676c5680 = 0;
  DAT_676c5684 = 0;
  DAT_676c5688 = 0xffffffff;
  _DAT_676c5678 = &PTR_FUN_676b9a38;
  return;
}



// Function: FUN_676ae384 at 676ae384

void FUN_676ae384(void)

{
  FUN_676b0c45(&LAB_676ae390);
  return;
}



// Function: FUN_676ae3ab at 676ae3ab

undefined4 * __thiscall FUN_676ae3ab(void *this,undefined1 param_1)

{
  FUN_676ae8c1((undefined4 *)this);
  *(undefined ***)this = &PTR_FUN_676bb468;
  *(undefined1 *)((int)this + 0x18) = param_1;
  return (undefined4 *)this;
}



// Function: FUN_676ae3c6 at 676ae3c6

undefined4 * __thiscall FUN_676ae3c6(void *this,byte param_1)

{
  FUN_676ae3e2((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_676ae3e2 at 676ae3e2

void __fastcall FUN_676ae3e2(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676bb468;
  FUN_676ae480((undefined *)param_1);
  FUN_676ae958(param_1);
  return;
}



// Function: FUN_676ae3f9 at 676ae3f9

undefined4 __thiscall FUN_676ae3f9(void *this,int param_1)

{
  short *psVar1;
  short *psVar2;
  
  psVar1 = (short *)param_1;
  if (param_1 != 0) {
    while (psVar1 = FUN_676ae823(this,&param_1), psVar1 != (short *)0x0) {
      psVar2 = (short *)operator_new((param_1 - (int)psVar1 >> 1) * 2 + 2);
      if (psVar2 == (short *)0x0) {
        return 0;
      }
      FUN_676ae229(psVar2,psVar1,param_1 - (int)psVar1 >> 1);
      psVar2[param_1 - (int)psVar1 >> 1] = 0;
      FUN_676ae98e(this,psVar2);
    }
  }
  return CONCAT31((int3)((uint)psVar1 >> 8),1);
}



// Function: FUN_676ae469 at 676ae469

undefined4 __thiscall FUN_676ae469(void *this,int param_1)

{
  undefined4 in_EAX;
  undefined4 uVar1;
  
  if (param_1 == 0) {
    uVar1 = CONCAT31((int3)((uint)in_EAX >> 8),1);
  }
  else {
    uVar1 = FUN_676ae3f9(this,param_1);
  }
  return uVar1;
}



// Function: FUN_676ae480 at 676ae480

void __fastcall FUN_676ae480(undefined *param_1)

{
  undefined4 uVar1;
  undefined *local_8;
  
  local_8 = param_1;
  while( true ) {
    uVar1 = FUN_676aea1c(param_1,&local_8);
    if ((char)uVar1 == '\0') break;
    if (local_8 != (undefined *)0x0) {
      FUN_676b0bb3(local_8);
    }
  }
  return;
}



// Function: FUN_676ae4aa at 676ae4aa

void * __thiscall FUN_676ae4aa(void *this,int param_1)

{
  FUN_676ae801(this,param_1);
  return this;
}



// Function: FUN_676ae4bc at 676ae4bc

void * __thiscall FUN_676ae4bc(void *this,int param_1)

{
  FUN_676ae801(this,param_1);
  return this;
}



// Function: FUN_676ae4ce at 676ae4ce

short * __fastcall FUN_676ae4ce(int param_1)

{
  undefined *puVar1;
  uint uVar2;
  int iVar3;
  short *psVar4;
  undefined4 uVar5;
  int iVar6;
  undefined **local_18;
  short *local_14;
  undefined4 local_10;
  int local_c;
  int local_8;
  
  iVar6 = 0;
  puVar1 = *(undefined **)(param_1 + 4);
  local_18 = &PTR_FUN_676b9a38;
  if ((puVar1 == (undefined *)0x0) &&
     (puVar1 = *(undefined **)(param_1 + 0x10), puVar1 == (undefined *)0x0)) {
    puVar1 = &DAT_676c5678;
  }
  local_14 = *(short **)(puVar1 + 4);
  local_10 = *(undefined4 *)(puVar1 + 8);
  local_c = *(int *)(puVar1 + 0xc);
  local_8 = *(int *)(puVar1 + 0x10);
  while( true ) {
    puVar1 = *(undefined **)(param_1 + 0x10);
    if (puVar1 == (undefined *)0x0) {
      puVar1 = &DAT_676c5678;
    }
    uVar2 = FUN_676aeb1e(&local_18,(int)puVar1);
    if ((char)uVar2 != '\0') break;
    iVar3 = FUN_676ae2a4(local_14);
    iVar6 = iVar6 + 2 + iVar3;
    if ((local_8 != 2) && (local_c != 0)) {
      FUN_676aea7d(&local_18,local_c);
    }
  }
  psVar4 = (short *)operator_new(iVar6 * 2 + 2);
  if (psVar4 != (short *)0x0) {
    *psVar4 = 0;
    puVar1 = *(undefined **)(param_1 + 4);
    if ((puVar1 == (undefined *)0x0) &&
       (puVar1 = *(undefined **)(param_1 + 0x10), puVar1 == (undefined *)0x0)) {
      puVar1 = &DAT_676c5678;
    }
    local_14 = *(short **)(puVar1 + 4);
    local_10 = *(undefined4 *)(puVar1 + 8);
    local_c = *(int *)(puVar1 + 0xc);
    local_8 = *(int *)(puVar1 + 0x10);
    while( true ) {
      puVar1 = *(undefined **)(param_1 + 0x10);
      if (puVar1 == (undefined *)0x0) {
        puVar1 = &DAT_676c5678;
      }
      uVar5 = FUN_6768c972(&local_18,(int)puVar1);
      if ((char)uVar5 == '\0') break;
      puVar1 = *(undefined **)(param_1 + 4);
      if ((puVar1 == (undefined *)0x0) &&
         (puVar1 = *(undefined **)(param_1 + 0x10), puVar1 == (undefined *)0x0)) {
        puVar1 = &DAT_676c5678;
      }
      uVar5 = FUN_6768c972(&local_18,(int)puVar1);
      if ((char)uVar5 != '\0') {
        FUN_676ae272(psVar4,(short *)&DAT_676c06ec);
      }
      FUN_676ae272(psVar4,local_14);
      FUN_676819c4((int)&local_18);
    }
  }
  return psVar4;
}



// Function: FUN_676ae5f4 at 676ae5f4

undefined4 __fastcall FUN_676ae5f4(int param_1)

{
  short *psVar1;
  undefined4 uVar2;
  
  psVar1 = FUN_676ae4ce(param_1);
  uVar2 = Ordinal_2(psVar1);
  FUN_676b0bb3((undefined *)psVar1);
  return uVar2;
}



// Function: FUN_676ae612 at 676ae612

uint __thiscall
FUN_676ae612(void *this,short *param_1,char param_2,char param_3,char param_4,char param_5)

{
  ushort uVar1;
  short sVar2;
  uint in_EAX;
  undefined *puVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  short *psVar7;
  short local_e54 [260];
  ushort local_c4c [260];
  short local_a44 [260];
  short local_83c [260];
  ushort local_634 [259];
  short asStack_42e [258];
  ushort auStack_22a [263];
  undefined **local_1c;
  short *local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  bool local_5;
  
  if (param_1 != (short *)0x0) {
    puVar3 = *(undefined **)((int)this + 4);
    local_1c = &PTR_FUN_676b9a38;
    if ((puVar3 == (undefined *)0x0) &&
       (puVar3 = *(undefined **)((int)this + 0x10), puVar3 == (undefined *)0x0)) {
      puVar3 = &DAT_676c5678;
    }
    local_18 = *(short **)(puVar3 + 4);
    local_14 = *(undefined4 *)(puVar3 + 8);
    local_10 = *(undefined4 *)(puVar3 + 0xc);
    local_c = *(undefined4 *)(puVar3 + 0x10);
    while( true ) {
      puVar3 = *(undefined **)((int)this + 0x10);
      if (puVar3 == (undefined *)0x0) {
        puVar3 = &DAT_676c5678;
      }
      in_EAX = FUN_6768c972(&local_1c,(int)puVar3);
      if ((char)in_EAX == '\0') break;
      uVar4 = FUN_676ae2a4(local_18);
      if (param_5 == '\0') {
        FUN_676ae1fc((short *)(auStack_22a + 3),local_18);
      }
      local_5 = param_2 != '\0';
      if (((2 < uVar4) && (auStack_22a[uVar4 + 2] == 0x3e)) && (auStack_22a[uVar4] == 0x3c)) {
        auStack_22a[uVar4] = 0;
        uVar1 = auStack_22a[uVar4 + 1];
        if ((0x51 < uVar1) && ((uVar1 < 0x54 || ((0x71 < uVar1 && (uVar1 < 0x74)))))) {
          local_5 = true;
        }
      }
      FUN_676ac8da(param_1,(short *)local_c4c,asStack_42e + 1,local_83c);
      FUN_676ac8da((short *)(auStack_22a + 3),(short *)local_634,local_e54,local_a44);
      if (((local_634[0] == 0) || (iVar5 = FUN_676ae307(local_c4c,local_634), iVar5 == 0)) &&
         ((((iVar5 = FUN_676ae2a4(asStack_42e + 1), local_83c[0] == 0 && (param_3 != '\0')) &&
           (((local_5 != false && (param_4 == '\0')) || (local_a44[0] == 0)))) ||
          (iVar6 = FUN_676acdfe(local_83c,local_a44), iVar6 != 0)))) {
        do {
          iVar6 = FUN_676acdfe(asStack_42e + 1,local_e54);
          if (iVar6 != 0) {
            return CONCAT31((int3)((uint)iVar6 >> 8),1);
          }
          if ((iVar5 < 1) || (local_5 == false)) break;
          psVar7 = asStack_42e + iVar5;
          do {
            iVar5 = iVar5 + -1;
            *psVar7 = 0;
            if ((iVar5 < 1) || (sVar2 = psVar7[-1], sVar2 == 0x5c)) break;
            psVar7 = psVar7 + -1;
          } while (sVar2 != 0x2f);
        } while( true );
      }
      FUN_676819c4((int)&local_1c);
    }
  }
  return in_EAX & 0xffffff00;
}



// Function: FUN_676ae801 at 676ae801

undefined4 __thiscall FUN_676ae801(void *this,int param_1)

{
  undefined4 uVar1;
  
                    /* WARNING: Load size is inaccurate */
  uVar1 = (**(code **)(*this + 4))();
  if (param_1 == 0) {
    uVar1 = CONCAT31((int3)((uint)uVar1 >> 8),1);
  }
  else {
    uVar1 = FUN_676ae3f9(this,param_1);
  }
  return uVar1;
}



// Function: FUN_676ae823 at 676ae823

short * __thiscall FUN_676ae823(void *this,int *param_1)

{
  short sVar1;
  short *psVar2;
  short *psVar3;
  
  if (*param_1 != 0) {
    if (*(char *)((int)this + 0x18) == '\0') {
      while( true ) {
        sVar1 = *(short *)*param_1;
        if ((sVar1 != 0xd) && (sVar1 != 10)) break;
        *param_1 = (int)((short *)*param_1 + 1);
      }
    }
    else {
      while( true ) {
        sVar1 = *(short *)*param_1;
        if (((sVar1 != 0xd) && (sVar1 != 10)) && (sVar1 != 0x7c)) break;
        *param_1 = (int)((short *)*param_1 + 1);
      }
    }
    psVar2 = (short *)*param_1;
    if (*psVar2 != 0) {
      if (*(char *)((int)this + 0x18) == '\0') {
        while( true ) {
          sVar1 = *(short *)*param_1;
          if (sVar1 == 0xd) {
            return psVar2;
          }
          if (sVar1 == 10) break;
          psVar3 = (short *)*param_1 + 1;
          *param_1 = (int)psVar3;
          if (*psVar3 == 0) {
            return psVar2;
          }
        }
        return psVar2;
      }
      do {
        sVar1 = *(short *)*param_1;
        if (sVar1 == 0xd) {
          return psVar2;
        }
        if (sVar1 == 10) {
          return psVar2;
        }
        if (sVar1 == 0x7c) {
          return psVar2;
        }
        psVar3 = (short *)*param_1 + 1;
        *param_1 = (int)psVar3;
      } while (*psVar3 != 0);
      return psVar2;
    }
  }
  return (short *)0x0;
}



// Function: FUN_676ae8c1 at 676ae8c1

undefined4 * __fastcall FUN_676ae8c1(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  
  *param_1 = &PTR_FUN_676bb470;
  puVar2 = (undefined4 *)operator_new(0x14);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    *puVar2 = &PTR_FUN_676b9a38;
    puVar2[2] = 0;
    puVar2[3] = 0;
    puVar2[4] = 1;
  }
  param_1[3] = puVar2;
  puVar2 = (undefined4 *)operator_new(0x14);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    *puVar2 = &PTR_FUN_676b9a38;
    puVar2[2] = 0;
    puVar2[3] = 0;
    puVar2[4] = 2;
  }
  puVar1 = (undefined4 *)param_1[3];
  param_1[4] = puVar2;
  if (puVar1 != (undefined4 *)0x0) {
    if (puVar2 != (undefined4 *)0x0) goto LAB_676ae93f;
    if (puVar1 != (undefined4 *)0x0) {
      (**(code **)*puVar1)(1);
      param_1[3] = 0;
    }
  }
  if ((undefined4 *)param_1[4] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[4])(1);
    param_1[4] = 0;
  }
LAB_676ae93f:
  FUN_676aeaba(param_1,0);
  FUN_676aeaec(param_1,0);
  param_1[5] = 0;
  return param_1;
}



// Function: FUN_676ae958 at 676ae958

void __fastcall FUN_676ae958(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676bb470;
  while (param_1[1] != 0) {
    FUN_676aea1c(param_1,(undefined4 *)0x0);
  }
  if ((undefined4 *)param_1[3] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[3])(1);
  }
  if ((undefined4 *)param_1[4] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)param_1[4])(1);
  }
  return;
}



// Function: FUN_676ae98e at 676ae98e

undefined4 __thiscall FUN_676ae98e(void *this,undefined4 param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  
  if (*(int *)((int)this + 4) == 0) {
    puVar1 = (undefined4 *)operator_new(0x14);
    if (puVar1 == (undefined4 *)0x0) {
      puVar3 = (undefined4 *)0x0;
    }
    else {
      *puVar1 = &PTR_FUN_676b9a38;
      puVar1[1] = param_1;
      puVar1[2] = 0;
      puVar1[3] = 0;
      puVar1[4] = 0;
      puVar3 = puVar1;
    }
    if (puVar3 == (undefined4 *)0x0) {
LAB_676ae9f9:
      return (uint)puVar1 & 0xffffff00;
    }
    FUN_676aeaba(this,(int)puVar3);
    puVar1 = puVar3;
  }
  else {
    puVar1 = (undefined4 *)operator_new(0x14);
    if (puVar1 == (undefined4 *)0x0) {
      puVar1 = (undefined4 *)0x0;
    }
    else {
      *puVar1 = &PTR_FUN_676b9a38;
      puVar1[1] = param_1;
      puVar1[2] = 0;
      puVar1[3] = 0;
      puVar1[4] = 0;
    }
    if (puVar1 == (undefined4 *)0x0) goto LAB_676ae9f9;
    *(undefined4 **)(*(int *)((int)this + 8) + 0xc) = puVar1;
    puVar1[2] = *(undefined4 *)((int)this + 8);
  }
  uVar2 = FUN_676aeaec(this,(int)puVar1);
  *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + 1;
  return CONCAT31((int3)((uint)uVar2 >> 8),1);
}



// Function: FUN_676aea1c at 676aea1c

uint __thiscall FUN_676aea1c(void *this,undefined4 *param_1)

{
  undefined4 *puVar1;
  uint in_EAX;
  uint uVar2;
  
  puVar1 = *(undefined4 **)((int)this + 4);
  if (puVar1 == (undefined4 *)0x0) {
    uVar2 = in_EAX & 0xffffff00;
  }
  else {
    FUN_676aeaba(this,puVar1[3]);
    if (*(int *)((int)this + 4) == 0) {
      FUN_676aeaec(this,0);
    }
    if (param_1 != (undefined4 *)0x0) {
      *param_1 = puVar1[1];
    }
    *(int *)((int)this + 0x14) = *(int *)((int)this + 0x14) + -1;
    if (puVar1 != (undefined4 *)0x0) {
      param_1 = (undefined4 *)(**(code **)*puVar1)(1);
    }
    uVar2 = CONCAT31((int3)((uint)param_1 >> 8),1);
  }
  return uVar2;
}



// Function: FUN_676aea67 at 676aea67

void __fastcall FUN_676aea67(void *param_1)

{
  while (*(int *)((int)param_1 + 4) != 0) {
    FUN_676aea1c(param_1,(undefined4 *)0x0);
  }
  return;
}



// Function: FUN_676aea7d at 676aea7d

void __thiscall FUN_676aea7d(void *this,int param_1)

{
  *(undefined4 *)((int)this + 4) = *(undefined4 *)(param_1 + 4);
  *(undefined4 *)((int)this + 8) = *(undefined4 *)(param_1 + 8);
  *(undefined4 *)((int)this + 0xc) = *(undefined4 *)(param_1 + 0xc);
  *(undefined4 *)((int)this + 0x10) = *(undefined4 *)(param_1 + 0x10);
  return;
}



// Function: FUN_676aea9e at 676aea9e

undefined4 * __thiscall FUN_676aea9e(void *this,byte param_1)

{
  FUN_676ae958((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_676aeaba at 676aeaba

void __thiscall FUN_676aeaba(void *this,int param_1)

{
  *(int *)((int)this + 4) = param_1;
  if ((param_1 != 0) && (*(int *)(param_1 + 0x10) != 0)) {
    *(undefined4 *)((int)this + 4) = 0;
  }
  if (*(int *)((int)this + 0xc) != 0) {
    *(undefined4 *)(*(int *)((int)this + 0xc) + 0xc) = *(undefined4 *)((int)this + 4);
    if (*(int *)((int)this + 4) != 0) {
      *(undefined4 *)(*(int *)((int)this + 4) + 8) = *(undefined4 *)((int)this + 0xc);
    }
  }
  return;
}



// Function: FUN_676aeaec at 676aeaec

void __thiscall FUN_676aeaec(void *this,int param_1)

{
  *(int *)((int)this + 8) = param_1;
  if ((param_1 != 0) && (*(int *)(param_1 + 0x10) != 0)) {
    *(undefined4 *)((int)this + 8) = 0;
  }
  if (*(int *)((int)this + 0x10) != 0) {
    *(undefined4 *)(*(int *)((int)this + 0x10) + 8) = *(undefined4 *)((int)this + 8);
    if (*(int *)((int)this + 8) != 0) {
      *(undefined4 *)(*(int *)((int)this + 8) + 0xc) = *(undefined4 *)((int)this + 0x10);
    }
  }
  return;
}



// Function: FUN_676aeb1e at 676aeb1e

uint __thiscall FUN_676aeb1e(void *this,int param_1)

{
  int iVar1;
  uint3 uVar3;
  uint uVar2;
  
  iVar1 = *(int *)((int)this + 0x10);
  uVar3 = (uint3)((uint)iVar1 >> 8);
  if (iVar1 == *(int *)(param_1 + 0x10)) {
    if (iVar1 == 0) {
      uVar2 = (uint)(*(int *)((int)this + 4) == *(int *)(param_1 + 4));
    }
    else {
      uVar2 = CONCAT31(uVar3,1);
    }
  }
  else {
    uVar2 = (uint)uVar3 << 8;
  }
  return uVar2;
}



// Function: FUN_676aeb44 at 676aeb44

void __fastcall FUN_676aeb44(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676bb478;
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  return;
}



// Function: FUN_676aeb58 at 676aeb58

undefined4 * __thiscall FUN_676aeb58(void *this,byte param_1)

{
  FUN_676aeb74((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_676aeb74 at 676aeb74

void __fastcall FUN_676aeb74(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676bb478;
  FUN_676aec28((int)param_1);
  return;
}



// Function: FUN_676aeb7f at 676aeb7f

void __thiscall FUN_676aeb7f(void *this,int param_1)

{
  int *piVar1;
  int iVar2;
  
  if (param_1 == 0) {
    iVar2 = 0;
  }
  else {
    iVar2 = *(int *)(param_1 + 4);
  }
  *(int *)((int)this + 4) = iVar2;
  *(int *)((int)this + 8) = param_1;
  if (param_1 != 0) {
    *(undefined4 *)((int)this + 0xc) = *(undefined4 *)(param_1 + 0xc);
  }
  if (iVar2 != 0) {
    *(void **)(iVar2 + 8) = this;
  }
  if (*(int *)((int)this + 8) != 0) {
    *(void **)(*(int *)((int)this + 8) + 4) = this;
  }
  iVar2 = *(int *)((int)this + 0xc);
  if (iVar2 != 0) {
    if (*(int *)(iVar2 + 4) == param_1) {
      *(void **)(iVar2 + 4) = this;
    }
    if (*(int *)(*(int *)((int)this + 0xc) + 8) == 0) {
      *(void **)(*(int *)((int)this + 0xc) + 8) = this;
    }
    piVar1 = (int *)(*(int *)((int)this + 0xc) + 0xc);
    *piVar1 = *piVar1 + 1;
  }
  return;
}



// Function: FUN_676aebd5 at 676aebd5

void __thiscall FUN_676aebd5(void *this,int param_1)

{
  int *piVar1;
  int iVar2;
  undefined4 uVar3;
  
  *(int *)((int)this + 4) = param_1;
  if (param_1 == 0) {
    uVar3 = 0;
  }
  else {
    uVar3 = *(undefined4 *)(param_1 + 8);
  }
  *(undefined4 *)((int)this + 8) = uVar3;
  if (param_1 != 0) {
    *(undefined4 *)((int)this + 0xc) = *(undefined4 *)(param_1 + 0xc);
    *(void **)(param_1 + 8) = this;
  }
  if (*(int *)((int)this + 8) != 0) {
    *(void **)(*(int *)((int)this + 8) + 4) = this;
  }
  iVar2 = *(int *)((int)this + 0xc);
  if (iVar2 != 0) {
    if (*(int *)(iVar2 + 8) == *(int *)((int)this + 4)) {
      *(void **)(iVar2 + 8) = this;
    }
    if (*(int *)(*(int *)((int)this + 0xc) + 4) == 0) {
      *(void **)(*(int *)((int)this + 0xc) + 4) = this;
    }
    piVar1 = (int *)(*(int *)((int)this + 0xc) + 0xc);
    *piVar1 = *piVar1 + 1;
  }
  return;
}



// Function: FUN_676aec28 at 676aec28

void __fastcall FUN_676aec28(int param_1)

{
  int *piVar1;
  int iVar2;
  
  if (*(int *)(param_1 + 4) != 0) {
    *(undefined4 *)(*(int *)(param_1 + 4) + 8) = *(undefined4 *)(param_1 + 8);
  }
  if (*(int *)(param_1 + 8) != 0) {
    *(undefined4 *)(*(int *)(param_1 + 8) + 4) = *(undefined4 *)(param_1 + 4);
  }
  iVar2 = *(int *)(param_1 + 0xc);
  if (iVar2 != 0) {
    if (*(int *)(iVar2 + 4) == param_1) {
      *(undefined4 *)(iVar2 + 4) = *(undefined4 *)(param_1 + 8);
    }
    if (*(int *)(*(int *)(param_1 + 0xc) + 8) == param_1) {
      *(undefined4 *)(*(int *)(param_1 + 0xc) + 8) = *(undefined4 *)(param_1 + 4);
    }
    piVar1 = (int *)(*(int *)(param_1 + 0xc) + 0xc);
    *piVar1 = *piVar1 + -1;
  }
  *(undefined4 *)(param_1 + 0xc) = 0;
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined4 *)(param_1 + 8) = 0;
  return;
}



// Function: FUN_676aec78 at 676aec78

void __fastcall FUN_676aec78(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676bb47c;
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  return;
}



// Function: FUN_676aec8c at 676aec8c

undefined4 * __thiscall FUN_676aec8c(void *this,byte param_1)

{
  FUN_676aeca8((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_676aeca8 at 676aeca8

void __fastcall FUN_676aeca8(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_676bb47c;
  return;
}



// Function: FUN_676aecaf at 676aecaf

int __thiscall FUN_676aecaf(void *this,int param_1,char param_2)

{
  int iVar1;
  uint3 uVar2;
  
  if (param_2 == '\0') {
    iVar1 = *(int *)((int)this + 4);
  }
  else {
    iVar1 = *(int *)((int)this + 8);
  }
  while( true ) {
    uVar2 = (uint3)((uint)iVar1 >> 8);
    if (iVar1 == 0) {
      return (uint)uVar2 << 8;
    }
    if (iVar1 == param_1) break;
    if (param_2 == '\0') {
      iVar1 = *(int *)(iVar1 + 8);
    }
    else {
      iVar1 = *(int *)(iVar1 + 4);
    }
  }
  return CONCAT31(uVar2,1);
}



// Function: FUN_676aed2a at 676aed2a

void __fastcall FUN_676aed2a(int param_1)

{
  while (*(int *)(param_1 + 4) != 0) {
    FUN_676aec28(*(int *)(param_1 + 4));
  }
  return;
}



// Function: FUN_676aed3d at 676aed3d

void __thiscall FUN_676aed3d(void *this,void *param_1)

{
  if (param_1 != (void *)0x0) {
    *(void **)((int)param_1 + 0xc) = this;
    FUN_676aeb7f(param_1,*(int *)((int)this + 4));
  }
  return;
}



// Function: FUN_676aed55 at 676aed55

void __thiscall FUN_676aed55(void *this,void *param_1)

{
  if (param_1 != (void *)0x0) {
    *(void **)((int)param_1 + 0xc) = this;
    FUN_676aebd5(param_1,*(int *)((int)this + 8));
  }
  return;
}



// Function: FUN_676aedac at 676aedac

int * __thiscall FUN_676aedac(void *this,undefined4 param_1)

{
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x14))(param_1);
  return (int *)this;
}



// Function: FUN_676aedbe at 676aedbe

int * __thiscall FUN_676aedbe(void *this,undefined4 param_1)

{
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x20))(param_1);
  return (int *)this;
}



// Function: FUN_676aedd8 at 676aedd8

undefined4 FUN_676aedd8(int param_1)

{
  undefined4 uVar1;
  
  if (param_1 == 0) {
    uVar1 = 0;
  }
  else {
    uVar1 = *(undefined4 *)(param_1 + 8);
  }
  return uVar1;
}



// Function: FUN_676aedea at 676aedea

undefined4 FUN_676aedea(int param_1)

{
  undefined4 uVar1;
  
  if (param_1 == 0) {
    uVar1 = 0;
  }
  else {
    uVar1 = *(undefined4 *)(param_1 + 4);
  }
  return uVar1;
}



// Function: FUN_676aedfc at 676aedfc

undefined4 __fastcall FUN_676aedfc(int param_1)

{
  return *(undefined4 *)(param_1 + 0xc);
}



// Function: FUN_676aee00 at 676aee00

HANDLE __cdecl FUN_676aee00(LPCWSTR param_1,LPWIN32_FIND_DATAW param_2)

{
  HANDLE pvVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR lpFileName;
  _WIN32_FIND_DATAA local_144;
  
  pvVar1 = FindFirstFileW(param_1,param_2);
  if (pvVar1 == (HANDLE)0xffffffff) {
    DVar2 = GetLastError();
    if (DVar2 == 0x78) {
      if (param_1 == (LPCWSTR)0x0) {
        lpFileName = (LPCSTR)0x0;
      }
      else {
        lpFileName = &stack0xfffffeb0;
        iVar3 = lstrlenW(param_1);
        FUN_676b06a0();
        WideCharToMultiByte(0,0,param_1,-1,&stack0xfffffeb0,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
      }
      pvVar1 = FindFirstFileA(lpFileName,&local_144);
      if (pvVar1 != (HANDLE)0xffffffff) {
        FUN_676afa4b(&param_2->dwFileAttributes,&local_144.dwFileAttributes);
      }
    }
  }
  return pvVar1;
}



// Function: FUN_676aee96 at 676aee96

BOOL __cdecl FUN_676aee96(HANDLE param_1,LPWIN32_FIND_DATAW param_2)

{
  BOOL BVar1;
  DWORD DVar2;
  _WIN32_FIND_DATAA local_144;
  
  BVar1 = FindNextFileW(param_1,param_2);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    if (DVar2 == 0x78) {
      BVar1 = FindNextFileA(param_1,&local_144);
      if (BVar1 != 0) {
        FUN_676afa4b(&param_2->dwFileAttributes,&local_144.dwFileAttributes);
      }
    }
  }
  return BVar1;
}



// Function: FUN_676aeee9 at 676aeee9

HANDLE __cdecl
FUN_676aeee9(LPCWSTR param_1,DWORD param_2,DWORD param_3,LPSECURITY_ATTRIBUTES param_4,DWORD param_5
            ,DWORD param_6,HANDLE param_7)

{
  HANDLE pvVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR lpFileName;
  
  SetLastError(0);
  pvVar1 = CreateFileW(param_1,param_2,param_3,param_4,param_5,param_6,param_7);
  DVar2 = GetLastError();
  if (DVar2 == 0x78) {
    if (param_1 == (LPCWSTR)0x0) {
      lpFileName = (LPCSTR)0x0;
    }
    else {
      lpFileName = &stack0xfffffff0;
      iVar3 = lstrlenW(param_1);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,param_1,-1,&stack0xfffffff0,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    }
    pvVar1 = CreateFileA(lpFileName,param_2,param_3,param_4,param_5,param_6,param_7);
  }
  return pvVar1;
}



// Function: FUN_676aef7c at 676aef7c

BOOL __cdecl FUN_676aef7c(LPCWSTR param_1,LPSECURITY_ATTRIBUTES param_2)

{
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR lpPathName;
  
  SetLastError(0);
  BVar1 = CreateDirectoryW(param_1,param_2);
  DVar2 = GetLastError();
  if (DVar2 == 0x78) {
    if (param_1 == (LPCWSTR)0x0) {
      lpPathName = (LPCSTR)0x0;
    }
    else {
      lpPathName = &stack0xfffffff0;
      iVar3 = lstrlenW(param_1);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,param_1,-1,&stack0xfffffff0,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    }
    BVar1 = CreateDirectoryA(lpPathName,param_2);
  }
  return BVar1;
}



// Function: FUN_676aeff1 at 676aeff1

DWORD __cdecl FUN_676aeff1(LPCWSTR param_1,uint param_2,LPWSTR param_3,LPWSTR *param_4)

{
  DWORD DVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR lpFileName;
  LPSTR local_c;
  LPSTR local_8;
  
  SetLastError(0);
  DVar1 = GetFullPathNameW(param_1,param_2,param_3,param_4);
  DVar2 = GetLastError();
  if (DVar2 == 0x78) {
    local_8 = (LPSTR)operator_new(param_2 + 1);
    local_c = (LPSTR)0x0;
    if (local_8 == (LPSTR)0x0) {
      SetLastError(0xe);
      DVar1 = 0;
    }
    else {
      if (param_1 == (LPCWSTR)0x0) {
        lpFileName = (LPCSTR)0x0;
      }
      else {
        lpFileName = &stack0xffffffe4;
        iVar3 = lstrlenW(param_1);
        FUN_676b06a0();
        WideCharToMultiByte(0,0,param_1,-1,&stack0xffffffe4,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
      }
      DVar1 = GetFullPathNameA(lpFileName,param_2,local_8,&local_c);
      if (((DVar1 != 0) && (DVar1 <= param_2)) &&
         (MultiByteToWideChar(0,1,local_8,-1,param_3,param_2 + 1), param_4 != (LPWSTR *)0x0)) {
        *param_4 = param_3 + ((int)local_c - (int)local_8);
      }
      FUN_676b0bb3(local_8);
    }
  }
  return DVar1;
}



// Function: FUN_676af0d8 at 676af0d8

DWORD __cdecl FUN_676af0d8(DWORD param_1,LPWSTR param_2)

{
  DWORD DVar1;
  DWORD DVar2;
  LPSTR lpBuffer;
  
  SetLastError(0);
  DVar1 = GetTempPathW(param_1,param_2);
  DVar2 = GetLastError();
  if (DVar2 == 0x78) {
    lpBuffer = (LPSTR)operator_new(param_1 + 1);
    if (lpBuffer == (LPSTR)0x0) {
      SetLastError(0xe);
      DVar1 = 0;
    }
    else {
      DVar1 = GetTempPathA(param_1,lpBuffer);
      if (DVar1 != 0) {
        MultiByteToWideChar(0,0,lpBuffer,-1,param_2,param_1 + 1);
      }
      FUN_676b0bb3(lpBuffer);
    }
  }
  return DVar1;
}



// Function: FUN_676af150 at 676af150

DWORD __cdecl FUN_676af150(LPCWSTR param_1,LPDWORD param_2)

{
  DWORD DVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR lptstrFilename;
  
  SetLastError(0);
  DVar1 = GetFileVersionInfoSizeW(param_1,param_2);
  DVar2 = GetLastError();
  if (DVar2 == 0x78) {
    if (param_1 == (LPCWSTR)0x0) {
      lptstrFilename = (LPCSTR)0x0;
    }
    else {
      lptstrFilename = &stack0xfffffff0;
      iVar3 = lstrlenW(param_1);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,param_1,-1,&stack0xfffffff0,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    }
    DVar1 = GetFileVersionInfoSizeA(lptstrFilename,param_2);
  }
  return DVar1;
}



// Function: FUN_676af1c3 at 676af1c3

BOOL __cdecl FUN_676af1c3(LPCWSTR param_1,DWORD param_2,DWORD param_3,LPVOID param_4)

{
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR lptstrFilename;
  
  SetLastError(0);
  BVar1 = GetFileVersionInfoW(param_1,param_2,param_3,param_4);
  DVar2 = GetLastError();
  if (DVar2 == 0x78) {
    if (param_1 == (LPCWSTR)0x0) {
      lptstrFilename = (LPCSTR)0x0;
    }
    else {
      lptstrFilename = &stack0xfffffff0;
      iVar3 = lstrlenW(param_1);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,param_1,-1,&stack0xfffffff0,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    }
    BVar1 = GetFileVersionInfoA(lptstrFilename,param_2,param_3,param_4);
  }
  return BVar1;
}



// Function: FUN_676af242 at 676af242

DWORD __cdecl FUN_676af242(HMODULE param_1,LPWSTR param_2,DWORD param_3)

{
  DWORD DVar1;
  DWORD DVar2;
  LPSTR lpFilename;
  
  SetLastError(0);
  DVar1 = GetModuleFileNameW(param_1,param_2,param_3);
  DVar2 = GetLastError();
  if (DVar2 == 0x78) {
    lpFilename = (LPSTR)operator_new(param_3 + 1);
    if (lpFilename == (LPSTR)0x0) {
      SetLastError(0xe);
      DVar1 = 0;
    }
    else {
      DVar1 = GetModuleFileNameA(param_1,lpFilename,param_3);
      if ((DVar1 != 0) && (param_3 != 0)) {
        MultiByteToWideChar(0,1,lpFilename,-1,param_2,param_3 + 1);
      }
      FUN_676b0bb3(lpFilename);
    }
  }
  return DVar1;
}



// Function: FUN_676af2c4 at 676af2c4

UINT __cdecl FUN_676af2c4(LPCWSTR param_1)

{
  UINT UVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR lpRootPathName;
  
  SetLastError(0);
  UVar1 = GetDriveTypeW(param_1);
  DVar2 = GetLastError();
  if (DVar2 == 0x78) {
    if (param_1 == (LPCWSTR)0x0) {
      lpRootPathName = (LPCSTR)0x0;
    }
    else {
      lpRootPathName = &stack0xfffffff0;
      iVar3 = lstrlenW(param_1);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,param_1,-1,&stack0xfffffff0,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    }
    UVar1 = GetDriveTypeA(lpRootPathName);
  }
  return UVar1;
}



// Function: FUN_676af333 at 676af333

BOOL __cdecl FUN_676af333(LPCWSTR param_1,LPCWSTR param_2)

{
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  
  if ((param_1 == (LPCWSTR)0x0) || (param_2 == (LPCWSTR)0x0)) {
    BVar1 = 0;
  }
  else {
    SetLastError(0);
    BVar1 = MoveFileW(param_1,param_2);
    DVar2 = GetLastError();
    if (DVar2 == 0x78) {
      iVar3 = lstrlenW(param_2);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,param_2,-1,&stack0xffffffec,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
      iVar3 = lstrlenW(param_1);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,param_1,-1,&stack0xffffffec,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
      BVar1 = MoveFileA(&stack0xffffffec,&stack0xffffffec);
    }
  }
  return BVar1;
}



// Function: FUN_676af3e6 at 676af3e6

BOOL __cdecl
FUN_676af3e6(LPCWSTR param_1,LPDWORD param_2,LPDWORD param_3,LPDWORD param_4,LPDWORD param_5)

{
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR lpRootPathName;
  
  SetLastError(0);
  BVar1 = GetDiskFreeSpaceW(param_1,param_2,param_3,param_4,param_5);
  DVar2 = GetLastError();
  if (DVar2 == 0x78) {
    if (param_1 == (LPCWSTR)0x0) {
      lpRootPathName = (LPCSTR)0x0;
    }
    else {
      lpRootPathName = &stack0xfffffff0;
      iVar3 = lstrlenW(param_1);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,param_1,-1,&stack0xfffffff0,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    }
    BVar1 = GetDiskFreeSpaceA(lpRootPathName,param_2,param_3,param_4,param_5);
  }
  return BVar1;
}



// Function: FUN_676af46d at 676af46d

BOOL __cdecl FUN_676af46d(LPCWSTR param_1,DWORD param_2)

{
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR lpFileName;
  
  SetLastError(0);
  BVar1 = SetFileAttributesW(param_1,param_2);
  DVar2 = GetLastError();
  if (DVar2 == 0x78) {
    if (param_1 == (LPCWSTR)0x0) {
      lpFileName = (LPCSTR)0x0;
    }
    else {
      lpFileName = &stack0xfffffff0;
      iVar3 = lstrlenW(param_1);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,param_1,-1,&stack0xfffffff0,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    }
    BVar1 = SetFileAttributesA(lpFileName,param_2);
  }
  return BVar1;
}



// Function: FUN_676af4e2 at 676af4e2

DWORD __cdecl FUN_676af4e2(LPCWSTR param_1)

{
  DWORD DVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR lpFileName;
  
  SetLastError(0);
  DVar1 = GetFileAttributesW(param_1);
  DVar2 = GetLastError();
  if (DVar2 == 0x78) {
    if (param_1 == (LPCWSTR)0x0) {
      lpFileName = (LPCSTR)0x0;
    }
    else {
      lpFileName = &stack0xfffffff0;
      iVar3 = lstrlenW(param_1);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,param_1,-1,&stack0xfffffff0,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    }
    DVar1 = GetFileAttributesA(lpFileName);
  }
  return DVar1;
}



// Function: FUN_676af551 at 676af551

BOOL __cdecl FUN_676af551(LPCWSTR param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR lpFileName;
  
  SetLastError(0);
  BVar1 = DeleteFileW(param_1);
  DVar2 = GetLastError();
  if (DVar2 == 0x78) {
    if (param_1 == (LPCWSTR)0x0) {
      lpFileName = (LPCSTR)0x0;
    }
    else {
      lpFileName = &stack0xfffffff0;
      iVar3 = lstrlenW(param_1);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,param_1,-1,&stack0xfffffff0,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    }
    BVar1 = DeleteFileA(lpFileName);
  }
  return BVar1;
}



// Function: FUN_676af5c0 at 676af5c0

BOOL __cdecl FUN_676af5c0(LPCWSTR param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR lpPathName;
  
  SetLastError(0);
  BVar1 = RemoveDirectoryW(param_1);
  DVar2 = GetLastError();
  if (DVar2 == 0x78) {
    if (param_1 == (LPCWSTR)0x0) {
      lpPathName = (LPCSTR)0x0;
    }
    else {
      lpPathName = &stack0xfffffff0;
      iVar3 = lstrlenW(param_1);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,param_1,-1,&stack0xfffffff0,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    }
    BVar1 = RemoveDirectoryA(lpPathName);
  }
  return BVar1;
}



// Function: FUN_676af62f at 676af62f

BOOL __cdecl
FUN_676af62f(LPCWSTR param_1,LPWSTR param_2,DWORD param_3,LPDWORD param_4,LPDWORD param_5,
            LPDWORD param_6,LPWSTR param_7,DWORD param_8)

{
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR lpRootPathName;
  LPCSTR local_c;
  LPSTR local_8;
  
  SetLastError(0);
  BVar1 = GetVolumeInformationW(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8);
  DVar2 = GetLastError();
  if (DVar2 == 0x78) {
    if (param_2 == (LPWSTR)0x0) {
      local_8 = (LPSTR)0x0;
    }
    else {
      local_8 = (LPSTR)operator_new(param_3 + 1);
    }
    if (param_7 == (LPWSTR)0x0) {
      local_c = (LPCSTR)0x0;
    }
    else {
      local_c = (LPCSTR)operator_new(param_8 + 1);
    }
    if (param_1 == (LPCWSTR)0x0) {
      lpRootPathName = (LPCSTR)0x0;
    }
    else {
      lpRootPathName = &stack0xffffffe8;
      iVar3 = lstrlenW(param_1);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,param_1,-1,&stack0xffffffe8,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    }
    BVar1 = GetVolumeInformationA
                      (lpRootPathName,local_8,param_3,param_4,param_5,param_6,local_c,param_8);
    if (local_8 != (LPSTR)0x0) {
      if (BVar1 != 0) {
        MultiByteToWideChar(0,1,local_8,-1,param_2,param_3);
      }
      FUN_676b0bb3(local_8);
    }
    if (local_c != (LPCSTR)0x0) {
      if (BVar1 != 0) {
        MultiByteToWideChar(0,1,local_c,-1,param_7,param_8);
      }
      FUN_676b0bb3(local_c);
    }
  }
  return BVar1;
}



// Function: FUN_676af746 at 676af746

BOOL __cdecl FUN_676af746(LPCWSTR param_1,LPCWSTR param_2)

{
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR lpRootPathName;
  
  SetLastError(0);
  BVar1 = SetVolumeLabelW(param_1,param_2);
  DVar2 = GetLastError();
  if (DVar2 == 0x78) {
    if (param_2 == (LPCWSTR)0x0) {
      param_2 = (LPCWSTR)0x0;
    }
    else {
      iVar3 = lstrlenW(param_2);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,param_2,-1,&stack0xffffffe8,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
      param_2 = (LPCWSTR)&stack0xffffffe8;
    }
    if (param_1 == (LPCWSTR)0x0) {
      lpRootPathName = (LPCSTR)0x0;
    }
    else {
      lpRootPathName = &stack0xffffffe8;
      iVar3 = lstrlenW(param_1);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,param_1,-1,&stack0xffffffe8,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    }
    BVar1 = SetVolumeLabelA(lpRootPathName,(LPCSTR)param_2);
  }
  return BVar1;
}



// Function: FUN_676af804 at 676af804

HANDLE __cdecl
FUN_676af804(HINSTANCE param_1,LPCWSTR param_2,UINT param_3,int param_4,int param_5,UINT param_6)

{
  HANDLE pvVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR name;
  
  SetLastError(0);
  pvVar1 = LoadImageW(param_1,param_2,param_3,param_4,param_5,param_6);
  DVar2 = GetLastError();
  if (DVar2 == 0x78) {
    if (param_2 == (LPCWSTR)0x0) {
      name = (LPCSTR)0x0;
    }
    else {
      name = &stack0xfffffff0;
      iVar3 = lstrlenW(param_2);
      FUN_676b06a0();
      WideCharToMultiByte(0,0,param_2,-1,&stack0xfffffff0,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
    }
    pvVar1 = LoadImageA(param_1,name,param_3,param_4,param_5,param_6);
  }
  return pvVar1;
}



// Function: FUN_676af891 at 676af891

LPWSTR __cdecl FUN_676af891(LPWSTR param_1)

{
  LPWSTR lpWideCharStr;
  DWORD DVar1;
  int iVar2;
  LPSTR lpMultiByteStr;
  uint local_8;
  
  SetLastError(0);
  lpWideCharStr = param_1;
  param_1 = CharUpperW(param_1);
  DVar1 = GetLastError();
  if (DVar1 == 0x78) {
    if ((short)((uint)lpWideCharStr >> 0x10) == 0) {
      local_8 = (uint)lpWideCharStr & 0xffff;
      WideCharToMultiByte(0,0,(LPCWSTR)&local_8,-1,(LPSTR)((int)&param_1 + 2),2,(LPCSTR)0x0,
                          (LPBOOL)0x0);
      CharUpperA((LPSTR)((int)&param_1 + 2));
      MultiByteToWideChar(0,0,(LPCSTR)((int)&param_1 + 2),-1,(LPWSTR)&local_8,2);
      param_1 = (LPWSTR)(local_8 & 0xffff);
    }
    else {
      iVar2 = FUN_676ae2a4(lpWideCharStr);
      param_1 = (LPWSTR)(iVar2 + 1);
      lpMultiByteStr = (LPSTR)operator_new((uint)param_1);
      if (lpMultiByteStr == (LPSTR)0x0) {
        SetLastError(0xe);
        param_1 = (LPWSTR)0x0;
      }
      else {
        WideCharToMultiByte(0,0,lpWideCharStr,-1,lpMultiByteStr,(int)param_1,(LPCSTR)0x0,(LPBOOL)0x0
                           );
        CharUpperA(lpMultiByteStr);
        MultiByteToWideChar(0,0,lpMultiByteStr,-1,lpWideCharStr,(int)param_1);
        param_1 = lpWideCharStr;
        FUN_676b0bb3(lpMultiByteStr);
      }
    }
  }
  return param_1;
}



// Function: FUN_676af969 at 676af969

DWORD __cdecl FUN_676af969(LPCWSTR param_1,LPWSTR param_2,DWORD param_3)

{
  DWORD DVar1;
  DWORD DVar2;
  LPCSTR lpszShortPath;
  int iVar3;
  LPCSTR lpszLongPath;
  
  SetLastError(0);
  DVar1 = GetShortPathNameW(param_1,param_2,param_3);
  DVar2 = GetLastError();
  if (DVar2 == 0x78) {
    lpszShortPath = (LPCSTR)operator_new(param_3 + 1);
    if (lpszShortPath == (LPCSTR)0x0) {
      SetLastError(0xe);
      DVar1 = 0;
    }
    else {
      if (param_1 == (LPCWSTR)0x0) {
        lpszLongPath = (LPCSTR)0x0;
      }
      else {
        lpszLongPath = &stack0xffffffe8;
        iVar3 = lstrlenW(param_1);
        FUN_676b06a0();
        WideCharToMultiByte(0,0,param_1,-1,&stack0xffffffe8,iVar3 * 2 + 2,(LPCSTR)0x0,(LPBOOL)0x0);
      }
      DVar1 = GetShortPathNameA(lpszLongPath,lpszShortPath,param_3);
      iVar3 = lstrlenA(lpszShortPath);
      FUN_676b06a0();
      MultiByteToWideChar(0,0,lpszShortPath,-1,(LPWSTR)&stack0xffffffe8,iVar3 + 1);
      FUN_676ae1fc(param_2,(short *)&stack0xffffffe8);
      FUN_676b0bb3(lpszShortPath);
    }
  }
  return DVar1;
}



// Function: FUN_676afa4b at 676afa4b

undefined4 __cdecl FUN_676afa4b(undefined4 *param_1,undefined4 *param_2)

{
  int iVar1;
  
  *param_1 = *param_2;
  param_1[1] = param_2[1];
  param_1[2] = param_2[2];
  param_1[3] = param_2[3];
  param_1[4] = param_2[4];
  param_1[5] = param_2[5];
  param_1[6] = param_2[6];
  param_1[7] = param_2[7];
  param_1[8] = param_2[8];
  param_1[9] = param_2[9];
  param_1[10] = param_2[10];
  MultiByteToWideChar(0,1,(LPCSTR)(param_2 + 0xb),-1,(LPWSTR)(param_1 + 0xb),0x104);
  iVar1 = MultiByteToWideChar(0,1,(LPCSTR)(param_2 + 0x4c),-1,(LPWSTR)(param_1 + 0x8d),0xe);
  return CONCAT31((int3)((uint)iVar1 >> 8),1);
}



// Function: FUN_676afacf at 676afacf

undefined4 * __thiscall FUN_676afacf(void *this,undefined4 param_1)

{
  *(undefined4 *)((int)this + 4) = param_1;
  *(undefined ***)this = &PTR_FUN_676bb4bc;
  *(undefined4 *)((int)this + 8) = 0;
  *(undefined4 *)((int)this + 0xc) = 0;
  *(undefined4 *)((int)this + 0x10) = 0;
  FUN_676afb60((int)this);
  return (undefined4 *)this;
}



// Function: FUN_676afaf5 at 676afaf5

undefined4 * __thiscall FUN_676afaf5(void *this,byte param_1)

{
  FUN_676afb11((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    FUN_676b0bb3((undefined *)this);
  }
  return (undefined4 *)this;
}



// Function: FUN_676afb11 at 676afb11

void __fastcall FUN_676afb11(undefined4 *param_1)

{
  undefined4 *puVar1;
  
  *param_1 = &PTR_FUN_676bb4bc;
  if (param_1[4] == 1) {
    CoTaskMemFree((LPVOID)param_1[2]);
  }
  else if (param_1[4] == 2) {
    puVar1 = *(undefined4 **)((ushort *)param_1[1] + 4);
    if ((*(ushort *)param_1[1] & 0x4000) == 0x4000) {
      puVar1 = (undefined4 *)*puVar1;
    }
    Ordinal_24(puVar1);
  }
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  return;
}



// Function: FUN_676afb60 at 676afb60

uint __fastcall FUN_676afb60(int param_1)

{
  int *piVar1;
  ushort *puVar2;
  ushort *puVar3;
  uint uVar4;
  undefined4 *puVar5;
  int iVar6;
  ushort uVar7;
  undefined4 uVar8;
  bool bVar9;
  int local_10;
  int local_c;
  ushort *local_8;
  
  piVar1 = (int *)(param_1 + 8);
LAB_676afb6e:
  puVar3 = (ushort *)*piVar1;
  if (((ushort *)*piVar1 == (ushort *)0x0) &&
     (puVar3 = *(ushort **)(param_1 + 4), puVar3 != (ushort *)0x0)) {
    *(undefined4 *)(param_1 + 0xc) = 0;
    *(undefined4 *)(param_1 + 0x10) = 0;
    uVar7 = *puVar3;
    bVar9 = (uVar7 & 0x4000) != 0x4000;
    if ((bVar9) || (*(int *)(puVar3 + 4) != 0)) {
      if ((uVar7 & 0x2000) == 0) {
        uVar7 = uVar7 & 0xfff;
        if (uVar7 < 0x25) {
          if (uVar7 != 0x24) {
            switch(uVar7) {
            case 2:
            case 0xb:
            case 0x12:
              if (bVar9) {
                puVar3 = (ushort *)(*(int *)(param_1 + 4) + 8);
              }
              else {
                puVar3 = *(ushort **)(*(int *)(param_1 + 4) + 8);
              }
              *piVar1 = (int)puVar3;
              *(undefined4 *)(param_1 + 0xc) = 2;
              goto switchD_676afbd4_caseD_f;
            case 3:
            case 4:
            case 10:
            case 0x13:
            case 0x16:
            case 0x17:
              if (bVar9) {
                puVar3 = (ushort *)(*(int *)(param_1 + 4) + 8);
              }
              else {
                puVar3 = *(ushort **)(*(int *)(param_1 + 4) + 8);
              }
              *piVar1 = (int)puVar3;
              *(undefined4 *)(param_1 + 0xc) = 4;
              goto switchD_676afbd4_caseD_f;
            case 5:
            case 6:
            case 7:
            case 0x14:
            case 0x15:
              puVar3 = (ushort *)0x8;
              if (bVar9) {
                iVar6 = *(int *)(param_1 + 4) + 8;
              }
              else {
                iVar6 = *(int *)(*(int *)(param_1 + 4) + 8);
              }
              *piVar1 = iVar6;
              break;
            case 8:
              puVar5 = *(undefined4 **)(*(int *)(param_1 + 4) + 8);
              if (!bVar9) {
                puVar5 = (undefined4 *)*puVar5;
              }
              *piVar1 = (int)puVar5;
              puVar3 = (ushort *)Ordinal_149(puVar5);
              break;
            case 9:
            case 0xd:
            case 0x18:
            case 0x19:
            case 0x1a:
            case 0x1b:
            case 0x1c:
            case 0x1d:
            case 0x1e:
            case 0x1f:
              goto switchD_676afbd4_caseD_9;
            case 0xc:
              goto switchD_676afbd4_caseD_c;
            case 0xe:
              puVar3 = *(ushort **)(*(int *)(param_1 + 4) + 8);
              *(undefined4 *)(param_1 + 0xc) = 0x10;
              *piVar1 = (int)puVar3;
            default:
              goto switchD_676afbd4_caseD_f;
            case 0x10:
            case 0x11:
              if (bVar9) {
                puVar3 = (ushort *)(*(int *)(param_1 + 4) + 8);
              }
              else {
                puVar3 = *(ushort **)(*(int *)(param_1 + 4) + 8);
              }
              *piVar1 = (int)puVar3;
              *(undefined4 *)(param_1 + 0xc) = 1;
              goto switchD_676afbd4_caseD_f;
            }
            *(ushort **)(param_1 + 0xc) = puVar3;
            goto switchD_676afbd4_caseD_f;
          }
        }
        else if ((uVar7 < 0x40) || (0x49 < uVar7)) goto switchD_676afbd4_caseD_f;
      }
      else {
        if (bVar9) {
          uVar8 = *(undefined4 *)(*(int *)(param_1 + 4) + 8);
        }
        else {
          uVar8 = **(undefined4 **)(*(int *)(param_1 + 4) + 8);
        }
        local_8 = (ushort *)Ordinal_17(uVar8);
        puVar3 = local_8;
        if ((0 < (int)local_8) &&
           (puVar2 = (ushort *)Ordinal_18(uVar8), puVar3 = puVar2, 0 < (int)puVar2)) {
          *(undefined4 *)(param_1 + 0xc) = 0;
          goto LAB_676afc16;
        }
      }
    }
  }
  goto switchD_676afbd4_caseD_9;
switchD_676afbd4_caseD_c:
  *(undefined4 *)(param_1 + 4) = *(undefined4 *)(puVar3 + 4);
  goto LAB_676afb6e;
  while( true ) {
    local_10 = 0;
    puVar3 = (ushort *)Ordinal_20(uVar8,local_8,&local_10);
    if ((int)puVar3 < 0) goto switchD_676afbd4_caseD_9;
    *(int *)(param_1 + 0xc) = *(int *)(param_1 + 0xc) + ((local_c - local_10) + 1) * (int)puVar2;
    local_8 = (ushort *)((int)local_8 + -1);
    if (local_8 == (ushort *)0x0) break;
LAB_676afc16:
    local_c = 0;
    puVar3 = (ushort *)Ordinal_19(uVar8,local_8,&local_c);
    if ((int)puVar3 < 0) goto switchD_676afbd4_caseD_9;
  }
  puVar3 = (ushort *)Ordinal_23(uVar8,piVar1);
  if ((int)puVar3 < 0) {
    *piVar1 = 0;
switchD_676afbd4_caseD_9:
    uVar4 = (uint)puVar3 & 0xffffff00;
  }
  else {
    *(undefined4 *)(param_1 + 0x10) = 2;
switchD_676afbd4_caseD_f:
    uVar4 = CONCAT31((int3)((uint)puVar3 >> 8),1);
  }
  return uVar4;
}



// Function: FUN_676afdac at 676afdac

int __cdecl FUN_676afdac(int *param_1,byte *param_2)

{
  int iVar1;
  int iVar2;
  
  FUN_676afea4((uint)param_1);
  iVar1 = FUN_676b1460(param_1);
  iVar2 = FUN_676b1517(param_1,param_2,(undefined4 *)&stack0x0000000c);
  FUN_676b14ed(iVar1,param_1);
  FUN_676afef6((uint)param_1);
  return iVar2;
}



// Function: FUN_676afea4 at 676afea4

void __cdecl FUN_676afea4(uint param_1)

{
  if ((0x676c20f7 < param_1) && (param_1 < 0x676c2359)) {
    FUN_676b20a4(((int)(param_1 + 0x9893df08) >> 5) + 0x1c);
    return;
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x20));
  return;
}



// Function: FUN_676afed3 at 676afed3

void __cdecl FUN_676afed3(int param_1,int param_2)

{
  if (param_1 < 0x14) {
    FUN_676b20a4(param_1 + 0x1c);
    return;
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(param_2 + 0x20));
  return;
}



// Function: FUN_676afef6 at 676afef6

void __cdecl FUN_676afef6(uint param_1)

{
  if ((0x676c20f7 < param_1) && (param_1 < 0x676c2359)) {
    FUN_676b2105(((int)(param_1 + 0x9893df08) >> 5) + 0x1c);
    return;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x20));
  return;
}



// Function: FUN_676aff25 at 676aff25

void __cdecl FUN_676aff25(int param_1,int param_2)

{
  if (param_1 < 0x14) {
    FUN_676b2105(param_1 + 0x1c);
    return;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_2 + 0x20));
  return;
}



// Function: FUN_676aff48 at 676aff48

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_676aff48(void)

{
  void *extraout_ECX;
  
  FUN_676aff60();
  _DAT_676c5694 = FUN_676b216a();
  FUN_676b211a(extraout_ECX);
  return;
}



// Function: FUN_676aff60 at 676aff60

void FUN_676aff60(void)

{
  PTR___fptrap_676c26a8 = &LAB_676b21ed;
  PTR___fptrap_676c26a4 = __cfltcvt;
  PTR___fptrap_676c26ac = __fassign;
  PTR___fptrap_676c26b0 = FUN_676b2193;
  PTR___fptrap_676c26b4 = &LAB_676b223b;
  PTR___fptrap_676c26b8 = __cfltcvt;
  return;
}



// Function: FUN_676aff98 at 676aff98

void FUN_676aff98(void)

{
  if (PTR_FUN_676c2380 != (undefined *)0x0) {
    (*(code *)PTR_FUN_676c2380)();
  }
  FUN_676b00ad((undefined4 *)&DAT_676bf028,(undefined4 *)&DAT_676bf038);
  FUN_676b00ad((undefined4 *)&DAT_676bf000,(undefined4 *)&DAT_676bf024);
  return;
}



// Function: FUN_676affc5 at 676affc5

void __cdecl FUN_676affc5(UINT param_1)

{
  FUN_676afff6(param_1,0,0);
  return;
}



// Function: __exit at 676affd6

/* Library Function - Single Match
    __exit
   
   Library: Visual Studio 2003 Release */

void __cdecl __exit(int _Code)

{
  FUN_676afff6(_Code,1,0);
  return;
}



// Function: FUN_676affe7 at 676affe7

void FUN_676affe7(void)

{
  FUN_676afff6(0,0,1);
  return;
}



// Function: FUN_676afff6 at 676afff6

void __cdecl FUN_676afff6(UINT param_1,int param_2,int param_3)

{
  HANDLE hProcess;
  undefined4 *puVar1;
  UINT uExitCode;
  
  FUN_676b009b();
  if (DAT_676c56d8 == 1) {
    uExitCode = param_1;
    hProcess = GetCurrentProcess();
    TerminateProcess(hProcess,uExitCode);
  }
  DAT_676c56d4 = 1;
  DAT_676c56d0 = (undefined1)param_3;
  if (param_2 == 0) {
    if ((DAT_676c5d98 != (undefined4 *)0x0) &&
       (puVar1 = (undefined4 *)(DAT_676c5d94 - 4), DAT_676c5d98 <= puVar1)) {
      do {
        if ((code *)*puVar1 != (code *)0x0) {
          (*(code *)*puVar1)();
        }
        puVar1 = puVar1 + -1;
      } while (DAT_676c5d98 <= puVar1);
    }
    FUN_676b00ad((undefined4 *)&DAT_676bf03c,(undefined4 *)&DAT_676bf044);
  }
  FUN_676b00ad((undefined4 *)&DAT_676bf048,&DAT_676bf04c);
  if (param_3 == 0) {
    DAT_676c56d8 = 1;
                    /* WARNING: Subroutine does not return */
    ExitProcess(param_1);
  }
  FUN_676b00a4();
  return;
}



// Function: FUN_676b009b at 676b009b

void FUN_676b009b(void)

{
  FUN_676b20a4(0xd);
  return;
}



// Function: FUN_676b00a4 at 676b00a4

void FUN_676b00a4(void)

{
  FUN_676b2105(0xd);
  return;
}



// Function: FUN_676b00ad at 676b00ad

void __cdecl FUN_676b00ad(undefined4 *param_1,undefined4 *param_2)

{
  for (; param_1 < param_2; param_1 = param_1 + 1) {
    if ((code *)*param_1 != (code *)0x0) {
      (*(code *)*param_1)();
    }
  }
  return;
}



// Function: _malloc at 676b00c7

/* Library Function - Single Match
    _malloc
   
   Library: Visual Studio 2003 Release */

void * __cdecl _malloc(size_t _Size)

{
  void *pvVar1;
  
  pvVar1 = __nh_malloc(_Size,DAT_676c5758);
  return pvVar1;
}



// Function: __nh_malloc at 676b00d9

/* Library Function - Single Match
    __nh_malloc
   
   Library: Visual Studio 2003 Release */

void * __cdecl __nh_malloc(size_t _Size,int _NhFlag)

{
  void *pvVar1;
  int iVar2;
  
  if (_Size < 0xffffffe1) {
    do {
      pvVar1 = (void *)FUN_676b0105((uint *)_Size);
      if (pvVar1 != (void *)0x0) {
        return pvVar1;
      }
      if (_NhFlag == 0) {
        return (void *)0x0;
      }
      iVar2 = FUN_676b25b9(_Size);
    } while (iVar2 != 0);
  }
  return (void *)0x0;
}



// Function: FUN_676b0105 at 676b0105

void __cdecl FUN_676b0105(uint *param_1)

{
  int *piVar1;
  uint dwBytes;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_676bb670;
  puStack_10 = &LAB_676b3b5c;
  local_14 = ExceptionList;
  if (DAT_676c5c68 == 3) {
    ExceptionList = &local_14;
    if (param_1 <= DAT_676c5c60) {
      ExceptionList = &local_14;
      FUN_676b20a4(9);
      local_8 = 0;
      piVar1 = FUN_676b2bea(param_1);
      local_8 = 0xffffffff;
      FUN_676b016c();
      if (piVar1 != (int *)0x0) {
        ExceptionList = local_14;
        return;
      }
    }
  }
  else {
    ExceptionList = &local_14;
    if (DAT_676c5c68 == 2) {
      if (param_1 == (uint *)0x0) {
        dwBytes = 0x10;
      }
      else {
        dwBytes = (int)param_1 + 0xfU & 0xfffffff0;
      }
      ExceptionList = &local_14;
      if (dwBytes <= DAT_676c46e4) {
        ExceptionList = &local_14;
        FUN_676b20a4(9);
        local_8 = 1;
        piVar1 = FUN_676b368d(dwBytes >> 4);
        local_8 = 0xffffffff;
        FUN_676b01cb();
        if (piVar1 != (int *)0x0) {
          ExceptionList = local_14;
          return;
        }
      }
      goto LAB_676b01e4;
    }
  }
  if (param_1 == (uint *)0x0) {
    param_1 = (uint *)0x1;
  }
  dwBytes = (int)param_1 + 0xfU & 0xfffffff0;
LAB_676b01e4:
  HeapAlloc(DAT_676c5c64,0,dwBytes);
  ExceptionList = local_14;
  return;
}



// Function: FUN_676b016c at 676b016c

void FUN_676b016c(void)

{
  FUN_676b2105(9);
  return;
}



// Function: FUN_676b01cb at 676b01cb

void FUN_676b01cb(void)

{
  FUN_676b2105(9);
  return;
}



// Function: FUN_676b0201 at 676b0201

void __cdecl FUN_676b0201(undefined *param_1)

{
  uint *puVar1;
  int local_2c;
  uint *local_28;
  uint local_24;
  uint *local_20;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_676bb688;
  puStack_10 = &LAB_676b3b5c;
  local_14 = ExceptionList;
  if (param_1 == (undefined *)0x0) {
    return;
  }
  if (DAT_676c5c68 == 3) {
    ExceptionList = &local_14;
    FUN_676b20a4(9);
    local_8 = 0;
    local_20 = (uint *)FUN_676b2896((int)param_1);
    if (local_20 != (uint *)0x0) {
      FUN_676b28c1(local_20,(int)param_1);
    }
    local_8 = 0xffffffff;
    FUN_676b026b();
    puVar1 = local_20;
  }
  else {
    ExceptionList = &local_14;
    if (DAT_676c5c68 != 2) goto LAB_676b02cd;
    ExceptionList = &local_14;
    FUN_676b20a4(9);
    local_8 = 1;
    local_28 = (uint *)FUN_676b35f1(param_1,&local_2c,&local_24);
    if (local_28 != (uint *)0x0) {
      FUN_676b3648(local_2c,local_24,(byte *)local_28);
    }
    local_8 = 0xffffffff;
    FUN_676b02c3();
    puVar1 = local_28;
  }
  if (puVar1 != (uint *)0x0) {
    ExceptionList = local_14;
    return;
  }
LAB_676b02cd:
  HeapFree(DAT_676c5c64,0,param_1);
  ExceptionList = local_14;
  return;
}



// Function: FUN_676b026b at 676b026b

void FUN_676b026b(void)

{
  FUN_676b2105(9);
  return;
}



// Function: FUN_676b02c3 at 676b02c3

void FUN_676b02c3(void)

{
  FUN_676b2105(9);
  return;
}



// Function: FUN_676b02ea at 676b02ea

int __cdecl FUN_676b02ea(int *param_1)

{
  int iVar1;
  DWORD DVar2;
  
  iVar1 = FUN_676b0318(param_1);
  if (iVar1 != 0) {
    return -1;
  }
  if ((*(byte *)((int)param_1 + 0xd) & 0x40) != 0) {
    DVar2 = FUN_676b3f3c(param_1[4]);
    return -(uint)(DVar2 != 0);
  }
  return 0;
}



// Function: FUN_676b0318 at 676b0318

undefined4 __cdecl FUN_676b0318(int *param_1)

{
  uint uVar1;
  undefined4 uVar2;
  uint uVar3;
  
  uVar2 = 0;
  if ((((byte)param_1[3] & 3) == 2) && ((param_1[3] & 0x108U) != 0)) {
    uVar3 = *param_1 - param_1[2];
    if (0 < (int)uVar3) {
      uVar1 = FUN_676b3d4c(param_1[4],(char *)param_1[2],uVar3);
      if (uVar1 == uVar3) {
        if ((param_1[3] & 0x80U) != 0) {
          param_1[3] = param_1[3] & 0xfffffffd;
        }
      }
      else {
        param_1[3] = param_1[3] | 0x20;
        uVar2 = 0xffffffff;
      }
    }
  }
  param_1[1] = 0;
  *param_1 = param_1[2];
  return uVar2;
}



// Function: FUN_676b037d at 676b037d

int __cdecl FUN_676b037d(int param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar3 = 0;
  iVar5 = 0;
  FUN_676b20a4(2);
  iVar4 = 0;
  if (0 < DAT_676c6da0) {
    do {
      iVar2 = *(int *)(DAT_676c5d9c + iVar4 * 4);
      if ((iVar2 != 0) && ((*(byte *)(iVar2 + 0xc) & 0x83) != 0)) {
        FUN_676afed3(iVar4,iVar2);
        piVar1 = *(int **)(DAT_676c5d9c + iVar4 * 4);
        if ((piVar1[3] & 0x83U) != 0) {
          if (param_1 == 1) {
            iVar2 = FUN_676b02ea(piVar1);
            if (iVar2 != -1) {
              iVar3 = iVar3 + 1;
            }
          }
          else if ((param_1 == 0) && ((piVar1[3] & 2U) != 0)) {
            iVar2 = FUN_676b02ea(piVar1);
            if (iVar2 == -1) {
              iVar5 = -1;
            }
          }
        }
        FUN_676aff25(iVar4,*(int *)(DAT_676c5d9c + iVar4 * 4));
      }
      iVar4 = iVar4 + 1;
    } while (iVar4 < DAT_676c6da0);
  }
  FUN_676b2105(2);
  if (param_1 != 1) {
    iVar3 = iVar5;
  }
  return iVar3;
}



// Function: FUN_676b0421 at 676b0421

undefined4 __cdecl FUN_676b0421(int *param_1)

{
  undefined4 uVar1;
  
  uVar1 = 0xffffffff;
  if ((*(byte *)(param_1 + 3) & 0x40) == 0) {
    FUN_676afea4((uint)param_1);
    uVar1 = FUN_676b0452(param_1);
    FUN_676afef6((uint)param_1);
  }
  else {
    param_1[3] = 0;
  }
  return uVar1;
}



// Function: FUN_676b0452 at 676b0452

undefined4 __cdecl FUN_676b0452(int *param_1)

{
  int iVar1;
  undefined4 uVar2;
  
  uVar2 = 0xffffffff;
  if ((*(byte *)(param_1 + 3) & 0x83) != 0) {
    uVar2 = FUN_676b0318(param_1);
    FUN_676b40f3(param_1);
    iVar1 = FUN_676b4013(param_1[4]);
    if (iVar1 < 0) {
      uVar2 = 0xffffffff;
    }
    else if ((undefined *)param_1[7] != (undefined *)0x0) {
      FUN_676b0201((undefined *)param_1[7]);
      param_1[7] = 0;
    }
  }
  param_1[3] = 0;
  return uVar2;
}



// Function: FUN_676b0530 at 676b0530

uint * __cdecl FUN_676b0530(uint *param_1,uint *param_2)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  uint *puVar4;
  
  uVar3 = (uint)param_2 & 3;
  puVar4 = param_1;
  while (uVar3 != 0) {
    bVar1 = (byte)*param_2;
    uVar3 = (uint)bVar1;
    param_2 = (uint *)((int)param_2 + 1);
    if (bVar1 == 0) goto LAB_676b0618;
    *(byte *)puVar4 = bVar1;
    puVar4 = (uint *)((int)puVar4 + 1);
    uVar3 = (uint)param_2 & 3;
  }
  do {
    uVar2 = *param_2;
    uVar3 = *param_2;
    param_2 = param_2 + 1;
    if (((uVar2 ^ 0xffffffff ^ uVar2 + 0x7efefeff) & 0x81010100) != 0) {
      if ((char)uVar3 == '\0') {
LAB_676b0618:
        *(byte *)puVar4 = (byte)uVar3;
        return param_1;
      }
      if ((char)(uVar3 >> 8) == '\0') {
        *(short *)puVar4 = (short)uVar3;
        return param_1;
      }
      if ((uVar3 & 0xff0000) == 0) {
        *(short *)puVar4 = (short)uVar3;
        *(byte *)((int)puVar4 + 2) = 0;
        return param_1;
      }
      if ((uVar3 & 0xff000000) == 0) {
        *puVar4 = uVar3;
        return param_1;
      }
    }
    *puVar4 = uVar3;
    puVar4 = puVar4 + 1;
  } while( true );
}



// Function: FUN_676b0540 at 676b0540

uint * __cdecl FUN_676b0540(uint *param_1,uint *param_2)

{
  byte bVar1;
  uint uVar2;
  uint *puVar3;
  uint uVar4;
  uint *puVar5;
  
  uVar4 = (uint)param_1 & 3;
  puVar3 = param_1;
  while (uVar4 != 0) {
    uVar4 = *puVar3;
    puVar3 = (uint *)((int)puVar3 + 1);
    if ((byte)uVar4 == 0) goto LAB_676b058f;
    uVar4 = (uint)puVar3 & 3;
  }
  do {
    do {
      puVar5 = puVar3;
      puVar3 = puVar5 + 1;
    } while (((*puVar5 ^ 0xffffffff ^ *puVar5 + 0x7efefeff) & 0x81010100) == 0);
    uVar4 = *puVar5;
    if ((char)uVar4 == '\0') goto LAB_676b05a1;
    if ((char)(uVar4 >> 8) == '\0') {
      puVar5 = (uint *)((int)puVar5 + 1);
      goto LAB_676b05a1;
    }
    if ((uVar4 & 0xff0000) == 0) {
      puVar5 = (uint *)((int)puVar5 + 2);
      goto LAB_676b05a1;
    }
  } while ((uVar4 & 0xff000000) != 0);
LAB_676b058f:
  puVar5 = (uint *)((int)puVar3 + -1);
LAB_676b05a1:
  uVar4 = (uint)param_2 & 3;
  while (uVar4 != 0) {
    bVar1 = (byte)*param_2;
    uVar4 = (uint)bVar1;
    param_2 = (uint *)((int)param_2 + 1);
    if (bVar1 == 0) goto LAB_676b0618;
    *(byte *)puVar5 = bVar1;
    puVar5 = (uint *)((int)puVar5 + 1);
    uVar4 = (uint)param_2 & 3;
  }
  do {
    uVar2 = *param_2;
    uVar4 = *param_2;
    param_2 = param_2 + 1;
    if (((uVar2 ^ 0xffffffff ^ uVar2 + 0x7efefeff) & 0x81010100) != 0) {
      if ((char)uVar4 == '\0') {
LAB_676b0618:
        *(byte *)puVar5 = (byte)uVar4;
        return param_1;
      }
      if ((char)(uVar4 >> 8) == '\0') {
        *(short *)puVar5 = (short)uVar4;
        return param_1;
      }
      if ((uVar4 & 0xff0000) == 0) {
        *(short *)puVar5 = (short)uVar4;
        *(byte *)((int)puVar5 + 2) = 0;
        return param_1;
      }
      if ((uVar4 & 0xff000000) == 0) {
        *puVar5 = uVar4;
        return param_1;
      }
    }
    *puVar5 = uVar4;
    puVar5 = puVar5 + 1;
  } while( true );
}



// Function: FUN_676b0620 at 676b0620

uint __thiscall FUN_676b0620(void *this,int param_1,uint param_2)

{
  BOOL BVar1;
  int iVar2;
  undefined4 local_8;
  
  if (param_1 + 1U < 0x101) {
    param_1._2_2_ = *(ushort *)(PTR_DAT_676c2390 + param_1 * 2);
  }
  else {
    if ((PTR_DAT_676c2390[(param_1 >> 8 & 0xffU) * 2 + 1] & 0x80) == 0) {
      local_8 = CONCAT31((int3)((uint)this >> 8),(char)param_1) & 0xffff00ff;
      iVar2 = 1;
    }
    else {
      local_8._0_2_ = CONCAT11((char)param_1,(char)((uint)param_1 >> 8));
      local_8 = CONCAT22((short)((uint)this >> 0x10),(undefined2)local_8) & 0xff00ffff;
      iVar2 = 2;
    }
    BVar1 = FUN_676b411e(1,(LPCSTR)&local_8,iVar2,(LPWORD)((int)&param_1 + 2),0,0,1);
    if (BVar1 == 0) {
      return 0;
    }
  }
  return param_1._2_2_ & param_2;
}



// Function: FUN_676b06a0 at 676b06a0

/* WARNING: Unable to track spacebase fully for stack */

void FUN_676b06a0(void)

{
  uint in_EAX;
  undefined1 *puVar1;
  undefined4 unaff_retaddr;
  
  puVar1 = &stack0x00000004;
  if (0xfff < in_EAX) {
    do {
      puVar1 = puVar1 + -0x1000;
      in_EAX = in_EAX - 0x1000;
    } while (0xfff < in_EAX);
  }
  *(undefined4 *)(puVar1 + (-4 - in_EAX)) = unaff_retaddr;
  return;
}



// Function: FUN_676b06d0 at 676b06d0

undefined4 * __cdecl FUN_676b06d0(undefined4 *param_1,undefined4 *param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  
  if ((param_2 < param_1) && (param_1 < (undefined4 *)(param_3 + (int)param_2))) {
    puVar3 = (undefined4 *)((param_3 - 4) + (int)param_2);
    puVar4 = (undefined4 *)((param_3 - 4) + (int)param_1);
    if (((uint)puVar4 & 3) == 0) {
      uVar1 = param_3 >> 2;
      uVar2 = param_3 & 3;
      if (7 < uVar1) {
        for (; uVar1 != 0; uVar1 = uVar1 - 1) {
          *puVar4 = *puVar3;
          puVar3 = puVar3 + -1;
          puVar4 = puVar4 + -1;
        }
        switch(uVar2) {
        case 0:
          return param_1;
        case 2:
          goto switchD_676b0887_caseD_2;
        case 3:
          goto switchD_676b0887_caseD_3;
        }
        goto switchD_676b0887_caseD_1;
      }
    }
    else {
      switch(param_3) {
      case 0:
        goto switchD_676b0887_caseD_0;
      case 1:
        goto switchD_676b0887_caseD_1;
      case 2:
        goto switchD_676b0887_caseD_2;
      case 3:
        goto switchD_676b0887_caseD_3;
      default:
        uVar1 = param_3 - ((uint)puVar4 & 3);
        switch((uint)puVar4 & 3) {
        case 1:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          puVar3 = (undefined4 *)((int)puVar3 + -1);
          uVar1 = uVar1 >> 2;
          puVar4 = (undefined4 *)((int)puVar4 - 1);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return param_1;
            case 2:
              goto switchD_676b0887_caseD_2;
            case 3:
              goto switchD_676b0887_caseD_3;
            }
            goto switchD_676b0887_caseD_1;
          }
          break;
        case 2:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          puVar3 = (undefined4 *)((int)puVar3 + -2);
          puVar4 = (undefined4 *)((int)puVar4 - 2);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return param_1;
            case 2:
              goto switchD_676b0887_caseD_2;
            case 3:
              goto switchD_676b0887_caseD_3;
            }
            goto switchD_676b0887_caseD_1;
          }
          break;
        case 3:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
          puVar3 = (undefined4 *)((int)puVar3 + -3);
          puVar4 = (undefined4 *)((int)puVar4 - 3);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return param_1;
            case 2:
              goto switchD_676b0887_caseD_2;
            case 3:
              goto switchD_676b0887_caseD_3;
            }
            goto switchD_676b0887_caseD_1;
          }
        }
      }
    }
    switch(uVar1) {
    case 7:
      puVar4[7 - uVar1] = puVar3[7 - uVar1];
    case 6:
      puVar4[6 - uVar1] = puVar3[6 - uVar1];
    case 5:
      puVar4[5 - uVar1] = puVar3[5 - uVar1];
    case 4:
      puVar4[4 - uVar1] = puVar3[4 - uVar1];
    case 3:
      puVar4[3 - uVar1] = puVar3[3 - uVar1];
    case 2:
      puVar4[2 - uVar1] = puVar3[2 - uVar1];
    case 1:
      puVar4[1 - uVar1] = puVar3[1 - uVar1];
      puVar3 = puVar3 + -uVar1;
      puVar4 = puVar4 + -uVar1;
    }
    switch(uVar2) {
    case 1:
switchD_676b0887_caseD_1:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      return param_1;
    case 2:
switchD_676b0887_caseD_2:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      return param_1;
    case 3:
switchD_676b0887_caseD_3:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
      return param_1;
    }
switchD_676b0887_caseD_0:
    return param_1;
  }
  puVar3 = param_1;
  if (((uint)param_1 & 3) == 0) {
    uVar1 = param_3 >> 2;
    uVar2 = param_3 & 3;
    if (7 < uVar1) {
      for (; uVar1 != 0; uVar1 = uVar1 - 1) {
        *puVar3 = *param_2;
        param_2 = param_2 + 1;
        puVar3 = puVar3 + 1;
      }
      switch(uVar2) {
      case 0:
        return param_1;
      case 2:
        goto switchD_676b0705_caseD_2;
      case 3:
        goto switchD_676b0705_caseD_3;
      }
      goto switchD_676b0705_caseD_1;
    }
  }
  else {
    switch(param_3) {
    case 0:
      goto switchD_676b0705_caseD_0;
    case 1:
      goto switchD_676b0705_caseD_1;
    case 2:
      goto switchD_676b0705_caseD_2;
    case 3:
      goto switchD_676b0705_caseD_3;
    default:
      uVar1 = (param_3 - 4) + ((uint)param_1 & 3);
      switch((uint)param_1 & 3) {
      case 1:
        uVar2 = uVar1 & 3;
        *(undefined1 *)param_1 = *(undefined1 *)param_2;
        *(undefined1 *)((int)param_1 + 1) = *(undefined1 *)((int)param_2 + 1);
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)param_1 + 2) = *(undefined1 *)((int)param_2 + 2);
        param_2 = (undefined4 *)((int)param_2 + 3);
        puVar3 = (undefined4 *)((int)param_1 + 3);
        if (7 < uVar1) {
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *param_2;
            param_2 = param_2 + 1;
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return param_1;
          case 2:
            goto switchD_676b0705_caseD_2;
          case 3:
            goto switchD_676b0705_caseD_3;
          }
          goto switchD_676b0705_caseD_1;
        }
        break;
      case 2:
        uVar2 = uVar1 & 3;
        *(undefined1 *)param_1 = *(undefined1 *)param_2;
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)param_1 + 1) = *(undefined1 *)((int)param_2 + 1);
        param_2 = (undefined4 *)((int)param_2 + 2);
        puVar3 = (undefined4 *)((int)param_1 + 2);
        if (7 < uVar1) {
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *param_2;
            param_2 = param_2 + 1;
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return param_1;
          case 2:
            goto switchD_676b0705_caseD_2;
          case 3:
            goto switchD_676b0705_caseD_3;
          }
          goto switchD_676b0705_caseD_1;
        }
        break;
      case 3:
        uVar2 = uVar1 & 3;
        *(undefined1 *)param_1 = *(undefined1 *)param_2;
        param_2 = (undefined4 *)((int)param_2 + 1);
        uVar1 = uVar1 >> 2;
        puVar3 = (undefined4 *)((int)param_1 + 1);
        if (7 < uVar1) {
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *param_2;
            param_2 = param_2 + 1;
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return param_1;
          case 2:
            goto switchD_676b0705_caseD_2;
          case 3:
            goto switchD_676b0705_caseD_3;
          }
          goto switchD_676b0705_caseD_1;
        }
      }
    }
  }
  switch(uVar1) {
  case 7:
    puVar3[uVar1 - 7] = param_2[uVar1 - 7];
  case 6:
    puVar3[uVar1 - 6] = param_2[uVar1 - 6];
  case 5:
    puVar3[uVar1 - 5] = param_2[uVar1 - 5];
  case 4:
    puVar3[uVar1 - 4] = param_2[uVar1 - 4];
  case 3:
    puVar3[uVar1 - 3] = param_2[uVar1 - 3];
  case 2:
    puVar3[uVar1 - 2] = param_2[uVar1 - 2];
  case 1:
    puVar3[uVar1 - 1] = param_2[uVar1 - 1];
    param_2 = param_2 + uVar1;
    puVar3 = puVar3 + uVar1;
  }
  switch(uVar2) {
  case 1:
switchD_676b0705_caseD_1:
    *(undefined1 *)puVar3 = *(undefined1 *)param_2;
    return param_1;
  case 2:
switchD_676b0705_caseD_2:
    *(undefined1 *)puVar3 = *(undefined1 *)param_2;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)param_2 + 1);
    return param_1;
  case 3:
switchD_676b0705_caseD_3:
    *(undefined1 *)puVar3 = *(undefined1 *)param_2;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)param_2 + 1);
    *(undefined1 *)((int)puVar3 + 2) = *(undefined1 *)((int)param_2 + 2);
    return param_1;
  }
switchD_676b0705_caseD_0:
  return param_1;
}



// Function: _memset at 676b0a10

/* Library Function - Single Match
    _memset
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

void * __cdecl _memset(void *_Dst,int _Val,size_t _Size)

{
  uint uVar1;
  uint uVar2;
  size_t sVar3;
  uint *puVar4;
  
  if (_Size == 0) {
    return _Dst;
  }
  uVar1 = _Val & 0xff;
  puVar4 = (uint *)_Dst;
  if (3 < _Size) {
    uVar2 = -(int)_Dst & 3;
    sVar3 = _Size;
    if (uVar2 != 0) {
      sVar3 = _Size - uVar2;
      do {
        *(undefined1 *)puVar4 = (undefined1)_Val;
        puVar4 = (uint *)((int)puVar4 + 1);
        uVar2 = uVar2 - 1;
      } while (uVar2 != 0);
    }
    uVar1 = uVar1 * 0x1010101;
    _Size = sVar3 & 3;
    uVar2 = sVar3 >> 2;
    if (uVar2 != 0) {
      for (; uVar2 != 0; uVar2 = uVar2 - 1) {
        *puVar4 = uVar1;
        puVar4 = puVar4 + 1;
      }
      if (_Size == 0) {
        return _Dst;
      }
    }
  }
  do {
    *(char *)puVar4 = (char)uVar1;
    puVar4 = (uint *)((int)puVar4 + 1);
    _Size = _Size - 1;
  } while (_Size != 0);
  return _Dst;
}



// Function: FUN_676b0a68 at 676b0a68

int * __cdecl FUN_676b0a68(int param_1,int param_2)

{
  int iVar1;
  uint *puVar2;
  uint *puVar3;
  uint *_Size;
  int *local_24;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_676bb6a0;
  puStack_10 = &LAB_676b3b5c;
  local_14 = ExceptionList;
  puVar2 = (uint *)(param_1 * param_2);
  puVar3 = puVar2;
  ExceptionList = &local_14;
  if (puVar2 < (uint *)0xffffffe1) {
    if (puVar2 == (uint *)0x0) {
      puVar3 = (uint *)0x1;
    }
    puVar3 = (uint *)((int)puVar3 + 0xfU & 0xfffffff0);
    ExceptionList = &local_14;
  }
  do {
    local_24 = (int *)0x0;
    if (puVar3 < (uint *)0xffffffe1) {
      if (DAT_676c5c68 == 3) {
        if (puVar2 <= DAT_676c5c60) {
          FUN_676b20a4(9);
          local_8 = 0;
          local_24 = FUN_676b2bea(puVar2);
          local_8 = 0xffffffff;
          FUN_676b0b01();
          _Size = puVar2;
          if (local_24 == (int *)0x0) goto LAB_676b0b55;
LAB_676b0b44:
          _memset(local_24,0,(size_t)_Size);
        }
LAB_676b0b50:
        if (local_24 != (int *)0x0) {
          ExceptionList = local_14;
          return local_24;
        }
      }
      else {
        if ((DAT_676c5c68 != 2) || (DAT_676c46e4 < puVar3)) goto LAB_676b0b50;
        FUN_676b20a4(9);
        local_8 = 1;
        local_24 = FUN_676b368d((uint)puVar3 >> 4);
        local_8 = 0xffffffff;
        FUN_676b0b8a();
        _Size = puVar3;
        if (local_24 != (int *)0x0) goto LAB_676b0b44;
      }
LAB_676b0b55:
      local_24 = (int *)HeapAlloc(DAT_676c5c64,8,(SIZE_T)puVar3);
    }
    if (local_24 != (int *)0x0) {
      ExceptionList = local_14;
      return local_24;
    }
    if (DAT_676c5758 == 0) {
      ExceptionList = local_14;
      return (int *)0x0;
    }
    iVar1 = FUN_676b25b9(puVar3);
    if (iVar1 == 0) {
      ExceptionList = local_14;
      return (int *)0x0;
    }
  } while( true );
}



// Function: FUN_676b0b01 at 676b0b01

void FUN_676b0b01(void)

{
  FUN_676b2105(9);
  return;
}



// Function: FUN_676b0b8a at 676b0b8a

void FUN_676b0b8a(void)

{
  FUN_676b2105(9);
  return;
}



// Function: operator_new at 676b0ba5

/* Library Function - Single Match
    void * __cdecl operator new(unsigned int)
   
   Library: Visual Studio 2003 Release */

void * __cdecl operator_new(uint param_1)

{
  void *pvVar1;
  
  pvVar1 = __nh_malloc(param_1,1);
  return pvVar1;
}



// Function: FUN_676b0bb3 at 676b0bb3

void __cdecl FUN_676b0bb3(undefined *param_1)

{
  FUN_676b0201(param_1);
  return;
}



// Function: FUN_676b0bc7 at 676b0bc7

undefined4 __cdecl FUN_676b0bc7(undefined4 param_1)

{
  byte *pbVar1;
  SIZE_T SVar2;
  
  FUN_676b009b();
  pbVar1 = (byte *)FUN_676b4267(DAT_676c5d98);
  if (pbVar1 < DAT_676c5d94 + (4 - (int)DAT_676c5d98)) {
    SVar2 = FUN_676b4267(DAT_676c5d98);
    pbVar1 = FUN_676b0e9c(DAT_676c5d98,(uint *)(SVar2 + 0x10));
    if (pbVar1 == (byte *)0x0) {
      param_1 = 0;
      goto LAB_676b0c3c;
    }
    DAT_676c5d94 = pbVar1 + ((int)DAT_676c5d94 - (int)DAT_676c5d98 >> 2) * 4;
    DAT_676c5d98 = pbVar1;
  }
  *(undefined4 *)DAT_676c5d94 = param_1;
  DAT_676c5d94 = DAT_676c5d94 + 4;
LAB_676b0c3c:
  FUN_676b00a4();
  return param_1;
}



// Function: FUN_676b0c45 at 676b0c45

int __cdecl FUN_676b0c45(undefined4 param_1)

{
  int iVar1;
  
  iVar1 = FUN_676b0bc7(param_1);
  return (iVar1 != 0) - 1;
}



// Function: __allmul at 676b0c90

/* Library Function - Single Match
    __allmul
   
   Library: Visual Studio */

longlong __allmul(uint param_1,int param_2,uint param_3,int param_4)

{
  if (param_4 == 0 && param_2 == 0) {
    return (ulonglong)param_1 * (ulonglong)param_3;
  }
  return CONCAT44((int)((ulonglong)param_1 * (ulonglong)param_3 >> 0x20) +
                  param_2 * param_3 + param_1 * param_4,
                  (int)((ulonglong)param_1 * (ulonglong)param_3));
}



// Function: __alldiv at 676b0cd0

/* Library Function - Single Match
    __alldiv
   
   Library: Visual Studio */

undefined8 __alldiv(uint param_1,uint param_2,uint param_3,uint param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  bool bVar10;
  char cVar11;
  uint uVar9;
  
  cVar11 = (int)param_2 < 0;
  if ((bool)cVar11) {
    bVar10 = param_1 != 0;
    param_1 = -param_1;
    param_2 = -(uint)bVar10 - param_2;
  }
  if ((int)param_4 < 0) {
    cVar11 = cVar11 + '\x01';
    bVar10 = param_3 != 0;
    param_3 = -param_3;
    param_4 = -(uint)bVar10 - param_4;
  }
  uVar3 = param_1;
  uVar5 = param_3;
  uVar6 = param_2;
  uVar9 = param_4;
  if (param_4 == 0) {
    uVar3 = param_2 / param_3;
    iVar4 = (int)(((ulonglong)param_2 % (ulonglong)param_3 << 0x20 | (ulonglong)param_1) /
                 (ulonglong)param_3);
  }
  else {
    do {
      uVar8 = uVar9 >> 1;
      uVar5 = uVar5 >> 1 | (uint)((uVar9 & 1) != 0) << 0x1f;
      uVar7 = uVar6 >> 1;
      uVar3 = uVar3 >> 1 | (uint)((uVar6 & 1) != 0) << 0x1f;
      uVar6 = uVar7;
      uVar9 = uVar8;
    } while (uVar8 != 0);
    uVar1 = CONCAT44(uVar7,uVar3) / (ulonglong)uVar5;
    iVar4 = (int)uVar1;
    lVar2 = (ulonglong)param_3 * (uVar1 & 0xffffffff);
    uVar3 = (uint)((ulonglong)lVar2 >> 0x20);
    uVar5 = uVar3 + iVar4 * param_4;
    if (((CARRY4(uVar3,iVar4 * param_4)) || (param_2 < uVar5)) ||
       ((param_2 <= uVar5 && (param_1 < (uint)lVar2)))) {
      iVar4 = iVar4 + -1;
    }
    uVar3 = 0;
  }
  if (cVar11 == '\x01') {
    bVar10 = iVar4 != 0;
    iVar4 = -iVar4;
    uVar3 = -(uint)bVar10 - uVar3;
  }
  return CONCAT44(uVar3,iVar4);
}



// Function: __aulldiv at 676b0d80

/* Library Function - Single Match
    __aulldiv
   
   Library: Visual Studio */

undefined8 __aulldiv(uint param_1,uint param_2,uint param_3,uint param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  
  uVar3 = param_1;
  uVar8 = param_4;
  uVar6 = param_2;
  uVar9 = param_3;
  if (param_4 == 0) {
    uVar3 = param_2 / param_3;
    iVar4 = (int)(((ulonglong)param_2 % (ulonglong)param_3 << 0x20 | (ulonglong)param_1) /
                 (ulonglong)param_3);
  }
  else {
    do {
      uVar5 = uVar8 >> 1;
      uVar9 = uVar9 >> 1 | (uint)((uVar8 & 1) != 0) << 0x1f;
      uVar7 = uVar6 >> 1;
      uVar3 = uVar3 >> 1 | (uint)((uVar6 & 1) != 0) << 0x1f;
      uVar8 = uVar5;
      uVar6 = uVar7;
    } while (uVar5 != 0);
    uVar1 = CONCAT44(uVar7,uVar3) / (ulonglong)uVar9;
    iVar4 = (int)uVar1;
    lVar2 = (ulonglong)param_3 * (uVar1 & 0xffffffff);
    uVar3 = (uint)((ulonglong)lVar2 >> 0x20);
    uVar8 = uVar3 + iVar4 * param_4;
    if (((CARRY4(uVar3,iVar4 * param_4)) || (param_2 < uVar8)) ||
       ((param_2 <= uVar8 && (param_1 < (uint)lVar2)))) {
      iVar4 = iVar4 + -1;
    }
    uVar3 = 0;
  }
  return CONCAT44(uVar3,iVar4);
}



// Function: _memcmp at 676b0df0

/* Library Function - Single Match
    _memcmp
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

int __cdecl _memcmp(void *_Buf1,void *_Buf2,size_t _Size)

{
  uint uVar1;
  size_t sVar2;
  int iVar3;
  byte bVar4;
  uint uVar5;
  byte bVar6;
  uint *puVar7;
  uint *puVar8;
  bool bVar9;
  
  sVar2 = _Size;
  if (_Size != 0) {
    if ((((uint)_Buf1 | (uint)_Buf2) & 3) == 0) {
      sVar2 = _Size & 3;
      uVar5 = _Size >> 2;
      bVar9 = uVar5 == 0;
      puVar7 = (uint *)_Buf1;
      puVar8 = (uint *)_Buf2;
      if (!bVar9) {
        do {
          _Buf1 = puVar7;
          _Buf2 = puVar8;
          if (uVar5 == 0) break;
          uVar5 = uVar5 - 1;
          _Buf2 = puVar8 + 1;
          _Buf1 = puVar7 + 1;
          bVar9 = *puVar7 == *puVar8;
          puVar7 = (uint *)_Buf1;
          puVar8 = (uint *)_Buf2;
        } while (bVar9);
        if (!bVar9) {
          uVar5 = *(uint *)((int)_Buf1 + -4);
          uVar1 = *(uint *)((int)_Buf2 + -4);
          bVar9 = (byte)uVar5 < (byte)uVar1;
          if ((((byte)uVar5 == (byte)uVar1) &&
              (bVar4 = (byte)(uVar5 >> 8), bVar6 = (byte)(uVar1 >> 8), bVar9 = bVar4 < bVar6,
              bVar4 == bVar6)) &&
             (bVar4 = (byte)(uVar5 >> 0x10), bVar6 = (byte)(uVar1 >> 0x10), bVar9 = bVar4 < bVar6,
             bVar4 == bVar6)) {
            bVar9 = (byte)(uVar5 >> 0x18) < (byte)(uVar1 >> 0x18);
          }
          goto LAB_676b0e6a;
        }
      }
      if (sVar2 != 0) {
                    /* WARNING: Load size is inaccurate */
        uVar5 = *_Buf1;
                    /* WARNING: Load size is inaccurate */
        uVar1 = *_Buf2;
        bVar9 = (byte)uVar5 < (byte)uVar1;
        if ((byte)uVar5 != (byte)uVar1) {
LAB_676b0e6a:
          return (1 - (uint)bVar9) - (uint)(bVar9 != 0);
        }
        iVar3 = sVar2 - 1;
        if (iVar3 != 0) {
          bVar6 = (byte)(uVar5 >> 8);
          bVar4 = (byte)(uVar1 >> 8);
          bVar9 = bVar6 < bVar4;
          if (bVar6 != bVar4) goto LAB_676b0e6a;
          iVar3 = sVar2 - 2;
          if (iVar3 != 0) {
            bVar9 = (uVar5 & 0xff0000) < (uVar1 & 0xff0000);
            if ((uVar5 & 0xff0000) != (uVar1 & 0xff0000)) goto LAB_676b0e6a;
            iVar3 = sVar2 - 3;
          }
        }
        return iVar3;
      }
    }
    else {
      if ((_Size & 1) == 0) goto LAB_676b0e1d;
                    /* WARNING: Load size is inaccurate */
                    /* WARNING: Load size is inaccurate */
      bVar9 = *_Buf1 < *_Buf2;
      if (*_Buf1 != *_Buf2) goto LAB_676b0e6a;
      _Buf1 = (void *)((int)_Buf1 + 1);
      _Buf2 = (void *)((int)_Buf2 + 1);
      for (_Size = _Size - 1; sVar2 = _Size, _Size != 0; _Size = _Size - 2) {
LAB_676b0e1d:
                    /* WARNING: Load size is inaccurate */
                    /* WARNING: Load size is inaccurate */
        bVar9 = *_Buf1 < *_Buf2;
        if ((*_Buf1 != *_Buf2) ||
           (bVar9 = *(byte *)((int)_Buf1 + 1) < *(byte *)((int)_Buf2 + 1),
           *(byte *)((int)_Buf1 + 1) != *(byte *)((int)_Buf2 + 1))) goto LAB_676b0e6a;
        _Buf2 = (void *)((int)_Buf2 + 2);
        _Buf1 = (void *)((int)_Buf1 + 2);
      }
    }
  }
  return sVar2;
}



// Function: FUN_676b0e9c at 676b0e9c

byte * __cdecl FUN_676b0e9c(byte *param_1,uint *param_2)

{
  int iVar1;
  uint *puVar2;
  byte *pbVar3;
  int local_3c;
  uint *local_38;
  byte *local_34;
  int *local_30;
  uint *local_2c;
  byte *local_28;
  uint *local_24;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_676bb6b8;
  puStack_10 = &LAB_676b3b5c;
  local_14 = ExceptionList;
  pbVar3 = (byte *)0x0;
  if (param_1 == (byte *)0x0) {
    ExceptionList = &local_14;
    pbVar3 = (byte *)_malloc((size_t)param_2);
  }
  else {
    if (param_2 == (uint *)0x0) {
      ExceptionList = &local_14;
      FUN_676b0201(param_1);
    }
    else {
      ExceptionList = &local_14;
      if (DAT_676c5c68 == 3) {
        do {
          local_28 = (byte *)0x0;
          if (param_2 < (uint *)0xffffffe1) {
            FUN_676b20a4(9);
            local_8 = 0;
            local_2c = (uint *)FUN_676b2896((int)param_1);
            if (local_2c != (uint *)0x0) {
              if (param_2 <= DAT_676c5c60) {
                iVar1 = FUN_676b309f(local_2c,(int)param_1,(int)param_2);
                if (iVar1 == 0) {
                  local_28 = (byte *)FUN_676b2bea(param_2);
                  if (local_28 != (byte *)0x0) {
                    local_24 = (uint *)(*(int *)(param_1 + -4) - 1);
                    puVar2 = local_24;
                    if (param_2 <= local_24) {
                      puVar2 = param_2;
                    }
                    FUN_676b06d0((undefined4 *)local_28,(undefined4 *)param_1,(uint)puVar2);
                    local_2c = (uint *)FUN_676b2896((int)param_1);
                    FUN_676b28c1(local_2c,(int)param_1);
                  }
                }
                else {
                  local_28 = param_1;
                }
              }
              if (local_28 == (byte *)0x0) {
                if (param_2 == (uint *)0x0) {
                  param_2 = (uint *)0x1;
                }
                param_2 = (uint *)((int)param_2 + 0xfU & 0xfffffff0);
                local_28 = (byte *)HeapAlloc(DAT_676c5c64,0,(SIZE_T)param_2);
                if (local_28 != (byte *)0x0) {
                  local_24 = (uint *)(*(int *)(param_1 + -4) - 1);
                  puVar2 = local_24;
                  if (param_2 <= local_24) {
                    puVar2 = param_2;
                  }
                  FUN_676b06d0((undefined4 *)local_28,(undefined4 *)param_1,(uint)puVar2);
                  FUN_676b28c1(local_2c,(int)param_1);
                }
              }
            }
            local_8 = 0xffffffff;
            FUN_676b1027();
            if (local_2c == (uint *)0x0) {
              if (param_2 == (uint *)0x0) {
                param_2 = (uint *)0x1;
              }
              param_2 = (uint *)((int)param_2 + 0xfU & 0xfffffff0);
              local_28 = (byte *)HeapReAlloc(DAT_676c5c64,0,param_1,(SIZE_T)param_2);
            }
          }
          if (local_28 != (byte *)0x0) {
            ExceptionList = local_14;
            return local_28;
          }
          if (DAT_676c5758 == (byte *)0x0) {
            ExceptionList = local_14;
            return (byte *)0x0;
          }
          iVar1 = FUN_676b25b9(param_2);
        } while (iVar1 != 0);
      }
      else {
        ExceptionList = &local_14;
        if (DAT_676c5c68 == 2) {
          ExceptionList = &local_14;
          if (param_2 < (uint *)0xffffffe1) {
            if (param_2 == (uint *)0x0) {
              param_2 = (uint *)0x10;
              ExceptionList = &local_14;
            }
            else {
              param_2 = (uint *)((int)param_2 + 0xfU & 0xfffffff0);
              ExceptionList = &local_14;
            }
          }
          do {
            local_28 = pbVar3;
            if (param_2 < (uint *)0xffffffe1) {
              FUN_676b20a4(9);
              local_8 = 1;
              pbVar3 = (byte *)FUN_676b35f1(param_1,&local_3c,(uint *)&local_30);
              local_34 = pbVar3;
              if (pbVar3 == (byte *)0x0) {
                local_28 = (byte *)HeapReAlloc(DAT_676c5c64,0,param_1,(SIZE_T)param_2);
              }
              else {
                if (param_2 < DAT_676c46e4) {
                  iVar1 = FUN_676b39b9(local_3c,local_30,pbVar3,(uint)param_2 >> 4);
                  if (iVar1 == 0) {
                    local_28 = (byte *)FUN_676b368d((uint)param_2 >> 4);
                    if (local_28 != (byte *)0x0) {
                      local_38 = (uint *)((uint)*pbVar3 << 4);
                      puVar2 = local_38;
                      if (param_2 <= local_38) {
                        puVar2 = param_2;
                      }
                      FUN_676b06d0((undefined4 *)local_28,(undefined4 *)param_1,(uint)puVar2);
                      FUN_676b3648(local_3c,(int)local_30,pbVar3);
                    }
                  }
                  else {
                    local_28 = param_1;
                  }
                }
                if ((local_28 == (byte *)0x0) &&
                   (local_28 = (byte *)HeapAlloc(DAT_676c5c64,0,(SIZE_T)param_2),
                   local_28 != (byte *)0x0)) {
                  local_38 = (uint *)((uint)*pbVar3 << 4);
                  puVar2 = local_38;
                  if (param_2 <= local_38) {
                    puVar2 = param_2;
                  }
                  FUN_676b06d0((undefined4 *)local_28,(undefined4 *)param_1,(uint)puVar2);
                  FUN_676b3648(local_3c,(int)local_30,pbVar3);
                }
              }
              local_8 = 0xffffffff;
              FUN_676b1175();
            }
            if (local_28 != pbVar3) {
              ExceptionList = local_14;
              return local_28;
            }
            if (DAT_676c5758 == pbVar3) {
              ExceptionList = local_14;
              return local_28;
            }
            iVar1 = FUN_676b25b9(param_2);
          } while (iVar1 != 0);
        }
        else {
          do {
            pbVar3 = (byte *)0x0;
            if (param_2 < (uint *)0xffffffe1) {
              if (param_2 == (uint *)0x0) {
                param_2 = (uint *)0x1;
              }
              param_2 = (uint *)((int)param_2 + 0xfU & 0xfffffff0);
              pbVar3 = (byte *)HeapReAlloc(DAT_676c5c64,0,param_1,(SIZE_T)param_2);
            }
            if (pbVar3 != (byte *)0x0) {
              ExceptionList = local_14;
              return pbVar3;
            }
            if (DAT_676c5758 == (byte *)0x0) {
              ExceptionList = local_14;
              return (byte *)0x0;
            }
            iVar1 = FUN_676b25b9(param_2);
          } while (iVar1 != 0);
        }
      }
    }
    pbVar3 = (byte *)0x0;
  }
  ExceptionList = local_14;
  return pbVar3;
}



// Function: FUN_676b1027 at 676b1027

void FUN_676b1027(void)

{
  FUN_676b2105(9);
  return;
}



// Function: FUN_676b1175 at 676b1175

void FUN_676b1175(void)

{
  FUN_676b2105(9);
  return;
}



// Function: FUN_676b11cb at 676b11cb

int __thiscall FUN_676b11cb(void *this,byte *param_1)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  byte *pbVar5;
  undefined *puVar6;
  
  while( true ) {
    if (DAT_676c259c < 2) {
      uVar1 = (byte)PTR_DAT_676c2390[(uint)*param_1 * 2] & 8;
      this = PTR_DAT_676c2390;
    }
    else {
      puVar6 = (undefined *)0x8;
      uVar1 = FUN_676b0620(this,(uint)*param_1,8);
      this = puVar6;
    }
    if (uVar1 == 0) break;
    param_1 = param_1 + 1;
  }
  uVar1 = (uint)*param_1;
  pbVar5 = param_1 + 1;
  if ((uVar1 == 0x2d) || (uVar4 = uVar1, uVar1 == 0x2b)) {
    uVar4 = (uint)*pbVar5;
    pbVar5 = param_1 + 2;
  }
  iVar3 = 0;
  while( true ) {
    if (DAT_676c259c < 2) {
      uVar2 = (byte)PTR_DAT_676c2390[uVar4 * 2] & 4;
    }
    else {
      puVar6 = (undefined *)0x4;
      uVar2 = FUN_676b0620(this,uVar4,4);
      this = puVar6;
    }
    if (uVar2 == 0) break;
    iVar3 = (uVar4 - 0x30) + iVar3 * 10;
    uVar4 = (uint)*pbVar5;
    pbVar5 = pbVar5 + 1;
  }
  if (uVar1 == 0x2d) {
    iVar3 = -iVar3;
  }
  return iVar3;
}



// Function: FUN_676b1256 at 676b1256

void __thiscall FUN_676b1256(void *this,byte *param_1)

{
  FUN_676b11cb(this,param_1);
  return;
}



// Function: __aullshr at 676b1270

/* Library Function - Single Match
    __aullshr
   
   Library: Visual Studio */

ulonglong __fastcall __aullshr(byte param_1,uint param_2)

{
  uint in_EAX;
  
  if (0x3f < param_1) {
    return 0;
  }
  if (param_1 < 0x20) {
    return CONCAT44(param_2 >> (param_1 & 0x1f),
                    in_EAX >> (param_1 & 0x1f) | param_2 << 0x20 - (param_1 & 0x1f));
  }
  return (ulonglong)(param_2 >> (param_1 & 0x1f));
}



// Function: __ftol at 676b1290

/* Library Function - Single Match
    __ftol
   
   Library: Visual Studio */

longlong __ftol(void)

{
  float10 in_ST0;
  
  return (longlong)ROUND(in_ST0);
}



// Function: FUN_676b12b7 at 676b12b7

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 FUN_676b12b7(undefined4 param_1,int param_2)

{
  int iVar1;
  undefined4 uVar2;
  
  if (param_2 == 1) {
    DAT_676c569c = GetVersion();
    iVar1 = FUN_676b2749(1);
    if (iVar1 != 0) {
      _DAT_676c56a8 = DAT_676c569c >> 8 & 0xff;
      _DAT_676c56a4 = DAT_676c569c & 0xff;
      DAT_676c569c = DAT_676c569c >> 0x10;
      _DAT_676c56a0 = _DAT_676c56a4 * 0x100 + _DAT_676c56a8;
      iVar1 = FUN_676b4355();
      if (iVar1 != 0) {
        DAT_676c5d84 = GetCommandLineA();
        DAT_676c56e0 = FUN_676b47e7();
        FUN_676b1d7e();
        FUN_676b459a();
        FUN_676b44e1();
        FUN_676aff98();
        DAT_676c56dc = DAT_676c56dc + 1;
        goto LAB_676b138a;
      }
      FUN_676b27a6();
    }
LAB_676b1317:
    uVar2 = 0;
  }
  else {
    if (param_2 == 0) {
      if (DAT_676c56dc < 1) goto LAB_676b1317;
      DAT_676c56dc = DAT_676c56dc + -1;
      if (DAT_676c56d4 == 0) {
        FUN_676affe7();
      }
      FUN_676b1f3a();
      FUN_676b43a9();
      FUN_676b27a6();
    }
    else if (param_2 == 3) {
      FUN_676b4441((undefined *)0x0);
    }
LAB_676b138a:
    uVar2 = 1;
  }
  return uVar2;
}



// Function: entry at 676b1390

int entry(HMODULE param_1,int param_2,undefined4 param_3)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar1 = param_2;
  iVar2 = DAT_676c56dc;
  if (param_2 != 0) {
    if ((param_2 != 1) && (param_2 != 2)) goto LAB_676b13d8;
    if ((DAT_676c5d88 != (code *)0x0) &&
       (iVar2 = (*DAT_676c5d88)(param_1,param_2,param_3), iVar2 == 0)) {
      return 0;
    }
    iVar2 = FUN_676b12b7(param_1,param_2);
  }
  if (iVar2 == 0) {
    return 0;
  }
LAB_676b13d8:
  iVar2 = FUN_676a956a(param_1,param_2);
  if (param_2 == 1) {
    if (iVar2 != 0) {
      return iVar2;
    }
    FUN_676b12b7(param_1,0);
  }
  if ((param_2 != 0) && (param_2 != 3)) {
    return iVar2;
  }
  iVar3 = FUN_676b12b7(param_1,param_2);
  param_2 = iVar2;
  if (iVar3 == 0) {
    param_2 = 0;
  }
  if (param_2 != 0) {
    if (DAT_676c5d88 != (code *)0x0) {
      iVar2 = (*DAT_676c5d88)(param_1,iVar1,param_3);
      return iVar2;
    }
    return param_2;
  }
  return 0;
}



// Function: __amsg_exit at 676b142d

/* Library Function - Single Match
    __amsg_exit
   
   Library: Visual Studio 2003 Release */

void __cdecl __amsg_exit(int param_1)

{
  if ((DAT_676c56e8 == 1) || ((DAT_676c56e8 == 0 && (DAT_676c56ec == 1)))) {
    FUN_676b4919();
  }
  FUN_676b4952(param_1);
  (*(code *)PTR___exit_676c25b0)(0xff);
  return;
}



// Function: FUN_676b1460 at 676b1460

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 __cdecl FUN_676b1460(undefined4 *param_1)

{
  undefined4 uVar1;
  byte bVar2;
  undefined3 extraout_var;
  int iVar3;
  void *pvVar4;
  
  bVar2 = FUN_676b4aa5(param_1[4]);
  if (CONCAT31(extraout_var,bVar2) == 0) {
    return 0;
  }
  if (param_1 == (undefined4 *)&DAT_676c2118) {
    iVar3 = 0;
  }
  else {
    if (param_1 != (undefined4 *)&DAT_676c2138) {
      return 0;
    }
    iVar3 = 1;
  }
  _DAT_676c568c = _DAT_676c568c + 1;
  if ((*(ushort *)(param_1 + 3) & 0x10c) != 0) {
    return 0;
  }
  if ((&DAT_676c56f0)[iVar3] == 0) {
    pvVar4 = _malloc(0x1000);
    (&DAT_676c56f0)[iVar3] = pvVar4;
    if (pvVar4 == (void *)0x0) {
      param_1[2] = param_1 + 5;
      *param_1 = param_1 + 5;
      param_1[6] = 2;
      param_1[1] = 2;
      goto LAB_676b14dc;
    }
  }
  uVar1 = (&DAT_676c56f0)[iVar3];
  param_1[6] = 0x1000;
  param_1[2] = uVar1;
  *param_1 = uVar1;
  param_1[1] = 0x1000;
LAB_676b14dc:
  *(ushort *)(param_1 + 3) = *(ushort *)(param_1 + 3) | 0x1102;
  return 1;
}



// Function: FUN_676b14ed at 676b14ed

void __cdecl FUN_676b14ed(int param_1,int *param_2)

{
  if ((param_1 != 0) && ((*(byte *)((int)param_2 + 0xd) & 0x10) != 0)) {
    FUN_676b0318(param_2);
    *(byte *)((int)param_2 + 0xd) = *(byte *)((int)param_2 + 0xd) & 0xee;
    param_2[6] = 0;
    *param_2 = 0;
    param_2[2] = 0;
  }
  return;
}



// Function: FUN_676b1517 at 676b1517

int __cdecl FUN_676b1517(int *param_1,byte *param_2,undefined4 *param_3)

{
  int iVar1;
  uint uVar2;
  WCHAR *pWVar3;
  undefined4 uVar4;
  short *psVar5;
  int *piVar6;
  LPSTR pCVar7;
  byte bVar8;
  int iVar9;
  WCHAR *pWVar10;
  LPSTR pCVar11;
  undefined8 uVar12;
  WCHAR local_250 [255];
  undefined1 local_51;
  undefined4 local_50;
  undefined4 local_4c;
  CHAR local_48 [4];
  undefined4 local_44;
  int local_40;
  int local_3c;
  int local_38;
  WCHAR *local_34;
  int local_30;
  int local_2c;
  int local_28;
  undefined8 local_24;
  char local_1a;
  char local_19;
  int local_18;
  LPSTR local_14;
  WCHAR *local_10;
  int local_c;
  uint local_8;
  
  local_40 = 0;
  local_14 = (LPSTR)0x0;
  bVar8 = *param_2;
  param_2 = param_2 + 1;
  local_18 = 0;
  local_34 = (WCHAR *)0x0;
  do {
    if ((bVar8 == 0) || (local_18 < 0)) {
      return local_18;
    }
    if (((char)bVar8 < ' ') || ('x' < (char)bVar8)) {
      uVar2 = 0;
    }
    else {
      uVar2 = (byte)(&DAT_676bb6b0)[(char)bVar8] & 0xf;
    }
    local_40 = (int)(char)(&DAT_676bb6d0)[uVar2 * 8 + local_40] >> 4;
    switch(local_40) {
    case 0:
switchD_676b1593_caseD_0:
      local_30 = 0;
      if ((PTR_DAT_676c2390[(uint)bVar8 * 2 + 1] & 0x80) != 0) {
        FUN_676b1cb5((int)(char)bVar8,param_1,&local_18);
        bVar8 = *param_2;
        param_2 = param_2 + 1;
      }
      FUN_676b1cb5((int)(char)bVar8,param_1,&local_18);
      break;
    case 1:
      local_c = -1;
      local_44 = 0;
      local_3c = 0;
      local_2c = 0;
      local_28 = 0;
      local_8 = 0;
      local_30 = 0;
      break;
    case 2:
      if (bVar8 == 0x20) {
        local_8 = local_8 | 2;
      }
      else if (bVar8 == 0x23) {
        local_8 = local_8 | 0x80;
      }
      else if (bVar8 == 0x2b) {
        local_8 = local_8 | 1;
      }
      else if (bVar8 == 0x2d) {
        local_8 = local_8 | 4;
      }
      else if (bVar8 == 0x30) {
        local_8 = local_8 | 8;
      }
      break;
    case 3:
      if (bVar8 == 0x2a) {
        local_2c = FUN_676b1d53((int *)&param_3);
        if (local_2c < 0) {
          local_8 = local_8 | 4;
          local_2c = -local_2c;
        }
      }
      else {
        local_2c = (char)bVar8 + -0x30 + local_2c * 10;
      }
      break;
    case 4:
      local_c = 0;
      break;
    case 5:
      if (bVar8 == 0x2a) {
        local_c = FUN_676b1d53((int *)&param_3);
        if (local_c < 0) {
          local_c = -1;
        }
      }
      else {
        local_c = (char)bVar8 + -0x30 + local_c * 10;
      }
      break;
    case 6:
      if (bVar8 == 0x49) {
        if ((*param_2 != 0x36) || (param_2[1] != 0x34)) {
          local_40 = 0;
          goto switchD_676b1593_caseD_0;
        }
        param_2 = param_2 + 2;
        local_8 = local_8 | 0x8000;
      }
      else if (bVar8 == 0x68) {
        local_8 = local_8 | 0x20;
      }
      else if (bVar8 == 0x6c) {
        local_8 = local_8 | 0x10;
      }
      else if (bVar8 == 0x77) {
        local_8 = local_8 | 0x800;
      }
      break;
    case 7:
      pWVar10 = local_10;
      if ((char)bVar8 < 'h') {
        if ((char)bVar8 < 'e') {
          if ((char)bVar8 < 'Y') {
            if (bVar8 != 0x58) {
              if (bVar8 == 0x43) {
                if ((local_8 & 0x830) == 0) {
                  local_8 = local_8 | 0x800;
                }
                goto LAB_676b17e8;
              }
              if ((bVar8 != 0x45) && (bVar8 != 0x47)) {
                if (bVar8 == 0x53) {
                  if ((local_8 & 0x830) == 0) {
                    local_8 = local_8 | 0x800;
                  }
                  goto LAB_676b1758;
                }
                goto LAB_676b1b6b;
              }
              local_44 = 1;
              bVar8 = bVar8 + 0x20;
              goto LAB_676b17ba;
            }
LAB_676b19c7:
            local_38 = 7;
LAB_676b19ce:
            local_14 = (LPSTR)0x10;
            if ((local_8 & 0x80) != 0) {
              local_1a = '0';
              local_19 = (char)local_38 + 'Q';
              local_28 = 2;
            }
            goto LAB_676b1a37;
          }
          if (bVar8 == 0x5a) {
            psVar5 = (short *)FUN_676b1d53((int *)&param_3);
            if ((psVar5 == (short *)0x0) ||
               (pWVar10 = *(WCHAR **)(psVar5 + 2), pWVar10 == (WCHAR *)0x0)) {
              local_10 = (WCHAR *)PTR_DAT_676c25b4;
              pWVar10 = (WCHAR *)PTR_DAT_676c25b4;
              goto LAB_676b1948;
            }
            if ((local_8 & 0x800) == 0) {
              local_30 = 0;
              local_14 = (LPSTR)(int)*psVar5;
            }
            else {
              local_30 = 1;
              local_14 = (LPSTR)((uint)(int)*psVar5 >> 1);
            }
          }
          else if (bVar8 == 99) {
LAB_676b17e8:
            if ((local_8 & 0x810) == 0) {
              uVar4 = FUN_676b1d53((int *)&param_3);
              local_250[0]._0_1_ = (undefined1)uVar4;
              local_14 = (LPSTR)0x1;
            }
            else {
              uVar4 = FUN_676b1d70((int *)&param_3);
              local_14 = FUN_676b4b4b((LPSTR)local_250,(WCHAR)uVar4);
              if ((int)local_14 < 0) {
                local_3c = 1;
              }
            }
            pWVar10 = local_250;
          }
          else if (bVar8 == 100) goto LAB_676b1a2c;
        }
        else {
LAB_676b17ba:
          local_8 = local_8 | 0x40;
          pWVar10 = local_250;
          pWVar3 = local_250;
          if (local_c < 0) {
            local_c = 6;
          }
          else if (local_c == 0) {
            if (bVar8 == 0x67) {
              local_c = 1;
            }
          }
          else {
            if (0x200 < local_c) {
              local_c = 0x200;
            }
            if ((0xa3 < local_c) &&
               (local_10 = local_250, local_34 = (WCHAR *)_malloc(local_c + 0x15d),
               pWVar10 = local_34, pWVar3 = local_34, local_34 == (WCHAR *)0x0)) {
              local_c = 0xa3;
              pWVar10 = local_250;
              pWVar3 = local_10;
            }
          }
          local_10 = pWVar3;
          local_50 = *param_3;
          local_4c = param_3[1];
          param_3 = param_3 + 2;
          (*(code *)PTR___fptrap_676c26a4)(&local_50,pWVar10,(int)(char)bVar8,local_c,local_44);
          uVar2 = local_8 & 0x80;
          if ((uVar2 != 0) && (local_c == 0)) {
            (*(code *)PTR___fptrap_676c26b0)(pWVar10);
          }
          if ((bVar8 == 0x67) && (uVar2 == 0)) {
            (*(code *)PTR___fptrap_676c26a8)(pWVar10);
          }
          if ((char)*pWVar10 == '-') {
            local_8 = local_8 | 0x100;
            pWVar10 = (WCHAR *)((int)pWVar10 + 1);
            local_10 = pWVar10;
          }
LAB_676b1948:
          local_14 = (LPSTR)_strlen((char *)pWVar10);
          pWVar10 = local_10;
        }
LAB_676b1b6b:
        local_10 = pWVar10;
        uVar2 = local_8;
        if (local_3c == 0) {
          if ((local_8 & 0x40) != 0) {
            if ((local_8 & 0x100) == 0) {
              if ((local_8 & 1) == 0) {
                if ((local_8 & 2) == 0) goto LAB_676b1ba3;
                local_1a = ' ';
              }
              else {
                local_1a = '+';
              }
            }
            else {
              local_1a = '-';
            }
            local_28 = 1;
          }
LAB_676b1ba3:
          iVar9 = (local_2c - local_28) - (int)local_14;
          if ((local_8 & 0xc) == 0) {
            FUN_676b1cea(0x20,iVar9,param_1,&local_18);
          }
          FUN_676b1d1b(&local_1a,local_28,param_1,&local_18);
          if (((uVar2 & 8) != 0) && ((uVar2 & 4) == 0)) {
            FUN_676b1cea(0x30,iVar9,param_1,&local_18);
          }
          if ((local_30 == 0) || (pCVar11 = local_14, pWVar10 = local_10, (int)local_14 < 1)) {
            FUN_676b1d1b((char *)local_10,(int)local_14,param_1,&local_18);
          }
          else {
            do {
              pCVar11 = pCVar11 + -1;
              pCVar7 = FUN_676b4b4b(local_48,*pWVar10);
              if ((int)pCVar7 < 1) break;
              FUN_676b1d1b(local_48,(int)pCVar7,param_1,&local_18);
              pWVar10 = pWVar10 + 1;
            } while (pCVar11 != (LPSTR)0x0);
          }
          if ((local_8 & 4) != 0) {
            FUN_676b1cea(0x20,iVar9,param_1,&local_18);
          }
        }
      }
      else {
        if (bVar8 == 0x69) {
LAB_676b1a2c:
          local_8 = local_8 | 0x40;
LAB_676b1a30:
          local_14 = (LPSTR)0xa;
LAB_676b1a37:
          if ((local_8 & 0x8000) == 0) {
            if ((local_8 & 0x20) == 0) {
              if ((local_8 & 0x40) == 0) {
                uVar2 = FUN_676b1d53((int *)&param_3);
                local_24 = (ulonglong)uVar2;
                goto LAB_676b1a8a;
              }
              uVar2 = FUN_676b1d53((int *)&param_3);
            }
            else if ((local_8 & 0x40) == 0) {
              uVar2 = FUN_676b1d53((int *)&param_3);
              uVar2 = uVar2 & 0xffff;
            }
            else {
              uVar4 = FUN_676b1d53((int *)&param_3);
              uVar2 = (uint)(short)uVar4;
            }
            local_24 = (ulonglong)(int)uVar2;
          }
          else {
            local_24 = FUN_676b1d60((int *)&param_3);
          }
LAB_676b1a8a:
          iVar9 = (int)(local_24 >> 0x20);
          if ((((local_8 & 0x40) != 0) && (iVar9 == 0 || (longlong)local_24 < 0)) &&
             ((longlong)local_24 < 0)) {
            local_8 = local_8 | 0x100;
            local_24 = CONCAT44(-(iVar9 + (uint)((int)local_24 != 0)),-(int)local_24);
          }
          if ((local_8 & 0x8000) == 0) {
            local_24 = local_24 & 0xffffffff;
          }
          if (local_c < 0) {
            local_c = 1;
          }
          else {
            local_8 = local_8 & 0xfffffff7;
            if (0x200 < local_c) {
              local_c = 0x200;
            }
          }
          if ((uint)local_24 == 0 && local_24._4_4_ == 0) {
            local_28 = 0;
          }
          local_10 = (WCHAR *)&local_51;
          while( true ) {
            pCVar11 = local_14;
            iVar9 = local_c + -1;
            if ((local_c < 1) && ((uint)local_24 == 0 && local_24._4_4_ == 0)) break;
            uVar2 = (int)local_14 >> 0x1f;
            local_c = iVar9;
            uVar12 = __aullrem((uint)local_24,local_24._4_4_,(uint)local_14,uVar2);
            iVar9 = (int)uVar12 + 0x30;
            local_24 = __aulldiv((uint)local_24,local_24._4_4_,(uint)pCVar11,uVar2);
            if (0x39 < iVar9) {
              iVar9 = iVar9 + local_38;
            }
            pWVar10 = (WCHAR *)((int)local_10 + -1);
            *(char *)local_10 = (char)iVar9;
            local_10 = pWVar10;
          }
          iVar1 = -(int)local_10;
          local_14 = &local_51 + iVar1;
          pWVar10 = (WCHAR *)((int)local_10 + 1);
          local_c = iVar9;
          if (((local_8 & 0x200) != 0) && ((*(char *)pWVar10 != '0' || (local_14 == (LPSTR)0x0)))) {
            *(char *)local_10 = '0';
            local_14 = (LPSTR)((int)&local_50 + iVar1);
            pWVar10 = local_10;
          }
          goto LAB_676b1b6b;
        }
        if (bVar8 != 0x6e) {
          if (bVar8 == 0x6f) {
            local_14 = (LPSTR)0x8;
            if ((local_8 & 0x80) != 0) {
              local_8 = local_8 | 0x200;
            }
            goto LAB_676b1a37;
          }
          if (bVar8 == 0x70) {
            local_c = 8;
            goto LAB_676b19c7;
          }
          if (bVar8 == 0x73) {
LAB_676b1758:
            iVar9 = 0x7fffffff;
            if (local_c != -1) {
              iVar9 = local_c;
            }
            pWVar3 = (WCHAR *)FUN_676b1d53((int *)&param_3);
            if ((local_8 & 0x810) == 0) {
              pWVar10 = pWVar3;
              if (pWVar3 == (WCHAR *)0x0) {
                pWVar3 = (WCHAR *)PTR_DAT_676c25b4;
                pWVar10 = (WCHAR *)PTR_DAT_676c25b4;
              }
              for (; (iVar9 != 0 && ((char)*pWVar3 != '\0')); pWVar3 = (WCHAR *)((int)pWVar3 + 1)) {
                iVar9 = iVar9 + -1;
              }
              local_14 = (LPSTR)((int)pWVar3 - (int)pWVar10);
            }
            else {
              if (pWVar3 == (WCHAR *)0x0) {
                pWVar3 = (WCHAR *)PTR_DAT_676c25b8;
              }
              local_30 = 1;
              for (pWVar10 = pWVar3; (iVar9 != 0 && (*pWVar10 != L'\0')); pWVar10 = pWVar10 + 1) {
                iVar9 = iVar9 + -1;
              }
              local_14 = (LPSTR)((int)pWVar10 - (int)pWVar3 >> 1);
              pWVar10 = pWVar3;
            }
            goto LAB_676b1b6b;
          }
          if (bVar8 != 0x75) {
            if (bVar8 != 0x78) goto LAB_676b1b6b;
            local_38 = 0x27;
            goto LAB_676b19ce;
          }
          goto LAB_676b1a30;
        }
        piVar6 = (int *)FUN_676b1d53((int *)&param_3);
        if ((local_8 & 0x20) == 0) {
          *piVar6 = local_18;
        }
        else {
          *(undefined2 *)piVar6 = (undefined2)local_18;
        }
        local_3c = 1;
      }
      if (local_34 != (WCHAR *)0x0) {
        FUN_676b0201((undefined *)local_34);
        local_34 = (WCHAR *)0x0;
      }
    }
    bVar8 = *param_2;
    param_2 = param_2 + 1;
  } while( true );
}



// Function: FUN_676b1cb5 at 676b1cb5

void __cdecl FUN_676b1cb5(uint param_1,int *param_2,int *param_3)

{
  int *piVar1;
  uint uVar2;
  
  piVar1 = param_2 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 < 0) {
    uVar2 = FUN_676b3c34(param_1,param_2);
  }
  else {
    *(undefined1 *)*param_2 = (undefined1)param_1;
    *param_2 = *param_2 + 1;
    uVar2 = param_1 & 0xff;
  }
  if (uVar2 == 0xffffffff) {
    *param_3 = -1;
    return;
  }
  *param_3 = *param_3 + 1;
  return;
}



// Function: FUN_676b1cea at 676b1cea

void __cdecl FUN_676b1cea(uint param_1,int param_2,int *param_3,int *param_4)

{
  if (0 < param_2) {
    do {
      param_2 = param_2 + -1;
      FUN_676b1cb5(param_1,param_3,param_4);
      if (*param_4 == -1) {
        return;
      }
    } while (0 < param_2);
  }
  return;
}



// Function: FUN_676b1d1b at 676b1d1b

void __cdecl FUN_676b1d1b(char *param_1,int param_2,int *param_3,int *param_4)

{
  char cVar1;
  
  if (0 < param_2) {
    do {
      param_2 = param_2 + -1;
      cVar1 = *param_1;
      param_1 = param_1 + 1;
      FUN_676b1cb5((int)cVar1,param_3,param_4);
      if (*param_4 == -1) {
        return;
      }
    } while (0 < param_2);
  }
  return;
}



// Function: FUN_676b1d53 at 676b1d53

undefined4 __cdecl FUN_676b1d53(int *param_1)

{
  *param_1 = *param_1 + 4;
  return *(undefined4 *)(*param_1 + -4);
}



// Function: FUN_676b1d60 at 676b1d60

undefined8 __cdecl FUN_676b1d60(int *param_1)

{
  *param_1 = *param_1 + 8;
  return *(undefined8 *)(*param_1 + -8);
}



// Function: FUN_676b1d70 at 676b1d70

undefined4 __cdecl FUN_676b1d70(int *param_1)

{
  *param_1 = *param_1 + 4;
  return CONCAT22((short)((uint)*param_1 >> 0x10),*(undefined2 *)(*param_1 + -4));
}



// Function: FUN_676b1d7e at 676b1d7e

void FUN_676b1d7e(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  DWORD DVar4;
  HANDLE hFile;
  UINT *pUVar5;
  int iVar6;
  uint uVar7;
  UINT UVar8;
  UINT UVar9;
  _STARTUPINFOA local_4c;
  byte *local_8;
  
  puVar2 = (undefined4 *)_malloc(0x480);
  if (puVar2 == (undefined4 *)0x0) {
    __amsg_exit(0x1b);
  }
  DAT_676c5d80 = 0x20;
  DAT_676c5c80 = puVar2;
  for (; puVar2 < DAT_676c5c80 + 0x120; puVar2 = puVar2 + 9) {
    *(undefined1 *)(puVar2 + 1) = 0;
    *puVar2 = 0xffffffff;
    puVar2[2] = 0;
    *(undefined1 *)((int)puVar2 + 5) = 10;
  }
  GetStartupInfoA(&local_4c);
  if ((local_4c.cbReserved2 != 0) && ((UINT *)local_4c.lpReserved2 != (UINT *)0x0)) {
    UVar8 = *(UINT *)local_4c.lpReserved2;
    pUVar5 = (UINT *)((int)local_4c.lpReserved2 + 4);
    local_8 = (byte *)((int)pUVar5 + UVar8);
    if (0x7ff < (int)UVar8) {
      UVar8 = 0x800;
    }
    UVar9 = UVar8;
    if ((int)DAT_676c5d80 < (int)UVar8) {
      puVar2 = &DAT_676c5c84;
      do {
        puVar3 = (undefined4 *)_malloc(0x480);
        UVar9 = DAT_676c5d80;
        if (puVar3 == (undefined4 *)0x0) break;
        DAT_676c5d80 = DAT_676c5d80 + 0x20;
        *puVar2 = puVar3;
        puVar1 = puVar3;
        for (; puVar3 < puVar1 + 0x120; puVar3 = puVar3 + 9) {
          *(undefined1 *)(puVar3 + 1) = 0;
          *puVar3 = 0xffffffff;
          puVar3[2] = 0;
          *(undefined1 *)((int)puVar3 + 5) = 10;
          puVar1 = (undefined4 *)*puVar2;
        }
        puVar2 = puVar2 + 1;
        UVar9 = UVar8;
      } while ((int)DAT_676c5d80 < (int)UVar8);
    }
    uVar7 = 0;
    if (0 < (int)UVar9) {
      do {
        if (((*(HANDLE *)local_8 != (HANDLE)0xffffffff) && ((*pUVar5 & 1) != 0)) &&
           (((*pUVar5 & 8) != 0 || (DVar4 = GetFileType(*(HANDLE *)local_8), DVar4 != 0)))) {
          puVar2 = (undefined4 *)((int)(&DAT_676c5c80)[(int)uVar7 >> 5] + (uVar7 & 0x1f) * 0x24);
          *puVar2 = *(undefined4 *)local_8;
          *(byte *)(puVar2 + 1) = (byte)*pUVar5;
        }
        local_8 = local_8 + 4;
        uVar7 = uVar7 + 1;
        pUVar5 = (UINT *)((int)pUVar5 + 1);
      } while ((int)uVar7 < (int)UVar9);
    }
  }
  iVar6 = 0;
  do {
    puVar2 = DAT_676c5c80 + iVar6 * 9;
    if (DAT_676c5c80[iVar6 * 9] == -1) {
      *(undefined1 *)(puVar2 + 1) = 0x81;
      if (iVar6 == 0) {
        DVar4 = 0xfffffff6;
      }
      else {
        DVar4 = 0xfffffff5 - (iVar6 != 1);
      }
      hFile = GetStdHandle(DVar4);
      if ((hFile != (HANDLE)0xffffffff) && (DVar4 = GetFileType(hFile), DVar4 != 0)) {
        *puVar2 = hFile;
        if ((DVar4 & 0xff) != 2) {
          if ((DVar4 & 0xff) == 3) {
            *(byte *)(puVar2 + 1) = *(byte *)(puVar2 + 1) | 8;
          }
          goto LAB_676b1f23;
        }
      }
      *(byte *)(puVar2 + 1) = *(byte *)(puVar2 + 1) | 0x40;
    }
    else {
      *(byte *)(puVar2 + 1) = *(byte *)(puVar2 + 1) | 0x80;
    }
LAB_676b1f23:
    iVar6 = iVar6 + 1;
    if (2 < iVar6) {
      SetHandleCount(DAT_676c5d80);
      return;
    }
  } while( true );
}



// Function: FUN_676b1f3a at 676b1f3a

void FUN_676b1f3a(void)

{
  LPCRITICAL_SECTION lpCriticalSection;
  uint *puVar1;
  uint uVar2;
  
  puVar1 = &DAT_676c5c80;
  do {
    uVar2 = *puVar1;
    if (uVar2 != 0) {
      if (uVar2 < uVar2 + 0x480) {
        lpCriticalSection = (LPCRITICAL_SECTION)(uVar2 + 0xc);
        do {
          if (lpCriticalSection[-1].SpinCount != 0) {
            DeleteCriticalSection(lpCriticalSection);
          }
          uVar2 = uVar2 + 0x24;
          lpCriticalSection = (LPCRITICAL_SECTION)&lpCriticalSection[1].OwningThread;
        } while (uVar2 < *puVar1 + 0x480);
      }
      FUN_676b0201((undefined *)*puVar1);
      *puVar1 = 0;
    }
    puVar1 = puVar1 + 1;
  } while ((int)puVar1 < 0x676c5d80);
  return;
}



// Function: FUN_676b200f at 676b200f

void FUN_676b200f(void)

{
  InitializeCriticalSection((LPCRITICAL_SECTION)PTR_DAT_676c2628);
  InitializeCriticalSection((LPCRITICAL_SECTION)PTR_DAT_676c2618);
  InitializeCriticalSection((LPCRITICAL_SECTION)PTR_DAT_676c2608);
  InitializeCriticalSection((LPCRITICAL_SECTION)PTR_DAT_676c25e8);
  return;
}



// Function: FUN_676b2038 at 676b2038

void FUN_676b2038(void)

{
  undefined **ppuVar1;
  
  ppuVar1 = (undefined **)&DAT_676c25e4;
  do {
    if (((((LPCRITICAL_SECTION)*ppuVar1 != (LPCRITICAL_SECTION)0x0) &&
         (ppuVar1 != &PTR_DAT_676c2628)) && (ppuVar1 != &PTR_DAT_676c2618)) &&
       ((ppuVar1 != &PTR_DAT_676c2608 && (ppuVar1 != &PTR_DAT_676c25e8)))) {
      DeleteCriticalSection((LPCRITICAL_SECTION)*ppuVar1);
      FUN_676b0201(*ppuVar1);
    }
    ppuVar1 = ppuVar1 + 1;
  } while ((int)ppuVar1 < 0x676c26a4);
  DeleteCriticalSection((LPCRITICAL_SECTION)PTR_DAT_676c2608);
  DeleteCriticalSection((LPCRITICAL_SECTION)PTR_DAT_676c2618);
  DeleteCriticalSection((LPCRITICAL_SECTION)PTR_DAT_676c2628);
  DeleteCriticalSection((LPCRITICAL_SECTION)PTR_DAT_676c25e8);
  return;
}



// Function: FUN_676b20a4 at 676b20a4

void __cdecl FUN_676b20a4(int param_1)

{
  int *piVar1;
  LPCRITICAL_SECTION lpCriticalSection;
  
  piVar1 = &DAT_676c25e4 + param_1;
  if ((&DAT_676c25e4)[param_1] == 0) {
    lpCriticalSection = (LPCRITICAL_SECTION)_malloc(0x18);
    if (lpCriticalSection == (LPCRITICAL_SECTION)0x0) {
      __amsg_exit(0x11);
    }
    FUN_676b20a4(0x11);
    if (*piVar1 == 0) {
      InitializeCriticalSection(lpCriticalSection);
      *piVar1 = (int)lpCriticalSection;
    }
    else {
      FUN_676b0201((undefined *)lpCriticalSection);
    }
    FUN_676b2105(0x11);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)*piVar1);
  return;
}



// Function: FUN_676b2105 at 676b2105

void __cdecl FUN_676b2105(int param_1)

{
  LeaveCriticalSection((LPCRITICAL_SECTION)(&DAT_676c25e4)[param_1]);
  return;
}



// Function: FUN_676b211a at 676b211a

void __fastcall FUN_676b211a(void *param_1)

{
  FUN_676b4cba(param_1,0x10000,0x30000);
  return;
}



// Function: FUN_676b212c at 676b212c

/* WARNING: Removing unreachable block (ram,0x676b2161) */

undefined4 FUN_676b212c(void)

{
  return 0;
}



// Function: FUN_676b216a at 676b216a

void FUN_676b216a(void)

{
  HMODULE hModule;
  FARPROC pFVar1;
  
  hModule = GetModuleHandleA(s_KERNEL32_676c0598);
  if (hModule != (HMODULE)0x0) {
    pFVar1 = GetProcAddress(hModule,"IsProcessorFeaturePresent");
    if (pFVar1 != (FARPROC)0x0) {
      (*pFVar1)(0);
      return;
    }
  }
  FUN_676b212c();
  return;
}



// Function: FUN_676b2193 at 676b2193

void __cdecl FUN_676b2193(char *param_1)

{
  char cVar1;
  char cVar2;
  undefined *this;
  uint uVar3;
  undefined *puVar4;
  
  this = (undefined *)(int)*param_1;
  uVar3 = FUN_676b4deb((uint)this);
  if (uVar3 != 0x65) {
    do {
      param_1 = param_1 + 1;
      if (DAT_676c259c < 2) {
        uVar3 = (byte)PTR_DAT_676c2390[*param_1 * 2] & 4;
        this = PTR_DAT_676c2390;
      }
      else {
        puVar4 = (undefined *)0x4;
        uVar3 = FUN_676b0620(this,(int)*param_1,4);
        this = puVar4;
      }
    } while (uVar3 != 0);
  }
  cVar2 = *param_1;
  *param_1 = DAT_676c25a0;
  do {
    param_1 = param_1 + 1;
    cVar1 = *param_1;
    *param_1 = cVar2;
    cVar2 = cVar1;
  } while (*param_1 != '\0');
  return;
}



// Function: __fassign at 676b2253

/* Library Function - Single Match
    __fassign
   
   Library: Visual Studio 2003 Release */

void __cdecl __fassign(int flag,char *argument,char *number)

{
  void *in_ECX;
  void *local_c;
  void *local_8;
  
  if (flag != 0) {
    local_c = in_ECX;
    local_8 = in_ECX;
    FUN_676b52b7(in_ECX,(uint *)&local_c,(byte *)number);
    *(void **)argument = local_c;
    *(void **)(argument + 4) = local_8;
    return;
  }
  FUN_676b52e4(in_ECX,(uint *)&number,(byte *)number);
  *(char **)argument = number;
  return;
}



// Function: FUN_676b2291 at 676b2291

undefined1 * __cdecl FUN_676b2291(undefined8 *param_1,undefined1 *param_2,int param_3,int param_4)

{
  uint local_2c [6];
  int local_14 [4];
  
  FUN_676b5388((int)*param_1,(int)((ulonglong)*param_1 >> 0x20),local_14,local_2c);
  FUN_676b5311(param_2 + (uint)(0 < param_3) + (uint)(local_14[0] == 0x2d),param_3 + 1,(int)local_14
              );
  FUN_676b22f2(param_2,param_3,param_4,local_14,'\0');
  return param_2;
}



// Function: FUN_676b22f2 at 676b22f2

undefined1 * __cdecl
FUN_676b22f2(undefined1 *param_1,int param_2,int param_3,int *param_4,char param_5)

{
  undefined1 *puVar1;
  undefined1 *puVar2;
  uint *puVar3;
  int iVar4;
  
  if (param_5 != '\0') {
    FUN_676b2594(param_1 + (*param_4 == 0x2d),(uint)(0 < param_2));
  }
  puVar1 = param_1;
  if (*param_4 == 0x2d) {
    *param_1 = 0x2d;
    puVar1 = param_1 + 1;
  }
  puVar2 = puVar1;
  if (0 < param_2) {
    puVar2 = puVar1 + 1;
    *puVar1 = puVar1[1];
    *puVar2 = DAT_676c25a0;
  }
  puVar3 = FUN_676b0530((uint *)(puVar2 + param_2 + (uint)(param_5 == '\0')),(uint *)"e+000");
  if (param_3 != 0) {
    *(undefined1 *)puVar3 = 0x45;
  }
  if (*(char *)param_4[3] != '0') {
    iVar4 = param_4[1] + -1;
    if (iVar4 < 0) {
      iVar4 = -iVar4;
      *(undefined1 *)((int)puVar3 + 1) = 0x2d;
    }
    if (99 < iVar4) {
      *(char *)((int)puVar3 + 2) = *(char *)((int)puVar3 + 2) + (char)(iVar4 / 100);
      iVar4 = iVar4 % 100;
    }
    if (9 < iVar4) {
      *(char *)((int)puVar3 + 3) = *(char *)((int)puVar3 + 3) + (char)(iVar4 / 10);
      iVar4 = iVar4 % 10;
    }
    *(char *)(puVar3 + 1) = (char)puVar3[1] + (char)iVar4;
  }
  return param_1;
}



// Function: FUN_676b23b4 at 676b23b4

char * __cdecl FUN_676b23b4(undefined8 *param_1,char *param_2,size_t param_3)

{
  uint local_2c [6];
  int local_14;
  int local_10;
  
  FUN_676b5388((int)*param_1,(int)((ulonglong)*param_1 >> 0x20),&local_14,local_2c);
  FUN_676b5311(param_2 + (local_14 == 0x2d),local_10 + param_3,(int)&local_14);
  FUN_676b2409(param_2,param_3,&local_14,'\0');
  return param_2;
}



// Function: FUN_676b2409 at 676b2409

char * __cdecl FUN_676b2409(char *param_1,size_t param_2,int *param_3,char param_4)

{
  int iVar1;
  int iVar2;
  char *pcVar3;
  
  iVar1 = param_3[1];
  if ((param_4 != '\0') && (iVar1 - 1U == param_2)) {
    iVar2 = *param_3;
    param_1[(uint)(iVar2 == 0x2d) + (iVar1 - 1U)] = '0';
    (param_1 + (uint)(iVar2 == 0x2d) + (iVar1 - 1U))[1] = '\0';
  }
  pcVar3 = param_1;
  if (*param_3 == 0x2d) {
    *param_1 = '-';
    pcVar3 = param_1 + 1;
  }
  if (param_3[1] < 1) {
    FUN_676b2594(pcVar3,1);
    *pcVar3 = '0';
    pcVar3 = pcVar3 + 1;
  }
  else {
    pcVar3 = pcVar3 + param_3[1];
  }
  if (0 < (int)param_2) {
    FUN_676b2594(pcVar3,1);
    *pcVar3 = DAT_676c25a0;
    iVar1 = param_3[1];
    if (iVar1 < 0) {
      if ((param_4 != '\0') || (SBORROW4(param_2,-iVar1) == (int)(param_2 + iVar1) < 0)) {
        param_2 = -iVar1;
      }
      FUN_676b2594(pcVar3 + 1,param_2);
      _memset(pcVar3 + 1,0x30,param_2);
    }
  }
  return param_1;
}



// Function: FUN_676b24b0 at 676b24b0

void __cdecl FUN_676b24b0(undefined8 *param_1,char *param_2,size_t param_3,int param_4)

{
  int iVar1;
  char *pcVar2;
  char *pcVar3;
  uint local_2c [6];
  int local_14;
  int local_10;
  
  FUN_676b5388((int)*param_1,(int)((ulonglong)*param_1 >> 0x20),&local_14,local_2c);
  iVar1 = local_10 + -1;
  FUN_676b5311(param_2 + (local_14 == 0x2d),param_3,(int)&local_14);
  local_10 = local_10 + -1;
  if ((local_10 < -4) || ((int)param_3 <= local_10)) {
    FUN_676b22f2(param_2,param_3,param_4,&local_14,'\x01');
  }
  else {
    pcVar2 = param_2 + (local_14 == 0x2d);
    if (iVar1 < local_10) {
      do {
        pcVar3 = pcVar2;
        pcVar2 = pcVar3 + 1;
      } while (*pcVar3 != '\0');
      pcVar3[-1] = '\0';
    }
    FUN_676b2409(param_2,param_3,&local_14,'\x01');
  }
  return;
}



// Function: __cfltcvt at 676b2543

/* Library Function - Single Match
    __cfltcvt
   
   Library: Visual Studio 2003 Release */

errno_t __cdecl
__cfltcvt(double *arg,char *buffer,size_t sizeInBytes,int format,int precision,int caps)

{
  char *pcVar1;
  undefined1 *puVar2;
  
  if ((sizeInBytes == 0x65) || (sizeInBytes == 0x45)) {
    puVar2 = FUN_676b2291(arg,buffer,format,precision);
  }
  else {
    if (sizeInBytes == 0x66) {
      pcVar1 = FUN_676b23b4(arg,buffer,format);
      return (errno_t)pcVar1;
    }
    puVar2 = (undefined1 *)FUN_676b24b0(arg,buffer,format,precision);
  }
  return (errno_t)puVar2;
}



// Function: FUN_676b2594 at 676b2594

void __cdecl FUN_676b2594(char *param_1,int param_2)

{
  size_t sVar1;
  
  if (param_2 != 0) {
    sVar1 = _strlen(param_1);
    FUN_676b54a0((undefined4 *)(param_1 + param_2),(undefined4 *)param_1,sVar1 + 1);
  }
  return;
}



// Function: FUN_676b25b9 at 676b25b9

undefined4 __cdecl FUN_676b25b9(undefined4 param_1)

{
  int iVar1;
  
  if (DAT_676c575c != (code *)0x0) {
    iVar1 = (*DAT_676c575c)(param_1);
    if (iVar1 != 0) {
      return 1;
    }
  }
  return 0;
}



// Function: FUN_676b25d4 at 676b25d4

void __cdecl FUN_676b25d4(undefined4 *param_1)

{
  int iVar1;
  HMODULE pHVar2;
  
  *param_1 = 0;
  pHVar2 = GetModuleHandleA((LPCSTR)0x0);
  if (((short)pHVar2->unused == 0x5a4d) && (iVar1 = pHVar2[0xf].unused, iVar1 != 0)) {
    *(undefined1 *)param_1 = *(undefined1 *)((int)&pHVar2[6].unused + iVar1 + 2);
    *(undefined1 *)((int)param_1 + 1) = *(undefined1 *)((int)&pHVar2[6].unused + iVar1 + 3);
  }
  return;
}



// Function: FUN_676b2601 at 676b2601

int FUN_676b2601(void)

{
  char cVar1;
  byte bVar2;
  BOOL BVar3;
  DWORD DVar4;
  int iVar5;
  byte *pbVar6;
  char *pcVar7;
  byte *this;
  byte unaff_BL;
  char local_1230 [4240];
  char local_1a0 [260];
  DWORD local_9c;
  uint local_98;
  DWORD local_8c;
  CHAR aCStackY_18 [4];
  
  FUN_676b06a0();
  local_9c = 0x94;
  BVar3 = GetVersionExA((LPOSVERSIONINFOA)&local_9c);
  if (((BVar3 == 0) || (local_8c != 2)) || (local_98 < 5)) {
    builtin_memcpy(aCStackY_18,"[&kg",4);
    DVar4 = GetEnvironmentVariableA("__MSVCRT_HEAP_SELECT",local_1230,0x1090);
    if (DVar4 != 0) {
      pcVar7 = local_1230;
      while (local_1230[0] != '\0') {
        cVar1 = *pcVar7;
        if (('`' < cVar1) && (cVar1 < '{')) {
          *pcVar7 = cVar1 + -0x20;
        }
        pcVar7 = pcVar7 + 1;
        local_1230[0] = *pcVar7;
      }
      aCStackY_18[0] = -0x67;
      aCStackY_18[1] = '&';
      aCStackY_18[2] = 'k';
      aCStackY_18[3] = 'g';
      iVar5 = _strncmp("__GLOBAL_HEAP_SELECTED",local_1230,0x16);
      if (iVar5 == 0) {
        pcVar7 = local_1230;
      }
      else {
        aCStackY_18[0] = -0x45;
        aCStackY_18[1] = '&';
        aCStackY_18[2] = 'k';
        aCStackY_18[3] = 'g';
        GetModuleFileNameA((HMODULE)0x0,local_1a0,0x104);
        pcVar7 = local_1a0;
        while (local_1a0[0] != '\0') {
          cVar1 = *pcVar7;
          if (('`' < cVar1) && (cVar1 < '{')) {
            *pcVar7 = cVar1 + -0x20;
          }
          pcVar7 = pcVar7 + 1;
          local_1a0[0] = *pcVar7;
        }
        pcVar7 = _strstr(local_1230,local_1a0);
      }
      if ((pcVar7 != (char *)0x0) && (pcVar7 = _strchr(pcVar7,0x2c), pcVar7 != (char *)0x0)) {
        pbVar6 = (byte *)(pcVar7 + 1);
        bVar2 = *pbVar6;
        this = pbVar6;
        while (bVar2 != 0) {
          if (*this == 0x3b) {
            *this = 0;
          }
          else {
            this = this + 1;
          }
          bVar2 = *this;
        }
        builtin_memcpy(aCStackY_18,"!\'kg",4);
        iVar5 = FUN_676b57de(this,pbVar6,(int *)0x0,(void *)0xa);
        if (iVar5 == 2) {
          return 2;
        }
        if (iVar5 == 3) {
          return 3;
        }
        if (iVar5 == 1) {
          return 1;
        }
      }
    }
    FUN_676b25d4((undefined4 *)&stack0xfffffff8);
    iVar5 = 3 - (uint)(unaff_BL < 6);
  }
  else {
    iVar5 = 1;
  }
  return iVar5;
}



// Function: FUN_676b2749 at 676b2749

undefined4 __cdecl FUN_676b2749(int param_1)

{
  undefined **ppuVar1;
  
  DAT_676c5c64 = HeapCreate((uint)(param_1 == 0),0x1000,0);
  if (DAT_676c5c64 != (HANDLE)0x0) {
    DAT_676c5c68 = FUN_676b2601();
    if (DAT_676c5c68 == 3) {
      ppuVar1 = (undefined **)FUN_676b284e(0x3f8);
    }
    else {
      if (DAT_676c5c68 != 2) {
        return 1;
      }
      ppuVar1 = FUN_676b3395();
    }
    if (ppuVar1 != (undefined **)0x0) {
      return 1;
    }
    HeapDestroy(DAT_676c5c64);
  }
  return 0;
}



// Function: FUN_676b27a6 at 676b27a6

void FUN_676b27a6(void)

{
  int iVar1;
  undefined4 *puVar2;
  undefined **ppuVar3;
  
  if (DAT_676c5c68 == 3) {
    iVar1 = 0;
    if (0 < DAT_676c5c58) {
      puVar2 = (undefined4 *)((int)DAT_676c5c5c + 0xc);
      do {
        VirtualFree((LPVOID)*puVar2,0x100000,0x4000);
        VirtualFree((LPVOID)*puVar2,0,0x8000);
        HeapFree(DAT_676c5c64,0,(LPVOID)puVar2[1]);
        puVar2 = puVar2 + 5;
        iVar1 = iVar1 + 1;
      } while (iVar1 < DAT_676c5c58);
    }
    HeapFree(DAT_676c5c64,0,DAT_676c5c5c);
  }
  else if (DAT_676c5c68 == 2) {
    ppuVar3 = &PTR_LOOP_676c26c0;
    do {
      if (ppuVar3[4] != (undefined *)0x0) {
        VirtualFree(ppuVar3[4],0,0x8000);
      }
      ppuVar3 = (undefined **)*ppuVar3;
    } while (ppuVar3 != &PTR_LOOP_676c26c0);
  }
  HeapDestroy(DAT_676c5c64);
  return;
}



// Function: FUN_676b284e at 676b284e

undefined4 __cdecl FUN_676b284e(undefined4 param_1)

{
  DAT_676c5c5c = HeapAlloc(DAT_676c5c64,0,0x140);
  if (DAT_676c5c5c == (LPVOID)0x0) {
    return 0;
  }
  DAT_676c5c54 = 0;
  DAT_676c5c58 = 0;
  DAT_676c5c50 = DAT_676c5c5c;
  DAT_676c5c60 = param_1;
  DAT_676c5c48 = 0x10;
  return 1;
}



// Function: FUN_676b2896 at 676b2896

uint __cdecl FUN_676b2896(int param_1)

{
  uint uVar1;
  
  uVar1 = DAT_676c5c5c;
  while( true ) {
    if (DAT_676c5c5c + DAT_676c5c58 * 0x14 <= uVar1) {
      return 0;
    }
    if ((uint)(param_1 - *(int *)(uVar1 + 0xc)) < 0x100000) break;
    uVar1 = uVar1 + 0x14;
  }
  return uVar1;
}



// Function: FUN_676b28c1 at 676b28c1

void __cdecl FUN_676b28c1(uint *param_1,int param_2)

{
  char *pcVar1;
  uint *puVar2;
  int *piVar3;
  char cVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  byte bVar8;
  uint uVar9;
  uint *puVar10;
  uint *puVar11;
  uint *puVar12;
  uint uVar13;
  uint uVar14;
  uint local_8;
  
  uVar5 = param_1[4];
  puVar12 = (uint *)(param_2 + -4);
  uVar14 = param_2 - param_1[3] >> 0xf;
  piVar3 = (int *)(uVar14 * 0x204 + 0x144 + uVar5);
  uVar13 = *puVar12;
  local_8 = uVar13 - 1;
  if ((local_8 & 1) == 0) {
    uVar6 = *(uint *)(local_8 + (int)puVar12);
    uVar7 = *(uint *)(param_2 + -8);
    if ((uVar6 & 1) == 0) {
      uVar9 = ((int)uVar6 >> 4) - 1;
      if (0x3f < uVar9) {
        uVar9 = 0x3f;
      }
      if (*(int *)((int)puVar12 + uVar13 + 3) == *(int *)((int)puVar12 + uVar13 + 7)) {
        if (uVar9 < 0x20) {
          pcVar1 = (char *)(uVar9 + 4 + uVar5);
          uVar9 = ~(0x80000000U >> ((byte)uVar9 & 0x1f));
          puVar10 = (uint *)(uVar5 + 0x44 + uVar14 * 4);
          *puVar10 = *puVar10 & uVar9;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            *param_1 = *param_1 & uVar9;
          }
        }
        else {
          pcVar1 = (char *)(uVar9 + 4 + uVar5);
          uVar9 = ~(0x80000000U >> ((byte)uVar9 - 0x20 & 0x1f));
          puVar10 = (uint *)(uVar5 + 0xc4 + uVar14 * 4);
          *puVar10 = *puVar10 & uVar9;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            param_1[1] = param_1[1] & uVar9;
          }
        }
      }
      local_8 = local_8 + uVar6;
      *(undefined4 *)(*(int *)((int)puVar12 + uVar13 + 7) + 4) =
           *(undefined4 *)((int)puVar12 + uVar13 + 3);
      *(undefined4 *)(*(int *)((int)puVar12 + uVar13 + 3) + 8) =
           *(undefined4 *)((int)puVar12 + uVar13 + 7);
    }
    puVar10 = (uint *)(((int)local_8 >> 4) - 1);
    if ((uint *)0x3f < puVar10) {
      puVar10 = (uint *)0x3f;
    }
    puVar11 = param_1;
    if ((uVar7 & 1) == 0) {
      puVar12 = (uint *)((int)puVar12 - uVar7);
      puVar11 = (uint *)(((int)uVar7 >> 4) - 1);
      if ((uint *)0x3f < puVar11) {
        puVar11 = (uint *)0x3f;
      }
      local_8 = local_8 + uVar7;
      puVar10 = (uint *)(((int)local_8 >> 4) - 1);
      if ((uint *)0x3f < puVar10) {
        puVar10 = (uint *)0x3f;
      }
      if (puVar11 != puVar10) {
        if (puVar12[1] == puVar12[2]) {
          if (puVar11 < (uint *)0x20) {
            uVar13 = ~(0x80000000U >> ((byte)puVar11 & 0x1f));
            puVar2 = (uint *)(uVar5 + 0x44 + uVar14 * 4);
            *puVar2 = *puVar2 & uVar13;
            pcVar1 = (char *)((int)puVar11 + uVar5 + 4);
            *pcVar1 = *pcVar1 + -1;
            if (*pcVar1 == '\0') {
              *param_1 = *param_1 & uVar13;
            }
          }
          else {
            uVar13 = ~(0x80000000U >> ((byte)puVar11 - 0x20 & 0x1f));
            puVar2 = (uint *)(uVar5 + 0xc4 + uVar14 * 4);
            *puVar2 = *puVar2 & uVar13;
            pcVar1 = (char *)((int)puVar11 + uVar5 + 4);
            *pcVar1 = *pcVar1 + -1;
            if (*pcVar1 == '\0') {
              param_1[1] = param_1[1] & uVar13;
            }
          }
        }
        *(uint *)(puVar12[2] + 4) = puVar12[1];
        *(uint *)(puVar12[1] + 8) = puVar12[2];
      }
    }
    if (((uVar7 & 1) != 0) || (puVar11 != puVar10)) {
      puVar12[1] = piVar3[(int)puVar10 * 2 + 1];
      puVar12[2] = (uint)(piVar3 + (int)puVar10 * 2);
      (piVar3 + (int)puVar10 * 2)[1] = (int)puVar12;
      *(uint **)(puVar12[1] + 8) = puVar12;
      if (puVar12[1] == puVar12[2]) {
        cVar4 = *(char *)((int)puVar10 + uVar5 + 4);
        *(char *)((int)puVar10 + uVar5 + 4) = cVar4 + '\x01';
        bVar8 = (byte)puVar10;
        if (puVar10 < (uint *)0x20) {
          if (cVar4 == '\0') {
            *param_1 = *param_1 | 0x80000000U >> (bVar8 & 0x1f);
          }
          puVar10 = (uint *)(uVar5 + 0x44 + uVar14 * 4);
          *puVar10 = *puVar10 | 0x80000000U >> (bVar8 & 0x1f);
        }
        else {
          if (cVar4 == '\0') {
            param_1[1] = param_1[1] | 0x80000000U >> (bVar8 - 0x20 & 0x1f);
          }
          puVar10 = (uint *)(uVar5 + 0xc4 + uVar14 * 4);
          *puVar10 = *puVar10 | 0x80000000U >> (bVar8 - 0x20 & 0x1f);
        }
      }
    }
    *puVar12 = local_8;
    *(uint *)((local_8 - 4) + (int)puVar12) = local_8;
    *piVar3 = *piVar3 + -1;
    if (*piVar3 == 0) {
      if (DAT_676c5c54 != (uint *)0x0) {
        VirtualFree((LPVOID)(DAT_676c5c4c * 0x8000 + DAT_676c5c54[3]),0x8000,0x4000);
        DAT_676c5c54[2] = DAT_676c5c54[2] | 0x80000000U >> ((byte)DAT_676c5c4c & 0x1f);
        *(undefined4 *)(DAT_676c5c54[4] + 0xc4 + DAT_676c5c4c * 4) = 0;
        *(char *)(DAT_676c5c54[4] + 0x43) = *(char *)(DAT_676c5c54[4] + 0x43) + -1;
        if (*(char *)(DAT_676c5c54[4] + 0x43) == '\0') {
          DAT_676c5c54[1] = DAT_676c5c54[1] & 0xfffffffe;
        }
        if (DAT_676c5c54[2] == 0xffffffff) {
          VirtualFree((LPVOID)DAT_676c5c54[3],0,0x8000);
          HeapFree(DAT_676c5c64,0,(LPVOID)DAT_676c5c54[4]);
          FUN_676b54a0(DAT_676c5c54,DAT_676c5c54 + 5,
                       (DAT_676c5c58 * 0x14 - (int)DAT_676c5c54) + -0x14 + DAT_676c5c5c);
          DAT_676c5c58 = DAT_676c5c58 + -1;
          if (DAT_676c5c54 < param_1) {
            param_1 = param_1 + -5;
          }
          DAT_676c5c50 = DAT_676c5c5c;
        }
      }
      DAT_676c5c54 = param_1;
      DAT_676c5c4c = uVar14;
    }
  }
  return;
}



// Function: FUN_676b2bea at 676b2bea

int * __cdecl FUN_676b2bea(uint *param_1)

{
  char *pcVar1;
  int *piVar2;
  char cVar3;
  int *piVar4;
  byte bVar5;
  uint uVar6;
  int iVar7;
  uint *puVar8;
  int iVar9;
  int *piVar10;
  uint *puVar11;
  uint *puVar12;
  uint uVar13;
  int iVar14;
  uint local_10;
  uint local_c;
  int local_8;
  
  puVar8 = DAT_676c5c5c + DAT_676c5c58 * 5;
  uVar6 = (int)param_1 + 0x17U & 0xfffffff0;
  iVar7 = ((int)((int)param_1 + 0x17U) >> 4) + -1;
  bVar5 = (byte)iVar7;
  if (iVar7 < 0x20) {
    local_10 = 0xffffffff >> (bVar5 & 0x1f);
    local_c = 0xffffffff;
  }
  else {
    local_c = 0xffffffff >> (bVar5 - 0x20 & 0x1f);
    local_10 = 0;
  }
  param_1 = DAT_676c5c50;
  if (DAT_676c5c50 < puVar8) {
    do {
      if ((param_1[1] & local_c) != 0 || (*param_1 & local_10) != 0) break;
      param_1 = param_1 + 5;
    } while (param_1 < puVar8);
  }
  puVar11 = DAT_676c5c5c;
  if (param_1 == puVar8) {
    for (; (puVar11 < DAT_676c5c50 && ((puVar11[1] & local_c) == 0 && (*puVar11 & local_10) == 0));
        puVar11 = puVar11 + 5) {
    }
    param_1 = puVar11;
    if (puVar11 == DAT_676c5c50) {
      for (; (puVar11 < puVar8 && (puVar11[2] == 0)); puVar11 = puVar11 + 5) {
      }
      puVar12 = DAT_676c5c5c;
      param_1 = puVar11;
      if (puVar11 == puVar8) {
        for (; (puVar12 < DAT_676c5c50 && (puVar12[2] == 0)); puVar12 = puVar12 + 5) {
        }
        param_1 = puVar12;
        if ((puVar12 == DAT_676c5c50) && (param_1 = FUN_676b2ef3(), param_1 == (uint *)0x0)) {
          return (int *)0x0;
        }
      }
      iVar7 = FUN_676b2fa4((int)param_1);
      *(int *)param_1[4] = iVar7;
      if (*(int *)param_1[4] == -1) {
        return (int *)0x0;
      }
    }
  }
  piVar4 = (int *)param_1[4];
  local_8 = *piVar4;
  if ((local_8 == -1) ||
     ((piVar4[local_8 + 0x31] & local_c) == 0 && (piVar4[local_8 + 0x11] & local_10) == 0)) {
    local_8 = 0;
    puVar8 = (uint *)(piVar4 + 0x11);
    if ((piVar4[0x31] & local_c) == 0 && (piVar4[0x11] & local_10) == 0) {
      do {
        puVar11 = puVar8 + 0x21;
        local_8 = local_8 + 1;
        puVar8 = puVar8 + 1;
      } while ((*puVar11 & local_c) == 0 && (local_10 & *puVar8) == 0);
    }
  }
  iVar7 = 0;
  piVar2 = piVar4 + local_8 * 0x81 + 0x51;
  local_10 = piVar4[local_8 + 0x11] & local_10;
  if (local_10 == 0) {
    local_10 = piVar4[local_8 + 0x31] & local_c;
    iVar7 = 0x20;
  }
  for (; -1 < (int)local_10; local_10 = local_10 << 1) {
    iVar7 = iVar7 + 1;
  }
  piVar10 = (int *)piVar2[iVar7 * 2 + 1];
  iVar9 = *piVar10 - uVar6;
  iVar14 = (iVar9 >> 4) + -1;
  if (0x3f < iVar14) {
    iVar14 = 0x3f;
  }
  DAT_676c5c50 = param_1;
  if (iVar14 != iVar7) {
    if (piVar10[1] == piVar10[2]) {
      if (iVar7 < 0x20) {
        pcVar1 = (char *)((int)piVar4 + iVar7 + 4);
        uVar13 = ~(0x80000000U >> ((byte)iVar7 & 0x1f));
        piVar4[local_8 + 0x11] = uVar13 & piVar4[local_8 + 0x11];
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          *param_1 = *param_1 & uVar13;
        }
      }
      else {
        pcVar1 = (char *)((int)piVar4 + iVar7 + 4);
        uVar13 = ~(0x80000000U >> ((byte)iVar7 - 0x20 & 0x1f));
        piVar4[local_8 + 0x31] = piVar4[local_8 + 0x31] & uVar13;
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          param_1[1] = param_1[1] & uVar13;
        }
      }
    }
    *(int *)(piVar10[2] + 4) = piVar10[1];
    *(int *)(piVar10[1] + 8) = piVar10[2];
    if (iVar9 == 0) goto LAB_676b2eb0;
    piVar10[1] = piVar2[iVar14 * 2 + 1];
    piVar10[2] = (int)(piVar2 + iVar14 * 2);
    (piVar2 + iVar14 * 2)[1] = (int)piVar10;
    *(int **)(piVar10[1] + 8) = piVar10;
    if (piVar10[1] == piVar10[2]) {
      cVar3 = *(char *)(iVar14 + 4 + (int)piVar4);
      bVar5 = (byte)iVar14;
      if (iVar14 < 0x20) {
        *(char *)(iVar14 + 4 + (int)piVar4) = cVar3 + '\x01';
        if (cVar3 == '\0') {
          *param_1 = *param_1 | 0x80000000U >> (bVar5 & 0x1f);
        }
        piVar4[local_8 + 0x11] = piVar4[local_8 + 0x11] | 0x80000000U >> (bVar5 & 0x1f);
      }
      else {
        *(char *)(iVar14 + 4 + (int)piVar4) = cVar3 + '\x01';
        if (cVar3 == '\0') {
          param_1[1] = param_1[1] | 0x80000000U >> (bVar5 - 0x20 & 0x1f);
        }
        piVar4[local_8 + 0x31] = piVar4[local_8 + 0x31] | 0x80000000U >> (bVar5 - 0x20 & 0x1f);
      }
    }
  }
  if (iVar9 != 0) {
    *piVar10 = iVar9;
    *(int *)(iVar9 + -4 + (int)piVar10) = iVar9;
  }
LAB_676b2eb0:
  piVar10 = (int *)((int)piVar10 + iVar9);
  *piVar10 = uVar6 + 1;
  *(uint *)((int)piVar10 + (uVar6 - 4)) = uVar6 + 1;
  iVar7 = *piVar2;
  *piVar2 = iVar7 + 1;
  if (((iVar7 == 0) && (param_1 == DAT_676c5c54)) && (local_8 == DAT_676c5c4c)) {
    DAT_676c5c54 = (uint *)0x0;
  }
  *piVar4 = local_8;
  return piVar10 + 1;
}



// Function: FUN_676b2ef3 at 676b2ef3

undefined4 * FUN_676b2ef3(void)

{
  undefined4 *puVar1;
  LPVOID pvVar2;
  
  if (DAT_676c5c58 == DAT_676c5c48) {
    pvVar2 = HeapReAlloc(DAT_676c5c64,0,DAT_676c5c5c,(DAT_676c5c48 * 5 + 0x50) * 4);
    if (pvVar2 == (LPVOID)0x0) {
      return (undefined4 *)0x0;
    }
    DAT_676c5c48 = DAT_676c5c48 + 0x10;
    DAT_676c5c5c = pvVar2;
  }
  puVar1 = (undefined4 *)((int)DAT_676c5c5c + DAT_676c5c58 * 0x14);
  pvVar2 = HeapAlloc(DAT_676c5c64,8,0x41c4);
  puVar1[4] = pvVar2;
  if (pvVar2 != (LPVOID)0x0) {
    pvVar2 = VirtualAlloc((LPVOID)0x0,0x100000,0x2000,4);
    puVar1[3] = pvVar2;
    if (pvVar2 != (LPVOID)0x0) {
      puVar1[2] = 0xffffffff;
      *puVar1 = 0;
      puVar1[1] = 0;
      DAT_676c5c58 = DAT_676c5c58 + 1;
      *(undefined4 *)puVar1[4] = 0xffffffff;
      return puVar1;
    }
    HeapFree(DAT_676c5c64,0,(LPVOID)puVar1[4]);
  }
  return (undefined4 *)0x0;
}



// Function: FUN_676b2fa4 at 676b2fa4

int __cdecl FUN_676b2fa4(int param_1)

{
  int *piVar1;
  char cVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  LPVOID pvVar6;
  int *piVar7;
  int iVar8;
  int iVar9;
  int *lpAddress;
  
  iVar3 = *(int *)(param_1 + 0x10);
  iVar9 = 0;
  for (iVar4 = *(int *)(param_1 + 8); -1 < iVar4; iVar4 = iVar4 << 1) {
    iVar9 = iVar9 + 1;
  }
  iVar8 = 0x3f;
  iVar4 = iVar9 * 0x204 + 0x144 + iVar3;
  iVar5 = iVar4;
  do {
    *(int *)(iVar5 + 8) = iVar5;
    *(int *)(iVar5 + 4) = iVar5;
    iVar5 = iVar5 + 8;
    iVar8 = iVar8 + -1;
  } while (iVar8 != 0);
  lpAddress = (int *)(iVar9 * 0x8000 + *(int *)(param_1 + 0xc));
  pvVar6 = VirtualAlloc(lpAddress,0x8000,0x1000,4);
  if (pvVar6 == (LPVOID)0x0) {
    iVar9 = -1;
  }
  else {
    if (lpAddress <= lpAddress + 0x1c00) {
      piVar7 = lpAddress + 4;
      do {
        piVar7[-2] = -1;
        piVar7[0x3fb] = -1;
        piVar7[-1] = 0xff0;
        *piVar7 = (int)(piVar7 + 0x3ff);
        piVar7[1] = (int)(piVar7 + -0x401);
        piVar7[0x3fa] = 0xff0;
        piVar1 = piVar7 + 0x3fc;
        piVar7 = piVar7 + 0x400;
      } while (piVar1 <= lpAddress + 0x1c00);
    }
    *(int **)(iVar4 + 0x1fc) = lpAddress + 3;
    lpAddress[5] = iVar4 + 0x1f8;
    *(int **)(iVar4 + 0x200) = lpAddress + 0x1c03;
    lpAddress[0x1c04] = iVar4 + 0x1f8;
    *(undefined4 *)(iVar3 + 0x44 + iVar9 * 4) = 0;
    *(undefined4 *)(iVar3 + 0xc4 + iVar9 * 4) = 1;
    cVar2 = *(char *)(iVar3 + 0x43);
    *(char *)(iVar3 + 0x43) = cVar2 + '\x01';
    if (cVar2 == '\0') {
      *(uint *)(param_1 + 4) = *(uint *)(param_1 + 4) | 1;
    }
    *(uint *)(param_1 + 8) = *(uint *)(param_1 + 8) & ~(0x80000000U >> ((byte)iVar9 & 0x1f));
  }
  return iVar9;
}



// Function: FUN_676b309f at 676b309f

undefined4 __cdecl FUN_676b309f(uint *param_1,int param_2,int param_3)

{
  char *pcVar1;
  int *piVar2;
  int iVar3;
  char cVar4;
  uint uVar5;
  int iVar6;
  uint *puVar7;
  byte bVar8;
  int iVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint local_c;
  
  uVar5 = param_1[4];
  uVar12 = param_3 + 0x17U & 0xfffffff0;
  uVar10 = param_2 - param_1[3] >> 0xf;
  iVar3 = uVar10 * 0x204 + 0x144 + uVar5;
  iVar6 = *(int *)(param_2 + -4);
  iVar9 = iVar6 + -1;
  uVar13 = *(uint *)(iVar6 + -5 + param_2);
  iVar6 = iVar6 + -5 + param_2;
  if (iVar9 < (int)uVar12) {
    if (((uVar13 & 1) != 0) || ((int)(uVar13 + iVar9) < (int)uVar12)) {
      return 0;
    }
    local_c = ((int)uVar13 >> 4) - 1;
    if (0x3f < local_c) {
      local_c = 0x3f;
    }
    if (*(int *)(iVar6 + 4) == *(int *)(iVar6 + 8)) {
      if (local_c < 0x20) {
        pcVar1 = (char *)(local_c + 4 + uVar5);
        uVar11 = ~(0x80000000U >> ((byte)local_c & 0x1f));
        puVar7 = (uint *)(uVar5 + 0x44 + uVar10 * 4);
        *puVar7 = *puVar7 & uVar11;
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          *param_1 = *param_1 & uVar11;
        }
      }
      else {
        pcVar1 = (char *)(local_c + 4 + uVar5);
        uVar11 = ~(0x80000000U >> ((byte)local_c - 0x20 & 0x1f));
        puVar7 = (uint *)(uVar5 + 0xc4 + uVar10 * 4);
        *puVar7 = *puVar7 & uVar11;
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          param_1[1] = param_1[1] & uVar11;
        }
      }
    }
    *(undefined4 *)(*(int *)(iVar6 + 8) + 4) = *(undefined4 *)(iVar6 + 4);
    *(undefined4 *)(*(int *)(iVar6 + 4) + 8) = *(undefined4 *)(iVar6 + 8);
    iVar6 = uVar13 + (iVar9 - uVar12);
    if (0 < iVar6) {
      uVar13 = (iVar6 >> 4) - 1;
      iVar9 = param_2 + -4 + uVar12;
      if (0x3f < uVar13) {
        uVar13 = 0x3f;
      }
      iVar3 = iVar3 + uVar13 * 8;
      *(undefined4 *)(iVar9 + 4) = *(undefined4 *)(iVar3 + 4);
      *(int *)(iVar9 + 8) = iVar3;
      *(int *)(iVar3 + 4) = iVar9;
      *(int *)(*(int *)(iVar9 + 4) + 8) = iVar9;
      if (*(int *)(iVar9 + 4) == *(int *)(iVar9 + 8)) {
        cVar4 = *(char *)(uVar13 + 4 + uVar5);
        *(char *)(uVar13 + 4 + uVar5) = cVar4 + '\x01';
        bVar8 = (byte)uVar13;
        if (uVar13 < 0x20) {
          if (cVar4 == '\0') {
            *param_1 = *param_1 | 0x80000000U >> (bVar8 & 0x1f);
          }
          puVar7 = (uint *)(uVar5 + 0x44 + uVar10 * 4);
        }
        else {
          if (cVar4 == '\0') {
            param_1[1] = param_1[1] | 0x80000000U >> (bVar8 - 0x20 & 0x1f);
          }
          puVar7 = (uint *)(uVar5 + 0xc4 + uVar10 * 4);
          bVar8 = bVar8 - 0x20;
        }
        *puVar7 = *puVar7 | 0x80000000U >> (bVar8 & 0x1f);
      }
      piVar2 = (int *)(param_2 + -4 + uVar12);
      *piVar2 = iVar6;
      *(int *)(iVar6 + -4 + (int)piVar2) = iVar6;
    }
    *(uint *)(param_2 + -4) = uVar12 + 1;
    *(uint *)(param_2 + -8 + uVar12) = uVar12 + 1;
  }
  else if ((int)uVar12 < iVar9) {
    param_3 = iVar9 - uVar12;
    *(uint *)(param_2 + -4) = uVar12 + 1;
    piVar2 = (int *)(param_2 + -4 + uVar12);
    uVar11 = (param_3 >> 4) - 1;
    piVar2[-1] = uVar12 + 1;
    if (0x3f < uVar11) {
      uVar11 = 0x3f;
    }
    if ((uVar13 & 1) == 0) {
      uVar12 = ((int)uVar13 >> 4) - 1;
      if (0x3f < uVar12) {
        uVar12 = 0x3f;
      }
      if (*(int *)(iVar6 + 4) == *(int *)(iVar6 + 8)) {
        if (uVar12 < 0x20) {
          pcVar1 = (char *)(uVar12 + 4 + uVar5);
          uVar12 = ~(0x80000000U >> ((byte)uVar12 & 0x1f));
          puVar7 = (uint *)(uVar5 + 0x44 + uVar10 * 4);
          *puVar7 = *puVar7 & uVar12;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            *param_1 = *param_1 & uVar12;
          }
        }
        else {
          pcVar1 = (char *)(uVar12 + 4 + uVar5);
          uVar12 = ~(0x80000000U >> ((byte)uVar12 - 0x20 & 0x1f));
          puVar7 = (uint *)(uVar5 + 0xc4 + uVar10 * 4);
          *puVar7 = *puVar7 & uVar12;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            param_1[1] = param_1[1] & uVar12;
          }
        }
      }
      *(undefined4 *)(*(int *)(iVar6 + 8) + 4) = *(undefined4 *)(iVar6 + 4);
      *(undefined4 *)(*(int *)(iVar6 + 4) + 8) = *(undefined4 *)(iVar6 + 8);
      param_3 = param_3 + uVar13;
      uVar11 = (param_3 >> 4) - 1;
      if (0x3f < uVar11) {
        uVar11 = 0x3f;
      }
    }
    iVar6 = iVar3 + uVar11 * 8;
    piVar2[1] = *(int *)(iVar3 + 4 + uVar11 * 8);
    piVar2[2] = iVar6;
    *(int **)(iVar6 + 4) = piVar2;
    *(int **)(piVar2[1] + 8) = piVar2;
    if (piVar2[1] == piVar2[2]) {
      cVar4 = *(char *)(uVar11 + 4 + uVar5);
      *(char *)(uVar11 + 4 + uVar5) = cVar4 + '\x01';
      bVar8 = (byte)uVar11;
      if (uVar11 < 0x20) {
        if (cVar4 == '\0') {
          *param_1 = *param_1 | 0x80000000U >> (bVar8 & 0x1f);
        }
        puVar7 = (uint *)(uVar5 + 0x44 + uVar10 * 4);
      }
      else {
        if (cVar4 == '\0') {
          param_1[1] = param_1[1] | 0x80000000U >> (bVar8 - 0x20 & 0x1f);
        }
        puVar7 = (uint *)(uVar5 + 0xc4 + uVar10 * 4);
        bVar8 = bVar8 - 0x20;
      }
      *puVar7 = *puVar7 | 0x80000000U >> (bVar8 & 0x1f);
    }
    *piVar2 = param_3;
    *(int *)(param_3 + -4 + (int)piVar2) = param_3;
  }
  return 1;
}



// Function: FUN_676b3395 at 676b3395

undefined ** FUN_676b3395(void)

{
  bool bVar1;
  int *lpAddress;
  LPVOID pvVar2;
  undefined **ppuVar3;
  int iVar4;
  undefined **lpMem;
  
  if (DAT_676c26d0 == -1) {
    lpMem = &PTR_LOOP_676c26c0;
  }
  else {
    lpMem = (undefined **)HeapAlloc(DAT_676c5c64,0,0x2020);
    if (lpMem == (undefined **)0x0) {
      return (undefined **)0x0;
    }
  }
  lpAddress = (int *)VirtualAlloc((LPVOID)0x0,0x400000,0x2000,4);
  if (lpAddress != (int *)0x0) {
    pvVar2 = VirtualAlloc(lpAddress,0x10000,0x1000,4);
    if (pvVar2 != (LPVOID)0x0) {
      if (lpMem == &PTR_LOOP_676c26c0) {
        if (PTR_LOOP_676c26c0 == (undefined *)0x0) {
          PTR_LOOP_676c26c0 = (undefined *)&PTR_LOOP_676c26c0;
        }
        if (PTR_PTR_LOOP_676c26c4 == (undefined *)0x0) {
          PTR_PTR_LOOP_676c26c4 = (undefined *)&PTR_LOOP_676c26c0;
        }
      }
      else {
        *lpMem = (undefined *)&PTR_LOOP_676c26c0;
        lpMem[1] = PTR_PTR_LOOP_676c26c4;
        PTR_PTR_LOOP_676c26c4 = (undefined *)lpMem;
        *(undefined ***)lpMem[1] = lpMem;
      }
      lpMem[5] = (undefined *)(lpAddress + 0x100000);
      ppuVar3 = lpMem + 6;
      lpMem[3] = (undefined *)(lpMem + 0x26);
      lpMem[4] = (undefined *)lpAddress;
      lpMem[2] = (undefined *)ppuVar3;
      iVar4 = 0;
      do {
        bVar1 = 0xf < iVar4;
        iVar4 = iVar4 + 1;
        *ppuVar3 = (undefined *)((bVar1 - 1 & 0xf1) - 1);
        ppuVar3[1] = (undefined *)0xf1;
        ppuVar3 = ppuVar3 + 2;
      } while (iVar4 < 0x400);
      _memset(lpAddress,0,0x10000);
      for (; lpAddress < lpMem[4] + 0x10000; lpAddress = lpAddress + 0x400) {
        *(undefined1 *)(lpAddress + 0x3e) = 0xff;
        *lpAddress = (int)(lpAddress + 2);
        lpAddress[1] = 0xf0;
      }
      return lpMem;
    }
    VirtualFree(lpAddress,0,0x8000);
  }
  if (lpMem != &PTR_LOOP_676c26c0) {
    HeapFree(DAT_676c5c64,0,lpMem);
  }
  return (undefined **)0x0;
}



// Function: FUN_676b34d9 at 676b34d9

void __cdecl FUN_676b34d9(undefined **param_1)

{
  VirtualFree(param_1[4],0,0x8000);
  if ((undefined **)PTR_PTR_LOOP_676c46e0 == param_1) {
    PTR_PTR_LOOP_676c46e0 = param_1[1];
  }
  if (param_1 != &PTR_LOOP_676c26c0) {
    *(undefined **)param_1[1] = *param_1;
    *(undefined **)(*param_1 + 4) = param_1[1];
    HeapFree(DAT_676c5c64,0,param_1);
    return;
  }
  DAT_676c26d0 = 0xffffffff;
  return;
}



// Function: FUN_676b352f at 676b352f

void __cdecl FUN_676b352f(int param_1)

{
  BOOL BVar1;
  undefined **ppuVar2;
  int iVar3;
  undefined **ppuVar4;
  undefined **ppuVar5;
  int local_8;
  
  ppuVar4 = (undefined **)PTR_PTR_LOOP_676c26c4;
  do {
    ppuVar5 = ppuVar4;
    if (ppuVar4[4] != (undefined *)0xffffffff) {
      local_8 = 0;
      ppuVar5 = ppuVar4 + 0x804;
      iVar3 = 0x3ff000;
      do {
        if (*ppuVar5 == (undefined *)0xf0) {
          BVar1 = VirtualFree(ppuVar4[4] + iVar3,0x1000,0x4000);
          if (BVar1 != 0) {
            *ppuVar5 = (undefined *)0xffffffff;
            DAT_676c5760 = DAT_676c5760 + -1;
            if (((undefined **)ppuVar4[3] == (undefined **)0x0) || (ppuVar5 < ppuVar4[3])) {
              ppuVar4[3] = (undefined *)ppuVar5;
            }
            local_8 = local_8 + 1;
            param_1 = param_1 + -1;
            if (param_1 == 0) break;
          }
        }
        iVar3 = iVar3 + -0x1000;
        ppuVar5 = ppuVar5 + -2;
      } while (-1 < iVar3);
      ppuVar5 = (undefined **)ppuVar4[1];
      if ((local_8 != 0) && (ppuVar4[6] == (undefined *)0xffffffff)) {
        ppuVar2 = ppuVar4 + 8;
        iVar3 = 1;
        do {
          if (*ppuVar2 != (undefined *)0xffffffff) break;
          iVar3 = iVar3 + 1;
          ppuVar2 = ppuVar2 + 2;
        } while (iVar3 < 0x400);
        if (iVar3 == 0x400) {
          FUN_676b34d9(ppuVar4);
        }
      }
    }
    if ((ppuVar5 == (undefined **)PTR_PTR_LOOP_676c26c4) || (ppuVar4 = ppuVar5, param_1 < 1)) {
      return;
    }
  } while( true );
}



// Function: FUN_676b35f1 at 676b35f1

int __cdecl FUN_676b35f1(undefined *param_1,undefined4 *param_2,uint *param_3)

{
  undefined **ppuVar1;
  uint uVar2;
  
  ppuVar1 = &PTR_LOOP_676c26c0;
  while ((param_1 <= ppuVar1[4] || (ppuVar1[5] <= param_1))) {
    ppuVar1 = (undefined **)*ppuVar1;
    if (ppuVar1 == &PTR_LOOP_676c26c0) {
      return 0;
    }
  }
  if (((uint)param_1 & 0xf) != 0) {
    return 0;
  }
  if (((uint)param_1 & 0xfff) < 0x100) {
    return 0;
  }
  *param_2 = ppuVar1;
  uVar2 = (uint)param_1 & 0xfffff000;
  *param_3 = uVar2;
  return ((int)(param_1 + (-0x100 - uVar2)) >> 4) + 8 + uVar2;
}



// Function: FUN_676b3648 at 676b3648

void __cdecl FUN_676b3648(int param_1,int param_2,byte *param_3)

{
  int *piVar1;
  
  piVar1 = (int *)(param_1 + 0x18 + (param_2 - *(int *)(param_1 + 0x10) >> 0xc) * 8);
  *piVar1 = *piVar1 + (uint)*param_3;
  *param_3 = 0;
  piVar1[1] = 0xf1;
  if ((*piVar1 == 0xf0) && (DAT_676c5760 = DAT_676c5760 + 1, DAT_676c5760 == 0x20)) {
    FUN_676b352f(0x10);
  }
  return;
}



// Function: FUN_676b368d at 676b368d

/* WARNING: Type propagation algorithm not settling */

int * __cdecl FUN_676b368d(uint param_1)

{
  uint *puVar1;
  undefined **ppuVar2;
  undefined *puVar3;
  int *piVar4;
  int *piVar5;
  undefined **ppuVar6;
  int *piVar7;
  uint *puVar8;
  undefined **ppuVar9;
  int local_8;
  
  piVar7 = (int *)PTR_PTR_LOOP_676c46e0;
  do {
    if (piVar7[4] != -1) {
      puVar8 = (uint *)piVar7[2];
      piVar4 = (int *)(((int)puVar8 + (-0x18 - (int)piVar7) >> 3) * 0x1000 + piVar7[4]);
      if (puVar8 < piVar7 + 0x806) {
        do {
          if (((int)param_1 <= (int)*puVar8) && (param_1 < puVar8[1])) {
            piVar5 = (int *)FUN_676b3895(piVar4,*puVar8,param_1);
            if (piVar5 != (int *)0x0) goto LAB_676b3758;
            puVar8[1] = param_1;
          }
          puVar8 = puVar8 + 2;
          piVar4 = piVar4 + 0x400;
        } while (puVar8 < piVar7 + 0x806);
      }
      puVar1 = (uint *)piVar7[2];
      piVar4 = (int *)piVar7[4];
      for (puVar8 = (uint *)(piVar7 + 6); puVar8 < puVar1; puVar8 = puVar8 + 2) {
        if (((int)param_1 <= (int)*puVar8) && (param_1 < puVar8[1])) {
          piVar5 = (int *)FUN_676b3895(piVar4,*puVar8,param_1);
          if (piVar5 != (int *)0x0) {
LAB_676b3758:
            PTR_PTR_LOOP_676c46e0 = (undefined *)piVar7;
            *puVar8 = *puVar8 - param_1;
            piVar7[2] = (int)puVar8;
            return piVar5;
          }
          puVar8[1] = param_1;
        }
        piVar4 = piVar4 + 0x400;
      }
    }
    piVar7 = (int *)*piVar7;
    if (piVar7 == (int *)PTR_PTR_LOOP_676c46e0) {
      ppuVar9 = &PTR_LOOP_676c26c0;
      while ((ppuVar9[4] == (undefined *)0xffffffff || (ppuVar9[3] == (undefined *)0x0))) {
        ppuVar9 = (undefined **)*ppuVar9;
        if (ppuVar9 == &PTR_LOOP_676c26c0) {
          ppuVar9 = FUN_676b3395();
          if (ppuVar9 == (undefined **)0x0) {
            return (int *)0x0;
          }
          piVar7 = (int *)ppuVar9[4];
          *(char *)(piVar7 + 2) = (char)param_1;
          PTR_PTR_LOOP_676c46e0 = (undefined *)ppuVar9;
          *piVar7 = (int)piVar7 + param_1 + 8;
          piVar7[1] = 0xf0 - param_1;
          ppuVar9[6] = ppuVar9[6] + -(param_1 & 0xff);
          return piVar7 + 0x40;
        }
      }
      ppuVar2 = (undefined **)ppuVar9[3];
      local_8 = 0;
      piVar7 = (int *)(ppuVar9[4] + ((int)ppuVar2 + (-0x18 - (int)ppuVar9) >> 3) * 0x1000);
      puVar3 = *ppuVar2;
      ppuVar6 = ppuVar2;
      for (; (puVar3 == (undefined *)0xffffffff && (local_8 < 0x10)); local_8 = local_8 + 1) {
        ppuVar6 = ppuVar6 + 2;
        puVar3 = *ppuVar6;
      }
      piVar4 = (int *)VirtualAlloc(piVar7,local_8 << 0xc,0x1000,4);
      if (piVar4 != piVar7) {
        return (int *)0x0;
      }
      _memset(piVar7,local_8 << 0xc,0);
      ppuVar6 = ppuVar2;
      if (0 < local_8) {
        piVar4 = piVar7 + 1;
        do {
          *(undefined1 *)(piVar4 + 0x3d) = 0xff;
          piVar4[-1] = (int)(piVar4 + 1);
          *piVar4 = 0xf0;
          *ppuVar6 = (undefined *)0xf0;
          ppuVar6[1] = (undefined *)0xf1;
          piVar4 = piVar4 + 0x400;
          ppuVar6 = ppuVar6 + 2;
          local_8 = local_8 + -1;
        } while (local_8 != 0);
      }
      for (; (ppuVar6 < ppuVar9 + 0x806 && (*ppuVar6 != (undefined *)0xffffffff));
          ppuVar6 = ppuVar6 + 2) {
      }
      PTR_PTR_LOOP_676c46e0 = (undefined *)ppuVar9;
      ppuVar9[3] = (undefined *)(-(uint)(ppuVar6 < ppuVar9 + 0x806) & (uint)ppuVar6);
      *(char *)(piVar7 + 2) = (char)param_1;
      ppuVar9[2] = (undefined *)ppuVar2;
      *ppuVar2 = *ppuVar2 + -param_1;
      piVar7[1] = piVar7[1] - param_1;
      *piVar7 = (int)piVar7 + param_1 + 8;
      return piVar7 + 0x40;
    }
  } while( true );
}



// Function: FUN_676b3895 at 676b3895

int __cdecl FUN_676b3895(int *param_1,uint param_2,uint param_3)

{
  byte *pbVar1;
  byte *pbVar2;
  byte bVar3;
  byte *pbVar4;
  uint uVar5;
  byte *pbVar6;
  
  pbVar2 = (byte *)*param_1;
  pbVar1 = (byte *)(param_1 + 0x3e);
  bVar3 = (byte)param_3;
  if ((uint)param_1[1] < param_3) {
    pbVar6 = pbVar2;
    if (pbVar2[param_1[1]] != 0) {
      pbVar6 = pbVar2 + param_1[1];
    }
    while( true ) {
      while( true ) {
        if (pbVar1 <= pbVar6 + param_3) {
          pbVar6 = (byte *)(param_1 + 2);
          while( true ) {
            while( true ) {
              if (pbVar2 <= pbVar6) {
                return 0;
              }
              if (pbVar1 <= pbVar6 + param_3) {
                return 0;
              }
              if (*pbVar6 == 0) break;
              pbVar6 = pbVar6 + *pbVar6;
            }
            uVar5 = 1;
            pbVar4 = pbVar6;
            while (pbVar4 = pbVar4 + 1, *pbVar4 == 0) {
              uVar5 = uVar5 + 1;
            }
            if (param_3 <= uVar5) break;
            param_2 = param_2 - uVar5;
            pbVar6 = pbVar4;
            if (param_2 < param_3) {
              return 0;
            }
          }
          if (pbVar6 + param_3 < pbVar1) {
            *param_1 = (int)(pbVar6 + param_3);
            param_1[1] = uVar5 - param_3;
          }
          else {
            param_1[1] = 0;
            *param_1 = (int)(param_1 + 2);
          }
          *pbVar6 = bVar3;
          pbVar2 = pbVar6 + 8;
          goto LAB_676b39a8;
        }
        if (*pbVar6 == 0) break;
        pbVar6 = pbVar6 + *pbVar6;
      }
      uVar5 = 1;
      pbVar4 = pbVar6;
      while (pbVar4 = pbVar4 + 1, *pbVar4 == 0) {
        uVar5 = uVar5 + 1;
      }
      if (param_3 <= uVar5) break;
      if (pbVar6 == pbVar2) {
        param_1[1] = uVar5;
        pbVar6 = pbVar4;
      }
      else {
        param_2 = param_2 - uVar5;
        pbVar6 = pbVar4;
        if (param_2 < param_3) {
          return 0;
        }
      }
    }
    if (pbVar6 + param_3 < pbVar1) {
      *param_1 = (int)(pbVar6 + param_3);
      param_1[1] = uVar5 - param_3;
    }
    else {
      param_1[1] = 0;
      *param_1 = (int)(param_1 + 2);
    }
    *pbVar6 = bVar3;
    pbVar2 = pbVar6 + 8;
  }
  else {
    *pbVar2 = bVar3;
    if (pbVar2 + param_3 < pbVar1) {
      *param_1 = *param_1 + param_3;
      param_1[1] = param_1[1] - param_3;
    }
    else {
      param_1[1] = 0;
      *param_1 = (int)(param_1 + 2);
    }
    pbVar2 = pbVar2 + 8;
  }
LAB_676b39a8:
  return (int)pbVar2 * 0x10 + (int)param_1 * -0xf;
}



// Function: FUN_676b39b9 at 676b39b9

undefined4 __cdecl FUN_676b39b9(int param_1,int *param_2,byte *param_3,uint param_4)

{
  byte *pbVar1;
  int *piVar2;
  byte bVar3;
  byte *pbVar4;
  int iVar5;
  uint uVar6;
  
  uVar6 = (uint)*param_3;
  piVar2 = (int *)(param_1 + 0x18 + ((int)param_2 - *(int *)(param_1 + 0x10) >> 0xc) * 8);
  if (param_4 < uVar6) {
    *param_3 = (byte)param_4;
    *piVar2 = *piVar2 + (uVar6 - param_4);
    piVar2[1] = 0xf1;
  }
  else {
    if (param_4 <= uVar6) {
      return 0;
    }
    pbVar1 = param_3 + param_4;
    if (param_2 + 0x3e < pbVar1) {
      return 0;
    }
    for (pbVar4 = param_3 + uVar6; (pbVar4 < pbVar1 && (*pbVar4 == 0)); pbVar4 = pbVar4 + 1) {
    }
    if (pbVar4 != pbVar1) {
      return 0;
    }
    *param_3 = (byte)param_4;
    if ((param_3 <= (byte *)*param_2) && ((byte *)*param_2 < pbVar1)) {
      if (pbVar1 < param_2 + 0x3e) {
        iVar5 = 0;
        *param_2 = (int)pbVar1;
        bVar3 = *pbVar1;
        while (bVar3 == 0) {
          iVar5 = iVar5 + 1;
          bVar3 = pbVar1[iVar5];
        }
        param_2[1] = iVar5;
      }
      else {
        param_2[1] = 0;
        *param_2 = (int)(param_2 + 2);
      }
    }
    *piVar2 = *piVar2 + (uVar6 - param_4);
  }
  return 1;
}



// Function: __global_unwind2 at 676b3a64

/* Library Function - Single Match
    __global_unwind2
   
   Library: Visual Studio */

void __cdecl __global_unwind2(PVOID param_1)

{
  RtlUnwind(param_1,(PVOID)0x676b3a7c,(PEXCEPTION_RECORD)0x0,(PVOID)0x0);
  return;
}



// Function: __local_unwind2 at 676b3aa6

/* Library Function - Single Match
    __local_unwind2
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release, Visual Studio 2003 Debug, Visual
   Studio 2003 Release */

void __cdecl __local_unwind2(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  void *pvStack_1c;
  undefined1 *puStack_18;
  undefined4 local_14;
  int iStack_10;
  
  iStack_10 = param_1;
  puStack_18 = &LAB_676b3a84;
  pvStack_1c = ExceptionList;
  ExceptionList = &pvStack_1c;
  while( true ) {
    iVar1 = *(int *)(param_1 + 8);
    iVar2 = *(int *)(param_1 + 0xc);
    if ((iVar2 == -1) || (iVar2 == param_2)) break;
    local_14 = *(undefined4 *)(iVar1 + iVar2 * 0xc);
    *(undefined4 *)(param_1 + 0xc) = local_14;
    if (*(int *)(iVar1 + 4 + iVar2 * 0xc) == 0) {
      FUN_676b3b3a();
      (**(code **)(iVar1 + 8 + iVar2 * 0xc))();
    }
  }
  ExceptionList = pvStack_1c;
  return;
}



// Function: FUN_676b3b3a at 676b3b3a

void FUN_676b3b3a(void)

{
  undefined4 in_EAX;
  int unaff_EBP;
  
  DAT_676c46f0 = *(undefined4 *)(unaff_EBP + 8);
  DAT_676c46ec = in_EAX;
  DAT_676c46f4 = unaff_EBP;
  return;
}



// Function: FUN_676b3c19 at 676b3c19

void FUN_676b3c19(int param_1)

{
  __local_unwind2(*(int *)(param_1 + 0x18),*(int *)(param_1 + 0x1c));
  return;
}



// Function: FUN_676b3c34 at 676b3c34

uint __cdecl FUN_676b3c34(uint param_1,int *param_2)

{
  uint uVar1;
  uint uVar2;
  char *pcVar3;
  int *piVar4;
  byte bVar5;
  undefined3 extraout_var;
  undefined *puVar6;
  int *piVar7;
  
  piVar4 = param_2;
  uVar1 = param_2[3];
  uVar2 = param_2[4];
  if (((uVar1 & 0x82) == 0) || ((uVar1 & 0x40) != 0)) {
LAB_676b3d40:
    param_2[3] = uVar1 | 0x20;
  }
  else {
    if ((uVar1 & 1) != 0) {
      param_2[1] = 0;
      if ((uVar1 & 0x10) == 0) goto LAB_676b3d40;
      *param_2 = param_2[2];
      param_2[3] = uVar1 & 0xfffffffe;
    }
    uVar1 = param_2[3];
    param_2[1] = 0;
    param_2 = (int *)0x0;
    piVar4[3] = uVar1 & 0xffffffef | 2;
    if (((uVar1 & 0x10c) == 0) &&
       (((piVar4 != (int *)&DAT_676c2118 && (piVar4 != (int *)&DAT_676c2138)) ||
        (bVar5 = FUN_676b4aa5(uVar2), CONCAT31(extraout_var,bVar5) == 0)))) {
      FUN_676b3fcf(piVar4);
    }
    if ((*(ushort *)(piVar4 + 3) & 0x108) == 0) {
      piVar7 = (int *)0x1;
      param_2 = (int *)FUN_676b3d4c(uVar2,(char *)&param_1,1);
    }
    else {
      pcVar3 = (char *)piVar4[2];
      piVar7 = (int *)(*piVar4 - (int)pcVar3);
      *piVar4 = (int)(pcVar3 + 1);
      piVar4[1] = piVar4[6] + -1;
      if ((int)piVar7 < 1) {
        if (uVar2 == 0xffffffff) {
          puVar6 = &DAT_676c25c0;
        }
        else {
          puVar6 = (undefined *)((&DAT_676c5c80)[(int)uVar2 >> 5] + (uVar2 & 0x1f) * 0x24);
        }
        if ((puVar6[4] & 0x20) != 0) {
          FUN_676b5b88(uVar2,0,2);
        }
      }
      else {
        param_2 = (int *)FUN_676b3d4c(uVar2,pcVar3,(uint)piVar7);
      }
      *(undefined1 *)piVar4[2] = (undefined1)param_1;
    }
    if (param_2 == piVar7) {
      return param_1 & 0xff;
    }
    piVar4[3] = piVar4[3] | 0x20;
  }
  return 0xffffffff;
}



// Function: FUN_676b3d4c at 676b3d4c

int __cdecl FUN_676b3d4c(uint param_1,char *param_2,uint param_3)

{
  int iVar1;
  DWORD *pDVar2;
  
  if ((param_1 < DAT_676c5d80) &&
     ((*(byte *)((&DAT_676c5c80)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24) & 1) != 0)) {
    FUN_676b5da6(param_1);
    iVar1 = FUN_676b3db1(param_1,param_2,param_3);
    FUN_676b5e05(param_1);
    return iVar1;
  }
  pDVar2 = FUN_676b5cd3();
  *pDVar2 = 9;
  pDVar2 = FUN_676b5cdc();
  *pDVar2 = 0;
  return -1;
}



// Function: FUN_676b3db1 at 676b3db1

int __cdecl FUN_676b3db1(DWORD param_1,char *param_2,uint param_3)

{
  int *piVar1;
  char *pcVar2;
  char cVar3;
  int iVar4;
  char *pcVar5;
  BOOL BVar6;
  DWORD *pDVar7;
  char local_418 [1028];
  int local_14;
  DWORD local_10;
  DWORD local_c;
  char *local_8;
  
  local_c = 0;
  local_14 = 0;
  if (param_3 == 0) {
LAB_676b3dca:
    iVar4 = 0;
  }
  else {
    piVar1 = &DAT_676c5c80 + ((int)param_1 >> 5);
    iVar4 = (param_1 & 0x1f) * 0x24;
    if ((*(byte *)(*piVar1 + 4 + iVar4) & 0x20) != 0) {
      FUN_676b5bed(param_1,0,2);
    }
    if ((*(byte *)((undefined4 *)(*piVar1 + iVar4) + 1) & 0x80) == 0) {
      BVar6 = WriteFile(*(HANDLE *)(*piVar1 + iVar4),param_2,param_3,&local_10,(LPOVERLAPPED)0x0);
      if (BVar6 == 0) {
        param_1 = GetLastError();
      }
      else {
        local_c = local_10;
        param_1 = 0;
      }
LAB_676b3e99:
      if (local_c != 0) {
        return local_c - local_14;
      }
      if (param_1 == 0) goto LAB_676b3f0b;
      if (param_1 == 5) {
        pDVar7 = FUN_676b5cd3();
        *pDVar7 = 9;
        pDVar7 = FUN_676b5cdc();
        *pDVar7 = 5;
      }
      else {
        FUN_676b5c60(param_1);
      }
    }
    else {
      local_8 = param_2;
      param_1 = 0;
      if (param_3 != 0) {
        do {
          pcVar5 = local_418;
          do {
            if (param_3 <= (uint)((int)local_8 - (int)param_2)) break;
            pcVar2 = local_8 + 1;
            cVar3 = *local_8;
            local_8 = pcVar2;
            if (cVar3 == '\n') {
              local_14 = local_14 + 1;
              *pcVar5 = '\r';
              pcVar5 = pcVar5 + 1;
            }
            *pcVar5 = cVar3;
            pcVar5 = pcVar5 + 1;
          } while ((int)pcVar5 - (int)local_418 < 0x400);
          BVar6 = WriteFile(*(HANDLE *)(*piVar1 + iVar4),local_418,(int)pcVar5 - (int)local_418,
                            &local_10,(LPOVERLAPPED)0x0);
          if (BVar6 == 0) {
            param_1 = GetLastError();
            goto LAB_676b3e99;
          }
          local_c = local_c + local_10;
          if (((int)local_10 < (int)pcVar5 - (int)local_418) ||
             (param_3 <= (uint)((int)local_8 - (int)param_2))) goto LAB_676b3e99;
        } while( true );
      }
LAB_676b3f0b:
      if (((*(byte *)(*piVar1 + 4 + iVar4) & 0x40) != 0) && (*param_2 == '\x1a')) goto LAB_676b3dca;
      pDVar7 = FUN_676b5cd3();
      *pDVar7 = 0x1c;
      pDVar7 = FUN_676b5cdc();
      *pDVar7 = 0;
    }
    iVar4 = -1;
  }
  return iVar4;
}



// Function: FUN_676b3f3c at 676b3f3c

DWORD __cdecl FUN_676b3f3c(uint param_1)

{
  HANDLE hFile;
  BOOL BVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  int iVar4;
  
  if (DAT_676c5d80 <= param_1) {
LAB_676b3fbd:
    pDVar3 = FUN_676b5cd3();
    *pDVar3 = 9;
    return 0xffffffff;
  }
  iVar4 = (param_1 & 0x1f) * 0x24;
  if ((*(byte *)((&DAT_676c5c80)[(int)param_1 >> 5] + 4 + iVar4) & 1) == 0) goto LAB_676b3fbd;
  FUN_676b5da6(param_1);
  if ((*(byte *)((&DAT_676c5c80)[(int)param_1 >> 5] + 4 + iVar4) & 1) != 0) {
    hFile = (HANDLE)FUN_676b5d64(param_1);
    BVar1 = FlushFileBuffers(hFile);
    if (BVar1 == 0) {
      DVar2 = GetLastError();
    }
    else {
      DVar2 = 0;
    }
    if (DVar2 == 0) goto LAB_676b3fb2;
    pDVar3 = FUN_676b5cdc();
    *pDVar3 = DVar2;
  }
  pDVar3 = FUN_676b5cd3();
  *pDVar3 = 9;
  DVar2 = 0xffffffff;
LAB_676b3fb2:
  FUN_676b5e05(param_1);
  return DVar2;
}



// Function: FUN_676b3fcf at 676b3fcf

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __cdecl FUN_676b3fcf(undefined4 *param_1)

{
  void *pvVar1;
  
  _DAT_676c568c = _DAT_676c568c + 1;
  pvVar1 = _malloc(0x1000);
  param_1[2] = pvVar1;
  if (pvVar1 == (void *)0x0) {
    param_1[3] = param_1[3] | 4;
    param_1[2] = param_1 + 5;
    param_1[6] = 2;
  }
  else {
    param_1[3] = param_1[3] | 8;
    param_1[6] = 0x1000;
  }
  param_1[1] = 0;
  *param_1 = param_1[2];
  return;
}



// Function: FUN_676b4013 at 676b4013

undefined4 __cdecl FUN_676b4013(uint param_1)

{
  undefined4 uVar1;
  DWORD *pDVar2;
  
  if ((param_1 < DAT_676c5d80) &&
     ((*(byte *)((&DAT_676c5c80)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24) & 1) != 0)) {
    FUN_676b5da6(param_1);
    uVar1 = FUN_676b4070(param_1);
    FUN_676b5e05(param_1);
    return uVar1;
  }
  pDVar2 = FUN_676b5cd3();
  *pDVar2 = 9;
  pDVar2 = FUN_676b5cdc();
  *pDVar2 = 0;
  return 0xffffffff;
}



// Function: FUN_676b4070 at 676b4070

undefined4 __cdecl FUN_676b4070(uint param_1)

{
  int iVar1;
  int iVar2;
  HANDLE hObject;
  BOOL BVar3;
  DWORD DVar4;
  undefined4 uVar5;
  
  iVar1 = FUN_676b5d64(param_1);
  if (iVar1 != -1) {
    if ((param_1 == 1) || (param_1 == 2)) {
      iVar1 = FUN_676b5d64(2);
      iVar2 = FUN_676b5d64(1);
      if (iVar2 == iVar1) goto LAB_676b40be;
    }
    hObject = (HANDLE)FUN_676b5d64(param_1);
    BVar3 = CloseHandle(hObject);
    if (BVar3 == 0) {
      DVar4 = GetLastError();
      goto LAB_676b40c0;
    }
  }
LAB_676b40be:
  DVar4 = 0;
LAB_676b40c0:
  FUN_676b5ce5(param_1);
  *(undefined1 *)((&DAT_676c5c80)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24) = 0;
  if (DVar4 == 0) {
    uVar5 = 0;
  }
  else {
    FUN_676b5c60(DVar4);
    uVar5 = 0xffffffff;
  }
  return uVar5;
}



// Function: FUN_676b40f3 at 676b40f3

void __cdecl FUN_676b40f3(undefined4 *param_1)

{
  if (((param_1[3] & 0x83) != 0) && ((param_1[3] & 8) != 0)) {
    FUN_676b0201((undefined *)param_1[2]);
    *(ushort *)(param_1 + 3) = *(ushort *)(param_1 + 3) & 0xfbf7;
    *param_1 = 0;
    param_1[2] = 0;
    param_1[1] = 0;
  }
  return;
}



// Function: FUN_676b411e at 676b411e

BOOL __cdecl
FUN_676b411e(DWORD param_1,LPCSTR param_2,int param_3,LPWORD param_4,UINT param_5,LCID param_6,
            int param_7)

{
  undefined1 *puVar1;
  BOOL BVar2;
  int iVar3;
  WORD local_20 [2];
  undefined1 *local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_676bb7c8;
  puStack_10 = &LAB_676b3b5c;
  local_14 = ExceptionList;
  local_1c = &stack0xffffffc8;
  iVar3 = DAT_676c5764;
  ExceptionList = &local_14;
  puVar1 = &stack0xffffffc8;
  if (DAT_676c5764 == 0) {
    ExceptionList = &local_14;
    BVar2 = GetStringTypeW(1,L"",1,local_20);
    iVar3 = 1;
    puVar1 = local_1c;
    if (BVar2 == 0) {
      BVar2 = GetStringTypeA(0,1,"",1,local_20);
      if (BVar2 == 0) {
        ExceptionList = local_14;
        return 0;
      }
      iVar3 = 2;
      puVar1 = local_1c;
    }
  }
  local_1c = puVar1;
  DAT_676c5764 = iVar3;
  if (DAT_676c5764 != 2) {
    if (DAT_676c5764 == 1) {
      if (param_5 == 0) {
        param_5 = DAT_676c5890;
      }
      iVar3 = MultiByteToWideChar(param_5,(-(uint)(param_7 != 0) & 8) + 1,param_2,param_3,
                                  (LPWSTR)0x0,0);
      if (iVar3 != 0) {
        local_8 = 0;
        FUN_676b06a0();
        local_1c = &stack0xffffffc8;
        _memset(&stack0xffffffc8,0,iVar3 * 2);
        local_8 = 0xffffffff;
        if ((&stack0x00000000 != (undefined1 *)0x38) &&
           (iVar3 = MultiByteToWideChar(param_5,1,param_2,param_3,(LPWSTR)&stack0xffffffc8,iVar3),
           iVar3 != 0)) {
          BVar2 = GetStringTypeW(param_1,(LPCWSTR)&stack0xffffffc8,iVar3,param_4);
          ExceptionList = local_14;
          return BVar2;
        }
      }
    }
    ExceptionList = local_14;
    return 0;
  }
  if (param_6 == 0) {
    param_6 = DAT_676c5880;
  }
  BVar2 = GetStringTypeA(param_6,param_1,param_2,param_3,param_4);
  ExceptionList = local_14;
  return BVar2;
}



// Function: FUN_676b4267 at 676b4267

SIZE_T __cdecl FUN_676b4267(undefined *param_1)

{
  byte *pbVar1;
  SIZE_T SVar2;
  undefined4 local_30;
  byte *local_2c;
  uint local_28;
  SIZE_T local_24;
  byte *local_20;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_676bb7d8;
  puStack_10 = &LAB_676b3b5c;
  local_14 = ExceptionList;
  if (DAT_676c5c68 == 3) {
    ExceptionList = &local_14;
    FUN_676b20a4(9);
    local_8 = 0;
    local_20 = (byte *)FUN_676b2896((int)param_1);
    if (local_20 != (byte *)0x0) {
      local_24 = *(int *)(param_1 + -4) - 9;
    }
    SVar2 = local_24;
    local_8 = 0xffffffff;
    FUN_676b42d1();
    pbVar1 = local_20;
  }
  else {
    ExceptionList = &local_14;
    if (DAT_676c5c68 != 2) goto LAB_676b4325;
    ExceptionList = &local_14;
    FUN_676b20a4(9);
    local_8 = 1;
    local_2c = (byte *)FUN_676b35f1(param_1,&local_30,&local_28);
    if (local_2c != (byte *)0x0) {
      local_24 = (uint)*local_2c << 4;
    }
    SVar2 = local_24;
    local_8 = 0xffffffff;
    FUN_676b434c();
    pbVar1 = local_2c;
  }
  if (pbVar1 != (byte *)0x0) {
    ExceptionList = local_14;
    return SVar2;
  }
LAB_676b4325:
  SVar2 = HeapSize(DAT_676c5c64,0,param_1);
  ExceptionList = local_14;
  return SVar2;
}



// Function: FUN_676b42d1 at 676b42d1

void FUN_676b42d1(void)

{
  FUN_676b2105(9);
  return;
}



// Function: FUN_676b434c at 676b434c

void FUN_676b434c(void)

{
  FUN_676b2105(9);
  return;
}



// Function: FUN_676b4355 at 676b4355

undefined4 FUN_676b4355(void)

{
  DWORD *lpTlsValue;
  BOOL BVar1;
  DWORD DVar2;
  
  FUN_676b200f();
  DAT_676c46f8 = TlsAlloc();
  if (DAT_676c46f8 != 0xffffffff) {
    lpTlsValue = (DWORD *)FUN_676b0a68(1,0x74);
    if (lpTlsValue != (DWORD *)0x0) {
      BVar1 = TlsSetValue(DAT_676c46f8,lpTlsValue);
      if (BVar1 != 0) {
        FUN_676b43c7((int)lpTlsValue);
        DVar2 = GetCurrentThreadId();
        lpTlsValue[1] = 0xffffffff;
        *lpTlsValue = DVar2;
        return 1;
      }
    }
  }
  return 0;
}



// Function: FUN_676b43a9 at 676b43a9

void FUN_676b43a9(void)

{
  FUN_676b2038();
  if (DAT_676c46f8 != 0xffffffff) {
    TlsFree(DAT_676c46f8);
    DAT_676c46f8 = 0xffffffff;
  }
  return;
}



// Function: FUN_676b43c7 at 676b43c7

void __cdecl FUN_676b43c7(int param_1)

{
  *(undefined **)(param_1 + 0x50) = &DAT_676c4928;
  *(undefined4 *)(param_1 + 0x14) = 1;
  return;
}



// Function: FUN_676b43da at 676b43da

DWORD * FUN_676b43da(void)

{
  DWORD dwErrCode;
  DWORD *lpTlsValue;
  BOOL BVar1;
  DWORD DVar2;
  
  dwErrCode = GetLastError();
  lpTlsValue = (DWORD *)TlsGetValue(DAT_676c46f8);
  if (lpTlsValue == (DWORD *)0x0) {
    lpTlsValue = (DWORD *)FUN_676b0a68(1,0x74);
    if (lpTlsValue != (DWORD *)0x0) {
      BVar1 = TlsSetValue(DAT_676c46f8,lpTlsValue);
      if (BVar1 != 0) {
        FUN_676b43c7((int)lpTlsValue);
        DVar2 = GetCurrentThreadId();
        lpTlsValue[1] = 0xffffffff;
        *lpTlsValue = DVar2;
        goto LAB_676b4435;
      }
    }
    __amsg_exit(0x10);
  }
LAB_676b4435:
  SetLastError(dwErrCode);
  return lpTlsValue;
}



// Function: FUN_676b4441 at 676b4441

void __cdecl FUN_676b4441(undefined *param_1)

{
  if (DAT_676c46f8 != 0xffffffff) {
    if ((param_1 != (undefined *)0x0) ||
       (param_1 = (undefined *)TlsGetValue(DAT_676c46f8), param_1 != (undefined *)0x0)) {
      if (*(undefined **)(param_1 + 0x24) != (undefined *)0x0) {
        FUN_676b0201(*(undefined **)(param_1 + 0x24));
      }
      if (*(undefined **)(param_1 + 0x28) != (undefined *)0x0) {
        FUN_676b0201(*(undefined **)(param_1 + 0x28));
      }
      if (*(undefined **)(param_1 + 0x30) != (undefined *)0x0) {
        FUN_676b0201(*(undefined **)(param_1 + 0x30));
      }
      if (*(undefined **)(param_1 + 0x38) != (undefined *)0x0) {
        FUN_676b0201(*(undefined **)(param_1 + 0x38));
      }
      if (*(undefined **)(param_1 + 0x40) != (undefined *)0x0) {
        FUN_676b0201(*(undefined **)(param_1 + 0x40));
      }
      if (*(undefined **)(param_1 + 0x44) != (undefined *)0x0) {
        FUN_676b0201(*(undefined **)(param_1 + 0x44));
      }
      if (*(undefined **)(param_1 + 0x50) != &DAT_676c4928) {
        FUN_676b0201(*(undefined **)(param_1 + 0x50));
      }
      FUN_676b0201(param_1);
    }
    TlsSetValue(DAT_676c46f8,(LPVOID)0x0);
    return;
  }
  return;
}



// Function: FUN_676b44e1 at 676b44e1

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_676b44e1(void)

{
  char cVar1;
  size_t sVar2;
  undefined4 *puVar3;
  void *pvVar4;
  int iVar5;
  uint *puVar6;
  
  if (DAT_676c5d90 == 0) {
    FUN_676b61ff();
  }
  iVar5 = 0;
  for (puVar6 = DAT_676c56e0; (char)*puVar6 != '\0'; puVar6 = (uint *)((int)puVar6 + sVar2 + 1)) {
    if ((char)*puVar6 != '=') {
      iVar5 = iVar5 + 1;
    }
    sVar2 = _strlen((char *)puVar6);
  }
  puVar3 = (undefined4 *)_malloc(iVar5 * 4 + 4);
  _DAT_676c56b8 = puVar3;
  if (puVar3 == (undefined4 *)0x0) {
    __amsg_exit(9);
  }
  cVar1 = (char)*DAT_676c56e0;
  puVar6 = DAT_676c56e0;
  while (cVar1 != '\0') {
    sVar2 = _strlen((char *)puVar6);
    if ((char)*puVar6 != '=') {
      pvVar4 = _malloc(sVar2 + 1);
      *puVar3 = pvVar4;
      if (pvVar4 == (void *)0x0) {
        __amsg_exit(9);
      }
      FUN_676b0530((uint *)*puVar3,puVar6);
      puVar3 = puVar3 + 1;
    }
    puVar6 = (uint *)((int)puVar6 + sVar2 + 1);
    cVar1 = (char)*puVar6;
  }
  FUN_676b0201((undefined *)DAT_676c56e0);
  DAT_676c56e0 = (uint *)0x0;
  *puVar3 = 0;
  _DAT_676c5d8c = 1;
  return;
}



// Function: FUN_676b459a at 676b459a

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_676b459a(void)

{
  undefined4 *puVar1;
  byte *pbVar2;
  int local_c;
  int local_8;
  
  if (DAT_676c5d90 == 0) {
    FUN_676b61ff();
  }
  GetModuleFileNameA((HMODULE)0x0,&DAT_676c5768,0x104);
  _DAT_676c56c8 = &DAT_676c5768;
  pbVar2 = &DAT_676c5768;
  if (*DAT_676c5d84 != 0) {
    pbVar2 = DAT_676c5d84;
  }
  FUN_676b4633(pbVar2,(undefined4 *)0x0,(byte *)0x0,&local_8,&local_c);
  puVar1 = (undefined4 *)_malloc(local_c + local_8 * 4);
  if (puVar1 == (undefined4 *)0x0) {
    __amsg_exit(8);
  }
  FUN_676b4633(pbVar2,puVar1,(byte *)(puVar1 + local_8),&local_8,&local_c);
  _DAT_676c56b0 = puVar1;
  _DAT_676c56ac = local_8 + -1;
  return;
}



// Function: FUN_676b4633 at 676b4633

void __cdecl FUN_676b4633(byte *param_1,undefined4 *param_2,byte *param_3,int *param_4,int *param_5)

{
  byte bVar1;
  bool bVar2;
  bool bVar3;
  byte *pbVar4;
  byte *pbVar5;
  uint uVar6;
  undefined4 *puVar7;
  
  *param_5 = 0;
  *param_4 = 1;
  if (param_2 != (undefined4 *)0x0) {
    *param_2 = param_3;
    param_2 = param_2 + 1;
  }
  if (*param_1 == 0x22) {
    while( true ) {
      bVar1 = param_1[1];
      pbVar4 = param_1 + 1;
      if ((bVar1 == 0x22) || (bVar1 == 0)) break;
      if (((*(byte *)((int)&DAT_676c5b40 + bVar1 + 1) & 4) != 0) &&
         (*param_5 = *param_5 + 1, param_3 != (byte *)0x0)) {
        *param_3 = *pbVar4;
        param_3 = param_3 + 1;
        pbVar4 = param_1 + 2;
      }
      *param_5 = *param_5 + 1;
      param_1 = pbVar4;
      if (param_3 != (byte *)0x0) {
        *param_3 = *pbVar4;
        param_3 = param_3 + 1;
      }
    }
    *param_5 = *param_5 + 1;
    if (param_3 != (byte *)0x0) {
      *param_3 = 0;
      param_3 = param_3 + 1;
    }
    if (*pbVar4 == 0x22) {
      pbVar4 = param_1 + 2;
    }
  }
  else {
    do {
      *param_5 = *param_5 + 1;
      if (param_3 != (byte *)0x0) {
        *param_3 = *param_1;
        param_3 = param_3 + 1;
      }
      bVar1 = *param_1;
      pbVar4 = param_1 + 1;
      if ((*(byte *)((int)&DAT_676c5b40 + bVar1 + 1) & 4) != 0) {
        *param_5 = *param_5 + 1;
        if (param_3 != (byte *)0x0) {
          *param_3 = *pbVar4;
          param_3 = param_3 + 1;
        }
        pbVar4 = param_1 + 2;
      }
      if (bVar1 == 0x20) break;
      if (bVar1 == 0) goto LAB_676b46de;
      param_1 = pbVar4;
    } while (bVar1 != 9);
    if (bVar1 == 0) {
LAB_676b46de:
      pbVar4 = pbVar4 + -1;
    }
    else if (param_3 != (byte *)0x0) {
      param_3[-1] = 0;
    }
  }
  bVar2 = false;
  puVar7 = param_2;
  while (*pbVar4 != 0) {
    for (; (*pbVar4 == 0x20 || (*pbVar4 == 9)); pbVar4 = pbVar4 + 1) {
    }
    if (*pbVar4 == 0) break;
    if (puVar7 != (undefined4 *)0x0) {
      *puVar7 = param_3;
      puVar7 = puVar7 + 1;
      param_2 = puVar7;
    }
    *param_4 = *param_4 + 1;
    while( true ) {
      bVar3 = true;
      uVar6 = 0;
      for (; *pbVar4 == 0x5c; pbVar4 = pbVar4 + 1) {
        uVar6 = uVar6 + 1;
      }
      if (*pbVar4 == 0x22) {
        pbVar5 = pbVar4;
        if ((uVar6 & 1) == 0) {
          if ((!bVar2) || (pbVar5 = pbVar4 + 1, pbVar4[1] != 0x22)) {
            bVar3 = false;
            pbVar5 = pbVar4;
          }
          bVar2 = !bVar2;
          puVar7 = param_2;
        }
        uVar6 = uVar6 >> 1;
        pbVar4 = pbVar5;
      }
      for (; uVar6 != 0; uVar6 = uVar6 - 1) {
        if (param_3 != (byte *)0x0) {
          *param_3 = 0x5c;
          param_3 = param_3 + 1;
        }
        *param_5 = *param_5 + 1;
      }
      bVar1 = *pbVar4;
      if ((bVar1 == 0) || ((!bVar2 && ((bVar1 == 0x20 || (bVar1 == 9)))))) break;
      if (bVar3) {
        if (param_3 == (byte *)0x0) {
          if ((*(byte *)((int)&DAT_676c5b40 + bVar1 + 1) & 4) != 0) {
            pbVar4 = pbVar4 + 1;
            *param_5 = *param_5 + 1;
          }
        }
        else {
          if ((*(byte *)((int)&DAT_676c5b40 + bVar1 + 1) & 4) != 0) {
            *param_3 = bVar1;
            param_3 = param_3 + 1;
            pbVar4 = pbVar4 + 1;
            *param_5 = *param_5 + 1;
          }
          *param_3 = *pbVar4;
          param_3 = param_3 + 1;
        }
        *param_5 = *param_5 + 1;
      }
      pbVar4 = pbVar4 + 1;
    }
    if (param_3 != (byte *)0x0) {
      *param_3 = 0;
      param_3 = param_3 + 1;
    }
    *param_5 = *param_5 + 1;
  }
  if (puVar7 != (undefined4 *)0x0) {
    *puVar7 = 0;
  }
  *param_4 = *param_4 + 1;
  return;
}



// Function: FUN_676b47e7 at 676b47e7

LPSTR FUN_676b47e7(void)

{
  char cVar1;
  WCHAR WVar2;
  WCHAR *pWVar3;
  WCHAR *pWVar4;
  int iVar5;
  size_t _Size;
  LPSTR pCVar6;
  char *pcVar7;
  LPWCH lpWideCharStr;
  LPCH pCVar9;
  LPSTR local_8;
  char *pcVar8;
  
  lpWideCharStr = (LPWCH)0x0;
  pCVar9 = (LPCH)0x0;
  if (DAT_676c586c == 0) {
    lpWideCharStr = GetEnvironmentStringsW();
    if (lpWideCharStr != (LPWCH)0x0) {
      DAT_676c586c = 1;
LAB_676b483e:
      if ((lpWideCharStr == (LPWCH)0x0) &&
         (lpWideCharStr = GetEnvironmentStringsW(), lpWideCharStr == (LPWCH)0x0)) {
        return (LPSTR)0x0;
      }
      WVar2 = *lpWideCharStr;
      pWVar4 = lpWideCharStr;
      while (WVar2 != L'\0') {
        do {
          pWVar3 = pWVar4;
          pWVar4 = pWVar3 + 1;
        } while (*pWVar4 != L'\0');
        pWVar4 = pWVar3 + 2;
        WVar2 = *pWVar4;
      }
      iVar5 = ((int)pWVar4 - (int)lpWideCharStr >> 1) + 1;
      _Size = WideCharToMultiByte(0,0,lpWideCharStr,iVar5,(LPSTR)0x0,0,(LPCSTR)0x0,(LPBOOL)0x0);
      local_8 = (LPSTR)0x0;
      if (((_Size != 0) && (pCVar6 = (LPSTR)_malloc(_Size), pCVar6 != (LPSTR)0x0)) &&
         (iVar5 = WideCharToMultiByte(0,0,lpWideCharStr,iVar5,pCVar6,_Size,(LPCSTR)0x0,(LPBOOL)0x0),
         local_8 = pCVar6, iVar5 == 0)) {
        FUN_676b0201(pCVar6);
        local_8 = (LPSTR)0x0;
      }
      FreeEnvironmentStringsW(lpWideCharStr);
      return local_8;
    }
    pCVar9 = GetEnvironmentStrings();
    if (pCVar9 == (LPCH)0x0) {
      return (LPSTR)0x0;
    }
    DAT_676c586c = 2;
  }
  else {
    if (DAT_676c586c == 1) goto LAB_676b483e;
    if (DAT_676c586c != 2) {
      return (LPSTR)0x0;
    }
  }
  if ((pCVar9 == (LPCH)0x0) && (pCVar9 = GetEnvironmentStrings(), pCVar9 == (LPCH)0x0)) {
    return (LPSTR)0x0;
  }
  cVar1 = *pCVar9;
  pcVar7 = pCVar9;
  while (cVar1 != '\0') {
    do {
      pcVar8 = pcVar7;
      pcVar7 = pcVar8 + 1;
    } while (*pcVar7 != '\0');
    pcVar7 = pcVar8 + 2;
    cVar1 = *pcVar7;
  }
  pCVar6 = (LPSTR)_malloc((size_t)(pcVar7 + (1 - (int)pCVar9)));
  if (pCVar6 == (LPSTR)0x0) {
    pCVar6 = (LPSTR)0x0;
  }
  else {
    FUN_676b06d0((undefined4 *)pCVar6,(undefined4 *)pCVar9,(uint)(pcVar7 + (1 - (int)pCVar9)));
  }
  FreeEnvironmentStringsA(pCVar9);
  return pCVar6;
}



// Function: FUN_676b4919 at 676b4919

void FUN_676b4919(void)

{
  if ((DAT_676c56e8 == 1) || ((DAT_676c56e8 == 0 && (DAT_676c56ec == 1)))) {
    FUN_676b4952(0xfc);
    if (DAT_676c5870 != (code *)0x0) {
      (*DAT_676c5870)();
    }
    FUN_676b4952(0xff);
  }
  return;
}



// Function: FUN_676b4952 at 676b4952

void __cdecl FUN_676b4952(DWORD param_1)

{
  undefined4 *puVar1;
  DWORD *pDVar2;
  DWORD DVar3;
  size_t sVar4;
  HANDLE hFile;
  int iVar5;
  uint *_Dest;
  undefined1 auStackY_1e3 [7];
  LPCVOID lpBuffer;
  LPOVERLAPPED lpOverlapped;
  uint local_1a8 [65];
  uint local_a4 [40];
  
  iVar5 = 0;
  pDVar2 = &DAT_676c4700;
  do {
    if (param_1 == *pDVar2) break;
    pDVar2 = pDVar2 + 2;
    iVar5 = iVar5 + 1;
  } while (pDVar2 < &DAT_676c4790);
  if (param_1 == (&DAT_676c4700)[iVar5 * 2]) {
    if ((DAT_676c56e8 == 1) || ((DAT_676c56e8 == 0 && (DAT_676c56ec == 1)))) {
      pDVar2 = &param_1;
      puVar1 = (undefined4 *)(iVar5 * 8 + 0x676c4704);
      lpOverlapped = (LPOVERLAPPED)0x0;
      sVar4 = _strlen((char *)*puVar1);
      lpBuffer = (LPCVOID)*puVar1;
      hFile = GetStdHandle(0xfffffff4);
      WriteFile(hFile,lpBuffer,sVar4,pDVar2,lpOverlapped);
    }
    else if (param_1 != 0xfc) {
      DVar3 = GetModuleFileNameA((HMODULE)0x0,(LPSTR)local_1a8,0x104);
      if (DVar3 == 0) {
        FUN_676b0530(local_1a8,(uint *)"<program name unknown>");
      }
      _Dest = local_1a8;
      sVar4 = _strlen((char *)local_1a8);
      if (0x3c < sVar4 + 1) {
        sVar4 = _strlen((char *)local_1a8);
        _Dest = (uint *)(auStackY_1e3 + sVar4);
        _strncpy((char *)_Dest,"...",3);
      }
      FUN_676b0530(local_a4,(uint *)"Runtime Error!\n\nProgram: ");
      FUN_676b0540(local_a4,_Dest);
      FUN_676b0540(local_a4,(uint *)&DAT_676bbaa4);
      FUN_676b0540(local_a4,*(uint **)(iVar5 * 8 + 0x676c4704));
      auStackY_1e3._3_4_ = 0x676b4a76;
      FUN_676b621b(local_a4,"Microsoft Visual C++ Runtime Library",0x12010);
    }
  }
  return;
}



// Function: FUN_676b4aa5 at 676b4aa5

byte __cdecl FUN_676b4aa5(uint param_1)

{
  if (DAT_676c5d80 <= param_1) {
    return 0;
  }
  return *(byte *)((&DAT_676c5c80)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24) & 0x40;
}



// Function: _strlen at 676b4ad0

/* Library Function - Single Match
    _strlen
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

size_t __cdecl _strlen(char *_Str)

{
  uint uVar1;
  uint *puVar2;
  uint *puVar3;
  
  uVar1 = (uint)_Str & 3;
  puVar2 = (uint *)_Str;
  while (uVar1 != 0) {
    uVar1 = *puVar2;
    puVar2 = (uint *)((int)puVar2 + 1);
    if ((char)uVar1 == '\0') goto LAB_676b4b23;
    uVar1 = (uint)puVar2 & 3;
  }
  do {
    do {
      puVar3 = puVar2;
      puVar2 = puVar3 + 1;
    } while (((*puVar3 ^ 0xffffffff ^ *puVar3 + 0x7efefeff) & 0x81010100) == 0);
    uVar1 = *puVar3;
    if ((char)uVar1 == '\0') {
      return (int)puVar3 - (int)_Str;
    }
    if ((char)(uVar1 >> 8) == '\0') {
      return (size_t)((int)puVar3 + (1 - (int)_Str));
    }
    if ((uVar1 & 0xff0000) == 0) {
      return (size_t)((int)puVar3 + (2 - (int)_Str));
    }
  } while ((uVar1 & 0xff000000) != 0);
LAB_676b4b23:
  return (size_t)((int)puVar2 + (-1 - (int)_Str));
}



// Function: FUN_676b4b4b at 676b4b4b

LPSTR __cdecl FUN_676b4b4b(LPSTR param_1,WCHAR param_2)

{
  LPSTR pCVar1;
  bool bVar2;
  
  InterlockedIncrement((LONG *)&DAT_676c5a18);
  bVar2 = DAT_676c5a14 != 0;
  if (bVar2) {
    InterlockedDecrement((LONG *)&DAT_676c5a18);
    FUN_676b20a4(0x13);
  }
  pCVar1 = FUN_676b4ba4(param_1,param_2);
  if (bVar2) {
    FUN_676b2105(0x13);
  }
  else {
    InterlockedDecrement((LONG *)&DAT_676c5a18);
  }
  return pCVar1;
}



// Function: FUN_676b4ba4 at 676b4ba4

LPSTR __cdecl FUN_676b4ba4(LPSTR param_1,WCHAR param_2)

{
  LPSTR pCVar1;
  DWORD *pDVar2;
  
  pCVar1 = param_1;
  if (param_1 == (LPSTR)0x0) {
    return param_1;
  }
  if (DAT_676c5880 == 0) {
    if ((ushort)param_2 < 0x100) {
      *param_1 = (CHAR)param_2;
      return (LPSTR)0x1;
    }
  }
  else {
    param_1 = (LPSTR)0x0;
    pCVar1 = (LPSTR)WideCharToMultiByte(DAT_676c5890,0x220,&param_2,1,pCVar1,DAT_676c259c,
                                        (LPCSTR)0x0,(LPBOOL)&param_1);
    if ((pCVar1 != (LPSTR)0x0) && (param_1 == (LPSTR)0x0)) {
      return pCVar1;
    }
  }
  pDVar2 = FUN_676b5cd3();
  *pDVar2 = 0x2a;
  return (LPSTR)0xffffffff;
}



// Function: __aullrem at 676b4c10

/* Library Function - Single Match
    __aullrem
   
   Library: Visual Studio */

undefined8 __aullrem(uint param_1,uint param_2,uint param_3,uint param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  bool bVar11;
  
  uVar3 = param_1;
  uVar4 = param_4;
  uVar9 = param_2;
  uVar10 = param_3;
  if (param_4 == 0) {
    iVar6 = (int)(((ulonglong)param_2 % (ulonglong)param_3 << 0x20 | (ulonglong)param_1) %
                 (ulonglong)param_3);
    iVar7 = 0;
  }
  else {
    do {
      uVar5 = uVar4 >> 1;
      uVar10 = uVar10 >> 1 | (uint)((uVar4 & 1) != 0) << 0x1f;
      uVar8 = uVar9 >> 1;
      uVar3 = uVar3 >> 1 | (uint)((uVar9 & 1) != 0) << 0x1f;
      uVar4 = uVar5;
      uVar9 = uVar8;
    } while (uVar5 != 0);
    uVar1 = CONCAT44(uVar8,uVar3) / (ulonglong)uVar10;
    uVar3 = (int)uVar1 * param_4;
    lVar2 = (uVar1 & 0xffffffff) * (ulonglong)param_3;
    uVar9 = (uint)((ulonglong)lVar2 >> 0x20);
    uVar4 = (uint)lVar2;
    uVar10 = uVar9 + uVar3;
    if (((CARRY4(uVar9,uVar3)) || (param_2 < uVar10)) || ((param_2 <= uVar10 && (param_1 < uVar4))))
    {
      bVar11 = uVar4 < param_3;
      uVar4 = uVar4 - param_3;
      uVar10 = (uVar10 - param_4) - (uint)bVar11;
    }
    iVar6 = -(uVar4 - param_1);
    iVar7 = -(uint)(uVar4 - param_1 != 0) - ((uVar10 - param_2) - (uint)(uVar4 < param_1));
  }
  return CONCAT44(iVar7,iVar6);
}



// Function: FUN_676b4c85 at 676b4c85

uint __thiscall FUN_676b4c85(void *this,uint param_1,uint param_2)

{
  uint uVar1;
  undefined2 in_FPUControlWord;
  undefined4 local_8;
  
  local_8 = CONCAT22((short)((uint)this >> 0x10),in_FPUControlWord);
  uVar1 = FUN_676b4cd0(local_8);
  uVar1 = uVar1 & ~param_2 | param_1 & param_2;
  FUN_676b4d62(uVar1);
  return uVar1;
}



// Function: FUN_676b4cba at 676b4cba

void __thiscall FUN_676b4cba(void *this,uint param_1,uint param_2)

{
  FUN_676b4c85(this,param_1,param_2 & 0xfff7ffff);
  return;
}



// Function: FUN_676b4cd0 at 676b4cd0

uint __cdecl FUN_676b4cd0(uint param_1)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = 0;
  if ((param_1 & 1) != 0) {
    uVar1 = 0x10;
  }
  if ((param_1 & 4) != 0) {
    uVar1 = uVar1 | 8;
  }
  if ((param_1 & 8) != 0) {
    uVar1 = uVar1 | 4;
  }
  if ((param_1 & 0x10) != 0) {
    uVar1 = uVar1 | 2;
  }
  if ((param_1 & 0x20) != 0) {
    uVar1 = uVar1 | 1;
  }
  if ((param_1 & 2) != 0) {
    uVar1 = uVar1 | 0x80000;
  }
  uVar2 = param_1 & 0xc00;
  if (uVar2 != 0) {
    if (uVar2 == 0x400) {
      uVar1 = uVar1 | 0x100;
    }
    else if (uVar2 == 0x800) {
      uVar1 = uVar1 | 0x200;
    }
    else if (uVar2 == 0xc00) {
      uVar1 = uVar1 | 0x300;
    }
  }
  if ((param_1 & 0x300) == 0) {
    uVar1 = uVar1 | 0x20000;
  }
  else if ((param_1 & 0x300) == 0x200) {
    uVar1 = uVar1 | 0x10000;
  }
  if ((param_1 & 0x1000) != 0) {
    uVar1 = uVar1 | 0x40000;
  }
  return uVar1;
}



// Function: FUN_676b4d62 at 676b4d62

uint __cdecl FUN_676b4d62(uint param_1)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = (uint)((param_1 & 0x10) != 0);
  if ((param_1 & 8) != 0) {
    uVar1 = uVar1 | 4;
  }
  if ((param_1 & 4) != 0) {
    uVar1 = uVar1 | 8;
  }
  if ((param_1 & 2) != 0) {
    uVar1 = uVar1 | 0x10;
  }
  if ((param_1 & 1) != 0) {
    uVar1 = uVar1 | 0x20;
  }
  if ((param_1 & 0x80000) != 0) {
    uVar1 = uVar1 | 2;
  }
  uVar2 = param_1 & 0x300;
  if (uVar2 != 0) {
    if (uVar2 == 0x100) {
      uVar1 = uVar1 | 0x400;
    }
    else if (uVar2 == 0x200) {
      uVar1 = uVar1 | 0x800;
    }
    else if (uVar2 == 0x300) {
      uVar1 = uVar1 | 0xc00;
    }
  }
  if ((param_1 & 0x30000) == 0) {
    uVar1 = uVar1 | 0x300;
  }
  else if ((param_1 & 0x30000) == 0x10000) {
    uVar1 = uVar1 | 0x200;
  }
  if ((param_1 & 0x40000) != 0) {
    uVar1 = uVar1 | 0x1000;
  }
  return uVar1;
}



// Function: FUN_676b4deb at 676b4deb

uint __cdecl FUN_676b4deb(uint param_1)

{
  void *extraout_ECX;
  bool bVar1;
  void *this;
  
  if (DAT_676c5880 == 0) {
    if ((0x40 < (int)param_1) && ((int)param_1 < 0x5b)) {
      return param_1 + 0x20;
    }
  }
  else {
    InterlockedIncrement((LONG *)&DAT_676c5a18);
    bVar1 = DAT_676c5a14 != 0;
    this = extraout_ECX;
    if (bVar1) {
      InterlockedDecrement((LONG *)&DAT_676c5a18);
      this = (void *)0x13;
      FUN_676b20a4(0x13);
    }
    param_1 = FUN_676b4e5a(this,param_1);
    if (bVar1) {
      FUN_676b2105(0x13);
    }
    else {
      InterlockedDecrement((LONG *)&DAT_676c5a18);
    }
  }
  return param_1;
}



// Function: FUN_676b4e5a at 676b4e5a

uint __thiscall FUN_676b4e5a(void *this,uint param_1)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  void *local_8;
  
  uVar1 = param_1;
  if (DAT_676c5880 == 0) {
    if ((0x40 < (int)param_1) && ((int)param_1 < 0x5b)) {
      uVar1 = param_1 + 0x20;
    }
  }
  else {
    iVar3 = 1;
    local_8 = this;
    if ((int)param_1 < 0x100) {
      if (DAT_676c259c < 2) {
        uVar2 = (byte)PTR_DAT_676c2390[param_1 * 2] & 1;
      }
      else {
        uVar2 = FUN_676b0620(this,param_1,1);
      }
      if (uVar2 == 0) {
        return uVar1;
      }
    }
    if ((PTR_DAT_676c2390[((int)uVar1 >> 8 & 0xffU) * 2 + 1] & 0x80) == 0) {
      param_1 = CONCAT31((int3)(param_1 >> 8),(char)uVar1) & 0xffff00ff;
    }
    else {
      uVar2 = param_1 >> 0x10;
      param_1._0_2_ = CONCAT11((char)uVar1,(char)(uVar1 >> 8));
      param_1 = CONCAT22((short)uVar2,(undefined2)param_1) & 0xff00ffff;
      iVar3 = 2;
    }
    iVar3 = FUN_676b63ae(DAT_676c5880,0x100,(char *)&param_1,iVar3,(LPWSTR)&local_8,3,0,1);
    if (iVar3 != 0) {
      if (iVar3 == 1) {
        uVar1 = (uint)local_8 & 0xff;
      }
      else {
        uVar1 = (uint)local_8 & 0xffff;
      }
    }
  }
  return uVar1;
}



// Function: FUN_676b4f25 at 676b4f25

undefined4 __cdecl FUN_676b4f25(int param_1,int param_2)

{
  int *piVar1;
  int iVar2;
  
  if ((*(uint *)(param_1 + (param_2 / 0x20) * 4) & ~(-1 << (0x1fU - (char)(param_2 % 0x20) & 0x1f)))
      != 0) {
    return 0;
  }
  iVar2 = param_2 / 0x20 + 1;
  if (iVar2 < 3) {
    piVar1 = (int *)(param_1 + iVar2 * 4);
    do {
      if (*piVar1 != 0) {
        return 0;
      }
      iVar2 = iVar2 + 1;
      piVar1 = piVar1 + 1;
    } while (iVar2 < 3);
  }
  return 1;
}



// Function: FUN_676b4f6e at 676b4f6e

void __cdecl FUN_676b4f6e(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  uint *puVar3;
  
  puVar3 = (uint *)(param_1 + (param_2 / 0x20) * 4);
  iVar1 = FUN_676b65fd(*puVar3,1 << (0x1fU - (char)(param_2 % 0x20) & 0x1f),puVar3);
  iVar2 = param_2 / 0x20 + -1;
  if (-1 < iVar2) {
    puVar3 = (uint *)(param_1 + iVar2 * 4);
    do {
      if (iVar1 == 0) {
        return;
      }
      iVar1 = FUN_676b65fd(*puVar3,1,puVar3);
      iVar2 = iVar2 + -1;
      puVar3 = puVar3 + -1;
    } while (-1 < iVar2);
  }
  return;
}



// Function: FUN_676b4fc4 at 676b4fc4

undefined4 __cdecl FUN_676b4fc4(int param_1,int param_2)

{
  uint *puVar1;
  int iVar2;
  byte bVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined4 local_8;
  
  local_8 = 0;
  puVar1 = (uint *)(param_1 + (param_2 / 0x20) * 4);
  bVar3 = 0x1f - (char)(param_2 % 0x20);
  if (((*puVar1 & 1 << (bVar3 & 0x1f)) != 0) &&
     (iVar2 = FUN_676b4f25(param_1,param_2 + 1), iVar2 == 0)) {
    local_8 = FUN_676b4f6e(param_1,param_2 + -1);
  }
  *puVar1 = *puVar1 & -1 << (bVar3 & 0x1f);
  iVar2 = param_2 / 0x20 + 1;
  if (iVar2 < 3) {
    puVar5 = (undefined4 *)(param_1 + iVar2 * 4);
    for (iVar4 = 3 - iVar2; iVar4 != 0; iVar4 = iVar4 + -1) {
      *puVar5 = 0;
      puVar5 = puVar5 + 1;
    }
  }
  return local_8;
}



// Function: FUN_676b5050 at 676b5050

void __cdecl FUN_676b5050(int param_1,undefined4 *param_2)

{
  int iVar1;
  int iVar2;
  
  iVar1 = param_1 - (int)param_2;
  iVar2 = 3;
  do {
    *(undefined4 *)(iVar1 + (int)param_2) = *param_2;
    param_2 = param_2 + 1;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  return;
}



// Function: FUN_676b506b at 676b506b

void __cdecl FUN_676b506b(undefined4 *param_1)

{
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  return;
}



// Function: FUN_676b5077 at 676b5077

undefined4 __cdecl FUN_676b5077(int *param_1)

{
  int iVar1;
  
  iVar1 = 0;
  do {
    if (*param_1 != 0) {
      return 0;
    }
    iVar1 = iVar1 + 1;
    param_1 = param_1 + 1;
  } while (iVar1 < 3);
  return 1;
}



// Function: FUN_676b5092 at 676b5092

void __cdecl FUN_676b5092(uint *param_1,uint param_2)

{
  uint uVar1;
  int iVar2;
  byte bVar3;
  int iVar4;
  int iVar5;
  uint *puVar6;
  int local_8;
  
  local_8 = 3;
  iVar2 = (int)param_2 / 0x20;
  iVar5 = (int)param_2 % 0x20;
  param_2 = 0;
  bVar3 = (byte)iVar5;
  puVar6 = param_1;
  do {
    uVar1 = *puVar6;
    *puVar6 = uVar1 >> (bVar3 & 0x1f) | param_2;
    puVar6 = puVar6 + 1;
    param_2 = (uVar1 & ~(-1 << (bVar3 & 0x1f))) << (0x20 - bVar3 & 0x1f);
    local_8 = local_8 + -1;
  } while (local_8 != 0);
  iVar5 = 2;
  iVar4 = 8;
  do {
    if (iVar5 < iVar2) {
      *(undefined4 *)(iVar4 + (int)param_1) = 0;
    }
    else {
      *(undefined4 *)(iVar4 + (int)param_1) = *(undefined4 *)(iVar4 + iVar2 * -4 + (int)param_1);
    }
    iVar5 = iVar5 + -1;
    iVar4 = iVar4 + -4;
  } while (-1 < iVar4);
  return;
}



// Function: FUN_676b511f at 676b511f

undefined4 __cdecl FUN_676b511f(ushort *param_1,uint *param_2,int *param_3)

{
  ushort uVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  undefined4 uVar5;
  undefined4 local_1c [3];
  uint local_10;
  uint local_c;
  int local_8;
  
  uVar1 = param_1[5];
  local_10 = *(uint *)(param_1 + 3);
  local_c = *(uint *)(param_1 + 1);
  uVar3 = uVar1 & 0x7fff;
  iVar4 = uVar3 - 0x3fff;
  local_8 = (uint)*param_1 << 0x10;
  if (iVar4 == -0x3fff) {
    iVar4 = 0;
    iVar2 = FUN_676b5077((int *)&local_10);
    if (iVar2 != 0) {
LAB_676b524b:
      uVar5 = 0;
      goto LAB_676b524d;
    }
    FUN_676b506b(&local_10);
  }
  else {
    FUN_676b5050((int)local_1c,&local_10);
    iVar2 = FUN_676b4fc4((int)&local_10,param_3[2]);
    if (iVar2 != 0) {
      iVar4 = uVar3 - 0x3ffe;
    }
    iVar2 = param_3[1];
    if (iVar4 < iVar2 - param_3[2]) {
      FUN_676b506b(&local_10);
    }
    else {
      if (iVar2 < iVar4) {
        if (*param_3 <= iVar4) {
          FUN_676b506b(&local_10);
          local_10 = local_10 | 0x80000000;
          FUN_676b5092(&local_10,param_3[3]);
          iVar4 = param_3[5] + *param_3;
          uVar5 = 1;
          goto LAB_676b524d;
        }
        local_10 = local_10 & 0x7fffffff;
        iVar4 = param_3[5] + iVar4;
        FUN_676b5092(&local_10,param_3[3]);
        goto LAB_676b524b;
      }
      FUN_676b5050((int)&local_10,local_1c);
      FUN_676b5092(&local_10,iVar2 - iVar4);
      FUN_676b4fc4((int)&local_10,param_3[2]);
      FUN_676b5092(&local_10,param_3[3] + 1);
    }
  }
  iVar4 = 0;
  uVar5 = 2;
LAB_676b524d:
  local_10 = iVar4 << (0x1fU - (char)param_3[3] & 0x1f) |
             -(uint)((uVar1 & 0x8000) != 0) & 0x80000000 | local_10;
  if (param_3[4] == 0x40) {
    param_2[1] = local_10;
    *param_2 = local_c;
  }
  else if (param_3[4] == 0x20) {
    *param_2 = local_10;
  }
  return uVar5;
}



// Function: FUN_676b528b at 676b528b

void __cdecl FUN_676b528b(ushort *param_1,uint *param_2)

{
  FUN_676b511f(param_1,param_2,(int *)&DAT_676c4790);
  return;
}



// Function: FUN_676b52a1 at 676b52a1

void __cdecl FUN_676b52a1(ushort *param_1,uint *param_2)

{
  FUN_676b511f(param_1,param_2,(int *)&DAT_676c47a8);
  return;
}



// Function: FUN_676b52b7 at 676b52b7

void __thiscall FUN_676b52b7(void *this,uint *param_1,byte *param_2)

{
  ushort local_10 [6];
  
  FUN_676b679e(this,local_10,(int *)&param_2,param_2,0,0,0,0);
  FUN_676b528b(local_10,param_1);
  return;
}



// Function: FUN_676b52e4 at 676b52e4

void __thiscall FUN_676b52e4(void *this,uint *param_1,byte *param_2)

{
  ushort local_10 [6];
  
  FUN_676b679e(this,local_10,(int *)&param_2,param_2,0,0,0,0);
  FUN_676b52a1(local_10,param_1);
  return;
}



// Function: FUN_676b5311 at 676b5311

void __cdecl FUN_676b5311(char *param_1,int param_2,int param_3)

{
  char *_Str;
  char *pcVar1;
  char *pcVar2;
  size_t sVar3;
  char *pcVar4;
  char cVar5;
  
  pcVar1 = param_1;
  pcVar4 = *(char **)(param_3 + 0xc);
  _Str = param_1 + 1;
  *param_1 = '0';
  pcVar2 = _Str;
  if (0 < param_2) {
    param_1 = (char *)param_2;
    param_2 = 0;
    do {
      cVar5 = *pcVar4;
      if (cVar5 == '\0') {
        cVar5 = '0';
      }
      else {
        pcVar4 = pcVar4 + 1;
      }
      *pcVar2 = cVar5;
      pcVar2 = pcVar2 + 1;
      param_1 = param_1 + -1;
    } while (param_1 != (char *)0x0);
  }
  *pcVar2 = '\0';
  if ((-1 < param_2) && ('4' < *pcVar4)) {
    while (pcVar2 = pcVar2 + -1, *pcVar2 == '9') {
      *pcVar2 = '0';
    }
    *pcVar2 = *pcVar2 + '\x01';
  }
  if (*pcVar1 == '1') {
    *(int *)(param_3 + 4) = *(int *)(param_3 + 4) + 1;
  }
  else {
    sVar3 = _strlen(_Str);
    FUN_676b54a0((undefined4 *)pcVar1,(undefined4 *)_Str,sVar3 + 1);
  }
  return;
}



// Function: FUN_676b5388 at 676b5388

int * __cdecl FUN_676b5388(undefined4 param_1,undefined4 param_2,int *param_3,uint *param_4)

{
  int *piVar1;
  uint *puVar2;
  int iVar3;
  undefined4 in_stack_ffffffbc;
  undefined2 uVar4;
  short local_2c;
  char local_2a;
  uint local_28 [6];
  uint local_10;
  uint uStack_c;
  undefined2 uStack_8;
  
  uVar4 = (undefined2)((uint)in_stack_ffffffbc >> 0x10);
  FUN_676b53e4(&local_10,&param_1);
  iVar3 = FUN_676b6c6f(local_10,uStack_c,CONCAT22(uVar4,uStack_8),0x11,0,&local_2c);
  puVar2 = param_4;
  piVar1 = param_3;
  param_3[2] = iVar3;
  *param_3 = (int)local_2a;
  param_3[1] = (int)local_2c;
  FUN_676b0530(param_4,local_28);
  piVar1[3] = (int)puVar2;
  return piVar1;
}



// Function: FUN_676b53e4 at 676b53e4

void __cdecl FUN_676b53e4(uint *param_1,uint *param_2)

{
  ushort uVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  uint local_8;
  
  uVar1 = *(ushort *)((int)param_2 + 6);
  uVar3 = (uVar1 & 0x7ff0) >> 4;
  uVar2 = *param_2;
  local_8 = 0x80000000;
  if (uVar3 == 0) {
    if (((param_2[1] & 0xfffff) == 0) && (uVar2 == 0)) {
      param_1[1] = 0;
      *param_1 = 0;
      *(undefined2 *)(param_1 + 2) = 0;
      return;
    }
    iVar4 = 0x3c01;
    local_8 = 0;
  }
  else if (uVar3 == 0x7ff) {
    iVar4 = 0x7fff;
  }
  else {
    iVar4 = uVar3 + 0x3c00;
  }
  local_8 = uVar2 >> 0x15 | (param_2[1] & 0xfffff) << 0xb | local_8;
  param_1[1] = local_8;
  *param_1 = uVar2 << 0xb;
  while ((local_8 & 0x80000000) == 0) {
    local_8 = *param_1 >> 0x1f | local_8 * 2;
    *param_1 = *param_1 * 2;
    param_1[1] = local_8;
    iVar4 = iVar4 + 0xffff;
  }
  *(ushort *)(param_1 + 2) = uVar1 & 0x8000 | (ushort)iVar4;
  return;
}



// Function: FUN_676b54a0 at 676b54a0

undefined4 * __cdecl FUN_676b54a0(undefined4 *param_1,undefined4 *param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  
  if ((param_2 < param_1) && (param_1 < (undefined4 *)(param_3 + (int)param_2))) {
    puVar3 = (undefined4 *)((param_3 - 4) + (int)param_2);
    puVar4 = (undefined4 *)((param_3 - 4) + (int)param_1);
    if (((uint)puVar4 & 3) == 0) {
      uVar1 = param_3 >> 2;
      uVar2 = param_3 & 3;
      if (7 < uVar1) {
        for (; uVar1 != 0; uVar1 = uVar1 - 1) {
          *puVar4 = *puVar3;
          puVar3 = puVar3 + -1;
          puVar4 = puVar4 + -1;
        }
        switch(uVar2) {
        case 0:
          return param_1;
        case 2:
          goto switchD_676b5657_caseD_2;
        case 3:
          goto switchD_676b5657_caseD_3;
        }
        goto switchD_676b5657_caseD_1;
      }
    }
    else {
      switch(param_3) {
      case 0:
        goto switchD_676b5657_caseD_0;
      case 1:
        goto switchD_676b5657_caseD_1;
      case 2:
        goto switchD_676b5657_caseD_2;
      case 3:
        goto switchD_676b5657_caseD_3;
      default:
        uVar1 = param_3 - ((uint)puVar4 & 3);
        switch((uint)puVar4 & 3) {
        case 1:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          puVar3 = (undefined4 *)((int)puVar3 + -1);
          uVar1 = uVar1 >> 2;
          puVar4 = (undefined4 *)((int)puVar4 - 1);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return param_1;
            case 2:
              goto switchD_676b5657_caseD_2;
            case 3:
              goto switchD_676b5657_caseD_3;
            }
            goto switchD_676b5657_caseD_1;
          }
          break;
        case 2:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          puVar3 = (undefined4 *)((int)puVar3 + -2);
          puVar4 = (undefined4 *)((int)puVar4 - 2);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return param_1;
            case 2:
              goto switchD_676b5657_caseD_2;
            case 3:
              goto switchD_676b5657_caseD_3;
            }
            goto switchD_676b5657_caseD_1;
          }
          break;
        case 3:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
          puVar3 = (undefined4 *)((int)puVar3 + -3);
          puVar4 = (undefined4 *)((int)puVar4 - 3);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return param_1;
            case 2:
              goto switchD_676b5657_caseD_2;
            case 3:
              goto switchD_676b5657_caseD_3;
            }
            goto switchD_676b5657_caseD_1;
          }
        }
      }
    }
    switch(uVar1) {
    case 7:
      puVar4[7 - uVar1] = puVar3[7 - uVar1];
    case 6:
      puVar4[6 - uVar1] = puVar3[6 - uVar1];
    case 5:
      puVar4[5 - uVar1] = puVar3[5 - uVar1];
    case 4:
      puVar4[4 - uVar1] = puVar3[4 - uVar1];
    case 3:
      puVar4[3 - uVar1] = puVar3[3 - uVar1];
    case 2:
      puVar4[2 - uVar1] = puVar3[2 - uVar1];
    case 1:
      puVar4[1 - uVar1] = puVar3[1 - uVar1];
      puVar3 = puVar3 + -uVar1;
      puVar4 = puVar4 + -uVar1;
    }
    switch(uVar2) {
    case 1:
switchD_676b5657_caseD_1:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      return param_1;
    case 2:
switchD_676b5657_caseD_2:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      return param_1;
    case 3:
switchD_676b5657_caseD_3:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
      return param_1;
    }
switchD_676b5657_caseD_0:
    return param_1;
  }
  puVar3 = param_1;
  if (((uint)param_1 & 3) == 0) {
    uVar1 = param_3 >> 2;
    uVar2 = param_3 & 3;
    if (7 < uVar1) {
      for (; uVar1 != 0; uVar1 = uVar1 - 1) {
        *puVar3 = *param_2;
        param_2 = param_2 + 1;
        puVar3 = puVar3 + 1;
      }
      switch(uVar2) {
      case 0:
        return param_1;
      case 2:
        goto switchD_676b54d5_caseD_2;
      case 3:
        goto switchD_676b54d5_caseD_3;
      }
      goto switchD_676b54d5_caseD_1;
    }
  }
  else {
    switch(param_3) {
    case 0:
      goto switchD_676b54d5_caseD_0;
    case 1:
      goto switchD_676b54d5_caseD_1;
    case 2:
      goto switchD_676b54d5_caseD_2;
    case 3:
      goto switchD_676b54d5_caseD_3;
    default:
      uVar1 = (param_3 - 4) + ((uint)param_1 & 3);
      switch((uint)param_1 & 3) {
      case 1:
        uVar2 = uVar1 & 3;
        *(undefined1 *)param_1 = *(undefined1 *)param_2;
        *(undefined1 *)((int)param_1 + 1) = *(undefined1 *)((int)param_2 + 1);
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)param_1 + 2) = *(undefined1 *)((int)param_2 + 2);
        param_2 = (undefined4 *)((int)param_2 + 3);
        puVar3 = (undefined4 *)((int)param_1 + 3);
        if (7 < uVar1) {
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *param_2;
            param_2 = param_2 + 1;
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return param_1;
          case 2:
            goto switchD_676b54d5_caseD_2;
          case 3:
            goto switchD_676b54d5_caseD_3;
          }
          goto switchD_676b54d5_caseD_1;
        }
        break;
      case 2:
        uVar2 = uVar1 & 3;
        *(undefined1 *)param_1 = *(undefined1 *)param_2;
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)param_1 + 1) = *(undefined1 *)((int)param_2 + 1);
        param_2 = (undefined4 *)((int)param_2 + 2);
        puVar3 = (undefined4 *)((int)param_1 + 2);
        if (7 < uVar1) {
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *param_2;
            param_2 = param_2 + 1;
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return param_1;
          case 2:
            goto switchD_676b54d5_caseD_2;
          case 3:
            goto switchD_676b54d5_caseD_3;
          }
          goto switchD_676b54d5_caseD_1;
        }
        break;
      case 3:
        uVar2 = uVar1 & 3;
        *(undefined1 *)param_1 = *(undefined1 *)param_2;
        param_2 = (undefined4 *)((int)param_2 + 1);
        uVar1 = uVar1 >> 2;
        puVar3 = (undefined4 *)((int)param_1 + 1);
        if (7 < uVar1) {
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *param_2;
            param_2 = param_2 + 1;
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return param_1;
          case 2:
            goto switchD_676b54d5_caseD_2;
          case 3:
            goto switchD_676b54d5_caseD_3;
          }
          goto switchD_676b54d5_caseD_1;
        }
      }
    }
  }
  switch(uVar1) {
  case 7:
    puVar3[uVar1 - 7] = param_2[uVar1 - 7];
  case 6:
    puVar3[uVar1 - 6] = param_2[uVar1 - 6];
  case 5:
    puVar3[uVar1 - 5] = param_2[uVar1 - 5];
  case 4:
    puVar3[uVar1 - 4] = param_2[uVar1 - 4];
  case 3:
    puVar3[uVar1 - 3] = param_2[uVar1 - 3];
  case 2:
    puVar3[uVar1 - 2] = param_2[uVar1 - 2];
  case 1:
    puVar3[uVar1 - 1] = param_2[uVar1 - 1];
    param_2 = param_2 + uVar1;
    puVar3 = puVar3 + uVar1;
  }
  switch(uVar2) {
  case 1:
switchD_676b54d5_caseD_1:
    *(undefined1 *)puVar3 = *(undefined1 *)param_2;
    return param_1;
  case 2:
switchD_676b54d5_caseD_2:
    *(undefined1 *)puVar3 = *(undefined1 *)param_2;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)param_2 + 1);
    return param_1;
  case 3:
switchD_676b54d5_caseD_3:
    *(undefined1 *)puVar3 = *(undefined1 *)param_2;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)param_2 + 1);
    *(undefined1 *)((int)puVar3 + 2) = *(undefined1 *)((int)param_2 + 2);
    return param_1;
  }
switchD_676b54d5_caseD_0:
  return param_1;
}



// Function: __fptrap at 676b57d5

/* Library Function - Single Match
    __fptrap
   
   Library: Visual Studio 2003 Release */

void __cdecl __fptrap(void)

{
  __amsg_exit(2);
  return;
}



// Function: FUN_676b57de at 676b57de

void __thiscall FUN_676b57de(void *this,byte *param_1,int *param_2,void *param_3)

{
  FUN_676b57f5(this,param_1,param_2,param_3,0);
  return;
}



// Function: FUN_676b57f5 at 676b57f5

void * __thiscall FUN_676b57f5(void *this,byte *param_1,int *param_2,void *param_3,uint param_4)

{
  void *pvVar1;
  uint uVar2;
  void *pvVar3;
  uint uVar4;
  DWORD *pDVar5;
  void *this_00;
  byte bVar6;
  undefined *puVar7;
  void *local_c;
  byte *local_8;
  
  local_c = (void *)0x0;
  bVar6 = *param_1;
  local_8 = param_1 + 1;
  while( true ) {
    if (DAT_676c259c < 2) {
      uVar2 = (byte)PTR_DAT_676c2390[(uint)bVar6 * 2] & 8;
      this = PTR_DAT_676c2390;
    }
    else {
      puVar7 = (undefined *)0x8;
      uVar2 = FUN_676b0620(this,(uint)bVar6,8);
      this = puVar7;
    }
    if (uVar2 == 0) break;
    bVar6 = *local_8;
    local_8 = local_8 + 1;
  }
  if (bVar6 == 0x2d) {
    param_4 = param_4 | 2;
LAB_676b5850:
    bVar6 = *local_8;
    local_8 = local_8 + 1;
  }
  else if (bVar6 == 0x2b) goto LAB_676b5850;
  if ((((int)param_3 < 0) || (param_3 == (void *)0x1)) || (0x24 < (int)param_3)) {
    if (param_2 != (int *)0x0) {
      *param_2 = (int)param_1;
    }
    return (void *)0x0;
  }
  this_00 = (void *)0x10;
  if (param_3 == (void *)0x0) {
    if (bVar6 != 0x30) {
      param_3 = (void *)0xa;
      goto LAB_676b58ba;
    }
    if ((*local_8 != 0x78) && (*local_8 != 0x58)) {
      param_3 = (void *)0x8;
      goto LAB_676b58ba;
    }
    param_3 = (void *)0x10;
  }
  if (((param_3 == (void *)0x10) && (bVar6 == 0x30)) && ((*local_8 == 0x78 || (*local_8 == 0x58))))
  {
    bVar6 = local_8[1];
    local_8 = local_8 + 2;
  }
LAB_676b58ba:
  pvVar3 = (void *)(0xffffffff / ZEXT48(param_3));
  do {
    uVar2 = (uint)bVar6;
    if (DAT_676c259c < 2) {
      uVar4 = (byte)PTR_DAT_676c2390[uVar2 * 2] & 4;
    }
    else {
      pvVar1 = (void *)0x4;
      uVar4 = FUN_676b0620(this_00,uVar2,4);
      this_00 = pvVar1;
    }
    if (uVar4 == 0) {
      if (DAT_676c259c < 2) {
        uVar2 = *(ushort *)(PTR_DAT_676c2390 + uVar2 * 2) & 0x103;
      }
      else {
        uVar2 = FUN_676b0620(this_00,uVar2,0x103);
      }
      if (uVar2 == 0) {
LAB_676b5966:
        local_8 = local_8 + -1;
        if ((param_4 & 8) == 0) {
          if (param_2 != (int *)0x0) {
            local_8 = param_1;
          }
          local_c = (void *)0x0;
        }
        else if (((param_4 & 4) != 0) ||
                (((param_4 & 1) == 0 &&
                 ((((param_4 & 2) != 0 && ((void *)0x80000000 < local_c)) ||
                  (((param_4 & 2) == 0 && ((void *)0x7fffffff < local_c)))))))) {
          pDVar5 = FUN_676b5cd3();
          *pDVar5 = 0x22;
          if ((param_4 & 1) == 0) {
            local_c = (void *)(((param_4 & 2) != 0) + 0x7fffffff);
          }
          else {
            local_c = (void *)0xffffffff;
          }
        }
        if (param_2 != (int *)0x0) {
          *param_2 = (int)local_8;
        }
        if ((param_4 & 2) == 0) {
          return local_c;
        }
        return (void *)-(int)local_c;
      }
      uVar2 = FUN_676b6f02((int)(char)bVar6);
      this_00 = (void *)(uVar2 - 0x37);
    }
    else {
      this_00 = (void *)((char)bVar6 + -0x30);
    }
    if (param_3 <= this_00) goto LAB_676b5966;
    if ((local_c < pvVar3) ||
       ((local_c == pvVar3 && (this_00 <= (void *)(0xffffffff % ZEXT48(param_3)))))) {
      local_c = (void *)((int)local_c * (int)param_3 + (int)this_00);
      param_4 = param_4 | 8;
    }
    else {
      param_4 = param_4 | 0xc;
    }
    bVar6 = *local_8;
    local_8 = local_8 + 1;
  } while( true );
}



// Function: _strchr at 676b5a10

/* Library Function - Single Match
    _strchr
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

char * __cdecl _strchr(char *_Str,int _Val)

{
  uint uVar1;
  char cVar2;
  uint uVar3;
  uint uVar4;
  uint *puVar5;
  
  uVar1 = (uint)_Str & 3;
  while (uVar1 != 0) {
    if ((char)*(uint *)_Str == (char)_Val) {
      return (char *)(uint *)_Str;
    }
    if ((char)*(uint *)_Str == '\0') {
      return (char *)0x0;
    }
    uVar1 = (uint)((int)_Str + 1) & 3;
    _Str = (char *)((int)_Str + 1);
  }
  while( true ) {
    while( true ) {
      uVar1 = *(uint *)_Str;
      uVar4 = uVar1 ^ CONCAT22(CONCAT11((char)_Val,(char)_Val),CONCAT11((char)_Val,(char)_Val));
      uVar3 = uVar1 ^ 0xffffffff ^ uVar1 + 0x7efefeff;
      puVar5 = (uint *)((int)_Str + 4);
      if (((uVar4 ^ 0xffffffff ^ uVar4 + 0x7efefeff) & 0x81010100) != 0) break;
      _Str = (char *)puVar5;
      if ((uVar3 & 0x81010100) != 0) {
        if ((uVar3 & 0x1010100) != 0) {
          return (char *)0x0;
        }
        if ((uVar1 + 0x7efefeff & 0x80000000) == 0) {
          return (char *)0x0;
        }
      }
    }
    uVar1 = *(uint *)_Str;
    if ((char)uVar1 == (char)_Val) {
      return (char *)(uint *)_Str;
    }
    if ((char)uVar1 == '\0') {
      return (char *)0x0;
    }
    cVar2 = (char)(uVar1 >> 8);
    if (cVar2 == (char)_Val) {
      return (char *)((int)_Str + 1);
    }
    if (cVar2 == '\0') break;
    cVar2 = (char)(uVar1 >> 0x10);
    if (cVar2 == (char)_Val) {
      return (char *)((int)_Str + 2);
    }
    if (cVar2 == '\0') {
      return (char *)0x0;
    }
    cVar2 = (char)(uVar1 >> 0x18);
    if (cVar2 == (char)_Val) {
      return (char *)((int)_Str + 3);
    }
    _Str = (char *)puVar5;
    if (cVar2 == '\0') {
      return (char *)0x0;
    }
  }
  return (char *)0x0;
}



// Function: _strstr at 676b5ad0

/* Library Function - Single Match
    _strstr
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

char * __cdecl _strstr(char *_Str,char *_SubStr)

{
  char *pcVar1;
  char *pcVar2;
  char cVar3;
  uint uVar4;
  char cVar5;
  uint uVar6;
  uint uVar7;
  char *pcVar8;
  uint *puVar9;
  char *pcVar10;
  
  cVar3 = *_SubStr;
  if (cVar3 == '\0') {
    return _Str;
  }
  if (_SubStr[1] == '\0') {
    uVar4 = (uint)_Str & 3;
    while (uVar4 != 0) {
      if ((char)*(uint *)_Str == cVar3) {
        return (char *)(uint *)_Str;
      }
      if ((char)*(uint *)_Str == '\0') {
        return (char *)0x0;
      }
      uVar4 = (uint)((int)_Str + 1) & 3;
      _Str = (char *)((int)_Str + 1);
    }
    while( true ) {
      while( true ) {
        uVar4 = *(uint *)_Str;
        uVar7 = uVar4 ^ CONCAT22(CONCAT11(cVar3,cVar3),CONCAT11(cVar3,cVar3));
        uVar6 = uVar4 ^ 0xffffffff ^ uVar4 + 0x7efefeff;
        puVar9 = (uint *)((int)_Str + 4);
        if (((uVar7 ^ 0xffffffff ^ uVar7 + 0x7efefeff) & 0x81010100) != 0) break;
        _Str = (char *)puVar9;
        if ((uVar6 & 0x81010100) != 0) {
          if ((uVar6 & 0x1010100) != 0) {
            return (char *)0x0;
          }
          if ((uVar4 + 0x7efefeff & 0x80000000) == 0) {
            return (char *)0x0;
          }
        }
      }
      uVar4 = *(uint *)_Str;
      if ((char)uVar4 == cVar3) {
        return (char *)(uint *)_Str;
      }
      if ((char)uVar4 == '\0') {
        return (char *)0x0;
      }
      cVar5 = (char)(uVar4 >> 8);
      if (cVar5 == cVar3) {
        return (char *)((int)_Str + 1);
      }
      if (cVar5 == '\0') break;
      cVar5 = (char)(uVar4 >> 0x10);
      if (cVar5 == cVar3) {
        return (char *)((int)_Str + 2);
      }
      if (cVar5 == '\0') {
        return (char *)0x0;
      }
      cVar5 = (char)(uVar4 >> 0x18);
      if (cVar5 == cVar3) {
        return (char *)((int)_Str + 3);
      }
      _Str = (char *)puVar9;
      if (cVar5 == '\0') {
        return (char *)0x0;
      }
    }
    return (char *)0x0;
  }
  do {
    cVar5 = *_Str;
    do {
      while (_Str = _Str + 1, cVar5 != cVar3) {
        if (cVar5 == '\0') {
          return (char *)0x0;
        }
        cVar5 = *_Str;
      }
      cVar5 = *_Str;
      pcVar10 = _Str + 1;
      pcVar8 = _SubStr;
    } while (cVar5 != _SubStr[1]);
    do {
      if (pcVar8[2] == '\0') {
LAB_676b5b43:
        return _Str + -1;
      }
      if (*pcVar10 != pcVar8[2]) break;
      pcVar1 = pcVar8 + 3;
      if (*pcVar1 == '\0') goto LAB_676b5b43;
      pcVar2 = pcVar10 + 1;
      pcVar8 = pcVar8 + 2;
      pcVar10 = pcVar10 + 2;
    } while (*pcVar1 == *pcVar2);
  } while( true );
}



// Function: _strncmp at 676b5b50

/* Library Function - Single Match
    _strncmp
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

int __cdecl _strncmp(char *_Str1,char *_Str2,size_t _MaxCount)

{
  char cVar1;
  char cVar2;
  size_t sVar3;
  int iVar4;
  uint uVar5;
  char *pcVar6;
  char *pcVar7;
  
  sVar3 = _MaxCount;
  pcVar6 = _Str1;
  if (_MaxCount != 0) {
    do {
      if (sVar3 == 0) break;
      sVar3 = sVar3 - 1;
      cVar1 = *pcVar6;
      pcVar6 = pcVar6 + 1;
    } while (cVar1 != '\0');
    iVar4 = _MaxCount - sVar3;
    do {
      pcVar6 = _Str2;
      pcVar7 = _Str1;
      if (iVar4 == 0) break;
      iVar4 = iVar4 + -1;
      pcVar7 = _Str1 + 1;
      pcVar6 = _Str2 + 1;
      cVar2 = *_Str1;
      cVar1 = *_Str2;
      _Str2 = pcVar6;
      _Str1 = pcVar7;
    } while (cVar1 == cVar2);
    uVar5 = 0;
    if ((byte)pcVar6[-1] <= (byte)pcVar7[-1]) {
      if (pcVar6[-1] == pcVar7[-1]) {
        return 0;
      }
      uVar5 = 0xfffffffe;
    }
    _MaxCount = ~uVar5;
  }
  return _MaxCount;
}



// Function: FUN_676b5b88 at 676b5b88

DWORD __cdecl FUN_676b5b88(uint param_1,LONG param_2,DWORD param_3)

{
  DWORD DVar1;
  DWORD *pDVar2;
  
  if ((param_1 < DAT_676c5d80) &&
     ((*(byte *)((&DAT_676c5c80)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24) & 1) != 0)) {
    FUN_676b5da6(param_1);
    DVar1 = FUN_676b5bed(param_1,param_2,param_3);
    FUN_676b5e05(param_1);
    return DVar1;
  }
  pDVar2 = FUN_676b5cd3();
  *pDVar2 = 9;
  pDVar2 = FUN_676b5cdc();
  *pDVar2 = 0;
  return 0xffffffff;
}



// Function: FUN_676b5bed at 676b5bed

DWORD __cdecl FUN_676b5bed(uint param_1,LONG param_2,DWORD param_3)

{
  byte *pbVar1;
  HANDLE hFile;
  DWORD *pDVar2;
  DWORD DVar3;
  uint uVar4;
  
  hFile = (HANDLE)FUN_676b5d64(param_1);
  if (hFile == (HANDLE)0xffffffff) {
    pDVar2 = FUN_676b5cd3();
    *pDVar2 = 9;
  }
  else {
    DVar3 = SetFilePointer(hFile,param_2,(PLONG)0x0,param_3);
    if (DVar3 == 0xffffffff) {
      uVar4 = GetLastError();
    }
    else {
      uVar4 = 0;
    }
    if (uVar4 == 0) {
      pbVar1 = (byte *)((&DAT_676c5c80)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24);
      *pbVar1 = *pbVar1 & 0xfd;
      return DVar3;
    }
    FUN_676b5c60(uVar4);
  }
  return 0xffffffff;
}



// Function: FUN_676b5c60 at 676b5c60

void __cdecl FUN_676b5c60(uint param_1)

{
  DWORD *pDVar1;
  uint *puVar2;
  int iVar3;
  
  pDVar1 = FUN_676b5cdc();
  iVar3 = 0;
  *pDVar1 = param_1;
  puVar2 = &DAT_676c47c0;
  do {
    if (param_1 == *puVar2) {
      pDVar1 = FUN_676b5cd3();
      *pDVar1 = *(DWORD *)(iVar3 * 8 + 0x676c47c4);
      return;
    }
    puVar2 = puVar2 + 2;
    iVar3 = iVar3 + 1;
  } while (puVar2 < &DAT_676c4928);
  if ((0x12 < param_1) && (param_1 < 0x25)) {
    pDVar1 = FUN_676b5cd3();
    *pDVar1 = 0xd;
    return;
  }
  if ((0xbb < param_1) && (param_1 < 0xcb)) {
    pDVar1 = FUN_676b5cd3();
    *pDVar1 = 8;
    return;
  }
  pDVar1 = FUN_676b5cd3();
  *pDVar1 = 0x16;
  return;
}



// Function: FUN_676b5cd3 at 676b5cd3

DWORD * FUN_676b5cd3(void)

{
  DWORD *pDVar1;
  
  pDVar1 = FUN_676b43da();
  return pDVar1 + 2;
}



// Function: FUN_676b5cdc at 676b5cdc

DWORD * FUN_676b5cdc(void)

{
  DWORD *pDVar1;
  
  pDVar1 = FUN_676b43da();
  return pDVar1 + 3;
}



// Function: FUN_676b5ce5 at 676b5ce5

undefined4 __cdecl FUN_676b5ce5(uint param_1)

{
  int *piVar1;
  DWORD *pDVar2;
  int iVar3;
  DWORD nStdHandle;
  
  if (param_1 < DAT_676c5d80) {
    iVar3 = (param_1 & 0x1f) * 0x24;
    piVar1 = (int *)((&DAT_676c5c80)[(int)param_1 >> 5] + iVar3);
    if (((*(byte *)(piVar1 + 1) & 1) != 0) && (*piVar1 != -1)) {
      if (DAT_676c56ec == 1) {
        if (param_1 == 0) {
          nStdHandle = 0xfffffff6;
        }
        else if (param_1 == 1) {
          nStdHandle = 0xfffffff5;
        }
        else {
          if (param_1 != 2) goto LAB_676b5d41;
          nStdHandle = 0xfffffff4;
        }
        SetStdHandle(nStdHandle,(HANDLE)0x0);
      }
LAB_676b5d41:
      *(undefined4 *)((&DAT_676c5c80)[(int)param_1 >> 5] + iVar3) = 0xffffffff;
      return 0;
    }
  }
  pDVar2 = FUN_676b5cd3();
  *pDVar2 = 9;
  pDVar2 = FUN_676b5cdc();
  *pDVar2 = 0;
  return 0xffffffff;
}



// Function: FUN_676b5d64 at 676b5d64

undefined4 __cdecl FUN_676b5d64(uint param_1)

{
  DWORD *pDVar1;
  
  if ((param_1 < DAT_676c5d80) &&
     ((*(byte *)((&DAT_676c5c80)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24) & 1) != 0)) {
    return *(undefined4 *)((&DAT_676c5c80)[(int)param_1 >> 5] + (param_1 & 0x1f) * 0x24);
  }
  pDVar1 = FUN_676b5cd3();
  *pDVar1 = 9;
  pDVar1 = FUN_676b5cdc();
  *pDVar1 = 0;
  return 0xffffffff;
}



// Function: FUN_676b5da6 at 676b5da6

void __cdecl FUN_676b5da6(uint param_1)

{
  int iVar1;
  int iVar2;
  
  iVar2 = (param_1 & 0x1f) * 0x24;
  iVar1 = (&DAT_676c5c80)[(int)param_1 >> 5] + iVar2;
  if (*(int *)(iVar1 + 8) == 0) {
    FUN_676b20a4(0x11);
    if (*(int *)(iVar1 + 8) == 0) {
      InitializeCriticalSection((LPCRITICAL_SECTION)(iVar1 + 0xc));
      *(int *)(iVar1 + 8) = *(int *)(iVar1 + 8) + 1;
    }
    FUN_676b2105(0x11);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)((&DAT_676c5c80)[(int)param_1 >> 5] + 0xc + iVar2));
  return;
}



// Function: FUN_676b5e05 at 676b5e05

void __cdecl FUN_676b5e05(uint param_1)

{
  LeaveCriticalSection
            ((LPCRITICAL_SECTION)
             ((&DAT_676c5c80)[(int)param_1 >> 5] + 0xc + (param_1 & 0x1f) * 0x24));
  return;
}



// Function: FUN_676b5e27 at 676b5e27

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 __cdecl FUN_676b5e27(int param_1)

{
  BYTE *pBVar1;
  byte *pbVar2;
  byte bVar3;
  byte bVar4;
  UINT CodePage;
  UINT *pUVar5;
  BOOL BVar6;
  uint uVar7;
  uint uVar8;
  BYTE *pBVar9;
  int iVar10;
  byte *pbVar11;
  int iVar12;
  byte *pbVar13;
  undefined4 uVar14;
  undefined4 *puVar15;
  _cpinfo local_1c;
  uint local_8;
  
  FUN_676b20a4(0x19);
  CodePage = FUN_676b5fd4(param_1);
  if (CodePage != DAT_676c5a1c) {
    if (CodePage != 0) {
      iVar12 = 0;
      pUVar5 = &DAT_676c49b8;
LAB_676b5e64:
      if (*pUVar5 != CodePage) goto code_r0x676b5e68;
      local_8 = 0;
      puVar15 = &DAT_676c5b40;
      for (iVar10 = 0x40; iVar10 != 0; iVar10 = iVar10 + -1) {
        *puVar15 = 0;
        puVar15 = puVar15 + 1;
      }
      iVar12 = iVar12 * 0x30;
      *(undefined1 *)puVar15 = 0;
      pbVar13 = (byte *)(iVar12 + 0x676c49c8);
      do {
        bVar3 = *pbVar13;
        pbVar11 = pbVar13;
        while ((bVar3 != 0 && (bVar3 = pbVar11[1], bVar3 != 0))) {
          uVar8 = (uint)*pbVar11;
          if (uVar8 <= bVar3) {
            bVar4 = (&DAT_676c49b0)[local_8];
            do {
              pbVar2 = (byte *)((int)&DAT_676c5b40 + uVar8 + 1);
              *pbVar2 = *pbVar2 | bVar4;
              uVar8 = uVar8 + 1;
            } while (uVar8 <= bVar3);
          }
          pbVar11 = pbVar11 + 2;
          bVar3 = *pbVar11;
        }
        local_8 = local_8 + 1;
        pbVar13 = pbVar13 + 8;
      } while (local_8 < 4);
      _DAT_676c5a2c = 1;
      DAT_676c5a1c = CodePage;
      DAT_676c5c44 = FUN_676b601e(CodePage);
      DAT_676c5a20 = *(undefined4 *)(iVar12 + 0x676c49bc);
      DAT_676c5a24 = *(undefined4 *)(iVar12 + 0x676c49c0);
      DAT_676c5a28 = *(undefined4 *)(iVar12 + 0x676c49c4);
      goto LAB_676b5fb8;
    }
    goto LAB_676b5fb3;
  }
  goto LAB_676b5e4e;
code_r0x676b5e68:
  pUVar5 = pUVar5 + 0xc;
  iVar12 = iVar12 + 1;
  if ((UINT *)0x676c4aa7 < pUVar5) goto code_r0x676b5e73;
  goto LAB_676b5e64;
code_r0x676b5e73:
  BVar6 = GetCPInfo(CodePage,&local_1c);
  uVar8 = 1;
  if (BVar6 == 1) {
    DAT_676c5c44 = 0;
    puVar15 = &DAT_676c5b40;
    for (iVar12 = 0x40; iVar12 != 0; iVar12 = iVar12 + -1) {
      *puVar15 = 0;
      puVar15 = puVar15 + 1;
    }
    *(undefined1 *)puVar15 = 0;
    if (local_1c.MaxCharSize < 2) {
      _DAT_676c5a2c = 0;
      DAT_676c5a1c = CodePage;
    }
    else {
      DAT_676c5a1c = CodePage;
      if (local_1c.LeadByte[0] != '\0') {
        pBVar9 = local_1c.LeadByte + 1;
        do {
          bVar3 = *pBVar9;
          if (bVar3 == 0) break;
          for (uVar7 = (uint)pBVar9[-1]; uVar7 <= bVar3; uVar7 = uVar7 + 1) {
            pbVar13 = (byte *)((int)&DAT_676c5b40 + uVar7 + 1);
            *pbVar13 = *pbVar13 | 4;
          }
          pBVar1 = pBVar9 + 1;
          pBVar9 = pBVar9 + 2;
        } while (*pBVar1 != 0);
      }
      do {
        pbVar13 = (byte *)((int)&DAT_676c5b40 + uVar8 + 1);
        *pbVar13 = *pbVar13 | 8;
        uVar8 = uVar8 + 1;
      } while (uVar8 < 0xff);
      DAT_676c5c44 = FUN_676b601e(CodePage);
      _DAT_676c5a2c = 1;
    }
    DAT_676c5a20 = 0;
    DAT_676c5a24 = 0;
    DAT_676c5a28 = 0;
  }
  else {
    if (DAT_676c5898 == 0) {
      uVar14 = 0xffffffff;
      goto LAB_676b5fc5;
    }
LAB_676b5fb3:
    FUN_676b6051();
  }
LAB_676b5fb8:
  FUN_676b607a();
LAB_676b5e4e:
  uVar14 = 0;
LAB_676b5fc5:
  FUN_676b2105(0x19);
  return uVar14;
}



// Function: FUN_676b5fd4 at 676b5fd4

int __cdecl FUN_676b5fd4(int param_1)

{
  int iVar1;
  bool bVar2;
  
  if (param_1 == -2) {
    DAT_676c5898 = 1;
                    /* WARNING: Could not recover jumptable at 0x676b5fee. Too many branches */
                    /* WARNING: Treating indirect jump as call */
    iVar1 = GetOEMCP();
    return iVar1;
  }
  if (param_1 == -3) {
    DAT_676c5898 = 1;
                    /* WARNING: Could not recover jumptable at 0x676b6003. Too many branches */
                    /* WARNING: Treating indirect jump as call */
    iVar1 = GetACP();
    return iVar1;
  }
  bVar2 = param_1 == -4;
  if (bVar2) {
    param_1 = DAT_676c5890;
  }
  DAT_676c5898 = (uint)bVar2;
  return param_1;
}



// Function: FUN_676b601e at 676b601e

undefined4 __cdecl FUN_676b601e(int param_1)

{
  if (param_1 == 0x3a4) {
    return 0x411;
  }
  if (param_1 == 0x3a8) {
    return 0x804;
  }
  if (param_1 == 0x3b5) {
    return 0x412;
  }
  if (param_1 != 0x3b6) {
    return 0;
  }
  return 0x404;
}



// Function: FUN_676b6051 at 676b6051

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_676b6051(void)

{
  int iVar1;
  undefined4 *puVar2;
  
  puVar2 = &DAT_676c5b40;
  for (iVar1 = 0x40; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  *(undefined1 *)puVar2 = 0;
  DAT_676c5a1c = 0;
  _DAT_676c5a2c = 0;
  DAT_676c5c44 = 0;
  DAT_676c5a20 = 0;
  DAT_676c5a24 = 0;
  DAT_676c5a28 = 0;
  return;
}



// Function: FUN_676b607a at 676b607a

void FUN_676b607a(void)

{
  byte *pbVar1;
  BOOL BVar2;
  uint uVar3;
  char cVar4;
  uint uVar5;
  uint uVar6;
  ushort *puVar7;
  undefined1 uVar8;
  BYTE *pBVar9;
  CHAR *pCVar10;
  WORD local_518 [256];
  WCHAR local_318 [128];
  WCHAR local_218 [128];
  CHAR local_118 [256];
  _cpinfo local_18;
  
  BVar2 = GetCPInfo(DAT_676c5a1c,&local_18);
  if (BVar2 == 1) {
    uVar3 = 0;
    do {
      local_118[uVar3] = (CHAR)uVar3;
      uVar3 = uVar3 + 1;
    } while (uVar3 < 0x100);
    local_118[0] = ' ';
    if (local_18.LeadByte[0] != 0) {
      pBVar9 = local_18.LeadByte + 1;
      do {
        uVar3 = (uint)local_18.LeadByte[0];
        if (uVar3 <= *pBVar9) {
          uVar5 = (*pBVar9 - uVar3) + 1;
          uVar6 = uVar5 >> 2;
          pCVar10 = local_118 + uVar3;
          while (uVar6 != 0) {
            uVar6 = uVar6 - 1;
            builtin_memcpy(pCVar10,"    ",4);
            pCVar10 = pCVar10 + 4;
          }
          for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
            *pCVar10 = ' ';
            pCVar10 = pCVar10 + 1;
          }
        }
        local_18.LeadByte[0] = pBVar9[1];
        pBVar9 = pBVar9 + 2;
      } while (local_18.LeadByte[0] != 0);
    }
    FUN_676b411e(1,local_118,0x100,local_518,DAT_676c5a1c,DAT_676c5c44,0);
    FUN_676b63ae(DAT_676c5c44,0x100,local_118,0x100,local_218,0x100,DAT_676c5a1c,0);
    FUN_676b63ae(DAT_676c5c44,0x200,local_118,0x100,local_318,0x100,DAT_676c5a1c,0);
    uVar3 = 0;
    puVar7 = local_518;
    do {
      if ((*puVar7 & 1) == 0) {
        if ((*puVar7 & 2) != 0) {
          pbVar1 = (byte *)((int)&DAT_676c5b40 + uVar3 + 1);
          *pbVar1 = *pbVar1 | 0x20;
          uVar8 = *(undefined1 *)((int)local_318 + uVar3);
          goto LAB_676b6186;
        }
        (&DAT_676c5a40)[uVar3] = 0;
      }
      else {
        pbVar1 = (byte *)((int)&DAT_676c5b40 + uVar3 + 1);
        *pbVar1 = *pbVar1 | 0x10;
        uVar8 = *(undefined1 *)((int)local_218 + uVar3);
LAB_676b6186:
        (&DAT_676c5a40)[uVar3] = uVar8;
      }
      uVar3 = uVar3 + 1;
      puVar7 = puVar7 + 1;
    } while (uVar3 < 0x100);
  }
  else {
    uVar3 = 0;
    do {
      if ((uVar3 < 0x41) || (0x5a < uVar3)) {
        if ((0x60 < uVar3) && (uVar3 < 0x7b)) {
          pbVar1 = (byte *)((int)&DAT_676c5b40 + uVar3 + 1);
          *pbVar1 = *pbVar1 | 0x20;
          cVar4 = (char)uVar3 + -0x20;
          goto LAB_676b61d0;
        }
        (&DAT_676c5a40)[uVar3] = 0;
      }
      else {
        pbVar1 = (byte *)((int)&DAT_676c5b40 + uVar3 + 1);
        *pbVar1 = *pbVar1 | 0x10;
        cVar4 = (char)uVar3 + ' ';
LAB_676b61d0:
        (&DAT_676c5a40)[uVar3] = cVar4;
      }
      uVar3 = uVar3 + 1;
    } while (uVar3 < 0x100);
  }
  return;
}



// Function: FUN_676b61ff at 676b61ff

void FUN_676b61ff(void)

{
  if (DAT_676c5d90 == 0) {
    FUN_676b5e27(-3);
    DAT_676c5d90 = 1;
  }
  return;
}



// Function: FUN_676b621b at 676b621b

int __cdecl FUN_676b621b(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  HMODULE hModule;
  int iVar1;
  
  iVar1 = 0;
  if (DAT_676c589c == (FARPROC)0x0) {
    hModule = LoadLibraryA("user32.dll");
    if (hModule != (HMODULE)0x0) {
      DAT_676c589c = GetProcAddress(hModule,"MessageBoxA");
      if (DAT_676c589c != (FARPROC)0x0) {
        DAT_676c58a0 = GetProcAddress(hModule,"GetActiveWindow");
        DAT_676c58a4 = GetProcAddress(hModule,"GetLastActivePopup");
        goto LAB_676b626a;
      }
    }
    iVar1 = 0;
  }
  else {
LAB_676b626a:
    if (DAT_676c58a0 != (FARPROC)0x0) {
      iVar1 = (*DAT_676c58a0)();
      if ((iVar1 != 0) && (DAT_676c58a4 != (FARPROC)0x0)) {
        iVar1 = (*DAT_676c58a4)(iVar1);
      }
    }
    iVar1 = (*DAT_676c589c)(iVar1,param_1,param_2,param_3);
  }
  return iVar1;
}



// Function: _strncpy at 676b62b0

/* Library Function - Single Match
    _strncpy
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

char * __cdecl _strncpy(char *_Dest,char *_Source,size_t _Count)

{
  uint uVar1;
  uint uVar2;
  char cVar3;
  uint uVar4;
  uint *puVar5;
  
  if (_Count == 0) {
    return _Dest;
  }
  puVar5 = (uint *)_Dest;
  if (((uint)_Source & 3) != 0) {
    while( true ) {
      uVar4 = *(uint *)_Source;
      _Source = (char *)((int)_Source + 1);
      *(char *)puVar5 = (char)uVar4;
      puVar5 = (uint *)((int)puVar5 + 1);
      _Count = _Count - 1;
      if (_Count == 0) {
        return _Dest;
      }
      if ((char)uVar4 == '\0') break;
      if (((uint)_Source & 3) == 0) {
        uVar4 = _Count >> 2;
        goto joined_r0x676b62ee;
      }
    }
    do {
      if (((uint)puVar5 & 3) == 0) {
        uVar4 = _Count >> 2;
        cVar3 = '\0';
        if (uVar4 == 0) goto LAB_676b632b;
        goto LAB_676b6399;
      }
      *(char *)puVar5 = '\0';
      puVar5 = (uint *)((int)puVar5 + 1);
      _Count = _Count - 1;
    } while (_Count != 0);
    return _Dest;
  }
  uVar4 = _Count >> 2;
  if (uVar4 != 0) {
    do {
      uVar1 = *(uint *)_Source;
      uVar2 = *(uint *)_Source;
      _Source = (char *)((int)_Source + 4);
      if (((uVar1 ^ 0xffffffff ^ uVar1 + 0x7efefeff) & 0x81010100) != 0) {
        if ((char)uVar2 == '\0') {
          *puVar5 = 0;
joined_r0x676b6395:
          while( true ) {
            uVar4 = uVar4 - 1;
            puVar5 = puVar5 + 1;
            if (uVar4 == 0) break;
LAB_676b6399:
            *puVar5 = 0;
          }
          cVar3 = '\0';
          _Count = _Count & 3;
          if (_Count != 0) goto LAB_676b632b;
          return _Dest;
        }
        if ((char)(uVar2 >> 8) == '\0') {
          *puVar5 = uVar2 & 0xff;
          goto joined_r0x676b6395;
        }
        if ((uVar2 & 0xff0000) == 0) {
          *puVar5 = uVar2 & 0xffff;
          goto joined_r0x676b6395;
        }
        if ((uVar2 & 0xff000000) == 0) {
          *puVar5 = uVar2;
          goto joined_r0x676b6395;
        }
      }
      *puVar5 = uVar2;
      puVar5 = puVar5 + 1;
      uVar4 = uVar4 - 1;
joined_r0x676b62ee:
    } while (uVar4 != 0);
    _Count = _Count & 3;
    if (_Count == 0) {
      return _Dest;
    }
  }
  do {
    cVar3 = (char)*(uint *)_Source;
    _Source = (char *)((int)_Source + 1);
    *(char *)puVar5 = cVar3;
    puVar5 = (uint *)((int)puVar5 + 1);
    if (cVar3 == '\0') {
      while (_Count = _Count - 1, _Count != 0) {
LAB_676b632b:
        *(char *)puVar5 = cVar3;
        puVar5 = (uint *)((int)puVar5 + 1);
      }
      return _Dest;
    }
    _Count = _Count - 1;
  } while (_Count != 0);
  return _Dest;
}



// Function: FUN_676b63ae at 676b63ae

int __cdecl
FUN_676b63ae(LCID param_1,uint param_2,char *param_3,int param_4,LPWSTR param_5,int param_6,
            UINT param_7,int param_8)

{
  int iVar1;
  int iVar2;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_676bbb20;
  puStack_10 = &LAB_676b3b5c;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  if (DAT_676c58c8 == 0) {
    ExceptionList = &local_14;
    iVar1 = LCMapStringW(0,0x100,L"",1,(LPWSTR)0x0,0);
    if (iVar1 == 0) {
      iVar1 = LCMapStringA(0,0x100,"",1,(LPSTR)0x0,0);
      if (iVar1 == 0) {
        ExceptionList = local_14;
        return 0;
      }
      DAT_676c58c8 = 2;
    }
    else {
      DAT_676c58c8 = 1;
    }
  }
  if (0 < param_4) {
    param_4 = FUN_676b65d2(param_3,param_4);
  }
  if (DAT_676c58c8 == 2) {
    iVar1 = LCMapStringA(param_1,param_2,param_3,param_4,(LPSTR)param_5,param_6);
    ExceptionList = local_14;
    return iVar1;
  }
  if (DAT_676c58c8 == 1) {
    if (param_7 == 0) {
      param_7 = DAT_676c5890;
    }
    iVar1 = MultiByteToWideChar(param_7,(-(uint)(param_8 != 0) & 8) + 1,param_3,param_4,(LPWSTR)0x0,
                                0);
    if (iVar1 != 0) {
      local_8 = 0;
      FUN_676b06a0();
      local_8 = 0xffffffff;
      if ((&stack0x00000000 != (undefined1 *)0x3c) &&
         (iVar2 = MultiByteToWideChar(param_7,1,param_3,param_4,(LPWSTR)&stack0xffffffc4,iVar1),
         iVar2 != 0)) {
        iVar2 = LCMapStringW(param_1,param_2,(LPCWSTR)&stack0xffffffc4,iVar1,(LPWSTR)0x0,0);
        if (iVar2 != 0) {
          if ((param_2 & 0x400) == 0) {
            local_8 = 1;
            FUN_676b06a0();
            local_8 = 0xffffffff;
            if (&stack0x00000000 == (undefined1 *)0x3c) {
              ExceptionList = local_14;
              return 0;
            }
            iVar1 = LCMapStringW(param_1,param_2,(LPCWSTR)&stack0xffffffc4,iVar1,
                                 (LPWSTR)&stack0xffffffc4,iVar2);
            if (iVar1 == 0) {
              ExceptionList = local_14;
              return 0;
            }
            if (param_6 == 0) {
              param_6 = 0;
              param_5 = (LPWSTR)0x0;
            }
            iVar2 = WideCharToMultiByte(param_7,0x220,(LPCWSTR)&stack0xffffffc4,iVar2,(LPSTR)param_5
                                        ,param_6,(LPCSTR)0x0,(LPBOOL)0x0);
            iVar1 = iVar2;
          }
          else {
            if (param_6 == 0) {
              ExceptionList = local_14;
              return iVar2;
            }
            if (param_6 < iVar2) {
              ExceptionList = local_14;
              return 0;
            }
            iVar1 = LCMapStringW(param_1,param_2,(LPCWSTR)&stack0xffffffc4,iVar1,param_5,param_6);
          }
          if (iVar1 != 0) {
            ExceptionList = local_14;
            return iVar2;
          }
        }
      }
    }
  }
  ExceptionList = local_14;
  return 0;
}



// Function: FUN_676b65d2 at 676b65d2

int __cdecl FUN_676b65d2(char *param_1,int param_2)

{
  char *pcVar1;
  int iVar2;
  
  pcVar1 = param_1;
  iVar2 = param_2;
  if (param_2 != 0) {
    do {
      iVar2 = iVar2 + -1;
      if (*pcVar1 == '\0') break;
      pcVar1 = pcVar1 + 1;
    } while (iVar2 != 0);
  }
  if (*pcVar1 == '\0') {
    return (int)pcVar1 - (int)param_1;
  }
  return param_2;
}



// Function: FUN_676b65fd at 676b65fd

undefined4 __cdecl FUN_676b65fd(uint param_1,uint param_2,uint *param_3)

{
  uint uVar1;
  undefined4 uVar2;
  
  uVar2 = 0;
  uVar1 = param_1 + param_2;
  if ((uVar1 < param_1) || (uVar1 < param_2)) {
    uVar2 = 1;
  }
  *param_3 = uVar1;
  return uVar2;
}



// Function: ___add_12 at 676b661e

/* Library Function - Single Match
    ___add_12
   
   Library: Visual Studio 2003 Release */

void __cdecl ___add_12(uint *param_1,uint *param_2)

{
  int iVar1;
  
  iVar1 = FUN_676b65fd(*param_1,*param_2,param_1);
  if (iVar1 != 0) {
    iVar1 = FUN_676b65fd(param_1[1],1,param_1 + 1);
    if (iVar1 != 0) {
      param_1[2] = param_1[2] + 1;
    }
  }
  iVar1 = FUN_676b65fd(param_1[1],param_2[1],param_1 + 1);
  if (iVar1 != 0) {
    param_1[2] = param_1[2] + 1;
  }
  FUN_676b65fd(param_1[2],param_2[2],param_1 + 2);
  return;
}



// Function: FUN_676b667c at 676b667c

void __cdecl FUN_676b667c(uint *param_1)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = *param_1;
  uVar2 = param_1[1];
  *param_1 = uVar1 * 2;
  param_1[1] = uVar2 * 2 | uVar1 >> 0x1f;
  param_1[2] = param_1[2] << 1 | uVar2 >> 0x1f;
  return;
}



// Function: FUN_676b66aa at 676b66aa

void __cdecl FUN_676b66aa(uint *param_1)

{
  uint uVar1;
  
  uVar1 = param_1[1];
  param_1[1] = uVar1 >> 1 | param_1[2] << 0x1f;
  param_1[2] = param_1[2] >> 1;
  *param_1 = *param_1 >> 1 | uVar1 << 0x1f;
  return;
}



// Function: FUN_676b66d7 at 676b66d7

void __cdecl FUN_676b66d7(char *param_1,int param_2,uint *param_3)

{
  uint *puVar1;
  uint local_14;
  uint local_10;
  uint local_c;
  int local_8;
  
  puVar1 = param_3;
  local_8 = 0x404e;
  *param_3 = 0;
  param_3[1] = 0;
  param_3[2] = 0;
  if (param_2 != 0) {
    param_3 = (uint *)param_2;
    do {
      local_14 = *puVar1;
      local_10 = puVar1[1];
      local_c = puVar1[2];
      FUN_676b667c(puVar1);
      FUN_676b667c(puVar1);
      ___add_12(puVar1,&local_14);
      FUN_676b667c(puVar1);
      local_10 = 0;
      local_c = 0;
      local_14 = (uint)*param_1;
      ___add_12(puVar1,&local_14);
      param_1 = param_1 + 1;
      param_3 = (uint *)((int)param_3 + -1);
    } while (param_3 != (uint *)0x0);
  }
  while (puVar1[2] == 0) {
    puVar1[2] = puVar1[1] >> 0x10;
    local_8 = local_8 + 0xfff0;
    puVar1[1] = *puVar1 >> 0x10 | puVar1[1] << 0x10;
    *puVar1 = *puVar1 << 0x10;
  }
  while ((puVar1[2] & 0x8000) == 0) {
    FUN_676b667c(puVar1);
    local_8 = local_8 + 0xffff;
  }
  *(undefined2 *)((int)puVar1 + 10) = (undefined2)local_8;
  return;
}



// Function: FUN_676b679e at 676b679e

undefined4 __thiscall
FUN_676b679e(void *this,ushort *param_1,int *param_2,byte *param_3,int param_4,int param_5,
            int param_6,int param_7)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  char *pcVar4;
  int iVar5;
  byte bVar6;
  byte *pbVar7;
  byte *pbVar8;
  int iVar9;
  byte *pbVar10;
  char local_60 [23];
  char local_49;
  ushort local_44;
  undefined2 uStack_42;
  undefined2 uStack_40;
  byte *local_3e;
  ushort local_3a;
  int local_34;
  int local_30;
  undefined4 local_2c;
  int local_28;
  int local_24;
  byte *local_20;
  int local_1c;
  undefined4 local_18;
  int local_14;
  char *local_10;
  int local_c;
  uint local_8;
  
  local_10 = local_60;
  local_2c = 0;
  local_1c = 1;
  local_8 = 0;
  local_14 = 0;
  local_28 = 0;
  local_24 = 0;
  local_30 = 0;
  local_34 = 0;
  local_20 = (byte *)0x0;
  local_c = 0;
  local_18 = 0;
  pbVar8 = param_3;
  while( true ) {
    bVar6 = *pbVar8;
    this = (void *)CONCAT31((int3)((uint)this >> 8),bVar6);
    if ((((bVar6 != 0x20) && (bVar6 != 9)) && (bVar6 != 10)) && (bVar6 != 0xd)) break;
    pbVar8 = pbVar8 + 1;
  }
  iVar1 = 4;
  iVar9 = 0;
  iVar5 = local_14;
LAB_676b67f5:
  local_14 = iVar5;
  pbVar7 = pbVar8;
  iVar5 = 1;
  bVar6 = *pbVar7;
  pbVar8 = pbVar7 + 1;
  iVar2 = local_14;
  switch(iVar9) {
  case 0:
    if (('0' < (char)bVar6) && ((char)bVar6 < ':')) {
LAB_676b6812:
      local_14 = iVar2;
      iVar9 = 3;
      goto LAB_676b6a37;
    }
    if (bVar6 == DAT_676c25a0) goto LAB_676b6821;
    if (bVar6 == 0x2b) {
      local_2c = 0;
      iVar9 = 2;
      iVar5 = local_14;
    }
    else if (bVar6 == 0x2d) {
      local_2c = 0x8000;
      iVar9 = 2;
      iVar5 = local_14;
    }
    else {
      iVar9 = iVar5;
      iVar5 = local_14;
      if (bVar6 != 0x30) goto LAB_676b6b11;
    }
    goto LAB_676b67f5;
  case 1:
    local_14 = 1;
    if (('0' < (char)bVar6) && (iVar2 = iVar5, (char)bVar6 < ':')) goto LAB_676b6812;
    iVar9 = iVar1;
    if (bVar6 != DAT_676c25a0) {
      iVar9 = iVar5;
      if ((bVar6 == 0x2b) || (iVar9 = local_14, bVar6 == 0x2d)) goto LAB_676b68a6;
      iVar9 = iVar5;
      local_14 = iVar5;
      if (bVar6 != 0x30) goto LAB_676b687f;
    }
    goto LAB_676b67f5;
  case 2:
    if (('0' < (char)bVar6) && ((char)bVar6 < ':')) goto LAB_676b6812;
    if (bVar6 == DAT_676c25a0) {
LAB_676b6821:
      iVar9 = 5;
      iVar5 = local_14;
    }
    else {
      iVar9 = iVar5;
      pbVar7 = param_3;
      iVar5 = local_14;
      if (bVar6 != 0x30) goto LAB_676b6b16;
    }
    goto LAB_676b67f5;
  case 3:
    local_14 = iVar5;
    while( true ) {
      if (DAT_676c259c < 2) {
        uVar3 = (byte)PTR_DAT_676c2390[(uint)bVar6 * 2] & 4;
        this = PTR_DAT_676c2390;
      }
      else {
        pbVar7 = (byte *)0x4;
        uVar3 = FUN_676b0620(this,(uint)bVar6,4);
        this = pbVar7;
      }
      if (uVar3 == 0) break;
      if (local_8 < 0x19) {
        local_8 = local_8 + 1;
        pcVar4 = local_10 + 1;
        *local_10 = bVar6 - 0x30;
        local_10 = pcVar4;
      }
      else {
        local_c = local_c + 1;
      }
      bVar6 = *pbVar8;
      pbVar8 = pbVar8 + 1;
    }
    iVar9 = iVar1;
    iVar5 = local_14;
    if (bVar6 != DAT_676c25a0) goto LAB_676b6993;
    goto LAB_676b67f5;
  case 4:
    local_14 = 1;
    local_28 = 1;
    iVar9 = iVar5;
    if (local_8 == 0) {
      while (iVar5 = local_28, iVar9 = local_14, bVar6 == 0x30) {
        local_c = local_c + -1;
        bVar6 = *pbVar8;
        pbVar8 = pbVar8 + 1;
      }
    }
    while( true ) {
      local_14 = iVar9;
      local_28 = iVar5;
      if (DAT_676c259c < 2) {
        uVar3 = (byte)PTR_DAT_676c2390[(uint)bVar6 * 2] & 4;
        this = PTR_DAT_676c2390;
      }
      else {
        pbVar7 = (byte *)0x4;
        uVar3 = FUN_676b0620(this,(uint)bVar6,4);
        this = pbVar7;
      }
      if (uVar3 == 0) break;
      if (local_8 < 0x19) {
        local_8 = local_8 + 1;
        local_c = local_c + -1;
        pcVar4 = local_10 + 1;
        *local_10 = bVar6 - 0x30;
        local_10 = pcVar4;
      }
      bVar6 = *pbVar8;
      pbVar8 = pbVar8 + 1;
      iVar5 = local_28;
      iVar9 = local_14;
    }
LAB_676b6993:
    iVar9 = local_14;
    if ((bVar6 == 0x2b) || (bVar6 == 0x2d)) {
LAB_676b68a6:
      local_14 = iVar9;
      iVar9 = 0xb;
      pbVar8 = pbVar8 + -1;
      iVar5 = local_14;
    }
    else {
LAB_676b687f:
      if (((char)bVar6 < 'D') ||
         (('E' < (char)bVar6 && (((char)bVar6 < 'd' || ('e' < (char)bVar6)))))) goto LAB_676b6b11;
      iVar9 = 6;
      iVar5 = local_14;
    }
    goto LAB_676b67f5;
  case 5:
    local_28 = iVar5;
    if (DAT_676c259c < 2) {
      uVar3 = (byte)PTR_DAT_676c2390[(uint)bVar6 * 2] & 4;
      this = PTR_DAT_676c2390;
    }
    else {
      pbVar7 = (byte *)0x4;
      uVar3 = FUN_676b0620(this,(uint)bVar6,4);
      this = pbVar7;
    }
    iVar9 = iVar1;
    pbVar7 = param_3;
    if (uVar3 != 0) goto LAB_676b6a37;
    goto LAB_676b6b16;
  case 6:
    pbVar7 = pbVar7 + -1;
    this = pbVar7;
    param_3 = pbVar7;
    if (((char)bVar6 < '1') || ('9' < (char)bVar6)) {
      if (bVar6 == 0x2b) goto LAB_676b6a6c;
      if (bVar6 == 0x2d) goto LAB_676b6a60;
      if (bVar6 != 0x30) goto LAB_676b6b16;
LAB_676b6a05:
      iVar9 = 8;
      iVar5 = local_14;
      goto LAB_676b67f5;
    }
    break;
  case 7:
    if (((char)bVar6 < '1') || ('9' < (char)bVar6)) {
      pbVar7 = param_3;
      if (bVar6 == 0x30) goto LAB_676b6a05;
      goto LAB_676b6b16;
    }
    break;
  case 8:
    local_24 = 1;
    while (bVar6 == 0x30) {
      bVar6 = *pbVar8;
      pbVar8 = pbVar8 + 1;
    }
    if (((char)bVar6 < '1') || ('9' < (char)bVar6)) goto LAB_676b6b11;
    break;
  case 9:
    local_24 = 1;
    pbVar7 = (byte *)0x0;
    goto LAB_676b6a97;
  default:
    goto switchD_676b6801_caseD_a;
  case 0xb:
    if (param_7 != 0) {
      if (bVar6 == 0x2b) {
LAB_676b6a6c:
        iVar9 = 7;
        this = pbVar7;
        param_3 = pbVar7;
        iVar5 = local_14;
      }
      else {
        param_3 = pbVar7;
        if (bVar6 != 0x2d) goto LAB_676b6b16;
LAB_676b6a60:
        local_1c = -1;
        iVar9 = 7;
        this = pbVar7;
        param_3 = pbVar7;
        iVar5 = local_14;
      }
      goto LAB_676b67f5;
    }
    iVar9 = 10;
    pbVar8 = pbVar7;
switchD_676b6801_caseD_a:
    pbVar7 = pbVar8;
    iVar5 = local_14;
    if (iVar9 != 10) goto LAB_676b67f5;
    goto LAB_676b6b16;
  }
  iVar9 = 9;
LAB_676b6a37:
  pbVar8 = pbVar8 + -1;
  iVar5 = local_14;
  goto LAB_676b67f5;
LAB_676b6a97:
  if (DAT_676c259c < 2) {
    uVar3 = (byte)PTR_DAT_676c2390[(uint)bVar6 * 2] & 4;
    this = PTR_DAT_676c2390;
  }
  else {
    pbVar10 = (byte *)0x4;
    uVar3 = FUN_676b0620(this,(uint)bVar6,4);
    this = pbVar10;
  }
  if (uVar3 == 0) goto LAB_676b6ae1;
  this = (void *)(int)(char)bVar6;
  pbVar7 = (byte *)((int)this + (int)pbVar7 * 10 + -0x30);
  if (0x1450 < (int)pbVar7) goto LAB_676b6ad9;
  bVar6 = *pbVar8;
  pbVar8 = pbVar8 + 1;
  goto LAB_676b6a97;
LAB_676b6ad9:
  pbVar7 = (byte *)0x1451;
LAB_676b6ae1:
  while( true ) {
    local_20 = pbVar7;
    if (DAT_676c259c < 2) {
      uVar3 = (byte)PTR_DAT_676c2390[(uint)bVar6 * 2] & 4;
      this = PTR_DAT_676c2390;
    }
    else {
      pbVar7 = (byte *)0x4;
      uVar3 = FUN_676b0620(this,(uint)bVar6,4);
      this = pbVar7;
    }
    if (uVar3 == 0) break;
    bVar6 = *pbVar8;
    pbVar8 = pbVar8 + 1;
    pbVar7 = local_20;
  }
LAB_676b6b11:
  pbVar7 = pbVar8 + -1;
LAB_676b6b16:
  *param_2 = (int)pbVar7;
  if (local_14 == 0) {
    local_44 = 0;
    local_3a = 0;
    local_3e = (byte *)0x0;
    param_3 = (byte *)0x0;
    local_18 = 4;
    goto LAB_676b6c24;
  }
  pcVar4 = local_10;
  if (0x18 < local_8) {
    if ('\x04' < local_49) {
      local_49 = local_49 + '\x01';
    }
    local_8 = 0x18;
    local_c = local_c + 1;
    pcVar4 = local_10 + -1;
  }
  if (local_8 == 0) {
    local_44 = 0;
    local_3a = 0;
    local_3e = (byte *)0x0;
    param_3 = (byte *)0x0;
  }
  else {
    while (pcVar4 = pcVar4 + -1, *pcVar4 == '\0') {
      local_8 = local_8 - 1;
      local_c = local_c + 1;
    }
    FUN_676b66d7(local_60,local_8,(uint *)&local_44);
    pbVar8 = local_20;
    if (local_1c < 0) {
      pbVar8 = (byte *)-(int)local_20;
    }
    pbVar8 = pbVar8 + local_c;
    if (local_24 == 0) {
      pbVar8 = pbVar8 + param_5;
    }
    if (local_28 == 0) {
      pbVar8 = pbVar8 + -param_6;
    }
    if ((int)pbVar8 < 0x1451) {
      if (-0x1451 < (int)pbVar8) {
        FUN_676b72da((int *)&local_44,(uint)pbVar8,param_4);
        param_3 = (byte *)CONCAT22(uStack_40,uStack_42);
        goto LAB_676b6ba9;
      }
      local_34 = 1;
    }
    else {
      local_30 = 1;
    }
    local_3a = (ushort)param_3;
    local_3e = param_3;
    local_44 = local_3a;
  }
LAB_676b6ba9:
  if (local_30 == 0) {
    if (local_34 != 0) {
      local_44 = 0;
      local_3a = 0;
      local_3e = (byte *)0x0;
      param_3 = (byte *)0x0;
      local_18 = 1;
    }
  }
  else {
    param_3 = (byte *)0x0;
    local_3a = 0x7fff;
    local_3e = (byte *)0x80000000;
    local_44 = 0;
    local_18 = 2;
  }
LAB_676b6c24:
  *(byte **)(param_1 + 3) = local_3e;
  *(byte **)(param_1 + 1) = param_3;
  param_1[5] = local_3a | (ushort)local_2c;
  *param_1 = local_44;
  return local_18;
}



// Function: FUN_676b6c6f at 676b6c6f

undefined4 __cdecl
FUN_676b6c6f(uint param_1,uint param_2,uint param_3,int param_4,byte param_5,short *param_6)

{
  short *psVar1;
  uint uVar2;
  short *psVar3;
  char cVar4;
  uint uVar5;
  short *psVar6;
  short *psVar7;
  short sVar8;
  int iVar9;
  int iVar10;
  char *pcVar11;
  undefined1 local_20;
  undefined1 local_1f;
  undefined1 local_1e;
  undefined1 local_1d;
  undefined1 local_1c;
  undefined1 local_1b;
  undefined1 local_1a;
  undefined1 local_19;
  undefined1 local_18;
  undefined1 local_17;
  undefined1 local_16;
  undefined1 local_15;
  undefined2 local_14;
  undefined4 local_12;
  undefined4 local_e;
  undefined1 local_a;
  char cStack_9;
  undefined4 local_8;
  
  psVar3 = param_6;
  uVar5 = param_3 & 0x7fff;
  local_20 = 0xcc;
  local_1f = 0xcc;
  local_1e = 0xcc;
  local_1d = 0xcc;
  local_1c = 0xcc;
  local_1b = 0xcc;
  local_1a = 0xcc;
  local_19 = 0xcc;
  local_18 = 0xcc;
  local_17 = 0xcc;
  local_16 = 0xfb;
  local_15 = 0x3f;
  local_8 = 1;
  if ((param_3 & 0x8000) == 0) {
    *(undefined1 *)(param_6 + 1) = 0x20;
  }
  else {
    *(undefined1 *)(param_6 + 1) = 0x2d;
  }
  if ((((short)uVar5 != 0) || (param_2 != 0)) || (param_1 != 0)) {
    if ((short)uVar5 == 0x7fff) {
      *param_6 = 1;
      if (((param_2 == 0x80000000) && (param_1 == 0)) || ((param_2 & 0x40000000) != 0)) {
        if (((param_3 & 0x8000) == 0) || (param_2 != 0xc0000000)) {
          if ((param_2 != 0x80000000) || (param_1 != 0)) goto LAB_676b6d64;
          pcVar11 = "1#INF";
        }
        else {
          if (param_1 != 0) {
LAB_676b6d64:
            pcVar11 = "1#QNAN";
            goto LAB_676b6d69;
          }
          pcVar11 = "1#IND";
        }
        FUN_676b0530((uint *)(param_6 + 2),(uint *)pcVar11);
        *(undefined1 *)((int)psVar3 + 3) = 5;
      }
      else {
        pcVar11 = "1#SNAN";
LAB_676b6d69:
        FUN_676b0530((uint *)(param_6 + 2),(uint *)pcVar11);
        *(undefined1 *)((int)psVar3 + 3) = 6;
      }
      return 0;
    }
    local_14 = 0;
    local_a = (undefined1)uVar5;
    cStack_9 = (char)(uVar5 >> 8);
    sVar8 = (short)(((uVar5 >> 8) + (param_2 >> 0x18) * 2) * 0x4d + -0x134312f4 + uVar5 * 0x4d10 >>
                   0x10);
    local_e = param_2;
    local_12 = param_1;
    FUN_676b72da((int *)&local_14,-(int)sVar8,1);
    if (0x3ffe < CONCAT11(cStack_9,local_a)) {
      sVar8 = sVar8 + 1;
      FUN_676b70ba((int *)&local_14,(int *)&local_20);
    }
    *psVar3 = sVar8;
    iVar10 = param_4;
    if (((param_5 & 1) == 0) || (iVar10 = param_4 + sVar8, 0 < param_4 + sVar8)) {
      if (0x15 < iVar10) {
        iVar10 = 0x15;
      }
      iVar9 = CONCAT11(cStack_9,local_a) - 0x3ffe;
      local_a = 0;
      cStack_9 = '\0';
      param_6 = (short *)0x8;
      do {
        FUN_676b667c((uint *)&local_14);
        param_6 = (short *)((int)param_6 + -1);
      } while (param_6 != (short *)0x0);
      if (iVar9 < 0) {
        param_6 = (short *)0x0;
        for (uVar5 = -iVar9 & 0xff; uVar5 != 0; uVar5 = uVar5 - 1) {
          FUN_676b66aa((uint *)&local_14);
        }
      }
      param_4 = iVar10 + 1;
      psVar6 = psVar3 + 2;
      param_6 = psVar6;
      uVar5 = local_12;
      uVar2 = local_e;
      if (0 < param_4) {
        do {
          local_e._2_2_ = (undefined2)(uVar2 >> 0x10);
          local_e._0_2_ = (undefined2)uVar2;
          local_12._2_2_ = (undefined2)(uVar5 >> 0x10);
          local_12._0_2_ = (undefined2)uVar5;
          param_1 = CONCAT22((undefined2)local_12,local_14);
          param_2 = CONCAT22((undefined2)local_e,local_12._2_2_);
          param_3 = CONCAT13(cStack_9,CONCAT12(local_a,local_e._2_2_));
          local_12 = uVar5;
          local_e = uVar2;
          FUN_676b667c((uint *)&local_14);
          FUN_676b667c((uint *)&local_14);
          ___add_12((uint *)&local_14,&param_1);
          FUN_676b667c((uint *)&local_14);
          cVar4 = cStack_9;
          cStack_9 = '\0';
          psVar6 = (short *)((int)param_6 + 1);
          param_4 = param_4 + -1;
          *(char *)param_6 = cVar4 + '0';
          param_6 = psVar6;
          uVar5 = local_12;
          uVar2 = local_e;
        } while (param_4 != 0);
      }
      psVar7 = psVar6 + -1;
      psVar1 = psVar3 + 2;
      if ('4' < *(char *)((int)psVar6 + -1)) {
        for (; psVar1 <= psVar7; psVar7 = (short *)((int)psVar7 + -1)) {
          if ((char)*psVar7 != '9') {
            if (psVar1 <= psVar7) goto LAB_676b6ec1;
            break;
          }
          *(char *)psVar7 = '0';
        }
        psVar7 = (short *)((int)psVar7 + 1);
        *psVar3 = *psVar3 + 1;
LAB_676b6ec1:
        *(char *)psVar7 = (char)*psVar7 + '\x01';
LAB_676b6ec3:
        cVar4 = ((char)psVar7 - (char)psVar3) + -3;
        *(char *)((int)psVar3 + 3) = cVar4;
        *(undefined1 *)(cVar4 + 4 + (int)psVar3) = 0;
        return local_8;
      }
      for (; psVar1 <= psVar7; psVar7 = (short *)((int)psVar7 + -1)) {
        if ((char)*psVar7 != '0') {
          if (psVar1 <= psVar7) goto LAB_676b6ec3;
          break;
        }
      }
      *psVar3 = 0;
      *(undefined1 *)(psVar3 + 1) = 0x20;
      *(undefined1 *)((int)psVar3 + 3) = 1;
      *(char *)psVar1 = '0';
      goto LAB_676b6ef9;
    }
  }
  *psVar3 = 0;
  *(undefined1 *)(psVar3 + 1) = 0x20;
  *(undefined1 *)((int)psVar3 + 3) = 1;
  *(undefined1 *)(psVar3 + 2) = 0x30;
LAB_676b6ef9:
  *(undefined1 *)((int)psVar3 + 5) = 0;
  return 1;
}



// Function: FUN_676b6f02 at 676b6f02

uint __cdecl FUN_676b6f02(uint param_1)

{
  void *extraout_ECX;
  bool bVar1;
  void *this;
  
  if (DAT_676c5880 == 0) {
    if ((0x60 < (int)param_1) && ((int)param_1 < 0x7b)) {
      return param_1 - 0x20;
    }
  }
  else {
    InterlockedIncrement((LONG *)&DAT_676c5a18);
    bVar1 = DAT_676c5a14 != 0;
    this = extraout_ECX;
    if (bVar1) {
      InterlockedDecrement((LONG *)&DAT_676c5a18);
      this = (void *)0x13;
      FUN_676b20a4(0x13);
    }
    param_1 = FUN_676b6f71(this,param_1);
    if (bVar1) {
      FUN_676b2105(0x13);
    }
    else {
      InterlockedDecrement((LONG *)&DAT_676c5a18);
    }
  }
  return param_1;
}



// Function: FUN_676b6f71 at 676b6f71

uint __thiscall FUN_676b6f71(void *this,uint param_1)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  void *local_8;
  
  uVar1 = param_1;
  if (DAT_676c5880 == 0) {
    if ((0x60 < (int)param_1) && ((int)param_1 < 0x7b)) {
      uVar1 = param_1 - 0x20;
    }
  }
  else {
    local_8 = this;
    if ((int)param_1 < 0x100) {
      if (DAT_676c259c < 2) {
        uVar2 = (byte)PTR_DAT_676c2390[param_1 * 2] & 2;
      }
      else {
        uVar2 = FUN_676b0620(this,param_1,2);
      }
      if (uVar2 == 0) {
        return uVar1;
      }
    }
    if ((PTR_DAT_676c2390[((int)uVar1 >> 8 & 0xffU) * 2 + 1] & 0x80) == 0) {
      param_1 = CONCAT31((int3)(param_1 >> 8),(char)uVar1) & 0xffff00ff;
      iVar3 = 1;
    }
    else {
      uVar2 = param_1 >> 0x10;
      param_1._0_2_ = CONCAT11((char)uVar1,(char)(uVar1 >> 8));
      param_1 = CONCAT22((short)uVar2,(undefined2)param_1) & 0xff00ffff;
      iVar3 = 2;
    }
    iVar3 = FUN_676b63ae(DAT_676c5880,0x200,(char *)&param_1,iVar3,(LPWSTR)&local_8,3,0,1);
    if (iVar3 != 0) {
      if (iVar3 == 1) {
        uVar1 = (uint)local_8 & 0xff;
      }
      else {
        uVar1 = (uint)local_8 & 0xffff;
      }
    }
  }
  return uVar1;
}



// Function: FUN_676b7040 at 676b7040

int __cdecl FUN_676b7040(byte *param_1,byte *param_2)

{
  byte bVar1;
  int iVar2;
  byte abStack_28 [32];
  
  abStack_28[0x1c] = 0;
  abStack_28[0x1d] = 0;
  abStack_28[0x1e] = 0;
  abStack_28[0x1f] = 0;
  abStack_28[0x18] = 0;
  abStack_28[0x19] = 0;
  abStack_28[0x1a] = 0;
  abStack_28[0x1b] = 0;
  abStack_28[0x14] = 0;
  abStack_28[0x15] = 0;
  abStack_28[0x16] = 0;
  abStack_28[0x17] = 0;
  abStack_28[0x10] = 0;
  abStack_28[0x11] = 0;
  abStack_28[0x12] = 0;
  abStack_28[0x13] = 0;
  abStack_28[0xc] = 0;
  abStack_28[0xd] = 0;
  abStack_28[0xe] = 0;
  abStack_28[0xf] = 0;
  abStack_28[8] = 0;
  abStack_28[9] = 0;
  abStack_28[10] = 0;
  abStack_28[0xb] = 0;
  abStack_28[4] = 0;
  abStack_28[5] = 0;
  abStack_28[6] = 0;
  abStack_28[7] = 0;
  abStack_28[0] = 0;
  abStack_28[1] = 0;
  abStack_28[2] = 0;
  abStack_28[3] = 0;
  while( true ) {
    bVar1 = *param_2;
    if (bVar1 == 0) break;
    param_2 = param_2 + 1;
    abStack_28[(int)(uint)bVar1 >> 3] = abStack_28[(int)(uint)bVar1 >> 3] | '\x01' << (bVar1 & 7);
  }
  iVar2 = -1;
  do {
    iVar2 = iVar2 + 1;
    bVar1 = *param_1;
    if (bVar1 == 0) {
      return iVar2;
    }
    param_1 = param_1 + 1;
  } while ((abStack_28[(int)(uint)bVar1 >> 3] >> (bVar1 & 7) & 1) == 0);
  return iVar2;
}



// Function: FUN_676b7080 at 676b7080

byte * __cdecl FUN_676b7080(byte *param_1,byte *param_2)

{
  byte bVar1;
  byte *pbVar2;
  byte abStack_28 [32];
  
  abStack_28[0x1c] = 0;
  abStack_28[0x1d] = 0;
  abStack_28[0x1e] = 0;
  abStack_28[0x1f] = 0;
  abStack_28[0x18] = 0;
  abStack_28[0x19] = 0;
  abStack_28[0x1a] = 0;
  abStack_28[0x1b] = 0;
  abStack_28[0x14] = 0;
  abStack_28[0x15] = 0;
  abStack_28[0x16] = 0;
  abStack_28[0x17] = 0;
  abStack_28[0x10] = 0;
  abStack_28[0x11] = 0;
  abStack_28[0x12] = 0;
  abStack_28[0x13] = 0;
  abStack_28[0xc] = 0;
  abStack_28[0xd] = 0;
  abStack_28[0xe] = 0;
  abStack_28[0xf] = 0;
  abStack_28[8] = 0;
  abStack_28[9] = 0;
  abStack_28[10] = 0;
  abStack_28[0xb] = 0;
  abStack_28[4] = 0;
  abStack_28[5] = 0;
  abStack_28[6] = 0;
  abStack_28[7] = 0;
  abStack_28[0] = 0;
  abStack_28[1] = 0;
  abStack_28[2] = 0;
  abStack_28[3] = 0;
  while( true ) {
    bVar1 = *param_2;
    if (bVar1 == 0) break;
    param_2 = param_2 + 1;
    abStack_28[(int)(uint)bVar1 >> 3] = abStack_28[(int)(uint)bVar1 >> 3] | '\x01' << (bVar1 & 7);
  }
  do {
    pbVar2 = param_1;
    bVar1 = *pbVar2;
    if (bVar1 == 0) {
      return (byte *)(uint)bVar1;
    }
    param_1 = pbVar2 + 1;
  } while ((abStack_28[(int)(uint)bVar1 >> 3] >> (bVar1 & 7) & 1) == 0);
  return pbVar2;
}



// Function: FUN_676b70ba at 676b70ba

void __cdecl FUN_676b70ba(int *param_1,int *param_2)

{
  int *piVar1;
  short sVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  ushort uVar6;
  uint uVar7;
  int iVar8;
  ushort uVar9;
  uint uVar10;
  ushort uVar11;
  byte local_28;
  undefined1 uStack_27;
  undefined2 uStack_26;
  short local_24;
  undefined2 uStack_22;
  undefined2 local_20;
  undefined1 uStack_1e;
  byte bStack_1d;
  int *local_1c;
  int local_18;
  int local_14;
  ushort *local_10;
  ushort *local_c;
  short *local_8;
  
  piVar5 = param_2;
  piVar4 = param_1;
  local_18 = 0;
  local_28 = 0;
  uStack_27 = 0;
  uStack_26 = 0;
  local_24 = 0;
  uStack_22 = 0;
  local_20 = 0;
  uStack_1e = 0;
  bStack_1d = 0;
  uVar7 = *(ushort *)((int)param_1 + 10) & 0x7fff;
  uVar10 = *(ushort *)((int)param_2 + 10) & 0x7fff;
  uVar11 = (*(ushort *)((int)param_2 + 10) ^ *(ushort *)((int)param_1 + 10)) & 0x8000;
  uVar6 = (ushort)uVar7;
  piVar1 = (int *)(uVar10 + uVar7);
  if (((uVar6 < 0x7fff) && (uVar9 = (ushort)uVar10, uVar9 < 0x7fff)) && ((ushort)piVar1 < 0xbffe)) {
    if ((ushort)piVar1 < 0x3fc0) {
LAB_676b715d:
      piVar4[2] = 0;
      piVar4[1] = 0;
      *piVar4 = 0;
      return;
    }
    if (((uVar6 != 0) || (piVar1 = (int *)((int)piVar1 + 1), (param_1[2] & 0x7fffffffU) != 0)) ||
       ((uVar6 = 0, param_1[1] != 0 || (*param_1 != 0)))) {
      param_1 = piVar1;
      if (((uVar9 == 0) && (param_1 = (int *)((int)param_1 + 1), (param_2[2] & 0x7fffffffU) == 0))
         && ((param_2[1] == 0 && (*param_2 == 0)))) goto LAB_676b715d;
      local_14 = 0;
      local_8 = &local_24;
      param_2 = (int *)0x5;
      do {
        if (0 < (int)param_2) {
          local_c = (ushort *)(local_14 * 2 + (int)piVar4);
          local_10 = (ushort *)(piVar5 + 2);
          local_1c = param_2;
          do {
            iVar8 = FUN_676b65fd(*(uint *)(local_8 + -2),(uint)*local_c * (uint)*local_10,
                                 (uint *)(local_8 + -2));
            if (iVar8 != 0) {
              *local_8 = *local_8 + 1;
            }
            local_c = local_c + 1;
            local_10 = local_10 + -1;
            local_1c = (int *)((int)local_1c + -1);
          } while (local_1c != (int *)0x0);
        }
        local_8 = local_8 + 1;
        local_14 = local_14 + 1;
        param_2 = (int *)((int)param_2 + -1);
      } while (0 < (int)param_2);
      param_1 = (int *)((int)param_1 + 0xc002);
      if ((short)(ushort)param_1 < 1) {
LAB_676b7211:
        param_1._0_2_ = (ushort)param_1 - 1;
        if ((short)(ushort)param_1 < 0) {
          iVar8 = -(int)(short)(ushort)param_1;
          param_1._0_2_ = (ushort)param_1 + (short)iVar8;
          do {
            if ((local_28 & 1) != 0) {
              local_18 = local_18 + 1;
            }
            FUN_676b66aa((uint *)&local_28);
            iVar8 = iVar8 + -1;
          } while (iVar8 != 0);
          if (local_18 != 0) {
            local_28 = local_28 | 1;
          }
        }
      }
      else {
        do {
          if ((bStack_1d & 0x80) != 0) break;
          FUN_676b667c((uint *)&local_28);
          param_1 = (int *)((int)param_1 + 0xffff);
        } while (0 < (short)(ushort)param_1);
        if ((short)(ushort)param_1 < 1) goto LAB_676b7211;
      }
      if ((0x8000 < CONCAT11(uStack_27,local_28)) ||
         (sVar2 = CONCAT11(bStack_1d,uStack_1e), iVar3 = CONCAT22(local_20,uStack_22),
         iVar8 = CONCAT22(local_24,uStack_26),
         (CONCAT22(uStack_26,CONCAT11(uStack_27,local_28)) & 0x1ffff) == 0x18000)) {
        if (CONCAT22(local_24,uStack_26) == -1) {
          iVar8 = 0;
          if (CONCAT22(local_20,uStack_22) == -1) {
            if (CONCAT11(bStack_1d,uStack_1e) == -1) {
              param_1._0_2_ = (ushort)param_1 + 1;
              sVar2 = -0x8000;
              iVar3 = 0;
              iVar8 = 0;
            }
            else {
              sVar2 = CONCAT11(bStack_1d,uStack_1e) + 1;
              iVar3 = 0;
              iVar8 = 0;
            }
          }
          else {
            sVar2 = CONCAT11(bStack_1d,uStack_1e);
            iVar3 = CONCAT22(local_20,uStack_22) + 1;
          }
        }
        else {
          iVar8 = CONCAT22(local_24,uStack_26) + 1;
          sVar2 = CONCAT11(bStack_1d,uStack_1e);
          iVar3 = CONCAT22(local_20,uStack_22);
        }
      }
      local_24 = (short)((uint)iVar8 >> 0x10);
      uStack_26 = (undefined2)iVar8;
      local_20 = (undefined2)((uint)iVar3 >> 0x10);
      uStack_22 = (undefined2)iVar3;
      bStack_1d = (byte)((ushort)sVar2 >> 8);
      uStack_1e = (undefined1)sVar2;
      if (0x7ffe < (ushort)param_1) goto LAB_676b72ba;
      uVar6 = (ushort)param_1 | uVar11;
      *(undefined2 *)piVar4 = uStack_26;
      *(uint *)((int)piVar4 + 2) = CONCAT22(uStack_22,local_24);
      *(uint *)((int)piVar4 + 6) = CONCAT13(bStack_1d,CONCAT12(uStack_1e,local_20));
    }
    *(ushort *)((int)piVar4 + 10) = uVar6;
  }
  else {
LAB_676b72ba:
    piVar4[1] = 0;
    *piVar4 = 0;
    piVar4[2] = (-(uint)(uVar11 != 0) & 0x80000000) + 0x7fff8000;
  }
  return;
}



// Function: FUN_676b72da at 676b72da

void __cdecl FUN_676b72da(int *param_1,uint param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  undefined **ppuVar3;
  undefined **ppuVar4;
  undefined2 local_10;
  undefined4 local_e;
  undefined2 uStack_a;
  undefined *puStack_8;
  
  ppuVar3 = &PTR_DAT_676c4c60;
  if (param_2 != 0) {
    if ((int)param_2 < 0) {
      param_2 = -param_2;
      ppuVar3 = (undefined **)0x676c4dc0;
    }
    if (param_3 == 0) {
      *(undefined2 *)param_1 = 0;
    }
    while (param_2 != 0) {
      ppuVar3 = ppuVar3 + 0x15;
      uVar1 = (int)param_2 >> 3;
      uVar2 = param_2 & 7;
      param_2 = uVar1;
      if (uVar2 != 0) {
        ppuVar4 = ppuVar3 + uVar2 * 3;
        if (0x7fff < *(ushort *)(ppuVar3 + uVar2 * 3)) {
          local_10 = SUB42(*ppuVar4,0);
          local_e._0_2_ = (undefined2)((uint)*ppuVar4 >> 0x10);
          local_e._2_2_ = SUB42(ppuVar4[1],0);
          uStack_a = (undefined2)((uint)ppuVar4[1] >> 0x10);
          puStack_8 = ppuVar4[2];
          local_e = CONCAT22(local_e._2_2_,(undefined2)local_e) + -1;
          ppuVar4 = (undefined **)&local_10;
        }
        FUN_676b70ba(param_1,(int *)ppuVar4);
      }
    }
  }
  return;
}



// Function: FUN_676b7360 at 676b7360

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

uint __thiscall FUN_676b7360(void *this,byte *param_1,byte *param_2)

{
  bool bVar1;
  int iVar2;
  byte bVar3;
  byte bVar4;
  byte bVar5;
  uint uVar6;
  void *extraout_ECX;
  void *this_00;
  void *extraout_ECX_00;
  uint uVar7;
  uint uVar8;
  
  iVar2 = _DAT_676c5a18;
  if (DAT_676c5880 == 0) {
    bVar5 = 0xff;
    do {
      do {
        if (bVar5 == 0) goto LAB_676b73ae;
        bVar5 = *param_2;
        param_2 = param_2 + 1;
        bVar4 = *param_1;
        param_1 = param_1 + 1;
      } while (bVar4 == bVar5);
      bVar3 = bVar5 + 0xbf + (-((byte)(bVar5 + 0xbf) < 0x1a) & 0x20U) + 0x41;
      bVar4 = bVar4 + 0xbf;
      bVar5 = bVar4 + (-(bVar4 < 0x1a) & 0x20U) + 0x41;
    } while (bVar5 == bVar3);
    bVar5 = (bVar5 < bVar3) * -2 + 1;
LAB_676b73ae:
    uVar6 = (uint)(char)bVar5;
  }
  else {
    LOCK();
    _DAT_676c5a18 = _DAT_676c5a18 + 1;
    UNLOCK();
    bVar1 = 0 < DAT_676c5a14;
    if (bVar1) {
      LOCK();
      UNLOCK();
      _DAT_676c5a18 = iVar2;
      FUN_676b20a4(0x13);
      this = extraout_ECX;
    }
    uVar8 = (uint)bVar1;
    uVar6 = 0xff;
    uVar7 = 0;
    do {
      do {
        if ((char)uVar6 == '\0') goto LAB_676b740f;
        bVar5 = *param_2;
        uVar6 = CONCAT31((int3)(uVar6 >> 8),bVar5);
        param_2 = param_2 + 1;
        bVar4 = *param_1;
        uVar7 = CONCAT31((int3)(uVar7 >> 8),bVar4);
        param_1 = param_1 + 1;
      } while (bVar5 == bVar4);
      uVar7 = FUN_676b4e5a(this,uVar7);
      uVar6 = FUN_676b4e5a(this_00,uVar6);
      this = extraout_ECX_00;
    } while ((byte)uVar7 == (byte)uVar6);
    uVar7 = (uint)((byte)uVar7 < (byte)uVar6);
    uVar6 = (1 - uVar7) - (uint)(uVar7 != 0);
LAB_676b740f:
    if (uVar8 == 0) {
      LOCK();
      _DAT_676c5a18 = _DAT_676c5a18 + -1;
      UNLOCK();
    }
    else {
      FUN_676b2105(0x13);
    }
  }
  return uVar6;
}



// Function: FUN_676b7430 at 676b7430

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void * __cdecl FUN_676b7430(byte *param_1,char *param_2,void *param_3)

{
  char cVar1;
  int iVar2;
  byte bVar3;
  ushort uVar4;
  uint uVar5;
  void *this;
  uint uVar6;
  bool bVar7;
  uint uVar8;
  
  iVar2 = _DAT_676c5a18;
  if (param_3 != (void *)0x0) {
    if (DAT_676c5880 == 0) {
      do {
        bVar3 = *param_1;
        cVar1 = *param_2;
        uVar4 = CONCAT11(bVar3,cVar1);
        if (bVar3 == 0) break;
        uVar4 = CONCAT11(bVar3,cVar1);
        uVar6 = (uint)uVar4;
        if (cVar1 == '\0') break;
        param_1 = param_1 + 1;
        param_2 = param_2 + 1;
        if ((0x40 < bVar3) && (bVar3 < 0x5b)) {
          uVar6 = (uint)CONCAT11(bVar3 + 0x20,cVar1);
        }
        uVar4 = (ushort)uVar6;
        bVar3 = (byte)uVar6;
        if ((0x40 < bVar3) && (bVar3 < 0x5b)) {
          uVar4 = (ushort)CONCAT31((int3)(uVar6 >> 8),bVar3 + 0x20);
        }
        bVar3 = (byte)(uVar4 >> 8);
        bVar7 = bVar3 < (byte)uVar4;
        if (bVar3 != (byte)uVar4) goto LAB_676b748f;
        param_3 = (void *)((int)param_3 + -1);
      } while (param_3 != (void *)0x0);
      param_3 = (void *)0x0;
      bVar3 = (byte)(uVar4 >> 8);
      bVar7 = bVar3 < (byte)uVar4;
      if (bVar3 != (byte)uVar4) {
LAB_676b748f:
        param_3 = (void *)0xffffffff;
        if (!bVar7) {
          param_3 = (void *)0x1;
        }
      }
    }
    else {
      LOCK();
      _DAT_676c5a18 = _DAT_676c5a18 + 1;
      UNLOCK();
      bVar7 = 0 < DAT_676c5a14;
      if (bVar7) {
        LOCK();
        UNLOCK();
        _DAT_676c5a18 = iVar2;
        FUN_676b20a4(0x13);
      }
      uVar8 = (uint)bVar7;
      uVar5 = 0;
      uVar6 = 0;
      do {
        uVar5 = CONCAT31((int3)(uVar5 >> 8),*param_1);
        uVar6 = CONCAT31((int3)(uVar6 >> 8),*param_2);
        if ((uVar5 == 0) || (uVar6 == 0)) break;
        param_1 = param_1 + 1;
        param_2 = param_2 + 1;
        uVar6 = FUN_676b4e5a(param_3,uVar6);
        uVar5 = FUN_676b4e5a(this,uVar5);
        bVar7 = uVar5 < uVar6;
        if (uVar5 != uVar6) goto LAB_676b7505;
        param_3 = (void *)((int)param_3 + -1);
      } while (param_3 != (void *)0x0);
      param_3 = (void *)0x0;
      bVar7 = uVar5 < uVar6;
      if (uVar5 != uVar6) {
LAB_676b7505:
        param_3 = (void *)0xffffffff;
        if (!bVar7) {
          param_3 = (void *)0x1;
        }
      }
      if (uVar8 == 0) {
        LOCK();
        _DAT_676c5a18 = _DAT_676c5a18 + -1;
        UNLOCK();
      }
      else {
        FUN_676b2105(0x13);
      }
    }
  }
  return param_3;
}



