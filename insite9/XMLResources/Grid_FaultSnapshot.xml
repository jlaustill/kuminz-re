<!-- CHANAGE HISTORY
7/1/2005 Bharati Chaudhari(fk669) Changed for sorting of faultcodes 
06/11/2009 VV(is310) Replaced getAttribute(Description) to Text
8/19/2009  hk283   DB_G00144093	  Edited the header to add Customer Name
11/25/2009  hz225   DB_G00148748  Added column numbers 2 and 3 in ColoumnRowDetail
12/24/2009  hw281   DB_G00149871  Changed Column Width of 10th column, since some fault code numbers consists 6 digits
-->

<!-- This is a sample  -->
<FlexGrid xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">


	<Properties Cols="10:VT_I4" FixedCols="0:VT_I4" ExplorerBar="0:VT_I4" GridLines="1:VT_I4" OutlineBar="5:VT_I4"
	AllowUserResizing="1:VT_UI4"  Editable="0:VT_I4" ColWidthMax="3500:VT_I4" AutoResize="1:VT_I4"/>
	<ColoumnRowDetail CustomRowHeight="1:VT_I4" ColoumnNumber="1:VT_I4,2:VT_I4,3:VT_I4,4:VT_I4"/>
	<!-- Add properties to the "FlexGrid" element as attribute in Name=Value format -->
	<FixedRows>
		<FixedRow styleid="s1">
			<Column name="RES:Res1:101" />
			<Column name="RES:Res1:104" />
			<Column name="RES:Res1:107" />
			<Column name="RES:Res1:105" />
			<Column name="RES:Res1:117" />
			<Column name="RES:Res1:111" />
			<Column name="RES:Res1:113" />
			<Column name="RES:Res1:165" />
			<Column name="RES:Res1:166" />
			<Column name="RES:Res1:114" />
		</FixedRow>
		<FixedRow>
			<Column name="" />
			<Column name="RES:Res1:118" />
			<Column name="RES:Res1:119" />
			<Column name="RES:Res1:120" />
			<Column name="RES:Res1:121" />
			
		</FixedRow>
	</FixedRows>
	

	<data loopEnd="1">
		<Object name="n2" source="OBJ:VSFLEXGRID:ColWidth(0,900)PROPPUT" />
		<Object name="n2" source="OBJ:VSFLEXGRID:ColWidth(1,1800)PROPPUT" />
		<Object name="n2" source="OBJ:VSFLEXGRID:ColWidth(2,800)PROPPUT" />
		<Object name="n2" source="OBJ:VSFLEXGRID:ColWidth(3,800)PROPPUT" />
		<Object name="n2" source="OBJ:VSFLEXGRID:ColWidth(4,2000)PROPPUT" />
		<Object name="n2" source="OBJ:VSFLEXGRID:ColWidth(5,400)PROPPUT" />
		<Object name="n2" source="OBJ:VSFLEXGRID:ColWidth(6,400)PROPPUT" />
		<Object name="n2" source="OBJ:VSFLEXGRID:ColWidth(7,600)PROPPUT" />
		<Object name="n2" source="OBJ:VSFLEXGRID:ColWidth(8,600)PROPPUT" />
                <Object name="n2" source="OBJ:VSFLEXGRID:ColWidth(9,700)PROPPUT" />
		<!-- If there are no fault codes in the ECM, " -->
		<Node level = "0" loopStart="OBJ:DOM:selectNodes(FAvail):length" loopEnd="1" >
			<!-- Print "No Fault Codes Detected. -->
			<Column order = "0" datasource ="RES:Res1:202" />
		</Node>
		<!-- Else, begin faults display, (loop below will be executed only once) -->
		<Node level = "0" loopStart="0" loopEnd="OBJ:DOM:selectNodes(FAvail):length" >
			<!-- Print the first row, showing ModuleName, ECM Time etc. -->
			<Column order = "0" datasource ="OBJ:DOM:selectSingleNode(pID15):getAttribute(DV)" />
			<Column order = "1" datasource ="OBJ:DOM:selectSingleNode(pID7):getAttribute(N)" />
			<Column order = "2" datasource ="OBJ:DOM:selectSingleNode(pID7):getAttribute(DV)" />
			<Column order = "4" datasource ="OBJ:DOM:selectSingleNode(pID7):getAttribute(U)" />
                        <Node level="1" loopStart="0" loopEnd="1">
				<Column order="1" datasource="OBJ:DOM:selectSingleNode(pID9):getAttribute(N)"/>
				<Column order="2" datasource="OBJ:DOM:selectSingleNode(pID9):getAttribute(DV)"/>
				<Column order="4" datasource="OBJ:DOM:selectSingleNode(pID9):getAttribute(U)"/>
			</Node>
			 
			<Node level = "1" loopStart="0" loopEnd="1" >
				<Column order = "1" datasource ="OBJ:DOM:selectSingleNode(pID10):getAttribute(N)" />
				<Column order = "2" datasource ="OBJ:DOM:selectSingleNode(pID10):getAttribute(DV)" styleid="s2"/>
			</Node>
			
			<!-- Get all faults in the module. -->
			<Object name="Faults" source="OBJ:DOM:selectNodes(a1D1I)"/>
			<!-- Get the Faults Description node for this module from FaultsInfo_XX.xml -->
			<Object name="FIECM" source="OBJ:FIDOM:selectSingleNode(fiECM1)" />

			<Node level = "1" loopStart="0" loopEnd="OBJ:Faults:length" styleid="s1" >
				<!-- Print the fault code alongwith the description -->
				<Object name="FItem1" source="OBJ:Faults:nextNode" />
				<Object name="FINode" source="OBJ:FIECM:selectSingleNode(fiDesc)" />
				<Column order = "0" datasource ="OBJ:FItem1:getAttribute(Code)" />
				<Column order = "1" datasource ="OBJ:FItem1:getAttribute(Status)" />
				<Column order = "2" datasource ="OBJ:FItem1:getAttribute(Count)" />
				<Column order = "3" datasource ="OBJ:FIClrCode:selectSingleNode(ClrCode):Text" />
				<Column order = "4" datasource ="OBJ:FINode:Text" styleid="s3"/>
				<Column order = "5" datasource ="OBJ:FINode:getAttribute(PID)" />
				<Column order = "6" datasource ="OBJ:FINode:getAttribute(SID)" />
				<Column order = "7" datasource ="OBJ:FINode:getAttribute(FMI)" />
				<Column order = "8" datasource ="OBJ:FINode:getAttribute(FMI2)" />
				<Column order = "9" datasource ="OBJ:FINode:getAttribute(SPN)" />
	
				<!-- Get Fault Snapshot data -->
				<Object name="FPInfoList" source="OBJ:FItem1:selectNodes(pF)" />
					
				<!-- If no snapshot data is available  -->
				<Node level = "2" loopStart="OBJ:FPInfoList:length" loopEnd="1" >
					<Column order = "1" datasource ="RES:Res1:199" />
				</Node>
				<!-- Else, print all parameters in the snapshot data. -->
				<Node level = "2" loopStart="0" loopEnd="OBJ:FPInfoList:length" >
					<Object name="FP" source="OBJ:FPInfoList:item(LOOPINDEX2)"/>
					<Column order = "1" datasource ="OBJ:FP:getAttribute(N)" />
					<Column order = "2" datasource ="OBJ:FP:getAttribute(FDV)" styleid="s2"/>
					<Column order = "3" datasource ="OBJ:FP:getAttribute(LDV)" styleid="s2"/>
					<Column order = "4" datasource ="OBJ:FP:getAttribute(U)" />
				</Node>
			</Node>
		</Node>
		<Object name="n1" source="OBJ:VSFLEXGRID:AutoSize(4)" />
	</data>

	<parameters>
	 <parameter name="pID15" source="/root/Image/Parameters/P[@ID=15]"/>
	 <parameter name="pID10" source="/root/Image/Parameters/P[@ID=10]"/>
	 <parameter name="pID7" source="/root/Image/Parameters/P[@ID=7]"/>
     <parameter name="pID9" source="/root/Image/Parameters/P[@ID=9]"/>
	 <parameter name="a1D1I" source="/root/Faults[@ModuleID =0]/Fault"/>	 
	 <parameter name="FAvail" source="/root/Image/Arrays/A[@ID=2]/Dim/I[@Num=0]/Dim/I[./P[@ID=199021 and @V = 1] and @Num=0]"/>
	 <parameter name="fiDesc" source="./FAULT_CODE[@FaultCode=" source1="OBJ:FItem1:getAttribute(Code)" source2="]"/>
	 <parameter name="fiECM" source="/ROOT/RESOURCE/FAULT_INFO[@ECMID=" source1="OBJ:DOM:selectSingleNode(pImage):getAttribute(ModType)" source2="]"/> 
	 <parameter name="fiECM1" source="/ROOT/RESOURCE/FAULT_INFO[@ECMID=/ROOT/ECM_MAP/ECM_GROUP[./ECM[@ID=" source1="OBJ:DOM:selectSingleNode(pImage):getAttribute(ModType)" source2="]]/@Resource]"/> 
 	 <parameter name="a2DID0DI2" source="/root/Image/Arrays/A[@ID=2]/Dim/I[@Num=0]/Dim/I[./P[@ID=199008 and @V = " source1="OBJ:FItem1:getAttribute(Code)" source2="]]/P[@R = 1 and @ID != 199008 and @ID != 199021 ]"/>
 	 <parameter name="a2DID0DI199555" source="/root/Image/Arrays/A[@ID=" source1="OBJ:DOM:selectSingleNode(pFaultArray):getAttribute(V)" source2="]/Dim/I[@Num=0]/Dim/I[./P[@ID=199008 and @V = " source3="OBJ:FItem1:selectSingleNode(pFCode):getAttribute(DV)" source4="]]/P[@R = 1 and @ID != 199008 and @ID != 199021 ]"/>
	 <parameter name="a2DID1DI2" source="/root/Image/Arrays/A[@ID=2]/Dim/I[@Num=1]/Dim/I[./P[@ID=199008 and @V = " source1="OBJ:FItem1:getAttribute(Code)" source2="]]/P[@R = 1 and @ID != 199008 and @ID != 199021 ]"/>
	 <parameter name="a2DID1DI199555" source="/root/Image/Arrays/A[@ID=" source1="OBJ:DOM:selectSingleNode(pFaultArray):getAttribute(V)" source2="]/Dim/I[@Num=1]/Dim/I[./P[@ID=199008 and @V = " source3="OBJ:FItem1:selectSingleNode(pFCode):getAttribute(DV)" source4="]]/P[@R = 1 and @ID != 199008 and @ID != 199021 ]"/>
	 <parameter name="pRow" source="OBJ:VSFLEXGRID:Row"/>
     <parameter name="ClrCode" source="/XML_RESOURCE/RESOURCE/STRING[@Context='" source1="OBJ:FINode:getAttribute(Lamp)" source2="']"/>
     <parameter name="pFaultArray" source="/root/Image/Parameters/P[@ID=199555]"/>
     <parameter name="pF" source="./P"/> 
     <parameter name="pImage" source="/root/Image"/>
	</parameters>

	<icons>
	</icons>
	
	<combolists>
	</combolists>
	
	<styles>
		<style id="s1" CellFontBold="1:VT_I4" CellAlignMent="1:VT_I4" />
		<style id="s2"  CellAlignMent="0:VT_I4"/>
		<style id="s3"  AutoSizeMode="1:VT_I4" WordWrap="1" CellFontBold="1:VT_I4" />
	</styles>
	
	<resources>
		<resource id="Res1" CLSID="{1332CA33-AB73-4B5B-95AE-051831C69A91}" LoadDLL="TRUE"/>
	</resources>
	
	<printing HdrFontSize="8" >
		<header>
			<line>
				<center source="RES:Res1:225" />
			</line>
			<line>
				<left source="RES:Res1:220" />
				<left source="OBJ:DOM:selectSingleNode(/root/Image/Header/ESerial):getAttribute(DisplayValue)" />
				<right source="INSITE - " />
				<right source="OBJ:DOM:selectSingleNode(/root/Image):getAttribute(ImageVersion)" />
			</line>
			<line>
				<left source="RES:Res1:219" />
				<left source="OBJ:DOM:selectSingleNode(/root/Image/Header/UNumber):getAttribute(DisplayValue)" />
				<right source="RES:Res1:221" />
				<right source="OBJ:DOM:selectSingleNode(/root/Image/Header/VMake):getAttribute(DisplayValue)" />
			</line>
			<line>
				<left source="RES:Res1:222" />
				<left source="OBJ:DOM:selectSingleNode(/root/Image/Header/WOName):getAttribute(DisplayValue)" />
				<right source="RES:Res1:223" />
				<right source="OBJ:DOM:selectSingleNode(/root/Image/Header/IName):getAttribute(DisplayValue)" />
			</line>
			<line>
				<right source="RES:Res1:224"/>
				<right source="OBJ:DOM:selectSingleNode(/root/Image/Header/CustomerName):getAttribute(DisplayValue)"/>
			</line>
		</header>
		
	</printing>

</FlexGrid>
