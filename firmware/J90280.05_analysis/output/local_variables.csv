function_address,function_name,first_use_address,new_variable_name,type,comment
# Format: The third column is now the ADDRESS where the variable is first assigned/used
# Run the script once with placeholder addresses (like 0x0) to see actual first-use addresses
# Then update this file with the correct addresses from the debug output
#
# Example workflow:
# 1. Add entry with first_use_address=0x0 (will fail but show available variables)
"# 2. Check output for ""Available variables:"" with their first-use addresses"
# 3. Update the CSV with the correct first-use address
# 4. Re-run the script
#
# diagnosticCommandDispatcher local variables
#
# -----------------------------------------------------------------------------
# memoryOperationDispatcher @ 0x1b37a - Core memory write handler (Service 0x4B)
# Note: Uses systemSecurityCheckStub_AlwaysPasses (security DISABLED in this version)
# J90350.00 evolved to use hourMeterSecurityValidator (real security)
# Key difference: In J90280.05, any write with auth payload passes security check
# -----------------------------------------------------------------------------
# memoryOperationDispatcher local variables (has 2 systemSecurityCheck calls in cases 3 and 5)
#
# diagnosticServiceSecurityValidator local variables
#
# engine_speed_governor local variables - PID speed controller
# Index-based discovery: use 0-99 as first_use_address to select variable by index
# Script lists variables sorted by first-use address, selects by index, updates CSV with real address
# Use index 99 (out of range) to see list of available variables with their indices
# Variables from discovery (sorted by first-use address):
#   0: iVar2 (int) @ 0xb6c8 -> rpm_error_integral
#   1: wStack_6 (word) @ 0xb7ae -> rpm_error_clamped
#   2: wVar4 (word) @ 0xb7ba -> rpm_error_previous
#   3: wVar3 (word) @ 0xb9ea -> pid_output_previous
#   4: wVar5 (word) @ 0xb9ea -> derivative_term_previous
#   5: iVar1 (int) @ 0xbcf4 -> fuel_command_scaled
0x0000b656,engine_speed_governor,0xb6c8,rpm_error_integral,int,PID integral accumulator for speed error
0x0000b656,engine_speed_governor,0xb7ae,rpm_error_clamped,word,Clamped RPM error for PID calculation
0x0000b656,engine_speed_governor,0xb7ba,rpm_error_previous,word,Previous governor_rpm_error value for delta calculation
0x0000b656,engine_speed_governor,0xb97e,pid_output_previous,word,Previous PID combined output for feedback loop
0x0000b656,engine_speed_governor,0xb9ea,derivative_term_previous,word,Previous derivative term for filtering
0x00012484,diagnosticCommandDispatcher,0x1256c,subFunctionCode,byte,Sub-function code extracted from message
0x00012484,diagnosticCommandDispatcher,0x12580,securityCheckResult,char,Result from systemSecurityCheck() - 0=authorized nonzero=denied
0x0001b37a,memoryOperationDispatcher,0x1b45a,securityCheckResult3,char,Result from systemSecurityCheck() - third call in case 3
0x0001b37a,memoryOperationDispatcher,0x1b4c4,securityCheckResult,char,Result from systemSecurityCheck() in case 5 - 0=authorized nonzero=denied
0x0001b37a,memoryOperationDispatcher,0x1b4f0,securityCheckResult2,char,Result from systemSecurityCheck() in case 3 - 0=authorized nonzero=denied

# -----------------------------------------------------------------------------
# addressRangeValidator @ 0x2b544 - Validates memory address against 5-entry range table
# Returns: MEMORY_ACCESS_FLAG (0=direct, 3=secured, 4=denied, 5=logging, 9=invalid)
# 100% matched with J90350.00 (same algorithm, different address)
# Uses address_range_validation_table at 0x801be8 (5 entries x 10 bytes each)
# Variables: bVar2=table_index, uVar3=end_address, puVar4=table_entry_ptr
# -----------------------------------------------------------------------------

0x0001b7e8,diagnosticServiceSecurityValidator,0x1b7f4,serviceId,byte,Diagnostic service ID from message (0-23 valid range)
0x0001b7e8,diagnosticServiceSecurityValidator,0x1b7f8,messageLengthByte,char,Message length/type byte from param_1+5
0x0001b7e8,diagnosticServiceSecurityValidator,0x1b80a,requiredLength,char,Required message length (3 for services 3/4 else 1)
0x0001b7e8,diagnosticServiceSecurityValidator,0x1b85e,securityCheckResult,char,Result from systemSecurityCheck() - 0=authorized nonzero=denied
0x000339c2,vp44CanMessage100ResponseBuilder,0x339e2,byte_swap_temp,byte,Temporary word for byte-swapping (high byte extracted via >> 8)
